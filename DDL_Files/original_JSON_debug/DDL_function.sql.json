{
    "filename": "ddl_function.sql",
    "numb_objects": 80,
    "type": "function",
    "type_hex": "1ab166ab08078d6e8e2d91ad06a6fe5d",
    "encryption_key_type": "function.key",
    "inventory": [
        {
            "name": "FN_SLS_NO_XFER_VPD",
            "encrypted_name": "ff59f473a7d59673450ce4cfea1a50029d8b3fe8760b7fe8c45d1255ce1ebaf6",
            "type": "function",
            "database": "null",
            "encrypted_database": "null",
            "schema": "XDMADM",
            "encrypted_schema": "0e03d5c46556a742ba46252698396ef2",
            "fully_qualified_name": "XDMADM.FN_SLS_NO_XFER_VPD",
            "encrypted_fqn": "0e03d5c46556a742ba46252698396ef2.ff59f473a7d59673450ce4cfea1a50029d8b3fe8760b7fe8c45d1255ce1ebaf6",
            "synonyms": [],
            "metadata_analysis": "CREATE OR REPLACE FUNCTION \"0e03d5c46556a742ba46252698396ef2\".\"ff59f473a7d59673450ce4cfea1a50029d8b3fe8760b7fe8c45d1255ce1ebaf6\" (p_schema       IN VARCHAR2,\n                                              p_objname      IN VARCHAR2)\n   RETURN VARCHAR2 AS\n   \n   c_start                CONSTANT NUMBER := DBMS_UTILITY.get_time;\n   c_fn_nm                CONSTANT VARCHAR2(30) := 'FN_SLS_NO_XFER_VPD';\n   l_security_predicate   VARCHAR2(4000) DEFAULT NULL;\n   l_cur_sql              VARCHAR2(4000) := SYS_CONTEXT('USERENV', 'CURRENT_SQL');\n   l_sbjct_area VARCHAR2(100)\n         := SYS_CONTEXT(9751bbbcfea690cc0be4d58830a6fe2e.9bfb5eb7793dc8fa6800d5a61e5e3e4e1e2f6ec194927f064ce6cb31fba71a32.f4a54ebc6f2c591ed4266aafe66971af, 9751bbbcfea690cc0be4d58830a6fe2e.9bfb5eb7793dc8fa6800d5a61e5e3e4e1e2f6ec194927f064ce6cb31fba71a32.3b1288ed835b1b524e9500bb13544956e6e6300089dae5a98e31814d0406060f);\n   l_vpd_exempt VARCHAR2(1)\n         := SYS_CONTEXT(9751bbbcfea690cc0be4d58830a6fe2e.9bfb5eb7793dc8fa6800d5a61e5e3e4e1e2f6ec194927f064ce6cb31fba71a32.f4a54ebc6f2c591ed4266aafe66971af, 9751bbbcfea690cc0be4d58830a6fe2e.9bfb5eb7793dc8fa6800d5a61e5e3e4e1e2f6ec194927f064ce6cb31fba71a32.0eaf613ab52a53601d1496b5650de81e);\nBEGIN\n   \n   IF l_sbjct_area IS NULL THEN\n      l_security_predicate   := '1=2';\n      9751bbbcfea690cc0be4d58830a6fe2e.d4abe88ed2062b430c927bc84d61faf1f9a7aadf5998d448c2e2d1b0b47a3056.7d64937276682b23a0e16e5c61dad7aa('NO SA', c_fn_nm, USER, p_schema, p_objname, l_sbjct_area, l_vpd_exempt, NULL,\n      l_cur_sql, l_security_predicate, (DBMS_UTILITY.get_time - c_start) / 100);\n\n      RETURN l_security_predicate;\n   END IF;\n\n   \n   \n   IF l_vpd_exempt = 'Y' THEN\n      l_security_predicate   := '1=1';\n      9751bbbcfea690cc0be4d58830a6fe2e.d4abe88ed2062b430c927bc84d61faf1f9a7aadf5998d448c2e2d1b0b47a3056.7d64937276682b23a0e16e5c61dad7aa('EXEMPT', c_fn_nm, USER, p_schema, p_objname, l_sbjct_area, l_vpd_exempt,\n      NULL, l_cur_sql, l_security_predicate, (DBMS_UTILITY.get_time - c_start) / 100);\n\n      RETURN l_security_predicate;\n   END IF;\n\n   l_security_predicate   := 'XFER_TO_DT IS NULL';\n   9751bbbcfea690cc0be4d58830a6fe2e.d4abe88ed2062b430c927bc84d61faf1f9a7aadf5998d448c2e2d1b0b47a3056.7d64937276682b23a0e16e5c61dad7aa('ALL DIVS', c_fn_nm, USER, p_schema, p_objname, l_sbjct_area, l_vpd_exempt, NULL,\n   l_cur_sql, l_security_predicate, (DBMS_UTILITY.get_time - c_start) / 100);\n\n   RETURN l_security_predicate;\nEXCEPTION\n   WHEN OTHERS THEN\n      l_security_predicate   := '1=3';\n      9751bbbcfea690cc0be4d58830a6fe2e.d4abe88ed2062b430c927bc84d61faf1f9a7aadf5998d448c2e2d1b0b47a3056.7d64937276682b23a0e16e5c61dad7aa(SQLCODE || '-' || SQLERRM, c_fn_nm, USER, p_schema, p_objname, l_sbjct_area,\n      l_vpd_exempt, NULL, l_cur_sql, l_security_predicate, (DBMS_UTILITY.get_time - c_start) / 100);\n\n      RETURN l_security_predicate;\nEND fn_sls_no_xfer_vpd;\n/",
            "upstream_dependencies": [],
            "downstream_dependencies": [],
            "dag_location": "null",
            "gantt_location": "null",
            "created_at": "null",
            "updated_at": "null"
        },
        {
            "name": "FN_ENABLE_SUB_PART_IND",
            "encrypted_name": "59c2c612b1a3187a72e464765bf9afe5b894ca47235060b55395c823d08aebbb",
            "type": "function",
            "database": "null",
            "encrypted_database": "null",
            "schema": "XDMADM",
            "encrypted_schema": "0e03d5c46556a742ba46252698396ef2",
            "fully_qualified_name": "XDMADM.FN_ENABLE_SUB_PART_IND",
            "encrypted_fqn": "0e03d5c46556a742ba46252698396ef2.59c2c612b1a3187a72e464765bf9afe5b894ca47235060b55395c823d08aebbb",
            "synonyms": [],
            "metadata_analysis": "CREATE OR REPLACE FUNCTION \"0e03d5c46556a742ba46252698396ef2\".\"59c2c612b1a3187a72e464765bf9afe5b894ca47235060b55395c823d08aebbb\"\n                                     (V_TABLE_OWNER     IN VARCHAR2\n                                     ,V_TABLE_NAME      IN VARCHAR2\n                                     ,V_PARTITION_VALUE IN VARCHAR2\n                                     ,V_INDEX_NAME      IN VARCHAR2\n                                     )\n      RETURN VARCHAR2\n   AS\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n  CON_PROCESS_NAME  CONSTANT varchar2(40) := 'FN_ENABLE_SUB_PART_IND';\n\n\n\n\n   CURSOR c1\n   IS\n    SELECT subpartition_name\n      FROM sys.all_ind_subpartitions d\n          ,sys.all_ind_partitions c\n          ,sys.all_indexes b\n          ,sys.all_tables a\n     WHERE     sys.all_indexes.table_owner = sys.all_tables.owner\n           AND sys.all_indexes.table_name = sys.all_tables.table_name\n           and sys.all_indexes.owner      = sys.all_ind_partitions.index_owner\n           and sys.all_indexes.index_name = sys.all_ind_partitions.index_name\n           and sys.all_ind_partitions.index_owner    = sys.all_ind_subpartitions.index_owner\n           and sys.all_ind_partitions.index_name     = sys.all_ind_subpartitions.index_name\n           and sys.all_ind_partitions.partition_name = sys.all_ind_subpartitions.partition_name\n           AND sys.all_indexes.owner = V_TABLE_OWNER\n           AND sys.all_indexes.table_name = V_TABLE_NAME\n           and fbf824795dbb1d90518869c4f73b7bf1.264ea24bbbe35b3b01f2a8785107c5c0= V_INDEX_NAME\n           and sys.all_ind_partitions.partition_name = V_PARTITION_VALUE\n      ORDER BY 1;\n\n\n\n   v_subpartition_name   SYS.all_ind_subpartitions.SUBPARTITION_NAME%TYPE;\n   v_dynamic_sql_stmt    varchar2(32000);\n\n\n\n\n   v_prcs_nm            varchar(100);\n   v_prcs_stp           varchar(100);\n   v_prcs_pram          varchar(100);\n\n\n\n\nBEGIN\n\n      dbms_output.put_line('Start Process '||CON_PROCESS_NAME);\n      dbms_output.put_line('Start Time:'||TO_CHAR(SYSDATE,'YYYY-MM-DD HH24:MI:SS'));\n      v_prcs_nm  := CON_PROCESS_NAME ;\n      v_prcs_pram:=   V_TABLE_OWNER\n                    ||'-'\n                    ||V_TABLE_NAME\n                    ||'-'\n                    ||V_INDEX_NAME\n                    ||'-'\n                    ||V_PARTITION_VALUE\n                    ;\n      v_prcs_stp := 'Start Process'||CON_PROCESS_NAME;\n\n      OPEN c1;\n\n\n\n  << compress_sub_partitions>>\n       v_prcs_stp := 'Enabling the Index of all subpartitions of '||V_PARTITION_VALUE;\n\n       dbms_output.put_line (v_prcs_stp);\n       LOOP\n          FETCH c1 INTO v_subpartition_name;\n\n          EXIT WHEN c1%NOTFOUND;\n\n          v_dynamic_sql_stmt:=\n                              'ALTER INDEX '||V_TABLE_OWNER||'.'||V_INDEX_NAME||' REBUILD SUBPARTITION '\n                           || v_subpartition_name\n                           || ' PARALLEL (DEGREE 16)';\n\n          EXECUTE IMMEDIATE v_dynamic_sql_stmt;\n\n          COMMIT;\n          DBMS_OUTPUT.put_line ('\n       END LOOP;\n\n\n\n\n  <<Wrap_Program>>\n\n      v_prcs_stp := 'Final Commit';\n\n      CLOSE c1;\n\n      commit;\n\n      dbms_output.put_line ('Successfully Enabled the Index for Partition:' || V_PARTITION_VALUE);\n      dbms_output.put_line('End Process '||CON_PROCESS_NAME);\n      dbms_output.put_line('End Time:'||TO_CHAR(SYSDATE,'YYYY-MM-DD HH24:MI:SS'));\n\n      RETURN 0;\n\n\n\nEXCEPTION\n   WHEN OTHERS\n   THEN\n         DBMS_OUTPUT.put_line ('v_subpartition_name:' || v_subpartition_name);\n         DBMS_OUTPUT.put_line ('sql_stmt:'||v_dynamic_sql_stmt);\n         DBMS_OUTPUT.put_line ('SQLERROR:' || SQLCODE || ',' || SQLERRM);\n         DBMS_OUTPUT.PUT_LINE(       v_prcs_nm\n                            ||' - '||v_prcs_stp\n                            ||' - '||v_prcs_pram);\n\n      RETURN -1;\nEND;\n/",
            "upstream_dependencies": [],
            "downstream_dependencies": [],
            "dag_location": "null",
            "gantt_location": "null",
            "created_at": "null",
            "updated_at": "null"
        },
        {
            "name": "FN_CUST_WK_AGGR_LOAD_INTRVL",
            "encrypted_name": "2ebfd02960dfc60d4e4216bc68c3ff4de71a0ef0a0b2acdca9756a0532f786aa",
            "type": "function",
            "database": "null",
            "encrypted_database": "null",
            "schema": "XDMADM",
            "encrypted_schema": "0e03d5c46556a742ba46252698396ef2",
            "fully_qualified_name": "XDMADM.FN_CUST_WK_AGGR_LOAD_INTRVL",
            "encrypted_fqn": "0e03d5c46556a742ba46252698396ef2.2ebfd02960dfc60d4e4216bc68c3ff4de71a0ef0a0b2acdca9756a0532f786aa",
            "synonyms": [],
            "metadata_analysis": "CREATE OR REPLACE FUNCTION \"0e03d5c46556a742ba46252698396ef2\".\"2ebfd02960dfc60d4e4216bc68c3ff4de71a0ef0a0b2acdca9756a0532f786aa\" (p_div_nbr       NUMBER,\n                                     p_date          VARCHAR2 \n                                                             )\n   RETURN NUMBER IS\n   \n   c_success                   CONSTANT NUMBER := 0;\n   c_error                     CONSTANT NUMBER := 1;\n\n   l_fisc_yr_wk                VARCHAR2(6);\n   l_clndr_wk_strt_dt          DATE;\n   l_clndr_wk_end_dt           DATE;\n   l_fisc_mth_start_dt         DATE;\n   l_fisc_mth_end_dt           DATE;\n   l_prcs_dt                   DATE;\n   l_max_orig_ldr_tm           NUMBER;\n\n   l_cogs_ar_gl_lwr_lmt        NUMBER;\n   l_cogs_ar_gl_upr_lmt        NUMBER;\n   l_net_sls_ar_gl_lwr_lmt     NUMBER;\n   l_net_sls_ar_gl_upr_lmt     NUMBER;\n   l_net_acct_pim_suprcls_id   NUMBER;\nBEGIN\n   \n   IF (p_date IS NULL) THEN\n      DBMS_OUTPUT.put_line('Error: Invalid Parameters: Date is required');\n      RETURN c_error;\n   ELSE\n      BEGIN\n         l_prcs_dt   := TO_DATE(p_date, 'yyyymmdd');\n      EXCEPTION\n         WHEN OTHERS THEN\n            DBMS_OUTPUT.put_line('Invalid Date: ' || p_date);\n            RETURN c_error;\n      END;\n   END IF;\n\n   IF (p_div_nbr IS NULL) THEN\n      DBMS_OUTPUT.put_line('Error: Invalid Parameters: Div Number required');\n      RETURN c_error;\n   END IF;\n\n   \n   SELECT DISTINCT de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.f2de255a7553ba934b1f05ae7699ae4c,\n                   de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.c9ed3827968a72723f7e114f602d0196e32f6dd38f333cde68119d1f277367cd,\n                   de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.082954f5697b93de7d3d890e9e5528dc,\n                   de459e2fe7f96e4d958537b31b946b26.ca1faaabe4743a8a00a4d208ab58b2b3.eeb3cae1b83726e8df7c8d2367b9cf4b1d731bbdc4e3fb69a854112d4982eb99,\n                   de459e2fe7f96e4d958537b31b946b26.ca1faaabe4743a8a00a4d208ab58b2b3.e17b4db24503ad4d9365a15bec98eef6\n     INTO l_fisc_yr_wk,\n          l_clndr_wk_strt_dt,\n          l_clndr_wk_end_dt,\n          l_fisc_mth_start_dt,\n          l_fisc_mth_end_dt\n     FROM de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001 t, de459e2fe7f96e4d958537b31b946b26.ca1faaabe4743a8a00a4d208ab58b2b3 pt, de459e2fe7f96e4d958537b31b946b26.c063519e87e23d735cdb53a35832f0ff w\n    WHERE de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.2603c45be643e5cd8f9c6dad3bee6cb3 = de459e2fe7f96e4d958537b31b946b26.ca1faaabe4743a8a00a4d208ab58b2b3.2603c45be643e5cd8f9c6dad3bee6cb3\n      AND de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.222ccb1d1746bcdb2365f29b3da0b613 = l_prcs_dt;\n\n   DBMS_OUTPUT.put_line('Fiscal Week: ' || l_fisc_yr_wk);\n\n   DELETE FROM de459e2fe7f96e4d958537b31b946b26.036ae3d3b1cd5cb84ab106f395f4df87\n         WHERE full_day_flg = 'P'\n           AND latest_prcs_dt = l_prcs_dt\n           AND div_nbr = p_div_nbr;\n\n   DBMS_OUTPUT.put_line('Deleted ' || sql%ROWCOUNT || ' rows');\n\n   \n\n   SELECT NVL(MAX(orig_ldr_tm), 19900101000000)\n     INTO l_max_orig_ldr_tm\n     FROM de459e2fe7f96e4d958537b31b946b26.036ae3d3b1cd5cb84ab106f395f4df87\n    WHERE div_nbr = p_div_nbr\n      AND fisc_yr_wk = l_fisc_yr_wk\n      AND full_day_flg = 'F';\n\n   DBMS_OUTPUT.put_line('Max Original Loader Time: ' || l_max_orig_ldr_tm);\n\n   \n   BEGIN\n      SELECT param_value_nbr\n        INTO l_cogs_ar_gl_lwr_lmt\n        FROM de459e2fe7f96e4d958537b31b946b26.de40ae7be8b2eb3858d46af8d107f3db\n       WHERE app_name = 'ALL'\n         AND param_type = 'AR_GL_ACCT_LOWER_LMT'\n         AND param_code = 'COGS_AR_GL_LWR_LMT';\n\n      DBMS_OUTPUT.put_line('Parm value for COGS Lower Limit: ' || l_cogs_ar_gl_lwr_lmt);\n\n      SELECT param_value_nbr\n        INTO l_cogs_ar_gl_upr_lmt\n        FROM de459e2fe7f96e4d958537b31b946b26.de40ae7be8b2eb3858d46af8d107f3db\n       WHERE app_name = 'ALL'\n         AND param_type = 'AR_GL_ACCT_UPPER_LMT'\n         AND param_code = 'COGS_AR_GL_UPR_LMT';\n\n      DBMS_OUTPUT.put_line('Parm value for COGS Upper Limit: ' || l_cogs_ar_gl_upr_lmt);\n\n      SELECT param_value_nbr\n        INTO l_net_sls_ar_gl_lwr_lmt\n        FROM de459e2fe7f96e4d958537b31b946b26.de40ae7be8b2eb3858d46af8d107f3db\n       WHERE app_name = 'ALL'\n         AND param_type = 'AR_GL_ACCT_LOWER_LMT'\n         AND param_code = 'NET_SLS_AR_GL_LWR_LMT';\n\n      DBMS_OUTPUT.put_line('Parm value for Net Sales Lower Limit: ' || l_net_sls_ar_gl_lwr_lmt);\n\n      SELECT param_value_nbr\n        INTO l_net_sls_ar_gl_upr_lmt\n        FROM de459e2fe7f96e4d958537b31b946b26.de40ae7be8b2eb3858d46af8d107f3db\n       WHERE app_name = 'ALL'\n         AND param_type = 'AR_GL_ACCT_UPPER_LMT'\n         AND param_code = 'NET_SLS_AR_GL_UPR_LMT';\n\n      DBMS_OUTPUT.put_line('Parm value for Net Sales Upper Limit: ' || l_net_sls_ar_gl_upr_lmt);\n\n      SELECT param_value_nbr\n        INTO l_net_acct_pim_suprcls_id\n        FROM de459e2fe7f96e4d958537b31b946b26.de40ae7be8b2eb3858d46af8d107f3db\n       WHERE app_name = 'MERLIN'\n         AND param_type = 'NON_ADMIN_PIM_SUPRCLS_ID'\n         AND param_code = 'UPPER_LIMIT';\n\n      DBMS_OUTPUT.put_line('Parm value for Net Acct PIM Superclass ID: ' || l_net_acct_pim_suprcls_id);\n   EXCEPTION\n      WHEN NO_DATA_FOUND THEN\n         DBMS_OUTPUT.put_line('Error: Failed to get param value');\n         RETURN c_error;\n   END;\n\n   INSERT INTO de459e2fe7f96e4d958537b31b946b26.036ae3d3b1cd5cb84ab106f395f4df87(fisc_yr_wk, full_day_flg, cust_nbr, div_nbr, cust_sk, sls_revenue_div_nbr,\n                                   admn_flg, ldr_tm, drop_cnt, drop_cnt_ly, grs_sls_extnd, grs_sls_extnd_ly,\n                                   unfrm_qty_ship, unfrm_qty_ship_ly, actl_gp, actl_gp_ly, ttl_alwnc, ttl_alwnc_ly,\n                                   grs_tgp, grs_tgp_ly, net_sls, net_sls_ly, net_tgp, net_tgp_ly,\n                                   dwa_cost_extnd, dwa_cost_extnd_ly, rbt_loc_accrl_amt, rbt_loc_accrl_amt_ly, rbt_natl_accrl_amt, rbt_natl_accrl_amt_ly,\n                                   rbt_loc_exp_amt, rbt_loc_exp_amt_ly, rbt_natl_exp_amt, rbt_natl_exp_amt_ly, ttl_int_vndr_fnd_dvt, ttl_int_vndr_fnd_dvt_ly,\n                                   comm_bsis_amt_extnd, comm_bsis_amt_extnd_ly, dond, dond_ly, ttl_vndr_fnd_dvt, ttl_vndr_fnd_dvt_ly,\n                                   fixed_sell, fixed_sell_ly, n_prime_sis, n_prime_sis_ly, prc_apprvl, prc_apprvl_ly,\n                                   dwo, dwo_ly, invst_cs_prtcpt, invst_cs_prtcpt_ly, net_non_prod_chrg, net_non_prod_chrg_ly,\n                                   net_prod_chrg, net_prod_chrg_ly, net_non_prod_alwnc, net_non_prod_alwnc_ly, net_prod_alwnc, net_prod_alwnc_ly,\n                                   latest_prcs_dt, orig_ldr_tm, brk_srchrg, cde, prod_sls_tax, cogs_alw_chrg,\n                                   prod_alw, prod_chrg, non_prod_alwnc, non_prod_chrg, actl_cst, ap_cost,\n                                   ap_gain, frght_cost, inside_pad, lic_prod_extnd, lic_tot_extnd, rep_cost_extnd,\n                                   mkt_prod_extnd, mkt_tot_extnd, orig_dwa_cost_extnd, srchrg, cat_sold, cd_ln_cnt,\n                                   net_acct_cust_sk_ly, net_acct_cust_sk, rt_inv_cnt, rt_ln_cnt, rt_ln_cnt_ly, vndr_ship_inv_cnt,\n                                   vndr_ship_ln_cnt, vndr_ship_ln_cnt_ly, wc_inv_cnt, wc_ln_cnt, wc_ln_cnt_ly, dvt_cost_extnd,\n                                   eb_dvt_cost_extnd, eb_loc_int_dvt, eb_loc_vndr_fnd_dvt, eb_natl_int_dvt, eb_natl_vndr_fnd_dvt, eb_ttl_dvt,\n                                   eb_ttl_int_vndr_fnd_dvt, eb_ttl_vndr_fnd_dvt, loc_int_dvt, loc_vndr_fnd_dvt, natl_int_dvt, natl_vndr_fnd_dvt,\n                                   ttl_dvt, eb_actl_gp, eb_inv_gp, eb_true_gp, inv_actl_gp, inv_gp,\n                                   lnd_gp, net_tagp, net_tagp_ly, true_gp, natl_mrktng_alwnc_pgms, eb_natl_mrktng_alwnc_pgms,\n                                   eb_loc_mrktng_alwnc_pgms, eb_loc_one_tm, eb_loc_prom_alwnc_pgms, eb_natl_one_tm, eb_natl_prom_alwnc_pgms, eb_ttl_alwnc,\n                                   eb_ttl_loc_alwnc, eb_ttl_natl_alwnc, loc_mrktng_alwnc_pgms, loc_one_tm, loc_prom_alwnc_pgms, natl_one_tm,\n                                   natl_prom_alwnc_pgms, ttl_loc_alwnc, ttl_natl_alwnc, adj_markout, cd_unfrm_qty_ship, cd_qty_ship,\n                                   dry_each, dry_unit, dry_wt, each_ord, each_orig, each_rsrv,\n                                   each_ship, eb_unfrm_qty_ship, eb_unfrm_qty_ship_ly, eb_each_ship, eb_net_wt_ship, eb_qty_ship,\n                                   eb_qty_ship_ly, eb_unit_ship, frz_each, frz_unit, frz_wt, mb_unfrm_qty_ship,\n                                   mb_unfrm_qty_ship_ly, net_wt_ship, net_wt_ship_ly, qty_dvt, qty_markout, qty_ord,\n                                   qty_orig, qty_rsrv, qty_ship, qty_ship_ly, qty_subbed, rfrgrt_each,\n                                   rfrgrt_unit, rfrgrt_wt, rt_qty_ship, rt_qty_ship_ly, rt_unfrm_qty_ship, rt_unfrm_qty_ship_ly,\n                                   unfrm_qty_dvt, unfrm_qty_markout, unfrm_qty_ord, unfrm_qty_orig, unfrm_qty_rsrv, unfrm_qty_subbed,\n                                   unit_ord, unit_orig, unit_rsrv, unit_ship, vs_qty_ship, vs_unfrm_qty_ship,\n                                   wc_unfrm_qty_ship, wc_qty_ship, cmsn_sls_extnd, cr_memo_dlr, cd_grs_sls_extnd, cs_grs_sls_extnd,\n                                   ct_grs_sls_extnd, ec_grs_sls_extnd, eb_net_sls, eb_net_sls_ly, eb_grs_sls_extnd, eb_grs_sls_extnd_ly,\n                                   ed_grs_sls_extnd, fs_grs_sls_extnd, mb_net_sls, mb_net_sls_ly, mb_grs_sls_extnd, mb_grs_sls_extnd_ly,\n                                   rt_grs_sls_extnd, rt_net_sls, pt_grs_sls_extnd, vs_grs_sls_extnd, wc_grs_sls_extnd, cd_ln_cnt_ly,\n                                   cc_inv_cnt, cc_ln_cnt, cc_ln_cnt_ly, cc_unfrm_qty_ship, cc_qty_ship, cc_grs_sls_extnd,\n                                   st_grs_sls_extnd, lnd_actl_gp, lnd_actl_gp_ly, fisc_mth_strt_dt, fisc_mth_end_dt, fisc_wk_strt_dt,\n                                   fisc_wk_end_dt, rt_grs_sls_extnd_ly, actv_cust_sk, ttl_int_vndr_fnd_dvt_is, ttl_int_vndr_fnd_dvt_is_ly, comm_bsis_amt_extnd_is,\n                                   comm_bsis_amt_extnd_is_ly, dond_is, dond_is_ly, ec_grs_sls_extnd_ly, scp_qty_ship, scp_promo_qty_ship,\n                                   rtrn_unfrm_qty_ship, invst_sls_prtcpt, invst_sls_prtcpt_ly,usf_gl_ind,ec_st_grs_sls_extnd,\n                                   ec_st_grs_sls_extnd_ly,ec_na_grs_sls_extnd,ec_na_grs_sls_extnd_ly,ec_st_grs_sls_extnd_dnmtr,\n                                   ec_st_grs_sls_extnd_dnmtr_ly,ec_na_grs_sls_extnd_dnmtr,ec_na_grs_sls_extnd_dnmtr_ly)\n      SELECT l_fisc_yr_wk,\n             'P',\n             9232a27ba220391779f5962f8d639de4.852fa1e9f02f1ca2c75837f7146b2381,\n             9232a27ba220391779f5962f8d639de4.839c4ffb4bfaae1bb58eab4dee67d96a,\n             9232a27ba220391779f5962f8d639de4.7f599f836c449bebb92bb9757e86c603,\n             9232a27ba220391779f5962f8d639de4.a2b201123c685e8cc48b5468cb4a449361bbd7bc0d2d67c7d7b11cb0a8d18d03,\n             9232a27ba220391779f5962f8d639de4.15defaed5d972b2056efd55a03ec66b7,\n             TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS'),\n             9232a27ba220391779f5962f8d639de4.5eb47379f9cd1fd0a9110e76b90fc8c4,\n             NULL,\n             9232a27ba220391779f5962f8d639de4.2ee1400a0150f0b220dd7bd6268d1e66,\n             NULL,\n             9232a27ba220391779f5962f8d639de4.ccf8d88f2d37f3171da2121ab22e9330,\n             NULL,\n             9232a27ba220391779f5962f8d639de4.1afca342ab89e5b8c65c6c4c634b2186,\n             NULL,\n             9232a27ba220391779f5962f8d639de4.bc85f0acd4f5b2becdd7efc34c3a2003,\n             NULL,\n             9232a27ba220391779f5962f8d639de4.4f1272f7dffc94b9e882fd01e6907270,\n             NULL,\n             9232a27ba220391779f5962f8d639de4.0eb04e3d5b6a06d91d9f4c76179a4931,\n             NULL,\n             9232a27ba220391779f5962f8d639de4.749e34914a6f5722a4481aae0afcb0bc,\n             NULL,\n             9232a27ba220391779f5962f8d639de4.c6c7cc45578c678907522e08bb04a4ca,\n             NULL,\n             9232a27ba220391779f5962f8d639de4.5a946c48d4cb9b1b6880bf6386e276781d731bbdc4e3fb69a854112d4982eb99,\n             NULL,\n             9232a27ba220391779f5962f8d639de4.6ec51d00c0df5a2c35ea4dc79b992a0ef4147ca167a57859c2f78f7521e7a9a8,\n             NULL,\n             9232a27ba220391779f5962f8d639de4.bb26587da7cde1ca1883d4ac6949a349,\n             NULL,\n             9232a27ba220391779f5962f8d639de4.d2a9879c73e438cd42a66e4ee567caf5e32f6dd38f333cde68119d1f277367cd,\n             NULL,\n             9232a27ba220391779f5962f8d639de4.e2657ceeba5b709bafb65e0820feb4e2b6e1b396dbe14782b1b65b60d5d80e45,\n             NULL,\n             9232a27ba220391779f5962f8d639de4.7a408037993e6c1e330c1e1575363846280a4c8731f60bb762471fb74030c9a2,\n             NULL,\n             9232a27ba220391779f5962f8d639de4.10de911af5f8a093fcb0e794a8a37932,\n             NULL,\n             9232a27ba220391779f5962f8d639de4.b7982b81d447f11a0953881190e528cae32f6dd38f333cde68119d1f277367cd,\n             NULL,\n             9232a27ba220391779f5962f8d639de4.0e186bf9b85377462d6d66610841c265,\n             NULL,\n             9232a27ba220391779f5962f8d639de4.21ac790830e1a728ff98bf83401bc8bf,\n             NULL,\n             9232a27ba220391779f5962f8d639de4.0257dc808a7e5b4c2b16f4734ba32a2e,\n             NULL,\n             9232a27ba220391779f5962f8d639de4.188f013515d3525238ddcf63991be4a1,\n             NULL,\n             9232a27ba220391779f5962f8d639de4.fa90aa6029c4e57b7ba11058fe6e029ae32f6dd38f333cde68119d1f277367cd,\n             NULL,\n             9232a27ba220391779f5962f8d639de4.bbba88aa390c897e4916ee82fb5a943a63f2fe9cc6b573bb859641780443a51b,\n             NULL,\n             9232a27ba220391779f5962f8d639de4.6b3260c556af6890cf3ab676f017f510,\n             NULL,\n             9232a27ba220391779f5962f8d639de4.9124f44d32ff81f2f0620eb53c13ad9cab532c4a01b63f0ae3437f0a75e66999,\n             NULL,\n             9232a27ba220391779f5962f8d639de4.7cdb91afa2a4d687a44abd3f36010e94,\n             NULL,\n             9232a27ba220391779f5962f8d639de4.f8600be772743ca3722276946bfd8437,\n             9232a27ba220391779f5962f8d639de4.6aad564fb2381f50b58f8d5a0fb08cbd,\n             9232a27ba220391779f5962f8d639de4.2900b8b236fcbe8e44fe5fcfac669c47,\n             9232a27ba220391779f5962f8d639de4.adf5289e9a866af8b69b5e9d035b790b,\n             9232a27ba220391779f5962f8d639de4.6332016ddc9cad43c85dec8c86c2f732,\n             9232a27ba220391779f5962f8d639de4.1595668ddae5ffcbd3638b5bd00be375,\n             9232a27ba220391779f5962f8d639de4.63a91e2fd122990392b8c1467a67b61e,\n             9232a27ba220391779f5962f8d639de4.f4684b698d1e8edd11bf71d8eac02595,\n             9232a27ba220391779f5962f8d639de4.2dfeefdbbdd44f6feceb5ad393352003,\n             9232a27ba220391779f5962f8d639de4.bd428d343074503f124765bf6dd4405a,\n             9232a27ba220391779f5962f8d639de4.21c984990c46996e1ca85db8ed7b326f,\n             9232a27ba220391779f5962f8d639de4.879553e6f3c76406b6c8d29e37a2e69a,\n             9232a27ba220391779f5962f8d639de4.518556df822338be02791d180820e13d,\n             9232a27ba220391779f5962f8d639de4.caa7253bb26c1be62d920c15aa47acc7,\n             9232a27ba220391779f5962f8d639de4.47d7f1b55574f6efb03d7bd7c85359bf,\n             9232a27ba220391779f5962f8d639de4.ef84040ad09159c2ca7623e36c53c140,\n             9232a27ba220391779f5962f8d639de4.27927710671f59a6b0cb9e9107e333f4,\n             9232a27ba220391779f5962f8d639de4.88d58d1ceaa04b12e965be48693946b8,\n             9232a27ba220391779f5962f8d639de4.ba123fb99b0591dc3db0219d097aa590,\n             9232a27ba220391779f5962f8d639de4.46930193dd6f47d2a8ad6a585e4f0be5,\n             9232a27ba220391779f5962f8d639de4.192a0b9848c9b555676e26cadfe60852280a4c8731f60bb762471fb74030c9a2,\n             9232a27ba220391779f5962f8d639de4.b062726b7cf877dc4379a5ef28a428cb,\n             9232a27ba220391779f5962f8d639de4.c3a904d6986fe2e41d14bc8e27a86788,\n             9232a27ba220391779f5962f8d639de4.003c13a9baac77b8941acae69bb4b98e,\n             NULL,\n             9232a27ba220391779f5962f8d639de4.427b165a60053aea6330e695e94a70a7e32f6dd38f333cde68119d1f277367cd,\n             9232a27ba220391779f5962f8d639de4.f0680902520d5d75679702568c1d17fe,\n             9232a27ba220391779f5962f8d639de4.928fc2c4f030fae278a7dd9897ee6100,\n             NULL,\n             9232a27ba220391779f5962f8d639de4.94bd70997823b14287f2d6141c1f689b1d731bbdc4e3fb69a854112d4982eb99,\n             9232a27ba220391779f5962f8d639de4.ae686ab1728dfd932926860c60655a2de32f6dd38f333cde68119d1f277367cd,\n             NULL,\n             9232a27ba220391779f5962f8d639de4.0fc7e069331d6b84ca3a8a515a362275,\n             9232a27ba220391779f5962f8d639de4.229146346044dd4e63aa6b967c967693,\n             NULL,\n             9232a27ba220391779f5962f8d639de4.237609d37bbd0b9a205aa95e75daf38b,\n             9232a27ba220391779f5962f8d639de4.57036f3bf3cfa5839a64aa3da90a0c12fce896ca0fbbf5a5d330f2803036eb44,\n             9232a27ba220391779f5962f8d639de4.16e2f756a21900bcb4f192e05d07e792,\n             9232a27ba220391779f5962f8d639de4.a20a42594e8c2e7175ad6f0bbb8d31e21577c52487561bff1011f2a83812b399,\n             9232a27ba220391779f5962f8d639de4.c27949025202b5d57a0f051de04d0ad0,\n             9232a27ba220391779f5962f8d639de4.7daaa0c9fc5f2223863b4bf23991d827b6e1b396dbe14782b1b65b60d5d80e45,\n             9232a27ba220391779f5962f8d639de4.5bb4500a9b969963dbc03b2b284f765e,\n             9232a27ba220391779f5962f8d639de4.5315bd4779d5e338e7c07764a10b109f8d3117d2e3c5d600b9d29352edde7878,\n             9232a27ba220391779f5962f8d639de4.2c9cf97eb28b5b9b2e9ad51ca01d6fdf1577c52487561bff1011f2a83812b399,\n             9232a27ba220391779f5962f8d639de4.931b2ac4399b8a337f8d0ff67bab0e15,\n             9232a27ba220391779f5962f8d639de4.c137fdd918ede20e07fec7282883fa34e32f6dd38f333cde68119d1f277367cd,\n             9232a27ba220391779f5962f8d639de4.42dd45423319f918e704ed37d4dbb128,\n             9232a27ba220391779f5962f8d639de4.b5019e4009d6240fe25b80db390c07601d731bbdc4e3fb69a854112d4982eb99,\n             9232a27ba220391779f5962f8d639de4.5867b4a2e2d1a7c0792d8569c0d90b1f,\n             9232a27ba220391779f5962f8d639de4.01486ac0a3307281b2574d39ec14b74e,\n             9232a27ba220391779f5962f8d639de4.9180a3cbab663e4f421916c424dffd75,\n             9232a27ba220391779f5962f8d639de4.5f56cabcb8194c6f07c5031c5539d1bf,\n             9232a27ba220391779f5962f8d639de4.8a3a832e9ed55880c82a6085970dfe5d,\n             9232a27ba220391779f5962f8d639de4.b89d8f9a5bec26add637853438d6311f,\n             9232a27ba220391779f5962f8d639de4.aae449a432058ba773088445191b55b8,\n             9232a27ba220391779f5962f8d639de4.c9b483ce78db872b23a1b1e5ccd61f1c,\n             NULL,\n             9232a27ba220391779f5962f8d639de4.5c045c6ad55bfb143fea1cb9634d34af,\n             9232a27ba220391779f5962f8d639de4.5e937026da90c7e4a4e0bb540e061948eed1259e6b62783c664a0bc2e5e255a4,\n             9232a27ba220391779f5962f8d639de4.2cb2b59e6e2692262ff2da48575e74d076cf4044c94f9364bb1310f8eda7503d,\n             9232a27ba220391779f5962f8d639de4.674dba520e90f98671fb32dec37cef9ac8a15b2b5bbdf8c242bbd219cfe9cba6,\n             9232a27ba220391779f5962f8d639de4.e12e93eaa7e94d2fadd0fec4164a0963,\n             9232a27ba220391779f5962f8d639de4.ba9b12bc9affcca3eeb5ee1cd2e9f403eed1259e6b62783c664a0bc2e5e255a4,\n             9232a27ba220391779f5962f8d639de4.c595572922aedf9a3605b06547a01162,\n             9232a27ba220391779f5962f8d639de4.fe5aded79712e932062c92c1fbdd57b658a787d546a1bf64272b6e58b9909339,\n             9232a27ba220391779f5962f8d639de4.c9fab7575226c653862cc30226a84fba,\n             9232a27ba220391779f5962f8d639de4.f1c11edd74f72097d08f1b4aed826119e32f6dd38f333cde68119d1f277367cd,\n             9232a27ba220391779f5962f8d639de4.48fbeca57d7ff5ad5de7dc5bb0495323d2450100e2dda59c2b7828b4daff7f8c,\n             9232a27ba220391779f5962f8d639de4.3f5f78a3c918316a0e68170dc6b81e0c7ea8b5b6353c726ed7e410e230c7898b,\n             9232a27ba220391779f5962f8d639de4.42c87cd307c51e63a144309315721b09,\n             9232a27ba220391779f5962f8d639de4.df0917aa3fd36489aa4d308fa97b06b76398e8624834825f4604477ca9ac3d8a,\n             9232a27ba220391779f5962f8d639de4.11da749d2c0d1e21a4c413489daad454,\n             9232a27ba220391779f5962f8d639de4.7321a4c88369e6acc22f8952a98e86b3e7fabc080d1e698e1941d756c183e979,\n             9232a27ba220391779f5962f8d639de4.d36e400304221073c1c3bb586ed7de9f,\n             9232a27ba220391779f5962f8d639de4.92d4d6b1028cc8f6b6a6a50394af943a,\n             9232a27ba220391779f5962f8d639de4.46b0f23abe1bbed246cdeae858a9d7c0,\n             9232a27ba220391779f5962f8d639de4.ec3a8082f0d7ff5513bbb43bd8e67ab5e472b097974b0d6a9a7d2ed170324906,\n             9232a27ba220391779f5962f8d639de4.c43ef5a0431c6c1d631485efae5a01af,\n             9232a27ba220391779f5962f8d639de4.7e33db42f9c57a6374e01e1886e762b2,\n             9232a27ba220391779f5962f8d639de4.b204827e6d3f8c94592eef11de23cb12,\n             9232a27ba220391779f5962f8d639de4.11212ff4cad5193c5fabb7a5d519894b,\n             9232a27ba220391779f5962f8d639de4.d4e40e976e264ee8a5a57f4f800d6c3b,\n             9232a27ba220391779f5962f8d639de4.1b4f3e751f125481ce5a66b8a939dec8,\n             9232a27ba220391779f5962f8d639de4.233e8c6acbaa45d323ec940cedfa07b4,\n             9232a27ba220391779f5962f8d639de4.baa23b8932072303310f88d528c93b04,\n             9232a27ba220391779f5962f8d639de4.0f10fd1fb96408d40508d79449ec4053e472b097974b0d6a9a7d2ed170324906,\n             NULL,\n             9232a27ba220391779f5962f8d639de4.6bef547ac7468df0792a345ee0cec22d,\n             9232a27ba220391779f5962f8d639de4.9461ee6a62ed20fe561dca2d8fc004d0,\n             9232a27ba220391779f5962f8d639de4.03a9b4c40a730bc19a5312838aed1cfa,\n             NULL,\n             9232a27ba220391779f5962f8d639de4.856717c24e3d2fd21584703930c86f65,\n             9232a27ba220391779f5962f8d639de4.54edae7157431b18e6d2baa702518a1c,\n             9232a27ba220391779f5962f8d639de4.f7a32a3094075407e6262fa7b4099334,\n             9232a27ba220391779f5962f8d639de4.db506a9e456768af2c1d2fe201b53b40,\n             9232a27ba220391779f5962f8d639de4.3578e83b0c05d360c77167ca1fc69361e472b097974b0d6a9a7d2ed170324906,\n             NULL,\n             9232a27ba220391779f5962f8d639de4.b215402101f7a4f20fccac979c4d9b44,\n             NULL,\n             9232a27ba220391779f5962f8d639de4.af173eb37e528a7cdb955e5b28cc23aa,\n             9232a27ba220391779f5962f8d639de4.4b191f0271f76dbc6e6000be34023a3e,\n             9232a27ba220391779f5962f8d639de4.e1b1859b558f14ea9916a5dbcd02473a,\n             9232a27ba220391779f5962f8d639de4.82be0aaa7de54349da31cee325ab951e,\n             9232a27ba220391779f5962f8d639de4.4b413d0bbcae181494a218cf6afc155f,\n             9232a27ba220391779f5962f8d639de4.dc15696e1e997bad6131bf936574f406,\n             NULL,\n             9232a27ba220391779f5962f8d639de4.082ab98f67c47545852bd9eeb87c14a4,\n             9232a27ba220391779f5962f8d639de4.82bb584f288c6982cf738bddb639ec2a,\n             9232a27ba220391779f5962f8d639de4.5b092195a30f8906453974d1170a1ea1,\n             9232a27ba220391779f5962f8d639de4.2b326fa6a91e72fbd4db5ddd134f321f,\n             9232a27ba220391779f5962f8d639de4.20a040a6d6962025b5e3e8a68c387b1c,\n             NULL,\n             9232a27ba220391779f5962f8d639de4.69411dc7a4bc96ab29fac7b3f27121d4e472b097974b0d6a9a7d2ed170324906,\n             NULL,\n             9232a27ba220391779f5962f8d639de4.1db1b1099d6c7239a882ba6364f0e12d,\n             9232a27ba220391779f5962f8d639de4.c7a5550e66e03d37be3af7810a1cd82e1d731bbdc4e3fb69a854112d4982eb99,\n             9232a27ba220391779f5962f8d639de4.b929d681ced63c6b203aa9a1d8973da4,\n             9232a27ba220391779f5962f8d639de4.aea2b843066cbf7530af94deb507a420,\n             9232a27ba220391779f5962f8d639de4.500f21991e85f5b9a78ad5961f1fbbc7,\n             9232a27ba220391779f5962f8d639de4.60a12efca79b9e843a21f9dd325e6a80e32f6dd38f333cde68119d1f277367cd,\n             9232a27ba220391779f5962f8d639de4.424607a0ca73330c3cc1e84dfe4afa64,\n             9232a27ba220391779f5962f8d639de4.d3e77785919f0b458a86d736b61dd5a7,\n             9232a27ba220391779f5962f8d639de4.c2e82d4936217cdd8ea6375bc48b58b2,\n             9232a27ba220391779f5962f8d639de4.eaa03e417a6b67a32172cc9dca631f77,\n             9232a27ba220391779f5962f8d639de4.cdc96121610201658e8b9237cc891be9,\n             9232a27ba220391779f5962f8d639de4.8af4d1afe03bdc5e4057323407834e75e472b097974b0d6a9a7d2ed170324906,\n             9232a27ba220391779f5962f8d639de4.5d9388aca9e40bf836a22c7d6d6c6c18e472b097974b0d6a9a7d2ed170324906,\n             9232a27ba220391779f5962f8d639de4.9ab5a4e6d5c18c4920d30c2b5a877095,\n             9232a27ba220391779f5962f8d639de4.a793addd328c78704a7e0e45ea3001d4,\n             9232a27ba220391779f5962f8d639de4.582bd9075c3cdfa71b2052bbedf48cd5,\n             9232a27ba220391779f5962f8d639de4.5d1b6cf2fdcdfe2c08c25399fba1af1ae32f6dd38f333cde68119d1f277367cd,\n             9232a27ba220391779f5962f8d639de4.b3460ab28969f84cd0382214fc83a7c4e32f6dd38f333cde68119d1f277367cd,\n             9232a27ba220391779f5962f8d639de4.bbde6b3f21353efb5221496f1f2b2df6e32f6dd38f333cde68119d1f277367cd,\n             9232a27ba220391779f5962f8d639de4.d1987c8a23e55f6e34443ab156666710e32f6dd38f333cde68119d1f277367cd,\n             9232a27ba220391779f5962f8d639de4.02b595cfdac32e15a18add241a418258,\n             NULL,\n             9232a27ba220391779f5962f8d639de4.775a81ed07fc8289cafeb8f0be1f4fb7e32f6dd38f333cde68119d1f277367cd,\n             NULL,\n             9232a27ba220391779f5962f8d639de4.ad801eae97ca6c202ca8eae2745b84b8e32f6dd38f333cde68119d1f277367cd,\n             9232a27ba220391779f5962f8d639de4.a299557b51795ab090e95fe82fada24de32f6dd38f333cde68119d1f277367cd,\n             9232a27ba220391779f5962f8d639de4.ee0b4629d8b0d64feaed9c1ca2886a8d,\n             NULL,\n             9232a27ba220391779f5962f8d639de4.a29115438b5a8786c1ee9bb8e5e5cc3be32f6dd38f333cde68119d1f277367cd,\n             NULL,\n             9232a27ba220391779f5962f8d639de4.601edc10811255ea6b70fcd9aafa62d9e32f6dd38f333cde68119d1f277367cd,\n             9232a27ba220391779f5962f8d639de4.cdf2511e3c4e62e0fb9a2cd9d7991496,\n             9232a27ba220391779f5962f8d639de4.345a69a1d0b1051cea546b70c4c2a1c5e32f6dd38f333cde68119d1f277367cd,\n             9232a27ba220391779f5962f8d639de4.9bec34e0c076b14b2862f846bef2367fe32f6dd38f333cde68119d1f277367cd,\n             9232a27ba220391779f5962f8d639de4.a81ab036c1a04b32f86673c2f6c9468de32f6dd38f333cde68119d1f277367cd,\n             NULL,\n             9232a27ba220391779f5962f8d639de4.ffc74ef9bcabae7de8ac4bf056479525,\n             9232a27ba220391779f5962f8d639de4.3f38f4853b12aacd2f051a1e2709be51,\n             NULL,\n             9232a27ba220391779f5962f8d639de4.d642c2b7d6c42ec9007719af15dff9f4e472b097974b0d6a9a7d2ed170324906,\n             9232a27ba220391779f5962f8d639de4.08dc3a4ffafc7fa4918affe05188d843,\n             9232a27ba220391779f5962f8d639de4.9ae991debda61ffa628c716163bfd514e32f6dd38f333cde68119d1f277367cd,\n             9232a27ba220391779f5962f8d639de4.57aaa86f8577e32ae4d1478a2d5ad223e32f6dd38f333cde68119d1f277367cd,\n             9232a27ba220391779f5962f8d639de4.c4e3a9f99fa6f955de390a93819085ae,\n             NULL,\n             l_fisc_mth_start_dt,\n             l_fisc_mth_end_dt,\n             l_clndr_wk_strt_dt,\n             l_clndr_wk_end_dt,\n             NULL,\n             9232a27ba220391779f5962f8d639de4.7f599f836c449bebb92bb9757e86c603,\n             9232a27ba220391779f5962f8d639de4.e2657ceeba5b709bafb65e0820feb4e2e71d6e15d5f960146139766d193d0f98,\n             NULL,\n             9232a27ba220391779f5962f8d639de4.7a408037993e6c1e330c1e1575363846430598f9ef9d4def92bc5a23f13ed502,\n             NULL,\n             9232a27ba220391779f5962f8d639de4.093fd60cabfeef712934dac6442dacc6,\n             NULL,\n             NULL,\n             9232a27ba220391779f5962f8d639de4.710b07b45d4b4630a5ad3afaa7d2a273, \n             9232a27ba220391779f5962f8d639de4.ec6cdaa07d0a720be445fa57ba8a2b2d717ece3e5d30eea3a4743c148ed0937b, \n             9232a27ba220391779f5962f8d639de4.11d25a2a88d1df6d779924898efe7ac46edbedb9ceb71b99bd2417447d822f2b,\n             9232a27ba220391779f5962f8d639de4.5ef350c034768aaaa985c4f9f33127fbe32f6dd38f333cde68119d1f277367cd,\n             NULL,\n             usf_gl_ind,\n             ec_st_grs_sls_extnd,\n             NULL,\n             ec_na_grs_sls_extnd,\n             NULL,\n             ec_st_grs_sls_extnd_dnmtr,\n             NULL,\n             ec_na_grs_sls_extnd_dnmtr,\n             NULL\n        FROM (  SELECT e9a95106e01380a7834d36560e919770.852fa1e9f02f1ca2c75837f7146b2381,\n                       e9a95106e01380a7834d36560e919770.839c4ffb4bfaae1bb58eab4dee67d96a,\n                       e9a95106e01380a7834d36560e919770.7f599f836c449bebb92bb9757e86c603,\n                       NVL(e9a95106e01380a7834d36560e919770.a2b201123c685e8cc48b5468cb4a449361bbd7bc0d2d67c7d7b11cb0a8d18d03, e9a95106e01380a7834d36560e919770.839c4ffb4bfaae1bb58eab4dee67d96a) sls_revenue_div_nbr,\n                       DECODE(e472b097974b0d6a9a7d2ed170324906.89f3df82917b692fe64dca942d924e7c, 97, 'Y', 'N') admn_flg,\n                       COUNT(DISTINCT (CASE\n                                          WHEN e9a95106e01380a7834d36560e919770.26ac88e7ae671a1b22c14c2fce77aa2d = 'RT'\n                                           AND e472b097974b0d6a9a7d2ed170324906.89f3df82917b692fe64dca942d924e7c <> 97 THEN\n                                             e9a95106e01380a7834d36560e919770.839c4ffb4bfaae1bb58eab4dee67d96a || e9a95106e01380a7834d36560e919770.852fa1e9f02f1ca2c75837f7146b2381 || e9a95106e01380a7834d36560e919770.f5dd4374a3e3af6a775cb6d6b22e8162 || e9a95106e01380a7834d36560e919770.faaaf9cbe8897987592d529a771bbc17 || e9a95106e01380a7834d36560e919770.c4ffe3bd27523a268da639921856c18e\n                                          ELSE\n                                             NULL\n                                       END))\n                          drop_cnt,\n                       SUM(NVL(e9a95106e01380a7834d36560e919770.2ee1400a0150f0b220dd7bd6268d1e66, 0)) grs_sls_extnd,\n                       SUM(NVL(e9a95106e01380a7834d36560e919770.ccf8d88f2d37f3171da2121ab22e9330, 0)) unfrm_qty_ship,\n                       SUM(NVL(e9a95106e01380a7834d36560e919770.1afca342ab89e5b8c65c6c4c634b2186, 0)) actl_gp,\n                       SUM(NVL(e9a95106e01380a7834d36560e919770.bc85f0acd4f5b2becdd7efc34c3a2003, 0)) ttl_alwnc,\n                       SUM(NVL((e9a95106e01380a7834d36560e919770.2ee1400a0150f0b220dd7bd6268d1e66 - e9a95106e01380a7834d36560e919770.c6c7cc45578c678907522e08bb04a4ca) - (CASE WHEN e9a95106e01380a7834d36560e919770.487c194c34aee6c67551aa2cdd2358ace32f6dd38f333cde68119d1f277367cd = 'P' THEN NVL(e9a95106e01380a7834d36560e919770.d206d123f59f85e26ec113e33b465295,0) ELSE 0 END) + (e9a95106e01380a7834d36560e919770.b7982b81d447f11a0953881190e528cae32f6dd38f333cde68119d1f277367cd), 0)) grs_tgp,\n                       SUM(NVL(\n                              grs_sls_extnd\n                              + (CASE\n                                    WHEN before_price_ac_ind <> 'Y'\n                                     AND ar_gl_acct BETWEEN l_net_sls_ar_gl_lwr_lmt AND l_net_sls_ar_gl_upr_lmt THEN\n                                       (  NVL(prod_alw, 0)\n                                        + NVL(prod_chrg, 0)\n                                        + NVL(non_prod_alwnc, 0)\n                                        + NVL(non_prod_chrg, 0))\n                                    ELSE\n                                       0\n                                 END)\n                              - (  NVL(rbt_loc_accrl_amt, 0)\n                                 + NVL(rbt_natl_accrl_amt, 0)\n                                 + NVL(rbt_loc_exp_amt, 0)\n                                 + NVL(rbt_natl_exp_amt, 0)),\n                              0))\n                          net_sls,\n                       SUM(NVL(e9a95106e01380a7834d36560e919770.2ee1400a0150f0b220dd7bd6268d1e66, 0)\n                           + CASE\n                                WHEN e9a95106e01380a7834d36560e919770.6363e9ad7bc2d03871ced34810bbcc9cde922b42cda877bb335f20b7c10e0802 <> 'Y'\n                                 AND ar_gl_acct BETWEEN l_net_sls_ar_gl_lwr_lmt AND l_net_sls_ar_gl_upr_lmt THEN\n                                   (  NVL(e9a95106e01380a7834d36560e919770.63a91e2fd122990392b8c1467a67b61e, 0)\n                                    + NVL(e9a95106e01380a7834d36560e919770.f4684b698d1e8edd11bf71d8eac02595, 0)\n                                    + NVL(e9a95106e01380a7834d36560e919770.2dfeefdbbdd44f6feceb5ad393352003, 0)\n                                    + NVL(e9a95106e01380a7834d36560e919770.bd428d343074503f124765bf6dd4405a, 0))\n                                ELSE\n                                   0\n                             END\n                           - (  NVL(e9a95106e01380a7834d36560e919770.5a946c48d4cb9b1b6880bf6386e276781d731bbdc4e3fb69a854112d4982eb99, 0)\n                              + NVL(e9a95106e01380a7834d36560e919770.bb26587da7cde1ca1883d4ac6949a349, 0)\n                              + NVL(e9a95106e01380a7834d36560e919770.6ec51d00c0df5a2c35ea4dc79b992a0ef4147ca167a57859c2f78f7521e7a9a8, 0)\n                              + NVL(e9a95106e01380a7834d36560e919770.d2a9879c73e438cd42a66e4ee567caf5e32f6dd38f333cde68119d1f277367cd, 0))\n                           - e9a95106e01380a7834d36560e919770.c6c7cc45578c678907522e08bb04a4ca\n                           + e9a95106e01380a7834d36560e919770.b7982b81d447f11a0953881190e528cae32f6dd38f333cde68119d1f277367cd\n                           + CASE\n                                WHEN e9a95106e01380a7834d36560e919770.6363e9ad7bc2d03871ced34810bbcc9cde922b42cda877bb335f20b7c10e0802 <> 'Y'\n                                 AND ar_gl_acct BETWEEN l_cogs_ar_gl_lwr_lmt AND l_cogs_ar_gl_upr_lmt THEN\n                                   (  NVL(e9a95106e01380a7834d36560e919770.63a91e2fd122990392b8c1467a67b61e, 0)\n                                    + NVL(e9a95106e01380a7834d36560e919770.f4684b698d1e8edd11bf71d8eac02595, 0)\n                                    + NVL(e9a95106e01380a7834d36560e919770.2dfeefdbbdd44f6feceb5ad393352003, 0)\n                                    + NVL(e9a95106e01380a7834d36560e919770.bd428d343074503f124765bf6dd4405a, 0))\n                                ELSE\n                                   0\n                             END)\n                          net_tgp,\n                       SUM(NVL(dwa_cost_extnd, 0)) dwa_cost_extnd,\n                       SUM(NVL(rbt_loc_accrl_amt, 0)) rbt_loc_accrl_amt,\n                       SUM(NVL(rbt_natl_accrl_amt, 0)) rbt_natl_accrl_amt,\n                       SUM(NVL(rbt_loc_exp_amt, 0)) rbt_loc_exp_amt,\n                       SUM(NVL(rbt_natl_exp_amt, 0)) rbt_natl_exp_amt,\n                       SUM(NVL(e9a95106e01380a7834d36560e919770.e2657ceeba5b709bafb65e0820feb4e2b6e1b396dbe14782b1b65b60d5d80e45, 0)) ttl_int_vndr_fnd_dvt,\n                       SUM(NVL(extnd_fctr, 0) * NVL(comm_bsis_amt, 0)) comm_bsis_amt_extnd,\n                       SUM(\n                          CASE WHEN (e9a95106e01380a7834d36560e919770.69cc3d229f9a1af0e9235eb598b0b176 = 'DEV') THEN (e9a95106e01380a7834d36560e919770.2177cea9b358aa31faa3305994c025bb000751f5aaa607380a5ba46385b2c0ee - e9a95106e01380a7834d36560e919770.2ee1400a0150f0b220dd7bd6268d1e66) ELSE 0 END)\n                          dond,\n                       SUM(NVL(e9a95106e01380a7834d36560e919770.b7982b81d447f11a0953881190e528cae32f6dd38f333cde68119d1f277367cd, 0)) ttl_vndr_fnd_dvt,\n                       SUM(CASE\n                              WHEN NVL(e9a95106e01380a7834d36560e919770.d1ce6707c3d1cc0e57096fdc21a5e64f, 0) = 0\n                               AND NOT (  NVL(e9a95106e01380a7834d36560e919770.2ee1400a0150f0b220dd7bd6268d1e66, 0)\n                                        - NVL(e9a95106e01380a7834d36560e919770.c6c7cc45578c678907522e08bb04a4ca, 0)\n                                        - CASE WHEN e9a95106e01380a7834d36560e919770.487c194c34aee6c67551aa2cdd2358ace32f6dd38f333cde68119d1f277367cd = 'P' THEN NVL(e9a95106e01380a7834d36560e919770.d206d123f59f85e26ec113e33b465295,0) ELSE 0 END\n                                        + NVL(e9a95106e01380a7834d36560e919770.b7982b81d447f11a0953881190e528cae6795cb2e88838b630b499dd5cc5b881, 0) < 0\n                                    AND e9a95106e01380a7834d36560e919770.a00b7aac034b1de6ebfabe4a7097af1b3c072b0281819f75f19257cd7009a1b3 IN ('8', '9')) \n                               AND NOT NVL(e9a95106e01380a7834d36560e919770.e2657ceeba5b709bafb65e0820feb4e2e71d6e15d5f960146139766d193d0f98, 0) > 0 \n                               AND NVL(e9a95106e01380a7834d36560e919770.2ee1400a0150f0b220dd7bd6268d1e66, 0) + NVL(e9a95106e01380a7834d36560e919770.b7982b81d447f11a0953881190e528cae6795cb2e88838b630b499dd5cc5b881, 0) <=\n                                      NVL(e9a95106e01380a7834d36560e919770.2177cea9b358aa31faa3305994c025bb000751f5aaa607380a5ba46385b2c0ee, 0)\n                               AND NVL(e9a95106e01380a7834d36560e919770.210f742c7a4e17979d08976db76abf6f, 'X') = 'F' THEN\n                                 CASE\n                                    WHEN e9a95106e01380a7834d36560e919770.c2b9ebe664db8cfc1f7a702af0630a5b = 'IND' THEN\n                                         NVL(e9a95106e01380a7834d36560e919770.2177cea9b358aa31faa3305994c025bb000751f5aaa607380a5ba46385b2c0ee, 0)\n                                       - NVL(e9a95106e01380a7834d36560e919770.2ee1400a0150f0b220dd7bd6268d1e66, 0)\n                                       - NVL(e9a95106e01380a7834d36560e919770.b7982b81d447f11a0953881190e528cae6795cb2e88838b630b499dd5cc5b881, 0)\n                                    WHEN e9a95106e01380a7834d36560e919770.c2b9ebe664db8cfc1f7a702af0630a5b <> 'IND'\n                                     AND   NVL(e9a95106e01380a7834d36560e919770.2ee1400a0150f0b220dd7bd6268d1e66, 0)\n                                         - NVL(e9a95106e01380a7834d36560e919770.c6c7cc45578c678907522e08bb04a4ca, 0)\n                                         - CASE WHEN e9a95106e01380a7834d36560e919770.487c194c34aee6c67551aa2cdd2358ace32f6dd38f333cde68119d1f277367cd = 'P' THEN NVL(e9a95106e01380a7834d36560e919770.d206d123f59f85e26ec113e33b465295,0) ELSE 0 END\n                                         + NVL(e9a95106e01380a7834d36560e919770.b7982b81d447f11a0953881190e528cae6795cb2e88838b630b499dd5cc5b881, 0) < 0 THEN\n                                       ABS(  NVL(e9a95106e01380a7834d36560e919770.2ee1400a0150f0b220dd7bd6268d1e66, 0)\n                                           - NVL(e9a95106e01380a7834d36560e919770.c6c7cc45578c678907522e08bb04a4ca, 0)\n                                           - CASE WHEN e9a95106e01380a7834d36560e919770.487c194c34aee6c67551aa2cdd2358ace32f6dd38f333cde68119d1f277367cd = 'P' THEN NVL(e9a95106e01380a7834d36560e919770.d206d123f59f85e26ec113e33b465295,0) ELSE 0 END\n                                           + NVL(e9a95106e01380a7834d36560e919770.b7982b81d447f11a0953881190e528cae6795cb2e88838b630b499dd5cc5b881, 0))\n                                    ELSE\n                                       0\n                                 END\n                              ELSE\n                                 0\n                           END)\n                          fixed_sell,\n                       SUM(CASE\n                              WHEN NVL(e9a95106e01380a7834d36560e919770.d1ce6707c3d1cc0e57096fdc21a5e64f, 0) = 0\n                               AND NOT (  NVL(e9a95106e01380a7834d36560e919770.2ee1400a0150f0b220dd7bd6268d1e66, 0)\n                                        - NVL(e9a95106e01380a7834d36560e919770.c6c7cc45578c678907522e08bb04a4ca, 0)\n                                        - CASE WHEN e9a95106e01380a7834d36560e919770.487c194c34aee6c67551aa2cdd2358ace32f6dd38f333cde68119d1f277367cd = 'P' THEN NVL(e9a95106e01380a7834d36560e919770.d206d123f59f85e26ec113e33b465295,0) ELSE 0 END\n                                        + NVL(e9a95106e01380a7834d36560e919770.b7982b81d447f11a0953881190e528cae6795cb2e88838b630b499dd5cc5b881, 0) < 0\n                                    AND e9a95106e01380a7834d36560e919770.a00b7aac034b1de6ebfabe4a7097af1b3c072b0281819f75f19257cd7009a1b3 IN ('8', '9')) \n                               AND NOT NVL(e9a95106e01380a7834d36560e919770.e2657ceeba5b709bafb65e0820feb4e2e71d6e15d5f960146139766d193d0f98, 0) > 0 \n                               AND NOT (NVL(e9a95106e01380a7834d36560e919770.2ee1400a0150f0b220dd7bd6268d1e66, 0) + NVL(e9a95106e01380a7834d36560e919770.b7982b81d447f11a0953881190e528cae6795cb2e88838b630b499dd5cc5b881, 0) <=\n                                           NVL(e9a95106e01380a7834d36560e919770.2177cea9b358aa31faa3305994c025bb000751f5aaa607380a5ba46385b2c0ee, 0)\n                                    AND NVL(e9a95106e01380a7834d36560e919770.210f742c7a4e17979d08976db76abf6f, 'X') = 'F'\n                                    AND (e9a95106e01380a7834d36560e919770.c2b9ebe664db8cfc1f7a702af0630a5b = 'IND'\n                                      OR   NVL(e9a95106e01380a7834d36560e919770.2ee1400a0150f0b220dd7bd6268d1e66, 0)\n                                         - NVL(e9a95106e01380a7834d36560e919770.c6c7cc45578c678907522e08bb04a4ca, 0)\n                                         - CASE WHEN e9a95106e01380a7834d36560e919770.487c194c34aee6c67551aa2cdd2358ace32f6dd38f333cde68119d1f277367cd = 'P' THEN NVL(e9a95106e01380a7834d36560e919770.d206d123f59f85e26ec113e33b465295,0) ELSE 0 END\n                                         + NVL(e9a95106e01380a7834d36560e919770.b7982b81d447f11a0953881190e528cae6795cb2e88838b630b499dd5cc5b881, 0) < 0)) \n                               AND NOT (NVL(e9a95106e01380a7834d36560e919770.2ee1400a0150f0b220dd7bd6268d1e66, 0) + NVL(e9a95106e01380a7834d36560e919770.b7982b81d447f11a0953881190e528cae6795cb2e88838b630b499dd5cc5b881, 0) <=\n                                           NVL(e9a95106e01380a7834d36560e919770.2177cea9b358aa31faa3305994c025bb000751f5aaa607380a5ba46385b2c0ee, 0)\n                                    AND e9a95106e01380a7834d36560e919770.405eb70497393d739ad0b0163f59beab IS NOT NULL) \n                               AND NOT (e9a95106e01380a7834d36560e919770.69cc3d229f9a1af0e9235eb598b0b176 = 'DEV') \n                               AND NOT (e9a95106e01380a7834d36560e919770.69cc3d229f9a1af0e9235eb598b0b176 = 'CBA') \n                               AND e9a95106e01380a7834d36560e919770.370a5aec6c948b64a7638f194c6ea1a7 = 3\n                               AND e9a95106e01380a7834d36560e919770.ccc371b06f1e0daed88f223211b2e790 = 'N'\n                               AND NVL(e9a95106e01380a7834d36560e919770.2ee1400a0150f0b220dd7bd6268d1e66, 0) - NVL(e9a95106e01380a7834d36560e919770.c6c7cc45578c678907522e08bb04a4ca, 0) - (CASE WHEN e9a95106e01380a7834d36560e919770.487c194c34aee6c67551aa2cdd2358ace32f6dd38f333cde68119d1f277367cd = 'P' THEN NVL(e9a95106e01380a7834d36560e919770.d206d123f59f85e26ec113e33b465295,0) ELSE 0 END) + NVL(e9a95106e01380a7834d36560e919770.b7982b81d447f11a0953881190e528cae6795cb2e88838b630b499dd5cc5b881, 0) < 0\n                               AND e9a95106e01380a7834d36560e919770.677b20030e97fe7a072c96e3023ab27b75a332bf028585250008d9183409dc25 IN ('D', 'F') THEN\n                                 ABS(NVL(e9a95106e01380a7834d36560e919770.2ee1400a0150f0b220dd7bd6268d1e66, 0) - NVL(e9a95106e01380a7834d36560e919770.c6c7cc45578c678907522e08bb04a4ca, 0) - (CASE WHEN e9a95106e01380a7834d36560e919770.487c194c34aee6c67551aa2cdd2358ace32f6dd38f333cde68119d1f277367cd = 'P' THEN NVL(e9a95106e01380a7834d36560e919770.d206d123f59f85e26ec113e33b465295,0) ELSE 0 END) + NVL(e9a95106e01380a7834d36560e919770.b7982b81d447f11a0953881190e528cae6795cb2e88838b630b499dd5cc5b881, 0))\n                              ELSE\n                                 0\n                           END)\n                          n_prime_sis,\n                       SUM(CASE\n                              WHEN NVL(e9a95106e01380a7834d36560e919770.d1ce6707c3d1cc0e57096fdc21a5e64f, 0) = 0\n                               AND NOT (  NVL(e9a95106e01380a7834d36560e919770.2ee1400a0150f0b220dd7bd6268d1e66, 0)\n                                        - NVL(e9a95106e01380a7834d36560e919770.c6c7cc45578c678907522e08bb04a4ca, 0)\n                                        - CASE WHEN e9a95106e01380a7834d36560e919770.487c194c34aee6c67551aa2cdd2358ace32f6dd38f333cde68119d1f277367cd = 'P' THEN NVL(e9a95106e01380a7834d36560e919770.d206d123f59f85e26ec113e33b465295,0) ELSE 0 END\n                                        + NVL(e9a95106e01380a7834d36560e919770.b7982b81d447f11a0953881190e528cae6795cb2e88838b630b499dd5cc5b881, 0) < 0\n                                    AND e9a95106e01380a7834d36560e919770.a00b7aac034b1de6ebfabe4a7097af1b3c072b0281819f75f19257cd7009a1b3 IN ('8', '9')) \n                               AND NOT NVL(e9a95106e01380a7834d36560e919770.e2657ceeba5b709bafb65e0820feb4e2e71d6e15d5f960146139766d193d0f98, 0) > 0 \n                               AND NOT (NVL(e9a95106e01380a7834d36560e919770.2ee1400a0150f0b220dd7bd6268d1e66, 0) + NVL(e9a95106e01380a7834d36560e919770.b7982b81d447f11a0953881190e528cae6795cb2e88838b630b499dd5cc5b881, 0) <=\n                                           NVL(e9a95106e01380a7834d36560e919770.2177cea9b358aa31faa3305994c025bb000751f5aaa607380a5ba46385b2c0ee, 0)\n                                    AND NVL(e9a95106e01380a7834d36560e919770.210f742c7a4e17979d08976db76abf6f, 'X') = 'F'\n                                    AND (e9a95106e01380a7834d36560e919770.c2b9ebe664db8cfc1f7a702af0630a5b = 'IND'\n                                      OR   NVL(e9a95106e01380a7834d36560e919770.2ee1400a0150f0b220dd7bd6268d1e66, 0)\n                                         - NVL(e9a95106e01380a7834d36560e919770.c6c7cc45578c678907522e08bb04a4ca, 0)\n                                         - CASE WHEN e9a95106e01380a7834d36560e919770.487c194c34aee6c67551aa2cdd2358ace32f6dd38f333cde68119d1f277367cd = 'P' THEN NVL(e9a95106e01380a7834d36560e919770.d206d123f59f85e26ec113e33b465295,0) ELSE 0 END\n                                         + NVL(e9a95106e01380a7834d36560e919770.b7982b81d447f11a0953881190e528cae6795cb2e88838b630b499dd5cc5b881, 0) < 0)) \n                               AND NVL(e9a95106e01380a7834d36560e919770.2ee1400a0150f0b220dd7bd6268d1e66, 0) + NVL(e9a95106e01380a7834d36560e919770.b7982b81d447f11a0953881190e528cae6795cb2e88838b630b499dd5cc5b881, 0) <=\n                                      NVL(e9a95106e01380a7834d36560e919770.2177cea9b358aa31faa3305994c025bb000751f5aaa607380a5ba46385b2c0ee, 0)\n                               AND e9a95106e01380a7834d36560e919770.405eb70497393d739ad0b0163f59beab IS NOT NULL THEN\n                                   NVL(e9a95106e01380a7834d36560e919770.2177cea9b358aa31faa3305994c025bb000751f5aaa607380a5ba46385b2c0ee, 0)\n                                 - NVL(e9a95106e01380a7834d36560e919770.2ee1400a0150f0b220dd7bd6268d1e66, 0)\n                                 - NVL(e9a95106e01380a7834d36560e919770.b7982b81d447f11a0953881190e528cae6795cb2e88838b630b499dd5cc5b881, 0)\n                              ELSE\n                                 0\n                           END)\n                          prc_apprvl,\n                       SUM(CASE\n                              WHEN NVL(e9a95106e01380a7834d36560e919770.d1ce6707c3d1cc0e57096fdc21a5e64f, 0) = 0\n                               AND NVL(e9a95106e01380a7834d36560e919770.2ee1400a0150f0b220dd7bd6268d1e66, 0) - NVL(e9a95106e01380a7834d36560e919770.c6c7cc45578c678907522e08bb04a4ca, 0) - (CASE WHEN e9a95106e01380a7834d36560e919770.487c194c34aee6c67551aa2cdd2358ace32f6dd38f333cde68119d1f277367cd = 'P' THEN NVL(e9a95106e01380a7834d36560e919770.d206d123f59f85e26ec113e33b465295,0) ELSE 0 END) + NVL(e9a95106e01380a7834d36560e919770.b7982b81d447f11a0953881190e528cae6795cb2e88838b630b499dd5cc5b881, 0) < 0\n                               AND e9a95106e01380a7834d36560e919770.a00b7aac034b1de6ebfabe4a7097af1b3c072b0281819f75f19257cd7009a1b3 IN ('8', '9') THEN\n                                 ABS(NVL(e9a95106e01380a7834d36560e919770.2ee1400a0150f0b220dd7bd6268d1e66, 0) - NVL(e9a95106e01380a7834d36560e919770.c6c7cc45578c678907522e08bb04a4ca, 0) - (CASE WHEN e9a95106e01380a7834d36560e919770.487c194c34aee6c67551aa2cdd2358ace32f6dd38f333cde68119d1f277367cd = 'P' THEN NVL(e9a95106e01380a7834d36560e919770.d206d123f59f85e26ec113e33b465295,0) ELSE 0 END) + NVL(e9a95106e01380a7834d36560e919770.b7982b81d447f11a0953881190e528cae6795cb2e88838b630b499dd5cc5b881, 0))\n                              ELSE\n                                 0\n                           END)\n                          dwo,\n                       SUM(CASE\n                              WHEN NVL(e9a95106e01380a7834d36560e919770.d1ce6707c3d1cc0e57096fdc21a5e64f, 0) = 0\n                               AND NOT (  NVL(e9a95106e01380a7834d36560e919770.2ee1400a0150f0b220dd7bd6268d1e66, 0)\n                                        - NVL(e9a95106e01380a7834d36560e919770.c6c7cc45578c678907522e08bb04a4ca, 0)\n                                        - CASE WHEN e9a95106e01380a7834d36560e919770.487c194c34aee6c67551aa2cdd2358ace32f6dd38f333cde68119d1f277367cd = 'P' THEN NVL(e9a95106e01380a7834d36560e919770.d206d123f59f85e26ec113e33b465295,0) ELSE 0 END\n                                        + NVL(e9a95106e01380a7834d36560e919770.b7982b81d447f11a0953881190e528cae6795cb2e88838b630b499dd5cc5b881, 0) < 0\n                                    AND e9a95106e01380a7834d36560e919770.a00b7aac034b1de6ebfabe4a7097af1b3c072b0281819f75f19257cd7009a1b3 IN ('8', '9')) \n                               AND ((NVL(e9a95106e01380a7834d36560e919770.e2657ceeba5b709bafb65e0820feb4e2e71d6e15d5f960146139766d193d0f98, 0) > 0) \n                                 OR (NVL(e9a95106e01380a7834d36560e919770.2ee1400a0150f0b220dd7bd6268d1e66, 0) + NVL(e9a95106e01380a7834d36560e919770.b7982b81d447f11a0953881190e528cae6795cb2e88838b630b499dd5cc5b881, 0) <=\n                                        NVL(e9a95106e01380a7834d36560e919770.2177cea9b358aa31faa3305994c025bb000751f5aaa607380a5ba46385b2c0ee, 0)\n                                 AND NVL(e9a95106e01380a7834d36560e919770.210f742c7a4e17979d08976db76abf6f, 'X') = 'F'\n                                 AND (e9a95106e01380a7834d36560e919770.c2b9ebe664db8cfc1f7a702af0630a5b = 'IND'\n                                   OR NVL(e9a95106e01380a7834d36560e919770.2ee1400a0150f0b220dd7bd6268d1e66, 0) - NVL(e9a95106e01380a7834d36560e919770.c6c7cc45578c678907522e08bb04a4ca, 0) - (CASE WHEN e9a95106e01380a7834d36560e919770.487c194c34aee6c67551aa2cdd2358ace32f6dd38f333cde68119d1f277367cd = 'P' THEN NVL(e9a95106e01380a7834d36560e919770.d206d123f59f85e26ec113e33b465295,0) ELSE 0 END) + NVL(e9a95106e01380a7834d36560e919770.b7982b81d447f11a0953881190e528cae6795cb2e88838b630b499dd5cc5b881, 0) <\n                                         0)) \n                                 OR (NVL(e9a95106e01380a7834d36560e919770.2ee1400a0150f0b220dd7bd6268d1e66, 0) + NVL(e9a95106e01380a7834d36560e919770.b7982b81d447f11a0953881190e528cae6795cb2e88838b630b499dd5cc5b881, 0) <=\n                                        NVL(e9a95106e01380a7834d36560e919770.2177cea9b358aa31faa3305994c025bb000751f5aaa607380a5ba46385b2c0ee, 0)\n                                 AND e9a95106e01380a7834d36560e919770.405eb70497393d739ad0b0163f59beab IS NOT NULL) \n                                 OR e9a95106e01380a7834d36560e919770.69cc3d229f9a1af0e9235eb598b0b176 = 'DEV' \n                                 OR e9a95106e01380a7834d36560e919770.69cc3d229f9a1af0e9235eb598b0b176 = 'CBA' \n                                 OR (e9a95106e01380a7834d36560e919770.370a5aec6c948b64a7638f194c6ea1a7 = 3\n                                 AND e9a95106e01380a7834d36560e919770.ccc371b06f1e0daed88f223211b2e790 = 'N'\n                                 AND NVL(e9a95106e01380a7834d36560e919770.2ee1400a0150f0b220dd7bd6268d1e66, 0) - NVL(e9a95106e01380a7834d36560e919770.c6c7cc45578c678907522e08bb04a4ca, 0) - (CASE WHEN e9a95106e01380a7834d36560e919770.487c194c34aee6c67551aa2cdd2358ace32f6dd38f333cde68119d1f277367cd = 'P' THEN NVL(e9a95106e01380a7834d36560e919770.d206d123f59f85e26ec113e33b465295,0) ELSE 0 END) + NVL(e9a95106e01380a7834d36560e919770.b7982b81d447f11a0953881190e528cae6795cb2e88838b630b499dd5cc5b881, 0) <\n                                        0\n                                 AND e9a95106e01380a7834d36560e919770.677b20030e97fe7a072c96e3023ab27b75a332bf028585250008d9183409dc25 IN ('D', 'F')) \n                                                                        ) THEN\n                                 e9a95106e01380a7834d36560e919770.ccf8d88f2d37f3171da2121ab22e9330\n                              ELSE\n                                 0\n                           END)\n                          invst_cs_prtcptn,\n                       SUM(NVL((CASE\n                                   WHEN before_price_ac_ind <> 'Y'\n                                    AND ar_gl_acct BETWEEN l_net_sls_ar_gl_lwr_lmt AND l_net_sls_ar_gl_upr_lmt THEN\n                                      NVL(non_prod_chrg, 0)\n                                   ELSE\n                                      0\n                                END),\n                               0))\n                          net_non_prod_chrg,\n                       SUM(NVL((CASE\n                                   WHEN before_price_ac_ind <> 'Y'\n                                    AND ar_gl_acct BETWEEN l_net_sls_ar_gl_lwr_lmt AND l_net_sls_ar_gl_upr_lmt THEN\n                                      NVL(prod_chrg, 0)\n                                   ELSE\n                                      0\n                                END),\n                               0))\n                          net_prod_chrg,\n                       SUM(NVL((CASE\n                                   WHEN before_price_ac_ind <> 'Y'\n                                    AND ar_gl_acct BETWEEN l_net_sls_ar_gl_lwr_lmt AND l_net_sls_ar_gl_upr_lmt THEN\n                                      NVL(non_prod_alwnc, 0)\n                                   ELSE\n                                      0\n                                END),\n                               0))\n                          net_non_prod_alwnc,\n                       SUM(NVL((CASE\n                                   WHEN before_price_ac_ind <> 'Y'\n                                    AND ar_gl_acct BETWEEN l_net_sls_ar_gl_lwr_lmt AND l_net_sls_ar_gl_upr_lmt THEN\n                                      NVL(prod_alw, 0)\n                                   ELSE\n                                      0\n                                END),\n                               0))\n                          net_prod_alwnc,\n                       MAX(e9a95106e01380a7834d36560e919770.f5dd4374a3e3af6a775cb6d6b22e8162) latest_prcs_dt,\n                       MAX(e9a95106e01380a7834d36560e919770.6aad564fb2381f50b58f8d5a0fb08cbd) orig_ldr_tm,\n                       SUM(NVL(brk_srchrg, 0)) brk_srchrg,\n                       SUM(NVL(cde, 0)) cde,\n                       SUM(NVL(prod_sls_tax, 0)) prod_sls_tax,\n                       SUM(CASE\n                              WHEN e9a95106e01380a7834d36560e919770.6363e9ad7bc2d03871ced34810bbcc9cde922b42cda877bb335f20b7c10e0802 <> 'Y'\n                               AND ar_gl_acct BETWEEN l_cogs_ar_gl_lwr_lmt AND l_cogs_ar_gl_upr_lmt THEN\n                                 (  NVL(e9a95106e01380a7834d36560e919770.63a91e2fd122990392b8c1467a67b61e, 0)\n                                  + NVL(e9a95106e01380a7834d36560e919770.f4684b698d1e8edd11bf71d8eac02595, 0)\n                                  + NVL(e9a95106e01380a7834d36560e919770.2dfeefdbbdd44f6feceb5ad393352003, 0)\n                                  + NVL(e9a95106e01380a7834d36560e919770.bd428d343074503f124765bf6dd4405a, 0))\n                              ELSE\n                                 0\n                           END)\n                          cogs_alw_chrg,\n                       SUM(NVL(prod_alw, 0)) prod_alw,\n                       SUM(NVL(prod_chrg, 0)) prod_chrg,\n                       SUM(NVL(non_prod_alwnc, 0)) non_prod_alwnc,\n                       SUM(NVL(non_prod_chrg, 0)) non_prod_chrg,\n                       SUM(NVL(actl_cst, 0)) actl_cst,\n                       SUM(NVL(ap_cost, 0)) ap_cost,\n                       SUM(NVL(ap_gain, 0)) ap_gain,\n                       SUM(NVL(frght_cost, 0)) frght_cost,\n                       SUM(NVL(inside_pad, 0)) inside_pad,\n                       SUM(NVL(lic_prod_extnd, 0)) lic_prod_extnd,\n                       SUM(NVL(lic_tot_extnd, 0)) lic_tot_extnd,\n                       SUM(NVL(rep_cost_extnd, 0)) rep_cost_extnd,\n                       SUM(NVL(mkt_prod_extnd, 0)) mkt_prod_extnd,\n                       SUM(NVL(mkt_tot_extnd, 0)) mkt_tot_extnd,\n                       SUM(NVL(orig_dwa_cost_extnd, 0)) orig_dwa_cost_extnd,\n                       SUM(NVL(srchrg, 0)) srchrg,\n                       COUNT(\n                          DISTINCT (CASE\n                                       WHEN e472b097974b0d6a9a7d2ed170324906.89f3df82917b692fe64dca942d924e7c <= l_net_acct_pim_suprcls_id THEN e472b097974b0d6a9a7d2ed170324906.89f3df82917b692fe64dca942d924e7c\n                                       ELSE NULL\n                                    END))\n                          cat_sold,\n                       SUM(CASE\n                              WHEN trans_typ = 'CD'\n                               AND prod_alwnc_cd IS NULL\n                               AND prod_chrg_cd IS NULL THEN\n                                 1\n                              ELSE\n                                 0\n                           END)\n                          cd_ln_cnt,\n                       MAX(CASE WHEN e9a95106e01380a7834d36560e919770.26ac88e7ae671a1b22c14c2fce77aa2d IN ('RT', 'VS', 'WC') THEN e9a95106e01380a7834d36560e919770.7f599f836c449bebb92bb9757e86c603 ELSE NULL END) net_acct_cust_sk,\n                       COUNT(DISTINCT CASE\n                                         WHEN e9a95106e01380a7834d36560e919770.26ac88e7ae671a1b22c14c2fce77aa2d = 'RT'\n                                          AND e472b097974b0d6a9a7d2ed170324906.89f3df82917b692fe64dca942d924e7c <> 97 THEN\n                                            e9a95106e01380a7834d36560e919770.839c4ffb4bfaae1bb58eab4dee67d96a || e9a95106e01380a7834d36560e919770.852fa1e9f02f1ca2c75837f7146b2381 || e9a95106e01380a7834d36560e919770.f5dd4374a3e3af6a775cb6d6b22e8162 || e9a95106e01380a7834d36560e919770.faaaf9cbe8897987592d529a771bbc17 || e9a95106e01380a7834d36560e919770.be8d7c2ea76d3152927ebf8709ea0326\n                                         ELSE\n                                            NULL\n                                      END)\n                          rt_inv_cnt,\n                       SUM(CASE\n                              WHEN trans_typ = 'RT'\n                               AND prod_alwnc_cd IS NULL\n                               AND prod_chrg_cd IS NULL THEN\n                                 1\n                              ELSE\n                                 0\n                           END)\n                          rt_ln_cnt,\n                       COUNT(DISTINCT CASE\n                                         WHEN e9a95106e01380a7834d36560e919770.26ac88e7ae671a1b22c14c2fce77aa2d = 'VS'\n                                          AND e472b097974b0d6a9a7d2ed170324906.89f3df82917b692fe64dca942d924e7c <> 97 THEN\n                                            e9a95106e01380a7834d36560e919770.839c4ffb4bfaae1bb58eab4dee67d96a || e9a95106e01380a7834d36560e919770.852fa1e9f02f1ca2c75837f7146b2381 || e9a95106e01380a7834d36560e919770.f5dd4374a3e3af6a775cb6d6b22e8162 || e9a95106e01380a7834d36560e919770.faaaf9cbe8897987592d529a771bbc17 || e9a95106e01380a7834d36560e919770.be8d7c2ea76d3152927ebf8709ea0326\n                                         ELSE\n                                            NULL\n                                      END)\n                          vndr_ship_inv_cnt,\n                       SUM(CASE\n                              WHEN trans_typ = 'VS'\n                               AND prod_alwnc_cd IS NULL\n                               AND prod_chrg_cd IS NULL THEN\n                                 1\n                              ELSE\n                                 0\n                           END)\n                          vndr_ship_ln_cnt,\n                       COUNT(DISTINCT CASE\n                                         WHEN e9a95106e01380a7834d36560e919770.26ac88e7ae671a1b22c14c2fce77aa2d = 'WC'\n                                          AND e472b097974b0d6a9a7d2ed170324906.89f3df82917b692fe64dca942d924e7c <> 97 THEN\n                                            e9a95106e01380a7834d36560e919770.839c4ffb4bfaae1bb58eab4dee67d96a || e9a95106e01380a7834d36560e919770.852fa1e9f02f1ca2c75837f7146b2381 || e9a95106e01380a7834d36560e919770.f5dd4374a3e3af6a775cb6d6b22e8162 || e9a95106e01380a7834d36560e919770.faaaf9cbe8897987592d529a771bbc17 || e9a95106e01380a7834d36560e919770.be8d7c2ea76d3152927ebf8709ea0326\n                                         ELSE\n                                            NULL\n                                      END)\n                          wc_inv_cnt,\n                       SUM(CASE\n                              WHEN trans_typ = 'WC'\n                               AND prod_alwnc_cd IS NULL\n                               AND prod_chrg_cd IS NULL THEN\n                                 1\n                              ELSE\n                                 0\n                           END)\n                          wc_ln_cnt,\n                       SUM(NVL(dvt_cost_extnd, 0)) dvt_cost_extnd,\n                       SUM(CASE WHEN e472b097974b0d6a9a7d2ed170324906.c1a0243994c58a08334e325e29a31260 = 2 THEN dvt_cost_extnd ELSE 0 END) eb_dvt_cost_extnd,\n                       SUM(CASE WHEN e472b097974b0d6a9a7d2ed170324906.c1a0243994c58a08334e325e29a31260 = 2 THEN loc_int_dvt ELSE 0 END) eb_loc_int_dvt,\n                       SUM(CASE WHEN e472b097974b0d6a9a7d2ed170324906.c1a0243994c58a08334e325e29a31260 = 2 THEN loc_vndr_fnd_dvt ELSE 0 END) eb_loc_vndr_fnd_dvt,\n                       SUM(CASE WHEN e472b097974b0d6a9a7d2ed170324906.c1a0243994c58a08334e325e29a31260 = 2 THEN natl_int_dvt ELSE 0 END) eb_natl_int_dvt,\n                       SUM(CASE WHEN e472b097974b0d6a9a7d2ed170324906.c1a0243994c58a08334e325e29a31260 = 2 THEN natl_vndr_fnd_dvt ELSE 0 END) eb_natl_vndr_fnd_dvt,\n                       SUM(CASE WHEN e472b097974b0d6a9a7d2ed170324906.c1a0243994c58a08334e325e29a31260 = 2 THEN ttl_dvt ELSE 0 END) eb_ttl_dvt,\n                       SUM(CASE WHEN e472b097974b0d6a9a7d2ed170324906.c1a0243994c58a08334e325e29a31260 = 2 THEN ttl_int_vndr_fnd_dvt ELSE 0 END) eb_ttl_int_vndr_fnd_dvt,\n                       SUM(CASE WHEN e472b097974b0d6a9a7d2ed170324906.c1a0243994c58a08334e325e29a31260 = 2 THEN ttl_vndr_fnd_dvt ELSE 0 END) eb_ttl_vndr_fnd_dvt,\n                       SUM(NVL(loc_int_dvt, 0)) loc_int_dvt,\n                       SUM(NVL(loc_vndr_fnd_dvt, 0)) loc_vndr_fnd_dvt,\n                       SUM(NVL(natl_int_dvt, 0)) natl_int_dvt,\n                       SUM(NVL(natl_vndr_fnd_dvt, 0)) natl_vndr_fnd_dvt,\n                       SUM(NVL(ttl_dvt, 0)) ttl_dvt,\n                       SUM(CASE WHEN e472b097974b0d6a9a7d2ed170324906.c1a0243994c58a08334e325e29a31260 = 2 THEN actl_gp ELSE 0 END) eb_actl_gp,\n                       SUM(CASE WHEN e472b097974b0d6a9a7d2ed170324906.c1a0243994c58a08334e325e29a31260 = 2 THEN inv_gp ELSE 0 END) eb_inv_gp,\n                       SUM(CASE WHEN e472b097974b0d6a9a7d2ed170324906.c1a0243994c58a08334e325e29a31260 = 2 THEN true_gp ELSE 0 END) eb_true_gp,\n                       SUM(NVL(inv_actl_gp, 0)) inv_actl_gp,\n                       SUM(NVL(inv_gp, 0)) inv_gp,\n                       SUM(NVL(lnd_gp, 0)) lnd_gp,\n                       SUM(actl_gp\n                           + CASE\n                                WHEN NVL(before_price_ac_ind, 'N') <> 'Y'\n                                 AND NVL(ar_gl_acct, 0) BETWEEN l_net_sls_ar_gl_lwr_lmt AND l_net_sls_ar_gl_upr_lmt THEN\n                                   NVL(prod_alw, 0) + NVL(prod_chrg, 0) + NVL(non_prod_alwnc, 0) + NVL(non_prod_chrg, 0)\n                                ELSE\n                                   0\n                             END\n                           - (  NVL(rbt_loc_accrl_amt, 0)\n                              + NVL(rbt_loc_exp_amt, 0)\n                              + NVL(rbt_natl_accrl_amt, 0)\n                              + NVL(rbt_natl_exp_amt, 0))\n                           - CASE\n                                WHEN NVL(before_price_ac_ind, 'N') <> 'Y'\n                                 AND NVL(ar_gl_acct, 0) BETWEEN l_cogs_ar_gl_lwr_lmt AND l_cogs_ar_gl_upr_lmt THEN\n                                   NVL(prod_alw, 0) + NVL(prod_chrg, 0) + NVL(non_prod_alwnc, 0) + NVL(non_prod_chrg, 0)\n                                ELSE\n                                   0\n                             END)\n                          net_tagp,\n                       SUM(NVL(true_gp, 0)) true_gp,\n                       SUM(NVL(natl_mrktng_alwnc_pgms, 0)) natl_mrktng_alwnc_pgms,\n                       SUM(CASE WHEN e472b097974b0d6a9a7d2ed170324906.c1a0243994c58a08334e325e29a31260 = 2 THEN natl_mrktng_alwnc_pgms ELSE 0 END) eb_natl_mrktng_alwnc_pgms,\n                       SUM(CASE WHEN e472b097974b0d6a9a7d2ed170324906.c1a0243994c58a08334e325e29a31260 = 2 THEN loc_mrktng_alwnc_pgms ELSE 0 END) eb_loc_mrktng_alwnc_pgms,\n                       SUM(CASE WHEN e472b097974b0d6a9a7d2ed170324906.c1a0243994c58a08334e325e29a31260 = 2 THEN loc_one_tm ELSE 0 END) eb_loc_one_tm,\n                       SUM(CASE WHEN e472b097974b0d6a9a7d2ed170324906.c1a0243994c58a08334e325e29a31260 = 2 THEN loc_prom_alwnc_pgms ELSE 0 END) eb_loc_prom_alwnc_pgms,\n                       SUM(CASE WHEN e472b097974b0d6a9a7d2ed170324906.c1a0243994c58a08334e325e29a31260 = 2 THEN natl_one_tm ELSE 0 END) eb_natl_one_tm,\n                       SUM(CASE WHEN e472b097974b0d6a9a7d2ed170324906.c1a0243994c58a08334e325e29a31260 = 2 THEN natl_prom_alwnc_pgms ELSE 0 END) eb_natl_prom_alwnc_pgms,\n                       SUM(CASE WHEN e472b097974b0d6a9a7d2ed170324906.c1a0243994c58a08334e325e29a31260 = 2 THEN ttl_alwnc ELSE 0 END) eb_ttl_alwnc,\n                       SUM(CASE WHEN e472b097974b0d6a9a7d2ed170324906.c1a0243994c58a08334e325e29a31260 = 2 THEN ttl_loc_alwnc ELSE 0 END) eb_ttl_loc_alwnc,\n                       SUM(CASE WHEN e472b097974b0d6a9a7d2ed170324906.c1a0243994c58a08334e325e29a31260 = 2 THEN ttl_natl_alwnc ELSE 0 END) eb_ttl_natl_alwnc,\n                       SUM(NVL(loc_mrktng_alwnc_pgms, 0)) loc_mrktng_alwnc_pgms,\n                       SUM(NVL(loc_one_tm, 0)) loc_one_tm,\n                       SUM(NVL(loc_prom_alwnc_pgms, 0)) loc_prom_alwnc_pgms,\n                       SUM(NVL(natl_one_tm, 0)) natl_one_tm,\n                       SUM(NVL(natl_prom_alwnc_pgms, 0)) natl_prom_alwnc_pgms,\n                       SUM(NVL(ttl_loc_alwnc, 0)) ttl_loc_alwnc,\n                       SUM(NVL(ttl_natl_alwnc, 0)) ttl_natl_alwnc,\n                       SUM(NVL(adj_markout, 0)) adj_markout,\n                       SUM(CASE WHEN e9a95106e01380a7834d36560e919770.26ac88e7ae671a1b22c14c2fce77aa2d = 'CD' THEN unfrm_qty_ship ELSE 0 END) cd_unfrm_qty_ship,\n                       SUM(CASE WHEN e9a95106e01380a7834d36560e919770.26ac88e7ae671a1b22c14c2fce77aa2d = 'CD' THEN qty_ship ELSE 0 END) cd_qty_ship,\n                       SUM(NVL(dry_each, 0)) dry_each,\n                       SUM(NVL(dry_unit, 0)) dry_unit,\n                       SUM(NVL(dry_wt, 0)) dry_wt,\n                       SUM(NVL(each_ord, 0)) each_ord,\n                       SUM(NVL(each_orig, 0)) each_orig,\n                       SUM(NVL(each_rsrv, 0)) each_rsrv,\n                       SUM(NVL(each_ship, 0)) each_ship,\n                       SUM(CASE WHEN e472b097974b0d6a9a7d2ed170324906.c1a0243994c58a08334e325e29a31260 = 2 THEN unfrm_qty_ship ELSE 0 END) eb_unfrm_qty_ship,\n                       SUM(CASE WHEN e472b097974b0d6a9a7d2ed170324906.c1a0243994c58a08334e325e29a31260 = 2 THEN each_ship ELSE 0 END) eb_each_ship,\n                       SUM(CASE WHEN e472b097974b0d6a9a7d2ed170324906.c1a0243994c58a08334e325e29a31260 = 2 THEN net_wt_ship ELSE 0 END) eb_net_wt_ship,\n                       SUM(CASE WHEN e472b097974b0d6a9a7d2ed170324906.c1a0243994c58a08334e325e29a31260 = 2 THEN qty_ship ELSE 0 END) eb_qty_ship,\n                       SUM(CASE WHEN e472b097974b0d6a9a7d2ed170324906.c1a0243994c58a08334e325e29a31260 = 2 THEN unit_ship ELSE 0 END) eb_unit_ship,\n                       SUM(NVL(frz_each, 0)) frz_each,\n                       SUM(NVL(frz_unit, 0)) frz_unit,\n                       SUM(NVL(frz_wt, 0)) frz_wt,\n                       SUM(CASE WHEN NVL(e472b097974b0d6a9a7d2ed170324906.c1a0243994c58a08334e325e29a31260, 1) <> 2 THEN unfrm_qty_ship ELSE 0 END) mb_unfrm_qty_ship,\n                       SUM(NVL(net_wt_ship, 0)) net_wt_ship,\n                       SUM(NVL(qty_dvt, 0)) qty_dvt,\n                       SUM(NVL(qty_markout, 0)) qty_markout,\n                       SUM(NVL(qty_ord, 0)) qty_ord,\n                       SUM(NVL(qty_orig, 0)) qty_orig,\n                       SUM(NVL(qty_rsrv, 0)) qty_rsrv,\n                       SUM(NVL(qty_ship, 0)) qty_ship,\n                       SUM(NVL(qty_subbed, 0)) qty_subbed,\n                       SUM(NVL(rfrgrt_each, 0)) rfrgrt_each,\n                       SUM(NVL(rfrgrt_unit, 0)) rfrgrt_unit,\n                       SUM(NVL(rfrgrt_wt, 0)) rfrgrt_wt,\n                       SUM(CASE WHEN e9a95106e01380a7834d36560e919770.26ac88e7ae671a1b22c14c2fce77aa2d = 'RT' THEN qty_ship ELSE 0 END) rt_qty_ship,\n                       SUM(CASE WHEN e9a95106e01380a7834d36560e919770.26ac88e7ae671a1b22c14c2fce77aa2d = 'RT' THEN unfrm_qty_ship ELSE 0 END) rt_unfrm_qty_ship,\n                       SUM(NVL(unfrm_qty_dvt, 0)) unfrm_qty_dvt,\n                       SUM(NVL(unfrm_qty_markout, 0)) unfrm_qty_markout,\n                       SUM(NVL(unfrm_qty_ord, 0)) unfrm_qty_ord,\n                       SUM(NVL(unfrm_qty_orig, 0)) unfrm_qty_orig,\n                       SUM(NVL(unfrm_qty_rsrv, 0)) unfrm_qty_rsrv,\n                       SUM(NVL(unfrm_qty_subbed, 0)) unfrm_qty_subbed,\n                       SUM(NVL(unit_ord, 0)) unit_ord,\n                       SUM(NVL(unit_orig, 0)) unit_orig,\n                       SUM(NVL(unit_rsrv, 0)) unit_rsrv,\n                       SUM(NVL(unit_ship, 0)) unit_ship,\n                       SUM(CASE WHEN e9a95106e01380a7834d36560e919770.26ac88e7ae671a1b22c14c2fce77aa2d = 'VS' THEN qty_ship ELSE 0 END) vs_qty_ship,\n                       SUM(CASE WHEN e9a95106e01380a7834d36560e919770.26ac88e7ae671a1b22c14c2fce77aa2d = 'VS' THEN unfrm_qty_ship ELSE 0 END) vs_unfrm_qty_ship,\n                       SUM(CASE WHEN e9a95106e01380a7834d36560e919770.26ac88e7ae671a1b22c14c2fce77aa2d = 'WC' THEN unfrm_qty_ship ELSE 0 END) wc_unfrm_qty_ship,\n                       SUM(CASE WHEN e9a95106e01380a7834d36560e919770.26ac88e7ae671a1b22c14c2fce77aa2d = 'WC' THEN qty_ship ELSE 0 END) wc_qty_ship,\n                       SUM(NVL(cmsn_sls_extnd, 0)) cmsn_sls_extnd,\n                       SUM(NVL(cr_memo_dlr, 0)) cr_memo_dlr,\n                       SUM(CASE WHEN e9a95106e01380a7834d36560e919770.26ac88e7ae671a1b22c14c2fce77aa2d = 'CD' THEN grs_sls_extnd ELSE 0 END) cd_grs_sls_extnd,\n                       SUM(CASE WHEN e9a95106e01380a7834d36560e919770.73fc2afbbbce75dfdb12e62a0b628ace in  (select ORD_SRC from de459e2fe7f96e4d958537b31b946b26.957d70e3635c4c5cc9b2dfd7d366f419 where ORD_SRC_GRP = 'CS')\n                        THEN grs_sls_extnd ELSE 0 END) cs_grs_sls_extnd, \n                       SUM(CASE WHEN e9a95106e01380a7834d36560e919770.73fc2afbbbce75dfdb12e62a0b628ace = 'CT' THEN grs_sls_extnd ELSE 0 END) ct_grs_sls_extnd,\n                       SUM(CASE WHEN e9a95106e01380a7834d36560e919770.73fc2afbbbce75dfdb12e62a0b628ace in (select ORD_SRC from de459e2fe7f96e4d958537b31b946b26.957d70e3635c4c5cc9b2dfd7d366f419 where ORD_SRC_GRP = 'EC')\n                        THEN grs_sls_extnd ELSE 0 END) ec_grs_sls_extnd, \n                       SUM(CASE\n                              WHEN e472b097974b0d6a9a7d2ed170324906.c1a0243994c58a08334e325e29a31260 = 2 THEN\n                                 NVL(\n                                    grs_sls_extnd\n                                    + (CASE\n                                          WHEN before_price_ac_ind <> 'Y'\n                                           AND ar_gl_acct BETWEEN l_net_sls_ar_gl_lwr_lmt AND l_net_sls_ar_gl_upr_lmt THEN\n                                             (  NVL(prod_alw, 0)\n                                              + NVL(prod_chrg, 0)\n                                              + NVL(non_prod_alwnc, 0)\n                                              + NVL(non_prod_chrg, 0))\n                                          ELSE\n                                             0\n                                       END)\n                                    - (  NVL(rbt_loc_accrl_amt, 0)\n                                       + NVL(rbt_natl_accrl_amt, 0)\n                                       + NVL(rbt_loc_exp_amt, 0)\n                                       + NVL(rbt_natl_exp_amt, 0)),\n                                    0)\n                              ELSE\n                                 0\n                           END)\n                          eb_net_sls,\n                       SUM(CASE WHEN e472b097974b0d6a9a7d2ed170324906.c1a0243994c58a08334e325e29a31260 = 2 THEN grs_sls_extnd ELSE 0 END) eb_grs_sls_extnd,\n                       SUM(CASE WHEN e9a95106e01380a7834d36560e919770.73fc2afbbbce75dfdb12e62a0b628ace in  (select ORD_SRC from de459e2fe7f96e4d958537b31b946b26.957d70e3635c4c5cc9b2dfd7d366f419 where ORD_SRC_GRP = 'ED')\n                        THEN grs_sls_extnd ELSE 0 END) ed_grs_sls_extnd, \n                       SUM(CASE WHEN e9a95106e01380a7834d36560e919770.73fc2afbbbce75dfdb12e62a0b628ace = 'FS' THEN grs_sls_extnd ELSE 0 END) fs_grs_sls_extnd,\n                       SUM(CASE\n                              WHEN NVL(e472b097974b0d6a9a7d2ed170324906.c1a0243994c58a08334e325e29a31260, 1) <> 2 THEN\n                                 NVL(\n                                    grs_sls_extnd\n                                    + (CASE\n                                          WHEN before_price_ac_ind <> 'Y'\n                                           AND ar_gl_acct BETWEEN l_net_sls_ar_gl_lwr_lmt AND l_net_sls_ar_gl_upr_lmt THEN\n                                             (  NVL(prod_alw, 0)\n                                              + NVL(prod_chrg, 0)\n                                              + NVL(non_prod_alwnc, 0)\n                                              + NVL(non_prod_chrg, 0))\n                                          ELSE\n                                             0\n                                       END)\n                                    - (  NVL(rbt_loc_accrl_amt, 0)\n                                       + NVL(rbt_natl_accrl_amt, 0)\n                                       + NVL(rbt_loc_exp_amt, 0)\n                                       + NVL(rbt_natl_exp_amt, 0)),\n                                    0)\n                              ELSE\n                                 0\n                           END)\n                          mb_net_sls,\n                       SUM(CASE WHEN NVL(e472b097974b0d6a9a7d2ed170324906.c1a0243994c58a08334e325e29a31260, 1) <> 2 THEN grs_sls_extnd ELSE 0 END) mb_grs_sls_extnd,\n                       SUM(CASE WHEN e9a95106e01380a7834d36560e919770.26ac88e7ae671a1b22c14c2fce77aa2d = 'RT' THEN grs_sls_extnd ELSE 0 END) rt_grs_sls_extnd,\n                       SUM(CASE\n                              WHEN e9a95106e01380a7834d36560e919770.26ac88e7ae671a1b22c14c2fce77aa2d = 'RT' THEN\n                                 NVL(\n                                    grs_sls_extnd\n                                    + (CASE\n                                          WHEN before_price_ac_ind <> 'Y'\n                                           AND ar_gl_acct BETWEEN l_net_sls_ar_gl_lwr_lmt AND l_net_sls_ar_gl_upr_lmt THEN\n                                             (  NVL(prod_alw, 0)\n                                              + NVL(prod_chrg, 0)\n                                              + NVL(non_prod_alwnc, 0)\n                                              + NVL(non_prod_chrg, 0))\n                                          ELSE\n                                             0\n                                       END)\n                                    - (  NVL(rbt_loc_accrl_amt, 0)\n                                       + NVL(rbt_natl_accrl_amt, 0)\n                                       + NVL(rbt_loc_exp_amt, 0)\n                                       + NVL(rbt_natl_exp_amt, 0)),\n                                    0)\n                              ELSE\n                                 0\n                           END)\n                          rt_net_sls,\n                       SUM(CASE WHEN e9a95106e01380a7834d36560e919770.73fc2afbbbce75dfdb12e62a0b628ace = 'PT' THEN grs_sls_extnd ELSE 0 END) pt_grs_sls_extnd,\n                       SUM(CASE WHEN e9a95106e01380a7834d36560e919770.26ac88e7ae671a1b22c14c2fce77aa2d = 'VS' THEN grs_sls_extnd ELSE 0 END) vs_grs_sls_extnd,\n                       SUM(CASE WHEN e9a95106e01380a7834d36560e919770.26ac88e7ae671a1b22c14c2fce77aa2d = 'WC' THEN grs_sls_extnd ELSE 0 END) wc_grs_sls_extnd,\n                       COUNT(DISTINCT CASE\n                                         WHEN e9a95106e01380a7834d36560e919770.26ac88e7ae671a1b22c14c2fce77aa2d = 'CC'\n                                          AND e472b097974b0d6a9a7d2ed170324906.89f3df82917b692fe64dca942d924e7c <> 97 THEN\n                                            e9a95106e01380a7834d36560e919770.839c4ffb4bfaae1bb58eab4dee67d96a || e9a95106e01380a7834d36560e919770.852fa1e9f02f1ca2c75837f7146b2381 || e9a95106e01380a7834d36560e919770.f5dd4374a3e3af6a775cb6d6b22e8162 || e9a95106e01380a7834d36560e919770.faaaf9cbe8897987592d529a771bbc17 || e9a95106e01380a7834d36560e919770.be8d7c2ea76d3152927ebf8709ea0326\n                                         ELSE\n                                            NULL\n                                      END)\n                          cc_inv_cnt,\n                       SUM(CASE\n                              WHEN trans_typ = 'CC'\n                               AND prod_alwnc_cd IS NULL\n                               AND prod_chrg_cd IS NULL THEN\n                                 1\n                              ELSE\n                                 0\n                           END)\n                          cc_ln_cnt,\n                       SUM(CASE WHEN e9a95106e01380a7834d36560e919770.26ac88e7ae671a1b22c14c2fce77aa2d = 'CC' THEN unfrm_qty_ship ELSE 0 END) cc_unfrm_qty_ship,\n                       SUM(CASE WHEN e9a95106e01380a7834d36560e919770.26ac88e7ae671a1b22c14c2fce77aa2d = 'CC' THEN qty_ship ELSE 0 END) cc_qty_ship,\n                       SUM(CASE WHEN e9a95106e01380a7834d36560e919770.26ac88e7ae671a1b22c14c2fce77aa2d = 'CC' THEN grs_sls_extnd ELSE 0 END) cc_grs_sls_extnd,\n                       SUM(CASE WHEN e9a95106e01380a7834d36560e919770.73fc2afbbbce75dfdb12e62a0b628ace = 'ST' THEN grs_sls_extnd ELSE 0 END) st_grs_sls_extnd,\n                       SUM(NVL(lnd_actl_gp, 0)) lnd_actl_gp,\n                       SUM(CASE\n                              WHEN NVL(e9a95106e01380a7834d36560e919770.d1ce6707c3d1cc0e57096fdc21a5e64f, 0) = 0\n                               AND NOT (  NVL(e9a95106e01380a7834d36560e919770.2ee1400a0150f0b220dd7bd6268d1e66, 0)\n                                        - NVL(e9a95106e01380a7834d36560e919770.c6c7cc45578c678907522e08bb04a4ca, 0)\n                                        - CASE WHEN e9a95106e01380a7834d36560e919770.487c194c34aee6c67551aa2cdd2358ace32f6dd38f333cde68119d1f277367cd = 'P' THEN NVL(e9a95106e01380a7834d36560e919770.d206d123f59f85e26ec113e33b465295,0) ELSE 0 END\n                                        + NVL(e9a95106e01380a7834d36560e919770.b7982b81d447f11a0953881190e528cae6795cb2e88838b630b499dd5cc5b881, 0) < 0\n                                    AND e9a95106e01380a7834d36560e919770.a00b7aac034b1de6ebfabe4a7097af1b3c072b0281819f75f19257cd7009a1b3 IN ('8', '9')) \n                               AND NVL(e9a95106e01380a7834d36560e919770.e2657ceeba5b709bafb65e0820feb4e2e71d6e15d5f960146139766d193d0f98, 0) > 0 THEN\n                                 NVL(e9a95106e01380a7834d36560e919770.e2657ceeba5b709bafb65e0820feb4e2e71d6e15d5f960146139766d193d0f98, 0)\n                              ELSE\n                                 0\n                           END)\n                          ttl_int_vndr_fnd_dvt_is,\n                       SUM(CASE\n                              WHEN NVL(e9a95106e01380a7834d36560e919770.d1ce6707c3d1cc0e57096fdc21a5e64f, 0) = 0\n                               AND NOT (  NVL(e9a95106e01380a7834d36560e919770.2ee1400a0150f0b220dd7bd6268d1e66, 0)\n                                        - NVL(e9a95106e01380a7834d36560e919770.c6c7cc45578c678907522e08bb04a4ca, 0)\n                                        - CASE WHEN e9a95106e01380a7834d36560e919770.487c194c34aee6c67551aa2cdd2358ace32f6dd38f333cde68119d1f277367cd = 'P' THEN NVL(e9a95106e01380a7834d36560e919770.d206d123f59f85e26ec113e33b465295,0) ELSE 0 END\n                                        + NVL(e9a95106e01380a7834d36560e919770.b7982b81d447f11a0953881190e528cae6795cb2e88838b630b499dd5cc5b881, 0) < 0\n                                    AND e9a95106e01380a7834d36560e919770.a00b7aac034b1de6ebfabe4a7097af1b3c072b0281819f75f19257cd7009a1b3 IN ('8', '9')) \n                               AND NOT NVL(e9a95106e01380a7834d36560e919770.e2657ceeba5b709bafb65e0820feb4e2e71d6e15d5f960146139766d193d0f98, 0) > 0 \n                               AND NOT (NVL(e9a95106e01380a7834d36560e919770.2ee1400a0150f0b220dd7bd6268d1e66, 0) + NVL(e9a95106e01380a7834d36560e919770.b7982b81d447f11a0953881190e528cae6795cb2e88838b630b499dd5cc5b881, 0) <=\n                                           NVL(e9a95106e01380a7834d36560e919770.2177cea9b358aa31faa3305994c025bb000751f5aaa607380a5ba46385b2c0ee, 0)\n                                    AND NVL(e9a95106e01380a7834d36560e919770.210f742c7a4e17979d08976db76abf6f, 'X') = 'F'\n                                    AND (e9a95106e01380a7834d36560e919770.c2b9ebe664db8cfc1f7a702af0630a5b = 'IND'\n                                      OR   NVL(e9a95106e01380a7834d36560e919770.2ee1400a0150f0b220dd7bd6268d1e66, 0)\n                                         - NVL(e9a95106e01380a7834d36560e919770.c6c7cc45578c678907522e08bb04a4ca, 0)\n                                         - CASE WHEN e9a95106e01380a7834d36560e919770.487c194c34aee6c67551aa2cdd2358ace32f6dd38f333cde68119d1f277367cd = 'P' THEN NVL(e9a95106e01380a7834d36560e919770.d206d123f59f85e26ec113e33b465295,0) ELSE 0 END\n                                         + NVL(e9a95106e01380a7834d36560e919770.b7982b81d447f11a0953881190e528cae6795cb2e88838b630b499dd5cc5b881, 0) < 0)) \n                               AND NOT (NVL(e9a95106e01380a7834d36560e919770.2ee1400a0150f0b220dd7bd6268d1e66, 0) + NVL(e9a95106e01380a7834d36560e919770.b7982b81d447f11a0953881190e528cae6795cb2e88838b630b499dd5cc5b881, 0) <=\n                                           NVL(e9a95106e01380a7834d36560e919770.2177cea9b358aa31faa3305994c025bb000751f5aaa607380a5ba46385b2c0ee, 0)\n                                    AND e9a95106e01380a7834d36560e919770.405eb70497393d739ad0b0163f59beab IS NOT NULL) \n                               AND NOT (e9a95106e01380a7834d36560e919770.69cc3d229f9a1af0e9235eb598b0b176 = 'DEV') \n                               AND e9a95106e01380a7834d36560e919770.69cc3d229f9a1af0e9235eb598b0b176 = 'CBA' THEN\n                                 NVL(e9a95106e01380a7834d36560e919770.7a408037993e6c1e330c1e1575363846280a4c8731f60bb762471fb74030c9a2, 0) - NVL(e9a95106e01380a7834d36560e919770.b7982b81d447f11a0953881190e528cae6795cb2e88838b630b499dd5cc5b881, 0)\n                              ELSE\n                                 0\n                           END)\n                          comm_bsis_amt_extnd_is,\n                       SUM(CASE\n                              WHEN NVL(e9a95106e01380a7834d36560e919770.d1ce6707c3d1cc0e57096fdc21a5e64f, 0) = 0\n                               AND NOT (  NVL(e9a95106e01380a7834d36560e919770.2ee1400a0150f0b220dd7bd6268d1e66, 0)\n                                        - NVL(e9a95106e01380a7834d36560e919770.c6c7cc45578c678907522e08bb04a4ca, 0)\n                                        - CASE WHEN e9a95106e01380a7834d36560e919770.487c194c34aee6c67551aa2cdd2358ace32f6dd38f333cde68119d1f277367cd = 'P' THEN NVL(e9a95106e01380a7834d36560e919770.d206d123f59f85e26ec113e33b465295,0) ELSE 0 END\n                                        + NVL(e9a95106e01380a7834d36560e919770.b7982b81d447f11a0953881190e528cae6795cb2e88838b630b499dd5cc5b881, 0) < 0\n                                    AND e9a95106e01380a7834d36560e919770.a00b7aac034b1de6ebfabe4a7097af1b3c072b0281819f75f19257cd7009a1b3 IN ('8', '9')) \n                               AND NOT NVL(e9a95106e01380a7834d36560e919770.e2657ceeba5b709bafb65e0820feb4e2e71d6e15d5f960146139766d193d0f98, 0) > 0 \n                               AND NOT (NVL(e9a95106e01380a7834d36560e919770.2ee1400a0150f0b220dd7bd6268d1e66, 0) + NVL(e9a95106e01380a7834d36560e919770.b7982b81d447f11a0953881190e528cae6795cb2e88838b630b499dd5cc5b881, 0) <=\n                                           NVL(e9a95106e01380a7834d36560e919770.2177cea9b358aa31faa3305994c025bb000751f5aaa607380a5ba46385b2c0ee, 0)\n                                    AND NVL(e9a95106e01380a7834d36560e919770.210f742c7a4e17979d08976db76abf6f, 'X') = 'F'\n                                    AND (e9a95106e01380a7834d36560e919770.c2b9ebe664db8cfc1f7a702af0630a5b = 'IND'\n                                      OR   NVL(e9a95106e01380a7834d36560e919770.2ee1400a0150f0b220dd7bd6268d1e66, 0)\n                                         - NVL(e9a95106e01380a7834d36560e919770.c6c7cc45578c678907522e08bb04a4ca, 0)\n                                         - CASE WHEN e9a95106e01380a7834d36560e919770.487c194c34aee6c67551aa2cdd2358ace32f6dd38f333cde68119d1f277367cd = 'P' THEN NVL(e9a95106e01380a7834d36560e919770.d206d123f59f85e26ec113e33b465295,0) ELSE 0 END\n                                         + NVL(e9a95106e01380a7834d36560e919770.b7982b81d447f11a0953881190e528cae6795cb2e88838b630b499dd5cc5b881, 0) < 0)) \n                               AND NOT (NVL(e9a95106e01380a7834d36560e919770.2ee1400a0150f0b220dd7bd6268d1e66, 0) + NVL(e9a95106e01380a7834d36560e919770.b7982b81d447f11a0953881190e528cae6795cb2e88838b630b499dd5cc5b881, 0) <=\n                                           NVL(e9a95106e01380a7834d36560e919770.2177cea9b358aa31faa3305994c025bb000751f5aaa607380a5ba46385b2c0ee, 0)\n                                    AND e9a95106e01380a7834d36560e919770.405eb70497393d739ad0b0163f59beab IS NOT NULL) \n                               AND e9a95106e01380a7834d36560e919770.69cc3d229f9a1af0e9235eb598b0b176 = 'DEV' THEN\n                                   NVL(e9a95106e01380a7834d36560e919770.2177cea9b358aa31faa3305994c025bb000751f5aaa607380a5ba46385b2c0ee, 0)\n                                 - NVL(e9a95106e01380a7834d36560e919770.2ee1400a0150f0b220dd7bd6268d1e66, 0)\n                                 - NVL(e9a95106e01380a7834d36560e919770.b7982b81d447f11a0953881190e528cae6795cb2e88838b630b499dd5cc5b881, 0)\n                              ELSE\n                                 0\n                           END)\n                          dond_is,\n                       SUM(CASE WHEN 278e1ed5d8a135754be306e30c43cc04.2d45d761eb8d137835bca7a23010fab4 IS NOT NULL THEN qty_ship ELSE 0 END) scp_qty_ship,\n                       SUM(CASE WHEN bb805aa48637dff5301e58072c937e92.2d45d761eb8d137835bca7a23010fab4 IS NOT NULL THEN qty_ship ELSE 0 END) scp_promo_qty_ship,\n                       SUM(CASE WHEN e9a95106e01380a7834d36560e919770.07310c912dd99ea9c810de3167989b0f IN (6, 8) THEN e9a95106e01380a7834d36560e919770.ccf8d88f2d37f3171da2121ab22e9330 ELSE 0 END) rtrn_unfrm_qty_ship,\n                       SUM(CASE\n                              WHEN NVL(e9a95106e01380a7834d36560e919770.d1ce6707c3d1cc0e57096fdc21a5e64f, 0) = 0\n                               AND NOT (  NVL(e9a95106e01380a7834d36560e919770.2ee1400a0150f0b220dd7bd6268d1e66, 0)\n                                        - NVL(e9a95106e01380a7834d36560e919770.c6c7cc45578c678907522e08bb04a4ca, 0)\n                                        - CASE WHEN e9a95106e01380a7834d36560e919770.487c194c34aee6c67551aa2cdd2358ace32f6dd38f333cde68119d1f277367cd = 'P' THEN NVL(e9a95106e01380a7834d36560e919770.d206d123f59f85e26ec113e33b465295,0) ELSE 0 END\n                                        + NVL(e9a95106e01380a7834d36560e919770.b7982b81d447f11a0953881190e528cae6795cb2e88838b630b499dd5cc5b881, 0) < 0\n                                    AND e9a95106e01380a7834d36560e919770.a00b7aac034b1de6ebfabe4a7097af1b3c072b0281819f75f19257cd7009a1b3 IN ('8', '9')) \n                               AND ((NVL(e9a95106e01380a7834d36560e919770.e2657ceeba5b709bafb65e0820feb4e2e71d6e15d5f960146139766d193d0f98, 0) > 0) \n                                 OR (NVL(e9a95106e01380a7834d36560e919770.2ee1400a0150f0b220dd7bd6268d1e66, 0) + NVL(e9a95106e01380a7834d36560e919770.b7982b81d447f11a0953881190e528cae6795cb2e88838b630b499dd5cc5b881, 0) <=\n                                        NVL(e9a95106e01380a7834d36560e919770.2177cea9b358aa31faa3305994c025bb000751f5aaa607380a5ba46385b2c0ee, 0)\n                                 AND NVL(e9a95106e01380a7834d36560e919770.210f742c7a4e17979d08976db76abf6f, 'X') = 'F'\n                                 AND (e9a95106e01380a7834d36560e919770.c2b9ebe664db8cfc1f7a702af0630a5b = 'IND'\n                                   OR NVL(e9a95106e01380a7834d36560e919770.2ee1400a0150f0b220dd7bd6268d1e66, 0) - NVL(e9a95106e01380a7834d36560e919770.c6c7cc45578c678907522e08bb04a4ca, 0) - (CASE WHEN e9a95106e01380a7834d36560e919770.487c194c34aee6c67551aa2cdd2358ace32f6dd38f333cde68119d1f277367cd = 'P' THEN NVL(e9a95106e01380a7834d36560e919770.d206d123f59f85e26ec113e33b465295,0) ELSE 0 END) + NVL(e9a95106e01380a7834d36560e919770.b7982b81d447f11a0953881190e528cae6795cb2e88838b630b499dd5cc5b881, 0) <\n                                         0)) \n                                 OR (NVL(e9a95106e01380a7834d36560e919770.2ee1400a0150f0b220dd7bd6268d1e66, 0) + NVL(e9a95106e01380a7834d36560e919770.b7982b81d447f11a0953881190e528cae6795cb2e88838b630b499dd5cc5b881, 0) <=\n                                        NVL(e9a95106e01380a7834d36560e919770.2177cea9b358aa31faa3305994c025bb000751f5aaa607380a5ba46385b2c0ee, 0)\n                                 AND e9a95106e01380a7834d36560e919770.405eb70497393d739ad0b0163f59beab IS NOT NULL) \n                                 OR e9a95106e01380a7834d36560e919770.69cc3d229f9a1af0e9235eb598b0b176 = 'DEV' \n                                 OR e9a95106e01380a7834d36560e919770.69cc3d229f9a1af0e9235eb598b0b176 = 'CBA' \n                                 OR (e9a95106e01380a7834d36560e919770.370a5aec6c948b64a7638f194c6ea1a7 = 3\n                                 AND e9a95106e01380a7834d36560e919770.ccc371b06f1e0daed88f223211b2e790 = 'N'\n                                 AND NVL(e9a95106e01380a7834d36560e919770.2ee1400a0150f0b220dd7bd6268d1e66, 0) - NVL(e9a95106e01380a7834d36560e919770.c6c7cc45578c678907522e08bb04a4ca, 0) - (CASE WHEN e9a95106e01380a7834d36560e919770.487c194c34aee6c67551aa2cdd2358ace32f6dd38f333cde68119d1f277367cd = 'P' THEN NVL(e9a95106e01380a7834d36560e919770.d206d123f59f85e26ec113e33b465295,0) ELSE 0 END) + NVL(e9a95106e01380a7834d36560e919770.b7982b81d447f11a0953881190e528cae6795cb2e88838b630b499dd5cc5b881, 0) <\n                                        0\n                                 AND e9a95106e01380a7834d36560e919770.677b20030e97fe7a072c96e3023ab27b75a332bf028585250008d9183409dc25 IN ('D', 'F')) \n                                                                        ) THEN\n                                 e9a95106e01380a7834d36560e919770.2ee1400a0150f0b220dd7bd6268d1e66\n                              ELSE\n                                 0\n                           END)\n                          invst_sls_prtcpt,\n                       case when nvl(7bbc500993f8c1384ba73fe9d8ff44f8.c712a9ab5ef100c5807fa96123dac48b ,'USF') <> 'USF'\n                            and  e9a95106e01380a7834d36560e919770.f5dd4374a3e3af6a775cb6d6b22e8162 < nvl(7bbc500993f8c1384ba73fe9d8ff44f8.3db9275d5f5cb2e9d918e77dbabdd97b, e9a95106e01380a7834d36560e919770.f5dd4374a3e3af6a775cb6d6b22e8162) then 'N' else 'Y'\n                       end usf_gl_ind,\n                       sum(CASE  WHEN   NVL (7bbc500993f8c1384ba73fe9d8ff44f8.fb77d39bc5d09c4429027637da8ca1f3, 'USF') = 'USF'\n                       AND NVL(UPPER (TRIM (TRAILING ' ' FROM TRIM (LEADING ' ' FROM e9a95106e01380a7834d36560e919770.6ccef1eb8042feb61800f8c85bf4a17d))),'EC') IN ('EC','MO','NV','PO','VP')\n                       AND UPPER (TRIM (TRAILING ' ' FROM TRIM (LEADING ' ' FROM e9a95106e01380a7834d36560e919770.a2505c280adb19c603f231bc0dada48be32f6dd38f333cde68119d1f277367cd))) IN('CUST', 'PRTNR')\n                       AND   e9a95106e01380a7834d36560e919770.326c198749b2fb9f8273fc6cb7e21786 IN ('RT', 'VS', 'WC')THEN nvl(e9a95106e01380a7834d36560e919770.0effb8574b17d7b64bca94bc97d1d844,0) else 0 end) ec_st_grs_sls_extnd,\n\n                       Sum(CASE WHEN  NVL (7bbc500993f8c1384ba73fe9d8ff44f8.fb77d39bc5d09c4429027637da8ca1f3, 'USF') = 'USF'\n                       AND e9a95106e01380a7834d36560e919770.326c198749b2fb9f8273fc6cb7e21786 IN ('RT', 'VS', 'WC') AND ((UPPER (TRIM (TRAILING ' ' FROM TRIM (LEADING ' ' FROM e9a95106e01380a7834d36560e919770.a2505c280adb19c603f231bc0dada48be32f6dd38f333cde68119d1f277367cd))) IN('PRTNR')\n                       AND UPPER (TRIM (TRAILING ' ' FROM TRIM (LEADING ' ' FROM e9a95106e01380a7834d36560e919770.6ccef1eb8042feb61800f8c85bf4a17d))) IN('PO'))\n                       OR (UPPER (TRIM ( TRAILING ' ' FROM TRIM ( LEADING ' ' FROM e9a95106e01380a7834d36560e919770.a2505c280adb19c603f231bc0dada48be32f6dd38f333cde68119d1f277367cd))) IN('CUST', 'PRTNR')\n                       AND NVL (UPPER (TRIM (TRAILING ' ' FROM TRIM (LEADING ' ' FROM e9a95106e01380a7834d36560e919770.6ccef1eb8042feb61800f8c85bf4a17d))),'EC') IN ('EC','MO','NV','PO','VP'))\n                       OR (UPPER (TRIM (TRAILING ' ' FROM TRIM (LEADING ' ' FROM e9a95106e01380a7834d36560e919770.a2505c280adb19c603f231bc0dada48be32f6dd38f333cde68119d1f277367cd))) IN('PRTNR', 'SYSTM')\n                       AND UPPER ( TRIM ( TRAILING ' ' FROM TRIM ( LEADING ' ' FROM e9a95106e01380a7834d36560e919770.6ccef1eb8042feb61800f8c85bf4a17d))) IN ('ED', 'EP', 'OS')))\n                       THEN nvl(e9a95106e01380a7834d36560e919770.0effb8574b17d7b64bca94bc97d1d844,0) ELSE 0 END) ec_na_grs_sls_extnd,\n\n                       sum(Case when e9a95106e01380a7834d36560e919770.326c198749b2fb9f8273fc6cb7e21786 IN ('RT', 'VS', 'WC')\n                       and NVL(UPPER (TRIM (TRAILING ' ' FROM TRIM (LEADING ' ' FROM e9a95106e01380a7834d36560e919770.6ccef1eb8042feb61800f8c85bf4a17d))),'EC') NOT IN ('EP','ED','OS')\n                       then nvl(e9a95106e01380a7834d36560e919770.0effb8574b17d7b64bca94bc97d1d844,0) else 0 end) ec_st_grs_sls_extnd_dnmtr,\n\n                       sum(Case when e9a95106e01380a7834d36560e919770.326c198749b2fb9f8273fc6cb7e21786 IN ('RT', 'VS', 'WC')  then nvl(e9a95106e01380a7834d36560e919770.0effb8574b17d7b64bca94bc97d1d844,0) else 0 end) ec_na_grs_sls_extnd_dnmtr\n                  FROM de459e2fe7f96e4d958537b31b946b26.2c04d82ed0aa1cc9bce2cf2c0548b268 p,\n                       (SELECT *\n                          FROM de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c\n                         WHERE xfer_to_dt IS NULL\n                           AND prcs_dt = l_prcs_dt\n                           AND div_nbr = p_div_nbr\n                           AND (orig_ldr_tm IS NULL\n                             OR orig_ldr_tm > l_max_orig_ldr_tm)) s,\n                       (SELECT *\n                          FROM de459e2fe7f96e4d958537b31b946b26.a881784aba9565922acae6462c99da2c\n                         WHERE frst_scp_flg = 'Y'\n                           AND l_fisc_yr_wk >= promo_start_wk) scp_all, \n                       (SELECT *\n                          FROM de459e2fe7f96e4d958537b31b946b26.a881784aba9565922acae6462c99da2c\n                         WHERE l_fisc_yr_wk BETWEEN promo_start_wk AND promo_end_wk) scp_promo, \n                        de459e2fe7f96e4d958537b31b946b26.dec387908a0954ddc8689c4ad37c8a3c d,\n                        de459e2fe7f96e4d958537b31b946b26.dec387908a0954ddc8689c4ad37c8a3c rev_div\n                    WHERE e9a95106e01380a7834d36560e919770.d3268eabc4a7d98105fd85f9c9e62cd6e32ad436514bbe822b33de8bead744f3 = e472b097974b0d6a9a7d2ed170324906.d3268eabc4a7d98105fd85f9c9e62cd6e32ad436514bbe822b33de8bead744f3\n                   AND e9a95106e01380a7834d36560e919770.2d45d761eb8d137835bca7a23010fab4 = 278e1ed5d8a135754be306e30c43cc04.2d45d761eb8d137835bca7a23010fab4(+) \n                   AND e9a95106e01380a7834d36560e919770.2d45d761eb8d137835bca7a23010fab4 = bb805aa48637dff5301e58072c937e92.2d45d761eb8d137835bca7a23010fab4(+) \n                   AND e9a95106e01380a7834d36560e919770.839c4ffb4bfaae1bb58eab4dee67d96a  = fce896ca0fbbf5a5d330f2803036eb44.839c4ffb4bfaae1bb58eab4dee67d96a\n                   AND nvl(e9a95106e01380a7834d36560e919770.a2b201123c685e8cc48b5468cb4a449361bbd7bc0d2d67c7d7b11cb0a8d18d03,e9a95106e01380a7834d36560e919770.839c4ffb4bfaae1bb58eab4dee67d96a) = 7bbc500993f8c1384ba73fe9d8ff44f8.839c4ffb4bfaae1bb58eab4dee67d96a\n              GROUP BY e9a95106e01380a7834d36560e919770.852fa1e9f02f1ca2c75837f7146b2381,\n                       e9a95106e01380a7834d36560e919770.839c4ffb4bfaae1bb58eab4dee67d96a,\n                       e9a95106e01380a7834d36560e919770.7f599f836c449bebb92bb9757e86c603,\n                       NVL(e9a95106e01380a7834d36560e919770.a2b201123c685e8cc48b5468cb4a449361bbd7bc0d2d67c7d7b11cb0a8d18d03, e9a95106e01380a7834d36560e919770.839c4ffb4bfaae1bb58eab4dee67d96a),\n                       DECODE(e472b097974b0d6a9a7d2ed170324906.89f3df82917b692fe64dca942d924e7c, 97, 'Y', 'N') ,\n                       case when nvl(7bbc500993f8c1384ba73fe9d8ff44f8.c712a9ab5ef100c5807fa96123dac48b ,'USF') <> 'USF'\n                            and  e9a95106e01380a7834d36560e919770.f5dd4374a3e3af6a775cb6d6b22e8162 < nvl(7bbc500993f8c1384ba73fe9d8ff44f8.3db9275d5f5cb2e9d918e77dbabdd97b, e9a95106e01380a7834d36560e919770.f5dd4374a3e3af6a775cb6d6b22e8162) then 'N' else 'Y'\n                       end) e;\n\n   DBMS_OUTPUT.put_line('Inserted ' || sql%ROWCOUNT || ' rows');\n\n   COMMIT;\n\n   RETURN c_success;\nEXCEPTION\n   WHEN OTHERS THEN\n      DBMS_OUTPUT.put_line('Unexepected error');\n      DBMS_OUTPUT.put_line(SQLCODE || ': ' || SQLERRM);\n      ROLLBACK;\n      RETURN c_error;\nEND;\n/",
            "upstream_dependencies": [],
            "downstream_dependencies": [],
            "dag_location": "null",
            "gantt_location": "null",
            "created_at": "null",
            "updated_at": "null"
        },
        {
            "name": "FN_CUST_CLSFCTN_CORP_WK_LOAD",
            "encrypted_name": "5a29470c6a3d464325075a185f279be519a1d3122aa0e85f2fc3ccfcbdad89b5",
            "type": "function",
            "database": "null",
            "encrypted_database": "null",
            "schema": "XDMADM",
            "encrypted_schema": "0e03d5c46556a742ba46252698396ef2",
            "fully_qualified_name": "XDMADM.FN_CUST_CLSFCTN_CORP_WK_LOAD",
            "encrypted_fqn": "0e03d5c46556a742ba46252698396ef2.5a29470c6a3d464325075a185f279be519a1d3122aa0e85f2fc3ccfcbdad89b5",
            "synonyms": [],
            "metadata_analysis": "CREATE OR REPLACE FUNCTION \"0e03d5c46556a742ba46252698396ef2\".\"5a29470c6a3d464325075a185f279be519a1d3122aa0e85f2fc3ccfcbdad89b5\" (odate IN DATE)\n   RETURN NUMBER AS\n   \n   c_success            CONSTANT NUMBER := 0;\n   c_error              CONSTANT NUMBER := 1;\n   c_schema             CONSTANT VARCHAR2(30) := 'XDMADM';\n   c_aggr_tbl_syn_nm    CONSTANT VARCHAR2(30) := 'CUST_CLSFCTN_CORP_WK';\n   c_aggr_load_syn_nm   CONSTANT VARCHAR2(30) := 'CUST_CLSFCTN_CORP_WK_LOAD';\n   l_return_code        NUMBER;\n   l_out_msg            VARCHAR2(256);\n\n   l_aggr_tbl_nm        VARCHAR2(30);\n   l_load_tbl_nm        VARCHAR2(30);\nBEGIN\n   \n   IF (odate IS NULL) THEN\n      DBMS_OUTPUT.put_line('Error: Invalid Parameters: Date is required');\n      RETURN c_error;\n   END IF;\n\n   \n   EXECUTE IMMEDIATE 'SELECT table_name FROM user_synonyms WHERE synonym_name = ''' || c_aggr_tbl_syn_nm || ''''\n      INTO l_aggr_tbl_nm;\n\n   EXECUTE IMMEDIATE 'SELECT table_name FROM user_synonyms WHERE synonym_name = ''' || c_aggr_load_syn_nm || ''''\n      INTO l_load_tbl_nm;\n\n   DBMS_OUTPUT.put_line('Aggr Table: ' || l_aggr_tbl_nm);\n   DBMS_OUTPUT.put_line('Load Table: ' || l_load_tbl_nm);\n\n   \n   l_return_code   := 8e64339f96bb08058f5d52f1c04f954a.8ffe4678890c39c7d4ed38c2ed759e24.e4b5db2b3f9b19accbb8cddbfcd05bac(l_out_msg, c_schema, l_load_tbl_nm);\n   DBMS_OUTPUT.put_line('Truncate Load Table Return: ' || l_return_code || ' - ' || l_out_msg);\n\n   IF (l_return_code <> 0) THEN\n      DBMS_OUTPUT.put_line('Error: Failed to truncate table');\n      RETURN c_error;\n   END IF;\n\n   INSERT \n         INTO de459e2fe7f96e4d958537b31b946b26.1127751f1872aa967342f1fcf6b2ff728d382add7dc4db1491f377a54b82bdc9\n      (SELECT de459e2fe7f96e4d958537b31b946b26.1127751f1872aa967342f1fcf6b2ff72e472b097974b0d6a9a7d2ed170324906.44db07dca7893985ce87192c7f358f75,\n              de459e2fe7f96e4d958537b31b946b26.1127751f1872aa967342f1fcf6b2ff72e472b097974b0d6a9a7d2ed170324906.8a5c1eda3416fa5daae04a2980452d8a,\n              de459e2fe7f96e4d958537b31b946b26.1127751f1872aa967342f1fcf6b2ff72e472b097974b0d6a9a7d2ed170324906.852fa1e9f02f1ca2c75837f7146b2381,\n              de459e2fe7f96e4d958537b31b946b26.1127751f1872aa967342f1fcf6b2ff72e472b097974b0d6a9a7d2ed170324906.7f599f836c449bebb92bb9757e86c603,\n              de459e2fe7f96e4d958537b31b946b26.1127751f1872aa967342f1fcf6b2ff72e472b097974b0d6a9a7d2ed170324906.e8a9f207120b23947059cce42696d8f133cb242de526ddafe282bd57488cedea,\n              de459e2fe7f96e4d958537b31b946b26.1127751f1872aa967342f1fcf6b2ff72e472b097974b0d6a9a7d2ed170324906.839c4ffb4bfaae1bb58eab4dee67d96a,\n              de459e2fe7f96e4d958537b31b946b26.1127751f1872aa967342f1fcf6b2ff72e472b097974b0d6a9a7d2ed170324906.e17b4db24503ad4d9365a15bec98eef6,\n              de459e2fe7f96e4d958537b31b946b26.1127751f1872aa967342f1fcf6b2ff72e472b097974b0d6a9a7d2ed170324906.21c571650d05fd041faddc812b8444acf43d3e611ef8d78ea0e7840aa66f8834,\n              de459e2fe7f96e4d958537b31b946b26.1127751f1872aa967342f1fcf6b2ff72e472b097974b0d6a9a7d2ed170324906.e1d446673288adb6d5f219d0aa82d37a,\n              de459e2fe7f96e4d958537b31b946b26.1127751f1872aa967342f1fcf6b2ff72e472b097974b0d6a9a7d2ed170324906.d3ec1a21507970329af1c66ef244cdefe32f6dd38f333cde68119d1f277367cd,\n              de459e2fe7f96e4d958537b31b946b26.1127751f1872aa967342f1fcf6b2ff72e472b097974b0d6a9a7d2ed170324906.d3ec1a21507970329af1c66ef244cdefb274599470f4daf85f36de136c376169,\n              de459e2fe7f96e4d958537b31b946b26.1127751f1872aa967342f1fcf6b2ff72e472b097974b0d6a9a7d2ed170324906.ab30d6d679879cfacfe389b97d1d3f0e,\n              de459e2fe7f96e4d958537b31b946b26.1127751f1872aa967342f1fcf6b2ff72e472b097974b0d6a9a7d2ed170324906.2603c45be643e5cd8f9c6dad3bee6cb3,\n              de459e2fe7f96e4d958537b31b946b26.1127751f1872aa967342f1fcf6b2ff72e472b097974b0d6a9a7d2ed170324906.427b165a60053aea6330e695e94a70a7e32f6dd38f333cde68119d1f277367cd,\n              de459e2fe7f96e4d958537b31b946b26.1127751f1872aa967342f1fcf6b2ff72e472b097974b0d6a9a7d2ed170324906.90e4c117c92c6903bb3329bd073f897d21548f957a748c207f3c29e7d58d3908,\n              de459e2fe7f96e4d958537b31b946b26.1127751f1872aa967342f1fcf6b2ff72e472b097974b0d6a9a7d2ed170324906.0b510aa9723d1a3d509b1266593e14e32ee1400a0150f0b220dd7bd6268d1e66,\n              de459e2fe7f96e4d958537b31b946b26.1127751f1872aa967342f1fcf6b2ff72e472b097974b0d6a9a7d2ed170324906.0b510aa9723d1a3d509b1266593e14e34f1272f7dffc94b9e882fd01e6907270,\n              de459e2fe7f96e4d958537b31b946b26.1127751f1872aa967342f1fcf6b2ff72e472b097974b0d6a9a7d2ed170324906.0b510aa9723d1a3d509b1266593e14e3dc15696e1e997bad6131bf936574f406,\n              de459e2fe7f96e4d958537b31b946b26.1127751f1872aa967342f1fcf6b2ff72e472b097974b0d6a9a7d2ed170324906.0b510aa9723d1a3d509b1266593e14e3eb6a312932db943ec140f42c7c8998cf,\n              de459e2fe7f96e4d958537b31b946b26.1127751f1872aa967342f1fcf6b2ff72e472b097974b0d6a9a7d2ed170324906.eadd9908b946d3d5ca01943838f5c2e9c26c75501bd417b545424c1b7ba80221,\n              de459e2fe7f96e4d958537b31b946b26.1127751f1872aa967342f1fcf6b2ff72e472b097974b0d6a9a7d2ed170324906.63aa512b344d4723552137ee46f28794c26c75501bd417b545424c1b7ba80221,\n              de459e2fe7f96e4d958537b31b946b26.1127751f1872aa967342f1fcf6b2ff72e472b097974b0d6a9a7d2ed170324906.afcae1f8310cd038c0633aeaa179c10c280a4c8731f60bb762471fb74030c9a2,\n              de459e2fe7f96e4d958537b31b946b26.1127751f1872aa967342f1fcf6b2ff72e472b097974b0d6a9a7d2ed170324906.37175a70b8190fbf717de5f6ebc49b0a,\n              de459e2fe7f96e4d958537b31b946b26.1127751f1872aa967342f1fcf6b2ff72e472b097974b0d6a9a7d2ed170324906.e6160a512e148d90c7df38ae2e16368dcd30f368447f67a772f6e122173aa0f4,\n              de459e2fe7f96e4d958537b31b946b26.1127751f1872aa967342f1fcf6b2ff72e472b097974b0d6a9a7d2ed170324906.ccf8d88f2d37f3171da2121ab22e9330,\n              de459e2fe7f96e4d958537b31b946b26.1127751f1872aa967342f1fcf6b2ff72e472b097974b0d6a9a7d2ed170324906.630c48bbfe25ea68a239339f24d37c79,\n              de459e2fe7f96e4d958537b31b946b26.1127751f1872aa967342f1fcf6b2ff72e472b097974b0d6a9a7d2ed170324906.b510300e3201ebdc74ca77e145879977a60007b116184ea39d15d05e56cd3bd4,\n              de459e2fe7f96e4d958537b31b946b26.1127751f1872aa967342f1fcf6b2ff72e472b097974b0d6a9a7d2ed170324906.60c87cc02b8c8cefb8bba2a977223d5f38ee6547beafb256a1079a3b44ded48f,\n              de459e2fe7f96e4d958537b31b946b26.1127751f1872aa967342f1fcf6b2ff72e472b097974b0d6a9a7d2ed170324906.78a33e0356f72ef80a2eadf710f907c2fab85cad4899d2e8aeec539dda8a84ab,\n              de459e2fe7f96e4d958537b31b946b26.1127751f1872aa967342f1fcf6b2ff72e472b097974b0d6a9a7d2ed170324906.7a133759cd0bf9f99c4a5301a550aed5,\n              de459e2fe7f96e4d958537b31b946b26.c063519e87e23d735cdb53a35832f0ff.f2de255a7553ba934b1f05ae7699ae4c,\n              de459e2fe7f96e4d958537b31b946b26.c063519e87e23d735cdb53a35832f0ff.082954f5697b93de7d3d890e9e5528dc,\n              de459e2fe7f96e4d958537b31b946b26.c063519e87e23d735cdb53a35832f0ff.5b160722fa6c6c8ab59bb970fe674749f43d3e611ef8d78ea0e7840aa66f8834,\n              de459e2fe7f96e4d958537b31b946b26.c063519e87e23d735cdb53a35832f0ff.c9ed3827968a72723f7e114f602d0196e32f6dd38f333cde68119d1f277367cd,\n              de459e2fe7f96e4d958537b31b946b26.c063519e87e23d735cdb53a35832f0ff.c9ed3827968a72723f7e114f602d0196b274599470f4daf85f36de136c376169,\n              de459e2fe7f96e4d958537b31b946b26.c063519e87e23d735cdb53a35832f0ff.60366eb74592c7e4885fee555519b518,\n              de459e2fe7f96e4d958537b31b946b26.c063519e87e23d735cdb53a35832f0ff.d32044c9e2eb00f75a304d9b58a4a2c9\n         FROM de459e2fe7f96e4d958537b31b946b26.1127751f1872aa967342f1fcf6b2ff72e472b097974b0d6a9a7d2ed170324906 ccc, de459e2fe7f96e4d958537b31b946b26.c063519e87e23d735cdb53a35832f0ff wtc\n        WHERE de459e2fe7f96e4d958537b31b946b26.c063519e87e23d735cdb53a35832f0ff.eeb3cae1b83726e8df7c8d2367b9cf4b1d731bbdc4e3fb69a854112d4982eb99 = de459e2fe7f96e4d958537b31b946b26.1127751f1872aa967342f1fcf6b2ff72e472b097974b0d6a9a7d2ed170324906.d3ec1a21507970329af1c66ef244cdefe32f6dd38f333cde68119d1f277367cd);\n\n   DBMS_OUTPUT.put_line('Inserted ' || sql%ROWCOUNT || ' rows');\n\n   COMMIT;\n\n   \n   l_return_code   := de459e2fe7f96e4d958537b31b946b26.9b3711c37bca8fd1d7c76527508615f9(c_schema, l_load_tbl_nm);\n   DBMS_OUTPUT.put_line('Analyze Return: ' || l_return_code);\n\n   IF (l_return_code <> 0) THEN\n      DBMS_OUTPUT.put_line('Error: Failed to analyze table');\n      RETURN c_error;\n   END IF;\n\n   \n   l_return_code   := de459e2fe7f96e4d958537b31b946b26.f21751d25bb3675b2a3778f4f03c7da6(c_aggr_tbl_syn_nm, c_schema, l_load_tbl_nm);\n   DBMS_OUTPUT.put_line(\n      'Create synonym ' || c_aggr_tbl_syn_nm || ' for ' || c_schema || '.' || l_load_tbl_nm || ': ' || l_return_code);\n\n   IF (l_return_code <> 0) THEN\n      DBMS_OUTPUT.put_line('Error: Failed to create synonym for aggregate table');\n      RETURN c_error;\n   END IF;\n\n   l_return_code   := de459e2fe7f96e4d958537b31b946b26.f21751d25bb3675b2a3778f4f03c7da6(c_aggr_load_syn_nm, c_schema, l_aggr_tbl_nm);\n   DBMS_OUTPUT.put_line(\n      'Create synonym ' || c_aggr_load_syn_nm || ' for ' || c_schema || '.' || l_aggr_tbl_nm || ': ' || l_return_code);\n\n   IF (l_return_code <> 0) THEN\n      DBMS_OUTPUT.put_line('Error: Failed to create synonym for aggregate table');\n      RETURN c_error;\n   END IF;\n\n   \n   l_return_code   := 8e64339f96bb08058f5d52f1c04f954a.8ffe4678890c39c7d4ed38c2ed759e24.e4b5db2b3f9b19accbb8cddbfcd05bac(l_out_msg, c_schema, l_aggr_tbl_nm);\n   DBMS_OUTPUT.put_line('Truncate Prev Aggr Table Return: ' || l_return_code || ' - ' || l_out_msg);\n\n   IF (l_return_code <> 0) THEN\n      DBMS_OUTPUT.put_line('Error: Failed to truncate table');\n      RETURN c_error;\n   END IF;\n\n   RETURN c_success;\nEXCEPTION\n   WHEN OTHERS THEN\n      DBMS_OUTPUT.put_line('Unexepected error');\n      DBMS_OUTPUT.put_line(SQLCODE || ': ' || SQLERRM);\n      RETURN c_error;\nEND fn_cust_clsfctn_corp_wk_load;\n/",
            "upstream_dependencies": [],
            "downstream_dependencies": [],
            "dag_location": "null",
            "gantt_location": "null",
            "created_at": "null",
            "updated_at": "null"
        },
        {
            "name": "FN_GETSTAT_TBL",
            "encrypted_name": "b0fbcaece4c8b9138365d9d1ba63d0bd",
            "type": "function",
            "database": "null",
            "encrypted_database": "null",
            "schema": "XDMADM",
            "encrypted_schema": "0e03d5c46556a742ba46252698396ef2",
            "fully_qualified_name": "XDMADM.FN_GETSTAT_TBL",
            "encrypted_fqn": "0e03d5c46556a742ba46252698396ef2.b0fbcaece4c8b9138365d9d1ba63d0bd",
            "synonyms": [],
            "metadata_analysis": "CREATE OR REPLACE FUNCTION \"0e03d5c46556a742ba46252698396ef2\".\"b0fbcaece4c8b9138365d9d1ba63d0bd\"\n                                     (V_TABLE_OWNER     IN VARCHAR2\n                                     ,V_TABLE_NAME      IN VARCHAR2\n                                     )\n      RETURN VARCHAR2\n   AS\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n  CON_PROCESS_NAME  CONSTANT varchar2(40) := 'FN_GETSTAT_TBL';\n  CON_PRRTY_SEVERE  CONSTANT INTEGER := 1;\n  CON_PRRTY_WARN    CONSTANT INTEGER := 2;\n  CON_PRRTY_INFO    CONSTANT INTEGER := 3;\n  CON_PRRTY_DEBUG   CONSTANT INTEGER := 4;\n  CON_ERR_LVL       CONSTANT INTEGER := 3;\n  CON_REC_LIMIT     CONSTANT NUMBER := 500;\n  CON_COMM_LIMIT    CONSTANT NUMBER := 1000;\n\n\n\n   v_dynamic_sql_stmt    varchar2(32000);\n\n\n\n   v_prcs_nm            varchar(100);\n   v_prcs_stp           varchar(100);\n   v_prcs_pram          varchar(100);\n   v_prcs_err_cd        varchar(200);\n   v_prcs_err_msg       varchar(200);\n   v_getstats_retval    varchar(32);\n\n\n\nBEGIN\n      v_prcs_nm  := CON_PROCESS_NAME ;\n      v_prcs_pram:=   V_TABLE_OWNER\n                    ||'-'\n                    ||V_TABLE_NAME\n                    ;\n      v_prcs_stp := 'Start Process';\n\n      DBMS_OUTPUT.PUT_LINE('Start Time:'||TO_CHAR(SYSDATE,'YYYY-MM-DD HH24:MI:SS'));\n      DBMS_OUTPUT.PUT_LINE('v_prcs_pram:'||v_prcs_pram);\n\n\n\n\n<< compress_sub_partitions>>\n       v_prcs_stp := 'Gather stats for V_TABLE_NAME';\n\n        DBMS_STATS.gather_table_stats\n                                     (ownname               => V_TABLE_OWNER,\n                                      tabname               => V_TABLE_NAME,\n                                      estimate_percent      => 100,\n                                      block_sample          => FALSE,\n                                      method_opt            => 'FOR ALL COLUMNS SIZE 1',\n                                      DEGREE                => 128,\n                                      granularity           => 'ALL',\n                                      CASCADE               => TRUE\n                                     );\n\n         if  SQLCODE = 0 then\n              DBMS_OUTPUT.put_line\n              ('Gather stats for V_TABLE_NAME:' || V_TABLE_NAME\n                            ||' Completed');\n         else\n             DBMS_OUTPUT.put_line ( 'Get Stats Failed for '||V_TABLE_NAME);\n             return -1;\n         end if;\n\n\n\n\n  <<Wrap_Program>>\n\n      v_prcs_stp := 'Final Commit';\n\n      commit;\n\n      DBMS_OUTPUT.put_line ('Gather stats for :' || V_TABLE_NAME||' Completed');\n      dbms_output.put_line('End Time:'||to_char(sysdate,'YYYY-MM-DD HH24:MI:SS'));\n\n      RETURN 0;\n\n\n\nEXCEPTION\n   WHEN OTHERS\n   THEN\n         DBMS_OUTPUT.put_line ('V_TABLE_NAME:' || V_TABLE_NAME);\n         DBMS_OUTPUT.put_line ('SQLERROR:' || SQLCODE || ',' || SQLERRM);\n         DBMS_OUTPUT.PUT_LINE(       v_prcs_nm\n                            ||' - '||v_prcs_stp\n                            ||' - '||v_prcs_pram);\n\n      RETURN -1;\nEND;\n/",
            "upstream_dependencies": [],
            "downstream_dependencies": [],
            "dag_location": "null",
            "gantt_location": "null",
            "created_at": "null",
            "updated_at": "null"
        },
        {
            "name": "FN_COMPRESS_TBL_PARTITIONS",
            "encrypted_name": "83efd6d8dd9a916c973da5f80938eb224b0a34bbfb1857df2585d5dad5cf5437",
            "type": "function",
            "database": "null",
            "encrypted_database": "null",
            "schema": "XDMADM",
            "encrypted_schema": "0e03d5c46556a742ba46252698396ef2",
            "fully_qualified_name": "XDMADM.FN_COMPRESS_TBL_PARTITIONS",
            "encrypted_fqn": "0e03d5c46556a742ba46252698396ef2.83efd6d8dd9a916c973da5f80938eb224b0a34bbfb1857df2585d5dad5cf5437",
            "synonyms": [],
            "metadata_analysis": "CREATE OR REPLACE FUNCTION \"0e03d5c46556a742ba46252698396ef2\".\"83efd6d8dd9a916c973da5f80938eb224b0a34bbfb1857df2585d5dad5cf5437\"\n   (p_owner_name IN VARCHAR2, p_table_name IN VARCHAR2)\n      RETURN NUMBER\n   AS\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n   CON_PROCESS_NAME  CONSTANT varchar2(40) := 'FN_COMPRESS_TBL_PARTITIONS';\n\n\n\n\n    i                NUMBER(4);\n    v_compress_ret   VARCHAR2(3);\n    v_enb_ind_retval VARCHAR2(3);\n\n\n\n\n   v_prcs_nm            varchar(100);\n   v_prcs_stp           varchar(100);\n   v_prcs_pram          varchar(100);\n\n\n\n\n\n    CURSOR c_get_partitions(v_owner varchar2, v_table varchar2) IS\n        SELECT partition_name\n        FROM all_tab_partitions\n        WHERE 1=1\n        AND table_owner  = v_owner\n        AND table_name   = v_table;\n\n    TYPE rt_get_partitions IS TABLE OF c_get_partitions%ROWTYPE;\n    recs_get_partitions rt_get_partitions;\n\n    CURSOR c_get_index_names (v_owner varchar2, v_table varchar2) IS\n    SELECT 3c134f4b2aac64380b61fe11eb935629.6d0e550978722d910ffcd45ed98fa166,3c134f4b2aac64380b61fe11eb935629.6b87cebc6fcf94bb0e7a3e2566a8a8bf,3c134f4b2aac64380b61fe11eb935629.0c52240b1085be9f49770e0e6ddff3a6\n                    FROM all_indexes b, all_tables a\n                   WHERE     3c134f4b2aac64380b61fe11eb935629.4130f46b76a478b2b813dfd2eba62006 = d766804ca29c19debace5b311afb47b7.6d0e550978722d910ffcd45ed98fa166\n                         AND 3c134f4b2aac64380b61fe11eb935629.6b87cebc6fcf94bb0e7a3e2566a8a8bf = d766804ca29c19debace5b311afb47b7.6b87cebc6fcf94bb0e7a3e2566a8a8bf\n                         AND 3c134f4b2aac64380b61fe11eb935629.6d0e550978722d910ffcd45ed98fa166 = v_owner\n                         AND 3c134f4b2aac64380b61fe11eb935629.6b87cebc6fcf94bb0e7a3e2566a8a8bf = v_table;\n\n    TYPE rt_get_index_names IS TABLE OF c_get_index_names%ROWTYPE;\n    recs_get_index_names rt_get_index_names;\n\nBEGIN\n    dbms_output.put_line('Start Process '||CON_PROCESS_NAME);\n    dbms_output.put_line('Start Time:'||TO_CHAR(SYSDATE,'YYYY-MM-DD HH24:MI:SS'));\n    v_prcs_nm  := CON_PROCESS_NAME ;\n    v_prcs_pram:= 'PARAM1 : '||p_owner_name||'  PARAM2 : '||p_table_name;\n    v_prcs_stp := 'Start Process '||CON_PROCESS_NAME;\n\n\n\n\n    v_prcs_stp := 'Getting list of all partitions';\n    dbms_output.put_line('opening a cursor for partition names');\n    OPEN c_get_partitions(p_owner_name, p_table_name);\n    FETCH c_get_partitions BULK COLLECT INTO recs_get_partitions;\n    CLOSE c_get_partitions;\n    dbms_output.put_line('closing a cursor for partition names');\n\n\n\n\n\n    v_prcs_stp := 'Compressing paritions';\n    dbms_output.put_line('No. of Partitions will be comptressed in this run '||40bdbdbb2f53f8bd1e6d1a10e89dc379d76c99327ad0913383df205f1ad70415.26fd1c0cd65cf53eadf725ede4bbd5f1);\n\n    FOR i IN 40bdbdbb2f53f8bd1e6d1a10e89dc379d76c99327ad0913383df205f1ad70415.07f4dd260fecf0c31bad06cf354b1e62..40bdbdbb2f53f8bd1e6d1a10e89dc379d76c99327ad0913383df205f1ad70415.3ee46e182f9f30ed8605205ccd9a9d70\n    LOOP\n        v_compress_ret := de459e2fe7f96e4d958537b31b946b26.38f728116050e697e55873f59a78047fefbef1475632241e266038ba376333db(p_owner_name,\n                                                          p_table_name,\n                                                          recs_get_partitions(i).partition_name);\n    END LOOP;\n\n\n\n   \n\n\n\n\n\n           v_prcs_stp := 'Enabling the Index of Partitions';\n           dbms_output.put_line(v_prcs_stp);\n           dbms_output.put_line('opening a cursor for Index Names');\n           OPEN  c_get_index_names(p_owner_name, p_table_name);\n           FETCH c_get_index_names BULK COLLECT INTO recs_get_index_names;\n           CLOSE c_get_index_names;\n           dbms_output.put_line('closing a cursor for Index Names');\n\n           v_prcs_stp := 'Rebuild Indexes after Compressing Partition';\n           FOR j IN 7d7ffa5b016d3d1c7cf82ab301d6dadc64f80b0e8a71e8f5d84c9125db8147af.553895e5e063ac6e43387e4f18a91e29..7d7ffa5b016d3d1c7cf82ab301d6dadc64f80b0e8a71e8f5d84c9125db8147af.41be50fc80e1234211b6c5a37e8fdbb9\n           LOOP\n               FOR i IN 40bdbdbb2f53f8bd1e6d1a10e89dc379d76c99327ad0913383df205f1ad70415.07f4dd260fecf0c31bad06cf354b1e62..40bdbdbb2f53f8bd1e6d1a10e89dc379d76c99327ad0913383df205f1ad70415.3ee46e182f9f30ed8605205ccd9a9d70\n               LOOP\n\n                     v_enb_ind_retval := de459e2fe7f96e4d958537b31b946b26.59c2c612b1a3187a72e464765bf9afe5b894ca47235060b55395c823d08aebbb\n                                            ( p_owner_name                          \n                                             ,p_table_name                          \n                                             ,recs_get_partitions(i).partition_name \n                                             ,recs_get_index_names(j).index_name    \n                                             );\n\n                     if  v_enb_ind_retval <> 0 then\n                         DBMS_OUTPUT.put_line ( 'Rebuild Index Failed for '\n                                            ||recs_get_partitions(i).partition_name\n                                            ||'-'\n                                            ||recs_get_index_names(j).index_name\n                                            );\n                         return v_enb_ind_retval;\n                     else\n                        DBMS_OUTPUT.put_line ( 'Rebuild Index Completed for '\n                                            ||recs_get_partitions(i).partition_name\n                                            ||'-'\n                                            ||recs_get_index_names(j).index_name\n                                            );\n                     end if;\n               END LOOP;\n           END LOOP;\n\n\n\n\n  <<Wrap_Program>>\n\n      v_prcs_stp := 'Final Commit';\n\n      COMMIT;\n      dbms_output.put_line('End Process '||CON_PROCESS_NAME);\n      dbms_output.put_line('End Time:'||TO_CHAR(SYSDATE,'YYYY-MM-DD HH24:MI:SS'));\n      RETURN 0;\n\n\n\nEXCEPTION\n   WHEN OTHERS\n   THEN\n         \n         DBMS_OUTPUT.put_line ('SQLERROR:' || SQLCODE || ',' || SQLERRM);\n         DBMS_OUTPUT.PUT_LINE(       v_prcs_nm\n                            ||' - '||v_prcs_stp\n                            ||' - '||v_prcs_pram);\n\n      RETURN -1;\nEND;\n/",
            "upstream_dependencies": [],
            "downstream_dependencies": [],
            "dag_location": "null",
            "gantt_location": "null",
            "created_at": "null",
            "updated_at": "null"
        },
        {
            "name": "FN_CUST_CORP_PYR_AGGR_LOAD",
            "encrypted_name": "8f7de65fd07824e2eb265c460d4cd197afe8a26aa5c9bd45f837d26a84cb4cac",
            "type": "function",
            "database": "null",
            "encrypted_database": "null",
            "schema": "XDMADM",
            "encrypted_schema": "0e03d5c46556a742ba46252698396ef2",
            "fully_qualified_name": "XDMADM.FN_CUST_CORP_PYR_AGGR_LOAD",
            "encrypted_fqn": "0e03d5c46556a742ba46252698396ef2.8f7de65fd07824e2eb265c460d4cd197afe8a26aa5c9bd45f837d26a84cb4cac",
            "synonyms": [],
            "metadata_analysis": "CREATE OR REPLACE FUNCTION \"0e03d5c46556a742ba46252698396ef2\".\"8f7de65fd07824e2eb265c460d4cd197afe8a26aa5c9bd45f837d26a84cb4cac\"\n   RETURN NUMBER IS\n   \n\n   l_fn_start                      DATE;\n   v_cust_corp_cnt                 NUMBER := 0;\n   v_cust_corp_pyr_aggr_cnt        NUMBER := 0;\n   l_load_tbl_cnt                  NUMBER := 0;\n   l_return_code                   NUMBER := 0;\n   l_object_nm                     VARCHAR2(30);\n   l_out_msg                       VARCHAR2(256);\n   v_out_msg                       VARCHAR2(256);\n   l_load_tbl_nm                   VARCHAR2(30);\n\n   c_success                 CONSTANT NUMBER := 0;\n   c_error                   CONSTANT NUMBER := 1;\n   c_schema                  CONSTANT VARCHAR2(30) := 'XDMADM';\n   c_aggr_tbl_syn_nm         CONSTANT VARCHAR2(30) := 'CUST_CORP_PYR_AGGR';\n   c_aggr_load_syn_nm        CONSTANT VARCHAR2(30) := 'CUST_CORP_PYR_AGGR_LOAD';\n\n\n   all_exceptions exception; \n   e_truncate_table exception;\n   e_analyze_table exception;\n   e_syn exception;\n\nBEGIN\n\n\n\n\n   EXECUTE IMMEDIATE 'SELECT table_name FROM user_synonyms WHERE synonym_name = ''' || c_aggr_load_syn_nm || ''''\n      INTO l_load_tbl_nm;\n\n\n\n   IF (c_aggr_tbl_syn_nm = l_load_tbl_nm) THEN\n      RAISE e_syn;\n   END IF;\n\n      \n   EXECUTE IMMEDIATE 'SELECT count(1) FROM ' || l_load_tbl_nm INTO l_load_tbl_cnt;\n\n   IF (l_load_tbl_cnt > 0) THEN\n      DBMS_OUTPUT.put_line('Load aggregate table has ' || l_load_tbl_nm || ' records in it');\n\n      l_return_code   := 8e64339f96bb08058f5d52f1c04f954a.8ffe4678890c39c7d4ed38c2ed759e24.e4b5db2b3f9b19accbb8cddbfcd05bac(l_out_msg, c_schema, l_load_tbl_nm);\n\n      DBMS_OUTPUT.put_line('Truncate table Return: ' || l_return_code || ' - ' || l_out_msg);\n\n      IF (l_return_code <> 0) THEN\n         l_object_nm   := l_load_tbl_nm;\n         RAISE e_truncate_table;\n      END IF;\n\n      DBMS_OUTPUT.put_line('Load aggregate table ' || l_load_tbl_nm ||' truncated');\n\n   END IF;\n\n   \n\n   \n\n    l_fn_start       := SYSDATE;\n\n\n                \n   SELECT COUNT(1) INTO  v_cust_corp_cnt\n   FROM (\n         SELECT distinct\n                pyr_seg_cd,\n                corp_mlt_unit_nbr,\n                trd_cls,\n                prnt_mlt_unit_cd,\n                \n                cust_cntrct_flg,\n                cust_natl_mngd_flg,\n                cust_acctblty_flg, CUST_ACQSTN_STAT_CRNT,CUST_ACQSTN_STAT_ACTL\n    FROM   de459e2fe7f96e4d958537b31b946b26.0ad6212deb7aa1fcea6c3846d02d7978cdc81057bcd87469c7825d00b68d1ace a) ;                                      \n\n\n   \n   DBMS_OUTPUT.put_line('Number of distinct cust attributes from Sales Pyramid Aggr is ' || v_cust_corp_cnt);\n\n\n\n         INSERT INTO de459e2fe7f96e4d958537b31b946b26.323243f2aa8db4e082ef5ed345b40143a31dd53d2d6cfbbd9546588c1ad0a6c4 (\n                pyr_seg_cd,\n                pyr_seg_desc,\n                corp_mlt_unit_nbr,\n                corp_mlt_unit_desc,\n                trd_cls,\n                trd_cls_desc,\n                prnt_mlt_unit_cd,\n                prnt_mlt_unit_desc,\n                \n                cust_cntrct_flg,                                                \n                cust_cntrct_stat_desc,                                          \n                cust_natl_mngd_flg,                                             \n                cust_mgt_typ_desc,                                              \n                cust_acctblty_flg,                                              \n                cust_acctblty_desc,                                             \n                usf_top_pyr_seg_cd,                                             \n                usf_top_pyr_seg_desc,                                           \n                usf_top_pyr_seg_sort_ord,                                       \n                pyr_seg_sort_ord,                                                \n                cust_acqstn_stat_crnt,cust_acqstn_stat_actl\n                )\n          SELECT DISTINCT\n                pyr_seg_cd,\n                pyr_seg_desc,\n                corp_mlt_unit_nbr,\n                corp_mlt_unit_desc,\n                trd_cls,\n                trd_cls_desc,\n                prnt_mlt_unit_cd,\n                prnt_mlt_unit_desc,\n                cust_cntrct_flg,                                                \n                cust_cntrct_stat_desc,                                          \n                cust_natl_mngd_flg,                                             \n                cust_mgt_typ_desc,                                              \n                cust_acctblty_flg,                                              \n                cust_acctblty_desc,                                             \n                usf_top_pyr_seg_cd,                                             \n                usf_top_pyr_seg_desc,                                           \n                usf_top_pyr_seg_sort_ord,                                       \n                pyr_seg_sort_ord,\n                cust_acqstn_stat_crnt,cust_acqstn_stat_actl\n         FROM\n             de459e2fe7f96e4d958537b31b946b26.0ad6212deb7aa1fcea6c3846d02d7978cdc81057bcd87469c7825d00b68d1ace a ;\n\n       COMMIT;\n\n\n      DBMS_OUTPUT.put_line(\n         'Inserted ' || sql%ROWCOUNT || ' rows in ' || TO_CHAR(ROUND((SYSDATE - l_fn_start) * 86400)) || ' seconds');\n\n      COMMIT;\n\n  \n\n   DBMS_OUTPUT.put_line('Analyze the Load aggregate table ' || l_load_tbl_nm);\n   l_return_code    := de459e2fe7f96e4d958537b31b946b26.9b3711c37bca8fd1d7c76527508615f9(c_schema, l_load_tbl_nm);\n\n   IF (l_return_code <> 0) THEN\n      l_object_nm   := l_load_tbl_nm;\n      RAISE e_analyze_table;\n   END IF;\n\n  \n\n      SELECT count(1) INTO v_cust_corp_pyr_aggr_cnt FROM de459e2fe7f96e4d958537b31b946b26.323243f2aa8db4e082ef5ed345b40143a31dd53d2d6cfbbd9546588c1ad0a6c4;\n  DBMS_OUTPUT.put_line('Number of records inserted into CUST_CORP_PYR_AGGR_LOAD is ' || v_cust_corp_pyr_aggr_cnt);\n\n   COMMIT;\n\n     \n  \n   If v_cust_corp_cnt = v_cust_corp_pyr_aggr_cnt\n   THEN\n   DBMS_OUTPUT.PUT_LINE('Distinct record count match the number of records inserted into cust_corp_pyr_aggr.');\n   RETURN 0;\n   ELSE\n   DBMS_OUTPUT.PUT_LINE('Distinct record count does not match the number of records inserted into cust_corp_pyr_aggr.');\n   RETURN 1;\n   END IF;\n\n  \nEXCEPTION\n   WHEN e_syn THEN\n      DBMS_OUTPUT.put_line(\n         'Synonym currently points to Load table: ' || c_aggr_load_syn_nm || '. Requires manual update.');\n      DBMS_OUTPUT.put_line('Verify the ' ||c_aggr_load_syn_nm|| ' and ' ||c_aggr_load_syn_nm|| ' synonyms');\n      RETURN 6726798abbc757d8442516fefb8c40e9.de3afdf274dc4a6f320906a012ba2f12;\n   WHEN e_truncate_table THEN\n      DBMS_OUTPUT.put_line('Error Truncating Table: ' || l_load_tbl_nm || '. Requires manual update.');\n      DBMS_OUTPUT.put_line('Verify '||l_load_tbl_nm||' table has any records');\n      DBMS_OUTPUT.put_line(l_out_msg);\n      RETURN 6726798abbc757d8442516fefb8c40e9.de3afdf274dc4a6f320906a012ba2f12;\n   WHEN e_analyze_table THEN\n      DBMS_OUTPUT.put_line('Error Analyzing Table: ' || l_load_tbl_nm || '. Requires manual update.');\n      DBMS_OUTPUT.put_line(l_out_msg);\n      RETURN 6726798abbc757d8442516fefb8c40e9.de3afdf274dc4a6f320906a012ba2f12;\n   WHEN OTHERS THEN\n      DBMS_OUTPUT.put_line('Error in 0e03d5c46556a742ba46252698396ef2.b3eb1c75b34367b150c2a867ce3a23aa6471a5458309a3c4563edaae6043aa4d:' || SQLCODE || ' ' || SQLERRM);\n      RETURN 1;\nEND;\n/",
            "upstream_dependencies": [],
            "downstream_dependencies": [],
            "dag_location": "null",
            "gantt_location": "null",
            "created_at": "null",
            "updated_at": "null"
        },
        {
            "name": "FN_CKBK_LNS_AGGR_LOAD",
            "encrypted_name": "4685302dcf9ba7457ce15bdafd11a15e33458271b6f4a5ac93cddb79fbe15687",
            "type": "function",
            "database": "null",
            "encrypted_database": "null",
            "schema": "XDMADM",
            "encrypted_schema": "0e03d5c46556a742ba46252698396ef2",
            "fully_qualified_name": "XDMADM.FN_CKBK_LNS_AGGR_LOAD",
            "encrypted_fqn": "0e03d5c46556a742ba46252698396ef2.4685302dcf9ba7457ce15bdafd11a15e33458271b6f4a5ac93cddb79fbe15687",
            "synonyms": [],
            "metadata_analysis": "CREATE OR REPLACE FUNCTION \"0e03d5c46556a742ba46252698396ef2\".\"4685302dcf9ba7457ce15bdafd11a15e33458271b6f4a5ac93cddb79fbe15687\" (p_odate        IN DATE,\n                               p_prev_yrs     IN NUMBER)\n   RETURN NUMBER AS\n   \n   c_success            CONSTANT NUMBER := 0;\n   c_error              CONSTANT NUMBER := 1;\n   c_schema             CONSTANT VARCHAR2(30) := 'XDMADM';\n   c_aggr_tbl_syn_nm    CONSTANT VARCHAR2(30) := 'CKBK_LNS_AGGR';\n   c_aggr_load_syn_nm   CONSTANT VARCHAR2(30) := 'CKBK_LNS_AGGR_LOAD';\n   l_return_code        NUMBER;\n   l_out_msg            VARCHAR2(256);\n   l_start_dt           DATE;\n\n   l_aggr_tbl_nm        VARCHAR2(30);\n   l_load_tbl_nm        VARCHAR2(30);\n\n   CURSOR c_get_wks(p_start_dt      DATE,\n                    p_end_dt        DATE) IS\n        SELECT fisc_yr_wk, MIN(clndr_dt) start_dt, MAX(clndr_dt) end_dt\n          FROM de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001\n         WHERE clndr_dt BETWEEN p_start_dt AND p_end_dt\n      GROUP BY fisc_yr_wk\n      ORDER BY fisc_yr_wk;\nBEGIN\n   \n   IF (p_odate IS NULL) THEN\n      DBMS_OUTPUT.put_line('Error: Invalid Parameters: Date is required');\n      RETURN c_error;\n   END IF;\n\n   IF (p_prev_yrs IS NULL) THEN\n      DBMS_OUTPUT.put_line('Error: Invalid Parameters: Previous years is required');\n      RETURN c_error;\n   END IF;\n\n   \n   SELECT MIN(clndr_dt)\n     INTO l_start_dt\n     FROM de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001\n    WHERE fisc_yr >= (SELECT fisc_yr - p_prev_yrs\n                        FROM de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001 t\n                       WHERE clndr_dt = p_odate)\n      AND clndr_dt >= TO_DATE('20140405', 'YYYYMMDD'); \n\n   DBMS_OUTPUT.put_line('Start Date: ' || TO_CHAR(l_start_dt, 'DD-MON-YYYY'));\n   DBMS_OUTPUT.put_line('End Date: ' || TO_CHAR(p_odate, 'DD-MON-YYYY'));\n\n   \n   EXECUTE IMMEDIATE 'SELECT table_name FROM user_synonyms WHERE synonym_name = ''' || c_aggr_tbl_syn_nm || ''''\n      INTO l_aggr_tbl_nm;\n\n   EXECUTE IMMEDIATE 'SELECT table_name FROM user_synonyms WHERE synonym_name = ''' || c_aggr_load_syn_nm || ''''\n      INTO l_load_tbl_nm;\n\n   DBMS_OUTPUT.put_line('Aggr Table: ' || l_aggr_tbl_nm);\n   DBMS_OUTPUT.put_line('Load Table: ' || l_load_tbl_nm);\n\n   \n   l_return_code   := 8e64339f96bb08058f5d52f1c04f954a.8ffe4678890c39c7d4ed38c2ed759e24.e4b5db2b3f9b19accbb8cddbfcd05bac(l_out_msg, c_schema, l_load_tbl_nm);\n   DBMS_OUTPUT.put_line('Truncate Load Table Return: ' || l_return_code || ' - ' || l_out_msg);\n\n   IF (l_return_code <> 0) THEN\n      DBMS_OUTPUT.put_line('Error: Failed to truncate table');\n      RETURN c_error;\n   END IF;\n\n   FOR r_get_wks IN c_get_wks(l_start_dt, p_odate) LOOP\n      INSERT \n            INTO de459e2fe7f96e4d958537b31b946b26.7646d994813e570aba59d2d566f793f6aeb3b259259f3eb44d6974432d60ba0e\n         (SELECT *\n            FROM (\n                    SELECT prcs_dt,\n                           div_nbr,\n                           cust_nbr,\n                           trans_typ,\n                           SUM(total_line) ln_cnt,\n                           SUM(lines_below_min) lt_min_ln_cnt,\n                           SUM(line_min_to_target) min_to_trgt_ln_cnt,\n                           SUM(line_tar_to_max) trgt_to_max_ln_cnt,\n                           SUM(line_above_max) gt_max_ln_cnt,\n                           SUM(lost_sales) lost_sales,\n                           TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')\n                      FROM (  SELECT de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.f5dd4374a3e3af6a775cb6d6b22e8162,\n                                     de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.839c4ffb4bfaae1bb58eab4dee67d96a,\n                                     de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.852fa1e9f02f1ca2c75837f7146b2381,\n                                     de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.26ac88e7ae671a1b22c14c2fce77aa2d,\n                                     COUNT(1) total_line,\n                                     SUM(CASE WHEN de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.f2e27750b8738746a93b585e377bbeb9 < ROUND(de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.c02e74c6971787fd0eaa4d40080633ca, 2) THEN 1 ELSE 0 END) lines_below_min,\n                                     SUM(CASE\n                                            WHEN de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.f2e27750b8738746a93b585e377bbeb9 >= ROUND(de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.c02e74c6971787fd0eaa4d40080633ca, 2)\n                                             AND de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.f2e27750b8738746a93b585e377bbeb9 < ROUND(de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.10cd025cb584bb436abe512327259b3d, 2) THEN\n                                               1\n                                            ELSE\n                                               0\n                                         END)\n                                        line_min_to_target,\n                                     SUM(CASE\n                                            WHEN de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.f2e27750b8738746a93b585e377bbeb9 >= ROUND(de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.10cd025cb584bb436abe512327259b3d, 2)\n                                             AND de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.f2e27750b8738746a93b585e377bbeb9 <= ROUND(de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.2c87c72e26ae40b93e2b103f6b022612, 2) THEN\n                                               1\n                                            ELSE\n                                               0\n                                         END)\n                                        line_tar_to_max,\n                                     SUM(CASE WHEN de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.f2e27750b8738746a93b585e377bbeb9 > ROUND(de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.2c87c72e26ae40b93e2b103f6b022612, 2) THEN 1 ELSE 0 END) line_above_max,\n                                     SUM(CASE\n                                            WHEN de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.f2e27750b8738746a93b585e377bbeb9 < ROUND(de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.c02e74c6971787fd0eaa4d40080633ca, 2) THEN\n                                               ((ROUND(de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.10cd025cb584bb436abe512327259b3d, 2) - de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.f2e27750b8738746a93b585e377bbeb9) * de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.ccf8d88f2d37f3171da2121ab22e9330)\n                                            ELSE\n                                               0\n                                         END)\n                                        lost_sales\n                                FROM de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c s,\n                                     de459e2fe7f96e4d958537b31b946b26.c50b6339218f0dbbd97ce6557f2b051f p,\n                                     de459e2fe7f96e4d958537b31b946b26.2c04d82ed0aa1cc9bce2cf2c0548b268 pim,\n                                     de459e2fe7f96e4d958537b31b946b26.52982d3bbc1ebc2720d9504c7ea2ed3f cc,\n                                     de459e2fe7f96e4d958537b31b946b26.dec387908a0954ddc8689c4ad37c8a3c srd\n\n                                     \n                               WHERE de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.2d45d761eb8d137835bca7a23010fab4 = de459e2fe7f96e4d958537b31b946b26.c50b6339218f0dbbd97ce6557f2b051f.2d45d761eb8d137835bca7a23010fab4\n                                 AND de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.839c4ffb4bfaae1bb58eab4dee67d96a = de459e2fe7f96e4d958537b31b946b26.c50b6339218f0dbbd97ce6557f2b051f.839c4ffb4bfaae1bb58eab4dee67d96a\n                                 AND de459e2fe7f96e4d958537b31b946b26.c50b6339218f0dbbd97ce6557f2b051f.d3268eabc4a7d98105fd85f9c9e62cd6e32ad436514bbe822b33de8bead744f3 = de459e2fe7f96e4d958537b31b946b26.2c04d82ed0aa1cc9bce2cf2c0548b268.d3268eabc4a7d98105fd85f9c9e62cd6e32ad436514bbe822b33de8bead744f3\n                                 AND de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.852fa1e9f02f1ca2c75837f7146b2381 = de459e2fe7f96e4d958537b31b946b26.52982d3bbc1ebc2720d9504c7ea2ed3f.852fa1e9f02f1ca2c75837f7146b2381\n                                 AND de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.839c4ffb4bfaae1bb58eab4dee67d96a = de459e2fe7f96e4d958537b31b946b26.52982d3bbc1ebc2720d9504c7ea2ed3f.839c4ffb4bfaae1bb58eab4dee67d96a\n                                \n                                 AND de459e2fe7f96e4d958537b31b946b26.dec387908a0954ddc8689c4ad37c8a3c.b8c6ab19cb6e726c38f24d1885346ea3 <> 'CC' \n                                 AND de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.a00b7aac034b1de6ebfabe4a7097af1b3c072b0281819f75f19257cd7009a1b3 <> '1' \n                                 AND de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.f5dd4374a3e3af6a775cb6d6b22e8162 BETWEEN 2fc4fb154cfb8fccabd9c2fa19592f04.e0bf9cba274479e39b5a223dac451955 AND 2fc4fb154cfb8fccabd9c2fa19592f04.6748b643d5446c67e5291dda9744f0db\n                                 \n                                 AND de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.dc15696e1e997bad6131bf936574f406 >= 1\n                                 AND de459e2fe7f96e4d958537b31b946b26.2c04d82ed0aa1cc9bce2cf2c0548b268.89f3df82917b692fe64dca942d924e7c NOT IN (97, 11) \n                                 AND de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.370a5aec6c948b64a7638f194c6ea1a7 <> 3 \n                               \n                               \n                                 AND de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.10cd025cb584bb436abe512327259b3d > 0\n                                 AND de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.467a168a7499c57b1859198a7dac7be0 IS NULL\n                                 AND de459e2fe7f96e4d958537b31b946b26.52982d3bbc1ebc2720d9504c7ea2ed3f.dd6238100904f569270d672fe0643a5a = '1'\n                                 AND nvl (de459e2fe7f96e4d958537b31b946b26.dec387908a0954ddc8689c4ad37c8a3c.c712a9ab5ef100c5807fa96123dac48b,'USF') = 'USF'\n                                 And nvl (de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.a2b201123c685e8cc48b5468cb4a449361bbd7bc0d2d67c7d7b11cb0a8d18d03, de459e2fe7f96e4d958537b31b946b26.dec387908a0954ddc8689c4ad37c8a3c.839c4ffb4bfaae1bb58eab4dee67d96a) = de459e2fe7f96e4d958537b31b946b26.dec387908a0954ddc8689c4ad37c8a3c.839c4ffb4bfaae1bb58eab4dee67d96a\n                                 \n                            GROUP BY de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.f5dd4374a3e3af6a775cb6d6b22e8162,\n                                     de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.839c4ffb4bfaae1bb58eab4dee67d96a,\n                                     de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.852fa1e9f02f1ca2c75837f7146b2381,\n                                     de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.26ac88e7ae671a1b22c14c2fce77aa2d) result\n                  GROUP BY prcs_dt,\n                           div_nbr,\n                           cust_nbr,\n                           trans_typ));\n\n      DBMS_OUTPUT.put_line('Inserted ' || sql%ROWCOUNT || ' rows for ' || 2fc4fb154cfb8fccabd9c2fa19592f04.f2de255a7553ba934b1f05ae7699ae4c);\n\n      COMMIT;\n   END LOOP;\n\n   \n   l_return_code   := de459e2fe7f96e4d958537b31b946b26.9b3711c37bca8fd1d7c76527508615f9(c_schema, l_load_tbl_nm);\n   DBMS_OUTPUT.put_line('Analyze Return: ' || l_return_code);\n\n   IF (l_return_code <> 0) THEN\n      DBMS_OUTPUT.put_line('Error: Failed to analyze table');\n      RETURN c_error;\n   END IF;\n\n   \n   l_return_code   := de459e2fe7f96e4d958537b31b946b26.f21751d25bb3675b2a3778f4f03c7da6(c_aggr_tbl_syn_nm, c_schema, l_load_tbl_nm);\n   DBMS_OUTPUT.put_line(\n      'Create synonym ' || c_aggr_tbl_syn_nm || ' for ' || c_schema || '.' || l_load_tbl_nm || ': ' || l_return_code);\n\n   IF (l_return_code <> 0) THEN\n      DBMS_OUTPUT.put_line('Error: Failed to create synonym for aggregate table');\n      RETURN c_error;\n   END IF;\n\n   l_return_code   := de459e2fe7f96e4d958537b31b946b26.f21751d25bb3675b2a3778f4f03c7da6(c_aggr_load_syn_nm, c_schema, l_aggr_tbl_nm);\n   DBMS_OUTPUT.put_line(\n      'Create synonym ' || c_aggr_load_syn_nm || ' for ' || c_schema || '.' || l_aggr_tbl_nm || ': ' || l_return_code);\n\n   IF (l_return_code <> 0) THEN\n      DBMS_OUTPUT.put_line('Error: Failed to create synonym for aggregate table');\n      RETURN c_error;\n   END IF;\n\n   \n   l_return_code   := 8e64339f96bb08058f5d52f1c04f954a.8ffe4678890c39c7d4ed38c2ed759e24.e4b5db2b3f9b19accbb8cddbfcd05bac(l_out_msg, c_schema, l_aggr_tbl_nm);\n   DBMS_OUTPUT.put_line('Truncate Prev Aggr Table Return: ' || l_return_code || ' - ' || l_out_msg);\n\n   IF (l_return_code <> 0) THEN\n      DBMS_OUTPUT.put_line('Error: Failed to truncate table');\n      RETURN c_error;\n   END IF;\n\n   \n   UPDATE de459e2fe7f96e4d958537b31b946b26.0b3320d3f985cd20d1ec65d9dfeed2de\n      SET div_load_ts   = p_odate\n    WHERE fact_table = 'CKBK_LNS_AGGR'\n      AND div_nbr = 0;\n\n   IF (sql%ROWCOUNT = 0) THEN\n      INSERT INTO de459e2fe7f96e4d958537b31b946b26.0b3320d3f985cd20d1ec65d9dfeed2de(fact_table, div_nbr, fact_table_dsply_nm, fact_typ_desc, div_load_ts)\n          VALUES ('CKBK_LNS_AGGR',\n                  0,\n                  'COOKBOOK LINES AGG',\n                  'COOKBOOK LINES AGG',\n                  p_odate);\n\n      DBMS_OUTPUT.put_line('Inserted row in FACT_LOAD_STAT');\n   ELSE\n      DBMS_OUTPUT.put_line('Updated row in FACT_LOAD_STAT');\n   END IF;\n\n   COMMIT;\n\n   RETURN c_success;\nEXCEPTION\n   WHEN OTHERS THEN\n      DBMS_OUTPUT.put_line('Unexepected error');\n      DBMS_OUTPUT.put_line(SQLCODE || ': ' || SQLERRM);\n      RETURN c_error;\nEND fn_ckbk_lns_aggr_load;\n/",
            "upstream_dependencies": [],
            "downstream_dependencies": [],
            "dag_location": "null",
            "gantt_location": "null",
            "created_at": "null",
            "updated_at": "null"
        },
        {
            "name": "FN_AUGEO_CUST_EXTRCT",
            "encrypted_name": "2d75038dfcaa622736f8f8931b90d666fe9bab5e0563d804ec3773118c5fcdd7",
            "type": "function",
            "database": "null",
            "encrypted_database": "null",
            "schema": "XDMADM",
            "encrypted_schema": "0e03d5c46556a742ba46252698396ef2",
            "fully_qualified_name": "XDMADM.FN_AUGEO_CUST_EXTRCT",
            "encrypted_fqn": "0e03d5c46556a742ba46252698396ef2.2d75038dfcaa622736f8f8931b90d666fe9bab5e0563d804ec3773118c5fcdd7",
            "synonyms": [],
            "metadata_analysis": "CREATE OR REPLACE FUNCTION \"0e03d5c46556a742ba46252698396ef2\".\"2d75038dfcaa622736f8f8931b90d666fe9bab5e0563d804ec3773118c5fcdd7\" (p_partner_id IN VARCHAR2, p_odate IN   VARCHAR2 )\n   RETURN NUMBER\nIS\n\n\n   \n   c_quote                 VARCHAR2 (1)  := '\"';\n   c_comma               VARCHAR2 (1)    := ',';\n   v_prd_tbl_name        VARCHAR2 (24)   := 'AUGEO_CUST_EXTRCT';\n   v_fn_name             VARCHAR2 (25)   := 'FN_augeo_cust_Extrct';\n   v_owner               VARCHAR2 (9)    := 'XDMADM';\n   v_return_message      VARCHAR2 (2000) := NULL;\n   wkstartdate           VARCHAR2 (14);\n   wkenddate             VARCHAR2 (14);\n   v_ret_val             number := 0;\n   v_ret_cd              number:= 0 ;\n   out_msg               VARCHAR2(500)   := null;\n\nBEGIN\n\n   dbms_output.put_line('START of function ' || v_owner || '.' || v_fn_name);\n   dbms_output.put_line('...');\n\n\n   \n\n   BEGIN\n      DBMS_OUTPUT.PUT_LINE('...truncating  ' || UPPER(RTRIM(SUBSTR(p_partner_id, 1, 30))));\n      DBMS_OUTPUT.PUT_LINE('...         table : ' || v_owner || '.' || v_prd_tbl_name);\n\n    \n    v_ret_cd := 8e64339f96bb08058f5d52f1c04f954a.8ffe4678890c39c7d4ed38c2ed759e24.e4b5db2b3f9b19accbb8cddbfcd05bac(out_msg, v_owner,  v_prd_tbl_name );\n    IF v_ret_cd <> 0 THEN\n      \n      dbms_output.put_line('end of function ' || v_owner || '.' || v_fn_name);\n      dbms_output.put_line('...Error '|| out_msg);\n     return 2;\n    END IF;\n\n   END;\n\n         DBMS_OUTPUT.PUT_LINE('...Inserting ' || UPPER(RTRIM(SUBSTR(p_partner_id, 1, 30))));\n         DBMS_OUTPUT.PUT_LINE('...         into table : ' || v_owner || '.' || v_prd_tbl_name);\n         DBMS_OUTPUT.PUT_LINE('...Input Parameters Used: PARTNER_ID = ' || UPPER(RTRIM(SUBSTR(p_partner_id, 1, 30))));\n\n\n            INSERT  INTO 0e03d5c46556a742ba46252698396ef2.0c13bd040e5a63bc7c0d7f4e95c32c6457a3138978a711d200b2c78dfa82e0b5\n             NOLOGGING  (KEY_augeo_cust, DATA_augeo_cust)\n              WITH  user_emp\n       AS (SELECT   user_id,\n                    empl_id from 44cd8de7764b0234957157bb429c40da.9be248913a43f1927ba37b04a74f806857a3138978a711d200b2c78dfa82e0b5)\n           SELECT DISTINCT      UPPER(RTRIM( SUBSTR ('AUGEO_CUST', 1, 30))),\n                     '\"' ||\n                     TRIM(NVL(TRANSLATE(d2450100e2dda59c2b7828b4daff7f8c.852fa1e9f02f1ca2c75837f7146b2381,'*^|><@\"~`&',' '),' '))\n                     ||'\",\"' ||\n                     TRIM(NVL(LTRIM(TRANSLATE(d2450100e2dda59c2b7828b4daff7f8c.02af48720d7c4c3231cab77de091b7fe,'*^|><@\"~`&',' ')),'NAME blank IN db'))\n                     ||'\",\"' ||\n                     TRIM(NVL(LTRIM(TRANSLATE(d2450100e2dda59c2b7828b4daff7f8c.b8470fd4a80c466033b2900155294c26,'*^|><@\"~`&','        ')),'Address_1 blank IN db'))\n                     ||'\",\"' ||\n                     TRIM(NVL(LTRIM(TRANSLATE(d2450100e2dda59c2b7828b4daff7f8c.c294022725192581b7613157a1233c72,'*^|><@\"~`&','        ')),'Address_2 blank IN db'))\n                     ||'\",\"' ||\n                     TRIM(NVL(LTRIM(TRANSLATE(d2450100e2dda59c2b7828b4daff7f8c.c67cd1eafed9a912b9b48d7e6c4694d4,'*^|><@\"~`&','     ')),'City blank IN db'))\n                     ||'\",\"' ||\n                     TRIM(UPPER(NVL(TRANSLATE(d2450100e2dda59c2b7828b4daff7f8c.d98d3ca2a5822014db94b4455903ab3e,'*^|><@\"~`&','      '),'XX')))\n                     ||'\",\"' ||\n                     TRIM(NVL(TRANSLATE(d2450100e2dda59c2b7828b4daff7f8c.2e59c8c02a6a241d22d0536e2f80b067,'*^|><@\"~`&','         '),' '))\n                     ||'\",\"' ||\n                     TRIM(NVL(TRANSLATE(d2450100e2dda59c2b7828b4daff7f8c.7e9d21ce10aa1196ee51702551eb3e38,'*^|><@\"~`&','         '),' '))\n                     ||'\",\"' ||\n                     TRIM(NVL(TRANSLATE(d2450100e2dda59c2b7828b4daff7f8c.292d6af66d8c2559591277fc89608331,'*^|><@\"~`&','         '),' '))\n                     ||'\",\"' ||\n                     TRIM(NVL(TRANSLATE(d2450100e2dda59c2b7828b4daff7f8c.d22ea0aab4887a6dc362a76ddabd5448,'*^|><@\"~`&','         '),' '))\n                     ||'\",\"' ||\n                     TRIM(TRANSLATE(d2450100e2dda59c2b7828b4daff7f8c.839c4ffb4bfaae1bb58eab4dee67d96a,'*^|><@\"~`&','         '))\n                     ||'\",\"' ||\n                     TRIM(NVL(LTRIM(TRANSLATE(d2450100e2dda59c2b7828b4daff7f8c.ade99ff2caaeda3ac0852ddd400c0e28,'*^|><@\"~`&','         ')),' '))\n                     ||'\",\"' ||\n                     TRIM(NVL(LTRIM(TRANSLATE(d2450100e2dda59c2b7828b4daff7f8c.f7dd46abd36aa954fe77afba03bc8220,'*^|><@\"~`&','         ')),' '))\n                     ||'\",\"' ||\n                     TRIM(NVL(LTRIM(TRANSLATE(d2450100e2dda59c2b7828b4daff7f8c.58b87fef0b56bd2bd029967f2dfe557998df5d6b623334f2e9631188cca4cfd6,'*^|><@\"~`&','         ')),' '))\n                     ||'\",\"' ||\n                     TRIM(NVL(LTRIM(TRANSLATE(d2450100e2dda59c2b7828b4daff7f8c.f3c7ed306cc6a6b3d6cfb40db08ba919fce896ca0fbbf5a5d330f2803036eb44,'*^|><@\"~`&','         ')),' '))\n                     ||'\",\"' ||\n                     TRIM(NVL(LTRIM(TRANSLATE(d2450100e2dda59c2b7828b4daff7f8c.08b6aa5eab6b272450e6b379337146c0,'*^|><@\"~`&','         ')),' '))\n                     ||'\",\"' ||\n                     TRIM(NVL(LTRIM(TRANSLATE(d2450100e2dda59c2b7828b4daff7f8c.016474219f1f6d57bc90a3442bfc1709,'*^|><@\"~`&','         ')),' '))\n                     ||'\",\"' ||\n                     TRIM(NVL(LTRIM(TRANSLATE(d2450100e2dda59c2b7828b4daff7f8c.78c428af503aef49e56f3955f8f74fa5,'*^|><@\"~`&','         ')),' '))\n                     ||'\",\"' ||\n                     TRIM(NVL(LTRIM(TRANSLATE(d2450100e2dda59c2b7828b4daff7f8c.ea2a6fac3818a6a2522f130f8418653f,'*^|><@\"~`&','         ')),' '))\n                     ||'\",\"' ||\n                     TRIM(NVL(LTRIM(TRANSLATE(d2450100e2dda59c2b7828b4daff7f8c.17a070f45558c000ef488aabe8b430c2,'*^|><@\"~`&','         ')),' '))\n                     ||'\",\"' ||\n                     TRIM(NVL(LTRIM(TRANSLATE(6d9b37be5a083f8b78d676aba846c823.8b78bca74c200ef55dc944fae0f72a56,'*^|><@\"~`&','         ')),' '))\n                     ||'\",\"' ||\n                     TRIM(NVL(LTRIM(TRANSLATE(6d9b37be5a083f8b78d676aba846c823.4855453efe73ff0bd0f7583df58260dd,'*^|><@\"~`&','         ')),' '))\n                     ||'\",\"' ||\n                     TRIM(NVL(LTRIM(TRANSLATE(DECODE(d2450100e2dda59c2b7828b4daff7f8c.5112ab47fb19df73f8ed2678ddc0ecdbe6e6300089dae5a98e31814d0406060f,'000','   ','UNK','   ',d2450100e2dda59c2b7828b4daff7f8c.5112ab47fb19df73f8ed2678ddc0ecdbe6e6300089dae5a98e31814d0406060f),'*^|><@\"~`&','         ')),' '))\n                     ||'\",\"' ||\n                     TRIM(NVL(LTRIM(TRANSLATE(DECODE(d2450100e2dda59c2b7828b4daff7f8c.3377a56ac3a8caf2bec5d2e95319521415ebda0b6e5cc8d4c919a8c71a9d07e4,'Valid Code','   ','DEFAULT VALUE FOR Reference','   ',d2450100e2dda59c2b7828b4daff7f8c.3377a56ac3a8caf2bec5d2e95319521415ebda0b6e5cc8d4c919a8c71a9d07e4),'*^|><@\"~`&','         ')),' '))\n                     ||'\",\"' ||\n                     TRIM(NVL(LTRIM(TRANSLATE(DECODE(d2450100e2dda59c2b7828b4daff7f8c.5b166c5fe66db413f1e228635901a096e32f6dd38f333cde68119d1f277367cd,'UNK','   ',d2450100e2dda59c2b7828b4daff7f8c.5b166c5fe66db413f1e228635901a096e32f6dd38f333cde68119d1f277367cd),'*^|><@\"~`&','         ')),' '))\n                     ||'\",\"' ||\n                     TRIM(NVL(LTRIM(TRANSLATE(DECODE(d2450100e2dda59c2b7828b4daff7f8c.9033b904a17dc722bf77fb076a267f1515ebda0b6e5cc8d4c919a8c71a9d07e4,'UNKNOWN','   ',d2450100e2dda59c2b7828b4daff7f8c.9033b904a17dc722bf77fb076a267f1515ebda0b6e5cc8d4c919a8c71a9d07e4),'*^|><@\"~`&','         ')),' '))\n                     ||'\",\"' ||\n                     TRIM(NVL(LTRIM(TRANSLATE(d2450100e2dda59c2b7828b4daff7f8c.116f2cd181d527334694326f442fe0b4,'*^|><@\"~`&','         ')),' '))\n                     ||'\",\"' ||\n                     TRIM(NVL(LTRIM(TRANSLATE(d2450100e2dda59c2b7828b4daff7f8c.60425c3a30e707860f8c49e4d570e105,'*^|><@\"~`&','         ')),' '))\n                     ||'\",\"' ||\n                     TRIM(NVL(LTRIM(TRANSLATE(d2450100e2dda59c2b7828b4daff7f8c.72dc428b3abefe008be0a8e1a56cc26e,'*^|><@\"~`&','         ')),' '))\n                     ||'\",\"' ||\n                     TRIM(NVL(LTRIM(TRANSLATE(d2450100e2dda59c2b7828b4daff7f8c.aa7b5e6986ce32ac25fa082282dfc40a,'*^|><@\"~`&','         ')),' '))\n                     ||'\",\"' ||\n                     TRIM(NVL(LTRIM(TRANSLATE(045e8935e1c2fd0adc47d5be3e82b5c8.d3bf6a02136dbf2e2bb717980d5bb171,'*^|><@\"~`&','         ')),' '))\n                     ||'\",\"' ||\n                     TRIM(NVL(LTRIM(TRANSLATE(1e956b5722c4a8bb6192646e15f402d4.d3bf6a02136dbf2e2bb717980d5bb171,'*^|><@\"~`&','         ')),' '))\n                     ||'\",\"' ||\n                     TRIM(NVL(LTRIM(TRANSLATE(e348cd959cea5b29b6ed565cef7e9b0e.d3bf6a02136dbf2e2bb717980d5bb171,'*^|><@\"~`&','         ')),' '))\n                     ||'\",\"' ||\n                     TRIM(NVL(LTRIM(TRANSLATE(d2450100e2dda59c2b7828b4daff7f8c.0e5400811a26142f22e82e8c549073a6,'*^|><@\"~`&','         ')),' '))\n                     ||'\",\"' ||\n                     TRIM(NVL(LTRIM(TRANSLATE(d2450100e2dda59c2b7828b4daff7f8c.00cdbed4bd71948125ed2b15120f691651dd26a73c58dc7a9a33b2c1a62da4d3,'*^|><@\"~`&','         ')),' '))\n                     ||'\",\"' ||\n                     TRIM(NVL(LTRIM(TRANSLATE(d2450100e2dda59c2b7828b4daff7f8c.4c519ea2261e05bc61c96b41c134952f0a12b52193ec2e9d203d998bbff069f9,'*^|><@\"~`&','         ')),' '))\n                     ||'\",\"' ||\n                     TRIM(NVL(LTRIM(TRANSLATE(d2450100e2dda59c2b7828b4daff7f8c.e33988f12139bfc93f1e7557137feb5a29e110ac67769beb8c9647cf15a66d38,'*^|><@\"~`&','         ')),' '))\n                     ||'\",\"' ||\n                     TRIM(NVL(LTRIM(TRANSLATE(d2450100e2dda59c2b7828b4daff7f8c.94b0fcb8f7084e8c64dd4b5bb9f0ca64,'*^|><@\"~`&','         ')),' '))\n                     ||'\",\"' ||\n                     TRIM(NVL(LTRIM(TRANSLATE(d2450100e2dda59c2b7828b4daff7f8c.156f54b388a4986aa3d3d8e74d0fc0cd,'*^|><@\"~`&','         ')),' '))\n                     ||'\",\"' ||\n                     TRIM(NVL(LTRIM(TRANSLATE(d2450100e2dda59c2b7828b4daff7f8c.b0244019950c3493f027ab46f08f4a24,'*^|><@\"~`&','         ')),' '))\n                     ||'\",\"' ||\n                     TRIM(NVL(LTRIM(TRANSLATE(d2450100e2dda59c2b7828b4daff7f8c.7190e92bd222014102cfd9666cf8958b,'*^|><@\"~`&','         ')),' '))\n                     ||'\"'\n              FROM 0e03d5c46556a742ba46252698396ef2.dec387908a0954ddc8689c4ad37c8a3c b,\n                   0e03d5c46556a742ba46252698396ef2.52982d3bbc1ebc2720d9504c7ea2ed3f c,\n                   user_emp tm_id, user_emp dsm_id,user_emp rsm_id\n              WHERE 6d9b37be5a083f8b78d676aba846c823.3ad9e70cf16862b1ecd4e1a0ecde3783 IS NULL\n              AND   d2450100e2dda59c2b7828b4daff7f8c.839c4ffb4bfaae1bb58eab4dee67d96a = 6d9b37be5a083f8b78d676aba846c823.839c4ffb4bfaae1bb58eab4dee67d96a\n              AND   d2450100e2dda59c2b7828b4daff7f8c.dd6238100904f569270d672fe0643a5a = '1'\n              AND   d2450100e2dda59c2b7828b4daff7f8c.3ad9e70cf16862b1ecd4e1a0ecde3783 IS NULL\n              AND   d2450100e2dda59c2b7828b4daff7f8c.016474219f1f6d57bc90a3442bfc1709 = e348cd959cea5b29b6ed565cef7e9b0e.d9b20f4b35d5639078e9ce32cf0724c5(+)\n              AND   d2450100e2dda59c2b7828b4daff7f8c.f3c7ed306cc6a6b3d6cfb40db08ba919fce896ca0fbbf5a5d330f2803036eb44 = 1e956b5722c4a8bb6192646e15f402d4.d9b20f4b35d5639078e9ce32cf0724c5(+)\n              AND   d2450100e2dda59c2b7828b4daff7f8c.72dc428b3abefe008be0a8e1a56cc26e = 045e8935e1c2fd0adc47d5be3e82b5c8.d9b20f4b35d5639078e9ce32cf0724c5(+)\n              ;\n\n         COMMIT;\n         DBMS_OUTPUT.PUT_LINE('...End of  Insert ' || UPPER(RTRIM(SUBSTR(p_partner_id, 1, 30))));\n         DBMS_OUTPUT.PUT_LINE('...Count  Insert ' || UPPER(RTRIM(SUBSTR(p_partner_id, 1, 30))));\n\n\n            INSERT  INTO  0e03d5c46556a742ba46252698396ef2.0c13bd040e5a63bc7c0d7f4e95c32c6457a3138978a711d200b2c78dfa82e0b5\n             NOLOGGING (KEY_augeo_cust, DATA_augeo_cust)\n              SELECT DISTINCT\n                     UPPER(RTRIM( SUBSTR ('AUGEO_CUST', 1, 30))),\n                     '\"Customer Master\",'\n                     ||\n                      COUNT(*)\n              FROM 0e03d5c46556a742ba46252698396ef2.0c13bd040e5a63bc7c0d7f4e95c32c6457a3138978a711d200b2c78dfa82e0b5\n              WHERE key_augeo_cust = UPPER(RTRIM( SUBSTR ('AUGEO_CUST', 1, 30))) ;\n\n         COMMIT;\n         DBMS_OUTPUT.PUT_LINE('...End of Count Insert ' || UPPER(RTRIM(SUBSTR(p_partner_id, 1, 30))));\n\n      DBMS_OUTPUT.PUT_LINE('...');\n      DBMS_OUTPUT.PUT_LINE('END of function ' || v_owner || '.' || v_fn_name);\n      RETURN 0;\n\n\nEXCEPTION\n   WHEN NO_DATA_FOUND THEN\n      DBMS_OUTPUT.PUT_LINE('...ERROR inserting into table ' || v_owner || '.' || v_prd_tbl_name);\n      DBMS_OUTPUT.PUT_LINE('...SQLERRM: ' || SQLERRM);\n      DBMS_OUTPUT.PUT_LINE('...SQLCODE: ' || SQLCODE);\n      DBMS_OUTPUT.PUT_LINE('END of function ' || v_owner || '.' || v_fn_name);\n      RETURN 2;\n   WHEN OTHERS THEN\n      ROLLBACK;\n      DBMS_OUTPUT.PUT_LINE('...ERROR inserting into table ' || v_owner || '.' || v_prd_tbl_name);\n      DBMS_OUTPUT.PUT_LINE('...SQLERRM: ' || SQLERRM);\n      DBMS_OUTPUT.PUT_LINE('...SQLCODE: ' || SQLCODE);\n      DBMS_OUTPUT.PUT_LINE('END of function ' || v_owner || '.' || v_fn_name);\n      RETURN 3;\nEND fn_augeo_cust_extrct;\n/",
            "upstream_dependencies": [],
            "downstream_dependencies": [],
            "dag_location": "null",
            "gantt_location": "null",
            "created_at": "null",
            "updated_at": "null"
        },
        {
            "name": "FN_SWITCH_SYNONYM",
            "encrypted_name": "590e6463ac088fe2368334fe0bbd95feabdf79d26e6b64e5df538ee9f33855da",
            "type": "function",
            "database": "null",
            "encrypted_database": "null",
            "schema": "XDMADM",
            "encrypted_schema": "0e03d5c46556a742ba46252698396ef2",
            "fully_qualified_name": "XDMADM.FN_SWITCH_SYNONYM",
            "encrypted_fqn": "0e03d5c46556a742ba46252698396ef2.590e6463ac088fe2368334fe0bbd95feabdf79d26e6b64e5df538ee9f33855da",
            "synonyms": [],
            "metadata_analysis": "CREATE OR REPLACE FUNCTION \"0e03d5c46556a742ba46252698396ef2\".\"590e6463ac088fe2368334fe0bbd95feabdf79d26e6b64e5df538ee9f33855da\"\n(v_schema_name in varchar2, v_synonym_name in varchar2)\n      RETURN NUMBER\n   AS\n   v_prcs_nm            varchar2(50) := 'de459e2fe7f96e4d958537b31b946b26.2106304afe0251f8ac5c8d66717c423598df5d6b623334f2e9631188cca4cfd6 ';\n   v_prcs_stp           varchar2(200);\n   n_ret                number(1);\n   v_table_name         varchar(100);\n\nBEGIN\n\n\n\n\n<<SELECT_INCT_TABLE>>\n\n   v_prcs_stp := 'Select table to which the synonym will be switched';\n   SELECT tbl_nm INTO v_table_name\n     FROM 9751bbbcfea690cc0be4d58830a6fe2e.56ac3befbcbada23fa9268d8fe6d5242\n    WHERE actv_ind = 'N'\n      AND synonym_nm = v_synonym_name;\n\n   dbms_output.put_line('Table to which synonym will be switched:'||v_table_name);\n\n\n\n\n   v_prcs_stp := 'Switch the synonym';\n   n_ret := 0e03d5c46556a742ba46252698396ef2.f21751d25bb3675b2a3778f4f03c7da6(v_synonym_name, v_schema_name,v_table_name);\n   v_prcs_stp := 'Synonym successfully switched';\n\n\n\n\n   v_prcs_stp := 'Updating Synonym Switching Table';\n   UPDATE 9751bbbcfea690cc0be4d58830a6fe2e.56ac3befbcbada23fa9268d8fe6d5242\n    SET actv_ind = 'N',\n    last_updt = sysdate\n    WHERE actv_ind = 'Y'\n    AND synonym_nm = v_synonym_name;\n\n   UPDATE 9751bbbcfea690cc0be4d58830a6fe2e.56ac3befbcbada23fa9268d8fe6d5242\n    SET actv_ind = 'Y',\n    last_updt = sysdate\n    WHERE tbl_nm = v_table_name\n    AND synonym_nm = v_synonym_name;\n\n    COMMIT;\n    RETURN 0;\n\nEXCEPTION\n    WHEN NO_DATA_FOUND THEN\n        DBMS_OUTPUT.PUT_LINE(v_prcs_nm||' - '||v_prcs_stp);\n        DBMS_OUTPUT.put_line ('ERROR: Synonym name does not exist or synonym invalid. Failed at the above step.');\n        DBMS_OUTPUT.put_line ('ERROR:' || SQLCODE || ',' || SQLERRM);\n      RETURN 3;\n    WHEN OTHERS THEN\n        DBMS_OUTPUT.PUT_LINE(v_prcs_nm||' - '||v_prcs_stp);\n        DBMS_OUTPUT.put_line ('ERROR:' || SQLCODE || ',' || SQLERRM);\n        ROLLBACK;\n        RETURN 2;\nEND;\n/",
            "upstream_dependencies": [],
            "downstream_dependencies": [],
            "dag_location": "null",
            "gantt_location": "null",
            "created_at": "null",
            "updated_at": "null"
        },
        {
            "name": "FN_RNK_USR_DIV_ALL_VPD",
            "encrypted_name": "c54d261e5e8cdaaca4095a3e178a17fbc34d4c636f81fbc24dcc4928e333a28e",
            "type": "function",
            "database": "null",
            "encrypted_database": "null",
            "schema": "XDMADM",
            "encrypted_schema": "0e03d5c46556a742ba46252698396ef2",
            "fully_qualified_name": "XDMADM.FN_RNK_USR_DIV_ALL_VPD",
            "encrypted_fqn": "0e03d5c46556a742ba46252698396ef2.c54d261e5e8cdaaca4095a3e178a17fbc34d4c636f81fbc24dcc4928e333a28e",
            "synonyms": [],
            "metadata_analysis": "CREATE OR REPLACE FUNCTION \"0e03d5c46556a742ba46252698396ef2\".\"c54d261e5e8cdaaca4095a3e178a17fbc34d4c636f81fbc24dcc4928e333a28e\" (p_schema       IN VARCHAR2,\n                                                         p_objname      IN VARCHAR2)\n   RETURN VARCHAR2 AS\n   \n   c_start                CONSTANT NUMBER := DBMS_UTILITY.get_time;\n   c_fn_nm                CONSTANT VARCHAR2(30) := 'FN_RNK_USR_DIV_ALL_VPD';\n   l_security_predicate   VARCHAR2(4000) DEFAULT NULL;\n   l_cur_sql              VARCHAR2(4000) := SYS_CONTEXT('USERENV', 'CURRENT_SQL');\n   l_sbjct_area           VARCHAR2(100) := SYS_CONTEXT(9751bbbcfea690cc0be4d58830a6fe2e.9bfb5eb7793dc8fa6800d5a61e5e3e4e1e2f6ec194927f064ce6cb31fba71a32.f4a54ebc6f2c591ed4266aafe66971af, 9751bbbcfea690cc0be4d58830a6fe2e.9bfb5eb7793dc8fa6800d5a61e5e3e4e1e2f6ec194927f064ce6cb31fba71a32.3b1288ed835b1b524e9500bb13544956e6e6300089dae5a98e31814d0406060f);\n   l_vpd_exempt           VARCHAR2(1) := SYS_CONTEXT(9751bbbcfea690cc0be4d58830a6fe2e.9bfb5eb7793dc8fa6800d5a61e5e3e4e1e2f6ec194927f064ce6cb31fba71a32.f4a54ebc6f2c591ed4266aafe66971af, 9751bbbcfea690cc0be4d58830a6fe2e.9bfb5eb7793dc8fa6800d5a61e5e3e4e1e2f6ec194927f064ce6cb31fba71a32.0eaf613ab52a53601d1496b5650de81e);\n   l_all_divs             VARCHAR2(1) := SYS_CONTEXT(9751bbbcfea690cc0be4d58830a6fe2e.9bfb5eb7793dc8fa6800d5a61e5e3e4e1e2f6ec194927f064ce6cb31fba71a32.f4a54ebc6f2c591ed4266aafe66971af, 9751bbbcfea690cc0be4d58830a6fe2e.9bfb5eb7793dc8fa6800d5a61e5e3e4e1e2f6ec194927f064ce6cb31fba71a32.0f460756ee76d4a2460733464cda5f95);\n\n   l_div_count            NUMBER := 0;\n   l_first                BOOLEAN := TRUE;\n\n   CURSOR divs_c(p_user          VARCHAR2,\n                 p_sbjct_area    VARCHAR2) IS\n      SELECT DISTINCT CASE WHEN de459e2fe7f96e4d958537b31b946b26.dec387908a0954ddc8689c4ad37c8a3c.131a6c02fd88c7a4f0e7bee7bac39796 = 'SALES' THEN 'G_' || de459e2fe7f96e4d958537b31b946b26.dec387908a0954ddc8689c4ad37c8a3c.aa3822ab810afd27b14c86ae8e9d99cc ELSE 'D_' || de459e2fe7f96e4d958537b31b946b26.dec387908a0954ddc8689c4ad37c8a3c.4855453efe73ff0bd0f7583df58260dd END div_nbr\n        FROM 9751bbbcfea690cc0be4d58830a6fe2e.77f574c4275330a2ed961a49e2cb2df5 ud, de459e2fe7f96e4d958537b31b946b26.dec387908a0954ddc8689c4ad37c8a3c dc\n       WHERE 9751bbbcfea690cc0be4d58830a6fe2e.77f574c4275330a2ed961a49e2cb2df5.839c4ffb4bfaae1bb58eab4dee67d96a = de459e2fe7f96e4d958537b31b946b26.dec387908a0954ddc8689c4ad37c8a3c.839c4ffb4bfaae1bb58eab4dee67d96a\n         AND UPPER(usr_nm) = p_user\n         AND sbjct_area IN (p_sbjct_area, 'ALL');\n\n   divs_rec               divs_c%ROWTYPE;\nBEGIN\n   \n   IF l_sbjct_area IS NULL THEN\n      l_security_predicate   := '1=2';\n      9751bbbcfea690cc0be4d58830a6fe2e.d4abe88ed2062b430c927bc84d61faf1f9a7aadf5998d448c2e2d1b0b47a3056.7d64937276682b23a0e16e5c61dad7aa('NO SA',\n                                          c_fn_nm,\n                                          USER,\n                                          p_schema,\n                                          p_objname,\n                                          l_sbjct_area,\n                                          l_vpd_exempt,\n                                          l_all_divs,\n                                          l_cur_sql,\n                                          l_security_predicate,\n                                          (DBMS_UTILITY.get_time - c_start) / 100);\n\n      RETURN l_security_predicate;\n   END IF;\n\n   \n   \n   IF l_vpd_exempt = 'Y' THEN\n      l_security_predicate   := '1=1';\n      9751bbbcfea690cc0be4d58830a6fe2e.d4abe88ed2062b430c927bc84d61faf1f9a7aadf5998d448c2e2d1b0b47a3056.7d64937276682b23a0e16e5c61dad7aa('EXEMPT',\n                                          c_fn_nm,\n                                          USER,\n                                          p_schema,\n                                          p_objname,\n                                          l_sbjct_area,\n                                          l_vpd_exempt,\n                                          l_all_divs,\n                                          l_cur_sql,\n                                          l_security_predicate,\n                                          (DBMS_UTILITY.get_time - c_start) / 100);\n\n      RETURN l_security_predicate;\n   END IF;\n\n   \n   \n   IF l_all_divs = 'Y' THEN\n      l_security_predicate   := '1=1';\n      9751bbbcfea690cc0be4d58830a6fe2e.d4abe88ed2062b430c927bc84d61faf1f9a7aadf5998d448c2e2d1b0b47a3056.7d64937276682b23a0e16e5c61dad7aa('ALL DIVS',\n                                          c_fn_nm,\n                                          USER,\n                                          p_schema,\n                                          p_objname,\n                                          l_sbjct_area,\n                                          l_vpd_exempt,\n                                          l_all_divs,\n                                          l_cur_sql,\n                                          l_security_predicate,\n                                          (DBMS_UTILITY.get_time - c_start) / 100);\n\n      RETURN l_security_predicate;\n   END IF;\n\n   SELECT COUNT( * )\n     INTO l_div_count\n     FROM 9751bbbcfea690cc0be4d58830a6fe2e.77f574c4275330a2ed961a49e2cb2df5 ud, de459e2fe7f96e4d958537b31b946b26.dec387908a0954ddc8689c4ad37c8a3c dc\n    WHERE 9751bbbcfea690cc0be4d58830a6fe2e.77f574c4275330a2ed961a49e2cb2df5.839c4ffb4bfaae1bb58eab4dee67d96a = de459e2fe7f96e4d958537b31b946b26.dec387908a0954ddc8689c4ad37c8a3c.839c4ffb4bfaae1bb58eab4dee67d96a\n      AND 9751bbbcfea690cc0be4d58830a6fe2e.77f574c4275330a2ed961a49e2cb2df5.2487b33bfe363b72c30841fcf6b4451b = USER\n      AND 9751bbbcfea690cc0be4d58830a6fe2e.77f574c4275330a2ed961a49e2cb2df5.39ebeb219ed1244dec0e84ff7af83631 IN (l_sbjct_area, 'ALL')\n      AND 9751bbbcfea690cc0be4d58830a6fe2e.77f574c4275330a2ed961a49e2cb2df5.839c4ffb4bfaae1bb58eab4dee67d96a IS NOT NULL;\n\n   IF l_div_count > 0 THEN\n      l_first                := TRUE;\n\n      OPEN divs_c(USER, l_sbjct_area);\n\n      LOOP\n         FETCH divs_c INTO divs_rec;\n\n         EXIT WHEN divs_c%NOTFOUND;\n\n         IF l_first THEN\n            l_security_predicate   := 'GRP_CD_OR_BRNCH_CD IN (''' || 5a219141042999aad7af812b50802575.839c4ffb4bfaae1bb58eab4dee67d96a || '''';\n            l_first                := FALSE;\n         ELSE\n            l_security_predicate   := l_security_predicate || ',''' || 5a219141042999aad7af812b50802575.839c4ffb4bfaae1bb58eab4dee67d96a || '''';\n         END IF;\n      END LOOP;\n\n      CLOSE divs_c;\n\n      l_security_predicate   := l_security_predicate || ') OR ORG_LVL = ''RGN''';\n   ELSE\n      \n      l_security_predicate   := '1=2';\n   END IF;\n\n   9751bbbcfea690cc0be4d58830a6fe2e.d4abe88ed2062b430c927bc84d61faf1f9a7aadf5998d448c2e2d1b0b47a3056.7d64937276682b23a0e16e5c61dad7aa('USR DIVS',\n                                       c_fn_nm,\n                                       USER,\n                                       p_schema,\n                                       p_objname,\n                                       l_sbjct_area,\n                                       l_vpd_exempt,\n                                       l_all_divs,\n                                       l_cur_sql,\n                                       l_security_predicate,\n                                       (DBMS_UTILITY.get_time - c_start) / 100);\n\n   RETURN l_security_predicate;\nEXCEPTION\n   WHEN OTHERS THEN\n      l_security_predicate   := '1=2';\n      9751bbbcfea690cc0be4d58830a6fe2e.d4abe88ed2062b430c927bc84d61faf1f9a7aadf5998d448c2e2d1b0b47a3056.7d64937276682b23a0e16e5c61dad7aa(SQLCODE || '-' || SQLERRM,\n                                          c_fn_nm,\n                                          USER,\n                                          p_schema,\n                                          p_objname,\n                                          l_sbjct_area,\n                                          l_vpd_exempt,\n                                          NULL,\n                                          l_cur_sql,\n                                          l_security_predicate,\n                                          (DBMS_UTILITY.get_time - c_start) / 100);\n\n      RETURN l_security_predicate;\nEND fn_rnk_usr_div_all_vpd;\n/",
            "upstream_dependencies": [],
            "downstream_dependencies": [],
            "dag_location": "null",
            "gantt_location": "null",
            "created_at": "null",
            "updated_at": "null"
        },
        {
            "name": "FN_CASES_AND_DOLLARS_TEMP_WK",
            "encrypted_name": "a35377af85801a576ad44a3ad9cace2d0fd77a9cafec138338d4d544c2c7ff8b",
            "type": "function",
            "database": "null",
            "encrypted_database": "null",
            "schema": "XDMADM",
            "encrypted_schema": "0e03d5c46556a742ba46252698396ef2",
            "fully_qualified_name": "XDMADM.FN_CASES_AND_DOLLARS_TEMP_WK",
            "encrypted_fqn": "0e03d5c46556a742ba46252698396ef2.a35377af85801a576ad44a3ad9cace2d0fd77a9cafec138338d4d544c2c7ff8b",
            "synonyms": [],
            "metadata_analysis": "CREATE OR REPLACE FUNCTION \"0e03d5c46556a742ba46252698396ef2\".\"a35377af85801a576ad44a3ad9cace2d0fd77a9cafec138338d4d544c2c7ff8b\" (p_in_odate IN VARCHAR2)\n   RETURN NUMBER IS\n   \n\n   \n\n\n\n   v_const          NUMBER := 2;\n   v_end_dt         DATE;\n   v_strt_dt        DATE;\n   v_odate          DATE := TO_DATE(p_in_odate, 'YYYYMMDD');\n   v_prcs_stp       VARCHAR2(2000);\n   v_ldr_tm         NUMBER(20);\n   v_out_msg        VARCHAR2(256);\n\n   v_dba_func_msg   VARCHAR2(2000) := 'oXo';\n   dml_err_cnt      NUMBER;\n   v_brnch_cd       VARCHAR2(5) := NULL;\n   v_div_nbr        NUMBER(5) := NULL;\n\n   l_start          NUMBER;\n   l_end            NUMBER;\n   v_table_owner    VARCHAR2(40) := 'XDMADM'; \n   v_table_name1    VARCHAR2(40) := 'CASES_AND_DOLLARS_TEMP_WK';\n   v_table_name2    VARCHAR2(40) := 'DOLLARS_BY_PYR_SEG_WK'; \n   v_table_name3    VARCHAR2(40) := 'CASES_AND_RVNUE_BY_GL_ACCT_WK'; \n   v_truncate_tbl   NUMBER(3);\n\n   CURSOR c_get_dts(p_strt_dt       DATE,\n                    p_end_dt        DATE) IS\n      SELECT fisc_mth_start_dt, fisc_mth_end_dt\n        FROM de459e2fe7f96e4d958537b31b946b26.ca1faaabe4743a8a00a4d208ab58b2b3\n       WHERE fisc_mth_start_dt BETWEEN p_strt_dt AND p_end_dt;\nBEGIN\n   \n   BEGIN\n      v_prcs_stp       := 'Truncating Table 0e03d5c46556a742ba46252698396ef2.d69b2a68d4571dbb66aa4a659b0dcaa38788288a86543b0a6bcbc1ee338caa0e..... ';\n\n      DBMS_OUTPUT.put_line('Truncating/Deleting records from CASES_AND_DOLLARS_TEMP_WK');\n      v_truncate_tbl   := 8e64339f96bb08058f5d52f1c04f954a.8ffe4678890c39c7d4ed38c2ed759e24.e4b5db2b3f9b19accbb8cddbfcd05bac(v_out_msg, v_table_owner, v_table_name1);\n      DBMS_OUTPUT.put_line(v_out_msg);\n\n      IF v_truncate_tbl != 0 THEN\n         DBMS_OUTPUT.put_line('Error in Truncating the ' || v_table_name1 || ' table');\n         RETURN 500;\n      END IF;\n\n      DBMS_OUTPUT.put_line('0e03d5c46556a742ba46252698396ef2.d69b2a68d4571dbb66aa4a659b0dcaa38788288a86543b0a6bcbc1ee338caa0e table truncated successfully');\n   END;\n\n   \n   BEGIN\n      v_prcs_stp       := 'Truncating Table 0e03d5c46556a742ba46252698396ef2.ba14007a01f75b8e8b4274a5b262c17dcb22b5c6b2c358698a9a8cecf465f6fb..... ';\n\n      DBMS_OUTPUT.put_line('Truncating/Deleting records from DOLLARS_BY_PYR_SEG_WK');\n      v_truncate_tbl   := 8e64339f96bb08058f5d52f1c04f954a.8ffe4678890c39c7d4ed38c2ed759e24.e4b5db2b3f9b19accbb8cddbfcd05bac(v_out_msg, v_table_owner, v_table_name2);\n      DBMS_OUTPUT.put_line(v_out_msg);\n\n      IF v_truncate_tbl != 0 THEN\n         DBMS_OUTPUT.put_line('Error in Truncating the ' || v_table_name2 || ' table');\n         RETURN 500;\n      END IF;\n\n      DBMS_OUTPUT.put_line('0e03d5c46556a742ba46252698396ef2.ba14007a01f75b8e8b4274a5b262c17dcb22b5c6b2c358698a9a8cecf465f6fb table truncated successfully');\n   END;\n\n   \n\n   BEGIN\n      v_prcs_stp       := 'Truncating Table 0e03d5c46556a742ba46252698396ef2.0bc437e6dbeee36674bbae9feb068aa47e1ab47422f51502db6bcb83bdbd850c..... ';\n\n      DBMS_OUTPUT.put_line('Truncating/Deleting records from CASES_AND_RVNUE_BY_GL_ACCT_WK');\n      v_truncate_tbl   := 8e64339f96bb08058f5d52f1c04f954a.8ffe4678890c39c7d4ed38c2ed759e24.e4b5db2b3f9b19accbb8cddbfcd05bac(v_out_msg, v_table_owner, v_table_name3);\n      DBMS_OUTPUT.put_line(v_out_msg);\n\n      IF v_truncate_tbl != 0 THEN\n         DBMS_OUTPUT.put_line('Error in Truncating the ' || v_table_name3 || ' table');\n         RETURN 500;\n      END IF;\n\n      DBMS_OUTPUT.put_line('0e03d5c46556a742ba46252698396ef2.0bc437e6dbeee36674bbae9feb068aa47e1ab47422f51502db6bcb83bdbd850c table truncated successfully');\n   END;\n\n   BEGIN\n      v_prcs_stp   := 'GET THE VARIABLES ASSIGNED ';\n\n      \n\n\n     \n\n    SELECT MIN(clndr_dt)\n        INTO v_strt_dt\n        FROM de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001\n       WHERE fisc_yr IN (SELECT fisc_yr - (Select param_value_nbr FROM de459e2fe7f96e4d958537b31b946b26.de40ae7be8b2eb3858d46af8d107f3db\n WHERE app_name = 'HYP_PLANNING' and PARAM_TYPE = 'DATE_RANGE' and param_code = 'NOOFYRS'  )\n                           FROM de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001\n                          WHERE clndr_dt = (SELECT clndr_dt_wkago\n                                              FROM de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001\n                                             WHERE clndr_dt = v_odate));\n      \n\n      SELECT MAX(clndr_dt)\n        INTO v_end_dt\n        FROM de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001\n       WHERE fisc_yr_wk = (SELECT fisc_yr_wk\n                             FROM de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001\n                            WHERE clndr_dt = (SELECT clndr_dt_wkago\n                                                FROM de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001\n                                               WHERE clndr_dt = v_odate));\n\n      DBMS_OUTPUT.put_line('Start Date is:' || v_strt_dt);\n      DBMS_OUTPUT.put_line('End Date is:' || v_end_dt);\n      DBMS_OUTPUT.put_line('Run Date is:' || v_odate);\n\n      \n\n      SELECT TO_NUMBER(TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')) INTO v_ldr_tm FROM DUAL;\n\n      DBMS_OUTPUT.put_line('LDR_TM is :' || v_ldr_tm);\n   EXCEPTION\n      WHEN OTHERS THEN\n         DBMS_OUTPUT.put_line('Error in v_prcs_stp : ' || v_prcs_stp);\n\n         RETURN 900;\n   END;\n\n   \n   \n   \n   BEGIN\n      v_prcs_stp   := 'INSERT INTO table starts ';\n      l_start      := DBMS_UTILITY.get_time;\n\n      DBMS_OUTPUT.put_line('TIME ' || TO_CHAR(SYSDATE, 'yyyymmdd hh24:mi:ss'));\n\n      FOR r_get_dts IN c_get_dts(v_strt_dt, v_end_dt) LOOP\n         INSERT \n               INTO de459e2fe7f96e4d958537b31b946b26.affa69d2e18d5ca6c7314c74ba00bf4bb5d21bf767a527919124c3d0d22232bf(sls_div_nbr, div_nbr, div_typ_cd, fisc_yr, fisc_mth_of_yr, fisc_wk_of_prd,\n                                                     pyr_seg_cd, gl_acct_cd, cust_acctblty_flg, cust_natl_mngd_flg, delivered_type, unfrm_qty_ship,\n                                                     grs_sls_extnd, dwa_cost_extnd, natl_one_tm, natl_prom_alwnc_pgms, loc_mrktng_alwnc_pgms, loc_one_tm,\n                                                     loc_prom_alwnc_pgms, natl_mrktng_alwnc_pgms, rbt_loc_accrl_amt, rbt_natl_accrl_amt, rbt_loc_exp_amt, rbt_natl_exp_amt,\n                                                     loc_int_dvt, loc_vndr_fnd_dvt, natl_int_dvt, natl_vndr_fnd_dvt, ttl_ac, ldr_tm)\n            SELECT *\n              FROM (  SELECT CASE WHEN fce896ca0fbbf5a5d330f2803036eb44.b8c6ab19cb6e726c38f24d1885346ea3 = 'CC' THEN NVL(e9a95106e01380a7834d36560e919770.a2b201123c685e8cc48b5468cb4a449361bbd7bc0d2d67c7d7b11cb0a8d18d03, e9a95106e01380a7834d36560e919770.839c4ffb4bfaae1bb58eab4dee67d96a) ELSE e9a95106e01380a7834d36560e919770.839c4ffb4bfaae1bb58eab4dee67d96a END\n                                sls_div_nbr,\n                             e9a95106e01380a7834d36560e919770.839c4ffb4bfaae1bb58eab4dee67d96a,\n                             fce896ca0fbbf5a5d330f2803036eb44.b8c6ab19cb6e726c38f24d1885346ea3,\n                             1d731bbdc4e3fb69a854112d4982eb99.ab30d6d679879cfacfe389b97d1d3f0e,\n                             1d731bbdc4e3fb69a854112d4982eb99.e1d446673288adb6d5f219d0aa82d37a,\n                             1d731bbdc4e3fb69a854112d4982eb99.3f2fdebe4ba3a24bdf16fdac5827ebfb,\n                             d2450100e2dda59c2b7828b4daff7f8c.156f54b388a4986aa3d3d8e74d0fc0cd,\n                             CASE\n                                WHEN (e9a95106e01380a7834d36560e919770.5b031577f28cabdc6c0e17d15a4e0aa0 IN (SELECT DISTINCT param_value_chr\n                                                         FROM de459e2fe7f96e4d958537b31b946b26.de40ae7be8b2eb3858d46af8d107f3db\n                                                        WHERE app_name = 'HYP_PLANNING'\n                                                          AND param_type LIKE '%AR_GL_ACCT_CD')) THEN\n                                   CASE WHEN e9a95106e01380a7834d36560e919770.6363e9ad7bc2d03871ced34810bbcc9cde922b42cda877bb335f20b7c10e0802 <> 'Y' THEN e9a95106e01380a7834d36560e919770.5b031577f28cabdc6c0e17d15a4e0aa0 ELSE NULL END\n                                ELSE\n                                   0\n                             END\n                                gl_acct_cd,\n                             d2450100e2dda59c2b7828b4daff7f8c.318678c82ff4517124bc3a6b8506d59463f2fe9cc6b573bb859641780443a51b,\n                             d2450100e2dda59c2b7828b4daff7f8c.e33988f12139bfc93f1e7557137feb5a29e110ac67769beb8c9647cf15a66d38,\n                             CASE WHEN NVL(e9a95106e01380a7834d36560e919770.a2b201123c685e8cc48b5468cb4a449361bbd7bc0d2d67c7d7b11cb0a8d18d03, e9a95106e01380a7834d36560e919770.839c4ffb4bfaae1bb58eab4dee67d96a) = e9a95106e01380a7834d36560e919770.839c4ffb4bfaae1bb58eab4dee67d96a THEN 'Y' ELSE 'N' END\n                                delivered_type,\n                             SUM(unfrm_qty_ship) unfrm_qty_ship,\n                             SUM(NVL(grs_sls_extnd, 0)) grs_sls_extnd,\n                             SUM(NVL(dwa_cost_extnd, 0)) dwa_cost_extnd,\n                             SUM(NVL(natl_one_tm, 0)) natl_one_tm,\n                             SUM(NVL(natl_prom_alwnc_pgms, 0)) natl_prom_alwnc_pgms,\n                             SUM(NVL(loc_mrktng_alwnc_pgms, 0)) loc_mrktng_alwnc_pgms,\n                             SUM(NVL(loc_one_tm, 0)) loc_one_tm,\n                             SUM(NVL(loc_prom_alwnc_pgms, 0)) loc_prom_alwnc_pgms,\n                             SUM(NVL(natl_mrktng_alwnc_pgms, 0)) natl_mrktng_alwnc_pgms,\n                             SUM(NVL(rbt_loc_accrl_amt, 0)) rbt_loc_accrl_amt,\n                             SUM(NVL(rbt_natl_accrl_amt, 0)) rbt_natl_accrl_amt,\n                             SUM(NVL(rbt_loc_exp_amt, 0)) rbt_loc_exp_amt,\n                             SUM(NVL(rbt_natl_exp_amt, 0)) rbt_natl_exp_amt,\n                             SUM(CASE WHEN e9a95106e01380a7834d36560e919770.26ac88e7ae671a1b22c14c2fce77aa2d = 'AP' THEN loc_int_dvt ELSE 0 END) loc_int_dvt,\n                             SUM(CASE WHEN e9a95106e01380a7834d36560e919770.26ac88e7ae671a1b22c14c2fce77aa2d = 'AP' THEN loc_vndr_fnd_dvt ELSE 0 END) loc_vndr_fnd_dvt,\n                             SUM(CASE WHEN e9a95106e01380a7834d36560e919770.26ac88e7ae671a1b22c14c2fce77aa2d = 'AP' THEN natl_int_dvt ELSE 0 END) natl_int_dvt,\n                             SUM(CASE WHEN e9a95106e01380a7834d36560e919770.26ac88e7ae671a1b22c14c2fce77aa2d = 'AP' THEN natl_vndr_fnd_dvt ELSE 0 END) natl_vndr_fnd_dvt,\n                             SUM(CASE\n                                    WHEN e9a95106e01380a7834d36560e919770.5b031577f28cabdc6c0e17d15a4e0aa0 IN (SELECT DISTINCT param_value_chr\n                                                            FROM de459e2fe7f96e4d958537b31b946b26.de40ae7be8b2eb3858d46af8d107f3db\n                                                           WHERE app_name = 'HYP_PLANNING'\n                                                             AND param_type LIKE '%AR_GL_ACCT_CD') THEN\n                                       CASE\n                                          WHEN e9a95106e01380a7834d36560e919770.6363e9ad7bc2d03871ced34810bbcc9cde922b42cda877bb335f20b7c10e0802 <> 'Y' THEN\n                                             (  (NVL(e9a95106e01380a7834d36560e919770.63a91e2fd122990392b8c1467a67b61e, 0))\n                                              + (NVL(e9a95106e01380a7834d36560e919770.f4684b698d1e8edd11bf71d8eac02595, 0))\n                                              + (NVL(e9a95106e01380a7834d36560e919770.2dfeefdbbdd44f6feceb5ad393352003, 0))\n                                              + (NVL(e9a95106e01380a7834d36560e919770.bd428d343074503f124765bf6dd4405a, 0)))\n                                          ELSE\n                                             0\n                                       END\n                                    ELSE\n                                       0\n                                 END)\n                                ttl_ac,\n                             v_ldr_tm\n                        FROM de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c s,\n                             de459e2fe7f96e4d958537b31b946b26.52982d3bbc1ebc2720d9504c7ea2ed3f c,\n                             de459e2fe7f96e4d958537b31b946b26.dec387908a0954ddc8689c4ad37c8a3c d,\n                             de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001 t,\n                             de459e2fe7f96e4d958537b31b946b26.2c04d82ed0aa1cc9bce2cf2c0548b268 p\n                       WHERE e9a95106e01380a7834d36560e919770.f5dd4374a3e3af6a775cb6d6b22e8162 BETWEEN 21c902912ce01ef59af90ee0a71af15a.eeb3cae1b83726e8df7c8d2367b9cf4b1d731bbdc4e3fb69a854112d4982eb99 AND 21c902912ce01ef59af90ee0a71af15a.e17b4db24503ad4d9365a15bec98eef6\n                         AND e9a95106e01380a7834d36560e919770.f5dd4374a3e3af6a775cb6d6b22e8162 = 1d731bbdc4e3fb69a854112d4982eb99.222ccb1d1746bcdb2365f29b3da0b613\n                         AND e9a95106e01380a7834d36560e919770.852fa1e9f02f1ca2c75837f7146b2381 = d2450100e2dda59c2b7828b4daff7f8c.852fa1e9f02f1ca2c75837f7146b2381\n                         AND d2450100e2dda59c2b7828b4daff7f8c.839c4ffb4bfaae1bb58eab4dee67d96a = fce896ca0fbbf5a5d330f2803036eb44.839c4ffb4bfaae1bb58eab4dee67d96a\n                         AND e9a95106e01380a7834d36560e919770.d3268eabc4a7d98105fd85f9c9e62cd6e32ad436514bbe822b33de8bead744f3 = e472b097974b0d6a9a7d2ed170324906.d3268eabc4a7d98105fd85f9c9e62cd6e32ad436514bbe822b33de8bead744f3\n                         AND CASE\n                                WHEN (NVL(e9a95106e01380a7834d36560e919770.a2b201123c685e8cc48b5468cb4a449361bbd7bc0d2d67c7d7b11cb0a8d18d03, e9a95106e01380a7834d36560e919770.839c4ffb4bfaae1bb58eab4dee67d96a) = 0) THEN e9a95106e01380a7834d36560e919770.839c4ffb4bfaae1bb58eab4dee67d96a\n                                ELSE NVL(e9a95106e01380a7834d36560e919770.a2b201123c685e8cc48b5468cb4a449361bbd7bc0d2d67c7d7b11cb0a8d18d03, e9a95106e01380a7834d36560e919770.839c4ffb4bfaae1bb58eab4dee67d96a)\n                             END = fce896ca0fbbf5a5d330f2803036eb44.839c4ffb4bfaae1bb58eab4dee67d96a\n                         AND fce896ca0fbbf5a5d330f2803036eb44.2edfd837e0441242d7eed4e0cdf56652 IS NULL\n                         AND e9a95106e01380a7834d36560e919770.467a168a7499c57b1859198a7dac7be0 IS NULL\n                         AND d2450100e2dda59c2b7828b4daff7f8c.dd6238100904f569270d672fe0643a5a <> '2'\n                         AND e472b097974b0d6a9a7d2ed170324906.89f3df82917b692fe64dca942d924e7c <> 97\n                    GROUP BY CASE\n                                WHEN fce896ca0fbbf5a5d330f2803036eb44.b8c6ab19cb6e726c38f24d1885346ea3 = 'CC' THEN NVL(e9a95106e01380a7834d36560e919770.a2b201123c685e8cc48b5468cb4a449361bbd7bc0d2d67c7d7b11cb0a8d18d03, e9a95106e01380a7834d36560e919770.839c4ffb4bfaae1bb58eab4dee67d96a)\n                                ELSE e9a95106e01380a7834d36560e919770.839c4ffb4bfaae1bb58eab4dee67d96a\n                             END,\n                             e9a95106e01380a7834d36560e919770.839c4ffb4bfaae1bb58eab4dee67d96a,\n                             fce896ca0fbbf5a5d330f2803036eb44.b8c6ab19cb6e726c38f24d1885346ea3,\n                             1d731bbdc4e3fb69a854112d4982eb99.ab30d6d679879cfacfe389b97d1d3f0e,\n                             1d731bbdc4e3fb69a854112d4982eb99.e1d446673288adb6d5f219d0aa82d37a,\n                             1d731bbdc4e3fb69a854112d4982eb99.3f2fdebe4ba3a24bdf16fdac5827ebfb,\n                             d2450100e2dda59c2b7828b4daff7f8c.156f54b388a4986aa3d3d8e74d0fc0cd,\n                             CASE\n                                WHEN (e9a95106e01380a7834d36560e919770.5b031577f28cabdc6c0e17d15a4e0aa0 IN (SELECT DISTINCT param_value_chr\n                                                         FROM de459e2fe7f96e4d958537b31b946b26.de40ae7be8b2eb3858d46af8d107f3db\n                                                        WHERE app_name = 'HYP_PLANNING'\n                                                          AND param_type LIKE '%AR_GL_ACCT_CD')) THEN\n                                   CASE WHEN e9a95106e01380a7834d36560e919770.839c4ffb4bfaae1bb58eab4dee67d96a.6363e9ad7bc2d03871ced34810bbcc9cde922b42cda877bb335f20b7c10e0802 <> 'Y' THEN e9a95106e01380a7834d36560e919770.839c4ffb4bfaae1bb58eab4dee67d96a.5b031577f28cabdc6c0e17d15a4e0aa0 ELSE NULL END\n                                ELSE\n                                   0\n                             END,\n                             d2450100e2dda59c2b7828b4daff7f8c.318678c82ff4517124bc3a6b8506d59463f2fe9cc6b573bb859641780443a51b,\n                             d2450100e2dda59c2b7828b4daff7f8c.e33988f12139bfc93f1e7557137feb5a29e110ac67769beb8c9647cf15a66d38,\n                             CASE WHEN NVL(e9a95106e01380a7834d36560e919770.839c4ffb4bfaae1bb58eab4dee67d96a.a2b201123c685e8cc48b5468cb4a449361bbd7bc0d2d67c7d7b11cb0a8d18d03, e9a95106e01380a7834d36560e919770.839c4ffb4bfaae1bb58eab4dee67d96a.839c4ffb4bfaae1bb58eab4dee67d96a) = e9a95106e01380a7834d36560e919770.839c4ffb4bfaae1bb58eab4dee67d96a.839c4ffb4bfaae1bb58eab4dee67d96a THEN 'Y' ELSE 'N' END);\n\n         DBMS_OUTPUT.put_line('NO OF ROWS INSERTED:' || sql%ROWCOUNT);\n\n         COMMIT;\n      END LOOP;\n\n      l_end        := DBMS_UTILITY.get_time;\n\n      DBMS_OUTPUT.put_line(ROUND((l_end - l_start) / 100, 2) || ' seconds...');\n\n      RETURN 0;\n   EXCEPTION\n      WHEN OTHERS THEN\n         DBMS_OUTPUT.put_line('Error in v_prcs_stp:' || v_prcs_stp || SQLCODE || SQLERRM);\n\n         RETURN 701;\n   END;\n\n\n\n\nEXCEPTION\n   WHEN OTHERS THEN\n      ROLLBACK;\n      DBMS_OUTPUT.put_line(SQLCODE);\n      DBMS_OUTPUT.put_line(SQLERRM);\n\n      DBMS_OUTPUT.put_line('Error in function FN_CASES_AND_DOLLARS_TEMP_WK');\n      RETURN 600;\nEND fn_cases_and_dollars_temp_wk;\n/",
            "upstream_dependencies": [],
            "downstream_dependencies": [],
            "dag_location": "null",
            "gantt_location": "null",
            "created_at": "null",
            "updated_at": "null"
        },
        {
            "name": "FN_GET_PAST_FUT_WKS",
            "encrypted_name": "1dde8113836b4c140d518174269b76a19804ec6cef3fbf360c9c6a1b14f8ea2c",
            "type": "function",
            "database": "null",
            "encrypted_database": "null",
            "schema": "XDMADM",
            "encrypted_schema": "0e03d5c46556a742ba46252698396ef2",
            "fully_qualified_name": "XDMADM.FN_GET_PAST_FUT_WKS",
            "encrypted_fqn": "0e03d5c46556a742ba46252698396ef2.1dde8113836b4c140d518174269b76a19804ec6cef3fbf360c9c6a1b14f8ea2c",
            "synonyms": [],
            "metadata_analysis": "CREATE OR REPLACE FUNCTION \"0e03d5c46556a742ba46252698396ef2\".\"1dde8113836b4c140d518174269b76a19804ec6cef3fbf360c9c6a1b14f8ea2c\" (p_fisc_yr_wk   IN VARCHAR2,\n                                               p_num_wk       IN NUMBER)\n   RETURN VARCHAR2\n   DETERMINISTIC IS\n   l_fisc_yr_wk   VARCHAR2(6 BYTE);\nBEGIN\n   SELECT fisc_yr_wk\n     INTO l_fisc_yr_wk\n     FROM de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001 t\n    WHERE clndr_dt = (SELECT MIN(clndr_dt) + (7 * p_num_wk)\n                        FROM de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001\n                       WHERE fisc_yr_wk = p_fisc_yr_wk);\n\n   RETURN l_fisc_yr_wk;\nEND fn_get_past_fut_wks;\n/",
            "upstream_dependencies": [],
            "downstream_dependencies": [],
            "dag_location": "null",
            "gantt_location": "null",
            "created_at": "null",
            "updated_at": "null"
        },
        {
            "name": "FN_ALL_DIV_ACTIVE_VPD",
            "encrypted_name": "78ffad08765c3bc847733a8db03b397a582c2cac885aecb64ece08d1c6a748c5",
            "type": "function",
            "database": "null",
            "encrypted_database": "null",
            "schema": "XDMADM",
            "encrypted_schema": "0e03d5c46556a742ba46252698396ef2",
            "fully_qualified_name": "XDMADM.FN_ALL_DIV_ACTIVE_VPD",
            "encrypted_fqn": "0e03d5c46556a742ba46252698396ef2.78ffad08765c3bc847733a8db03b397a582c2cac885aecb64ece08d1c6a748c5",
            "synonyms": [],
            "metadata_analysis": "CREATE OR REPLACE FUNCTION \"0e03d5c46556a742ba46252698396ef2\".\"78ffad08765c3bc847733a8db03b397a582c2cac885aecb64ece08d1c6a748c5\" (p_schema       IN VARCHAR2,\n                                                    p_objname      IN VARCHAR2)\n   RETURN VARCHAR2 AS\n   \n   c_start                CONSTANT NUMBER := DBMS_UTILITY.get_time;\n   c_fn_nm                CONSTANT VARCHAR2(30) := 'FN_DIV_ALL_ACTIVE_VPD';\n   l_security_predicate   VARCHAR2(4000) DEFAULT NULL;\n   l_cur_sql              VARCHAR2(4000) := SYS_CONTEXT('USERENV', 'CURRENT_SQL');\n   l_sbjct_area VARCHAR2(100)\n         := SYS_CONTEXT(9751bbbcfea690cc0be4d58830a6fe2e.9bfb5eb7793dc8fa6800d5a61e5e3e4e1e2f6ec194927f064ce6cb31fba71a32.f4a54ebc6f2c591ed4266aafe66971af, 9751bbbcfea690cc0be4d58830a6fe2e.9bfb5eb7793dc8fa6800d5a61e5e3e4e1e2f6ec194927f064ce6cb31fba71a32.3b1288ed835b1b524e9500bb13544956e6e6300089dae5a98e31814d0406060f);\n   l_vpd_exempt VARCHAR2(1)\n         := SYS_CONTEXT(9751bbbcfea690cc0be4d58830a6fe2e.9bfb5eb7793dc8fa6800d5a61e5e3e4e1e2f6ec194927f064ce6cb31fba71a32.f4a54ebc6f2c591ed4266aafe66971af, 9751bbbcfea690cc0be4d58830a6fe2e.9bfb5eb7793dc8fa6800d5a61e5e3e4e1e2f6ec194927f064ce6cb31fba71a32.0eaf613ab52a53601d1496b5650de81e);\n   l_all_divs VARCHAR2(1)\n         := SYS_CONTEXT(9751bbbcfea690cc0be4d58830a6fe2e.9bfb5eb7793dc8fa6800d5a61e5e3e4e1e2f6ec194927f064ce6cb31fba71a32.f4a54ebc6f2c591ed4266aafe66971af, 9751bbbcfea690cc0be4d58830a6fe2e.9bfb5eb7793dc8fa6800d5a61e5e3e4e1e2f6ec194927f064ce6cb31fba71a32.0f460756ee76d4a2460733464cda5f95);\n\n   l_div_count            NUMBER := 0;\n   l_first                BOOLEAN := TRUE;\n\n   CURSOR all_divs_c IS\n      SELECT \n            de459e2fe7f96e4d958537b31b946b26.dec387908a0954ddc8689c4ad37c8a3c.839c4ffb4bfaae1bb58eab4dee67d96a\n        FROM de459e2fe7f96e4d958537b31b946b26.dec387908a0954ddc8689c4ad37c8a3c dc\n       WHERE de459e2fe7f96e4d958537b31b946b26.dec387908a0954ddc8689c4ad37c8a3c.2edfd837e0441242d7eed4e0cdf56652 IS NULL\n          OR de459e2fe7f96e4d958537b31b946b26.dec387908a0954ddc8689c4ad37c8a3c.6d74bb3e26f02dd707dc6b3b68070169 > SYSDATE;\n\n   all_divs_rec           all_divs_c%ROWTYPE;\nBEGIN\n   \n\n   IF l_sbjct_area IS NULL THEN\n      l_security_predicate   := '1=2';\n      9751bbbcfea690cc0be4d58830a6fe2e.d4abe88ed2062b430c927bc84d61faf1f9a7aadf5998d448c2e2d1b0b47a3056.7d64937276682b23a0e16e5c61dad7aa('NO SA', c_fn_nm, USER, p_schema, p_objname, l_sbjct_area, l_vpd_exempt,\n      l_all_divs, l_cur_sql, l_security_predicate, (DBMS_UTILITY.get_time - c_start) / 100);\n\n      RETURN l_security_predicate;\n   END IF;\n\n   \n   \n\n   IF l_vpd_exempt = 'Y' THEN\n      l_security_predicate   := '1=1';\n      9751bbbcfea690cc0be4d58830a6fe2e.d4abe88ed2062b430c927bc84d61faf1f9a7aadf5998d448c2e2d1b0b47a3056.7d64937276682b23a0e16e5c61dad7aa('EXEMPT', c_fn_nm, USER, p_schema, p_objname, l_sbjct_area, l_vpd_exempt,\n      l_all_divs, l_cur_sql, l_security_predicate, (DBMS_UTILITY.get_time - c_start) / 100);\n\n      RETURN l_security_predicate;\n   END IF;\n\n   \n   \n\n   SELECT COUNT( * )\n     INTO l_div_count\n     FROM de459e2fe7f96e4d958537b31b946b26.dec387908a0954ddc8689c4ad37c8a3c dc\n    WHERE de459e2fe7f96e4d958537b31b946b26.dec387908a0954ddc8689c4ad37c8a3c.2edfd837e0441242d7eed4e0cdf56652 IS NULL\n       OR de459e2fe7f96e4d958537b31b946b26.dec387908a0954ddc8689c4ad37c8a3c.6d74bb3e26f02dd707dc6b3b68070169 > SYSDATE;\n\n   IF l_div_count > 0 THEN\n      l_first                := TRUE;\n\n      OPEN all_divs_c;\n\n      LOOP\n         FETCH all_divs_c INTO all_divs_rec;\n\n         EXIT WHEN all_divs_c%NOTFOUND;\n\n         IF l_first THEN\n            l_security_predicate   := 'DIV_NBR IN (' || 05809d328a80b20ac6b3d7abdb3f24ec.839c4ffb4bfaae1bb58eab4dee67d96a;\n            l_first                := FALSE;\n         ELSE\n            l_security_predicate   := l_security_predicate || ',' || 05809d328a80b20ac6b3d7abdb3f24ec.839c4ffb4bfaae1bb58eab4dee67d96a;\n         END IF;\n      END LOOP;\n\n      CLOSE all_divs_c;\n\n      l_security_predicate   := l_security_predicate || ')';\n   ELSE\n      l_security_predicate   := '1=2';\n   END IF;\n\n   9751bbbcfea690cc0be4d58830a6fe2e.d4abe88ed2062b430c927bc84d61faf1f9a7aadf5998d448c2e2d1b0b47a3056.7d64937276682b23a0e16e5c61dad7aa('ALL DIVS', c_fn_nm, USER, p_schema, p_objname, l_sbjct_area, l_vpd_exempt,\n   l_all_divs, l_cur_sql, l_security_predicate, (DBMS_UTILITY.get_time - c_start) / 100);\n\n   RETURN l_security_predicate;\nEXCEPTION\n   WHEN OTHERS THEN\n      l_security_predicate   := '1=2';\n      9751bbbcfea690cc0be4d58830a6fe2e.d4abe88ed2062b430c927bc84d61faf1f9a7aadf5998d448c2e2d1b0b47a3056.7d64937276682b23a0e16e5c61dad7aa(SQLCODE || '-' || SQLERRM, c_fn_nm, USER, p_schema, p_objname, l_sbjct_area,\n      l_vpd_exempt, NULL, l_cur_sql, l_security_predicate, (DBMS_UTILITY.get_time - c_start) / 100);\n\n      RETURN l_security_predicate;\nEND fn_all_div_active_vpd;\n/",
            "upstream_dependencies": [],
            "downstream_dependencies": [],
            "dag_location": "null",
            "gantt_location": "null",
            "created_at": "null",
            "updated_at": "null"
        },
        {
            "name": "FN_TMS_VLDTN",
            "encrypted_name": "6dacadb7253a1e9ee782e0f15ad986ed",
            "type": "function",
            "database": "null",
            "encrypted_database": "null",
            "schema": "XDMADM",
            "encrypted_schema": "0e03d5c46556a742ba46252698396ef2",
            "fully_qualified_name": "XDMADM.FN_TMS_VLDTN",
            "encrypted_fqn": "0e03d5c46556a742ba46252698396ef2.6dacadb7253a1e9ee782e0f15ad986ed",
            "synonyms": [],
            "metadata_analysis": "CREATE OR REPLACE FUNCTION \"0e03d5c46556a742ba46252698396ef2\".\"6dacadb7253a1e9ee782e0f15ad986ed\" (p_odate IN DATE)\n   RETURN NUMBER AS\n   \n   c_success                 CONSTANT NUMBER := 0;\n   c_error                   CONSTANT NUMBER := 1;\n\n   l_fisc_yr_wk              VARCHAR2(6);\n\n   l_tms_po_cnt_pct          NUMBER;\n   l_tms_rcvd_pct            NUMBER;\n   l_tms_rcvd_qty_pct        NUMBER;\n   l_tms_rcvd_vol_pct        NUMBER;\n   l_tms_rcvd_wght_pct       NUMBER;\n\n   l_tms_po_cnt_pct_lmt      NUMBER;\n   l_tms_rcvd_pct_lmt        NUMBER;\n   l_tms_rcvd_qty_pct_lmt    NUMBER;\n   l_tms_rcvd_vol_pct_lmt    NUMBER;\n   l_tms_rcvd_wght_pct_lmt   NUMBER;\n\n   l_fail_cnt                NUMBER := 0;\nBEGIN\n   \n   IF (p_odate IS NULL) THEN\n      DBMS_OUTPUT.put_line('Error: Invalid Parameters: Date is required');\n      RETURN c_error;\n   END IF;\n\n   SELECT fisc_yr_wk\n     INTO l_fisc_yr_wk\n     FROM de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001\n    WHERE clndr_dt = p_odate;\n\n   DBMS_OUTPUT.put_line('Fiscal Week:' || l_fisc_yr_wk);\n\n   BEGIN\n      SELECT param_value_nbr\n        INTO l_tms_po_cnt_pct_lmt\n        FROM de459e2fe7f96e4d958537b31b946b26.de40ae7be8b2eb3858d46af8d107f3db\n       WHERE app_name = 'MANHATTAN'\n         AND param_type = 'TMS_VLDTN'\n         AND param_code = 'PO_CNT_PCT_LMT';\n\n      SELECT param_value_nbr\n        INTO l_tms_rcvd_pct_lmt\n        FROM de459e2fe7f96e4d958537b31b946b26.de40ae7be8b2eb3858d46af8d107f3db\n       WHERE app_name = 'MANHATTAN'\n         AND param_type = 'TMS_VLDTN'\n         AND param_code = 'RCVD_PCT_LMT';\n\n      SELECT param_value_nbr\n        INTO l_tms_rcvd_qty_pct_lmt\n        FROM de459e2fe7f96e4d958537b31b946b26.de40ae7be8b2eb3858d46af8d107f3db\n       WHERE app_name = 'MANHATTAN'\n         AND param_type = 'TMS_VLDTN'\n         AND param_code = 'RCVD_QTY_PCT_LMT';\n\n      SELECT param_value_nbr\n        INTO l_tms_rcvd_vol_pct_lmt\n        FROM de459e2fe7f96e4d958537b31b946b26.de40ae7be8b2eb3858d46af8d107f3db\n       WHERE app_name = 'MANHATTAN'\n         AND param_type = 'TMS_VLDTN'\n         AND param_code = 'RCVD_VOL_PCT_LMT';\n\n      SELECT param_value_nbr\n        INTO l_tms_rcvd_wght_pct_lmt\n        FROM de459e2fe7f96e4d958537b31b946b26.de40ae7be8b2eb3858d46af8d107f3db\n       WHERE app_name = 'MANHATTAN'\n         AND param_type = 'TMS_VLDTN'\n         AND param_code = 'RCVD_WGHT_PCT_LMT';\n   EXCEPTION\n      WHEN NO_DATA_FOUND THEN\n         DBMS_OUTPUT.put_line('Error getting limits from param table');\n         RETURN c_error;\n   END;\n\n   BEGIN\n        SELECT ROUND(((SUM(CASE WHEN src_po_id IS NOT NULL THEN 1 ELSE 0 END) / COUNT( * )) * 100), 2) tms_po_cnt_pct,\n               CASE\n                  WHEN SUM(CASE WHEN src_po_id IS NOT NULL THEN 1 ELSE 0 END) = 0 THEN\n                     0\n                  ELSE\n                     ROUND((  SUM(CASE\n                                     WHEN src_po_id IS NOT NULL\n                                      AND tms_rcvd_dt IS NOT NULL THEN\n                                        1\n                                     ELSE\n                                        0\n                                  END)\n                            / SUM(CASE WHEN src_po_id IS NOT NULL THEN 1 ELSE 0 END)\n                            * 100),\n                           2)\n               END\n                  tms_rcvd_pct,\n               CASE\n                  WHEN SUM(CASE WHEN src_po_id IS NOT NULL THEN eiw_rcvd_qty ELSE 0 END) = 0 THEN 0\n                  ELSE ROUND(((SUM(tms_rcvd_qty) / SUM(CASE WHEN src_po_id IS NOT NULL THEN eiw_rcvd_qty ELSE 0 END)) * 100), 2)\n               END\n                  tms_rcvd_qty_pct,\n               CASE\n                  WHEN SUM(CASE WHEN src_po_id IS NOT NULL THEN eiw_rcvd_vol ELSE 0 END) = 0 THEN 0\n                  ELSE ROUND(((SUM(tms_rcvd_vol) / SUM(CASE WHEN src_po_id IS NOT NULL THEN eiw_rcvd_vol ELSE 0 END)) * 100), 2)\n               END\n                  tms_rcvd_vol_pct,\n               CASE\n                  WHEN SUM(CASE WHEN src_po_id IS NOT NULL THEN eiw_rcvd_wght ELSE 0 END) = 0 THEN 0\n                  ELSE ROUND(((SUM(tms_rcvd_wght) / SUM(CASE WHEN src_po_id IS NOT NULL THEN eiw_rcvd_wght ELSE 0 END)) * 100), 2)\n               END\n                  tms_rcvd_wght_pct\n          INTO l_tms_po_cnt_pct, l_tms_rcvd_pct, l_tms_rcvd_qty_pct, l_tms_rcvd_vol_pct, l_tms_rcvd_wght_pct\n          FROM (WITH eiw_pos AS\n                       (  SELECT 2bf1df9f95a63cca26ff198e426f4130.f2de255a7553ba934b1f05ae7699ae4c,\n                                 9286383e21f04b9584c1bc569a201731.6bd6b7c188fef616b113c81245338906,\n                                 1ef1e03241fd3a9ca5a803b6fd417083.4855453efe73ff0bd0f7583df58260dd,\n                                 1ef1e03241fd3a9ca5a803b6fd417083.839c4ffb4bfaae1bb58eab4dee67d96a,\n                                 9286383e21f04b9584c1bc569a201731.75274b7e794ec4ac03e63646e000c70b,\n                                 9286383e21f04b9584c1bc569a201731.d07269fd715528545216b1ab9353756e,\n                                 SUM(9286383e21f04b9584c1bc569a201731.e7cabb8cf7b3db25086b2c8c7fe3a76e) rcvd_qty,\n                                 SUM(9286383e21f04b9584c1bc569a201731.0d664c9790a40f8877ce994a41ca662496a8e7c926d4a6d230ee2652a5996563) rcvd_vol,\n                                 SUM(9286383e21f04b9584c1bc569a201731.bb2dfd06913e72dbc1733f20ba3699ea2742f685419072427fdf6d978b822ac7) rcvd_wght\n                            FROM de459e2fe7f96e4d958537b31b946b26.c437d55d53d88d02ce92bdadaefd8483 po, de459e2fe7f96e4d958537b31b946b26.dec387908a0954ddc8689c4ad37c8a3c div, de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001 tc\n                           WHERE 9286383e21f04b9584c1bc569a201731.839c4ffb4bfaae1bb58eab4dee67d96a = 1ef1e03241fd3a9ca5a803b6fd417083.839c4ffb4bfaae1bb58eab4dee67d96a\n                             AND 9286383e21f04b9584c1bc569a201731.75274b7e794ec4ac03e63646e000c70b = 2bf1df9f95a63cca26ff198e426f4130.222ccb1d1746bcdb2365f29b3da0b613\n                             AND 2bf1df9f95a63cca26ff198e426f4130.f2de255a7553ba934b1f05ae7699ae4c = l_fisc_yr_wk\n                             AND 9286383e21f04b9584c1bc569a201731.26ac88e7ae671a1b22c14c2fce77aa2d = 'PR'\n                             AND frght_ppaid_ind_actl || frght_ppay_add_ind_actl || frght_bill_ind_actl || frght_bckhl_ind_actl || ctms_ind_actl IN\n                                       ('NYYNY', 'YNYNY', 'YNNYN', 'NNYNY', 'NNYYN')\n                        GROUP BY 2bf1df9f95a63cca26ff198e426f4130.f2de255a7553ba934b1f05ae7699ae4c,\n                                 9286383e21f04b9584c1bc569a201731.6bd6b7c188fef616b113c81245338906,\n                                 1ef1e03241fd3a9ca5a803b6fd417083.4855453efe73ff0bd0f7583df58260dd,\n                                 1ef1e03241fd3a9ca5a803b6fd417083.839c4ffb4bfaae1bb58eab4dee67d96a,\n                                 9286383e21f04b9584c1bc569a201731.75274b7e794ec4ac03e63646e000c70b,\n                                 9286383e21f04b9584c1bc569a201731.d07269fd715528545216b1ab9353756e),\n                    tms_pos AS (SELECT DISTINCT tms_src,\n                                                src_po_id,\n                                                po_nbr,\n                                                po_brnch_cd,\n                                                po_div_nbr,\n                                                po_rcvd_dt,\n                                                po_crt_dt,\n                                                rcvd_qty,\n                                                rcvd_volume,\n                                                rcvd_wght\n                                  FROM de459e2fe7f96e4d958537b31b946b26.1a663eaf7ebda55b3a5b36843b82b02d\n                                 WHERE tms_src = 'MANHATTAN')\n                SELECT 1d85f0ca96398f81a524b261356358b5.f2de255a7553ba934b1f05ae7699ae4c,\n                       1d85f0ca96398f81a524b261356358b5.6bd6b7c188fef616b113c81245338906,\n                       1d85f0ca96398f81a524b261356358b5.4855453efe73ff0bd0f7583df58260dd,\n                       1d85f0ca96398f81a524b261356358b5.839c4ffb4bfaae1bb58eab4dee67d96a,\n                       1d85f0ca96398f81a524b261356358b5.e7cabb8cf7b3db25086b2c8c7fe3a76e eiw_rcvd_qty,\n                       1d85f0ca96398f81a524b261356358b5.61ff2dff273b7e52d5bacef51cfed548 eiw_rcvd_vol,\n                       1d85f0ca96398f81a524b261356358b5.0814335c6b9bd523faacabf91539a73a eiw_rcvd_wght,\n                       af15e2bd04a97e5e587001bf109663fd.f94a37a592b3fa8a47144dd8dd293b48,\n                       af15e2bd04a97e5e587001bf109663fd.fc96e1f62e1a5368fd9c9da632a08c09,\n                       af15e2bd04a97e5e587001bf109663fd.75274b7e794ec4ac03e63646e000c70b tms_rcvd_dt,\n                       af15e2bd04a97e5e587001bf109663fd.e7cabb8cf7b3db25086b2c8c7fe3a76e tms_rcvd_qty,\n                       af15e2bd04a97e5e587001bf109663fd.de945cabe50252fdfc02b4903c999126 tms_rcvd_vol,\n                       af15e2bd04a97e5e587001bf109663fd.0814335c6b9bd523faacabf91539a73a tms_rcvd_wght\n                  FROM eiw_pos ep, tms_pos tp\n                 WHERE 1d85f0ca96398f81a524b261356358b5.6bd6b7c188fef616b113c81245338906 = af15e2bd04a97e5e587001bf109663fd.6bd6b7c188fef616b113c81245338906(+)\n                   AND 1d85f0ca96398f81a524b261356358b5.839c4ffb4bfaae1bb58eab4dee67d96a = af15e2bd04a97e5e587001bf109663fd.ce2946af2a24384c6ce971852c59159d(+)\n                   AND 1d85f0ca96398f81a524b261356358b5.d07269fd715528545216b1ab9353756e = af15e2bd04a97e5e587001bf109663fd.f48175c18b8a828da3d8f7dc74c9030c(+))\n      GROUP BY fisc_yr_wk;\n   EXCEPTION\n      WHEN NO_DATA_FOUND THEN\n         DBMS_OUTPUT.put_line('No POs found for fiscal week');\n         l_tms_po_cnt_pct      := 0;\n         l_tms_rcvd_pct        := 0;\n         l_tms_rcvd_qty_pct    := 0;\n         l_tms_rcvd_vol_pct    := 0;\n         l_tms_rcvd_wght_pct   := 0;\n   END;\n\n   DBMS_OUTPUT.put_line('TMS PO Matched%:' || l_tms_po_cnt_pct || ' Min:' || l_tms_po_cnt_pct_lmt);\n\n   IF l_tms_po_cnt_pct > l_tms_po_cnt_pct_lmt THEN\n      DBMS_OUTPUT.put_line('Pass');\n   ELSE\n      DBMS_OUTPUT.put_line('Fail');\n      l_fail_cnt   := 1;\n   END IF;\n\n   DBMS_OUTPUT.put_line('TMS Receipt%:' || l_tms_rcvd_pct || ' Min:' || l_tms_rcvd_pct_lmt);\n\n   IF l_tms_rcvd_pct > l_tms_rcvd_pct_lmt THEN\n      DBMS_OUTPUT.put_line('Pass');\n   ELSE\n      DBMS_OUTPUT.put_line('Fail');\n      l_fail_cnt   := 1;\n   END IF;\n\n   DBMS_OUTPUT.put_line('TMS Received Quantity%:' || l_tms_rcvd_qty_pct || ' Min:' || l_tms_rcvd_qty_pct_lmt);\n\n   IF l_tms_rcvd_qty_pct > l_tms_rcvd_qty_pct_lmt THEN\n      DBMS_OUTPUT.put_line('Pass');\n   ELSE\n      DBMS_OUTPUT.put_line('Fail');\n      l_fail_cnt   := 1;\n   END IF;\n\n   DBMS_OUTPUT.put_line('TMS Received Volume%:' || l_tms_rcvd_vol_pct || ' Min:' || l_tms_rcvd_vol_pct_lmt);\n\n   IF l_tms_rcvd_vol_pct > l_tms_rcvd_vol_pct_lmt THEN\n      DBMS_OUTPUT.put_line('Pass');\n   ELSE\n      DBMS_OUTPUT.put_line('Fail');\n      l_fail_cnt   := 1;\n   END IF;\n\n   DBMS_OUTPUT.put_line('TMS Received Weight%:' || l_tms_rcvd_wght_pct || ' Min:' || l_tms_rcvd_wght_pct_lmt);\n\n   IF l_tms_rcvd_wght_pct > l_tms_rcvd_wght_pct_lmt THEN\n      DBMS_OUTPUT.put_line('Pass');\n   ELSE\n      DBMS_OUTPUT.put_line('Fail');\n      l_fail_cnt   := 1;\n   END IF;\n\n   IF l_fail_cnt = 0 THEN\n      DBMS_OUTPUT.put_line('Validation Successful');\n      RETURN c_success;\n   ELSE\n      DBMS_OUTPUT.put_line('Validation Failed');\n      DBMS_OUTPUT.put_line('Note: Extract will still be delivered. Need to notify inbound logistcs team and investigate issue.');\n\n      RETURN c_error;\n   END IF;\nEXCEPTION\n   WHEN OTHERS THEN\n      DBMS_OUTPUT.put_line(SQLERRM);\n      RETURN c_error;\nEND fn_tms_vldtn;\n/",
            "upstream_dependencies": [],
            "downstream_dependencies": [],
            "dag_location": "null",
            "gantt_location": "null",
            "created_at": "null",
            "updated_at": "null"
        },
        {
            "name": "FN_CHANGE_CUST_LOAD",
            "encrypted_name": "e743cb7848cb703b6dc280ca7c0fb3d0a7d2c123ab08f9acde20fb7e42f4f726",
            "type": "function",
            "database": "null",
            "encrypted_database": "null",
            "schema": "XDMADM",
            "encrypted_schema": "0e03d5c46556a742ba46252698396ef2",
            "fully_qualified_name": "XDMADM.FN_CHANGE_CUST_LOAD",
            "encrypted_fqn": "0e03d5c46556a742ba46252698396ef2.e743cb7848cb703b6dc280ca7c0fb3d0a7d2c123ab08f9acde20fb7e42f4f726",
            "synonyms": [],
            "metadata_analysis": "CREATE OR REPLACE FUNCTION \"0e03d5c46556a742ba46252698396ef2\".\"e743cb7848cb703b6dc280ca7c0fb3d0a7d2c123ab08f9acde20fb7e42f4f726\" (odate          IN DATE,\n                             p_prev_years   IN NUMBER,\n                             p_full_load_flg IN VARCHAR2)\n   RETURN NUMBER AS\n   \n   c_success          CONSTANT NUMBER := 0;\n   c_error            CONSTANT NUMBER := 1;\n\n   l_prev_ldr_tm      NUMBER;\n   l_new_ldr_tm       NUMBER;\n   l_start_dt         DATE;\n   l_change_pim_cnt   NUMBER;\n   l_change_scp_cnt   NUMBER; \n   l_return_code      NUMBER;\n   l_out_msg          VARCHAR2(256);\nBEGIN\n   IF (odate IS NULL) THEN\n      DBMS_OUTPUT.put_line('Error: Invalid Parameters: Date is required');\n      RETURN c_error;\n   END IF;\n\n   DBMS_OUTPUT.put_line('ODATE: ' || odate);\n\n   IF (p_prev_years IS NULL) THEN\n      DBMS_OUTPUT.put_line('Error: Invalid Parameters: Previous Years is required');\n      RETURN c_error;\n   END IF;\n\n   DBMS_OUTPUT.put_line('Previous years: ' || p_prev_years);\n\n   IF (p_full_load_flg IS NULL) THEN\n      DBMS_OUTPUT.put_line('Error: Invalid Parameters: Full load flag is required');\n      RETURN c_error;\n   END IF;\n\n   DBMS_OUTPUT.put_line('Full load flag: ' || p_full_load_flg);\n\n   \n   l_return_code   := 8e64339f96bb08058f5d52f1c04f954a.8ffe4678890c39c7d4ed38c2ed759e24.e4b5db2b3f9b19accbb8cddbfcd05bac(l_out_msg, 'XDMADM', 'CHANGE_CUST');\n\n   IF (l_return_code <> 0) THEN\n      DBMS_OUTPUT.put_line('Error: Failed to truncate CHANGE_CUST table');\n      RETURN c_error;\n   END IF;\n\n   DBMS_OUTPUT.put_line('Truncated CHANGE_CUST table');\n\n   \n   \n   SELECT MIN(de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.222ccb1d1746bcdb2365f29b3da0b613)\n     INTO l_start_dt\n     FROM de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001 t, de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001 t2\n    WHERE de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.ab30d6d679879cfacfe389b97d1d3f0e = de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.ab30d6d679879cfacfe389b97d1d3f0e - (p_prev_years + 1)\n      AND de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.222ccb1d1746bcdb2365f29b3da0b613 = odate;\n\n   DBMS_OUTPUT.put_line('Start date: ' || l_start_dt);\n\n   \n   SELECT MAX(ldr_tm)\n     INTO l_new_ldr_tm\n     FROM de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c s, de459e2fe7f96e4d958537b31b946b26.dec387908a0954ddc8689c4ad37c8a3c d\n    WHERE de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.839c4ffb4bfaae1bb58eab4dee67d96a = de459e2fe7f96e4d958537b31b946b26.dec387908a0954ddc8689c4ad37c8a3c.839c4ffb4bfaae1bb58eab4dee67d96a\n      AND prcs_dt >= l_start_dt;\n\n   DBMS_OUTPUT.put_line('New loader time: ' || l_new_ldr_tm);\n\n   \n   IF (p_full_load_flg = 'Y') THEN\n      l_prev_ldr_tm   := 0;\n   ELSE\n      \n      \n      SELECT TO_CHAR(prcs_dt - 2, 'YYYYMMDDHH24MISS')\n        INTO l_prev_ldr_tm\n        FROM de459e2fe7f96e4d958537b31b946b26.0b3320d3f985cd20d1ec65d9dfeed2de\n       WHERE fact_table = 'CUST_WK_AGGR';\n   END IF;\n\n   DBMS_OUTPUT.put_line('Previous loader time: ' || l_prev_ldr_tm);\n\n   INSERT \n         INTO de459e2fe7f96e4d958537b31b946b26.ce1d729fee66fa77fd563722854ae2bd\n      SELECT DISTINCT de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.f2de255a7553ba934b1f05ae7699ae4c, de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.852fa1e9f02f1ca2c75837f7146b2381, de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.839c4ffb4bfaae1bb58eab4dee67d96a\n        FROM de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c s, de459e2fe7f96e4d958537b31b946b26.dec387908a0954ddc8689c4ad37c8a3c d, de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001 t\n       WHERE de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.839c4ffb4bfaae1bb58eab4dee67d96a = de459e2fe7f96e4d958537b31b946b26.dec387908a0954ddc8689c4ad37c8a3c.839c4ffb4bfaae1bb58eab4dee67d96a\n         AND de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.f5dd4374a3e3af6a775cb6d6b22e8162 = de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.222ccb1d1746bcdb2365f29b3da0b613\n         AND de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.f5dd4374a3e3af6a775cb6d6b22e8162 >= l_start_dt\n         AND ldr_tm > l_prev_ldr_tm\n         AND ldr_tm <= l_new_ldr_tm;\n\n   DBMS_OUTPUT.put_line('Inserted ' || sql%ROWCOUNT || ' into CHANGE_CUST');\n\n   COMMIT;\n\n   IF (p_full_load_flg <> 'Y') THEN\n      \n      SELECT COUNT( * )\n        INTO l_change_pim_cnt\n        FROM (SELECT pim_usf_std_prod_cd, admn_flg, brnd_typ FROM de459e2fe7f96e4d958537b31b946b26.87e84e1341e66e8b2b6728a9e27bac17\n              MINUS\n              SELECT pim_usf_std_prod_cd, DECODE(pim_suprcls_id, 97, 'Y', 'N'), DECODE(pim_brnd_typ, 2, 'EB', 'MB')\n                FROM de459e2fe7f96e4d958537b31b946b26.2c04d82ed0aa1cc9bce2cf2c0548b268);\n\n      DBMS_OUTPUT.put_line('Number of changed PIM_CORP records: ' || l_change_pim_cnt);\n\n      IF (l_change_pim_cnt > 0) THEN\n         \n         INSERT \n               INTO de459e2fe7f96e4d958537b31b946b26.ce1d729fee66fa77fd563722854ae2bd\n            WITH chng AS\n                   (SELECT pim_usf_std_prod_cd, admn_flg, brnd_typ FROM de459e2fe7f96e4d958537b31b946b26.87e84e1341e66e8b2b6728a9e27bac17\n                    MINUS\n                    SELECT pim_usf_std_prod_cd, DECODE(pim_suprcls_id, 97, 'Y', 'N'), DECODE(pim_brnd_typ, 2, 'EB', 'MB')\n                      FROM de459e2fe7f96e4d958537b31b946b26.2c04d82ed0aa1cc9bce2cf2c0548b268)\n            SELECT DISTINCT de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.f2de255a7553ba934b1f05ae7699ae4c, de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.852fa1e9f02f1ca2c75837f7146b2381, de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.839c4ffb4bfaae1bb58eab4dee67d96a\n              FROM de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c s,\n                   de459e2fe7f96e4d958537b31b946b26.dec387908a0954ddc8689c4ad37c8a3c d,\n                   de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001 t,\n                   chng ch\n             WHERE de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.839c4ffb4bfaae1bb58eab4dee67d96a = de459e2fe7f96e4d958537b31b946b26.dec387908a0954ddc8689c4ad37c8a3c.839c4ffb4bfaae1bb58eab4dee67d96a\n               AND de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.f5dd4374a3e3af6a775cb6d6b22e8162 = de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.222ccb1d1746bcdb2365f29b3da0b613\n               AND de459e2fe7f96e4d958537b31b946b26.dec387908a0954ddc8689c4ad37c8a3c.2edfd837e0441242d7eed4e0cdf56652 IS NULL\n               AND de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.467a168a7499c57b1859198a7dac7be0 IS NULL\n               AND de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.f5dd4374a3e3af6a775cb6d6b22e8162 >= l_start_dt\n               AND ldr_tm <= l_new_ldr_tm\n               AND de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.d3268eabc4a7d98105fd85f9c9e62cd6e32ad436514bbe822b33de8bead744f3 = 95500760c91ce611ed41dcf117f921ce.d3268eabc4a7d98105fd85f9c9e62cd6e32ad436514bbe822b33de8bead744f3\n               AND NOT EXISTS (SELECT 'X'\n                                 FROM de459e2fe7f96e4d958537b31b946b26.ce1d729fee66fa77fd563722854ae2bd\n                                WHERE fisc_yr_wk = de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.f2de255a7553ba934b1f05ae7699ae4c\n                                  AND cust_nbr = de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.852fa1e9f02f1ca2c75837f7146b2381\n                                  AND div_nbr = de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.839c4ffb4bfaae1bb58eab4dee67d96a);\n\n         DBMS_OUTPUT.put_line('Inserted ' || sql%ROWCOUNT || ' into CHANGE_CUST');\n\n         COMMIT;\n      END IF;\n   END IF;\n\n   \n   IF (p_full_load_flg <> 'Y') THEN\n      \n      SELECT COUNT( * )\n        INTO l_change_scp_cnt\n        FROM (SELECT DISTINCT prod_nbr\n                FROM ((SELECT scp_num,\n                              prod_nbr,\n                              promo_start_dt,\n                              promo_end_dt,\n                              promo_start_wk,\n                              promo_end_wk,\n                              frst_scp_flg\n                         FROM de459e2fe7f96e4d958537b31b946b26.a881784aba9565922acae6462c99da2c\n                       MINUS\n                       SELECT scp_num,\n                              prod_nbr,\n                              promo_start_dt,\n                              promo_end_dt,\n                              promo_start_wk,\n                              promo_end_wk,\n                              frst_scp_flg\n                         FROM de459e2fe7f96e4d958537b31b946b26.f969dbd4756a10712018ddfca1874878)\n                      UNION\n                      (SELECT scp_num,\n                              prod_nbr,\n                              promo_start_dt,\n                              promo_end_dt,\n                              promo_start_wk,\n                              promo_end_wk,\n                              frst_scp_flg\n                         FROM de459e2fe7f96e4d958537b31b946b26.f969dbd4756a10712018ddfca1874878\n                       MINUS\n                       SELECT scp_num,\n                              prod_nbr,\n                              promo_start_dt,\n                              promo_end_dt,\n                              promo_start_wk,\n                              promo_end_wk,\n                              frst_scp_flg\n                         FROM de459e2fe7f96e4d958537b31b946b26.a881784aba9565922acae6462c99da2c)));\n\n      DBMS_OUTPUT.put_line('Number of changed SCP_PROMO_WK records: ' || l_change_scp_cnt);\n\n      IF (l_change_scp_cnt > 0) THEN\n         \n         INSERT \n               INTO de459e2fe7f96e4d958537b31b946b26.ce1d729fee66fa77fd563722854ae2bd\n            WITH chng AS (SELECT DISTINCT prod_nbr\n                            FROM ((SELECT scp_num,\n                                          prod_nbr,\n                                          promo_start_dt,\n                                          promo_end_dt,\n                                          promo_start_wk,\n                                          promo_end_wk,\n                                          frst_scp_flg\n                                     FROM de459e2fe7f96e4d958537b31b946b26.a881784aba9565922acae6462c99da2c\n                                   MINUS\n                                   SELECT scp_num,\n                                          prod_nbr,\n                                          promo_start_dt,\n                                          promo_end_dt,\n                                          promo_start_wk,\n                                          promo_end_wk,\n                                          frst_scp_flg\n                                     FROM de459e2fe7f96e4d958537b31b946b26.f969dbd4756a10712018ddfca1874878)\n                                  UNION\n                                  (SELECT scp_num,\n                                          prod_nbr,\n                                          promo_start_dt,\n                                          promo_end_dt,\n                                          promo_start_wk,\n                                          promo_end_wk,\n                                          frst_scp_flg\n                                     FROM de459e2fe7f96e4d958537b31b946b26.f969dbd4756a10712018ddfca1874878\n                                   MINUS\n                                   SELECT scp_num,\n                                          prod_nbr,\n                                          promo_start_dt,\n                                          promo_end_dt,\n                                          promo_start_wk,\n                                          promo_end_wk,\n                                          frst_scp_flg\n                                     FROM de459e2fe7f96e4d958537b31b946b26.a881784aba9565922acae6462c99da2c)))\n            SELECT DISTINCT de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.f2de255a7553ba934b1f05ae7699ae4c, de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.852fa1e9f02f1ca2c75837f7146b2381, de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.839c4ffb4bfaae1bb58eab4dee67d96a\n              FROM de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c s,\n                   de459e2fe7f96e4d958537b31b946b26.dec387908a0954ddc8689c4ad37c8a3c d,\n                   de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001 t,\n                   chng ch\n             WHERE de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.839c4ffb4bfaae1bb58eab4dee67d96a = de459e2fe7f96e4d958537b31b946b26.dec387908a0954ddc8689c4ad37c8a3c.839c4ffb4bfaae1bb58eab4dee67d96a\n               AND de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.f5dd4374a3e3af6a775cb6d6b22e8162 = de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.222ccb1d1746bcdb2365f29b3da0b613\n               AND de459e2fe7f96e4d958537b31b946b26.dec387908a0954ddc8689c4ad37c8a3c.2edfd837e0441242d7eed4e0cdf56652 IS NULL\n               AND de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.467a168a7499c57b1859198a7dac7be0 IS NULL\n               AND de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.f5dd4374a3e3af6a775cb6d6b22e8162 >= l_start_dt\n               AND ldr_tm <= l_new_ldr_tm\n               AND de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.2d45d761eb8d137835bca7a23010fab4 = 95500760c91ce611ed41dcf117f921ce.2d45d761eb8d137835bca7a23010fab4\n               AND NOT EXISTS (SELECT 'X'\n                                 FROM de459e2fe7f96e4d958537b31b946b26.ce1d729fee66fa77fd563722854ae2bd\n                                WHERE fisc_yr_wk = de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.f2de255a7553ba934b1f05ae7699ae4c\n                                  AND cust_nbr = de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.852fa1e9f02f1ca2c75837f7146b2381\n                                  AND div_nbr = de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.839c4ffb4bfaae1bb58eab4dee67d96a);\n\n         DBMS_OUTPUT.put_line('Inserted ' || sql%ROWCOUNT || ' into CHANGE_CUST');\n\n         COMMIT;\n      END IF;\n   END IF;\n\n   \n   l_return_code   := de459e2fe7f96e4d958537b31b946b26.9b3711c37bca8fd1d7c76527508615f9('XDMADM', 'CHANGE_CUST');\n   DBMS_OUTPUT.put_line('Analyze CHANGE_CUST Return: ' || l_return_code);\n\n   IF (l_return_code <> 0) THEN\n      DBMS_OUTPUT.put_line('Error: Failed to analyze CHANGE_CUST table');\n      RETURN c_error;\n   END IF;\n\n   \n   l_return_code   := 8e64339f96bb08058f5d52f1c04f954a.8ffe4678890c39c7d4ed38c2ed759e24.e4b5db2b3f9b19accbb8cddbfcd05bac(l_out_msg, 'XDMADM', 'CHANGE_PIM');\n\n   IF (l_return_code <> 0) THEN\n      DBMS_OUTPUT.put_line('Error: Failed to truncate CHANGE_PIM table');\n      RETURN c_error;\n   END IF;\n\n   \n   INSERT \n         INTO de459e2fe7f96e4d958537b31b946b26.87e84e1341e66e8b2b6728a9e27bac17\n      SELECT pim_usf_std_prod_cd, DECODE(pim_suprcls_id, 97, 'Y', 'N'), DECODE(pim_brnd_typ, 2, 'EB', 'MB')\n        FROM de459e2fe7f96e4d958537b31b946b26.2c04d82ed0aa1cc9bce2cf2c0548b268;\n\n   COMMIT;\n\n   \n   l_return_code   := de459e2fe7f96e4d958537b31b946b26.9b3711c37bca8fd1d7c76527508615f9('XDMADM', 'CHANGE_PIM');\n   DBMS_OUTPUT.put_line('Analyze CHANGE_PIM Return: ' || l_return_code);\n\n   IF (l_return_code <> 0) THEN\n      DBMS_OUTPUT.put_line('Error: Failed to analyze CHANGE_PIM table');\n      RETURN c_error;\n   END IF;\n\n   \n   \n   l_return_code   := 8e64339f96bb08058f5d52f1c04f954a.8ffe4678890c39c7d4ed38c2ed759e24.e4b5db2b3f9b19accbb8cddbfcd05bac(l_out_msg, 'XDMADM', 'CHANGE_SCP');\n\n   IF (l_return_code <> 0) THEN\n      DBMS_OUTPUT.put_line('Error: Failed to truncate CHANGE_SCP table');\n      RETURN c_error;\n   END IF;\n\n   \n   \n   INSERT \n         INTO de459e2fe7f96e4d958537b31b946b26.f969dbd4756a10712018ddfca1874878\n      SELECT scp_num,\n             prod_nbr,\n             promo_start_dt,\n             promo_end_dt,\n             promo_start_wk,\n             promo_end_wk,\n             frst_scp_flg\n        FROM de459e2fe7f96e4d958537b31b946b26.a881784aba9565922acae6462c99da2c;\n\n   COMMIT;\n\n   \n   \n   l_return_code   := de459e2fe7f96e4d958537b31b946b26.9b3711c37bca8fd1d7c76527508615f9('XDMADM', 'CHANGE_SCP');\n   DBMS_OUTPUT.put_line('Analyze CHANGE_SCP Return: ' || l_return_code);\n\n   IF (l_return_code <> 0) THEN\n      DBMS_OUTPUT.put_line('Error: Failed to analyze CHANGE_SCP table');\n      RETURN c_error;\n   END IF;\n\n   \n   UPDATE de459e2fe7f96e4d958537b31b946b26.0b3320d3f985cd20d1ec65d9dfeed2de\n      SET prcs_dt   = TO_DATE(l_new_ldr_tm, 'YYYYMMDDHH24MISS')\n    WHERE fact_table = 'CUST_WK_AGGR';\n\n   COMMIT;\n   DBMS_OUTPUT.put_line('Updated FACT_LOAD_STAT process date');\n\n   RETURN c_success;\nEXCEPTION\n   WHEN OTHERS THEN\n      ROLLBACK;\n      DBMS_OUTPUT.put_line('Unexepected error');\n      DBMS_OUTPUT.put_line(SQLCODE || ': ' || SQLERRM);\n      RETURN c_error;\nEND fn_change_cust_load;\n/",
            "upstream_dependencies": [],
            "downstream_dependencies": [],
            "dag_location": "null",
            "gantt_location": "null",
            "created_at": "null",
            "updated_at": "null"
        },
        {
            "name": "FN_CASES_BY_GL_ACCT_LOAD",
            "encrypted_name": "2f8696bfcff6d0014b353a4e3caa58a54843539a446edf629a1efb6180b9ca50",
            "type": "function",
            "database": "null",
            "encrypted_database": "null",
            "schema": "XDMADM",
            "encrypted_schema": "0e03d5c46556a742ba46252698396ef2",
            "fully_qualified_name": "XDMADM.FN_CASES_BY_GL_ACCT_LOAD",
            "encrypted_fqn": "0e03d5c46556a742ba46252698396ef2.2f8696bfcff6d0014b353a4e3caa58a54843539a446edf629a1efb6180b9ca50",
            "synonyms": [],
            "metadata_analysis": "CREATE OR REPLACE FUNCTION \"0e03d5c46556a742ba46252698396ef2\".\"2f8696bfcff6d0014b353a4e3caa58a54843539a446edf629a1efb6180b9ca50\" (P_IN_ODATE   IN VARCHAR2)\n   RETURN NUMBER IS\n\n \n\n  \n\n\n\n    v_const         NUMBER := 2 ;\n    v_end_dt        DATE;\n    v_strt_dt       DATE;\n    v_odate         DATE := to_date(p_in_odate,'YYYYMMDD');\n    v_prcs_stp      VARCHAR2(2000);\n    v_ldr_tm        NUMBER(20);\n    v_out_msg       VARCHAR2(256);\n\n    v_dba_func_msg   VARCHAR2(2000) := 'oXo';\n    dml_err_cnt      NUMBER;\n\n\n   l_start              NUMBER;\n   l_end                NUMBER;\n   v_table_owner       VARCHAR2(40) := 'XDMADM'; \n   v_table_name      VARCHAR2(40) := 'CASES_AND_RVNUE_BY_GL_ACCT'; \n   v_truncate_tbl      NUMBER(3);\n\n\n    BEGIN\n\n\n\n\n  \n  \n  BEGIN\n       v_prcs_stp := 'INSERT INTO table starts ';\n       l_start := DBMS_UTILITY.get_time;\n\n        DBMS_OUTPUT.PUT_LINE('TIME ' || to_char(sysdate, 'yyyymmdd hh24:mi:ss'));\n\n  INSERT    INTO de459e2fe7f96e4d958537b31b946b26.0bc437e6dbeee36674bbae9feb068aa40dd4ce2b7ae4c9cdc3aa8ea0ad37a2da (\n     SELECT brnch_cd,\n           fisc_yr,\n           fisc_mth_of_yr,\n           acct,\n           gl_account,\n           cust_acctblty_flg,\n           cust_natl_mngd_flg,\n           ROUND (SUM (unfrm_qty_ship), 2) data_value\n      FROM\n          (SELECT 67bf7d9ddca5a0e34cb18386ed918361.4855453efe73ff0bd0f7583df58260dd, \n                503e5bca9f89192fda7def0b8f40adce.839c4ffb4bfaae1bb58eab4dee67d96a,\n                503e5bca9f89192fda7def0b8f40adce.b8c6ab19cb6e726c38f24d1885346ea3,\n                503e5bca9f89192fda7def0b8f40adce.ab30d6d679879cfacfe389b97d1d3f0e,\n                503e5bca9f89192fda7def0b8f40adce.e1d446673288adb6d5f219d0aa82d37a,\n                nvl(ca31c6f9941cbb812f171a59b9dd664e.c2b9ebe664db8cfc1f7a702af0630a5b, 'UNK') pyr_seg_cd,\n                ca31c6f9941cbb812f171a59b9dd664e.1a4ac3a5fce36e3190aec2ba5713e1ff,\n                503e5bca9f89192fda7def0b8f40adce.e3837b6b258b429fa00c148694e11e48,\n                CASE\n                  WHEN 503e5bca9f89192fda7def0b8f40adce.839c4ffb4bfaae1bb58eab4dee67d96a       = 503e5bca9f89192fda7def0b8f40adce.e3837b6b258b429fa00c148694e11e48  and 503e5bca9f89192fda7def0b8f40adce.b8c6ab19cb6e726c38f24d1885346ea3     = 'CC' and ca31c6f9941cbb812f171a59b9dd664e.b8ee9f6c896415acdd760daefea08893 = 'N'\n                  THEN '9010220'\n                  ELSE ca31c6f9941cbb812f171a59b9dd664e.f91fd5eae8d27d72b6ab5179e897097f\n                END gl_account,\n                503e5bca9f89192fda7def0b8f40adce.318678c82ff4517124bc3a6b8506d59463f2fe9cc6b573bb859641780443a51b,\n                503e5bca9f89192fda7def0b8f40adce.e33988f12139bfc93f1e7557137feb5a29e110ac67769beb8c9647cf15a66d38,\n                503e5bca9f89192fda7def0b8f40adce.ccf8d88f2d37f3171da2121ab22e9330 ,\n                ca31c6f9941cbb812f171a59b9dd664e.6ef3e4abc0d5bd2c29714f3162369e44,\n                ca31c6f9941cbb812f171a59b9dd664e.b8ee9f6c896415acdd760daefea08893\n      FROM    (  SELECT\n                        sls_div_nbr,\n                        div_nbr,\n                        div_typ_cd,\n                        fisc_yr,\n                        fisc_mth_of_yr,\n                        pyr_seg_cd,\n                        gl_acct_cd,\n                        cust_acctblty_flg,\n                        cust_natl_mngd_flg,\n                        delivered_type,\n                        sum(unfrm_qty_ship)  unfrm_qty_ship\n                    FROM de459e2fe7f96e4d958537b31b946b26.affa69d2e18d5ca6c7314c74ba00bf4ba435d42d15ea9fc5301ef86c434eccb0\n                GROUP BY\n                            sls_div_nbr,\n                            div_nbr,\n                            div_typ_cd,\n                            fisc_yr,\n                            fisc_mth_of_yr,\n                            pyr_seg_cd,\n                            gl_acct_cd,\n                            cust_acctblty_flg,\n                            cust_natl_mngd_flg,\n                            delivered_type ) x1\n                 LEFT OUTER JOIN de459e2fe7f96e4d958537b31b946b26.711f5f4c350254b40ce960d47ae1ab08fc3a5c81683f41af2951fae7621d4729 x2\n                               ON  503e5bca9f89192fda7def0b8f40adce.156f54b388a4986aa3d3d8e74d0fc0cd     = de459e2fe7f96e4d958537b31b946b26.711f5f4c350254b40ce960d47ae1ab08fc3a5c81683f41af2951fae7621d4729.c2b9ebe664db8cfc1f7a702af0630a5b\n                              AND 503e5bca9f89192fda7def0b8f40adce.b8ee9f6c896415acdd760daefea08893 = de459e2fe7f96e4d958537b31b946b26.711f5f4c350254b40ce960d47ae1ab08fc3a5c81683f41af2951fae7621d4729.b8ee9f6c896415acdd760daefea08893 \n                  INNER JOIN de459e2fe7f96e4d958537b31b946b26.dec387908a0954ddc8689c4ad37c8a3c x3\n                          ON de459e2fe7f96e4d958537b31b946b26.711f5f4c350254b40ce960d47ae1ab08fc3a5c81683f41af2951fae7621d4729.b8c6ab19cb6e726c38f24d1885346ea3                    = de459e2fe7f96e4d958537b31b946b26.dec387908a0954ddc8689c4ad37c8a3c.b8c6ab19cb6e726c38f24d1885346ea3\n                         AND NVL(503e5bca9f89192fda7def0b8f40adce.e3837b6b258b429fa00c148694e11e48, 503e5bca9f89192fda7def0b8f40adce.839c4ffb4bfaae1bb58eab4dee67d96a) = de459e2fe7f96e4d958537b31b946b26.dec387908a0954ddc8689c4ad37c8a3c.839c4ffb4bfaae1bb58eab4dee67d96a)\n               GROUP BY\n                       brnch_cd,\n                       fisc_yr,\n                       fisc_mth_of_yr,\n                       acct,\n                       gl_account,\n                       cust_acctblty_flg,\n                       cust_natl_mngd_flg );\n\n\n      l_end := DBMS_UTILITY.get_time;\n\n\n      DBMS_OUTPUT.PUT_LINE('NO OF ROWS INSERTED:' || sql%rowcount ) ;\n\n      DBMS_OUTPUT.PUT_LINE ( round( (l_end - l_start)/100, 2 ) ||' seconds...' );\n      COMMIT;\n       RETURN 0;\n    exception\n      WHEN OTHERS\n      THEN\n        DBMS_OUTPUT.PUT_LINE('Error in v_prcs_stp:'||v_prcs_stp || SQLCODE || SQLERRM );\n\n\n\n         RETURN 701;\n    END;\n\n\n   \n   \n   \n\n    EXCEPTION\n      WHEN OTHERS\n      THEN\n     ROLLBACK;\n     DBMS_OUTPUT.PUT_LINE(SQLCODE);\n     DBMS_OUTPUT.PUT_LINE(SQLERRM);\n\n    DBMS_OUTPUT.put_line('Error in function FN_CASES_BY_GL_ACCT_LOAD');\n    RETURN 600;\n\n\n\nEND FN_CASES_BY_GL_ACCT_LOAD;\n/",
            "upstream_dependencies": [],
            "downstream_dependencies": [],
            "dag_location": "null",
            "gantt_location": "null",
            "created_at": "null",
            "updated_at": "null"
        },
        {
            "name": "FN_COMPRESS_SUB_PART_TBL",
            "encrypted_name": "3ab1a934c1e73af48d255295c1b11bcdd45bab88ce33eb06efb7fa7143b3813e",
            "type": "function",
            "database": "null",
            "encrypted_database": "null",
            "schema": "XDMADM",
            "encrypted_schema": "0e03d5c46556a742ba46252698396ef2",
            "fully_qualified_name": "XDMADM.FN_COMPRESS_SUB_PART_TBL",
            "encrypted_fqn": "0e03d5c46556a742ba46252698396ef2.3ab1a934c1e73af48d255295c1b11bcdd45bab88ce33eb06efb7fa7143b3813e",
            "synonyms": [],
            "metadata_analysis": "CREATE OR REPLACE FUNCTION \"0e03d5c46556a742ba46252698396ef2\".\"3ab1a934c1e73af48d255295c1b11bcdd45bab88ce33eb06efb7fa7143b3813e\"\n                                     (V_TABLE_OWNER     IN VARCHAR2\n                                     ,V_TABLE_NAME      IN VARCHAR2\n                                     ,V_PARTITION_VALUE IN VARCHAR2)\n      RETURN VARCHAR2\n   AS\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n  CON_PROCESS_NAME  CONSTANT varchar2(40) := 'FN_COMPRESS_SUB_PART_TBL';\n\n\n\n\n   CURSOR c1\n   IS\n        SELECT subpartition_name\n          FROM sys.ALL_TAB_SUBPARTITIONS\n         WHERE table_owner = V_TABLE_OWNER\n           AND table_name = V_TABLE_NAME\n           and partition_name in\n                (SELECT partition_name\n                    FROM sys.all_tab_partitions\n                    WHERE table_owner = V_TABLE_OWNER\n                      AND table_name =  V_TABLE_NAME\n                      and partition_name =V_PARTITION_VALUE\n                  )\n      ORDER BY 1;\n\n\n\n   v_subpartition_name   SYS.ALL_TAB_SUBPARTITIONS.SUBPARTITION_NAME%TYPE;\n\n\n\n\n   v_prcs_nm            varchar(100);\n   v_prcs_stp           varchar(100);\n   v_prcs_pram          varchar(100);\n\n\n\n\nBEGIN\n      dbms_output.put_line('Start Process '||CON_PROCESS_NAME);\n      dbms_output.put_line('Start Time:'||TO_CHAR(SYSDATE,'YYYY-MM-DD HH24:MI:SS'));\n      v_prcs_nm  := CON_PROCESS_NAME ;\n      v_prcs_pram:= v_subpartition_name;\n      v_prcs_stp := 'Start Process '||CON_PROCESS_NAME;\n\n      OPEN c1;\n\n\n\n  << compress_sub_partitions>>\n       v_prcs_stp := 'Compress Subpartitions';\n\n       LOOP\n          FETCH c1 INTO v_subpartition_name;\n\n          EXIT WHEN c1%NOTFOUND;\n\n\n          EXECUTE IMMEDIATE 'ALTER TABLE '||V_TABLE_OWNER||'.'||V_TABLE_NAME||' MOVE SUBPARTITION '\n                           || v_subpartition_name\n                           || ' COMPRESS for query high parallel 16';\n\n\n\n          COMMIT;\n       END LOOP;\n\n\n\n\n  <<Wrap_Program>>\n\n      v_prcs_stp := 'Final Commit';\n\n      CLOSE c1;\n\n      commit;\n\n      dbms_output.put_line ('Compression Completed for Partition:' || V_PARTITION_VALUE);\n      dbms_output.put_line('End Time:'||to_char(sysdate,'YYYY-MM-DD HH24:MI:SS'));\n\n      RETURN 0;\n\n\n\nEXCEPTION\n   WHEN OTHERS\n   THEN\n         DBMS_OUTPUT.put_line ('v_subpartition_name:' || v_subpartition_name);\n         DBMS_OUTPUT.put_line ('SQLERROR:' || SQLCODE || ',' || SQLERRM);\n         DBMS_OUTPUT.PUT_LINE(       v_prcs_nm\n                            ||' - '||v_prcs_stp\n                            ||' - '||v_prcs_pram);\n\n      RETURN -1;\nEND;\n/",
            "upstream_dependencies": [],
            "downstream_dependencies": [],
            "dag_location": "null",
            "gantt_location": "null",
            "created_at": "null",
            "updated_at": "null"
        },
        {
            "name": "FN_SALES_SUMM_CUST_MRCH_LOAD",
            "encrypted_name": "a9ca92b9d6fb7b13e7a2fefda1446c430702efe2a150fc3c5e2f2dbab67f988c",
            "type": "function",
            "database": "null",
            "encrypted_database": "null",
            "schema": "XDMADM",
            "encrypted_schema": "0e03d5c46556a742ba46252698396ef2",
            "fully_qualified_name": "XDMADM.FN_SALES_SUMM_CUST_MRCH_LOAD",
            "encrypted_fqn": "0e03d5c46556a742ba46252698396ef2.a9ca92b9d6fb7b13e7a2fefda1446c430702efe2a150fc3c5e2f2dbab67f988c",
            "synonyms": [],
            "metadata_analysis": "CREATE OR REPLACE FUNCTION \"0e03d5c46556a742ba46252698396ef2\".\"a9ca92b9d6fb7b13e7a2fefda1446c430702efe2a150fc3c5e2f2dbab67f988c\" (\n   v_in_odate IN VARCHAR2)\n   RETURN NUMBER\nIS\n   \n\n\n   CON_PROCESS_NAME  CONSTANT varchar2(40) := 'FN_SALES_SUMM_CUST_MRCH_LOAD';\n\n    \n   v_odate                        DATE := TO_DATE (v_in_odate, 'YYYYMMDD');\n   v_cur_fisc_yr_mth          0e03d5c46556a742ba46252698396ef2.1609b28739e207519049a2cf090bfd19.2603c45be643e5cd8f9c6dad3bee6cb3%TYPE;\n   v_last_fisc_yr_mth         0e03d5c46556a742ba46252698396ef2.1609b28739e207519049a2cf090bfd19.2603c45be643e5cd8f9c6dad3bee6cb3%TYPE;\n   v_cur_fisc_mth_of_yr     0e03d5c46556a742ba46252698396ef2.1609b28739e207519049a2cf090bfd19.e1d446673288adb6d5f219d0aa82d37a%TYPE;\n   v_last_fisc_mth_of_yr    0e03d5c46556a742ba46252698396ef2.1609b28739e207519049a2cf090bfd19.e1d446673288adb6d5f219d0aa82d37a%TYPE;\n   v_fisc_yr                       0e03d5c46556a742ba46252698396ef2.1609b28739e207519049a2cf090bfd19.ab30d6d679879cfacfe389b97d1d3f0e%TYPE;\n   v_cur_fisc_prd_nm         0e03d5c46556a742ba46252698396ef2.1609b28739e207519049a2cf090bfd19.c6e0ffd13b59a270d18bfba7afeed0e2%TYPE;\n   v_last_fisc_prd_nm        0e03d5c46556a742ba46252698396ef2.1609b28739e207519049a2cf090bfd19.c6e0ffd13b59a270d18bfba7afeed0e2%TYPE;\n   v_prd_strt_dt                DATE;\n   v_prd_end_dt                DATE;\n   v_fisc_yr_mth        VARCHAR2 (8 Byte);\n   v_fisc_wks_this_pd   NUMBER;\n   v_pim_super_id   Varchar(20 Byte);\n   v_pim_mrch_ctgry_nm  Varchar(200 Byte);\n   l_fisc_yr_qtr VARCHAR(8 Byte);\n   l_fisc_cnt NUMBER;\n   v_12_prd_strt_dt  DATE;\n   v_12_prd_end_dt    DATE;\n   v_param_value NUMBER;\n\n\n   v_syn_nm                    42183b964ff47e407206508ef9606770.b6b353c534e61967560fe35bfd68bab2.5e4be82fa55134ee91432a9d827d6cfb%TYPE:= 'SALES_SUMM_CUST_MRCH' ;\n   v_tbl_to_load               42183b964ff47e407206508ef9606770.b6b353c534e61967560fe35bfd68bab2.80f6badb5be48efbfc5290fa64e4e111%TYPE;\n   v_tbl_owner                 VARCHAR2(40 BYTE):='XDMADM';\n   v_tbl_inactv                 VARCHAR2 (40 BYTE);\n   v_tbl_actv                    VARCHAR2 (40 BYTE);\n   v_tbl_nm                     VARCHAR2 (40 BYTE);\n   v_sql_str                     VARCHAR2(5000):=' ';\n\n   v_cnt                     NUMBER;\n   v_ret_val                NUMBER;\n   v_trunc_allow         boolean;\n   v_trunc_ret            NUMBER(3);\n   v_grs_sls_extnd      NUMBER;\n   v_unfrm_qty_ship   NUMBER;\n\n\n   v_prcs_nm           varchar(100);\n   v_prcs_step         varchar(100);\n   v_prcs_pram        varchar(100);\n   v_out_msg           varchar(200);\n\n\n\n\n   ALL_EXCEPTIONS       EXCEPTION;\n\nBEGIN\n    dbms_output.put_line('Start Process '||CON_PROCESS_NAME);\n    dbms_output.put_line('Start Time:'||TO_CHAR(SYSDATE,'YYYY-MM-DD HH24:MI:SS'));\n    v_prcs_nm  := CON_PROCESS_NAME ;\n    v_prcs_pram:= 'PARAM1 : '||v_odate;\n    v_prcs_step := 'Start Process '||CON_PROCESS_NAME;\n\n   \n\n   v_prcs_step:='Getting date parameters';\n\n   SELECT   CAST (100\n            * (CASE\n                  WHEN fisc_mth_of_yr = '01' THEN fisc_yr - 1\n                  ELSE fisc_yr\n               END)\n            + CASE\n                 WHEN fisc_mth_of_yr = '01' THEN 12\n                 ELSE CAST (fisc_mth_of_yr AS INT) - 1\n              END AS CHAR (6)\n         ) mth\n  INTO   v_fisc_yr_mth\n  FROM   0e03d5c46556a742ba46252698396ef2.476a877ff313a9e06b3ba262c317b001\n WHERE   clndr_dt = TRUNC(v_odate);\n\n select distinct fisc_wks_this_pd\n   into v_fisc_wks_this_pd\n  from de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001\n where fisc_yr_mth = v_fisc_yr_mth;\n\n   SELECT de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.2603c45be643e5cd8f9c6dad3bee6cb3\n     INTO v_cur_fisc_yr_mth\n     FROM de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001 t\n    WHERE de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.222ccb1d1746bcdb2365f29b3da0b613 = v_odate;\n\n   DBMS_OUTPUT.put_line ('Current Period is '|| v_cur_fisc_yr_mth);\n\n    SELECT MAX (de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.2603c45be643e5cd8f9c6dad3bee6cb3)\n       INTO v_last_fisc_yr_mth\n      FROM de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001 a\n     WHERE de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.2603c45be643e5cd8f9c6dad3bee6cb3 < (SELECT de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.2603c45be643e5cd8f9c6dad3bee6cb3\n                              FROM de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001 a\n                             WHERE de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.222ccb1d1746bcdb2365f29b3da0b613 = TRUNC (v_odate));\n\n      SELECT   MAX(FISC_YR_QTR)\n      into l_fisc_yr_qtr\n                             FROM   de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001\n                             WHERE   FISC_YR_QTR <\n                              (SELECT   FISC_YR_QTR\n                                         FROM   de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001\n                                        WHERE   clndr_dt = v_odate);\n\n         DBMS_OUTPUT.put_line ('fisc_yr_qtr' || l_fisc_yr_qtr);\n\n     \n     select count(*)\n        into l_fisc_cnt\n        from de459e2fe7f96e4d958537b31b946b26.163ed59da4f9e6a8bce446b0df2de84163f2fe9cc6b573bb859641780443a51b\n      where fisc_yr_qtr = l_fisc_yr_qtr\n        and rownum = 1;\n\n               if l_fisc_cnt = 0\n               then\n               DBMS_OUTPUT.put_line ('de459e2fe7f96e4d958537b31b946b26.163ed59da4f9e6a8bce446b0df2de84163f2fe9cc6b573bb859641780443a51b does not have correct fisc_yr_qtr');\n               DBMS_OUTPUT.put_line ('Correct fisc_yr_qtr is ' || l_fisc_yr_qtr);\n               return 1 ;\n               end if;\n\n\n   DBMS_OUTPUT.put_line ('Last Closed Period is '|| v_last_fisc_yr_mth);\n\n    SELECT MIN(clndr_dt),MAX (clndr_dt)\n     INTO v_prd_strt_dt, v_prd_end_dt\n     FROM de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001\n    WHERE fisc_yr_mth = v_last_fisc_yr_mth;\n\n   DBMS_OUTPUT.put_line ('Start Date of last period is '|| v_prd_strt_dt);\n   DBMS_OUTPUT.put_line ('End Date of last period is '|| v_prd_end_dt);\n\n    select max(clndr_dt) INTO v_12_prd_end_dt from de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001 where fisc_yr_mth in (\n    SELECT MAX (de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.2603c45be643e5cd8f9c6dad3bee6cb3)\n      FROM de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001 a\n     WHERE de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.2603c45be643e5cd8f9c6dad3bee6cb3 < (SELECT de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.2603c45be643e5cd8f9c6dad3bee6cb3\n                              FROM de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001 a\n                             WHERE de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.222ccb1d1746bcdb2365f29b3da0b613 = TRUNC (v_odate)));\n\n  DBMS_OUTPUT.put_line('End Date: '||v_12_prd_end_dt);\n\n   select min(clndr_dt)\n   into  v_12_prd_strt_dt\n     from de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001\n    where fisc_yr_mth in\n              (select  fisc_yr_mth - 100 as \"12_Mth_Ago\"\n                 from   de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001\n                 where  clndr_dt = trunc(v_odate));\n\n DBMS_OUTPUT.put_line('Start Date: '||v_12_prd_strt_dt);\n\n   SELECT tbl_nm\n     INTO v_tbl_inactv\n     FROM 9751bbbcfea690cc0be4d58830a6fe2e.56ac3befbcbada23fa9268d8fe6d5242\n    WHERE synonym_nm = v_syn_nm AND actv_ind = 'N';\n\n   SELECT tbl_nm\n     INTO v_tbl_actv\n     FROM 9751bbbcfea690cc0be4d58830a6fe2e.56ac3befbcbada23fa9268d8fe6d5242\n    WHERE synonym_nm = v_syn_nm AND actv_ind = 'Y';\n\n   SELECT table_name\n      INTO v_tbl_nm\n    FROM ALL_SYNONYMS\n   WHERE     owner = 'XDMADM'\n       AND table_owner = 'XDMADM'\n       AND synonym_name = 'SALES_SUMM_CUST_MRCH';\n\n       SELECT   param_value_nbr\n   INTO   v_param_value\n   FROM   de459e2fe7f96e4d958537b31b946b26.de40ae7be8b2eb3858d46af8d107f3db\n WHERE   app_name = 'SALES_COVERAGE_MMA'\n   AND   param_type ='DEFAULT_PNTRTN_RATE';\n\n\n    IF v_tbl_actv <> v_tbl_nm THEN\n         dbms_output.put_line('The tables ALL_SYNONYMS and 9751bbbcfea690cc0be4d58830a6fe2e.56ac3befbcbada23fa9268d8fe6d5242 are not in synch');\n         RETURN 1;\n    END IF;\n\n   DBMS_OUTPUT.put_line ('Table which needs to be loaded for '|| v_last_fisc_yr_mth|| ' is '|| v_tbl_inactv);\n\n\n\n\n   v_prcs_step := 'Truncating '||v_tbl_inactv ||' Table';\n   dbms_output.put_line('Truncating the table '||v_tbl_inactv);\n    v_trunc_ret := 7540495dc7d95c8483c39c98db3db89c.72d996f41712e622935d17bc9cb23cfa.bf64c6f363cecdf8179ad64aad199c7e(v_out_msg, 'XDMADM',v_tbl_inactv);\n     DBMS_OUTPUT.PUT_LINE(v_out_msg);\n     IF v_trunc_ret != 0 THEN\n        DBMS_OUTPUT.PUT_LINE('Error in Truncating '||v_tbl_inactv||' table');\n        RAISE ALL_EXCEPTIONS;\n     END IF;\n\n   v_tbl_to_load := v_tbl_inactv;\n\n\n\n   DBMS_OUTPUT.put_line ('Loading the table ' || v_tbl_to_load || ' started...' || systimestamp);\n\n  \n   \n   v_prcs_step:='Build all customer to merch category combinations';\n\nv_sql_str:=' INSERT INTO '|| v_tbl_owner||'.'||v_tbl_to_load\n    || ' with merch_sales as (  SELECT   count(distinct case when 80bed7bf10aa6c209fe2db0848bd6119.26ac88e7ae671a1b22c14c2fce77aa2d = ''RT'' then '\n    || '80bed7bf10aa6c209fe2db0848bd6119.4fdc122fb2d10dd764e32cbc98972eca||CUST_NBR||INV_DT||nvl(DLVR_RTE,'' '')||PRCS_DT '\n    || 'else ''0'' end) drops, 80bed7bf10aa6c209fe2db0848bd6119.839c4ffb4bfaae1bb58eab4dee67d96a, 80bed7bf10aa6c209fe2db0848bd6119.852fa1e9f02f1ca2c75837f7146b2381, '\n    || v_last_fisc_yr_mth\n    || ', NVL (14b72f98c2aa6561e42572349ab39342.5aeb276d6e88a3ea87ca7a7dd9ffa3a698df5d6b623334f2e9631188cca4cfd6,''UNKNOWN'') pim_mrch_ctgry_nm, '\n    || 'SUM (NVL (80bed7bf10aa6c209fe2db0848bd6119.2ee1400a0150f0b220dd7bd6268d1e66, 0)) grs_sls_extnd,\n                      SUM (NVL (80bed7bf10aa6c209fe2db0848bd6119.ccf8d88f2d37f3171da2121ab22e9330, 0)) unfrm_qty_ship,\n                      SUM (NVL (80bed7bf10aa6c209fe2db0848bd6119.1afca342ab89e5b8c65c6c4c634b2186, 0)) actl_gp\n               FROM   de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c s,de459e2fe7f96e4d958537b31b946b26.2c04d82ed0aa1cc9bce2cf2c0548b268 p,de459e2fe7f96e4d958537b31b946b26.dec387908a0954ddc8689c4ad37c8a3c div\n              WHERE   nvl(80bed7bf10aa6c209fe2db0848bd6119.dd95a4741b2ab36b2428b3c42ef8b0448cd47113485ed05c776655af504ed664,80bed7bf10aa6c209fe2db0848bd6119.839c4ffb4bfaae1bb58eab4dee67d96a) = de459e2fe7f96e4d958537b31b946b26.dec387908a0954ddc8689c4ad37c8a3c.4fdc122fb2d10dd764e32cbc98972eca and de459e2fe7f96e4d958537b31b946b26.dec387908a0954ddc8689c4ad37c8a3c.b8c6ab19cb6e726c38f24d1885346ea3 <> ''CC'' and NVL (de459e2fe7f96e4d958537b31b946b26.dec387908a0954ddc8689c4ad37c8a3c.c712a9ab5ef100c5807fa96123dac48b,''USF'') = ''USF''\n                      AND 80bed7bf10aa6c209fe2db0848bd6119.f5dd4374a3e3af6a775cb6d6b22e8162 BETWEEN '''||v_prd_strt_dt||''' AND '''||v_prd_end_dt||'''\n                      AND XFER_TO_DT IS NULL\n                      AND 14b72f98c2aa6561e42572349ab39342.8b8c72c349530db846280000957f636d = 80bed7bf10aa6c209fe2db0848bd6119.8b8c72c349530db846280000957f636d\n                      AND 14b72f98c2aa6561e42572349ab39342.89f3df82917b692fe64dca942d924e7c NOT IN\n                               (SELECT   param_value_nbr FROM   de459e2fe7f96e4d958537b31b946b26.de40ae7be8b2eb3858d46af8d107f3db WHERE   app_name =''FN_CUST_MRCH_NTL_AVG_LOAD''  AND param_type = ''PIM_SUPRCLS_ID'')\n           GROUP BY   80bed7bf10aa6c209fe2db0848bd6119.839c4ffb4bfaae1bb58eab4dee67d96a,\n                      80bed7bf10aa6c209fe2db0848bd6119.852fa1e9f02f1ca2c75837f7146b2381,\n                      14b72f98c2aa6561e42572349ab39342.5aeb276d6e88a3ea87ca7a7dd9ffa3a698df5d6b623334f2e9631188cca4cfd6),\n    cust as\n    (SELECT   DISTINCT 80bed7bf10aa6c209fe2db0848bd6119.839c4ffb4bfaae1bb58eab4dee67d96a, 80bed7bf10aa6c209fe2db0848bd6119.852fa1e9f02f1ca2c75837f7146b2381, 79bce3e4027780054b8a49ac57719e09.0e5400811a26142f22e82e8c549073a6,79bce3e4027780054b8a49ac57719e09.692d5399871e27b127ba4e3b3b7320ca382d0f5d3019cd2839eb42d66c71274c,79bce3e4027780054b8a49ac57719e09.7c69e8dbcf1eb7c5ac686fa0156ed0ebcd29164cb73cbe96e5420c0f260e477e\n                       FROM   MERCH_SALES s, de459e2fe7f96e4d958537b31b946b26.52982d3bbc1ebc2720d9504c7ea2ed3f c\n                      WHERE   80bed7bf10aa6c209fe2db0848bd6119.852fa1e9f02f1ca2c75837f7146b2381 = 79bce3e4027780054b8a49ac57719e09.852fa1e9f02f1ca2c75837f7146b2381\n                      and 80bed7bf10aa6c209fe2db0848bd6119.839c4ffb4bfaae1bb58eab4dee67d96a = 79bce3e4027780054b8a49ac57719e09.839c4ffb4bfaae1bb58eab4dee67d96a ),\n    sales\n       AS (SELECT   79bce3e4027780054b8a49ac57719e09.839c4ffb4bfaae1bb58eab4dee67d96a,\n                    79bce3e4027780054b8a49ac57719e09.852fa1e9f02f1ca2c75837f7146b2381,\n                    '||v_last_fisc_yr_mth || ',\n                    c1f84e8860c9acbd312fc2d82a40cc08.5aeb276d6e88a3ea87ca7a7dd9ffa3a698df5d6b623334f2e9631188cca4cfd6,\n                    0 grs_sls_extnd,\n                    0 unfrm_qty_ship,\n                    79bce3e4027780054b8a49ac57719e09.0e5400811a26142f22e82e8c549073a6,\n                    79bce3e4027780054b8a49ac57719e09.692d5399871e27b127ba4e3b3b7320ca382d0f5d3019cd2839eb42d66c71274c,\n                    79bce3e4027780054b8a49ac57719e09.7c69e8dbcf1eb7c5ac686fa0156ed0ebcd29164cb73cbe96e5420c0f260e477e\n             FROM   cust c,\n                    (SELECT   DISTINCT  NVL (pim_mrch_ctgry_nm, ''UNKNOWN'')    pim_mrch_ctgry_nm   FROM   de459e2fe7f96e4d958537b31b946b26.2c04d82ed0aa1cc9bce2cf2c0548b268) pim),\nptnl\n       AS (SELECT   79bce3e4027780054b8a49ac57719e09.852fa1e9f02f1ca2c75837f7146b2381,\n                    79bce3e4027780054b8a49ac57719e09.839c4ffb4bfaae1bb58eab4dee67d96a,\n                    79bce3e4027780054b8a49ac57719e09.0e5400811a26142f22e82e8c549073a6,\n                    0e03d5c46556a742ba46252698396ef2.38015843d86fd4eaa70452862e0eb01b33abc8a25a99d929134e1808ddd537c5.5aeb276d6e88a3ea87ca7a7dd9ffa3a698df5d6b623334f2e9631188cca4cfd6,\n                    CASE\n                       WHEN 79bce3e4027780054b8a49ac57719e09.7c69e8dbcf1eb7c5ac686fa0156ed0ebcd29164cb73cbe96e5420c0f260e477e = ''N'' AND NVL(6f0c06b9d336c874b1d8acd539f80993.c67e714c50092871e215f33a602c124d339d6512d0af0b6fe1f57edcdf48f234,0) = 0\n                       THEN  79bce3e4027780054b8a49ac57719e09.692d5399871e27b127ba4e3b3b7320ca382d0f5d3019cd2839eb42d66c71274c * ' || v_fisc_wks_this_pd|| '\n                       WHEN 79bce3e4027780054b8a49ac57719e09.7c69e8dbcf1eb7c5ac686fa0156ed0ebcd29164cb73cbe96e5420c0f260e477e = ''N'' AND NVL(6f0c06b9d336c874b1d8acd539f80993.c67e714c50092871e215f33a602c124d339d6512d0af0b6fe1f57edcdf48f234,0) <> 0\n                       THEN (0e03d5c46556a742ba46252698396ef2.24b4bc4c4cf4a9bc5d0f1ed790d1bd64fe1273d196c209677ff154534715415c.9cd2aa2a4161fda471ecbb591b3bd2f5fff9944709e8751521a61766c272dd58 / 52) * '|| v_fisc_wks_this_pd||'\n                       WHEN 31624cbb78d44c0eddf265fdbafcf907.46a1d305db3a3ec822e32ba64d8368c9c355dee0d4b8b9ac1b8e508c590373d3 = ''Y'' AND NVL(31624cbb78d44c0eddf265fdbafcf907.60b6d3b655afc3fa3fe57ec97a06d77ce7f1bb4487d12718c0cdcdefab6381f3,0) = 0\n                       THEN (0e03d5c46556a742ba46252698396ef2.24b4bc4c4cf4a9bc5d0f1ed790d1bd64fe1273d196c209677ff154534715415c.9cd2aa2a4161fda471ecbb591b3bd2f5fff9944709e8751521a61766c272dd58 / 52) * '|| v_fisc_wks_this_pd||'\n                       WHEN 31624cbb78d44c0eddf265fdbafcf907.46a1d305db3a3ec822e32ba64d8368c9c355dee0d4b8b9ac1b8e508c590373d3 = ''Y'' AND NVL(31624cbb78d44c0eddf265fdbafcf907.60b6d3b655afc3fa3fe57ec97a06d77ce7f1bb4487d12718c0cdcdefab6381f3,0) <> 0\n                       THEN  79bce3e4027780054b8a49ac57719e09.692d5399871e27b127ba4e3b3b7320ca382d0f5d3019cd2839eb42d66c71274c *'|| v_fisc_wks_this_pd|| '\n                    END\n                       crm_ttl_mthly_ptnl,\n                    0e03d5c46556a742ba46252698396ef2.38015843d86fd4eaa70452862e0eb01b33abc8a25a99d929134e1808ddd537c5.beb5785e3d7a9dbdf6a6bbfea7b99bb572b849fbff7c001c386aa148f05345ea\n             FROM   cust c,\n                    0e03d5c46556a742ba46252698396ef2.38015843d86fd4eaa70452862e0eb01b33abc8a25a99d929134e1808ddd537c5 cmc,\n                    0e03d5c46556a742ba46252698396ef2.24b4bc4c4cf4a9bc5d0f1ed790d1bd64fe1273d196c209677ff154534715415c cmp\n            WHERE       1 = 1\n                    AND 0e03d5c46556a742ba46252698396ef2.38015843d86fd4eaa70452862e0eb01b33abc8a25a99d929134e1808ddd537c5.0e5400811a26142f22e82e8c549073a6 = 79bce3e4027780054b8a49ac57719e09.0e5400811a26142f22e82e8c549073a6\n                    AND 79bce3e4027780054b8a49ac57719e09.852fa1e9f02f1ca2c75837f7146b2381 = 0e03d5c46556a742ba46252698396ef2.24b4bc4c4cf4a9bc5d0f1ed790d1bd64fe1273d196c209677ff154534715415c.852fa1e9f02f1ca2c75837f7146b2381(+)\n                    AND 79bce3e4027780054b8a49ac57719e09.839c4ffb4bfaae1bb58eab4dee67d96a = 0e03d5c46556a742ba46252698396ef2.24b4bc4c4cf4a9bc5d0f1ed790d1bd64fe1273d196c209677ff154534715415c.839c4ffb4bfaae1bb58eab4dee67d96a(+)\n                    AND 0e03d5c46556a742ba46252698396ef2.24b4bc4c4cf4a9bc5d0f1ed790d1bd64fe1273d196c209677ff154534715415c.17a7541ba0af7b39947d91f68f8cf748 (+) = ''Y''),\n           pntrtn_rate as\n        (select 80bed7bf10aa6c209fe2db0848bd6119.852fa1e9f02f1ca2c75837f7146b2381, 80bed7bf10aa6c209fe2db0848bd6119.839c4ffb4bfaae1bb58eab4dee67d96a,\n         (SUM (NVL (80bed7bf10aa6c209fe2db0848bd6119.2ee1400a0150f0b220dd7bd6268d1e66, 0))/nvl(e089adbf06af82e41ef429c19dfbe45d.46c15f2e85fafbfae0610bbb6710e373, '||v_param_value||'))/12 as cust_ttl_ptnl\n        from de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c s,de459e2fe7f96e4d958537b31b946b26.d26d0e860281f1968d53c43aaaab9ae554a969d2d379cfdbd590ec1ebc278741 m,cust c,0e03d5c46556a742ba46252698396ef2.8d75a8f2ab4850b84709184da29f9cdb DIV\n         where nvl(80bed7bf10aa6c209fe2db0848bd6119.dd95a4741b2ab36b2428b3c42ef8b0448cd47113485ed05c776655af504ed664,80bed7bf10aa6c209fe2db0848bd6119.839c4ffb4bfaae1bb58eab4dee67d96a) = de459e2fe7f96e4d958537b31b946b26.dec387908a0954ddc8689c4ad37c8a3c.4fdc122fb2d10dd764e32cbc98972eca and de459e2fe7f96e4d958537b31b946b26.dec387908a0954ddc8689c4ad37c8a3c.b8c6ab19cb6e726c38f24d1885346ea3 <> ''CC'' and NVL (de459e2fe7f96e4d958537b31b946b26.dec387908a0954ddc8689c4ad37c8a3c.c712a9ab5ef100c5807fa96123dac48b,''USF'') = ''USF''\n           AND e089adbf06af82e41ef429c19dfbe45d.0e5400811a26142f22e82e8c549073a6(+) = 79bce3e4027780054b8a49ac57719e09.0e5400811a26142f22e82e8c549073a6\n           and 80bed7bf10aa6c209fe2db0848bd6119.852fa1e9f02f1ca2c75837f7146b2381 = 79bce3e4027780054b8a49ac57719e09.852fa1e9f02f1ca2c75837f7146b2381\n           and 80bed7bf10aa6c209fe2db0848bd6119.839c4ffb4bfaae1bb58eab4dee67d96a = 79bce3e4027780054b8a49ac57719e09.839c4ffb4bfaae1bb58eab4dee67d96a\n           AND XFER_TO_DT IS NULL\n           and 80bed7bf10aa6c209fe2db0848bd6119.f5dd4374a3e3af6a775cb6d6b22e8162 BETWEEN '''||v_12_prd_strt_dt||''' AND '''||v_12_prd_end_dt||'''\n           group by 80bed7bf10aa6c209fe2db0848bd6119.852fa1e9f02f1ca2c75837f7146b2381, 80bed7bf10aa6c209fe2db0848bd6119.839c4ffb4bfaae1bb58eab4dee67d96a, avg_pntrtn_rate)\nSELECT   80bed7bf10aa6c209fe2db0848bd6119.839c4ffb4bfaae1bb58eab4dee67d96a,\n         80bed7bf10aa6c209fe2db0848bd6119.852fa1e9f02f1ca2c75837f7146b2381,\n         '||v_last_fisc_yr_mth || ',\n         80bed7bf10aa6c209fe2db0848bd6119.5aeb276d6e88a3ea87ca7a7dd9ffa3a698df5d6b623334f2e9631188cca4cfd6,\n         nvl(e089adbf06af82e41ef429c19dfbe45d.2ee1400a0150f0b220dd7bd6268d1e66,0),\n         nvl(e089adbf06af82e41ef429c19dfbe45d.ccf8d88f2d37f3171da2121ab22e9330,0),\n         14b72f98c2aa6561e42572349ab39342.0e5400811a26142f22e82e8c549073a6,\n         case when nvl(crm_ttl_mthly_ptnl,0) = 0 then aa1d56f7317d38d67a48f784824e1936.2ff17ac807c8ff41200bbccc2ac22fe9 else crm_ttl_mthly_ptnl end crm_ttl_mthly_ptnl,\n         nvl(ntl_avg_spnd_prcnt,0),\n         case when drops >0 then actl_gp/drops else 0 end tgapdrops\n  FROM   ptnl p, sales s, MERCH_SALES m, pntrtn_rate r\n WHERE       14b72f98c2aa6561e42572349ab39342.852fa1e9f02f1ca2c75837f7146b2381(+) = 80bed7bf10aa6c209fe2db0848bd6119.852fa1e9f02f1ca2c75837f7146b2381\n         AND 14b72f98c2aa6561e42572349ab39342.839c4ffb4bfaae1bb58eab4dee67d96a(+) = 80bed7bf10aa6c209fe2db0848bd6119.839c4ffb4bfaae1bb58eab4dee67d96a\n         AND 14b72f98c2aa6561e42572349ab39342.5aeb276d6e88a3ea87ca7a7dd9ffa3a698df5d6b623334f2e9631188cca4cfd6(+) = 80bed7bf10aa6c209fe2db0848bd6119.5aeb276d6e88a3ea87ca7a7dd9ffa3a698df5d6b623334f2e9631188cca4cfd6\n         AND 14b72f98c2aa6561e42572349ab39342.0e5400811a26142f22e82e8c549073a6(+) = 80bed7bf10aa6c209fe2db0848bd6119.0e5400811a26142f22e82e8c549073a6\n         AND 80bed7bf10aa6c209fe2db0848bd6119.839c4ffb4bfaae1bb58eab4dee67d96a = e089adbf06af82e41ef429c19dfbe45d.839c4ffb4bfaae1bb58eab4dee67d96a(+)\n         AND 80bed7bf10aa6c209fe2db0848bd6119.852fa1e9f02f1ca2c75837f7146b2381 = e089adbf06af82e41ef429c19dfbe45d.852fa1e9f02f1ca2c75837f7146b2381(+)\n         AND 80bed7bf10aa6c209fe2db0848bd6119.5aeb276d6e88a3ea87ca7a7dd9ffa3a698df5d6b623334f2e9631188cca4cfd6 = e089adbf06af82e41ef429c19dfbe45d.5aeb276d6e88a3ea87ca7a7dd9ffa3a698df5d6b623334f2e9631188cca4cfd6(+)\n         AND 80bed7bf10aa6c209fe2db0848bd6119.852fa1e9f02f1ca2c75837f7146b2381 = aa1d56f7317d38d67a48f784824e1936.852fa1e9f02f1ca2c75837f7146b2381\n         AND 80bed7bf10aa6c209fe2db0848bd6119.839c4ffb4bfaae1bb58eab4dee67d96a = aa1d56f7317d38d67a48f784824e1936.839c4ffb4bfaae1bb58eab4dee67d96a';\n\n    dbms_output.put_line('SQL for Insert Statement is:  '||  v_sql_str);\n\n    EXECUTE IMMEDIATE v_sql_str;\n    COMMIT;\n\n   \n  DBMS_OUTPUT.PUT_LINE('Start table analyze... ' || systimestamp);\n    v_ret_val    := 8e64339f96bb08058f5d52f1c04f954a.17fcfcb378ff5051796afa7f02d0a322.9058a38aed65e271486900da66f7adf0(v_out_msg, 'XDMADM',v_tbl_to_load);\n    IF v_ret_val != 0 THEN\n      DBMS_OUTPUT.PUT_LINE('Error in analyzing '||v_tbl_to_load||' table');\n      RAISE ALL_EXCEPTIONS;\n    END IF;\n    DBMS_OUTPUT.PUT_LINE('Table '||v_tbl_to_load||' analyzed OK...' || systimestamp);\n\n\nv_prcs_step:='Validating the data...';\n\n   DBMS_OUTPUT.put_line ('Validating the data loaded...');\n\n   v_sql_str:= ' SELECT COUNT (*) '\n        ||' FROM (SELECT SUM (de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.2ee1400a0150f0b220dd7bd6268d1e66) grs_sls_extnd, SUM (de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.ccf8d88f2d37f3171da2121ab22e9330) unfrm_qty_ship FROM de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c s, de459e2fe7f96e4d958537b31b946b26.2c04d82ed0aa1cc9bce2cf2c0548b268 p, '\n        ||' 0e03d5c46556a742ba46252698396ef2.8d75a8f2ab4850b84709184da29f9cdb DIV WHERE 1=1 AND nvl(de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.dd95a4741b2ab36b2428b3c42ef8b0448cd47113485ed05c776655af504ed664,de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.839c4ffb4bfaae1bb58eab4dee67d96a) = 1ef1e03241fd3a9ca5a803b6fd417083.4fdc122fb2d10dd764e32cbc98972eca and 1ef1e03241fd3a9ca5a803b6fd417083.b8c6ab19cb6e726c38f24d1885346ea3 <> ''CC'' and NVL (1ef1e03241fd3a9ca5a803b6fd417083.c712a9ab5ef100c5807fa96123dac48b,''USF'') = ''USF''  AND de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.f5dd4374a3e3af6a775cb6d6b22e8162 BETWEEN '''||v_prd_strt_dt ||''' AND '''|| v_prd_end_dt\n        ||''' AND XFER_TO_DT is null '\n        || 'AND de459e2fe7f96e4d958537b31b946b26.2c04d82ed0aa1cc9bce2cf2c0548b268.8b8c72c349530db846280000957f636d = de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.8b8c72c349530db846280000957f636d\n                      AND de459e2fe7f96e4d958537b31b946b26.2c04d82ed0aa1cc9bce2cf2c0548b268.89f3df82917b692fe64dca942d924e7c NOT IN\n                               (SELECT   param_value_nbr\n                                  FROM   de459e2fe7f96e4d958537b31b946b26.de40ae7be8b2eb3858d46af8d107f3db\n                                 WHERE   app_name =\n                                            ''FN_CUST_MRCH_NTL_AVG_LOAD''\n                                         AND param_type = ''PIM_SUPRCLS_ID'')'\n        ||' MINUS '\n        ||' SELECT SUM (de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.2ee1400a0150f0b220dd7bd6268d1e66) grs_sls_extnd, SUM (de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.ccf8d88f2d37f3171da2121ab22e9330) unfrm_qty_ship FROM '|| v_tbl_owner||'.'||v_tbl_to_load||' s)';\n\n    dbms_output.put_line('SQL for Validation is:  '||  v_sql_str);\n\n    EXECUTE IMMEDIATE v_sql_str INTO v_cnt;\n\n   IF v_cnt <> 0\n   THEN\n      DBMS_OUTPUT.PUT_LINE ('***** Validation failed !! *****');\n      DBMS_OUTPUT.PUT_LINE ('Please validate the data loaded against the data in 0e03d5c46556a742ba46252698396ef2.744733b0938dd8b442c799cb31a8176d table for the Period '|| v_last_fisc_yr_mth);\n      DBMS_OUTPUT.PUT_LINE('Please see below the details: ');\n      SELECT SUM (de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.2ee1400a0150f0b220dd7bd6268d1e66) grs_sls_extnd, SUM (de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.ccf8d88f2d37f3171da2121ab22e9330) unfrm_qty_ship\n      INTO v_grs_sls_extnd, v_unfrm_qty_ship\n      FROM de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c s, de459e2fe7f96e4d958537b31b946b26.2c04d82ed0aa1cc9bce2cf2c0548b268 p, 0e03d5c46556a742ba46252698396ef2.8d75a8f2ab4850b84709184da29f9cdb DIV\n      WHERE 1=1\n                      AND nvl(de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.dd95a4741b2ab36b2428b3c42ef8b0448cd47113485ed05c776655af504ed664,de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.839c4ffb4bfaae1bb58eab4dee67d96a) = 1ef1e03241fd3a9ca5a803b6fd417083.4fdc122fb2d10dd764e32cbc98972eca and 1ef1e03241fd3a9ca5a803b6fd417083.b8c6ab19cb6e726c38f24d1885346ea3 <> 'CC' and NVL (1ef1e03241fd3a9ca5a803b6fd417083.c712a9ab5ef100c5807fa96123dac48b,'USF') = 'USF'\n                      AND de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.f5dd4374a3e3af6a775cb6d6b22e8162 BETWEEN v_prd_strt_dt  AND v_prd_end_dt\n      AND XFER_TO_DT is null\n      AND de459e2fe7f96e4d958537b31b946b26.2c04d82ed0aa1cc9bce2cf2c0548b268.8b8c72c349530db846280000957f636d = de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.8b8c72c349530db846280000957f636d\n                      AND de459e2fe7f96e4d958537b31b946b26.2c04d82ed0aa1cc9bce2cf2c0548b268.89f3df82917b692fe64dca942d924e7c NOT IN\n                               (SELECT   param_value_nbr\n                                  FROM   de459e2fe7f96e4d958537b31b946b26.de40ae7be8b2eb3858d46af8d107f3db\n                                 WHERE   app_name = 'FN_CUST_MRCH_NTL_AVG_LOAD'\n                                         AND param_type = 'PIM_SUPRCLS_ID');\n\n       dbms_output.put_line('Table 0e03d5c46556a742ba46252698396ef2.6c9764319bbe350c2e23a29fd4e717b9');\n      dbms_output.put_line('GRS_SLS_EXTND: '||v_grs_sls_extnd||'  UNFRM_QTY_SHIP: '||v_unfrm_qty_ship);\n\n      EXECUTE IMMEDIATE ' SELECT SUM (grs_sls_extnd) grs_sls_extnd, SUM (unfrm_qty_ship) unfrm_qty_ship FROM '||v_tbl_to_load\n        INTO   v_grs_sls_extnd, v_unfrm_qty_ship;\n       dbms_output.put_line('Table '||v_tbl_to_load);\n      dbms_output.put_line('GRS_SLS_EXTND: '||v_grs_sls_extnd||'  UNFRM_QTY_SHIP: '||v_unfrm_qty_ship);\n\n      RETURN 1;\n   END IF;\n\n   DBMS_OUTPUT.put_line ('Data validated successfully.');\n\n   DBMS_OUTPUT.PUT_LINE ('Calling 0e03d5c46556a742ba46252698396ef2.60ac4f2269d203f666e8df2b3b5485d6 function to recreate the synonym to point to the newly built table '|| v_tbl_to_load);\n   \n   v_ret_val :=\n      0e03d5c46556a742ba46252698396ef2.60ac4f2269d203f666e8df2b3b5485d6 (v_syn_nm, 'XDMADM', v_tbl_to_load);\n\n   IF v_ret_val <> 0\n   THEN\n      DBMS_OUTPUT.PUT_LINE ('Error in calling 0e03d5c46556a742ba46252698396ef2.60ac4f2269d203f666e8df2b3b5485d6 function');\n      RETURN 1;\n   END IF;\n\n   \n   DBMS_OUTPUT.PUT_LINE ('Updating SYN_TBL_MAP table to mark the newly built table as active and mark the other table as inactive');\n\n   \n   UPDATE 9751bbbcfea690cc0be4d58830a6fe2e.56ac3befbcbada23fa9268d8fe6d5242\n      SET actv_ind = 'N',\n      last_updt=sysdate\n    WHERE synonym_nm = v_syn_nm AND actv_ind = 'Y';\n\n   \n   UPDATE 9751bbbcfea690cc0be4d58830a6fe2e.56ac3befbcbada23fa9268d8fe6d5242\n      SET actv_ind = 'Y',\n      last_updt=sysdate\n    WHERE tbl_nm = v_tbl_to_load;\n\n   COMMIT;\n\n   \n\n   SELECT tbl_nm\n     INTO v_tbl_inactv\n     FROM 9751bbbcfea690cc0be4d58830a6fe2e.56ac3befbcbada23fa9268d8fe6d5242\n    WHERE synonym_nm = v_syn_nm AND actv_ind = 'N';\n\n\n\n\n    DBMS_OUTPUT.put_line ('Truncating the inactive table ' || v_tbl_inactv);\n    v_prcs_step := 'Truncating '||v_tbl_inactv ||' Table';\n    v_trunc_ret := 7540495dc7d95c8483c39c98db3db89c.72d996f41712e622935d17bc9cb23cfa.bf64c6f363cecdf8179ad64aad199c7e(v_out_msg, 'XDMADM',v_tbl_inactv);\n    DBMS_OUTPUT.PUT_LINE(v_out_msg);\n    IF v_trunc_ret != 0 THEN\n        DBMS_OUTPUT.PUT_LINE('Error in Truncating '||v_tbl_inactv||' table');\n        RAISE ALL_EXCEPTIONS;\n    END IF;\n\n\n    \n    v_prcs_step:= 'Updating fact_load_stat table';\n\n    DBMS_OUTPUT.PUT_LINE ('Updating de459e2fe7f96e4d958537b31b946b26.0b3320d3f985cd20d1ec65d9dfeed2de table ...');\n\n    UPDATE  de459e2fe7f96e4d958537b31b946b26.0b3320d3f985cd20d1ec65d9dfeed2de\n    SET latest_prcs_dt =v_prd_end_dt,\n    div_load_stat = 1,\n    div_load_ts = sysdate,\n    prcs_dt = v_odate\n    WHERE fact_table ='SALES_SUMM_CUST_MRCH' ;\n    COMMIT;\n\n   RETURN 0;\nEXCEPTION\n      WHEN ALL_EXCEPTIONS\n      THEN\n         ROLLBACK;\n         DBMS_OUTPUT.put_line ('error raised at step:');\n         DBMS_OUTPUT.put_line ('******'||v_prcs_step);\n         RETURN 1;\n      WHEN OTHERS\n      THEN\n          ROLLBACK;\n         DBMS_OUTPUT.put_line ('ERROR:' || SQLCODE || ',' || SQLERRM);\n         DBMS_OUTPUT.PUT_LINE(       v_prcs_nm\n                            ||' - '||v_prcs_step\n                            ||' - '||v_prcs_pram);\n         RETURN 2;\nEND FN_SALES_SUMM_CUST_MRCH_LOAD;\n/",
            "upstream_dependencies": [],
            "downstream_dependencies": [],
            "dag_location": "null",
            "gantt_location": "null",
            "created_at": "null",
            "updated_at": "null"
        },
        {
            "name": "FN_CUST_AVG_PNTRTN_RATE_LOAD",
            "encrypted_name": "6de3baca193cc9bf0be1a67a62475191947d06e5e267e8ca75830a056730fd45",
            "type": "function",
            "database": "null",
            "encrypted_database": "null",
            "schema": "XDMADM",
            "encrypted_schema": "0e03d5c46556a742ba46252698396ef2",
            "fully_qualified_name": "XDMADM.FN_CUST_AVG_PNTRTN_RATE_LOAD",
            "encrypted_fqn": "0e03d5c46556a742ba46252698396ef2.6de3baca193cc9bf0be1a67a62475191947d06e5e267e8ca75830a056730fd45",
            "synonyms": [],
            "metadata_analysis": "CREATE OR REPLACE FUNCTION \"0e03d5c46556a742ba46252698396ef2\".\"6de3baca193cc9bf0be1a67a62475191947d06e5e267e8ca75830a056730fd45\" (ODATE IN VARCHAR2)\n   RETURN NUMBER IS\n \n\n   l_fn_start                       DATE;\n   v_cust_corp_cnt                  NUMBER := 0;\n   v_cust_avg_pntrtn_rate_cnt       NUMBER := 0;\n   l_load_tbl_cnt                   NUMBER := 0;\n   l_return_code                    NUMBER := 0;\n   l_object_nm                      VARCHAR2(30);\n   l_out_msg                        VARCHAR2(256);\n   v_out_msg                        VARCHAR2(256);\n   l_load_tbl_nm                    VARCHAR2(30);\n\n   c_success                 CONSTANT NUMBER := 0;\n   c_error                   CONSTANT NUMBER := 1;\n   c_schema                  CONSTANT VARCHAR2(30) := 'XDMADM';\n   c_aggr_tbl_syn_nm         CONSTANT VARCHAR2(30) := 'CUST_AVG_PNTRTN_RATE';\n   c_aggr_load_syn_nm        CONSTANT VARCHAR2(30) := 'CUST_AVG_PNTRTN_RATE_LOAD';\n\n   v_prd_strt_dt               DATE;\n   v_prd_end_dt                DATE;\n   v_param_value               NUMBER;\n   v_fisc_yr_mth               VARCHAR2 (8 Byte);\n   v_12_mth_ago                VARCHAR2 (8 Byte);\n   v_odate                     DATE := TO_DATE (odate, 'YYYYMMDD');\n   p_param_type                VARCHAR2(32767);\n\n   all_exceptions exception; \n   e_truncate_table exception;\n   e_analyze_table exception;\n   e_syn exception;\n   e_swap_table exception;\n\nBEGIN\n\n select max(clndr_dt) INTO v_prd_end_dt from de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001 where fisc_yr_mth in (\n    SELECT MAX (de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.2603c45be643e5cd8f9c6dad3bee6cb3)\n      FROM de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001 a\n     WHERE de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.2603c45be643e5cd8f9c6dad3bee6cb3 < (SELECT de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.2603c45be643e5cd8f9c6dad3bee6cb3\n                              FROM de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001 a\n                             WHERE de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.222ccb1d1746bcdb2365f29b3da0b613 = TRUNC (v_odate)));\n\n  DBMS_OUTPUT.put_line('End Date: '||v_prd_end_dt);\n\n   select min(clndr_dt)\n   into  v_prd_strt_dt\n     from de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001\n    where fisc_yr_mth in\n              (select  fisc_yr_mth - 100 as \"12_Mth_Ago\"\n                 from   de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001\n                 where  clndr_dt = trunc(v_odate));\n\n DBMS_OUTPUT.put_line('Start Date: '||v_prd_strt_dt);\n\n   SELECT   param_value_nbr\n   INTO   v_param_value\n   FROM   de459e2fe7f96e4d958537b31b946b26.de40ae7be8b2eb3858d46af8d107f3db\n WHERE   app_name = 'SALES_COVERAGE_MMA'\n     AND param_type ='DEFAULT_PNTRTN_RATE';\n\n  SELECT param_type\n  INTO   p_param_type\n  FROM de459e2fe7f96e4d958537b31b946b26.de40ae7be8b2eb3858d46af8d107f3db\n  WHERE APP_NAME = 'ALL' and param_code like 'CUST_AVG_PNTRTN_RATE';\n\n\n\n   EXECUTE IMMEDIATE 'SELECT table_name FROM user_synonyms WHERE synonym_name = ''' || c_aggr_load_syn_nm || ''''\n      INTO l_load_tbl_nm;\n\n\n\n   IF (c_aggr_tbl_syn_nm = l_load_tbl_nm) THEN\n      RAISE e_syn;\n   END IF;\n\n      \n   EXECUTE IMMEDIATE 'SELECT count(1) FROM ' || l_load_tbl_nm INTO l_load_tbl_cnt;\n\n   IF (l_load_tbl_cnt > 0) THEN\n      DBMS_OUTPUT.put_line('Load aggregate table has ' || l_load_tbl_nm || ' records in it');\n\n      l_return_code   := 8e64339f96bb08058f5d52f1c04f954a.8ffe4678890c39c7d4ed38c2ed759e24.e4b5db2b3f9b19accbb8cddbfcd05bac(l_out_msg, c_schema, l_load_tbl_nm);\n\n      DBMS_OUTPUT.put_line('Truncate table Return: ' || l_return_code || ' - ' || l_out_msg);\n\n      IF (l_return_code <> 0) THEN\n         l_object_nm   := l_load_tbl_nm;\n         RAISE e_truncate_table;\n      END IF;\n\n      DBMS_OUTPUT.put_line('Load aggregate table ' || l_load_tbl_nm ||' truncated');\n\n   END IF;\n\n   \n\n   \n\n    l_fn_start       := SYSDATE;\n\n\nINSERT INTO de459e2fe7f96e4d958537b31b946b26.d26d0e860281f1968d53c43aaaab9ae5579443cba7af295cfd012416ced4395d (MENU_TYP_CD,\n                                              GRS_SLS_EXTND,\n                                              MP_FOOD_BVRG_DSPSBL_PRCH,\n                                              AVG_PNTRTN_RATE)\n   WITH chd_ptnl\n          AS (SELECT   d2450100e2dda59c2b7828b4daff7f8c.0e5400811a26142f22e82e8c549073a6,\n                       d2450100e2dda59c2b7828b4daff7f8c.852fa1e9f02f1ca2c75837f7146b2381,\n                       d2450100e2dda59c2b7828b4daff7f8c.839c4ffb4bfaae1bb58eab4dee67d96a,\n                       mp_food_bvrg_dspsbl_prch\n                FROM   de459e2fe7f96e4d958537b31b946b26.e869ae975d524d2ee7be81b5d832da80 c, de459e2fe7f96e4d958537b31b946b26.24b4bc4c4cf4a9bc5d0f1ed790d1bd64fe1273d196c209677ff154534715415c m\n               WHERE       d2450100e2dda59c2b7828b4daff7f8c.852fa1e9f02f1ca2c75837f7146b2381 = 98df5d6b623334f2e9631188cca4cfd6.852fa1e9f02f1ca2c75837f7146b2381\n                       AND d2450100e2dda59c2b7828b4daff7f8c.839c4ffb4bfaae1bb58eab4dee67d96a = 98df5d6b623334f2e9631188cca4cfd6.839c4ffb4bfaae1bb58eab4dee67d96a\n                       AND 98df5d6b623334f2e9631188cca4cfd6.9cd2aa2a4161fda471ecbb591b3bd2f5fff9944709e8751521a61766c272dd58 > 0\n                       AND 98df5d6b623334f2e9631188cca4cfd6.17a7541ba0af7b39947d91f68f8cf748 = 'Y'\n                       AND d2450100e2dda59c2b7828b4daff7f8c.e33988f12139bfc93f1e7557137feb5a29e110ac67769beb8c9647cf15a66d38 = 'L'),\n       sales\n          AS (  SELECT   3ae8b0e557ecaae7dffe84081feddec7.839c4ffb4bfaae1bb58eab4dee67d96a,\n                         3ae8b0e557ecaae7dffe84081feddec7.852fa1e9f02f1ca2c75837f7146b2381,\n                         SUM (de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.2ee1400a0150f0b220dd7bd6268d1e66) grs_sls_extnd\n                  FROM   chd_ptnl m, de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c s, de459e2fe7f96e4d958537b31b946b26.8d75a8f2ab4850b84709184da29f9cdb div\n                 WHERE       3ae8b0e557ecaae7dffe84081feddec7.852fa1e9f02f1ca2c75837f7146b2381 = de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.852fa1e9f02f1ca2c75837f7146b2381\n                         AND 3ae8b0e557ecaae7dffe84081feddec7.839c4ffb4bfaae1bb58eab4dee67d96a = de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.839c4ffb4bfaae1bb58eab4dee67d96a\n                         AND de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.f5dd4374a3e3af6a775cb6d6b22e8162 BETWEEN v_prd_strt_dt AND v_prd_end_dt\n                         AND de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.467a168a7499c57b1859198a7dac7be0 IS NULL\n                         AND NVL (de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.a2b201123c685e8cc48b5468cb4a449361bbd7bc0d2d67c7d7b11cb0a8d18d03, de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.839c4ffb4bfaae1bb58eab4dee67d96a) =\n                               de459e2fe7f96e4d958537b31b946b26.8d75a8f2ab4850b84709184da29f9cdb.839c4ffb4bfaae1bb58eab4dee67d96a\n                         AND de459e2fe7f96e4d958537b31b946b26.8d75a8f2ab4850b84709184da29f9cdb.b8c6ab19cb6e726c38f24d1885346ea3 <> 'CC' \n                         AND NVL (de459e2fe7f96e4d958537b31b946b26.8d75a8f2ab4850b84709184da29f9cdb.c712a9ab5ef100c5807fa96123dac48b, 'USF') = 'USF'\n              GROUP BY   3ae8b0e557ecaae7dffe84081feddec7.839c4ffb4bfaae1bb58eab4dee67d96a, 3ae8b0e557ecaae7dffe84081feddec7.852fa1e9f02f1ca2c75837f7146b2381)\n   SELECT\n            menu_typ_cd,\n            grs_sls_extnd,\n            MP_FOOD_BVRG_DSPSBL_PRCH,\n            CASE WHEN AVG_PNTRT_RATE > 1 THEN 1 ELSE AVG_PNTRT_RATE END AS AVG_PNTRT_RATE\n     FROM   (  SELECT\n                        3ae8b0e557ecaae7dffe84081feddec7.0e5400811a26142f22e82e8c549073a6,\n                        SUM (80bed7bf10aa6c209fe2db0848bd6119.2ee1400a0150f0b220dd7bd6268d1e66) GRS_SLS_EXTND,\n                        SUM (3ae8b0e557ecaae7dffe84081feddec7.c67e714c50092871e215f33a602c124d339d6512d0af0b6fe1f57edcdf48f234) AS MP_FOOD_BVRG_DSPSBL_PRCH,\n                        NVL (SUM (80bed7bf10aa6c209fe2db0848bd6119.2ee1400a0150f0b220dd7bd6268d1e66) / SUM (3ae8b0e557ecaae7dffe84081feddec7.c67e714c50092871e215f33a602c124d339d6512d0af0b6fe1f57edcdf48f234), v_param_value )\n                           AS AVG_PNTRT_RATE\n                 FROM   sales p, chd_ptnl c\n                WHERE       80bed7bf10aa6c209fe2db0848bd6119.852fa1e9f02f1ca2c75837f7146b2381 = 3ae8b0e557ecaae7dffe84081feddec7.852fa1e9f02f1ca2c75837f7146b2381\n                        AND 80bed7bf10aa6c209fe2db0848bd6119.839c4ffb4bfaae1bb58eab4dee67d96a = 3ae8b0e557ecaae7dffe84081feddec7.839c4ffb4bfaae1bb58eab4dee67d96a\n                        AND 80bed7bf10aa6c209fe2db0848bd6119.2ee1400a0150f0b220dd7bd6268d1e66 > 0\n             GROUP BY   3ae8b0e557ecaae7dffe84081feddec7.0e5400811a26142f22e82e8c549073a6);\n\n      DBMS_OUTPUT.put_line(\n         'Inserted ' || sql%ROWCOUNT || ' rows in ' || TO_CHAR(ROUND((SYSDATE - l_fn_start) * 86400)) || ' seconds');\n\n      COMMIT;\n\n  \n\n   DBMS_OUTPUT.put_line('Analyze the Load aggregate table ' || l_load_tbl_nm);\n   l_return_code    := de459e2fe7f96e4d958537b31b946b26.9b3711c37bca8fd1d7c76527508615f9(c_schema, l_load_tbl_nm);\n\n   IF (l_return_code <> 0) THEN\n      l_object_nm   := l_load_tbl_nm;\n      RAISE e_analyze_table;\n   END IF;\n\n \n\n\n    SELECT count(1) INTO v_cust_avg_pntrtn_rate_cnt FROM de459e2fe7f96e4d958537b31b946b26.d26d0e860281f1968d53c43aaaab9ae5579443cba7af295cfd012416ced4395d ;\n\n    DBMS_OUTPUT.put_line(v_cust_avg_pntrtn_rate_cnt || ' ' || 'Rows Inserted into CUST_AVG_PNTRTN_RATE_LOAD');\n\n    DBMS_OUTPUT.put_line('Validate the Load aggregate table has records');\n\n   IF  v_cust_avg_pntrtn_rate_cnt > 0 THEN\n\n   l_return_code    := 0e03d5c46556a742ba46252698396ef2.b0c7b228cc9d5cd4595cb075b166be06 ( P_PARAM_TYPE, v_odate );\n\n   IF (l_return_code <> 0) THEN\n       l_object_nm   := l_load_tbl_nm;\n      RAISE e_swap_table;\n   ELSE\n       DBMS_OUTPUT.put_line('The Load aggregate table SYN swap is completed');\n   END IF;\n\n  ELSE\n  DBMS_OUTPUT.put_line('The Load aggregate table has no records and the SYN swap will not be performed');\n\n  END IF;\n\n\nRETURN 0;\n  \nEXCEPTION\n   WHEN e_syn THEN\n      DBMS_OUTPUT.put_line(\n         'Synonym currently points to Load table: ' || c_aggr_load_syn_nm || '. Requires manual update.');\n      DBMS_OUTPUT.put_line('Verify the ' ||c_aggr_load_syn_nm|| ' and ' ||c_aggr_load_syn_nm|| ' synonyms');\n      RETURN 6726798abbc757d8442516fefb8c40e9.de3afdf274dc4a6f320906a012ba2f12;\n   WHEN e_truncate_table THEN\n      DBMS_OUTPUT.put_line('Error Truncating Table: ' || l_load_tbl_nm || '. Requires manual update.');\n      DBMS_OUTPUT.put_line('Verify '||l_load_tbl_nm||' table has any records');\n      DBMS_OUTPUT.put_line(l_out_msg);\n      RETURN 6726798abbc757d8442516fefb8c40e9.de3afdf274dc4a6f320906a012ba2f12;\n   WHEN e_analyze_table THEN\n      DBMS_OUTPUT.put_line('Error Analyzing Table: ' || l_load_tbl_nm || '. Requires manual update.');\n      DBMS_OUTPUT.put_line(l_out_msg);\n      RETURN 6726798abbc757d8442516fefb8c40e9.de3afdf274dc4a6f320906a012ba2f12;\n   WHEN e_swap_table THEN\n      DBMS_OUTPUT.put_line('Synonym swap has failed');\n      DBMS_OUTPUT.put_line(l_out_msg);\n      RETURN 6726798abbc757d8442516fefb8c40e9.de3afdf274dc4a6f320906a012ba2f12;\n   WHEN OTHERS THEN\n      DBMS_OUTPUT.put_line('Error in 0e03d5c46556a742ba46252698396ef2.76ef0a5cbe62e4f1df11d5eb944c384f96f5f8bbe91455e6ec4dd10afd45832e:' || SQLCODE || ' ' || SQLERRM);\n      RETURN 1;\nEND;\n/",
            "upstream_dependencies": [],
            "downstream_dependencies": [],
            "dag_location": "null",
            "gantt_location": "null",
            "created_at": "null",
            "updated_at": "null"
        },
        {
            "name": "FN_AOP_TYPE_CORP_VPD",
            "encrypted_name": "870a7b94217c94919950e9e3c20b86556f3bf1564d2f7da4e41552c0a7d78051",
            "type": "function",
            "database": "null",
            "encrypted_database": "null",
            "schema": "XDMADM",
            "encrypted_schema": "0e03d5c46556a742ba46252698396ef2",
            "fully_qualified_name": "XDMADM.FN_AOP_TYPE_CORP_VPD",
            "encrypted_fqn": "0e03d5c46556a742ba46252698396ef2.870a7b94217c94919950e9e3c20b86556f3bf1564d2f7da4e41552c0a7d78051",
            "synonyms": [],
            "metadata_analysis": "CREATE OR REPLACE FUNCTION \"0e03d5c46556a742ba46252698396ef2\".\"870a7b94217c94919950e9e3c20b86556f3bf1564d2f7da4e41552c0a7d78051\" (p_schema       IN VARCHAR2,\n                                                  p_objname      IN VARCHAR2)\n   RETURN VARCHAR2 AS\n   \n   c_start                CONSTANT NUMBER := DBMS_UTILITY.get_time;\n   c_fn_nm                CONSTANT VARCHAR2(30) := 'FN_AOP_TYPE_CORP_VPD';\n   l_security_predicate   VARCHAR2(4000) DEFAULT NULL;\n   l_cur_sql              VARCHAR2(4000) := SYS_CONTEXT('USERENV', 'CURRENT_SQL');\n   l_sbjct_area           VARCHAR2(100) := SYS_CONTEXT(9751bbbcfea690cc0be4d58830a6fe2e.9bfb5eb7793dc8fa6800d5a61e5e3e4e1e2f6ec194927f064ce6cb31fba71a32.f4a54ebc6f2c591ed4266aafe66971af, 9751bbbcfea690cc0be4d58830a6fe2e.9bfb5eb7793dc8fa6800d5a61e5e3e4e1e2f6ec194927f064ce6cb31fba71a32.3b1288ed835b1b524e9500bb13544956e6e6300089dae5a98e31814d0406060f);\n   l_vpd_exempt           VARCHAR2(1) := SYS_CONTEXT(9751bbbcfea690cc0be4d58830a6fe2e.9bfb5eb7793dc8fa6800d5a61e5e3e4e1e2f6ec194927f064ce6cb31fba71a32.f4a54ebc6f2c591ed4266aafe66971af, 9751bbbcfea690cc0be4d58830a6fe2e.9bfb5eb7793dc8fa6800d5a61e5e3e4e1e2f6ec194927f064ce6cb31fba71a32.0eaf613ab52a53601d1496b5650de81e);\nBEGIN\n   \n   IF l_sbjct_area IS NULL THEN\n      l_security_predicate   := '1=2';\n      9751bbbcfea690cc0be4d58830a6fe2e.d4abe88ed2062b430c927bc84d61faf1f9a7aadf5998d448c2e2d1b0b47a3056.7d64937276682b23a0e16e5c61dad7aa('NO SA',\n                                          c_fn_nm,\n                                          USER,\n                                          p_schema,\n                                          p_objname,\n                                          l_sbjct_area,\n                                          l_vpd_exempt,\n                                          NULL,\n                                          l_cur_sql,\n                                          l_security_predicate,\n                                          (DBMS_UTILITY.get_time - c_start) / 100);\n\n      RETURN l_security_predicate;\n   END IF;\n\n   \n   \n   IF l_vpd_exempt = 'Y' THEN\n      l_security_predicate   := '1=1';\n      9751bbbcfea690cc0be4d58830a6fe2e.d4abe88ed2062b430c927bc84d61faf1f9a7aadf5998d448c2e2d1b0b47a3056.7d64937276682b23a0e16e5c61dad7aa('EXEMPT',\n                                          c_fn_nm,\n                                          USER,\n                                          p_schema,\n                                          p_objname,\n                                          l_sbjct_area,\n                                          l_vpd_exempt,\n                                          NULL,\n                                          l_cur_sql,\n                                          l_security_predicate,\n                                          (DBMS_UTILITY.get_time - c_start) / 100);\n\n      RETURN l_security_predicate;\n   END IF;\n\n   l_security_predicate   := 'AOP_TYPE = ''CORP''';\n   9751bbbcfea690cc0be4d58830a6fe2e.d4abe88ed2062b430c927bc84d61faf1f9a7aadf5998d448c2e2d1b0b47a3056.7d64937276682b23a0e16e5c61dad7aa('CORP AOP',\n                                       c_fn_nm,\n                                       USER,\n                                       p_schema,\n                                       p_objname,\n                                       l_sbjct_area,\n                                       l_vpd_exempt,\n                                       NULL,\n                                       l_cur_sql,\n                                       l_security_predicate,\n                                       (DBMS_UTILITY.get_time - c_start) / 100);\n\n   RETURN l_security_predicate;\nEXCEPTION\n   WHEN OTHERS THEN\n      l_security_predicate   := '1=3';\n      9751bbbcfea690cc0be4d58830a6fe2e.d4abe88ed2062b430c927bc84d61faf1f9a7aadf5998d448c2e2d1b0b47a3056.7d64937276682b23a0e16e5c61dad7aa(SQLCODE || '-' || SQLERRM,\n                                          c_fn_nm,\n                                          USER,\n                                          p_schema,\n                                          p_objname,\n                                          l_sbjct_area,\n                                          l_vpd_exempt,\n                                          NULL,\n                                          l_cur_sql,\n                                          l_security_predicate,\n                                          (DBMS_UTILITY.get_time - c_start) / 100);\n\n      RETURN l_security_predicate;\nEND FN_AOP_TYPE_CORP_VPD;\n/",
            "upstream_dependencies": [],
            "downstream_dependencies": [],
            "dag_location": "null",
            "gantt_location": "null",
            "created_at": "null",
            "updated_at": "null"
        },
        {
            "name": "FN_GET_FISC_TIME",
            "encrypted_name": "f4e695c1cd078a60bfb5f5d30ce0d271e32f6dd38f333cde68119d1f277367cd",
            "type": "function",
            "database": "null",
            "encrypted_database": "null",
            "schema": "XDMADM",
            "encrypted_schema": "0e03d5c46556a742ba46252698396ef2",
            "fully_qualified_name": "XDMADM.FN_GET_FISC_TIME",
            "encrypted_fqn": "0e03d5c46556a742ba46252698396ef2.f4e695c1cd078a60bfb5f5d30ce0d271e32f6dd38f333cde68119d1f277367cd",
            "synonyms": [],
            "metadata_analysis": "CREATE OR REPLACE FUNCTION \"0e03d5c46556a742ba46252698396ef2\".\"f4e695c1cd078a60bfb5f5d30ce0d271e32f6dd38f333cde68119d1f277367cd\" (p_clndr_dt     IN DATE,\n                          p_timeframe    IN VARCHAR2,\n                          p_remove_prev_on_last_day IN VARCHAR2 DEFAULT 'N')\n   RETURN VARCHAR2\n   DETERMINISTIC IS\n   l_fisc_yr_wk            VARCHAR2(6 BYTE);\n   l_fisc_yr_mth           VARCHAR2(6 BYTE);\n   l_fisc_yr               VARCHAR2(4 BYTE);\n   l_prev_fisc_yr_wk       VARCHAR2(6 BYTE);\n   l_prev_fisc_wk_yr_mth   VARCHAR2(6 BYTE);\n   l_prev_fisc_yr_mth      VARCHAR2(6 BYTE);\n   l_prev_fisc_yr          VARCHAR2(4 BYTE);\n   l_last_dt_mth           DATE;\n   l_timeframe             VARCHAR2(30) := p_timeframe;\nBEGIN\n  \n   IF (p_remove_prev_on_last_day = 'Y')\n  AND (TO_CHAR(p_clndr_dt, 'D') = 7)\n  AND (l_timeframe IN ('PREV_WK', 'PREV_YR_WK')) THEN\n      l_timeframe   := 'YR_WK';\n   END IF;\n\n  \n   IF (p_remove_prev_on_last_day = 'Y')\n  AND (l_timeframe IN ('PREV_MTH', 'PREV_YR_MTH')) THEN\n      SELECT MAX(clndr_dt)\n        INTO l_last_dt_mth\n        FROM de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001\n       WHERE fisc_yr_mth = (SELECT fisc_yr_mth\n                              FROM de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001\n                             WHERE clndr_dt = p_clndr_dt);\n\n      IF (p_clndr_dt = l_last_dt_mth) THEN\n         l_timeframe   := 'YR_MTH';\n      END IF;\n   END IF;\n\n   IF (l_timeframe LIKE 'PREV%') THEN\n      SELECT fisc_yr_wkago, DECODE(fisc_mth_of_yr, 1, (fisc_yr - 1) || '12', fisc_yr || fisc_mth_of_yr - 1), fisc_yr - 1\n        INTO l_prev_fisc_yr_wk, l_prev_fisc_yr_mth, l_prev_fisc_yr\n        FROM wkly_time_corp\n       WHERE p_clndr_dt BETWEEN clndr_wk_strt_dt AND clndr_wk_end_dt;\n\n      IF l_timeframe = 'PREV_WK_YR_MTH' THEN\n         SELECT fisc_yr_mth\n           INTO l_prev_fisc_wk_yr_mth\n           FROM wkly_time_corp\n          WHERE fisc_yr_wk = l_prev_fisc_yr_wk;\n\n         RETURN l_prev_fisc_wk_yr_mth;\n      ELSIF l_timeframe IN ('PREV_WK', 'PREV_YR_WK') THEN\n         RETURN l_prev_fisc_yr_wk;\n      ELSIF l_timeframe IN ('PREV_MTH', 'PREV_YR_MTH') THEN\n         RETURN l_prev_fisc_yr_mth;\n      ELSIF l_timeframe = 'PREV_YR' THEN\n         RETURN l_prev_fisc_yr;\n      END IF;\n   ELSE\n      SELECT fisc_yr_wk, fisc_yr_mth, fisc_yr\n        INTO l_fisc_yr_wk, l_fisc_yr_mth, l_fisc_yr\n        FROM time_corp\n       WHERE TRUNC(clndr_dt) = TRUNC(p_clndr_dt);\n\n      IF l_timeframe IN ('WK', 'YR_WK') THEN\n         RETURN l_fisc_yr_wk;\n      ELSIF l_timeframe IN ('MTH', 'YR_MTH') THEN\n         RETURN l_fisc_yr_mth;\n      ELSIF l_timeframe = 'YR' THEN\n         RETURN l_fisc_yr;\n      END IF;\n   END IF;\nEND fn_get_fisc_time;\n/",
            "upstream_dependencies": [],
            "downstream_dependencies": [],
            "dag_location": "null",
            "gantt_location": "null",
            "created_at": "null",
            "updated_at": "null"
        },
        {
            "name": "FN_CUST_CORP_AGGR_LOAD",
            "encrypted_name": "9815a06262a394064c428e37cc22329b1f117328deac51b12eb944fb47e5fb71",
            "type": "function",
            "database": "null",
            "encrypted_database": "null",
            "schema": "XDMADM",
            "encrypted_schema": "0e03d5c46556a742ba46252698396ef2",
            "fully_qualified_name": "XDMADM.FN_CUST_CORP_AGGR_LOAD",
            "encrypted_fqn": "0e03d5c46556a742ba46252698396ef2.9815a06262a394064c428e37cc22329b1f117328deac51b12eb944fb47e5fb71",
            "synonyms": [],
            "metadata_analysis": "CREATE OR REPLACE FUNCTION \"0e03d5c46556a742ba46252698396ef2\".\"9815a06262a394064c428e37cc22329b1f117328deac51b12eb944fb47e5fb71\"\n   RETURN NUMBER IS\n   \n   v_out_msg                VARCHAR2(256);\n   v_table_owner            VARCHAR2(40) := 'XDMADM'; \n   v_table_name             VARCHAR2(40) := 'CUST_CORP_AGGR'; \n   v_truncate_tbl           NUMBER(3);\n   v_prcs_stp               VARCHAR(100);\n   cust_corp_aggr_tbl_cnt   NUMBER := 0;\n\n   all_exceptions exception; \nBEGIN\n   DBMS_OUTPUT.put_line('Truncating/Deleting records from CUST_CORP_AGGR');\n   v_truncate_tbl   := 8e64339f96bb08058f5d52f1c04f954a.8ffe4678890c39c7d4ed38c2ed759e24.e4b5db2b3f9b19accbb8cddbfcd05bac(v_out_msg, v_table_owner, v_table_name);\n   DBMS_OUTPUT.put_line(v_out_msg);\n\n   IF v_truncate_tbl != 0 THEN\n      DBMS_OUTPUT.put_line('Error in Truncating the ' || v_table_name || ' table');\n      RAISE all_exceptions;\n   END IF;\n\n   DBMS_OUTPUT.put_line('0e03d5c46556a742ba46252698396ef2.03c36c79dd9f9f8e3d257559c81f79d9 table truncated successfully');\n\n   DBMS_OUTPUT.put_line('Inserting Rows into CUST_CORP_AGGR');\n\n   INSERT INTO cust_corp_aggr(acct_typ_cd, acct_typ_desc, corp_mlt_unit_nbr, corp_mlt_unit_desc, trd_cls, trd_cls_desc, prnt_mlt_unit_cd, prnt_mlt_unit_desc)\n      SELECT DISTINCT NVL(de459e2fe7f96e4d958537b31b946b26.52982d3bbc1ebc2720d9504c7ea2ed3f.909573c485e39cfe1c127c1a279986fd, '-9') acct_typ_cd, de459e2fe7f96e4d958537b31b946b26.52982d3bbc1ebc2720d9504c7ea2ed3f.292d6af66d8c2559591277fc89608331,\n                      NVL(de459e2fe7f96e4d958537b31b946b26.52982d3bbc1ebc2720d9504c7ea2ed3f.5112ab47fb19df73f8ed2678ddc0ecdbe6e6300089dae5a98e31814d0406060f, '-99') corp_mlt_unit_nbr, 426e7c539e50a4c198de5fda55bbcc7b.3377a56ac3a8caf2bec5d2e95319521415ebda0b6e5cc8d4c919a8c71a9d07e4,\n                      NVL(de459e2fe7f96e4d958537b31b946b26.52982d3bbc1ebc2720d9504c7ea2ed3f.dd6238100904f569270d672fe0643a5a, 'U') trd_cls, CASE de459e2fe7f96e4d958537b31b946b26.52982d3bbc1ebc2720d9504c7ea2ed3f.dd6238100904f569270d672fe0643a5a\n                                                      WHEN '1' THEN 'Trade'\n                                                      WHEN '2' THEN 'Vendor'\n                                                      WHEN '3' THEN 'Employee'\n                                                      WHEN '4' THEN 'Other Non Trade'\n                                                      WHEN 'U' THEN 'UNKNOWN'\n                                                      ELSE 'UNKNOWN'\n                                                   END\n                                                      AS trd_cls_desc, NVL(de459e2fe7f96e4d958537b31b946b26.52982d3bbc1ebc2720d9504c7ea2ed3f.5b166c5fe66db413f1e228635901a096e32f6dd38f333cde68119d1f277367cd, '-99') prnt_mlt_unit_cd,\n                      f3adb4eedb21b24e381d9e9f805f1e27e472b097974b0d6a9a7d2ed170324906.9033b904a17dc722bf77fb076a267f1515ebda0b6e5cc8d4c919a8c71a9d07e4\n        FROM de459e2fe7f96e4d958537b31b946b26.52982d3bbc1ebc2720d9504c7ea2ed3f a, corp_mu_map cm, prnt_mlt_unit_map pm\n       WHERE de459e2fe7f96e4d958537b31b946b26.52982d3bbc1ebc2720d9504c7ea2ed3f.5112ab47fb19df73f8ed2678ddc0ecdbe6e6300089dae5a98e31814d0406060f = 426e7c539e50a4c198de5fda55bbcc7b.5112ab47fb19df73f8ed2678ddc0ecdbe6e6300089dae5a98e31814d0406060f(+)\n         AND de459e2fe7f96e4d958537b31b946b26.52982d3bbc1ebc2720d9504c7ea2ed3f.5b166c5fe66db413f1e228635901a096e32f6dd38f333cde68119d1f277367cd = f3adb4eedb21b24e381d9e9f805f1e27e472b097974b0d6a9a7d2ed170324906.5b166c5fe66db413f1e228635901a096e32f6dd38f333cde68119d1f277367cd(+);\n\n   SELECT COUNT(1) INTO cust_corp_aggr_tbl_cnt FROM cust_corp_aggr;\n\n   DBMS_OUTPUT.put_line(cust_corp_aggr_tbl_cnt || ' ' || 'Rows Inserted into CUST_CORP_AGGR');\n\n   COMMIT;\n   RETURN 0;\nEXCEPTION\n   WHEN OTHERS THEN\n      DBMS_OUTPUT.put_line('Error in 0e03d5c46556a742ba46252698396ef2.03c36c79dd9f9f8e3d257559c81f79d9:' || SQLCODE || ' ' || SQLERRM);\n      RETURN 1;\nEND fn_cust_corp_aggr_load;\n/",
            "upstream_dependencies": [],
            "downstream_dependencies": [],
            "dag_location": "null",
            "gantt_location": "null",
            "created_at": "null",
            "updated_at": "null"
        },
        {
            "name": "FN_DOLLARS_BY_PYR_SEG_LOAD_WK",
            "encrypted_name": "9e8ebfa5ad793019faa2c6d2cf5206decd1916184571ec542fb7a7b2f5c39c29",
            "type": "function",
            "database": "null",
            "encrypted_database": "null",
            "schema": "XDMADM",
            "encrypted_schema": "0e03d5c46556a742ba46252698396ef2",
            "fully_qualified_name": "XDMADM.FN_DOLLARS_BY_PYR_SEG_LOAD_WK",
            "encrypted_fqn": "0e03d5c46556a742ba46252698396ef2.9e8ebfa5ad793019faa2c6d2cf5206decd1916184571ec542fb7a7b2f5c39c29",
            "synonyms": [],
            "metadata_analysis": "CREATE OR REPLACE FUNCTION \"0e03d5c46556a742ba46252698396ef2\".\"9e8ebfa5ad793019faa2c6d2cf5206decd1916184571ec542fb7a7b2f5c39c29\" (p_in_odate IN VARCHAR2)\n   RETURN NUMBER IS\n   \n\n   \n\n\n\n   v_const          NUMBER := 2;\n   v_end_dt         DATE;\n   v_strt_dt        DATE;\n   v_odate          DATE := TO_DATE(p_in_odate, 'YYYYMMDD');\n   v_prcs_stp       VARCHAR2(2000);\n   v_ldr_tm         NUMBER(20);\n   v_out_msg        VARCHAR2(256);\n\n   v_dba_func_msg   VARCHAR2(2000) := 'oXo';\n   dml_err_cnt      NUMBER;\n\n   l_start          NUMBER;\n   l_end            NUMBER;\n   v_table_owner    VARCHAR2(40) := 'XDMADM'; \n   v_table_name1    VARCHAR2(40) := 'DOLLARS_BY_PYR_SEG_WK'; \nBEGIN\n   \n   \n   \n   BEGIN\n      v_prcs_stp   := 'INSERT INTO table starts ';\n      l_start      := DBMS_UTILITY.get_time;\n\n      DBMS_OUTPUT.put_line('TIME ' || TO_CHAR(SYSDATE, 'yyyymmdd hh24:mi:ss'));\n\n                   INSERT \n                         INTO  de459e2fe7f96e4d958537b31b946b26.d458a891beb1ff0770a0f972079229c75fb73c9cf39b9202cce0c34fe9931634(sls_div_nbr, brnch_cd, div_nbr, fisc_yr, fisc_mth_of_yr, fisc_wk_of_prd,\n                                                            pyr_seg_cd, gl_acct_cd, cust_acctblty_flg, cust_natl_mngd_flg, grs_sls_extnd, dwa_cost_extnd,\n                                                            natl_one_tm, natl_prom_alwnc_pgms, loc_mrktng_alwnc_pgms, loc_one_tm, loc_prom_alwnc_pgms, natl_mrktng_alwnc_pgms,\n                                                            rbt_loc_accrl_amt, rbt_natl_accrl_amt, rbt_loc_exp_amt, rbt_natl_exp_amt, loc_int_dvt, loc_vndr_fnd_dvt,\n                                                            natl_int_dvt, natl_vndr_fnd_dvt, ttl_ac, ldr_tm)\n         SELECT *\n           FROM (WITH x1 AS (  SELECT sls_div_nbr,\n                                      div_nbr,\n                                      fisc_yr,\n                                      fisc_mth_of_yr,\n                                      fisc_wk_of_prd,\n                                      pyr_seg_cd,\n                                      gl_acct_cd,\n                                      cust_acctblty_flg,\n                                      cust_natl_mngd_flg,\n                                      SUM(NVL(grs_sls_extnd, 0)) grs_sls_extnd,\n                                      SUM(NVL(dwa_cost_extnd, 0)) dwa_cost_extnd,\n                                      SUM(NVL(natl_one_tm, 0)) natl_one_tm,\n                                      SUM(NVL(natl_prom_alwnc_pgms, 0)) natl_prom_alwnc_pgms,\n                                      SUM(NVL(loc_mrktng_alwnc_pgms, 0)) loc_mrktng_alwnc_pgms,\n                                      SUM(NVL(loc_one_tm, 0)) loc_one_tm,\n                                      SUM(NVL(loc_prom_alwnc_pgms, 0)) loc_prom_alwnc_pgms,\n                                      SUM(NVL(natl_mrktng_alwnc_pgms, 0)) natl_mrktng_alwnc_pgms,\n                                      SUM(NVL(rbt_loc_accrl_amt, 0)) rbt_loc_accrl_amt,\n                                      SUM(NVL(rbt_natl_accrl_amt, 0)) rbt_natl_accrl_amt,\n                                      SUM(NVL(rbt_loc_exp_amt, 0)) rbt_loc_exp_amt,\n                                      SUM(NVL(rbt_natl_exp_amt, 0)) rbt_natl_exp_amt,\n                                      SUM(loc_int_dvt) loc_int_dvt,\n                                      SUM(loc_vndr_fnd_dvt) loc_vndr_fnd_dvt,\n                                      SUM(natl_int_dvt) natl_int_dvt,\n                                      SUM(natl_vndr_fnd_dvt) natl_vndr_fnd_dvt,\n                                      SUM(ttl_ac) ttl_ac,\n                                      ldr_tm\n                                 FROM cases_and_dollars_temp_wk\n                             GROUP BY sls_div_nbr,\n                                      div_nbr,\n                                      fisc_yr,\n                                      fisc_mth_of_yr,\n                                      fisc_wk_of_prd,\n                                      pyr_seg_cd,\n                                      gl_acct_cd,\n                                      cust_acctblty_flg,\n                                      cust_natl_mngd_flg,\n                                      ldr_tm),\n                     d1 AS (SELECT div_nbr, brnch_cd FROM de459e2fe7f96e4d958537b31b946b26.dec387908a0954ddc8689c4ad37c8a3c)\n                 SELECT 503e5bca9f89192fda7def0b8f40adce.e3837b6b258b429fa00c148694e11e48,\n                        6b596d9776e346450614d112280d0dc0.4855453efe73ff0bd0f7583df58260dd,\n                        503e5bca9f89192fda7def0b8f40adce.839c4ffb4bfaae1bb58eab4dee67d96a,\n                        503e5bca9f89192fda7def0b8f40adce.ab30d6d679879cfacfe389b97d1d3f0e,\n                        503e5bca9f89192fda7def0b8f40adce.e1d446673288adb6d5f219d0aa82d37a,\n                        503e5bca9f89192fda7def0b8f40adce.3f2fdebe4ba3a24bdf16fdac5827ebfb,\n                        503e5bca9f89192fda7def0b8f40adce.156f54b388a4986aa3d3d8e74d0fc0cd,\n                        503e5bca9f89192fda7def0b8f40adce.ca8a7733395de053698a2360e88439fa,\n                        503e5bca9f89192fda7def0b8f40adce.318678c82ff4517124bc3a6b8506d59463f2fe9cc6b573bb859641780443a51b,\n                        503e5bca9f89192fda7def0b8f40adce.e33988f12139bfc93f1e7557137feb5a29e110ac67769beb8c9647cf15a66d38,\n                        503e5bca9f89192fda7def0b8f40adce.2ee1400a0150f0b220dd7bd6268d1e66,\n                        503e5bca9f89192fda7def0b8f40adce.c6c7cc45578c678907522e08bb04a4ca,\n                        503e5bca9f89192fda7def0b8f40adce.11da749d2c0d1e21a4c413489daad454,\n                        503e5bca9f89192fda7def0b8f40adce.7321a4c88369e6acc22f8952a98e86b3e7fabc080d1e698e1941d756c183e979,\n                        503e5bca9f89192fda7def0b8f40adce.3f5f78a3c918316a0e68170dc6b81e0c7ea8b5b6353c726ed7e410e230c7898b,\n                        503e5bca9f89192fda7def0b8f40adce.42c87cd307c51e63a144309315721b09,\n                        503e5bca9f89192fda7def0b8f40adce.df0917aa3fd36489aa4d308fa97b06b76398e8624834825f4604477ca9ac3d8a,\n                        503e5bca9f89192fda7def0b8f40adce.5e937026da90c7e4a4e0bb540e061948eed1259e6b62783c664a0bc2e5e255a4,\n                        503e5bca9f89192fda7def0b8f40adce.5a946c48d4cb9b1b6880bf6386e276781d731bbdc4e3fb69a854112d4982eb99,\n                        503e5bca9f89192fda7def0b8f40adce.6ec51d00c0df5a2c35ea4dc79b992a0ef4147ca167a57859c2f78f7521e7a9a8,\n                        503e5bca9f89192fda7def0b8f40adce.bb26587da7cde1ca1883d4ac6949a349,\n                        503e5bca9f89192fda7def0b8f40adce.d2a9879c73e438cd42a66e4ee567caf5e32f6dd38f333cde68119d1f277367cd,\n                        503e5bca9f89192fda7def0b8f40adce.931b2ac4399b8a337f8d0ff67bab0e15,\n                        503e5bca9f89192fda7def0b8f40adce.c137fdd918ede20e07fec7282883fa34e32f6dd38f333cde68119d1f277367cd,\n                        503e5bca9f89192fda7def0b8f40adce.42dd45423319f918e704ed37d4dbb128,\n                        503e5bca9f89192fda7def0b8f40adce.b5019e4009d6240fe25b80db390c07601d731bbdc4e3fb69a854112d4982eb99,\n                        503e5bca9f89192fda7def0b8f40adce.502b0bf00876210a515436d7a2d97c22,\n                        503e5bca9f89192fda7def0b8f40adce.721a8ad171b31ae60261431ccd51b52d\n                   FROM x1, d1\n                  WHERE 503e5bca9f89192fda7def0b8f40adce.e3837b6b258b429fa00c148694e11e48 = 6b596d9776e346450614d112280d0dc0.839c4ffb4bfaae1bb58eab4dee67d96a);\n\n      l_end        := DBMS_UTILITY.get_time;\n\n      DBMS_OUTPUT.put_line('NO OF ROWS INSERTED:' || sql%ROWCOUNT);\n\n      DBMS_OUTPUT.put_line(ROUND((l_end - l_start) / 100, 2) || ' seconds...');\n      COMMIT;\n      RETURN 0;\n   EXCEPTION\n      WHEN OTHERS THEN\n         DBMS_OUTPUT.put_line('Error in v_prcs_stp:' || v_prcs_stp || SQLCODE || SQLERRM);\n\n         RETURN 701;\n   END;\n\n\n\n\nEXCEPTION\n   WHEN OTHERS THEN\n      ROLLBACK;\n      DBMS_OUTPUT.put_line(SQLCODE);\n      DBMS_OUTPUT.put_line(SQLERRM);\n\n      DBMS_OUTPUT.put_line('Error in function FN_DOLLARS_BY_PYR_SEG_LOAD_WK');\n      RETURN 600;\nEND fn_dollars_by_pyr_seg_load_wk;\n/",
            "upstream_dependencies": [],
            "downstream_dependencies": [],
            "dag_location": "null",
            "gantt_location": "null",
            "created_at": "null",
            "updated_at": "null"
        },
        {
            "name": "FN_DIV_ALL_VPD",
            "encrypted_name": "4712e64c7f21bf99d27d8bddf6b04fa2",
            "type": "function",
            "database": "null",
            "encrypted_database": "null",
            "schema": "XDMADM",
            "encrypted_schema": "0e03d5c46556a742ba46252698396ef2",
            "fully_qualified_name": "XDMADM.FN_DIV_ALL_VPD",
            "encrypted_fqn": "0e03d5c46556a742ba46252698396ef2.4712e64c7f21bf99d27d8bddf6b04fa2",
            "synonyms": [],
            "metadata_analysis": "CREATE OR REPLACE FUNCTION \"0e03d5c46556a742ba46252698396ef2\".\"4712e64c7f21bf99d27d8bddf6b04fa2\" (p_schema       IN VARCHAR2,\n                                                 p_objname      IN VARCHAR2)\n   RETURN VARCHAR2 AS\n   \n   c_start                CONSTANT NUMBER := DBMS_UTILITY.get_time;\n   c_fn_nm                CONSTANT VARCHAR2(30) := 'FN_DIV_ALL_VPD';\n   l_security_predicate   VARCHAR2(4000) DEFAULT NULL;\n   l_cur_sql              VARCHAR2(4000) := SYS_CONTEXT('USERENV', 'CURRENT_SQL');\n   l_sbjct_area VARCHAR2(100)\n         := SYS_CONTEXT(9751bbbcfea690cc0be4d58830a6fe2e.9bfb5eb7793dc8fa6800d5a61e5e3e4e1e2f6ec194927f064ce6cb31fba71a32.f4a54ebc6f2c591ed4266aafe66971af, 9751bbbcfea690cc0be4d58830a6fe2e.9bfb5eb7793dc8fa6800d5a61e5e3e4e1e2f6ec194927f064ce6cb31fba71a32.3b1288ed835b1b524e9500bb13544956e6e6300089dae5a98e31814d0406060f);\n   l_vpd_exempt VARCHAR2(1)\n         := SYS_CONTEXT(9751bbbcfea690cc0be4d58830a6fe2e.9bfb5eb7793dc8fa6800d5a61e5e3e4e1e2f6ec194927f064ce6cb31fba71a32.f4a54ebc6f2c591ed4266aafe66971af, 9751bbbcfea690cc0be4d58830a6fe2e.9bfb5eb7793dc8fa6800d5a61e5e3e4e1e2f6ec194927f064ce6cb31fba71a32.0eaf613ab52a53601d1496b5650de81e);\n   l_all_divs VARCHAR2(1)\n         := SYS_CONTEXT(9751bbbcfea690cc0be4d58830a6fe2e.9bfb5eb7793dc8fa6800d5a61e5e3e4e1e2f6ec194927f064ce6cb31fba71a32.f4a54ebc6f2c591ed4266aafe66971af, 9751bbbcfea690cc0be4d58830a6fe2e.9bfb5eb7793dc8fa6800d5a61e5e3e4e1e2f6ec194927f064ce6cb31fba71a32.0f460756ee76d4a2460733464cda5f95);\n\n\nBEGIN\n   \n\n   IF l_sbjct_area IS NULL THEN\n      l_security_predicate   := '1=2';\n      9751bbbcfea690cc0be4d58830a6fe2e.d4abe88ed2062b430c927bc84d61faf1f9a7aadf5998d448c2e2d1b0b47a3056.7d64937276682b23a0e16e5c61dad7aa('NO SA', c_fn_nm, USER, p_schema, p_objname, l_sbjct_area, l_vpd_exempt,\n      l_all_divs, l_cur_sql, l_security_predicate, (DBMS_UTILITY.get_time - c_start) / 100);\n\n      RETURN l_security_predicate;\n   END IF;\n\n   l_security_predicate   := '1=1';\n   9751bbbcfea690cc0be4d58830a6fe2e.d4abe88ed2062b430c927bc84d61faf1f9a7aadf5998d448c2e2d1b0b47a3056.7d64937276682b23a0e16e5c61dad7aa('ALL DIVS', c_fn_nm, USER, p_schema, p_objname, l_sbjct_area, l_vpd_exempt,\n   l_all_divs, l_cur_sql, l_security_predicate, (DBMS_UTILITY.get_time - c_start) / 100);\n\n   RETURN l_security_predicate;\nEXCEPTION\n   WHEN OTHERS THEN\n      l_security_predicate   := '1=2';\n      9751bbbcfea690cc0be4d58830a6fe2e.d4abe88ed2062b430c927bc84d61faf1f9a7aadf5998d448c2e2d1b0b47a3056.7d64937276682b23a0e16e5c61dad7aa(SQLCODE || '-' || SQLERRM, c_fn_nm, USER, p_schema, p_objname, l_sbjct_area,\n      l_vpd_exempt, NULL, l_cur_sql, l_security_predicate, (DBMS_UTILITY.get_time - c_start) / 100);\n\n      RETURN l_security_predicate;\nEND fn_div_all_vpd;\n/",
            "upstream_dependencies": [],
            "downstream_dependencies": [],
            "dag_location": "null",
            "gantt_location": "null",
            "created_at": "null",
            "updated_at": "null"
        },
        {
            "name": "FN_SAME_DAY_LOAD_VPD",
            "encrypted_name": "6471bfa11afdec706d0ce83e6e0e2b906f3bf1564d2f7da4e41552c0a7d78051",
            "type": "function",
            "database": "null",
            "encrypted_database": "null",
            "schema": "XDMADM",
            "encrypted_schema": "0e03d5c46556a742ba46252698396ef2",
            "fully_qualified_name": "XDMADM.FN_SAME_DAY_LOAD_VPD",
            "encrypted_fqn": "0e03d5c46556a742ba46252698396ef2.6471bfa11afdec706d0ce83e6e0e2b906f3bf1564d2f7da4e41552c0a7d78051",
            "synonyms": [],
            "metadata_analysis": "CREATE OR REPLACE FUNCTION \"0e03d5c46556a742ba46252698396ef2\".\"6471bfa11afdec706d0ce83e6e0e2b906f3bf1564d2f7da4e41552c0a7d78051\" (p_schema       IN VARCHAR2,\n                              p_objname      IN VARCHAR2)\n   RETURN VARCHAR2 AS\n   \n\n   c_start                CONSTANT NUMBER := sys.DBMS_UTILITY.get_time;\n   c_fn_nm                CONSTANT VARCHAR2(30) := 'FN_SAME_DAY_LOAD_VPD';\n   l_security_predicate   VARCHAR2(4000) DEFAULT NULL;\n   l_cur_sql              VARCHAR2(4000) := SYS_CONTEXT('USERENV', 'CURRENT_SQL');\n   l_sbjct_area           VARCHAR2(100) := SYS_CONTEXT(9751bbbcfea690cc0be4d58830a6fe2e.9bfb5eb7793dc8fa6800d5a61e5e3e4e1e2f6ec194927f064ce6cb31fba71a32.f4a54ebc6f2c591ed4266aafe66971af, 9751bbbcfea690cc0be4d58830a6fe2e.9bfb5eb7793dc8fa6800d5a61e5e3e4e1e2f6ec194927f064ce6cb31fba71a32.3b1288ed835b1b524e9500bb13544956e6e6300089dae5a98e31814d0406060f);\n   l_vpd_exempt           VARCHAR2(1) := SYS_CONTEXT(9751bbbcfea690cc0be4d58830a6fe2e.9bfb5eb7793dc8fa6800d5a61e5e3e4e1e2f6ec194927f064ce6cb31fba71a32.f4a54ebc6f2c591ed4266aafe66971af, 9751bbbcfea690cc0be4d58830a6fe2e.9bfb5eb7793dc8fa6800d5a61e5e3e4e1e2f6ec194927f064ce6cb31fba71a32.0eaf613ab52a53601d1496b5650de81e);\n   l_all_divs             VARCHAR2(1) := SYS_CONTEXT(9751bbbcfea690cc0be4d58830a6fe2e.9bfb5eb7793dc8fa6800d5a61e5e3e4e1e2f6ec194927f064ce6cb31fba71a32.f4a54ebc6f2c591ed4266aafe66971af, 9751bbbcfea690cc0be4d58830a6fe2e.9bfb5eb7793dc8fa6800d5a61e5e3e4e1e2f6ec194927f064ce6cb31fba71a32.0f460756ee76d4a2460733464cda5f95);\n   l_spcl_hndling         VARCHAR2(20);\n   l_usr_div_date         VARCHAR2(20);\n   l_stmt_no              NUMBER := 0;\n   l_div_count            NUMBER := 0;\n   l_div_nbr              NUMBER := 0;\n   l_first                BOOLEAN := TRUE;\nBEGIN\n   \n\n   IF l_sbjct_area IS NULL THEN\n      l_security_predicate   := '1=2';\n      9751bbbcfea690cc0be4d58830a6fe2e.d4abe88ed2062b430c927bc84d61faf1f9a7aadf5998d448c2e2d1b0b47a3056.7d64937276682b23a0e16e5c61dad7aa('NO SA',\n                                          c_fn_nm,\n                                          USER,\n                                          p_schema,\n                                          p_objname,\n                                          l_sbjct_area,\n                                          l_vpd_exempt,\n                                          l_all_divs,\n                                          l_cur_sql,\n                                          l_security_predicate,\n                                          (sys.DBMS_UTILITY.get_time - c_start) / 100);\n\n      RETURN l_security_predicate;\n   END IF;\n\n   \n   \n\n   IF l_vpd_exempt = 'Y' THEN\n      l_security_predicate   := '1=1';\n      9751bbbcfea690cc0be4d58830a6fe2e.d4abe88ed2062b430c927bc84d61faf1f9a7aadf5998d448c2e2d1b0b47a3056.7d64937276682b23a0e16e5c61dad7aa('EXEMPT',\n                                          c_fn_nm,\n                                          USER,\n                                          p_schema,\n                                          p_objname,\n                                          l_sbjct_area,\n                                          l_vpd_exempt,\n                                          l_all_divs,\n                                          l_cur_sql,\n                                          l_security_predicate,\n                                          (sys.DBMS_UTILITY.get_time - c_start) / 100);\n\n      RETURN l_security_predicate;\n   END IF;\n\n   \n   \n   \n\n   IF l_all_divs = 'Y' THEN\n      SELECT TO_CHAR(MIN(div_load_ts), 'YYYYMMDDHH24MISS')\n        INTO l_usr_div_date\n        FROM de459e2fe7f96e4d958537b31b946b26.0b3320d3f985cd20d1ec65d9dfeed2de f, de459e2fe7f96e4d958537b31b946b26.dec387908a0954ddc8689c4ad37c8a3c d\n       WHERE div_load_stat = 0\n         AND fact_table = 'SALES_CORP'\n         AND de459e2fe7f96e4d958537b31b946b26.0b3320d3f985cd20d1ec65d9dfeed2de.839c4ffb4bfaae1bb58eab4dee67d96a = de459e2fe7f96e4d958537b31b946b26.dec387908a0954ddc8689c4ad37c8a3c.839c4ffb4bfaae1bb58eab4dee67d96a\n         AND fact_typ_cd = 'RG'\n         AND de459e2fe7f96e4d958537b31b946b26.dec387908a0954ddc8689c4ad37c8a3c.b8c6ab19cb6e726c38f24d1885346ea3 NOT IN ('CC', 'STK', 'SPC'); \n\n      IF l_usr_div_date IS NOT NULL THEN\n         l_security_predicate   :=\n               'TO_DATE(to_char(NVL(ORIG_LDR_TM,LDR_TM)),''YYYYMMDDHH24MISS'') <  TO_DATE('''\n            || l_usr_div_date\n            || ''',''YYYYMMDDHH24MISS'')';\n         9751bbbcfea690cc0be4d58830a6fe2e.d4abe88ed2062b430c927bc84d61faf1f9a7aadf5998d448c2e2d1b0b47a3056.7d64937276682b23a0e16e5c61dad7aa('ALL DIVS NO SAME DAY',\n                                             c_fn_nm,\n                                             USER,\n                                             p_schema,\n                                             p_objname,\n                                             l_sbjct_area,\n                                             l_vpd_exempt,\n                                             l_all_divs,\n                                             l_cur_sql,\n                                             l_security_predicate,\n                                             (sys.DBMS_UTILITY.get_time - c_start) / 100);\n\n         RETURN l_security_predicate;\n      ELSE\n         l_security_predicate   := '1=1';\n         9751bbbcfea690cc0be4d58830a6fe2e.d4abe88ed2062b430c927bc84d61faf1f9a7aadf5998d448c2e2d1b0b47a3056.7d64937276682b23a0e16e5c61dad7aa('ALL DIVS SAME DAY',\n                                             c_fn_nm,\n                                             USER,\n                                             p_schema,\n                                             p_objname,\n                                             l_sbjct_area,\n                                             l_vpd_exempt,\n                                             l_all_divs,\n                                             l_cur_sql,\n                                             l_security_predicate,\n                                             (sys.DBMS_UTILITY.get_time - c_start) / 100);\n\n         RETURN l_security_predicate;\n      END IF;\n   END IF;\n\n   SELECT TO_CHAR(MIN(de459e2fe7f96e4d958537b31b946b26.0b3320d3f985cd20d1ec65d9dfeed2de.973ac0b5b4102ce5cf52759e893ad53f), 'YYYYMMDDHH24MISS')\n     INTO l_usr_div_date\n     FROM de459e2fe7f96e4d958537b31b946b26.0b3320d3f985cd20d1ec65d9dfeed2de fls, 9751bbbcfea690cc0be4d58830a6fe2e.77f574c4275330a2ed961a49e2cb2df5 utd, de459e2fe7f96e4d958537b31b946b26.dec387908a0954ddc8689c4ad37c8a3c d\n    WHERE de459e2fe7f96e4d958537b31b946b26.0b3320d3f985cd20d1ec65d9dfeed2de.839c4ffb4bfaae1bb58eab4dee67d96a = 9751bbbcfea690cc0be4d58830a6fe2e.77f574c4275330a2ed961a49e2cb2df5.839c4ffb4bfaae1bb58eab4dee67d96a\n      AND de459e2fe7f96e4d958537b31b946b26.0b3320d3f985cd20d1ec65d9dfeed2de.839c4ffb4bfaae1bb58eab4dee67d96a = de459e2fe7f96e4d958537b31b946b26.dec387908a0954ddc8689c4ad37c8a3c.839c4ffb4bfaae1bb58eab4dee67d96a\n      AND 9751bbbcfea690cc0be4d58830a6fe2e.77f574c4275330a2ed961a49e2cb2df5.39ebeb219ed1244dec0e84ff7af83631 IN (l_sbjct_area, 'ALL')\n      AND UPPER(9751bbbcfea690cc0be4d58830a6fe2e.77f574c4275330a2ed961a49e2cb2df5.2487b33bfe363b72c30841fcf6b4451b) = USER\n      AND de459e2fe7f96e4d958537b31b946b26.0b3320d3f985cd20d1ec65d9dfeed2de.2035d739dc489843c15afb7ce4647338 = 0\n      AND de459e2fe7f96e4d958537b31b946b26.0b3320d3f985cd20d1ec65d9dfeed2de.e0b90cffaad9c3cb9c25d00826e70aac = 'SALES_CORP'\n      AND de459e2fe7f96e4d958537b31b946b26.0b3320d3f985cd20d1ec65d9dfeed2de.b90da9a94c2b509f039383aa5f9015bc = 'RG'\n      AND de459e2fe7f96e4d958537b31b946b26.dec387908a0954ddc8689c4ad37c8a3c.b8c6ab19cb6e726c38f24d1885346ea3 NOT IN ('CC', 'STK', 'SPC'); \n\n   IF l_usr_div_date IS NOT NULL THEN\n      l_security_predicate   :=\n            'TO_DATE(to_char(NVL(ORIG_LDR_TM,LDR_TM)),''YYYYMMDDHH24MISS'') <  TO_DATE('''\n         || l_usr_div_date\n         || ''',''YYYYMMDDHH24MISS'')';\n      9751bbbcfea690cc0be4d58830a6fe2e.d4abe88ed2062b430c927bc84d61faf1f9a7aadf5998d448c2e2d1b0b47a3056.7d64937276682b23a0e16e5c61dad7aa('USR DIVS NO SAME DAY',\n                                          c_fn_nm,\n                                          USER,\n                                          p_schema,\n                                          p_objname,\n                                          l_sbjct_area,\n                                          l_vpd_exempt,\n                                          l_all_divs,\n                                          l_cur_sql,\n                                          l_security_predicate,\n                                          (sys.DBMS_UTILITY.get_time - c_start) / 100);\n\n      RETURN l_security_predicate;\n   ELSE\n      l_security_predicate   := '1=1';\n      9751bbbcfea690cc0be4d58830a6fe2e.d4abe88ed2062b430c927bc84d61faf1f9a7aadf5998d448c2e2d1b0b47a3056.7d64937276682b23a0e16e5c61dad7aa('USR DIVS SAME DAY',\n                                          c_fn_nm,\n                                          USER,\n                                          p_schema,\n                                          p_objname,\n                                          l_sbjct_area,\n                                          l_vpd_exempt,\n                                          l_all_divs,\n                                          l_cur_sql,\n                                          l_security_predicate,\n                                          (sys.DBMS_UTILITY.get_time - c_start) / 100);\n\n      RETURN l_security_predicate;\n   END IF;\nEXCEPTION\n   WHEN OTHERS THEN\n      l_security_predicate   := '1=3';\n      9751bbbcfea690cc0be4d58830a6fe2e.d4abe88ed2062b430c927bc84d61faf1f9a7aadf5998d448c2e2d1b0b47a3056.7d64937276682b23a0e16e5c61dad7aa(SQLCODE || '-' || SQLERRM,\n                                          c_fn_nm,\n                                          USER,\n                                          p_schema,\n                                          p_objname,\n                                          l_sbjct_area,\n                                          l_vpd_exempt,\n                                          l_all_divs,\n                                          l_cur_sql,\n                                          l_security_predicate,\n                                          (sys.DBMS_UTILITY.get_time - c_start) / 100);\n\n      RETURN l_security_predicate;\nEND fn_same_day_load_vpd;\n/",
            "upstream_dependencies": [],
            "downstream_dependencies": [],
            "dag_location": "null",
            "gantt_location": "null",
            "created_at": "null",
            "updated_at": "null"
        },
        {
            "name": "FN_FWB_MDL_UPDT",
            "encrypted_name": "55064c1180f6ab336267c27277a24dab",
            "type": "function",
            "database": "null",
            "encrypted_database": "null",
            "schema": "XDMADM",
            "encrypted_schema": "0e03d5c46556a742ba46252698396ef2",
            "fully_qualified_name": "XDMADM.FN_FWB_MDL_UPDT",
            "encrypted_fqn": "0e03d5c46556a742ba46252698396ef2.55064c1180f6ab336267c27277a24dab",
            "synonyms": [],
            "metadata_analysis": "CREATE OR REPLACE FUNCTION \"0e03d5c46556a742ba46252698396ef2\".\"55064c1180f6ab336267c27277a24dab\" (p_odate varchar2,p_abort_flg in char)\nreturn number as\n\n\n\n\n\n    CON_PROCESS_NAME   CONSTANT VARCHAR2(40) := 'FN_FWB_MDL_UPDT';\n    CON_PRRTY_SEVERE   CONSTANT INTEGER := 1;\n    CON_PRRTY_WARN     CONSTANT INTEGER := 2;\n    CON_PRRTY_INFO     CONSTANT INTEGER := 3;\n    CON_PRRTY_DEBUG    CONSTANT INTEGER := 4;\n    CON_ERR_LVL        CONSTANT INTEGER := 3;\n    v_prcs_err_cd      NUMBER;\n    v_prcs_err_msg     VARCHAR2(500);\n    v_prcs_nm          VARCHAR2(30);\n    v_prcs_stp         VARCHAR2(500);\n\n\n    v_div_by_vndr_pct               de459e2fe7f96e4d958537b31b946b26.3ac217a6e67d8f0b8bacb7eae897ec01.9c32f86fb3474d80966549d99eff4696%TYPE;\n    v_div_by_vndr_prod_nbr_pct      de459e2fe7f96e4d958537b31b946b26.3ac217a6e67d8f0b8bacb7eae897ec01.b84b333a29f0a55bb4fac4c860cad23e498656bc8ad66311ba393980465dbd28%TYPE;\n    v_div_by_vndr_pct_ttl           NUMBER := 0;\n    v_div_by_vndr_prod_nbr_pct_ttl  NUMBER := 0;\n\n    v_fwb_mdl_rec                   de459e2fe7f96e4d958537b31b946b26.3ac217a6e67d8f0b8bacb7eae897ec01%rowtype;\n    v_opo_corp_stat                 de459e2fe7f96e4d958537b31b946b26.0b3320d3f985cd20d1ec65d9dfeed2de.2035d739dc489843c15afb7ce4647338%TYPE;\n    v_inv_stat                      de459e2fe7f96e4d958537b31b946b26.0b3320d3f985cd20d1ec65d9dfeed2de.2035d739dc489843c15afb7ce4647338%TYPE;\n    v_cursor_rowcount               NUMBER := 0;\n    v_updt_process                  NUMBER := 0;\n    v_div_pct                       NUMBER := 0;\n    v_div_pct_display               VARCHAR2(30);\n\n    v_odate                         date := to_date(p_odate,'yyyymmdd');\n\n    v_gain_end_days                 NUMBER;\n    v_reval_ship_dt_null_days       NUMBER;\n\n    v_opo_corp_schedule             VARCHAR2(3);\n    v_po_corp_schedule              VARCHAR2(3);\n    v_inventory_schedule            VARCHAR2(3);\n\n\nBEGIN\n\n\n    \n    dbms_output.put_line(' ');\n    v_prcs_stp := 'Populating forward buy values from the de459e2fe7f96e4d958537b31b946b26.02e9d63d10f9b42832e13b830a66cb4e table';\n    dbms_output.put_line(TO_CHAR(SYSDATE,'YYYY-MM-DD HH24:MI:SS     ')||v_prcs_stp);\n\n\n       \n       SELECT param_code\n       INTO v_gain_end_days\n       FROM de459e2fe7f96e4d958537b31b946b26.de40ae7be8b2eb3858d46af8d107f3db\n       WHERE app_name = 'FORWARD_BUY'\n       AND param_type = 'GAIN_END_DAYS';\n\n       \n       SELECT param_code\n       INTO v_reval_ship_dt_null_days\n       FROM de459e2fe7f96e4d958537b31b946b26.de40ae7be8b2eb3858d46af8d107f3db\n       WHERE app_name = 'FORWARD_BUY'\n       AND param_type = 'REVAL_SHIP_DT_NULL_DAYS';\n\n       \n       SELECT param_code\n       INTO v_opo_corp_schedule\n       FROM de459e2fe7f96e4d958537b31b946b26.de40ae7be8b2eb3858d46af8d107f3db\n       WHERE app_name = 'FORWARD_BUY'\n       AND param_type = 'OPO_CORP_SCHEDULE';\n\n       \n       SELECT param_code\n       INTO v_po_corp_schedule\n       FROM de459e2fe7f96e4d958537b31b946b26.de40ae7be8b2eb3858d46af8d107f3db\n       WHERE app_name = 'FORWARD_BUY'\n       AND param_type = 'PO_CORP_SCHEDULE';\n\n       \n       SELECT param_code\n       INTO v_inventory_schedule\n       FROM de459e2fe7f96e4d958537b31b946b26.de40ae7be8b2eb3858d46af8d107f3db\n       WHERE app_name = 'FORWARD_BUY'\n       AND param_type = 'INVENTORY_SCHEDULE';\n\n\n\n        \n\n        v_prcs_stp := 'Checking Open PO and Inventory Status';\n        dbms_output.put_line(TO_CHAR(SYSDATE,'YYYY-MM-DD HH24:MI:SS     ')||v_prcs_stp);\n\n        \n        \n        \n        SELECT div_load_stat\n          INTO v_opo_corp_stat\n          FROM de459e2fe7f96e4d958537b31b946b26.0b3320d3f985cd20d1ec65d9dfeed2de\n         WHERE fact_table = 'OPO_CORP'\n           AND ROWNUM = 1\n           AND TRUNC(latest_prcs_dt) = CASE\n                                          WHEN v_opo_corp_schedule = '1-7'\n                                             THEN v_odate\n                                          WHEN v_opo_corp_schedule = '1-6'\n                                             THEN CASE WHEN TO_CHAR(v_odate,'D') = 7 THEN v_odate - 1\n                                                  ELSE v_odate END\n                                          WHEN v_opo_corp_schedule = '2-6'\n                                             THEN CASE WHEN TO_CHAR(v_odate,'D') = 6 THEN v_odate - 1\n                                                       WHEN TO_CHAR(v_odate,'D') = 7 THEN v_odate - 2\n                                                  ELSE v_odate END\n                                       ELSE v_odate\n                                       END;\n\n\n\n        \n        \n        \n        SELECT div_load_stat\n          INTO v_inv_stat\n          FROM de459e2fe7f96e4d958537b31b946b26.0b3320d3f985cd20d1ec65d9dfeed2de\n         WHERE fact_table = 'INVNTY_TRK_CORP_DLY'\n           AND ROWNUM = 1\n           AND TRUNC(latest_prcs_dt) = CASE\n                                          WHEN v_inventory_schedule = '1-7'\n                                             THEN v_odate\n                                          WHEN v_inventory_schedule = '1-6'\n                                             THEN CASE WHEN TO_CHAR(v_odate,'D') = 7 THEN v_odate - 1\n                                                  ELSE v_odate END\n                                          WHEN v_inventory_schedule = '2-6'\n                                             THEN CASE WHEN TO_CHAR(v_odate,'D') = 6 THEN v_odate - 1\n                                                       WHEN TO_CHAR(v_odate,'D') = 7 THEN v_odate - 2\n                                                  ELSE v_odate END\n                                       ELSE v_odate\n                                       END;\n\n        dbms_output.put_line(TO_CHAR(SYSDATE,'YYYY-MM-DD HH24:MI:SS     ')||'     Open PO status is '||v_opo_corp_stat);\n        dbms_output.put_line(TO_CHAR(SYSDATE,'YYYY-MM-DD HH24:MI:SS     ')||'     Inventory status is '||v_inv_stat);\n\n\n    \n    IF (v_opo_corp_stat > 0 AND v_inv_stat > 0) then\n\n\n        \n\n        v_prcs_stp :=  'Freezing old records';\n        dbms_output.put_line(TO_CHAR(SYSDATE,'YYYY-MM-DD HH24:MI:SS     ')||v_prcs_stp);\n\n        UPDATE 0e03d5c46556a742ba46252698396ef2.3ac217a6e67d8f0b8bacb7eae897ec01\n           SET fwb_frz_ind = 'Y'\n          WHERE build_end_dt < (v_odate - v_gain_end_days)\n        AND NVL(fwb_frz_ind,'N') != 'Y';\n\n        v_prcs_stp := '     Freezing Completed Successfully:  '||SQL%ROWCOUNT||' rows frozen';\n        dbms_output.put_line(TO_CHAR(SYSDATE,'YYYY-MM-DD HH24:MI:SS     ')||v_prcs_stp);\n\n\n\n\n        \n        v_prcs_stp := 'Starting FWB_MDL Update Main cursor';\n        dbms_output.put_line(TO_CHAR(SYSDATE,'YYYY-MM-DD HH24:MI:SS     ')||v_prcs_stp);\n\n        FOR c_fwb_mdl_updt IN\n        (\n\n         WITH inv_deals AS\n                (\n                   SELECT 6ab39b60d6f2c33a660123f45c60027a.839c4ffb4bfaae1bb58eab4dee67d96a,\n                       6ab39b60d6f2c33a660123f45c60027a.2d45d761eb8d137835bca7a23010fab4,\n                       6ab39b60d6f2c33a660123f45c60027a.248bb7c9e01b8c5f62ab69655707dfa2,\n                       6ab39b60d6f2c33a660123f45c60027a.1d3f35cf8fe3d610d6c6d6282b3298f4,\n                       6ab39b60d6f2c33a660123f45c60027a.045f5a67635dd6df5b1cd25c92e8a68874c8e31994492430a932cedb572e8acf,\n                       6ab39b60d6f2c33a660123f45c60027a.19303c1f19e2797c3ce68f27e3fe51c7f0b50ea96f7fef3c9e84fed1968e8147,\n                       f457feb3a7b6b56bd605eb69c2f5070f.2117edd80dd5990f80d44c271c5b87a2a3ccc966d8f287c72c0a9f16f7eb69ed\n                   FROM\n                (SELECT\n                       9d311d2a1a94ef273657eec6fb11339f.839c4ffb4bfaae1bb58eab4dee67d96a,\n                       9d311d2a1a94ef273657eec6fb11339f.2d45d761eb8d137835bca7a23010fab4,\n                       9d311d2a1a94ef273657eec6fb11339f.248bb7c9e01b8c5f62ab69655707dfa2,\n                       9d311d2a1a94ef273657eec6fb11339f.1d3f35cf8fe3d610d6c6d6282b3298f4,\n                       SUM(DECODE(de459e2fe7f96e4d958537b31b946b26.012d9ba8d175e62146e8b58cab6bff27.9510796389298dfcc6b62ae39759608b, 'N', de459e2fe7f96e4d958537b31b946b26.012d9ba8d175e62146e8b58cab6bff27.07682cd21f9406c0aa38b03ea2c9d13c, 0))   fwb_crnt_opn_on_ord_qty,\n                       SUM(DECODE(de459e2fe7f96e4d958537b31b946b26.012d9ba8d175e62146e8b58cab6bff27.9510796389298dfcc6b62ae39759608b, 'Y', de459e2fe7f96e4d958537b31b946b26.012d9ba8d175e62146e8b58cab6bff27.e08d762984b4958fe98ced8ee3e72aba, 0)) fwb_crnt_cnfrm_opn_ord_qty\n\n                    FROM de459e2fe7f96e4d958537b31b946b26.3ac217a6e67d8f0b8bacb7eae897ec01 mdl_deals\n\n                    LEFT OUTER JOIN de459e2fe7f96e4d958537b31b946b26.012d9ba8d175e62146e8b58cab6bff27 opo\n                      ON 9d311d2a1a94ef273657eec6fb11339f.839c4ffb4bfaae1bb58eab4dee67d96a = de459e2fe7f96e4d958537b31b946b26.012d9ba8d175e62146e8b58cab6bff27.839c4ffb4bfaae1bb58eab4dee67d96a\n                     AND 9d311d2a1a94ef273657eec6fb11339f.2d45d761eb8d137835bca7a23010fab4 = de459e2fe7f96e4d958537b31b946b26.012d9ba8d175e62146e8b58cab6bff27.2d45d761eb8d137835bca7a23010fab4\n                     AND 9d311d2a1a94ef273657eec6fb11339f.223b465d99ce0b2ddf59cb7c68e88cf6 = 'DEALS'\n                     AND (\n\n                              (\n                                    9d311d2a1a94ef273657eec6fb11339f.70e1c5a02e931a9432af1b4b607d2d39 = 'ORDER DATE'\n                                AND de459e2fe7f96e4d958537b31b946b26.012d9ba8d175e62146e8b58cab6bff27.d07269fd715528545216b1ab9353756e BETWEEN 9d311d2a1a94ef273657eec6fb11339f.2fc53cb1d7b378da3f908e285bfa7f5e AND 9d311d2a1a94ef273657eec6fb11339f.248bb7c9e01b8c5f62ab69655707dfa2\n                              )\n\n                            OR\n                              (     (9d311d2a1a94ef273657eec6fb11339f.70e1c5a02e931a9432af1b4b607d2d39 = 'REQUESTED DELIVERY DATE' OR 9d311d2a1a94ef273657eec6fb11339f.70e1c5a02e931a9432af1b4b607d2d39='SCHEDULED DELIVERY DATE')\n                                AND de459e2fe7f96e4d958537b31b946b26.012d9ba8d175e62146e8b58cab6bff27.ce5f82a5e75938dfa35b47989ed3591a BETWEEN 9d311d2a1a94ef273657eec6fb11339f.2fc53cb1d7b378da3f908e285bfa7f5e AND 9d311d2a1a94ef273657eec6fb11339f.248bb7c9e01b8c5f62ab69655707dfa2\n                              )\n\n                            OR (  9d311d2a1a94ef273657eec6fb11339f.70e1c5a02e931a9432af1b4b607d2d39 = 'SHIP DATE'\n                                  AND NVL(de459e2fe7f96e4d958537b31b946b26.012d9ba8d175e62146e8b58cab6bff27.42c0b18f63bab531d16dabbe001c662d, de459e2fe7f96e4d958537b31b946b26.012d9ba8d175e62146e8b58cab6bff27.d07269fd715528545216b1ab9353756e + v_reval_ship_dt_null_days)\n                                      BETWEEN 9d311d2a1a94ef273657eec6fb11339f.2fc53cb1d7b378da3f908e285bfa7f5e AND 9d311d2a1a94ef273657eec6fb11339f.248bb7c9e01b8c5f62ab69655707dfa2\n                                )\n                         )\n                     WHERE\n                         9d311d2a1a94ef273657eec6fb11339f.223b465d99ce0b2ddf59cb7c68e88cf6 = 'DEALS'\n                     AND 9d311d2a1a94ef273657eec6fb11339f.3ad9e70cf16862b1ecd4e1a0ecde3783 IS NULL\n                     AND NVL(9d311d2a1a94ef273657eec6fb11339f.c268e49ad49183f154b1ef1ec3d2f7c9,'N') = 'N'\n                     AND v_odate <= 9d311d2a1a94ef273657eec6fb11339f.248bb7c9e01b8c5f62ab69655707dfa2\n                     group by 9d311d2a1a94ef273657eec6fb11339f.839c4ffb4bfaae1bb58eab4dee67d96a, 9d311d2a1a94ef273657eec6fb11339f.2d45d761eb8d137835bca7a23010fab4, 9d311d2a1a94ef273657eec6fb11339f.248bb7c9e01b8c5f62ab69655707dfa2, 9d311d2a1a94ef273657eec6fb11339f.1d3f35cf8fe3d610d6c6d6282b3298f4) opo_sub_q\n                LEFT OUTER JOIN\n                    (SELECT\n                       9d311d2a1a94ef273657eec6fb11339f.839c4ffb4bfaae1bb58eab4dee67d96a,\n                       9d311d2a1a94ef273657eec6fb11339f.2d45d761eb8d137835bca7a23010fab4,\n                       9d311d2a1a94ef273657eec6fb11339f.248bb7c9e01b8c5f62ab69655707dfa2,\n                       9d311d2a1a94ef273657eec6fb11339f.1d3f35cf8fe3d610d6c6d6282b3298f4,\n                       SUM(de459e2fe7f96e4d958537b31b946b26.c437d55d53d88d02ce92bdadaefd8483.e7cabb8cf7b3db25086b2c8c7fe3a76e) fwb_crnt_on_hnd_net_qty\n\n                    FROM de459e2fe7f96e4d958537b31b946b26.3ac217a6e67d8f0b8bacb7eae897ec01 mdl_deals\n\n                    INNER JOIN de459e2fe7f96e4d958537b31b946b26.c437d55d53d88d02ce92bdadaefd8483 po\n                      ON 9d311d2a1a94ef273657eec6fb11339f.839c4ffb4bfaae1bb58eab4dee67d96a = de459e2fe7f96e4d958537b31b946b26.c437d55d53d88d02ce92bdadaefd8483.839c4ffb4bfaae1bb58eab4dee67d96a\n                     AND 9d311d2a1a94ef273657eec6fb11339f.2d45d761eb8d137835bca7a23010fab4 = de459e2fe7f96e4d958537b31b946b26.c437d55d53d88d02ce92bdadaefd8483.2d45d761eb8d137835bca7a23010fab4\n                     AND de459e2fe7f96e4d958537b31b946b26.c437d55d53d88d02ce92bdadaefd8483.75274b7e794ec4ac03e63646e000c70b > v_odate - v_gain_end_days - v_reval_ship_dt_null_days\n                     AND 9d311d2a1a94ef273657eec6fb11339f.223b465d99ce0b2ddf59cb7c68e88cf6 = 'DEALS'\n                     AND (\n\n                              (\n                                    9d311d2a1a94ef273657eec6fb11339f.70e1c5a02e931a9432af1b4b607d2d39 = 'ORDER DATE'\n                                AND de459e2fe7f96e4d958537b31b946b26.c437d55d53d88d02ce92bdadaefd8483.d07269fd715528545216b1ab9353756e BETWEEN 9d311d2a1a94ef273657eec6fb11339f.2fc53cb1d7b378da3f908e285bfa7f5e AND 9d311d2a1a94ef273657eec6fb11339f.248bb7c9e01b8c5f62ab69655707dfa2\n                              )\n\n\n                            OR\n                              (     (9d311d2a1a94ef273657eec6fb11339f.70e1c5a02e931a9432af1b4b607d2d39 = 'REQUESTED DELIVERY DATE' OR 9d311d2a1a94ef273657eec6fb11339f.70e1c5a02e931a9432af1b4b607d2d39='SCHEDULED DELIVERY DATE')\n                                AND  de459e2fe7f96e4d958537b31b946b26.c437d55d53d88d02ce92bdadaefd8483.ce5f82a5e75938dfa35b47989ed3591a BETWEEN 9d311d2a1a94ef273657eec6fb11339f.2fc53cb1d7b378da3f908e285bfa7f5e AND 9d311d2a1a94ef273657eec6fb11339f.248bb7c9e01b8c5f62ab69655707dfa2\n                              )\n\n                            OR (  9d311d2a1a94ef273657eec6fb11339f.70e1c5a02e931a9432af1b4b607d2d39 = 'SHIP DATE'\n                                  AND NVL(de459e2fe7f96e4d958537b31b946b26.c437d55d53d88d02ce92bdadaefd8483.42c0b18f63bab531d16dabbe001c662d, NVL(de459e2fe7f96e4d958537b31b946b26.c437d55d53d88d02ce92bdadaefd8483.75274b7e794ec4ac03e63646e000c70b, de459e2fe7f96e4d958537b31b946b26.c437d55d53d88d02ce92bdadaefd8483.d07269fd715528545216b1ab9353756e + v_reval_ship_dt_null_days))\n                                      BETWEEN 9d311d2a1a94ef273657eec6fb11339f.2fc53cb1d7b378da3f908e285bfa7f5e AND 9d311d2a1a94ef273657eec6fb11339f.248bb7c9e01b8c5f62ab69655707dfa2\n                                )\n                         )  \n\n                   WHERE\n                         9d311d2a1a94ef273657eec6fb11339f.223b465d99ce0b2ddf59cb7c68e88cf6 = 'DEALS'\n                     AND 9d311d2a1a94ef273657eec6fb11339f.3ad9e70cf16862b1ecd4e1a0ecde3783 IS NULL\n                     AND NVL(9d311d2a1a94ef273657eec6fb11339f.c268e49ad49183f154b1ef1ec3d2f7c9,'N') = 'N'\n                     AND v_odate <= 9d311d2a1a94ef273657eec6fb11339f.248bb7c9e01b8c5f62ab69655707dfa2\n                     AND de459e2fe7f96e4d958537b31b946b26.c437d55d53d88d02ce92bdadaefd8483.e7cabb8cf7b3db25086b2c8c7fe3a76e <> 0\n                     group by 9d311d2a1a94ef273657eec6fb11339f.839c4ffb4bfaae1bb58eab4dee67d96a, 9d311d2a1a94ef273657eec6fb11339f.2d45d761eb8d137835bca7a23010fab4, 9d311d2a1a94ef273657eec6fb11339f.248bb7c9e01b8c5f62ab69655707dfa2, 9d311d2a1a94ef273657eec6fb11339f.1d3f35cf8fe3d610d6c6d6282b3298f4) po_sub_q\n                   ON  6ab39b60d6f2c33a660123f45c60027a.839c4ffb4bfaae1bb58eab4dee67d96a = f457feb3a7b6b56bd605eb69c2f5070f.839c4ffb4bfaae1bb58eab4dee67d96a\n                       AND 6ab39b60d6f2c33a660123f45c60027a.2d45d761eb8d137835bca7a23010fab4 = f457feb3a7b6b56bd605eb69c2f5070f.2d45d761eb8d137835bca7a23010fab4\n                       AND 6ab39b60d6f2c33a660123f45c60027a.248bb7c9e01b8c5f62ab69655707dfa2 = f457feb3a7b6b56bd605eb69c2f5070f.248bb7c9e01b8c5f62ab69655707dfa2\n                       AND 6ab39b60d6f2c33a660123f45c60027a.1d3f35cf8fe3d610d6c6d6282b3298f4 = f457feb3a7b6b56bd605eb69c2f5070f.1d3f35cf8fe3d610d6c6d6282b3298f4\n          )\n\n\n\n         SELECT\n            de459e2fe7f96e4d958537b31b946b26.3ac217a6e67d8f0b8bacb7eae897ec01.797aa00fde2c4463b39b877aaafc02c4,\n            de459e2fe7f96e4d958537b31b946b26.3ac217a6e67d8f0b8bacb7eae897ec01.248bb7c9e01b8c5f62ab69655707dfa2,\n            de459e2fe7f96e4d958537b31b946b26.3ac217a6e67d8f0b8bacb7eae897ec01.1d3f35cf8fe3d610d6c6d6282b3298f4,\n            de459e2fe7f96e4d958537b31b946b26.3ac217a6e67d8f0b8bacb7eae897ec01.839c4ffb4bfaae1bb58eab4dee67d96a,\n            de459e2fe7f96e4d958537b31b946b26.3ac217a6e67d8f0b8bacb7eae897ec01.2d45d761eb8d137835bca7a23010fab4,\n            de459e2fe7f96e4d958537b31b946b26.3ac217a6e67d8f0b8bacb7eae897ec01.05ed0e689d0d34553df094a9d844af43,\n            de459e2fe7f96e4d958537b31b946b26.3ac217a6e67d8f0b8bacb7eae897ec01.767a12a4059ce9b909a43d6b5acd0e63,\n            NVL(de459e2fe7f96e4d958537b31b946b26.c50b6339218f0dbbd97ce6557f2b051f.d3268eabc4a7d98105fd85f9c9e62cd6e32ad436514bbe822b33de8bead744f3, de459e2fe7f96e4d958537b31b946b26.3ac217a6e67d8f0b8bacb7eae897ec01.d3268eabc4a7d98105fd85f9c9e62cd6e32ad436514bbe822b33de8bead744f3) pim_usf_std_prod_cd,\n            de459e2fe7f96e4d958537b31b946b26.3ac217a6e67d8f0b8bacb7eae897ec01.4b398d884e397727aeb50b1bf2299e607e8fe841f8abc0a126967273be28f1b7,\n            de459e2fe7f96e4d958537b31b946b26.3ac217a6e67d8f0b8bacb7eae897ec01.4d3b33d66904d5ffa39649a349208691,\n            de459e2fe7f96e4d958537b31b946b26.3ac217a6e67d8f0b8bacb7eae897ec01.c12c7470f293124fcb9f5dba9107a6b9,\n            de459e2fe7f96e4d958537b31b946b26.3ac217a6e67d8f0b8bacb7eae897ec01.30eab1f0725f604622300238e22d79831495a070b2c37631a8b62c73a8b1f10c,\n            NVL(de459e2fe7f96e4d958537b31b946b26.3ac217a6e67d8f0b8bacb7eae897ec01.c268e49ad49183f154b1ef1ec3d2f7c9,'N') fwb_frz_ind,\n\n            CASE\n            WHEN NVL(a8b084beee2f471520333b3b2e79c7fc.e0b90cffaad9c3cb9c25d00826e70aac, 'NO PO') = 'PO_CORP' AND NVL(de459e2fe7f96e4d958537b31b946b26.eac6c5720db4ee5d1e021b3e4897ab18b1d0675b3f48a02abdfe73ad782b3146.2d45d761eb8d137835bca7a23010fab4, 'NO ROW') <> 'NO ROW'\n               THEN TRUNC(SYSDATE)\n            ELSE de459e2fe7f96e4d958537b31b946b26.3ac217a6e67d8f0b8bacb7eae897ec01.ac509ef677b8bd5eb1dc623b4125a53de32f6dd38f333cde68119d1f277367cd\n            END fwb_last_updt_dt,\n\n\n            CASE\n                WHEN de459e2fe7f96e4d958537b31b946b26.3ac217a6e67d8f0b8bacb7eae897ec01.223b465d99ce0b2ddf59cb7c68e88cf6 = 'DEALS'\n                   THEN NVL(71d4a70309e0170f9105c48d104ffa1f.19303c1f19e2797c3ce68f27e3fe51c7f0b50ea96f7fef3c9e84fed1968e8147,NVL(de459e2fe7f96e4d958537b31b946b26.3ac217a6e67d8f0b8bacb7eae897ec01.19303c1f19e2797c3ce68f27e3fe51c7f0b50ea96f7fef3c9e84fed1968e8147,0))\n            ELSE NVL(de459e2fe7f96e4d958537b31b946b26.eac6c5720db4ee5d1e021b3e4897ab18b1d0675b3f48a02abdfe73ad782b3146.19303c1f19e2797c3ce68f27e3fe51c7f0b50ea96f7fef3c9e84fed1968e8147,0)\n            END fwb_crnt_cnfrm_opn_ord_qty ,\n\n            CASE\n                WHEN de459e2fe7f96e4d958537b31b946b26.3ac217a6e67d8f0b8bacb7eae897ec01.223b465d99ce0b2ddf59cb7c68e88cf6 = 'DEALS'\n                   THEN NVL(71d4a70309e0170f9105c48d104ffa1f.045f5a67635dd6df5b1cd25c92e8a68874c8e31994492430a932cedb572e8acf,NVL(de459e2fe7f96e4d958537b31b946b26.3ac217a6e67d8f0b8bacb7eae897ec01.045f5a67635dd6df5b1cd25c92e8a68874c8e31994492430a932cedb572e8acf,0))\n            ELSE NVL(de459e2fe7f96e4d958537b31b946b26.eac6c5720db4ee5d1e021b3e4897ab18b1d0675b3f48a02abdfe73ad782b3146.045f5a67635dd6df5b1cd25c92e8a68874c8e31994492430a932cedb572e8acf,0)\n            END fwb_crnt_opn_on_ord_qty ,\n\n\n        \n            CASE\n                WHEN de459e2fe7f96e4d958537b31b946b26.3ac217a6e67d8f0b8bacb7eae897ec01.223b465d99ce0b2ddf59cb7c68e88cf6 = 'DEALS'\n                   THEN NVL(71d4a70309e0170f9105c48d104ffa1f.2117edd80dd5990f80d44c271c5b87a2a3ccc966d8f287c72c0a9f16f7eb69ed, NVL(de459e2fe7f96e4d958537b31b946b26.3ac217a6e67d8f0b8bacb7eae897ec01.2117edd80dd5990f80d44c271c5b87a2a3ccc966d8f287c72c0a9f16f7eb69ed,0))\n            ELSE\n                    CASE\n                      WHEN NVL(de459e2fe7f96e4d958537b31b946b26.eac6c5720db4ee5d1e021b3e4897ab18b1d0675b3f48a02abdfe73ad782b3146.ea1e206f2f9356e0cd6bec1819aa2f43,0) - NVL(de459e2fe7f96e4d958537b31b946b26.eac6c5720db4ee5d1e021b3e4897ab18b1d0675b3f48a02abdfe73ad782b3146.b2d39ff00f39461acb8d29d3acb61b7b,0) < 0\n                        THEN 0\n                      ELSE NVL(de459e2fe7f96e4d958537b31b946b26.eac6c5720db4ee5d1e021b3e4897ab18b1d0675b3f48a02abdfe73ad782b3146.ea1e206f2f9356e0cd6bec1819aa2f43,0) - NVL(de459e2fe7f96e4d958537b31b946b26.eac6c5720db4ee5d1e021b3e4897ab18b1d0675b3f48a02abdfe73ad782b3146.b2d39ff00f39461acb8d29d3acb61b7b,0)\n                    END\n           END fwb_crnt_on_hnd_net_qty,\n\n\n        \n            CASE\n                WHEN de459e2fe7f96e4d958537b31b946b26.3ac217a6e67d8f0b8bacb7eae897ec01.223b465d99ce0b2ddf59cb7c68e88cf6 = 'DEALS'\n                   THEN\n                    (\n\n                      de459e2fe7f96e4d958537b31b946b26.3ac217a6e67d8f0b8bacb7eae897ec01.7dbd8ab4ca56eb8a94ac73d1ae6d5194e32f6dd38f333cde68119d1f277367cd\n\n                    -\n                      (\n                        NVL(71d4a70309e0170f9105c48d104ffa1f.2117edd80dd5990f80d44c271c5b87a2a3ccc966d8f287c72c0a9f16f7eb69ed,NVL(de459e2fe7f96e4d958537b31b946b26.3ac217a6e67d8f0b8bacb7eae897ec01.2117edd80dd5990f80d44c271c5b87a2a3ccc966d8f287c72c0a9f16f7eb69ed,0)) + NVL(71d4a70309e0170f9105c48d104ffa1f.19303c1f19e2797c3ce68f27e3fe51c7f0b50ea96f7fef3c9e84fed1968e8147,NVL(de459e2fe7f96e4d958537b31b946b26.3ac217a6e67d8f0b8bacb7eae897ec01.19303c1f19e2797c3ce68f27e3fe51c7f0b50ea96f7fef3c9e84fed1968e8147,0))\n                      )\n                    ) * ABS(de459e2fe7f96e4d958537b31b946b26.3ac217a6e67d8f0b8bacb7eae897ec01.05ed0e689d0d34553df094a9d844af43 - de459e2fe7f96e4d958537b31b946b26.3ac217a6e67d8f0b8bacb7eae897ec01.767a12a4059ce9b909a43d6b5acd0e63)\n\n            ELSE\n                    (\n                      (\n                       (NVL(de459e2fe7f96e4d958537b31b946b26.3ac217a6e67d8f0b8bacb7eae897ec01.2583ffd3f02cbf7e0688bce2c6b3aecc,0) - 2) * NVL(de459e2fe7f96e4d958537b31b946b26.3ac217a6e67d8f0b8bacb7eae897ec01.b79152b7d639dcbd8bee57ccf1320cd9128e5fe2ada41a99e9000dd5e6a833ec,0)\n                      )\n                    -\n                      (\n                        NVL(de459e2fe7f96e4d958537b31b946b26.eac6c5720db4ee5d1e021b3e4897ab18b1d0675b3f48a02abdfe73ad782b3146.ea1e206f2f9356e0cd6bec1819aa2f43,0) - NVL(de459e2fe7f96e4d958537b31b946b26.eac6c5720db4ee5d1e021b3e4897ab18b1d0675b3f48a02abdfe73ad782b3146.b2d39ff00f39461acb8d29d3acb61b7b,0) + NVL(de459e2fe7f96e4d958537b31b946b26.eac6c5720db4ee5d1e021b3e4897ab18b1d0675b3f48a02abdfe73ad782b3146.19303c1f19e2797c3ce68f27e3fe51c7f0b50ea96f7fef3c9e84fed1968e8147,0)\n                      )\n                    ) * ABS(de459e2fe7f96e4d958537b31b946b26.3ac217a6e67d8f0b8bacb7eae897ec01.05ed0e689d0d34553df094a9d844af43 - de459e2fe7f96e4d958537b31b946b26.3ac217a6e67d8f0b8bacb7eae897ec01.767a12a4059ce9b909a43d6b5acd0e63)\n            END dlr_remng_amt,\n\n\n        \n            31624cbb78d44c0eddf265fdbafcf907.2e346f2faf648a0d2be0b3298e70b2b6 fwb_trans_typ,\n\n            NVL(\n                  CASE\n                  WHEN 31624cbb78d44c0eddf265fdbafcf907.7d7726baecad658ed918a370a96b679d <> 'COMPLETE' AND 31624cbb78d44c0eddf265fdbafcf907.2e346f2faf648a0d2be0b3298e70b2b6 = 'PO_CORP'\n                       THEN 'FORCED COMPLETE'\n                  ELSE 31624cbb78d44c0eddf265fdbafcf907.7d7726baecad658ed918a370a96b679d\n                  END\n\n                ,'NO PO'\n               )  prod_nbr_po_stat,\n\n            31624cbb78d44c0eddf265fdbafcf907.290db7fdfa44e31ff8eb07cbc62cb5eaf4e0be3842e1025ca02bb1fbbd29e007,\n\n\n        \n            CASE\n              WHEN NVL(44f2ac1131b0a2ab62e41b8d8fcbae4c.ea1e206f2f9356e0cd6bec1819aa2f43,0) - NVL(44f2ac1131b0a2ab62e41b8d8fcbae4c.b2d39ff00f39461acb8d29d3acb61b7b,0) > 0\n                THEN NVL(44f2ac1131b0a2ab62e41b8d8fcbae4c.ea1e206f2f9356e0cd6bec1819aa2f43,0) - NVL(44f2ac1131b0a2ab62e41b8d8fcbae4c.b2d39ff00f39461acb8d29d3acb61b7b,0)\n              ELSE 0\n            END  received_crnt_on_hnd_net_qty,\n\n\n        \n             CASE\n               WHEN 31624cbb78d44c0eddf265fdbafcf907.2e346f2faf648a0d2be0b3298e70b2b6 = 'PO_CORP' AND (NVL(44f2ac1131b0a2ab62e41b8d8fcbae4c.ea1e206f2f9356e0cd6bec1819aa2f43,0) - NVL(44f2ac1131b0a2ab62e41b8d8fcbae4c.b2d39ff00f39461acb8d29d3acb61b7b,0)) > 0\n                 THEN (NVL(44f2ac1131b0a2ab62e41b8d8fcbae4c.ea1e206f2f9356e0cd6bec1819aa2f43,0) - NVL(44f2ac1131b0a2ab62e41b8d8fcbae4c.b2d39ff00f39461acb8d29d3acb61b7b,0)) * ABS(de459e2fe7f96e4d958537b31b946b26.3ac217a6e67d8f0b8bacb7eae897ec01.05ed0e689d0d34553df094a9d844af43 - de459e2fe7f96e4d958537b31b946b26.3ac217a6e67d8f0b8bacb7eae897ec01.767a12a4059ce9b909a43d6b5acd0e63)\n               WHEN de459e2fe7f96e4d958537b31b946b26.3ac217a6e67d8f0b8bacb7eae897ec01.223b465d99ce0b2ddf59cb7c68e88cf6 = 'DEALS'\n                 THEN (  NVL(71d4a70309e0170f9105c48d104ffa1f.2117edd80dd5990f80d44c271c5b87a2a3ccc966d8f287c72c0a9f16f7eb69ed   ,NVL(de459e2fe7f96e4d958537b31b946b26.3ac217a6e67d8f0b8bacb7eae897ec01.2117edd80dd5990f80d44c271c5b87a2a3ccc966d8f287c72c0a9f16f7eb69ed   ,0))\n                       + NVL(71d4a70309e0170f9105c48d104ffa1f.19303c1f19e2797c3ce68f27e3fe51c7f0b50ea96f7fef3c9e84fed1968e8147,NVL(de459e2fe7f96e4d958537b31b946b26.3ac217a6e67d8f0b8bacb7eae897ec01.19303c1f19e2797c3ce68f27e3fe51c7f0b50ea96f7fef3c9e84fed1968e8147,0))\n                      )  * ABS(de459e2fe7f96e4d958537b31b946b26.3ac217a6e67d8f0b8bacb7eae897ec01.05ed0e689d0d34553df094a9d844af43 - de459e2fe7f96e4d958537b31b946b26.3ac217a6e67d8f0b8bacb7eae897ec01.767a12a4059ce9b909a43d6b5acd0e63)\n             ELSE NVL(de459e2fe7f96e4d958537b31b946b26.3ac217a6e67d8f0b8bacb7eae897ec01.4ffc57bd2c8444946072fd06c730adaa,0)\n             END captd_amt,\n\n\n        \n            CASE\n             WHEN de459e2fe7f96e4d958537b31b946b26.3ac217a6e67d8f0b8bacb7eae897ec01.223b465d99ce0b2ddf59cb7c68e88cf6 = 'DEALS'\n                THEN 'Y'\n             WHEN 31624cbb78d44c0eddf265fdbafcf907.2e346f2faf648a0d2be0b3298e70b2b6 = 'PO_CORP'\n                THEN 'Y'\n             ELSE 'N'\n            END fwb_invnty_gain_ind\n\n         FROM\n              de459e2fe7f96e4d958537b31b946b26.3ac217a6e67d8f0b8bacb7eae897ec01 mdl\n\n              JOIN de459e2fe7f96e4d958537b31b946b26.c50b6339218f0dbbd97ce6557f2b051f prod\n                ON de459e2fe7f96e4d958537b31b946b26.3ac217a6e67d8f0b8bacb7eae897ec01.839c4ffb4bfaae1bb58eab4dee67d96a = de459e2fe7f96e4d958537b31b946b26.c50b6339218f0dbbd97ce6557f2b051f.839c4ffb4bfaae1bb58eab4dee67d96a\n               AND de459e2fe7f96e4d958537b31b946b26.3ac217a6e67d8f0b8bacb7eae897ec01.2d45d761eb8d137835bca7a23010fab4 = de459e2fe7f96e4d958537b31b946b26.c50b6339218f0dbbd97ce6557f2b051f.2d45d761eb8d137835bca7a23010fab4\n\n              LEFT OUTER JOIN de459e2fe7f96e4d958537b31b946b26.eac6c5720db4ee5d1e021b3e4897ab18b1d0675b3f48a02abdfe73ad782b3146 inv\n                ON de459e2fe7f96e4d958537b31b946b26.3ac217a6e67d8f0b8bacb7eae897ec01.839c4ffb4bfaae1bb58eab4dee67d96a = de459e2fe7f96e4d958537b31b946b26.eac6c5720db4ee5d1e021b3e4897ab18b1d0675b3f48a02abdfe73ad782b3146.839c4ffb4bfaae1bb58eab4dee67d96a\n               AND de459e2fe7f96e4d958537b31b946b26.3ac217a6e67d8f0b8bacb7eae897ec01.2d45d761eb8d137835bca7a23010fab4 = de459e2fe7f96e4d958537b31b946b26.eac6c5720db4ee5d1e021b3e4897ab18b1d0675b3f48a02abdfe73ad782b3146.2d45d761eb8d137835bca7a23010fab4\n               AND(\n                        ( v_odate <= de459e2fe7f96e4d958537b31b946b26.3ac217a6e67d8f0b8bacb7eae897ec01.248bb7c9e01b8c5f62ab69655707dfa2\n                          AND de459e2fe7f96e4d958537b31b946b26.eac6c5720db4ee5d1e021b3e4897ab18b1d0675b3f48a02abdfe73ad782b3146.7ad1a6b03d18e90d77effe5558f7194b = v_odate\n                        )\n                    OR\n                        ( v_odate > de459e2fe7f96e4d958537b31b946b26.3ac217a6e67d8f0b8bacb7eae897ec01.248bb7c9e01b8c5f62ab69655707dfa2\n                           AND de459e2fe7f96e4d958537b31b946b26.eac6c5720db4ee5d1e021b3e4897ab18b1d0675b3f48a02abdfe73ad782b3146.7ad1a6b03d18e90d77effe5558f7194b = de459e2fe7f96e4d958537b31b946b26.3ac217a6e67d8f0b8bacb7eae897ec01.248bb7c9e01b8c5f62ab69655707dfa2\n                        )\n                  )\n\n              JOIN de459e2fe7f96e4d958537b31b946b26.0b3320d3f985cd20d1ec65d9dfeed2de fstat\n                ON de459e2fe7f96e4d958537b31b946b26.3ac217a6e67d8f0b8bacb7eae897ec01.839c4ffb4bfaae1bb58eab4dee67d96a = a8b084beee2f471520333b3b2e79c7fc.839c4ffb4bfaae1bb58eab4dee67d96a\n               AND a8b084beee2f471520333b3b2e79c7fc.e0b90cffaad9c3cb9c25d00826e70aac = 'PO_CORP'\n               AND a8b084beee2f471520333b3b2e79c7fc.b90da9a94c2b509f039383aa5f9015bc = 'RG'\n               AND a8b084beee2f471520333b3b2e79c7fc.f8600be772743ca3722276946bfd8437 = v_odate\n               AND a8b084beee2f471520333b3b2e79c7fc.2035d739dc489843c15afb7ce4647338 > 0\n\n            \n\n            LEFT OUTER JOIN\n            (\n\n                         SELECT\n                            6fe4d1531feb152f4babd55324ebd809.797aa00fde2c4463b39b877aaafc02c4  b_eff_dt,\n                            6fe4d1531feb152f4babd55324ebd809.1d3f35cf8fe3d610d6c6d6282b3298f4 b_fwb_cyc_id,\n                            6fe4d1531feb152f4babd55324ebd809.973be3d7016c197bb40ff85635227e9c b_fwb_trans_typ,\n                            6fe4d1531feb152f4babd55324ebd809.839c4ffb4bfaae1bb58eab4dee67d96a   b_div_nbr,\n                            6fe4d1531feb152f4babd55324ebd809.2d45d761eb8d137835bca7a23010fab4 b_prod_nbr,\n                            6fe4d1531feb152f4babd55324ebd809.a092beea83145614a13636d6603bbdd0  b_stat,\n                            6fe4d1531feb152f4babd55324ebd809.dd8af598a52a324fb25de25797fac36758287018733bb458df70a60742ba18bf b_day_before_received,\n                            6fe4d1531feb152f4babd55324ebd809.5ee08175d6df03a5fefc28ccb4597455 b_rn\n                         FROM\n                         (\n                              SELECT\n                                    de459e2fe7f96e4d958537b31b946b26.b6f8651287e7789be91157a4c0e5d70e.1d3f35cf8fe3d610d6c6d6282b3298f4,\n                                    de459e2fe7f96e4d958537b31b946b26.b6f8651287e7789be91157a4c0e5d70e.973be3d7016c197bb40ff85635227e9c,\n                                    de459e2fe7f96e4d958537b31b946b26.b6f8651287e7789be91157a4c0e5d70e.839c4ffb4bfaae1bb58eab4dee67d96a,\n                                    de459e2fe7f96e4d958537b31b946b26.b6f8651287e7789be91157a4c0e5d70e.2d45d761eb8d137835bca7a23010fab4,\n                                    de459e2fe7f96e4d958537b31b946b26.b6f8651287e7789be91157a4c0e5d70e.797aa00fde2c4463b39b877aaafc02c4,\n\n                                    CASE\n                                        WHEN (de459e2fe7f96e4d958537b31b946b26.b6f8651287e7789be91157a4c0e5d70e.a092beea83145614a13636d6603bbdd0 = 'COMPLETE' and de459e2fe7f96e4d958537b31b946b26.b6f8651287e7789be91157a4c0e5d70e.ebc0eb2fb6cae4576182f60543ae6b81 = 'Y')\n                                           THEN 'COMPLETE'\n                                    ELSE 'INCOMPLETE'\n                                    END po_stat,\n\n                                    CASE\n                                        WHEN de459e2fe7f96e4d958537b31b946b26.b6f8651287e7789be91157a4c0e5d70e.f615ecd2ca40369e5e4ba91a26cf8dfa = TO_DATE('01-JAN-1900', 'dd-mon-yyyy')\n                                            THEN TO_DATE('01-JAN-1900', 'dd-mon-yyyy')\n                                        ELSE de459e2fe7f96e4d958537b31b946b26.b6f8651287e7789be91157a4c0e5d70e.f615ecd2ca40369e5e4ba91a26cf8dfa - 1\n                                    END day_before_received,\n\n                                    row_number() OVER (PARTITION BY de459e2fe7f96e4d958537b31b946b26.b6f8651287e7789be91157a4c0e5d70e.1d3f35cf8fe3d610d6c6d6282b3298f4, de459e2fe7f96e4d958537b31b946b26.b6f8651287e7789be91157a4c0e5d70e.839c4ffb4bfaae1bb58eab4dee67d96a, de459e2fe7f96e4d958537b31b946b26.b6f8651287e7789be91157a4c0e5d70e.2d45d761eb8d137835bca7a23010fab4\n                                                       ORDER BY de459e2fe7f96e4d958537b31b946b26.b6f8651287e7789be91157a4c0e5d70e.973be3d7016c197bb40ff85635227e9c DESC, de459e2fe7f96e4d958537b31b946b26.b6f8651287e7789be91157a4c0e5d70e.a092beea83145614a13636d6603bbdd0 asc\n                                                       )  RN\n\n                               FROM de459e2fe7f96e4d958537b31b946b26.b6f8651287e7789be91157a4c0e5d70e fmb\n                          ) brg\n\n                          WHERE 6fe4d1531feb152f4babd55324ebd809.5ee08175d6df03a5fefc28ccb4597455=1\n             ) b\n\n              ON de459e2fe7f96e4d958537b31b946b26.3ac217a6e67d8f0b8bacb7eae897ec01.839c4ffb4bfaae1bb58eab4dee67d96a = b_div_nbr\n             AND de459e2fe7f96e4d958537b31b946b26.3ac217a6e67d8f0b8bacb7eae897ec01.2d45d761eb8d137835bca7a23010fab4 = b_prod_nbr\n             AND de459e2fe7f96e4d958537b31b946b26.3ac217a6e67d8f0b8bacb7eae897ec01.1d3f35cf8fe3d610d6c6d6282b3298f4 = b_fwb_cyc_id\n             AND de459e2fe7f96e4d958537b31b946b26.3ac217a6e67d8f0b8bacb7eae897ec01.797aa00fde2c4463b39b877aaafc02c4 = b_eff_dt\n             AND de459e2fe7f96e4d958537b31b946b26.3ac217a6e67d8f0b8bacb7eae897ec01.223b465d99ce0b2ddf59cb7c68e88cf6 <> 'DEALS'\n\n            LEFT OUTER JOIN de459e2fe7f96e4d958537b31b946b26.eac6c5720db4ee5d1e021b3e4897ab18b1d0675b3f48a02abdfe73ad782b3146 inv_received\n              ON de459e2fe7f96e4d958537b31b946b26.3ac217a6e67d8f0b8bacb7eae897ec01.839c4ffb4bfaae1bb58eab4dee67d96a = 44f2ac1131b0a2ab62e41b8d8fcbae4c.839c4ffb4bfaae1bb58eab4dee67d96a\n             AND de459e2fe7f96e4d958537b31b946b26.3ac217a6e67d8f0b8bacb7eae897ec01.2d45d761eb8d137835bca7a23010fab4 = 44f2ac1131b0a2ab62e41b8d8fcbae4c.2d45d761eb8d137835bca7a23010fab4\n             AND 44f2ac1131b0a2ab62e41b8d8fcbae4c.7ad1a6b03d18e90d77effe5558f7194b = 31624cbb78d44c0eddf265fdbafcf907.290db7fdfa44e31ff8eb07cbc62cb5eaf4e0be3842e1025ca02bb1fbbd29e007\n\n            \n            LEFT OUTER JOIN inv_deals\n              ON de459e2fe7f96e4d958537b31b946b26.3ac217a6e67d8f0b8bacb7eae897ec01.839c4ffb4bfaae1bb58eab4dee67d96a = 71d4a70309e0170f9105c48d104ffa1f.839c4ffb4bfaae1bb58eab4dee67d96a\n             AND de459e2fe7f96e4d958537b31b946b26.3ac217a6e67d8f0b8bacb7eae897ec01.2d45d761eb8d137835bca7a23010fab4 = 71d4a70309e0170f9105c48d104ffa1f.2d45d761eb8d137835bca7a23010fab4\n             AND de459e2fe7f96e4d958537b31b946b26.3ac217a6e67d8f0b8bacb7eae897ec01.248bb7c9e01b8c5f62ab69655707dfa2 = 71d4a70309e0170f9105c48d104ffa1f.248bb7c9e01b8c5f62ab69655707dfa2\n             AND de459e2fe7f96e4d958537b31b946b26.3ac217a6e67d8f0b8bacb7eae897ec01.1d3f35cf8fe3d610d6c6d6282b3298f4 = 71d4a70309e0170f9105c48d104ffa1f.1d3f35cf8fe3d610d6c6d6282b3298f4\n             AND v_odate <= de459e2fe7f96e4d958537b31b946b26.3ac217a6e67d8f0b8bacb7eae897ec01.248bb7c9e01b8c5f62ab69655707dfa2\n             AND de459e2fe7f96e4d958537b31b946b26.3ac217a6e67d8f0b8bacb7eae897ec01.223b465d99ce0b2ddf59cb7c68e88cf6 = 'DEALS'\n\n         WHERE de459e2fe7f96e4d958537b31b946b26.3ac217a6e67d8f0b8bacb7eae897ec01.3ad9e70cf16862b1ecd4e1a0ecde3783 IS NULL\n           AND de459e2fe7f96e4d958537b31b946b26.3ac217a6e67d8f0b8bacb7eae897ec01.223b465d99ce0b2ddf59cb7c68e88cf6 IN ('MONTHLY', 'DEALS')\n           AND NVL(de459e2fe7f96e4d958537b31b946b26.3ac217a6e67d8f0b8bacb7eae897ec01.c268e49ad49183f154b1ef1ec3d2f7c9,'N') = 'N'\n\n           AND (   NVL(de459e2fe7f96e4d958537b31b946b26.3ac217a6e67d8f0b8bacb7eae897ec01.5876993502d1c980263ca75dd0bafd7ade922b42cda877bb335f20b7c10e0802,'N') = 'N'\n                OR de459e2fe7f96e4d958537b31b946b26.3ac217a6e67d8f0b8bacb7eae897ec01.223b465d99ce0b2ddf59cb7c68e88cf6 = 'DEALS'\n               )\n\n        )\n\n\n\n    LOOP\n\n        BEGIN\n\n             \n             2fb0b353c59b2ad75ec5c61ececb5059.839c4ffb4bfaae1bb58eab4dee67d96a := cd33ee98588e98f05943b0411453f813.839c4ffb4bfaae1bb58eab4dee67d96a;\n             2fb0b353c59b2ad75ec5c61ececb5059.2d45d761eb8d137835bca7a23010fab4 := cd33ee98588e98f05943b0411453f813.2d45d761eb8d137835bca7a23010fab4;\n             2fb0b353c59b2ad75ec5c61ececb5059.1d3f35cf8fe3d610d6c6d6282b3298f4 := cd33ee98588e98f05943b0411453f813.1d3f35cf8fe3d610d6c6d6282b3298f4;\n             2fb0b353c59b2ad75ec5c61ececb5059.797aa00fde2c4463b39b877aaafc02c4 := cd33ee98588e98f05943b0411453f813.797aa00fde2c4463b39b877aaafc02c4;\n             2fb0b353c59b2ad75ec5c61ececb5059.248bb7c9e01b8c5f62ab69655707dfa2 := cd33ee98588e98f05943b0411453f813.248bb7c9e01b8c5f62ab69655707dfa2;\n\n             \n             2fb0b353c59b2ad75ec5c61ececb5059.d3268eabc4a7d98105fd85f9c9e62cd6e32ad436514bbe822b33de8bead744f3 := cd33ee98588e98f05943b0411453f813.d3268eabc4a7d98105fd85f9c9e62cd6e32ad436514bbe822b33de8bead744f3;\n             2fb0b353c59b2ad75ec5c61ececb5059.4b398d884e397727aeb50b1bf2299e607e8fe841f8abc0a126967273be28f1b7 := cd33ee98588e98f05943b0411453f813.4b398d884e397727aeb50b1bf2299e607e8fe841f8abc0a126967273be28f1b7;\n\n             \n             2fb0b353c59b2ad75ec5c61ececb5059.5876993502d1c980263ca75dd0bafd7ade922b42cda877bb335f20b7c10e0802 := cd33ee98588e98f05943b0411453f813.5876993502d1c980263ca75dd0bafd7ade922b42cda877bb335f20b7c10e0802;\n             2fb0b353c59b2ad75ec5c61ececb5059.b6a6ef53e1a4aaad28e23468251a5a75e32f6dd38f333cde68119d1f277367cd := cd33ee98588e98f05943b0411453f813.b6a6ef53e1a4aaad28e23468251a5a75e32f6dd38f333cde68119d1f277367cd;\n             2fb0b353c59b2ad75ec5c61ececb5059.ac509ef677b8bd5eb1dc623b4125a53de32f6dd38f333cde68119d1f277367cd := cd33ee98588e98f05943b0411453f813.ac509ef677b8bd5eb1dc623b4125a53de32f6dd38f333cde68119d1f277367cd;\n\n             \n             2fb0b353c59b2ad75ec5c61ececb5059.19303c1f19e2797c3ce68f27e3fe51c7f0b50ea96f7fef3c9e84fed1968e8147 := cd33ee98588e98f05943b0411453f813.19303c1f19e2797c3ce68f27e3fe51c7f0b50ea96f7fef3c9e84fed1968e8147;\n             2fb0b353c59b2ad75ec5c61ececb5059.045f5a67635dd6df5b1cd25c92e8a68874c8e31994492430a932cedb572e8acf := cd33ee98588e98f05943b0411453f813.045f5a67635dd6df5b1cd25c92e8a68874c8e31994492430a932cedb572e8acf;\n             2fb0b353c59b2ad75ec5c61ececb5059.2117edd80dd5990f80d44c271c5b87a2a3ccc966d8f287c72c0a9f16f7eb69ed := cd33ee98588e98f05943b0411453f813.2117edd80dd5990f80d44c271c5b87a2a3ccc966d8f287c72c0a9f16f7eb69ed;\n             2fb0b353c59b2ad75ec5c61ececb5059.4ffc57bd2c8444946072fd06c730adaa := cd33ee98588e98f05943b0411453f813.4ffc57bd2c8444946072fd06c730adaa;\n\n             IF ( cd33ee98588e98f05943b0411453f813.05d54d126f3531573b397b4caec67fcb < 0 )\n             THEN\n                 2fb0b353c59b2ad75ec5c61ececb5059.05d54d126f3531573b397b4caec67fcb := 0;\n             ELSE\n                 2fb0b353c59b2ad75ec5c61ececb5059.05d54d126f3531573b397b4caec67fcb := cd33ee98588e98f05943b0411453f813.05d54d126f3531573b397b4caec67fcb;\n             END IF;\n\n\n            \n\n\n\n             \n\n\n             IF (v_odate <= 2fb0b353c59b2ad75ec5c61ececb5059.248bb7c9e01b8c5f62ab69655707dfa2)\n             THEN\n\n                 v_prcs_stp := 'Updating CALCULATED quantities for a record that has an effective date in the FUTURE';\n\n                 UPDATE de459e2fe7f96e4d958537b31b946b26.3ac217a6e67d8f0b8bacb7eae897ec01\n                 SET\n                      pim_usf_std_prod_cd            = 2fb0b353c59b2ad75ec5c61ececb5059.d3268eabc4a7d98105fd85f9c9e62cd6e32ad436514bbe822b33de8bead744f3\n                     ,fwb_invnty_gain_ind            = 2fb0b353c59b2ad75ec5c61ececb5059.5876993502d1c980263ca75dd0bafd7ade922b42cda877bb335f20b7c10e0802\n                     ,prod_nbr_po_stat               = 2fb0b353c59b2ad75ec5c61ececb5059.b6a6ef53e1a4aaad28e23468251a5a75e32f6dd38f333cde68119d1f277367cd\n                     ,fwb_last_updt_dt               = 2fb0b353c59b2ad75ec5c61ececb5059.ac509ef677b8bd5eb1dc623b4125a53de32f6dd38f333cde68119d1f277367cd\n                     ,fwb_crnt_on_hnd_net_qty        = 2fb0b353c59b2ad75ec5c61ececb5059.2117edd80dd5990f80d44c271c5b87a2a3ccc966d8f287c72c0a9f16f7eb69ed\n                     ,fwb_crnt_cnfrm_opn_ord_qty     = 2fb0b353c59b2ad75ec5c61ececb5059.19303c1f19e2797c3ce68f27e3fe51c7f0b50ea96f7fef3c9e84fed1968e8147\n                     ,fwb_crnt_opn_on_ord_qty        = 2fb0b353c59b2ad75ec5c61ececb5059.045f5a67635dd6df5b1cd25c92e8a68874c8e31994492430a932cedb572e8acf\n                     ,captd_amt                      = 2fb0b353c59b2ad75ec5c61ececb5059.4ffc57bd2c8444946072fd06c730adaa\n                     ,dlr_remng_amt                  = 2fb0b353c59b2ad75ec5c61ececb5059.05d54d126f3531573b397b4caec67fcb\n\n                 WHERE div_nbr = 2fb0b353c59b2ad75ec5c61ececb5059.839c4ffb4bfaae1bb58eab4dee67d96a\n                   AND prod_nbr = 2fb0b353c59b2ad75ec5c61ececb5059.2d45d761eb8d137835bca7a23010fab4\n                   AND fwb_cyc_id = 2fb0b353c59b2ad75ec5c61ececb5059.1d3f35cf8fe3d610d6c6d6282b3298f4\n                   AND build_end_dt = 2fb0b353c59b2ad75ec5c61ececb5059.248bb7c9e01b8c5f62ab69655707dfa2;\n\n                 v_updt_process := 1;\n\n\n\n             ELSIF ( 2fb0b353c59b2ad75ec5c61ececb5059.248bb7c9e01b8c5f62ab69655707dfa2 < v_odate)\n             THEN\n\n                 v_prcs_stp := 'Updating attributes ONLY for records that have effective dates in the PAST';\n\n                 UPDATE de459e2fe7f96e4d958537b31b946b26.3ac217a6e67d8f0b8bacb7eae897ec01\n                 SET\n                      pim_usf_std_prod_cd             = 2fb0b353c59b2ad75ec5c61ececb5059.d3268eabc4a7d98105fd85f9c9e62cd6e32ad436514bbe822b33de8bead744f3\n                     ,fwb_invnty_gain_ind            = 2fb0b353c59b2ad75ec5c61ececb5059.5876993502d1c980263ca75dd0bafd7ade922b42cda877bb335f20b7c10e0802\n                     ,prod_nbr_po_stat               = 2fb0b353c59b2ad75ec5c61ececb5059.b6a6ef53e1a4aaad28e23468251a5a75e32f6dd38f333cde68119d1f277367cd\n                     ,captd_amt                      = 2fb0b353c59b2ad75ec5c61ececb5059.4ffc57bd2c8444946072fd06c730adaa\n                     ,fwb_last_updt_dt               = 2fb0b353c59b2ad75ec5c61ececb5059.ac509ef677b8bd5eb1dc623b4125a53de32f6dd38f333cde68119d1f277367cd\n\n                 WHERE div_nbr = 2fb0b353c59b2ad75ec5c61ececb5059.839c4ffb4bfaae1bb58eab4dee67d96a\n                   AND prod_nbr = 2fb0b353c59b2ad75ec5c61ececb5059.2d45d761eb8d137835bca7a23010fab4\n                   AND fwb_cyc_id = 2fb0b353c59b2ad75ec5c61ececb5059.1d3f35cf8fe3d610d6c6d6282b3298f4\n                   AND build_end_dt = 2fb0b353c59b2ad75ec5c61ececb5059.248bb7c9e01b8c5f62ab69655707dfa2;\n\n                 v_updt_process := 1;\n\n\n             ELSE\n                 v_prcs_stp := 'FWB_MDL Update failed while comparing ODATE and BUILD_END_DT';\n                 dbms_output.put_line(TO_CHAR(SYSDATE,'YYYY-MM-DD HH24:MI:SS     ')||v_prcs_stp);\n                 dbms_output.put_line(TO_CHAR(SYSDATE,'YYYY-MM-DD HH24:MI:SS     ')||'ODATE: '||v_odate);\n                 dbms_output.put_line(TO_CHAR(SYSDATE,'YYYY-MM-DD HH24:MI:SS     ')||'BUILD_END_DT: '||2fb0b353c59b2ad75ec5c61ececb5059.248bb7c9e01b8c5f62ab69655707dfa2);\n                 dbms_output.put_line(TO_CHAR(SYSDATE,'YYYY-MM-DD HH24:MI:SS     ')||'FWB_CYC_ID: '||2fb0b353c59b2ad75ec5c61ececb5059.1d3f35cf8fe3d610d6c6d6282b3298f4);\n\n                 RETURN 1;\n             END IF;\n\n\n             v_cursor_rowcount := v_cursor_rowcount + 1;\n\n        EXCEPTION\n        WHEN OTHERS THEN\n                dbms_output.put_line(TO_CHAR(SYSDATE,'YYYY-MM-DD HH24:MI:SS     ')||'*****GENERAL ERROR!*****');\n                dbms_output.put_line(TO_CHAR(SYSDATE,'YYYY-MM-DD HH24:MI:SS     ')||'ERROR IN STEP:  ' || v_prcs_stp);\n                v_prcs_err_msg:= ' SQLERRM: '||Sqlerrm||' Sqlcode: '||SQLCODE;\n                dbms_output.put_line(TO_CHAR(SYSDATE,'YYYY-MM-DD HH24:MI:SS     ')||'Messages: '||v_prcs_err_msg);\n                dbms_output.put_line(TO_CHAR(SYSDATE,'YYYY-MM-DD HH24:MI:SS     ')||'ODATE: '||v_odate);\n                dbms_output.put_line(TO_CHAR(SYSDATE,'YYYY-MM-DD HH24:MI:SS     ')||'EFF_DT: '||2fb0b353c59b2ad75ec5c61ececb5059.797aa00fde2c4463b39b877aaafc02c4);\n                dbms_output.put_line(TO_CHAR(SYSDATE,'YYYY-MM-DD HH24:MI:SS     ')||'BUILD_END_DT: '||2fb0b353c59b2ad75ec5c61ececb5059.248bb7c9e01b8c5f62ab69655707dfa2);\n                dbms_output.put_line(TO_CHAR(SYSDATE,'YYYY-MM-DD HH24:MI:SS     ')||'FWB_CYC_ID: '||2fb0b353c59b2ad75ec5c61ececb5059.1d3f35cf8fe3d610d6c6d6282b3298f4);\n                dbms_output.put_line(TO_CHAR(SYSDATE,'YYYY-MM-DD HH24:MI:SS     ')||'DIV_NBR: '||2fb0b353c59b2ad75ec5c61ececb5059.839c4ffb4bfaae1bb58eab4dee67d96a);\n                dbms_output.put_line(TO_CHAR(SYSDATE,'YYYY-MM-DD HH24:MI:SS     ')||'PROD_NBR: '||2fb0b353c59b2ad75ec5c61ececb5059.2d45d761eb8d137835bca7a23010fab4);\n                ROLLBACK;\n                RETURN 1;\n        END;\n\n\n    END LOOP;\n\n\n    v_prcs_stp := '     Main cursor found:  '||v_cursor_rowcount||' rows updated';\n    dbms_output.put_line(TO_CHAR(SYSDATE,'YYYY-MM-DD HH24:MI:SS     ')||v_prcs_stp);\n\n\n\n                \n                v_prcs_stp := 'Updating DIV_BY_VNDR_PCT';\n                v_cursor_rowcount := 0;\n\n                MERGE INTO de459e2fe7f96e4d958537b31b946b26.3ac217a6e67d8f0b8bacb7eae897ec01 DEST\n\n                USING\n                (\n                      SELECT\n                          61b148824f103ae3ce61e128cf184253.839c4ffb4bfaae1bb58eab4dee67d96a,\n                          61b148824f103ae3ce61e128cf184253.223b465d99ce0b2ddf59cb7c68e88cf6,\n                          61b148824f103ae3ce61e128cf184253.4d732318d69998c6709a6e5b1b6b8d11,\n                          61b148824f103ae3ce61e128cf184253.0c8615b6a1194ca689867db14aefff5f,\n                          61b148824f103ae3ce61e128cf184253.05d54d126f3531573b397b4caec67fcb,\n                          LAG(61b148824f103ae3ce61e128cf184253.fe3a63f97c7ee09a9a4c9a3cb08008f9, 1, 0 ) over (partition by 61b148824f103ae3ce61e128cf184253.839c4ffb4bfaae1bb58eab4dee67d96a, 61b148824f103ae3ce61e128cf184253.223b465d99ce0b2ddf59cb7c68e88cf6 order by 61b148824f103ae3ce61e128cf184253.05d54d126f3531573b397b4caec67fcb desc) shifted_sum,\n                          qualifier_count\n                      FROM\n\n                        (  SELECT de459e2fe7f96e4d958537b31b946b26.3ac217a6e67d8f0b8bacb7eae897ec01.839c4ffb4bfaae1bb58eab4dee67d96a,\n                                  de459e2fe7f96e4d958537b31b946b26.3ac217a6e67d8f0b8bacb7eae897ec01.223b465d99ce0b2ddf59cb7c68e88cf6,\n                                  de459e2fe7f96e4d958537b31b946b26.3ac217a6e67d8f0b8bacb7eae897ec01.4d732318d69998c6709a6e5b1b6b8d11,\n                                  de459e2fe7f96e4d958537b31b946b26.3ac217a6e67d8f0b8bacb7eae897ec01.05d54d126f3531573b397b4caec67fcb,\n                                  de459e2fe7f96e4d958537b31b946b26.3ac217a6e67d8f0b8bacb7eae897ec01.0c8615b6a1194ca689867db14aefff5f,\n                                  sum(nvl(de459e2fe7f96e4d958537b31b946b26.3ac217a6e67d8f0b8bacb7eae897ec01.05d54d126f3531573b397b4caec67fcb,0)) over (partition by de459e2fe7f96e4d958537b31b946b26.3ac217a6e67d8f0b8bacb7eae897ec01.839c4ffb4bfaae1bb58eab4dee67d96a, de459e2fe7f96e4d958537b31b946b26.3ac217a6e67d8f0b8bacb7eae897ec01.223b465d99ce0b2ddf59cb7c68e88cf6 order by de459e2fe7f96e4d958537b31b946b26.3ac217a6e67d8f0b8bacb7eae897ec01.05d54d126f3531573b397b4caec67fcb desc) running_sum,\n                                  qualifier_count\n                             FROM\n                                  (\n                                  SELECT\n                                      de459e2fe7f96e4d958537b31b946b26.3ac217a6e67d8f0b8bacb7eae897ec01.839c4ffb4bfaae1bb58eab4dee67d96a,\n                                      de459e2fe7f96e4d958537b31b946b26.3ac217a6e67d8f0b8bacb7eae897ec01.223b465d99ce0b2ddf59cb7c68e88cf6,\n                                      de459e2fe7f96e4d958537b31b946b26.3ac217a6e67d8f0b8bacb7eae897ec01.4d732318d69998c6709a6e5b1b6b8d11,\n                                      e3702de335ae9df767f122fdadfd1237.0c8615b6a1194ca689867db14aefff5f,\n                                      SUM(CASE WHEN de459e2fe7f96e4d958537b31b946b26.3ac217a6e67d8f0b8bacb7eae897ec01.5876993502d1c980263ca75dd0bafd7ade922b42cda877bb335f20b7c10e0802 = 'Y' AND de459e2fe7f96e4d958537b31b946b26.3ac217a6e67d8f0b8bacb7eae897ec01.223b465d99ce0b2ddf59cb7c68e88cf6 <> 'DEALS' THEN 0 ELSE de459e2fe7f96e4d958537b31b946b26.3ac217a6e67d8f0b8bacb7eae897ec01.05d54d126f3531573b397b4caec67fcb END) dlr_remng_amt,\n                                      SUM(CASE WHEN de459e2fe7f96e4d958537b31b946b26.3ac217a6e67d8f0b8bacb7eae897ec01.5876993502d1c980263ca75dd0bafd7ade922b42cda877bb335f20b7c10e0802 = 'N' OR de459e2fe7f96e4d958537b31b946b26.3ac217a6e67d8f0b8bacb7eae897ec01.223b465d99ce0b2ddf59cb7c68e88cf6 = 'DEALS' THEN 1 ELSE 0 END) qualifier_count\n                                  FROM de459e2fe7f96e4d958537b31b946b26.3ac217a6e67d8f0b8bacb7eae897ec01 mdl\n\n                                  JOIN\n                                  (\n                                      SELECT\n                                             47d888c646887f9aaa7f579a9b6c31cc.839c4ffb4bfaae1bb58eab4dee67d96a,\n                                             47d888c646887f9aaa7f579a9b6c31cc.223b465d99ce0b2ddf59cb7c68e88cf6,\n                                             SUM(CASE WHEN 47d888c646887f9aaa7f579a9b6c31cc.5876993502d1c980263ca75dd0bafd7ade922b42cda877bb335f20b7c10e0802 = 'Y' AND 47d888c646887f9aaa7f579a9b6c31cc.223b465d99ce0b2ddf59cb7c68e88cf6 <> 'DEALS' THEN 0 ELSE NVL(47d888c646887f9aaa7f579a9b6c31cc.05d54d126f3531573b397b4caec67fcb,0) END) div_ttl\n\n                                        FROM de459e2fe7f96e4d958537b31b946b26.3ac217a6e67d8f0b8bacb7eae897ec01 mdl_totals\n\n                                       WHERE NVL(47d888c646887f9aaa7f579a9b6c31cc.c268e49ad49183f154b1ef1ec3d2f7c9,'N') = 'N'\n                                         AND 47d888c646887f9aaa7f579a9b6c31cc.3ad9e70cf16862b1ecd4e1a0ecde3783 is null\n                                         AND v_odate < 47d888c646887f9aaa7f579a9b6c31cc.248bb7c9e01b8c5f62ab69655707dfa2\n                                         AND 47d888c646887f9aaa7f579a9b6c31cc.223b465d99ce0b2ddf59cb7c68e88cf6 IN ('MONTHLY', 'DEALS')\n\n                                      GROUP BY 47d888c646887f9aaa7f579a9b6c31cc.839c4ffb4bfaae1bb58eab4dee67d96a,\n                                               47d888c646887f9aaa7f579a9b6c31cc.223b465d99ce0b2ddf59cb7c68e88cf6\n                                  ) div_total\n\n                                     ON de459e2fe7f96e4d958537b31b946b26.3ac217a6e67d8f0b8bacb7eae897ec01.839c4ffb4bfaae1bb58eab4dee67d96a = e3702de335ae9df767f122fdadfd1237.839c4ffb4bfaae1bb58eab4dee67d96a\n                                    AND de459e2fe7f96e4d958537b31b946b26.3ac217a6e67d8f0b8bacb7eae897ec01.223b465d99ce0b2ddf59cb7c68e88cf6 = e3702de335ae9df767f122fdadfd1237.223b465d99ce0b2ddf59cb7c68e88cf6\n\n                                  WHERE NVL(de459e2fe7f96e4d958537b31b946b26.3ac217a6e67d8f0b8bacb7eae897ec01.c268e49ad49183f154b1ef1ec3d2f7c9,'N') = 'N'\n                                    AND de459e2fe7f96e4d958537b31b946b26.3ac217a6e67d8f0b8bacb7eae897ec01.3ad9e70cf16862b1ecd4e1a0ecde3783 is null\n                                    AND v_odate < de459e2fe7f96e4d958537b31b946b26.3ac217a6e67d8f0b8bacb7eae897ec01.248bb7c9e01b8c5f62ab69655707dfa2\n\n                                  GROUP BY de459e2fe7f96e4d958537b31b946b26.3ac217a6e67d8f0b8bacb7eae897ec01.839c4ffb4bfaae1bb58eab4dee67d96a, de459e2fe7f96e4d958537b31b946b26.3ac217a6e67d8f0b8bacb7eae897ec01.223b465d99ce0b2ddf59cb7c68e88cf6, de459e2fe7f96e4d958537b31b946b26.3ac217a6e67d8f0b8bacb7eae897ec01.4d732318d69998c6709a6e5b1b6b8d11, e3702de335ae9df767f122fdadfd1237.0c8615b6a1194ca689867db14aefff5f\n                                  ORDER BY de459e2fe7f96e4d958537b31b946b26.3ac217a6e67d8f0b8bacb7eae897ec01.839c4ffb4bfaae1bb58eab4dee67d96a, de459e2fe7f96e4d958537b31b946b26.3ac217a6e67d8f0b8bacb7eae897ec01.223b465d99ce0b2ddf59cb7c68e88cf6, sum(de459e2fe7f96e4d958537b31b946b26.3ac217a6e67d8f0b8bacb7eae897ec01.05d54d126f3531573b397b4caec67fcb) desc\n                                  ) mdl\n                         ) rt\n\n                ) SRC\n\n                on (\n                    31624cbb78d44c0eddf265fdbafcf907.839c4ffb4bfaae1bb58eab4dee67d96a = ebd1f68d6525d85f8f5ef856bb1b9123.839c4ffb4bfaae1bb58eab4dee67d96a\n                AND 31624cbb78d44c0eddf265fdbafcf907.223b465d99ce0b2ddf59cb7c68e88cf6 = ebd1f68d6525d85f8f5ef856bb1b9123.223b465d99ce0b2ddf59cb7c68e88cf6\n                AND 31624cbb78d44c0eddf265fdbafcf907.4d732318d69998c6709a6e5b1b6b8d11= ebd1f68d6525d85f8f5ef856bb1b9123.4d732318d69998c6709a6e5b1b6b8d11\n                AND 31624cbb78d44c0eddf265fdbafcf907.223b465d99ce0b2ddf59cb7c68e88cf6 IN ('MONTHLY', 'DEALS')\n                )\n\n                WHEN MATCHED THEN UPDATE SET\n                ebd1f68d6525d85f8f5ef856bb1b9123.9c32f86fb3474d80966549d99eff4696 = CASE WHEN 31624cbb78d44c0eddf265fdbafcf907.b03b35413ff6adeb522176574fa983b1 = 0 AND ebd1f68d6525d85f8f5ef856bb1b9123.5876993502d1c980263ca75dd0bafd7ade922b42cda877bb335f20b7c10e0802 = 'Y' AND ebd1f68d6525d85f8f5ef856bb1b9123.223b465d99ce0b2ddf59cb7c68e88cf6 <> 'DEALS' THEN 101\n                                       ELSE\n                                            CASE\n                                                WHEN 31624cbb78d44c0eddf265fdbafcf907.0c8615b6a1194ca689867db14aefff5f > 0\n                                                    THEN (31624cbb78d44c0eddf265fdbafcf907.eda9510232e3dae7535805a5618d7063/31624cbb78d44c0eddf265fdbafcf907.0c8615b6a1194ca689867db14aefff5f)*100\n                                                ELSE 0\n                                            END\n                                       END;\n\n\n                v_cursor_rowcount := SQL%ROWCOUNT;\n                v_prcs_stp := '     div_by_vndr_pct:  '||v_cursor_rowcount||' rows updated';\n                dbms_output.put_line(TO_CHAR(SYSDATE,'YYYY-MM-DD HH24:MI:SS     ')||v_prcs_stp);\n\n\n                \n                v_prcs_stp := 'Updating DIV_BY_VNDR_PROD_NBR_PCT';\n                v_cursor_rowcount := 0;\n\n                MERGE INTO de459e2fe7f96e4d958537b31b946b26.3ac217a6e67d8f0b8bacb7eae897ec01 DEST\n\n                USING\n                (\n                        SELECT 61b148824f103ae3ce61e128cf184253.839c4ffb4bfaae1bb58eab4dee67d96a,\n                           61b148824f103ae3ce61e128cf184253.223b465d99ce0b2ddf59cb7c68e88cf6,\n                           61b148824f103ae3ce61e128cf184253.4d732318d69998c6709a6e5b1b6b8d11,\n                           61b148824f103ae3ce61e128cf184253.2d45d761eb8d137835bca7a23010fab4,\n                           61b148824f103ae3ce61e128cf184253.c2408251c566d1d261627b8cfba0458b,\n                           61b148824f103ae3ce61e128cf184253.05d54d126f3531573b397b4caec67fcb,\n                           LAG(61b148824f103ae3ce61e128cf184253.702becd95545b2e24b27b750438e03ac, 1, 0 ) over (partition by 61b148824f103ae3ce61e128cf184253.839c4ffb4bfaae1bb58eab4dee67d96a, 61b148824f103ae3ce61e128cf184253.223b465d99ce0b2ddf59cb7c68e88cf6, 61b148824f103ae3ce61e128cf184253.4d732318d69998c6709a6e5b1b6b8d11 order by 61b148824f103ae3ce61e128cf184253.05d54d126f3531573b397b4caec67fcb desc) shifted_sum\n                        FROM\n\n                          (  SELECT 9435b71ffde1868c033c3e5646ca4366.839c4ffb4bfaae1bb58eab4dee67d96a,\n                                    9435b71ffde1868c033c3e5646ca4366.223b465d99ce0b2ddf59cb7c68e88cf6,\n                                    9435b71ffde1868c033c3e5646ca4366.4d732318d69998c6709a6e5b1b6b8d11,\n                                    9435b71ffde1868c033c3e5646ca4366.2d45d761eb8d137835bca7a23010fab4,\n                                    9435b71ffde1868c033c3e5646ca4366.c2408251c566d1d261627b8cfba0458b,\n                                    9435b71ffde1868c033c3e5646ca4366.05d54d126f3531573b397b4caec67fcb,\n                                    sum(nvl(9435b71ffde1868c033c3e5646ca4366.05d54d126f3531573b397b4caec67fcb,0)) over (partition by 9435b71ffde1868c033c3e5646ca4366.839c4ffb4bfaae1bb58eab4dee67d96a, 9435b71ffde1868c033c3e5646ca4366.223b465d99ce0b2ddf59cb7c68e88cf6, 9435b71ffde1868c033c3e5646ca4366.4d732318d69998c6709a6e5b1b6b8d11 order by 9435b71ffde1868c033c3e5646ca4366.05d54d126f3531573b397b4caec67fcb desc) running_sum\n                               FROM\n                                    (\n                                    SELECT\n                                        9435b71ffde1868c033c3e5646ca4366.839c4ffb4bfaae1bb58eab4dee67d96a,\n                                        9435b71ffde1868c033c3e5646ca4366.223b465d99ce0b2ddf59cb7c68e88cf6,\n                                        9435b71ffde1868c033c3e5646ca4366.4d732318d69998c6709a6e5b1b6b8d11,\n                                        9435b71ffde1868c033c3e5646ca4366.2d45d761eb8d137835bca7a23010fab4,\n                                        a8cb5e0ddda5a29d0172f234006032f6e32f6dd38f333cde68119d1f277367cd.c2408251c566d1d261627b8cfba0458b,\n                                        SUM(9435b71ffde1868c033c3e5646ca4366.05d54d126f3531573b397b4caec67fcb) dlr_remng_amt\n                                    FROM de459e2fe7f96e4d958537b31b946b26.3ac217a6e67d8f0b8bacb7eae897ec01 mdl\n                                    JOIN\n                                       (\n                                        SELECT 47d888c646887f9aaa7f579a9b6c31cc.839c4ffb4bfaae1bb58eab4dee67d96a,\n                                               47d888c646887f9aaa7f579a9b6c31cc.223b465d99ce0b2ddf59cb7c68e88cf6,\n                                               47d888c646887f9aaa7f579a9b6c31cc.4d732318d69998c6709a6e5b1b6b8d11,\n                                               SUM(CASE WHEN 47d888c646887f9aaa7f579a9b6c31cc.5876993502d1c980263ca75dd0bafd7ade922b42cda877bb335f20b7c10e0802 = 'Y' AND 47d888c646887f9aaa7f579a9b6c31cc.223b465d99ce0b2ddf59cb7c68e88cf6 <> 'DEALS' THEN 0 ELSE  NVL(47d888c646887f9aaa7f579a9b6c31cc.05d54d126f3531573b397b4caec67fcb,0) END) div_vndr_ttl\n                                          FROM de459e2fe7f96e4d958537b31b946b26.3ac217a6e67d8f0b8bacb7eae897ec01 mdl_totals\n\n                                         WHERE NVL(47d888c646887f9aaa7f579a9b6c31cc.c268e49ad49183f154b1ef1ec3d2f7c9,'N') = 'N'\n                                           AND 47d888c646887f9aaa7f579a9b6c31cc.3ad9e70cf16862b1ecd4e1a0ecde3783 is null\n                                           AND v_odate < 47d888c646887f9aaa7f579a9b6c31cc.248bb7c9e01b8c5f62ab69655707dfa2\n\n                                        GROUP BY 47d888c646887f9aaa7f579a9b6c31cc.839c4ffb4bfaae1bb58eab4dee67d96a,\n                                                 47d888c646887f9aaa7f579a9b6c31cc.223b465d99ce0b2ddf59cb7c68e88cf6,\n                                                 47d888c646887f9aaa7f579a9b6c31cc.4d732318d69998c6709a6e5b1b6b8d11\n                                       ) div_vendor_total\n\n                                    ON 9435b71ffde1868c033c3e5646ca4366.839c4ffb4bfaae1bb58eab4dee67d96a = a8cb5e0ddda5a29d0172f234006032f6e32f6dd38f333cde68119d1f277367cd.839c4ffb4bfaae1bb58eab4dee67d96a\n                                      AND 9435b71ffde1868c033c3e5646ca4366.4d732318d69998c6709a6e5b1b6b8d11 = a8cb5e0ddda5a29d0172f234006032f6e32f6dd38f333cde68119d1f277367cd.4d732318d69998c6709a6e5b1b6b8d11\n                                      AND 9435b71ffde1868c033c3e5646ca4366.223b465d99ce0b2ddf59cb7c68e88cf6 = a8cb5e0ddda5a29d0172f234006032f6e32f6dd38f333cde68119d1f277367cd.223b465d99ce0b2ddf59cb7c68e88cf6\n\n                                    WHERE NVL(9435b71ffde1868c033c3e5646ca4366.c268e49ad49183f154b1ef1ec3d2f7c9,'N') = 'N'\n                                      AND 9435b71ffde1868c033c3e5646ca4366.3ad9e70cf16862b1ecd4e1a0ecde3783 is null\n                                      AND v_odate < 9435b71ffde1868c033c3e5646ca4366.248bb7c9e01b8c5f62ab69655707dfa2\n\n                                    GROUP BY 9435b71ffde1868c033c3e5646ca4366.839c4ffb4bfaae1bb58eab4dee67d96a, 9435b71ffde1868c033c3e5646ca4366.223b465d99ce0b2ddf59cb7c68e88cf6, 9435b71ffde1868c033c3e5646ca4366.4d732318d69998c6709a6e5b1b6b8d11, 9435b71ffde1868c033c3e5646ca4366.2d45d761eb8d137835bca7a23010fab4, a8cb5e0ddda5a29d0172f234006032f6e32f6dd38f333cde68119d1f277367cd.c2408251c566d1d261627b8cfba0458b\n                                    ORDER BY 9435b71ffde1868c033c3e5646ca4366.839c4ffb4bfaae1bb58eab4dee67d96a, 9435b71ffde1868c033c3e5646ca4366.223b465d99ce0b2ddf59cb7c68e88cf6, 9435b71ffde1868c033c3e5646ca4366.4d732318d69998c6709a6e5b1b6b8d11, sum(9435b71ffde1868c033c3e5646ca4366.05d54d126f3531573b397b4caec67fcb) desc\n                                  ) mdl\n                          ) rt\n\n                ) SRC\n\n                on (\n                    a1fa0f79e78ad884522822d320ab5272.839c4ffb4bfaae1bb58eab4dee67d96a = ebd1f68d6525d85f8f5ef856bb1b9123.839c4ffb4bfaae1bb58eab4dee67d96a\n                AND a1fa0f79e78ad884522822d320ab5272.223b465d99ce0b2ddf59cb7c68e88cf6 = ebd1f68d6525d85f8f5ef856bb1b9123.223b465d99ce0b2ddf59cb7c68e88cf6\n                AND a1fa0f79e78ad884522822d320ab5272.4d732318d69998c6709a6e5b1b6b8d11= ebd1f68d6525d85f8f5ef856bb1b9123.4d732318d69998c6709a6e5b1b6b8d11\n                AND a1fa0f79e78ad884522822d320ab5272.2d45d761eb8d137835bca7a23010fab4= ebd1f68d6525d85f8f5ef856bb1b9123.2d45d761eb8d137835bca7a23010fab4\n                AND a1fa0f79e78ad884522822d320ab5272.223b465d99ce0b2ddf59cb7c68e88cf6 IN ('MONTHLY', 'DEALS')\n                )\n\n                WHEN MATCHED THEN UPDATE SET\n                ebd1f68d6525d85f8f5ef856bb1b9123.b84b333a29f0a55bb4fac4c860cad23e498656bc8ad66311ba393980465dbd28 = CASE WHEN ebd1f68d6525d85f8f5ef856bb1b9123.5876993502d1c980263ca75dd0bafd7ade922b42cda877bb335f20b7c10e0802 = 'Y' AND ebd1f68d6525d85f8f5ef856bb1b9123.223b465d99ce0b2ddf59cb7c68e88cf6 <> 'DEALS' THEN 101\n                                       ELSE\n                                            CASE\n                                                WHEN a1fa0f79e78ad884522822d320ab5272.c2408251c566d1d261627b8cfba0458b > 0\n                                                    THEN (a1fa0f79e78ad884522822d320ab5272.eda9510232e3dae7535805a5618d7063/a1fa0f79e78ad884522822d320ab5272.c2408251c566d1d261627b8cfba0458b)*100\n                                                ELSE 0\n                                            END\n                                       END;\n\n                v_cursor_rowcount := SQL%ROWCOUNT;\n\n                v_prcs_stp := '     div_by_vndr_prod_nbr_pct:  '||v_cursor_rowcount||' rows updated';\n                dbms_output.put_line(TO_CHAR(SYSDATE,'YYYY-MM-DD HH24:MI:SS     ')||v_prcs_stp);\n\n\n\n\n                \n                v_prcs_stp := 'Updating FWB_LAST_UPDT_DT';\n\n                UPDATE de459e2fe7f96e4d958537b31b946b26.3ac217a6e67d8f0b8bacb7eae897ec01\n                SET fwb_last_updt_dt = trunc(SYSDATE)\n                WHERE\n                      div_nbr in\n                               (\n                                SELECT de459e2fe7f96e4d958537b31b946b26.0b3320d3f985cd20d1ec65d9dfeed2de.839c4ffb4bfaae1bb58eab4dee67d96a\n\n                                FROM de459e2fe7f96e4d958537b31b946b26.0b3320d3f985cd20d1ec65d9dfeed2de po\n\n                                JOIN de459e2fe7f96e4d958537b31b946b26.eac6c5720db4ee5d1e021b3e4897ab18b1d0675b3f48a02abdfe73ad782b3146 inv\n                                  ON de459e2fe7f96e4d958537b31b946b26.eac6c5720db4ee5d1e021b3e4897ab18b1d0675b3f48a02abdfe73ad782b3146.839c4ffb4bfaae1bb58eab4dee67d96a = de459e2fe7f96e4d958537b31b946b26.0b3320d3f985cd20d1ec65d9dfeed2de.839c4ffb4bfaae1bb58eab4dee67d96a\n                                 AND de459e2fe7f96e4d958537b31b946b26.eac6c5720db4ee5d1e021b3e4897ab18b1d0675b3f48a02abdfe73ad782b3146.7ad1a6b03d18e90d77effe5558f7194b = v_odate\n\n                               WHERE de459e2fe7f96e4d958537b31b946b26.0b3320d3f985cd20d1ec65d9dfeed2de.e0b90cffaad9c3cb9c25d00826e70aac = 'PO_CORP'\n                                 AND de459e2fe7f96e4d958537b31b946b26.0b3320d3f985cd20d1ec65d9dfeed2de.b90da9a94c2b509f039383aa5f9015bc = 'RG'\n                                 AND de459e2fe7f96e4d958537b31b946b26.0b3320d3f985cd20d1ec65d9dfeed2de.f8600be772743ca3722276946bfd8437 = v_odate\n                                 AND de459e2fe7f96e4d958537b31b946b26.0b3320d3f985cd20d1ec65d9dfeed2de.2035d739dc489843c15afb7ce4647338 > 0\n                               )\n                      and NVL(fwb_frz_ind,'N') = 'N'\n                      AND fwb_cyc_typ IN ('MONTHLY', 'DEALS');\n\n\n                v_cursor_rowcount := SQL%ROWCOUNT;\n\n                v_prcs_stp := '     FWB_LAST_UPDT_DT update complete.  '||v_cursor_rowcount||' rows updated';\n                dbms_output.put_line(TO_CHAR(SYSDATE,'YYYY-MM-DD HH24:MI:SS     ')||v_prcs_stp);\n\n\n\n\n\n\n\n    ELSE\n         IF (p_abort_flg = 'N') THEN\n            NULL;\n            RETURN 0;\n\n         ELSIF ( p_abort_flg = 'Y') THEN\n            \n                dbms_output.put_line(TO_CHAR(SYSDATE,'YYYY-MM-DD HH24:MI:SS     ')||'*****FACT_LOAD CHECK ERROR!*****');\n                dbms_output.put_line(TO_CHAR(SYSDATE,'YYYY-MM-DD HH24:MI:SS     ')||'ERROR IN STEP:  ' || v_prcs_stp);\n                v_prcs_err_msg:= ' SQLERRM: '||Sqlerrm||' Sqlcode: '||SQLCODE;\n                dbms_output.put_line(TO_CHAR(SYSDATE,'YYYY-MM-DD HH24:MI:SS     ')||'Messages: '||v_prcs_err_msg);\n                ROLLBACK;\n                RETURN 1;\n\n        ELSIF ( p_abort_flg is null) THEN\n                dbms_output.put_line(TO_CHAR(SYSDATE,'YYYY-MM-DD HH24:MI:SS     ')||'*****ABORT FLAG PARAMETER ERROR!*****');\n                dbms_output.put_line(TO_CHAR(SYSDATE,'YYYY-MM-DD HH24:MI:SS     ')||'ERROR IN STEP:  ' || v_prcs_stp);\n                v_prcs_err_msg:= ' SQLERRM: '||Sqlerrm||' Sqlcode: '||SQLCODE;\n                dbms_output.put_line(TO_CHAR(SYSDATE,'YYYY-MM-DD HH24:MI:SS     ')||'Messages: '||v_prcs_err_msg);\n                ROLLBACK;\n                RETURN 1;\n\n        END IF;\n\n\n    END IF;\n\n\n    IF (v_updt_process = 0) then\n        dbms_output.put_line(TO_CHAR(SYSDATE,'YYYY-MM-DD HH24:MI:SS     ')||'No records have been processed');\n    END IF;\n\n\n    COMMIT;\n    dbms_output.put_line(TO_CHAR(SYSDATE,'YYYY-MM-DD HH24:MI:SS     ')||'PROCESS COMMITED');\n    RETURN 0;\n\n\n\nEXCEPTION\n\nWHEN no_data_found THEN\n        dbms_output.put_line(TO_CHAR(SYSDATE,'YYYY-MM-DD HH24:MI:SS     ')||'*****NO DATA FOUND ERROR!*****');\n        dbms_output.put_line(TO_CHAR(SYSDATE,'YYYY-MM-DD HH24:MI:SS     ')||'ERROR IN STEP:  ' || v_prcs_stp);\n        v_prcs_err_msg:= ' SQLERRM: '||Sqlerrm||' Sqlcode: '||SQLCODE;\n        dbms_output.put_line(TO_CHAR(SYSDATE,'YYYY-MM-DD HH24:MI:SS     ')||'Messages: '||v_prcs_err_msg);\n        ROLLBACK;\n        Return 1;\n\n\nWHEN OTHERS THEN\n        dbms_output.put_line(TO_CHAR(SYSDATE,'YYYY-MM-DD HH24:MI:SS     ')||'*****GENERAL ERROR!*****');\n        dbms_output.put_line(TO_CHAR(SYSDATE,'YYYY-MM-DD HH24:MI:SS     ')||'ERROR IN STEP:  ' || v_prcs_stp);\n        v_prcs_err_msg:= ' SQLERRM: '||Sqlerrm||' Sqlcode: '||SQLCODE;\n        dbms_output.put_line(TO_CHAR(SYSDATE,'YYYY-MM-DD HH24:MI:SS     ')||'Messages: '||v_prcs_err_msg);\n        ROLLBACK;\n        RETURN 1;\nEND;\n/",
            "upstream_dependencies": [],
            "downstream_dependencies": [],
            "dag_location": "null",
            "gantt_location": "null",
            "created_at": "null",
            "updated_at": "null"
        },
        {
            "name": "FN_CUST_WK_AGGR_SYN_TST",
            "encrypted_name": "2ebfd02960dfc60d4e4216bc68c3ff4dc4f53311af4ec5c633c2502cce362e64",
            "type": "function",
            "database": "null",
            "encrypted_database": "null",
            "schema": "XDMADM",
            "encrypted_schema": "0e03d5c46556a742ba46252698396ef2",
            "fully_qualified_name": "XDMADM.FN_CUST_WK_AGGR_SYN_TST",
            "encrypted_fqn": "0e03d5c46556a742ba46252698396ef2.2ebfd02960dfc60d4e4216bc68c3ff4dc4f53311af4ec5c633c2502cce362e64",
            "synonyms": [],
            "metadata_analysis": "CREATE OR REPLACE FUNCTION \"0e03d5c46556a742ba46252698396ef2\".\"2ebfd02960dfc60d4e4216bc68c3ff4dc4f53311af4ec5c633c2502cce362e64\" (odate IN DATE)\n   RETURN NUMBER AS\n   \n   c_success            CONSTANT NUMBER := 0;\n   c_error              CONSTANT NUMBER := 0;\n   c_schema             CONSTANT VARCHAR2(30) := 'XDMADM';\n   c_aggr_tbl_syn_nm    CONSTANT VARCHAR2(30) := 'CUST_WK_AGGR_TST';\n   c_aggr_load_syn_nm   CONSTANT VARCHAR2(30) := 'CUST_WK_AGGR_LOAD_TST';\n   l_return_code        NUMBER;\n   l_out_msg            VARCHAR2(256);\n\n   l_aggr_tbl_nm        VARCHAR2(30);\n   l_load_tbl_nm        VARCHAR2(30);\nBEGIN\n   \n   IF (odate IS NULL) THEN\n      DBMS_OUTPUT.put_line('Error: Invalid Parameters: Date is required');\n      RETURN c_error;\n   END IF;\n\n   \n   EXECUTE IMMEDIATE 'SELECT table_name FROM user_synonyms WHERE synonym_name = ''' || c_aggr_tbl_syn_nm || ''''\n      INTO l_aggr_tbl_nm;\n\n   EXECUTE IMMEDIATE 'SELECT table_name FROM user_synonyms WHERE synonym_name = ''' || c_aggr_load_syn_nm || ''''\n      INTO l_load_tbl_nm;\n\n   DBMS_OUTPUT.put_line('Aggr Table: ' || l_aggr_tbl_nm);\n   DBMS_OUTPUT.put_line('Load Table: ' || l_load_tbl_nm);\n\n   \n   l_return_code   := de459e2fe7f96e4d958537b31b946b26.9b3711c37bca8fd1d7c76527508615f9(c_schema, l_load_tbl_nm);\n   DBMS_OUTPUT.put_line('Analyze Return: ' || l_return_code);\n\n   IF (l_return_code <> 0) THEN\n      DBMS_OUTPUT.put_line('Error: Failed to analyze table');\n      RETURN c_error;\n   END IF;\n\n   \n   l_return_code   := de459e2fe7f96e4d958537b31b946b26.f21751d25bb3675b2a3778f4f03c7da6(c_aggr_tbl_syn_nm, c_schema, l_load_tbl_nm);\n   DBMS_OUTPUT.put_line(\n      'Create synonym ' || c_aggr_tbl_syn_nm || ' for ' || c_schema || '.' || l_load_tbl_nm || ': ' || l_return_code);\n\n   IF (l_return_code <> 0) THEN\n      DBMS_OUTPUT.put_line('Error: Failed to create synonym for aggregate table');\n      RETURN c_error;\n   END IF;\n\n   l_return_code   := de459e2fe7f96e4d958537b31b946b26.f21751d25bb3675b2a3778f4f03c7da6(c_aggr_load_syn_nm, c_schema, l_aggr_tbl_nm);\n   DBMS_OUTPUT.put_line(\n      'Create synonym ' || c_aggr_load_syn_nm || ' for ' || c_schema || '.' || l_aggr_tbl_nm || ': ' || l_return_code);\n\n   IF (l_return_code <> 0) THEN\n      DBMS_OUTPUT.put_line('Error: Failed to create synonym for aggregate table');\n      RETURN c_error;\n   END IF;\n\n   \n   l_return_code   := 8e64339f96bb08058f5d52f1c04f954a.8ffe4678890c39c7d4ed38c2ed759e24.e4b5db2b3f9b19accbb8cddbfcd05bac(l_out_msg, c_schema, l_aggr_tbl_nm);\n   DBMS_OUTPUT.put_line('Truncate Prev Aggr Table Return: ' || l_return_code || ' - ' || l_out_msg);\n\n   IF (l_return_code <> 0) THEN\n      DBMS_OUTPUT.put_line('Error: Failed to truncate table');\n      RETURN c_error;\n   END IF;\n\n   RETURN c_success;\nEXCEPTION\n   WHEN OTHERS THEN\n      DBMS_OUTPUT.put_line('Unexepected error');\n      DBMS_OUTPUT.put_line(SQLCODE || ': ' || SQLERRM);\n      RETURN c_error;\nEND;\n/",
            "upstream_dependencies": [],
            "downstream_dependencies": [],
            "dag_location": "null",
            "gantt_location": "null",
            "created_at": "null",
            "updated_at": "null"
        },
        {
            "name": "FN_CUST_MRCH_NTL_AVG_LOAD",
            "encrypted_name": "bd677c4f64c73b5f396efd5a440a8be1948fe48fba5007554ba603acfef8b08d",
            "type": "function",
            "database": "null",
            "encrypted_database": "null",
            "schema": "XDMADM",
            "encrypted_schema": "0e03d5c46556a742ba46252698396ef2",
            "fully_qualified_name": "XDMADM.FN_CUST_MRCH_NTL_AVG_LOAD",
            "encrypted_fqn": "0e03d5c46556a742ba46252698396ef2.bd677c4f64c73b5f396efd5a440a8be1948fe48fba5007554ba603acfef8b08d",
            "synonyms": [],
            "metadata_analysis": "CREATE OR REPLACE FUNCTION \"0e03d5c46556a742ba46252698396ef2\".\"bd677c4f64c73b5f396efd5a440a8be1948fe48fba5007554ba603acfef8b08d\" (p_odate IN DATE)\n   RETURN NUMBER AS\n   \n\n\nl_strt_dt            date;\nl_end_dt             date;\nl_insert_cnt         NUMBER;\nl_merge_cnt          NUMBER;\nl_fn_start           DATE;\nl_delete_cnt         NUMBER;\nl_insert_unknown_cnt NUMBER;\nl_fisc_yr_qtr  Varchar2 (18 Byte);\n\nBEGIN\nDBMS_OUTPUT.put_line('Start');\n\nl_fn_start       := SYSDATE;\n\nDBMS_OUTPUT.put_line('Truncate 0e03d5c46556a742ba46252698396ef2.493fe05657168a5bd103d86ddf2c25e663f2fe9cc6b573bb859641780443a51b');\n\nexecute immediate 'TRUNCATE table Cust_mrch_ntl_avg';\n\nl_delete_cnt     := sql%ROWCOUNT;\n\nDBMS_OUTPUT.put_line(\n      'Delete' || l_delete_cnt || ' rows from Cust_mrch_ntl_avg' || TO_CHAR(ROUND((SYSDATE - l_fn_start) * 86400)) || ' seconds');\nSELECT   MIN (clndr_dt), MAX (clndr_dt),MAX(FISC_YR_QTR)\n  INTO  l_strt_dt, l_end_dt, l_fisc_yr_qtr\n    FROM   de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001\n WHERE   FISC_YR_QTR =\n            (SELECT   MAX(FISC_YR_QTR)\n               FROM   de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001\n              WHERE   FISC_YR_QTR <\n                         (SELECT   FISC_YR_QTR\n                                         FROM   de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001\n                                        WHERE   clndr_dt = p_odate));\nDBMS_OUTPUT.put_line('l_strt_dt '|| l_strt_dt || ' l_end_dt '|| l_end_dt || ' l_fisc_yr_qtr' || l_fisc_yr_qtr);\n\n\nINSERT INTO 0e03d5c46556a742ba46252698396ef2.38015843d86fd4eaa70452862e0eb01b33abc8a25a99d929134e1808ddd537c5\nWITH CUST_MERCH\n       AS (SELECT   79bce3e4027780054b8a49ac57719e09.0e5400811a26142f22e82e8c549073a6,  \n                    pim_mrch_ctgry_nm,\n                    0 ntl_avg_spend_prcnt\n             FROM   (SELECT   menu_typ_cd\n                       FROM   0e03d5c46556a742ba46252698396ef2.27fa637ec927737485bd9510edce1dd8e472b097974b0d6a9a7d2ed170324906 c) cust,\n                    (SELECT   DISTINCT\n                              NVL (pim_mrch_ctgry_nm, 'UNKNOWN')\n                                 pim_mrch_ctgry_nm\n                       FROM   de459e2fe7f96e4d958537b31b946b26.2c04d82ed0aa1cc9bce2cf2c0548b268) pim),\n    cust_list\n       AS (  SELECT   d2450100e2dda59c2b7828b4daff7f8c.839c4ffb4bfaae1bb58eab4dee67d96a, d2450100e2dda59c2b7828b4daff7f8c.852fa1e9f02f1ca2c75837f7146b2381, COUNT (DISTINCT fe1273d196c209677ff154534715415c.89f3df82917b692fe64dca942d924e7c)\n               FROM   de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c S,\n                      de459e2fe7f96e4d958537b31b946b26.c50b6339218f0dbbd97ce6557f2b051f pr,\n                      de459e2fe7f96e4d958537b31b946b26.2c04d82ed0aa1cc9bce2cf2c0548b268 P,\n                      de459e2fe7f96e4d958537b31b946b26.dec387908a0954ddc8689c4ad37c8a3c d,\n                      de459e2fe7f96e4d958537b31b946b26.dec387908a0954ddc8689c4ad37c8a3c div,                                                               \n                      de459e2fe7f96e4d958537b31b946b26.52982d3bbc1ebc2720d9504c7ea2ed3f c\n              WHERE       nvl(e9a95106e01380a7834d36560e919770.dd95a4741b2ab36b2428b3c42ef8b0448cd47113485ed05c776655af504ed664,e9a95106e01380a7834d36560e919770.839c4ffb4bfaae1bb58eab4dee67d96a) = 1ef1e03241fd3a9ca5a803b6fd417083.4fdc122fb2d10dd764e32cbc98972eca and 1ef1e03241fd3a9ca5a803b6fd417083.b8c6ab19cb6e726c38f24d1885346ea3 <> 'CC'  \n                      AND nvl (1ef1e03241fd3a9ca5a803b6fd417083.c712a9ab5ef100c5807fa96123dac48b,'USF') = 'USF'     \n                      AND e9a95106e01380a7834d36560e919770.839c4ffb4bfaae1bb58eab4dee67d96a = fce896ca0fbbf5a5d330f2803036eb44.839c4ffb4bfaae1bb58eab4dee67d96a\n                      AND e9a95106e01380a7834d36560e919770.f5dd4374a3e3af6a775cb6d6b22e8162 BETWEEN l_strt_dt AND l_end_dt\n                      AND fce896ca0fbbf5a5d330f2803036eb44.108973800bf4120a1d29febf2c2630b6 = 1                     \n                      AND e9a95106e01380a7834d36560e919770.839c4ffb4bfaae1bb58eab4dee67d96a = 6ad611c36cd5ffd775d2a499e4642fe0.839c4ffb4bfaae1bb58eab4dee67d96a\n                      AND e9a95106e01380a7834d36560e919770.81992d6fe67a712017d5e998e33be0f0 = 6ad611c36cd5ffd775d2a499e4642fe0.2d45d761eb8d137835bca7a23010fab4\n                      AND e9a95106e01380a7834d36560e919770.839c4ffb4bfaae1bb58eab4dee67d96a = d2450100e2dda59c2b7828b4daff7f8c.839c4ffb4bfaae1bb58eab4dee67d96a\n                      AND e9a95106e01380a7834d36560e919770.852fa1e9f02f1ca2c75837f7146b2381 = d2450100e2dda59c2b7828b4daff7f8c.852fa1e9f02f1ca2c75837f7146b2381\n                      AND e9a95106e01380a7834d36560e919770.467a168a7499c57b1859198a7dac7be0 IS NULL\n                      AND 6ad611c36cd5ffd775d2a499e4642fe0.d3268eabc4a7d98105fd85f9c9e62cd6e32ad436514bbe822b33de8bead744f3 = e472b097974b0d6a9a7d2ed170324906.d3268eabc4a7d98105fd85f9c9e62cd6e32ad436514bbe822b33de8bead744f3\n\t\t\t\t\t  AND d2450100e2dda59c2b7828b4daff7f8c.e33988f12139bfc93f1e7557137feb5a29e110ac67769beb8c9647cf15a66d38 = 'L'  \n                      \n                      AND a95a09b2641cac5597ee63e380dd2738.9390381abcb131475214e65c6374a79c NOT IN (SELECT   param_value_chr\n                                  FROM   de459e2fe7f96e4d958537b31b946b26.de40ae7be8b2eb3858d46af8d107f3db\n                                 WHERE   app_name =\n                                            'FN_CUST_MRCH_NTL_AVG_LOAD'\n                                         AND param_type = 'DIV_TYP_CD')\n\n           GROUP BY   d2450100e2dda59c2b7828b4daff7f8c.839c4ffb4bfaae1bb58eab4dee67d96a, d2450100e2dda59c2b7828b4daff7f8c.852fa1e9f02f1ca2c75837f7146b2381\n             HAVING   COUNT (DISTINCT fe1273d196c209677ff154534715415c.89f3df82917b692fe64dca942d924e7c) >= 10),\n    cust\n       AS (SELECT   d2450100e2dda59c2b7828b4daff7f8c.909573c485e39cfe1c127c1a279986fd,\n                    d2450100e2dda59c2b7828b4daff7f8c.0e5400811a26142f22e82e8c549073a6, \n                    d2450100e2dda59c2b7828b4daff7f8c.852fa1e9f02f1ca2c75837f7146b2381,\n                    d2450100e2dda59c2b7828b4daff7f8c.839c4ffb4bfaae1bb58eab4dee67d96a\n             FROM   de459e2fe7f96e4d958537b31b946b26.52982d3bbc1ebc2720d9504c7ea2ed3f c, cust_list l\n            WHERE       d2450100e2dda59c2b7828b4daff7f8c.839c4ffb4bfaae1bb58eab4dee67d96a = 382d0f5d3019cd2839eb42d66c71274c.839c4ffb4bfaae1bb58eab4dee67d96a\n                    AND d2450100e2dda59c2b7828b4daff7f8c.852fa1e9f02f1ca2c75837f7146b2381 = 382d0f5d3019cd2839eb42d66c71274c.852fa1e9f02f1ca2c75837f7146b2381\n                    )\nSELECT   d2450100e2dda59c2b7828b4daff7f8c.0e5400811a26142f22e82e8c549073a6,  \n         d2450100e2dda59c2b7828b4daff7f8c.5aeb276d6e88a3ea87ca7a7dd9ffa3a698df5d6b623334f2e9631188cca4cfd6,\n         CASE\n            WHEN NVL (fba30c50fca98b497b0ee63200e72c52.949bb39147ab82f8c79c281d5a9ce4efe32f6dd38f333cde68119d1f277367cd, 0) = 0\n                 OR NVL (fba30c50fca98b497b0ee63200e72c52.a8f0d3be071ccf01e84d32c561c1322f, 0) = 0\n            THEN\n               0\n            ELSE\n               (fba30c50fca98b497b0ee63200e72c52.949bb39147ab82f8c79c281d5a9ce4efe32f6dd38f333cde68119d1f277367cd / fba30c50fca98b497b0ee63200e72c52.a8f0d3be071ccf01e84d32c561c1322f) * 100\n         END\n            AS ntl_avg_spnd_prcnt,\n            l_fisc_yr_qtr\n  FROM   (  SELECT   menu_typ_cd,   \n                     pim_mrch_ctgry_nm,\n                     SUM (grs_sls_extnd)\n                        OVER (PARTITION BY menu_typ_cd, pim_mrch_ctgry_nm)  \n                        AS sls_cust_cat_typ,\n                     SUM (grs_sls_extnd)\n                        OVER (PARTITION BY menu_typ_cd)  \n                        AS sls_cust_typ\n              FROM(SELECT d2450100e2dda59c2b7828b4daff7f8c.0e5400811a26142f22e82e8c549073a6,  \n                     e472b097974b0d6a9a7d2ed170324906.5aeb276d6e88a3ea87ca7a7dd9ffa3a698df5d6b623334f2e9631188cca4cfd6,\n                     SUM (e9a95106e01380a7834d36560e919770.2ee1400a0150f0b220dd7bd6268d1e66) grs_sls_extnd\n              FROM   de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c s,\n                     cust c,\n                     de459e2fe7f96e4d958537b31b946b26.2c04d82ed0aa1cc9bce2cf2c0548b268 p,\n                     de459e2fe7f96e4d958537b31b946b26.c50b6339218f0dbbd97ce6557f2b051f pc,\n                     de459e2fe7f96e4d958537b31b946b26.dec387908a0954ddc8689c4ad37c8a3c div                                                            \n             WHERE   nvl(e9a95106e01380a7834d36560e919770.dd95a4741b2ab36b2428b3c42ef8b0448cd47113485ed05c776655af504ed664,e9a95106e01380a7834d36560e919770.839c4ffb4bfaae1bb58eab4dee67d96a) = 1ef1e03241fd3a9ca5a803b6fd417083.4fdc122fb2d10dd764e32cbc98972eca and 1ef1e03241fd3a9ca5a803b6fd417083.b8c6ab19cb6e726c38f24d1885346ea3 <> 'CC'  \n                     AND nvl (1ef1e03241fd3a9ca5a803b6fd417083.c712a9ab5ef100c5807fa96123dac48b,'USF') = 'USF'     \n                     AND e9a95106e01380a7834d36560e919770.f5dd4374a3e3af6a775cb6d6b22e8162 BETWEEN l_strt_dt AND l_end_dt\n                     AND e9a95106e01380a7834d36560e919770.852fa1e9f02f1ca2c75837f7146b2381 = d2450100e2dda59c2b7828b4daff7f8c.852fa1e9f02f1ca2c75837f7146b2381\n                     AND e9a95106e01380a7834d36560e919770.839c4ffb4bfaae1bb58eab4dee67d96a = d2450100e2dda59c2b7828b4daff7f8c.839c4ffb4bfaae1bb58eab4dee67d96a\n                     AND e9a95106e01380a7834d36560e919770.467a168a7499c57b1859198a7dac7be0 IS NULL\n                     AND e9a95106e01380a7834d36560e919770.81992d6fe67a712017d5e998e33be0f0 = 42f98af8b44bfddfe984d4995da7a9c4.2d45d761eb8d137835bca7a23010fab4\n                     AND e9a95106e01380a7834d36560e919770.839c4ffb4bfaae1bb58eab4dee67d96a = 42f98af8b44bfddfe984d4995da7a9c4.839c4ffb4bfaae1bb58eab4dee67d96a\n                     AND 42f98af8b44bfddfe984d4995da7a9c4.d3268eabc4a7d98105fd85f9c9e62cd6e32ad436514bbe822b33de8bead744f3 = e472b097974b0d6a9a7d2ed170324906.d3268eabc4a7d98105fd85f9c9e62cd6e32ad436514bbe822b33de8bead744f3\n                     AND e472b097974b0d6a9a7d2ed170324906.89f3df82917b692fe64dca942d924e7c NOT IN\n                               (SELECT   param_value_nbr\n                                  FROM   de459e2fe7f96e4d958537b31b946b26.de40ae7be8b2eb3858d46af8d107f3db\n                                 WHERE   app_name =\n                                            'FN_CUST_MRCH_NTL_AVG_LOAD'\n                                         AND param_type = 'PIM_SUPRCLS_ID')\n                      AND e472b097974b0d6a9a7d2ed170324906.5aeb276d6e88a3ea87ca7a7dd9ffa3a698df5d6b623334f2e9631188cca4cfd6 NOT IN\n                               (SELECT   param_value_chr\n                                  FROM   de459e2fe7f96e4d958537b31b946b26.de40ae7be8b2eb3858d46af8d107f3db\n                                 WHERE   app_name =\n                                            'FN_CUST_MRCH_NTL_AVG_LOAD'\n                                         AND param_type = 'PIM_MRCH_CTGRY_NM')\n          GROUP BY   7e20a03bca6e021a3968177aa9f173b2.0e5400811a26142f22e82e8c549073a6, e472b097974b0d6a9a7d2ed170324906.5aeb276d6e88a3ea87ca7a7dd9ffa3a698df5d6b623334f2e9631188cca4cfd6)) sls,   \n         CUST_MERCH c\n WHERE   7e20a03bca6e021a3968177aa9f173b2.0e5400811a26142f22e82e8c549073a6 = fba30c50fca98b497b0ee63200e72c52.0e5400811a26142f22e82e8c549073a6(+)   \n         AND 7e20a03bca6e021a3968177aa9f173b2.5aeb276d6e88a3ea87ca7a7dd9ffa3a698df5d6b623334f2e9631188cca4cfd6 = fba30c50fca98b497b0ee63200e72c52.5aeb276d6e88a3ea87ca7a7dd9ffa3a698df5d6b623334f2e9631188cca4cfd6(+)\n  ;\nl_merge_cnt     := sql%ROWCOUNT;\n\n\nDBMS_OUTPUT.put_line(\n      'Insert ' || l_merge_cnt || ' rows in ' || TO_CHAR(ROUND((SYSDATE - l_fn_start) * 86400)) || ' seconds');\n\n\n     COMMIT;\n\n  RETURN 0;\n\nEXCEPTION\n           WHEN OTHERS THEN\n      DBMS_OUTPUT.put_line('Error in 0e03d5c46556a742ba46252698396ef2.bbff4f4d6f6cb3b1e47cd7e3a9076377a46fb24a3ecce505fcc1933609f2330f:' || SQLCODE || ' ' || SQLERRM);\n      RETURN 1;\nEND fn_cust_mrch_ntl_avg_load;\n/",
            "upstream_dependencies": [],
            "downstream_dependencies": [],
            "dag_location": "null",
            "gantt_location": "null",
            "created_at": "null",
            "updated_at": "null"
        },
        {
            "name": "FN_NO_CC_DIV_VPD",
            "encrypted_name": "9babd78549fcf52c85e9a0113e87bffee32f6dd38f333cde68119d1f277367cd",
            "type": "function",
            "database": "null",
            "encrypted_database": "null",
            "schema": "XDMADM",
            "encrypted_schema": "0e03d5c46556a742ba46252698396ef2",
            "fully_qualified_name": "XDMADM.FN_NO_CC_DIV_VPD",
            "encrypted_fqn": "0e03d5c46556a742ba46252698396ef2.9babd78549fcf52c85e9a0113e87bffee32f6dd38f333cde68119d1f277367cd",
            "synonyms": [],
            "metadata_analysis": "CREATE OR REPLACE FUNCTION \"0e03d5c46556a742ba46252698396ef2\".\"9babd78549fcf52c85e9a0113e87bffee32f6dd38f333cde68119d1f277367cd\" (p_schema       IN VARCHAR2,\n                          p_objname      IN VARCHAR2)\n   RETURN VARCHAR2 AS\n   \n   c_start                CONSTANT NUMBER := DBMS_UTILITY.get_time;\n   c_fn_nm                CONSTANT VARCHAR2(30) := 'FN_NO_CC_DIV_VPD';\n   l_security_predicate   VARCHAR2(4000) DEFAULT NULL;\n   l_cur_sql              VARCHAR2(4000) := SYS_CONTEXT('USERENV', 'CURRENT_SQL');\n   l_sbjct_area           VARCHAR2(100) := SYS_CONTEXT(9751bbbcfea690cc0be4d58830a6fe2e.9bfb5eb7793dc8fa6800d5a61e5e3e4e1e2f6ec194927f064ce6cb31fba71a32.f4a54ebc6f2c591ed4266aafe66971af, 9751bbbcfea690cc0be4d58830a6fe2e.9bfb5eb7793dc8fa6800d5a61e5e3e4e1e2f6ec194927f064ce6cb31fba71a32.3b1288ed835b1b524e9500bb13544956e6e6300089dae5a98e31814d0406060f);\n   l_vpd_exempt           VARCHAR2(1) := SYS_CONTEXT(9751bbbcfea690cc0be4d58830a6fe2e.9bfb5eb7793dc8fa6800d5a61e5e3e4e1e2f6ec194927f064ce6cb31fba71a32.f4a54ebc6f2c591ed4266aafe66971af, 9751bbbcfea690cc0be4d58830a6fe2e.9bfb5eb7793dc8fa6800d5a61e5e3e4e1e2f6ec194927f064ce6cb31fba71a32.0eaf613ab52a53601d1496b5650de81e);\n   l_all_divs             VARCHAR2(1) := SYS_CONTEXT(9751bbbcfea690cc0be4d58830a6fe2e.9bfb5eb7793dc8fa6800d5a61e5e3e4e1e2f6ec194927f064ce6cb31fba71a32.f4a54ebc6f2c591ed4266aafe66971af, 9751bbbcfea690cc0be4d58830a6fe2e.9bfb5eb7793dc8fa6800d5a61e5e3e4e1e2f6ec194927f064ce6cb31fba71a32.0f460756ee76d4a2460733464cda5f95);\n\n   l_div_count            NUMBER := 0;\n   l_first                BOOLEAN := TRUE;\n\n\n   CURSOR all_divs_c IS\n      SELECT \n            de459e2fe7f96e4d958537b31b946b26.dec387908a0954ddc8689c4ad37c8a3c.839c4ffb4bfaae1bb58eab4dee67d96a\n        FROM de459e2fe7f96e4d958537b31b946b26.dec387908a0954ddc8689c4ad37c8a3c dc\n       WHERE div_typ_cd = 'CC'\n         AND (de459e2fe7f96e4d958537b31b946b26.dec387908a0954ddc8689c4ad37c8a3c.2edfd837e0441242d7eed4e0cdf56652 IS NULL\n           OR de459e2fe7f96e4d958537b31b946b26.dec387908a0954ddc8689c4ad37c8a3c.6d74bb3e26f02dd707dc6b3b68070169 > SYSDATE);\n\n   all_divs_rec           all_divs_c%ROWTYPE;\nBEGIN\n   \n\n   IF l_sbjct_area IS NULL THEN\n      l_security_predicate   := '1=2';\n      9751bbbcfea690cc0be4d58830a6fe2e.d4abe88ed2062b430c927bc84d61faf1f9a7aadf5998d448c2e2d1b0b47a3056.7d64937276682b23a0e16e5c61dad7aa('NO SA',\n                                          c_fn_nm,\n                                          USER,\n                                          p_schema,\n                                          p_objname,\n                                          l_sbjct_area,\n                                          l_vpd_exempt,\n                                          l_all_divs,\n                                          l_cur_sql,\n                                          l_security_predicate,\n                                          (DBMS_UTILITY.get_time - c_start) / 100);\n\n      RETURN l_security_predicate;\n   END IF;\n\n   \n   \n\n   IF l_vpd_exempt = 'Y' THEN\n      l_security_predicate   := '1=1';\n      9751bbbcfea690cc0be4d58830a6fe2e.d4abe88ed2062b430c927bc84d61faf1f9a7aadf5998d448c2e2d1b0b47a3056.7d64937276682b23a0e16e5c61dad7aa('EXEMPT',\n                                          c_fn_nm,\n                                          USER,\n                                          p_schema,\n                                          p_objname,\n                                          l_sbjct_area,\n                                          l_vpd_exempt,\n                                          l_all_divs,\n                                          l_cur_sql,\n                                          l_security_predicate,\n                                          (DBMS_UTILITY.get_time - c_start) / 100);\n\n      RETURN l_security_predicate;\n   END IF;\n\n   \n   \n\n   SELECT COUNT( * )\n     INTO l_div_count\n     FROM de459e2fe7f96e4d958537b31b946b26.dec387908a0954ddc8689c4ad37c8a3c dc\n    WHERE div_typ_cd = 'CC'\n      AND (de459e2fe7f96e4d958537b31b946b26.dec387908a0954ddc8689c4ad37c8a3c.2edfd837e0441242d7eed4e0cdf56652 IS NULL\n        OR de459e2fe7f96e4d958537b31b946b26.dec387908a0954ddc8689c4ad37c8a3c.6d74bb3e26f02dd707dc6b3b68070169 > SYSDATE);\n\n   IF l_div_count > 0 THEN\n      l_first                := TRUE;\n\n      OPEN all_divs_c;\n\n      LOOP\n         FETCH all_divs_c INTO all_divs_rec;\n\n         EXIT WHEN all_divs_c%NOTFOUND;\n\n         IF l_first THEN\n            l_security_predicate   := 'DIV_NBR NOT IN (' || 05809d328a80b20ac6b3d7abdb3f24ec.839c4ffb4bfaae1bb58eab4dee67d96a;\n            l_first                := FALSE;\n         ELSE\n            l_security_predicate   := l_security_predicate || ',' || 05809d328a80b20ac6b3d7abdb3f24ec.839c4ffb4bfaae1bb58eab4dee67d96a;\n         END IF;\n      END LOOP;\n\n      CLOSE all_divs_c;\n\n      l_security_predicate   := l_security_predicate || ')';\n   ELSE\n      l_security_predicate   := '1=1';\n   END IF;\n\n   9751bbbcfea690cc0be4d58830a6fe2e.d4abe88ed2062b430c927bc84d61faf1f9a7aadf5998d448c2e2d1b0b47a3056.7d64937276682b23a0e16e5c61dad7aa('NO CC',\n                                       c_fn_nm,\n                                       USER,\n                                       p_schema,\n                                       p_objname,\n                                       l_sbjct_area,\n                                       l_vpd_exempt,\n                                       l_all_divs,\n                                       l_cur_sql,\n                                       l_security_predicate,\n                                       (DBMS_UTILITY.get_time - c_start) / 100);\n\n   RETURN l_security_predicate;\nEXCEPTION\n   WHEN OTHERS THEN\n      l_security_predicate   := '1=2';\n      9751bbbcfea690cc0be4d58830a6fe2e.d4abe88ed2062b430c927bc84d61faf1f9a7aadf5998d448c2e2d1b0b47a3056.7d64937276682b23a0e16e5c61dad7aa(SQLCODE || '-' || SQLERRM,\n                                          c_fn_nm,\n                                          USER,\n                                          p_schema,\n                                          p_objname,\n                                          l_sbjct_area,\n                                          l_vpd_exempt,\n                                          NULL,\n                                          l_cur_sql,\n                                          l_security_predicate,\n                                          (DBMS_UTILITY.get_time - c_start) / 100);\n\n      RETURN l_security_predicate;\nEND fn_no_cc_div_vpd;\n/",
            "upstream_dependencies": [],
            "downstream_dependencies": [],
            "dag_location": "null",
            "gantt_location": "null",
            "created_at": "null",
            "updated_at": "null"
        },
        {
            "name": "FN_XDM_SALES_CORP_UPD_AN",
            "encrypted_name": "8a7dc331f2181d5e6ec25c055901932f1214a603159393433e3ed3f38ae2175a",
            "type": "function",
            "database": "null",
            "encrypted_database": "null",
            "schema": "XDMADM",
            "encrypted_schema": "0e03d5c46556a742ba46252698396ef2",
            "fully_qualified_name": "XDMADM.FN_XDM_SALES_CORP_UPD_AN",
            "encrypted_fqn": "0e03d5c46556a742ba46252698396ef2.8a7dc331f2181d5e6ec25c055901932f1214a603159393433e3ed3f38ae2175a",
            "synonyms": [],
            "metadata_analysis": "CREATE OR REPLACE FUNCTION \"0e03d5c46556a742ba46252698396ef2\".\"8a7dc331f2181d5e6ec25c055901932f1214a603159393433e3ed3f38ae2175a\" (\n                                P_IN_DIV_NBR    IN NUMBER,\n                                P_IN_SRC_TBL    IN VARCHAR2,\n                                P_IN_TGT_TBL    IN VARCHAR2,\n                                P_IN_START_DT   IN VARCHAR2,\n                                P_IN_END_DT     IN VARCHAR2,\n                                p_out_message   IN OUT VARCHAR2) RETURN NUMBER  IS\n\n\n   v_return_nbr              NUMBER         := 0;\n   v_err_msg                 VARCHAR2(32767) := NULL;\n   n_return_code             NUMBER         := 0;\n   v_return_message          VARCHAR2(32767) := NULL;\n\n   v_src_cnt                 NUMBER;\n   v_src_grs_sls             NUMBER;\n   v_src_qty_ship            NUMBER;\n   v_src_ttl_dvt             NUMBER;\n   v_src_np_alw              NUMBER;\n   v_src_np_chrg             NUMBER;\n   v_src_prd_alw             NUMBER;\n   v_src_prd_chrg            NUMBER;\n\n   v_tgt_cnt                 NUMBER;\n   v_tgt_grs_sls             NUMBER;\n   v_tgt_qty_ship            NUMBER;\n   v_tgt_ttl_dvt             NUMBER;\n   v_tgt_np_alw              NUMBER;\n   v_tgt_np_chrg             NUMBER;\n   v_tgt_prd_alw             NUMBER;\n   v_tgt_prd_chrg            NUMBER;\n\n   v_ins_sql1         VARCHAR2(32767);\n   v_ins_sql2         VARCHAR2(32767);\n   v_ins_sql3          VARCHAR2(32767);\n   v_ins_sql4          VARCHAR2(32767);\n   v_ins_sql5         VARCHAR2(32767);\n   v_ins_sql6         VARCHAR2(32767);\n\n   v_antxn_sql1         VARCHAR2(32767);\n   v_antxn_sql2         VARCHAR2(32767);\n   v_antxn_sql3         VARCHAR2(32767);\n   v_antxn_sql4         VARCHAR2(32767);\n   v_antxn_sql5         VARCHAR2(32767);\n   v_antxn_sql6         VARCHAR2(32767);\n   v_antxn_sql7         VARCHAR2(32767);\n   v_antxn_sql8         VARCHAR2(32767);\n   v_antxn_sql9         VARCHAR2(32767);\n   v_antxn_sql10         VARCHAR2(32767);\n   v_antxn_sql11         VARCHAR2(32767);\n   v_antxn_sql12         VARCHAR2(32767);\n\n   v_reg_addfilter_sql     VARCHAR2(32767);\n   v_ap_addfilter_sql     VARCHAR2(32767);\n   v_an_addfilter_sql     VARCHAR2(32767);\n\n   v_div_nbr           NUMBER;\n   v_src_tbl           VARCHAR2(50);\n   v_tgt_tbl           VARCHAR2(50);\n   v_start_dt           VARCHAR2(12) := p_in_start_dt;\n   v_end_dt             VARCHAR2(12) := p_in_end_dt;\n   v_audt_sql1     VARCHAR2(2000);\n   v_audt_sql2     VARCHAR2(2000);\n\n   v_audt_fin      VARCHAR2(32767);\n\nBEGIN\n\n   v_div_nbr  := p_in_div_nbr;\n   v_src_tbl  := p_in_src_tbl;\n   v_tgt_tbl  := p_in_tgt_tbl;\n\nv_ins_sql1 := 'INSERT  INTO ' || v_tgt_tbl || ' (acct_typ_cd_actl, acct_typ_cd_desc_actl, actl_cst, actl_extnd, actl_gp, adj_markout, alw_chrg_cd, ' ||\n ' ap_cost, ap_gain, ap_vndr_nbr_actl, brk_srchrg, bsis_alw_amt, bsis_alw_applied, bsis_alw_ind, bsis_amt, carr_addr_txt, carr_alt_id, carr_alt_id_typ_cd, ' ||\n ' carr_city_nm, carr_cmnt, carr_cntct, carr_ctry_txt, carr_data_src_cd, carr_dot_nbr, carr_email_txt, carr_eqmt_mark_typ_cd, ' ||\n ' carr_fax_nbr, carr_inv_user_id, carr_motor_carr_nbr, carr_nm, carr_phn_nbr, carr_scac_cd, ';\n\nv_ins_sql2 := ' carr_st_cd, carr_stat_cd, carr_updt_dt, carr_updt_tm, carr_updt_user_id, carr_usf_nbr, carr_zip_cd, cde, cmpny_vndr_nbr_actl, cmsn_sls_extnd, ' ||\n ' cntrct_cpr_amt, cntrct_cpr_amt_ind, cntrct_cpr_bsis, cntrct_cpr_bsis_dt, cntrct_cpr_calc, cntrct_cpr_grp_typ, cntrct_cpr_nbr, cntrct_cpr_prod_grp, ' ||\n ' COMM_BSIS_AMT, corp_dvt_sls_base_rbt, corp_mlt_unit_desc_actl, corp_mlt_unit_nbr_actl, corp_non_dvt_sls_base_rbt, corp_prch_base_rbt, cr_dbt_rsn_cd, ' ||\n ' cr_dbt_rsn_desc, cr_memo_dlr, cr_memo_dt, cr_memo_dwa, cr_memo_nbr, cust_bus_seg_actl, cust_bus_seg_desc_actl, cust_nbr, cust_po_nbr, cust_prod_nbr, ' ||\n ' cust_sk, div_nbr, div_sk, dlvr_rte, dlvr_seq_nbr, drvr, dry_each, dry_unit, dry_wt, dstrct_cd_actl, dstrct_nm_actl, dstrct_sls_mgr_id_actl, ' ||\n ' dstrct_sls_mgr_nm_actl, ';\n\nv_ins_sql3 := ' dvt_cost_extnd, dwa_cost_extnd, each_conv_fctr, END_DAY_CD, each_ord, each_orig, each_prc, each_rsrv, each_ship, extnd_fctr, frght_cost, ' ||\n ' frz_each, frz_unit, frz_wt, gl_sbsys_cd, grs_sls_extnd, inside_pad, inv_actl_gp, inv_dt, inv_gp, inv_nbr, lagp_per_case, ldr, ldr_seq_nbr, ' ||\n ' ldr_tm, lic_prod_extnd, lic_tot_extnd, line_nbr, lnd_actl_gp, lnd_gp, loc_dvt_sls_base_rbt, loc_int_dvt, loc_mlt_unit_desc_actl, loc_mlt_unit_nbr_actl, '||\n ' loc_mrktng_alwnc_pgms, loc_non_dvt_sls_base_rbt, loc_one_tm, loc_prch_base_rbt, loc_prom_alwnc_pgms, loc_vndr_fnd_dvt, lpp, mkt_prod_extnd, ' ||\n ' mkt_tot_extnd, mrgn_bsis, natl_int_dvt, natl_mrktng_alwnc_pgms, natl_one_tm, natl_prom_alwnc_pgms, natl_vndr_fnd_dvt, net_sls_extnd, net_wt_ship, ' ||\n ' non_prod_alwnc, non_prod_alwnc_cd, non_prod_alwnc_desc, non_prod_chrg, non_prod_chrg_cd, non_prod_chrg_desc, ';\n\nv_ins_sql4 := ' ntv_cr_dbt_rsn_cd, ntv_cr_dbt_rsn_desc, ntv_ord_cls, ntv_ord_typ, ord_src, ord_tkr, orig_dwa_cost_extnd, orig_ldr_tm, orig_ord_dt, ' ||\n ' pick_slot_actl, pim_brnd_typ_actl, pim_brnd_typ_desc_actl, pim_cls_desc_actl, pim_cls_id_actl, pim_ctgry_desc_actl, ' ||\n ' pim_ctgry_id_actl, pim_grp_desc_actl, pim_grp_id_actl, pim_sk, pim_suprcls_desc_actl, pim_suprcls_id_actl, pim_usf_std_prod_cd, prc_mrgn, ' ||\n ' prc_src, prch_from_vndr_nbr_actl, prcs_dt, prime_aft_adj_dlr_amt, prime_aft_bsis_adj_amt, prime_aft_bsis_adj_ind, ' ||\n ' prime_bfr_adj_dlr_amt, prime_bfr_bsis_adj_amt, prime_bfr_bsis_adj_ind, prime_calc_ind, prime_cnh_cntrct_nbr, prime_cnh_prc_br_cd, ' ||\n ' prime_cns_cost_pt_mrk, prime_cns_cost_pt_rng, prime_cntrct_calc_bsis_amt, prime_cntrct_each_mrk_amt, prime_cntrct_each_mrk_typ, prime_cntrct_nm, ' ||\n ' prime_cntrct_prod_excpt_ind, prime_cost_by_po_nbr, prime_cust_prc_on_ind, prime_dvt_cost_amt, prime_dvt_cost_aply, prime_dvt_cost_typ, ';\n\nv_ins_sql5 := ' prime_dvtn_grp_nbr, prime_dvtn_grp_nm, prime_extnd_rbl_sis_amt, prime_frght_amt, prime_frght_bsis, prime_hcp_pim_cat, prime_hcp_pim_cls, ' ||\n' prime_hcp_pim_grp, prime_hcp_usf_std_prod_cd, prime_min_mrk_amt, prime_mrk_amt, prime_mrk_ind, prime_ord_orig_unit_prc, prime_prc_bsis, ' ||\n' prime_prc_bsis_amt, prime_prc_by, prime_prc_cost_tbl_eff_dt, prime_prc_cost_tbl_eff_tm, prime_rbl_sis_amt, prime_rbl_sis_mrgn, prime_rbl_sis_per, ' ||\n' prime_rnd_cd, prime_sbtyp_prc_by, prime_sis_flg, prime_updt_cyc, prnt_mlt_unit_cd_actl, prnt_mlt_unit_desc_actl, prod_alw, prod_alwnc_cd, ' ||\n' prod_alwnc_desc, prod_chrg, prod_chrg_cd, prod_chrg_desc, prod_nbr, prod_sk, prod_sls_tax, prod_stat_ind_actl, qty_dvt, qty_markout, qty_ord, ' ||\n' qty_orig, qty_rsrv, qty_ship, qty_subbed, rcrd_stat, rcvng_po_nbr, ';\n\nv_ins_sql6 := ' rep_cost_extnd, rfrgrt_each, rfrgrt_unit, rfrgrt_wt, rtd_ind, sample_ord_ind, ship_from, ship_to_id, sls_mrgn, sls_uom, srchrg, ' ||\n' sub_for, sub_prod_ind, tagp_per_case, tax_typ, tm_sk, trans_typ, trd_cls_actl, trtry_cd_actl, trtry_mgr_id_actl, trtry_mgr_nm_actl, ' ||\n' true_gp, true_mfr, ttl_alwnc, ttl_dvt, ttl_int_vndr_fnd_dvt, ttl_loc_alwnc, ttl_natl_alwnc, ttl_vndr_fnd_dvt, unfrm_qty_dvt, ' ||\n' unfrm_qty_markout, unfrm_qty_ord, unfrm_qty_orig, unfrm_qty_rsrv, unfrm_qty_ship, unfrm_qty_subbed, unit_ord, unit_orig, unit_prc, ' ||\n' unit_rsrv, unit_ship, xfer_from_dt, xfer_to_dt) ';\n\nv_antxn_sql1 := ' WITH txn_hdr AS ( SELECT   17f1c830e0e4f4473714a895228afe97.839c4ffb4bfaae1bb58eab4dee67d96a, 17f1c830e0e4f4473714a895228afe97.f5dd4374a3e3af6a775cb6d6b22e8162, 17f1c830e0e4f4473714a895228afe97.be8d7c2ea76d3152927ebf8709ea0326, 17f1c830e0e4f4473714a895228afe97.852fa1e9f02f1ca2c75837f7146b2381, 17f1c830e0e4f4473714a895228afe97.d1ce6707c3d1cc0e57096fdc21a5e64f, 17f1c830e0e4f4473714a895228afe97.8b8c72c349530db846280000957f636d, ' ||\n' 17f1c830e0e4f4473714a895228afe97.7c11ab787cf6f310ca23c850e9034413e32f6dd38f333cde68119d1f277367cd, 17f1c830e0e4f4473714a895228afe97.97ca09d0543afec109dac3f8d90db5305479098e904da91bb293c4391be1730d, 17f1c830e0e4f4473714a895228afe97.7d5c34ff491d8080f7cce12ef8714e0c, 17f1c830e0e4f4473714a895228afe97.5bbae4d36d584cb827876fa4cf42a7bfe32f6dd38f333cde68119d1f277367cd, 17f1c830e0e4f4473714a895228afe97.a95d417d16e7214ab26b755260f9b58ae32f6dd38f333cde68119d1f277367cd, 17f1c830e0e4f4473714a895228afe97.c822610ebab898cac56b201bbbbf3be0 ' ||\n' , 17f1c830e0e4f4473714a895228afe97.4c5fd6201abd060f4708bd2893dacabadfb673c032e1fff141ac84551b91849a, 17f1c830e0e4f4473714a895228afe97.76e1f04d1a3ab6533bd5dcf8b6682679932f120c97751cb6f536c08acbd63fcc, 17f1c830e0e4f4473714a895228afe97.64598583bb1c514bf2374e1725ea8b0f, 17f1c830e0e4f4473714a895228afe97.b894aa64cb1e7288637754771f2d1b0633709dad7fa5eac8c1c3486b35956c3e, 17f1c830e0e4f4473714a895228afe97.51a81ef30e84b502295c6528bdc86143, 17f1c830e0e4f4473714a895228afe97.1ad8179bb058c680d70c6f9663dba4e7, ' ||\n' 17f1c830e0e4f4473714a895228afe97.264e2d06211e3158081e62ae5103c845feddad254bfd5abc6373653d075ee11b, 17f1c830e0e4f4473714a895228afe97.3377a56ac3a8caf2bec5d2e95319521429ba5ee45e1d87a256e3a1b57750a92a, 17f1c830e0e4f4473714a895228afe97.5112ab47fb19df73f8ed2678ddc0ecdb34ceb39ae2f66f21170198c2e55391b5, 17f1c830e0e4f4473714a895228afe97.07310c912dd99ea9c810de3167989b0f ' ||\n' , 17f1c830e0e4f4473714a895228afe97.1855265b91ccef6e842d6a431c0295fc, 17f1c830e0e4f4473714a895228afe97.582bd9075c3cdfa71b2052bbedf48cd5, 17f1c830e0e4f4473714a895228afe97.0054744cef9d8175c53e48a21807c4b4382d0f5d3019cd2839eb42d66c71274c, 17f1c830e0e4f4473714a895228afe97.fecdf2b578d5771c3c985bce98c0022f1351bbde85c0ab91a84853573cd0dae5, 17f1c830e0e4f4473714a895228afe97.90ac752a9aacd6b72bdb4028510b579d, 17f1c830e0e4f4473714a895228afe97.7f599f836c449bebb92bb9757e86c603, 17f1c830e0e4f4473714a895228afe97.fa741a84bd7a01a1c4b5dc91364baac5, ' ||\n' 17f1c830e0e4f4473714a895228afe97.d55fbc4a3259962a8ab4fbedc0065134, 17f1c830e0e4f4473714a895228afe97.e8a1b74c58655c6b8ffcb348b45f0a27 ';\n\nv_antxn_sql2 := ', 17f1c830e0e4f4473714a895228afe97.f3c7ed306cc6a6b3d6cfb40db08ba919e18a0efa177931495b66865407b6da30, 17f1c830e0e4f4473714a895228afe97.58b87fef0b56bd2bd029967f2dfe55798b31ebbdd4a917cc13e004a9efd1e6bd, 17f1c830e0e4f4473714a895228afe97.ae40ab54d363f05f40ae79e99066b4c9, 17f1c830e0e4f4473714a895228afe97.0e55e137a02bb10fcd61e2ad9262eeee, 17f1c830e0e4f4473714a895228afe97.d641e89de57ff11c5990f70965a7a09e1351bbde85c0ab91a84853573cd0dae5, ' ||\n' 17f1c830e0e4f4473714a895228afe97.1c3f9404c7ddd5254f4ab6865d0c9ae75479098e904da91bb293c4391be1730d, 17f1c830e0e4f4473714a895228afe97.69cc3d229f9a1af0e9235eb598b0b176, 17f1c830e0e4f4473714a895228afe97.b5019e4009d6240fe25b80db390c07601d731bbdc4e3fb69a854112d4982eb99, 17f1c830e0e4f4473714a895228afe97.23e1fb1fa383dd566a7fa990e93f3b53f90adc90d03e80e5248398220ac3e975, 17f1c830e0e4f4473714a895228afe97.995423505a0670f0daf31417466a6833, 17f1c830e0e4f4473714a895228afe97.e0ebc2677f8d7eb0a98246b4cb3db329 ' ||\n' , 17f1c830e0e4f4473714a895228afe97.8708a839c00cf7a8852df326dbe38f05382d0f5d3019cd2839eb42d66c71274c, 17f1c830e0e4f4473714a895228afe97.8df6e6099ebb67df7a104f33cfbeae411351bbde85c0ab91a84853573cd0dae5, 17f1c830e0e4f4473714a895228afe97.106cff97a417dbe6c4979d1de5e4bc76382d0f5d3019cd2839eb42d66c71274c, 17f1c830e0e4f4473714a895228afe97.74b5cefda7cf1a7db3f0a3091333ac05, 17f1c830e0e4f4473714a895228afe97.c51ab05c6acd87cdbf495339cf5496c0dfb673c032e1fff141ac84551b91849a, 17f1c830e0e4f4473714a895228afe97.80f3b424d7258a583f0dff0f4d4b159d382d0f5d3019cd2839eb42d66c71274c, ' ||\n' 17f1c830e0e4f4473714a895228afe97.f97b65e019a6572a4dfbc160d1d868ff382d0f5d3019cd2839eb42d66c71274c, 17f1c830e0e4f4473714a895228afe97.b5e1ce6b2ac430bf504b82957a3e2685, 17f1c830e0e4f4473714a895228afe97.00d89839907d0ecec58003008d2713675479098e904da91bb293c4391be1730d, 17f1c830e0e4f4473714a895228afe97.21a6675858ce67d43a7b6513100e2930dfb673c032e1fff141ac84551b91849a, 17f1c830e0e4f4473714a895228afe97.4b398d884e397727aeb50b1bf2299e60f6283ea3dfab0ee7d1d005a13bf2d220, ' ||\n' 17f1c830e0e4f4473714a895228afe97.d6feb3ce3930e1df4568d8ad2e34234a601fa525a9ae6adbe4075e99e3bc2cf7, 17f1c830e0e4f4473714a895228afe97.5614e3e3773aa0cc945f4ce3d7f55482601fa525a9ae6adbe4075e99e3bc2cf7, 17f1c830e0e4f4473714a895228afe97.d4b886ec9db9850e79e0b6d4cf1585d4, 17f1c830e0e4f4473714a895228afe97.d89005a8280032bffbf811a9534ce895e32ad436514bbe822b33de8bead744f3, 17f1c830e0e4f4473714a895228afe97.9e023e08ce376b6e1b1b18dfa1cd167a11f37ee054443a481b60681df215350c, ' ||\n' 17f1c830e0e4f4473714a895228afe97.ffe40dcb6bc0e52a6e16f71f92936b55, 17f1c830e0e4f4473714a895228afe97.55758ba3499240fc41103cdeb54dabdcce26a64a7ac8d188835efcbfda026222 ';\n\nv_antxn_sql3 := ', 17f1c830e0e4f4473714a895228afe97.02c48591889a5fa84ba70163595e3cd4cd0030bf918e8eee8bdc28cab59f8e90, 17f1c830e0e4f4473714a895228afe97.5937a869f7bd9c820fe4bbf4390bfe1541baa927927c7a4850d6f91f78c62431, 17f1c830e0e4f4473714a895228afe97.677b20030e97fe7a072c96e3023ab27b75a332bf028585250008d9183409dc25, 17f1c830e0e4f4473714a895228afe97.896062ff14ee1e0e09184e57f315ec807e8fe841f8abc0a126967273be28f1b7, 17f1c830e0e4f4473714a895228afe97.896062ff14ee1e0e09184e57f315ec8098df5d6b623334f2e9631188cca4cfd6, ' ||\n' 17f1c830e0e4f4473714a895228afe97.559effe9c0b926e97c1a592970005d05e32f6dd38f333cde68119d1f277367cd, 17f1c830e0e4f4473714a895228afe97.c75cfeffaba16c33a08fd34fd23f01971d731bbdc4e3fb69a854112d4982eb99, 17f1c830e0e4f4473714a895228afe97.085ad920c0177cbda11e444d47a41c95e9a95106e01380a7834d36560e919770, 17f1c830e0e4f4473714a895228afe97.36e83390e6cef790558b8ec37de1f4fee472b097974b0d6a9a7d2ed170324906, 17f1c830e0e4f4473714a895228afe97.210f742c7a4e17979d08976db76abf6f, 17f1c830e0e4f4473714a895228afe97.72fe1ee604357ed2ad1717cc673f8d1b, ' ||\n' 17f1c830e0e4f4473714a895228afe97.3b18c8d346bdbe03ccf6d8560029ef43, 17f1c830e0e4f4473714a895228afe97.4545f9b55765471ccd2e57bda93403c8d24b2fb1eee3864a9486359f68c4e118, 17f1c830e0e4f4473714a895228afe97.7e96684bc4ed02b9ccf63d2f52a43b84e6e6300089dae5a98e31814d0406060f,17f1c830e0e4f4473714a895228afe97.370a5aec6c948b64a7638f194c6ea1a7, 17f1c830e0e4f4473714a895228afe97.6a04130b896c82c2b3b22b337cad2a56, 17f1c830e0e4f4473714a895228afe97.975e3b626d2e6ca06ed84fbbc5558de3bff56d587bce01d32a3d5e44d29ed4fa, 17f1c830e0e4f4473714a895228afe97.ccc371b06f1e0daed88f223211b2e790, ' ||\n' 17f1c830e0e4f4473714a895228afe97.6a57525895fd55cd1da456566ea80c1d, 17f1c830e0e4f4473714a895228afe97.5b166c5fe66db413f1e228635901a0965479098e904da91bb293c4391be1730d, 17f1c830e0e4f4473714a895228afe97.9033b904a17dc722bf77fb076a267f1529ba5ee45e1d87a256e3a1b57750a92a, 17f1c830e0e4f4473714a895228afe97.49dbc899bc8f9659472a5a3b3510790c, 17f1c830e0e4f4473714a895228afe97.deeb4c7020bbcfd9e70cb4a8ed6ea0dc, ' ||\n' 17f1c830e0e4f4473714a895228afe97.ca329b170a83f14795f7d01859b0fe42, 17f1c830e0e4f4473714a895228afe97.a4657a147b058328748c801964a53707, 17f1c830e0e4f4473714a895228afe97.0a85164948783cdf0d4416f41905a154, 17f1c830e0e4f4473714a895228afe97.a00b7aac034b1de6ebfabe4a7097af1b3c072b0281819f75f19257cd7009a1b3, 17f1c830e0e4f4473714a895228afe97.9b5a3fd0647f1b6d616bd47466949ec2, 17f1c830e0e4f4473714a895228afe97.b7a93c415ffd854911e38dbd0033808a, 17f1c830e0e4f4473714a895228afe97.b391f718d41b76652cd5f0d0063372b5, ' ||\n' 17f1c830e0e4f4473714a895228afe97.d5506821c4ea14a4d9ee0f0ce4e7652d, 17f1c830e0e4f4473714a895228afe97.f2afece23955e23b9d2f09fce0b18c61382d0f5d3019cd2839eb42d66c71274c, 17f1c830e0e4f4473714a895228afe97.0c499b9342241191d5d5fc19d9822401382d0f5d3019cd2839eb42d66c71274c ';\n\nv_antxn_sql4 := ', 17f1c830e0e4f4473714a895228afe97.abfa8e82cd46bbb827127b6cb2f5d6d5, 17f1c830e0e4f4473714a895228afe97.49a0a9be0a1154a8d1362e9b1213782e0f94938f8d42ec5a784edd3e75fceb1b, 17f1c830e0e4f4473714a895228afe97.721a8ad171b31ae60261431ccd51b52d, 17f1c830e0e4f4473714a895228afe97.caa2824077535938efbfeab4179ac71d, rank() OVER (PARTITION BY 17f1c830e0e4f4473714a895228afe97.839c4ffb4bfaae1bb58eab4dee67d96a, 17f1c830e0e4f4473714a895228afe97.be8d7c2ea76d3152927ebf8709ea0326, 17f1c830e0e4f4473714a895228afe97.852fa1e9f02f1ca2c75837f7146b2381, 17f1c830e0e4f4473714a895228afe97.d1ce6707c3d1cc0e57096fdc21a5e64f, ' ||\n' 17f1c830e0e4f4473714a895228afe97.f5dd4374a3e3af6a775cb6d6b22e8162  ORDER BY   17f1c830e0e4f4473714a895228afe97.839c4ffb4bfaae1bb58eab4dee67d96a, 17f1c830e0e4f4473714a895228afe97.be8d7c2ea76d3152927ebf8709ea0326, 17f1c830e0e4f4473714a895228afe97.852fa1e9f02f1ca2c75837f7146b2381, 17f1c830e0e4f4473714a895228afe97.d1ce6707c3d1cc0e57096fdc21a5e64f, 17f1c830e0e4f4473714a895228afe97.f5dd4374a3e3af6a775cb6d6b22e8162 ' ||\n' , 17f1c830e0e4f4473714a895228afe97.0e55e137a02bb10fcd61e2ad9262eeee) as ldrtm_ranking FROM ' || v_src_tbl || ' slc WHERE 17f1c830e0e4f4473714a895228afe97.26ac88e7ae671a1b22c14c2fce77aa2d IN (''RT'',''VS'',''WC'',''CD'') ' ||\n' AND 17f1c830e0e4f4473714a895228afe97.f5dd4374a3e3af6a775cb6d6b22e8162 BETWEEN ''' || v_start_dt || ''' AND ''' || v_end_dt || ''')';\n\nv_antxn_sql5 := ' SELECT 17f1c830e0e4f4473714a895228afe97.7c11ab787cf6f310ca23c850e9034413e32f6dd38f333cde68119d1f277367cd,17f1c830e0e4f4473714a895228afe97.97ca09d0543afec109dac3f8d90db5305479098e904da91bb293c4391be1730d,ee021411832cdef9f5645744af000ace.21c984990c46996e1ca85db8ed7b326f,ee021411832cdef9f5645744af000ace.d16361da5462bcd47e380bc6594c4a0b,ee021411832cdef9f5645744af000ace.1afca342ab89e5b8c65c6c4c634b2186,ee021411832cdef9f5645744af000ace.46b0f23abe1bbed246cdeae858a9d7c0,ee021411832cdef9f5645744af000ace.7d5c34ff491d8080f7cce12ef8714e0c, ' ||\n' ee021411832cdef9f5645744af000ace.879553e6f3c76406b6c8d29e37a2e69a,ee021411832cdef9f5645744af000ace.518556df822338be02791d180820e13d, NVL(ee021411832cdef9f5645744af000ace.5bbae4d36d584cb827876fa4cf42a7bfe32f6dd38f333cde68119d1f277367cd,''0000000''),ee021411832cdef9f5645744af000ace.2900b8b236fcbe8e44fe5fcfac669c47,ee021411832cdef9f5645744af000ace.b504056baae1285c544838b332f2aca8, NULL as bsis_alw_applied, NULL as bsis_alw_ind, ' ||\n' ee021411832cdef9f5645744af000ace.fd14faf665d1fba59e286a758cfc3f36,ee021411832cdef9f5645744af000ace.d177076d05b72fe78cc13e30e11297c3,ee021411832cdef9f5645744af000ace.44a426a92c76e990f2c56bbb0de32572,ee021411832cdef9f5645744af000ace.bd944ad07a61f08a440316f300f49e5e51dd26a73c58dc7a9a33b2c1a62da4d3,ee021411832cdef9f5645744af000ace.14c7293453586609fa21a9e804c67eb4,ee021411832cdef9f5645744af000ace.573c1824f5c3781a8948011d0d6c3ba0,ee021411832cdef9f5645744af000ace.256c83b1469edbf80b14f57cca8165ae,ee021411832cdef9f5645744af000ace.de9589972fae450afab915cf8cb14f35, ' ||\n' ee021411832cdef9f5645744af000ace.c4287395385650d3d248e8156d4567fce32f6dd38f333cde68119d1f277367cd,ee021411832cdef9f5645744af000ace.148c3c4861243c3f12c31758272b07c8,ee021411832cdef9f5645744af000ace.ade04172dd0f8d09e65cf48322dce6dc,ee021411832cdef9f5645744af000ace.402439cf67ca5cfb8f1a0fcd4b2b57232d455cc26a95f84625118b8a36838b8e,ee021411832cdef9f5645744af000ace.15ff7b1b1e28686e2149bef07efdc76f,ee021411832cdef9f5645744af000ace.434a532d8f1cef2bd0fd568bb6b6caf6e32f6dd38f333cde68119d1f277367cd, ' ||\n' ee021411832cdef9f5645744af000ace.9c99f24fffd97c0c09611fa2974b4ab461bbd7bc0d2d67c7d7b11cb0a8d18d03,ee021411832cdef9f5645744af000ace.5938af20283ebdf83028907a807f67fd,ee021411832cdef9f5645744af000ace.27f4ff9d0a4a317e520e8da1e1945338,ee021411832cdef9f5645744af000ace.b642618fb5eebe48633e5a178b756487,ee021411832cdef9f5645744af000ace.d9b9c5751b188cc971fb6f5b0300aa48,ee021411832cdef9f5645744af000ace.57ba888a8306534b2dd97cec40a0e9bf,ee021411832cdef9f5645744af000ace.b82d2514c0cd80b4085c0ce92d576b5e,ee021411832cdef9f5645744af000ace.72d511475d7f9d12b8b9cc719bb17c21, ' ||\n' ee021411832cdef9f5645744af000ace.73e2bcc2359fe903f78484b1e3b30d39fce896ca0fbbf5a5d330f2803036eb44,ee021411832cdef9f5645744af000ace.1b3974313149f303f5e793165a21379b,ee021411832cdef9f5645744af000ace.7e3de7c40f0ad40445e80e83750bf747,ee021411832cdef9f5645744af000ace.adf5289e9a866af8b69b5e9d035b790b,0 as cmpny_vndr_nbr_actl, ';\n\nv_antxn_sql6 := ' ee021411832cdef9f5645744af000ace.a793addd328c78704a7e0e45ea3001d4,ee021411832cdef9f5645744af000ace.2ba3341ec6405c796e064d0d56de134d,NULL as cntrct_cpr_amt_ind,NULL as cntrct_cpr_bsis,NULL as cntrct_cpr_bsis_dt,NULL as cntrct_cpr_calc, ' ||\n' ee021411832cdef9f5645744af000ace.4af993e73e888cc9b53304f9d31806e075a332bf028585250008d9183409dc25,NULL as cntrct_cpr_nbr,NULL as cntrct_cpr_prod_grp,0 as comm_bsis_amt,ee021411832cdef9f5645744af000ace.01114b0b258a9dd7a6bb11579f76b0f55cb85c0b89d2f6a64dbcbd9b2c83fb90, ' ||\n' 17f1c830e0e4f4473714a895228afe97.3377a56ac3a8caf2bec5d2e95319521429ba5ee45e1d87a256e3a1b57750a92a,17f1c830e0e4f4473714a895228afe97.5112ab47fb19df73f8ed2678ddc0ecdb34ceb39ae2f66f21170198c2e55391b5,ee021411832cdef9f5645744af000ace.18359c91426b88e025cb389d4ba884d3cab538eaa715f7ec4a49d35342504bda,ee021411832cdef9f5645744af000ace.0d90dd7ce0016ac875611e81ff7dd7f040ac87632f536029556cbb1d9cc5b05b,ee021411832cdef9f5645744af000ace.07310c912dd99ea9c810de3167989b0f, ' ||\n' ee021411832cdef9f5645744af000ace.1855265b91ccef6e842d6a431c0295fc,ee021411832cdef9f5645744af000ace.582bd9075c3cdfa71b2052bbedf48cd5,ee021411832cdef9f5645744af000ace.666f5a215737b7caeb73d3450f23b384,ee021411832cdef9f5645744af000ace.c3f74ba437664ccb638c59297216940a,ee021411832cdef9f5645744af000ace.d1ce6707c3d1cc0e57096fdc21a5e64f,17f1c830e0e4f4473714a895228afe97.0054744cef9d8175c53e48a21807c4b4382d0f5d3019cd2839eb42d66c71274c, ' ||\n' 17f1c830e0e4f4473714a895228afe97.fecdf2b578d5771c3c985bce98c0022f1351bbde85c0ab91a84853573cd0dae5,ee021411832cdef9f5645744af000ace.852fa1e9f02f1ca2c75837f7146b2381,ee021411832cdef9f5645744af000ace.90680862928e1dcb55a4787b6ef9f3c2,NULL as cust_prod_nbr,17f1c830e0e4f4473714a895228afe97.7f599f836c449bebb92bb9757e86c603,ee021411832cdef9f5645744af000ace.839c4ffb4bfaae1bb58eab4dee67d96a,ee021411832cdef9f5645744af000ace.fa741a84bd7a01a1c4b5dc91364baac5,ee021411832cdef9f5645744af000ace.c4ffe3bd27523a268da639921856c18e,ee021411832cdef9f5645744af000ace.f971ad6dea1e4dd7fd2fbd36d31a3ae5, ' ||\n' ee021411832cdef9f5645744af000ace.20f36943212d3ebf01d42fc2a58a878e,ee021411832cdef9f5645744af000ace.7e33db42f9c57a6374e01e1886e762b2,ee021411832cdef9f5645744af000ace.b204827e6d3f8c94592eef11de23cb12,ee021411832cdef9f5645744af000ace.11212ff4cad5193c5fabb7a5d519894b,17f1c830e0e4f4473714a895228afe97.d55fbc4a3259962a8ab4fbedc0065134,17f1c830e0e4f4473714a895228afe97.e8a1b74c58655c6b8ffcb348b45f0a27,17f1c830e0e4f4473714a895228afe97.f3c7ed306cc6a6b3d6cfb40db08ba919e18a0efa177931495b66865407b6da30, ';\n\nv_antxn_sql7 := ' 17f1c830e0e4f4473714a895228afe97.58b87fef0b56bd2bd029967f2dfe55798b31ebbdd4a917cc13e004a9efd1e6bd,ee021411832cdef9f5645744af000ace.237609d37bbd0b9a205aa95e75daf38b,ee021411832cdef9f5645744af000ace.c6c7cc45578c678907522e08bb04a4ca,17f1c830e0e4f4473714a895228afe97.ae40ab54d363f05f40ae79e99066b4c9,NULL as END_DAY_CD,ee021411832cdef9f5645744af000ace.d4e40e976e264ee8a5a57f4f800d6c3b,ee021411832cdef9f5645744af000ace.1b4f3e751f125481ce5a66b8a939dec8, ' ||\n' ee021411832cdef9f5645744af000ace.0cba16030608e3ed20685d2d8baffd65,ee021411832cdef9f5645744af000ace.233e8c6acbaa45d323ec940cedfa07b4,ee021411832cdef9f5645744af000ace.baa23b8932072303310f88d528c93b04,ee021411832cdef9f5645744af000ace.d522ff7fd338224e811132198cf36dfe,ee021411832cdef9f5645744af000ace.caa7253bb26c1be62d920c15aa47acc7,ee021411832cdef9f5645744af000ace.54edae7157431b18e6d2baa702518a1c,ee021411832cdef9f5645744af000ace.f7a32a3094075407e6262fa7b4099334,ee021411832cdef9f5645744af000ace.db506a9e456768af2c1d2fe201b53b40,ee021411832cdef9f5645744af000ace.94885bbd805e611e54ee0eb5fb602d46,ee021411832cdef9f5645744af000ace.2ee1400a0150f0b220dd7bd6268d1e66, ' ||\n' ee021411832cdef9f5645744af000ace.47d7f1b55574f6efb03d7bd7c85359bf,ee021411832cdef9f5645744af000ace.8a3a832e9ed55880c82a6085970dfe5d,ee021411832cdef9f5645744af000ace.faaaf9cbe8897987592d529a771bbc17,ee021411832cdef9f5645744af000ace.b89d8f9a5bec26add637853438d6311f,ee021411832cdef9f5645744af000ace.be8d7c2ea76d3152927ebf8709ea0326,ee021411832cdef9f5645744af000ace.594b02cf2e907a3b818937eeeb74f778,ee021411832cdef9f5645744af000ace.d57db2a07c9cf48d0fc5985b35080af3,ee021411832cdef9f5645744af000ace.f49440ef078632ba0e0dd973e4161bbd ,ee021411832cdef9f5645744af000ace.721a8ad171b31ae60261431ccd51b52d as an_ldr_tm, ' ||\n' ee021411832cdef9f5645744af000ace.ef84040ad09159c2ca7623e36c53c140,ee021411832cdef9f5645744af000ace.27927710671f59a6b0cb9e9107e333f4,ee021411832cdef9f5645744af000ace.0e55e137a02bb10fcd61e2ad9262eeee,ee021411832cdef9f5645744af000ace.c4e3a9f99fa6f955de390a93819085ae,ee021411832cdef9f5645744af000ace.aae449a432058ba773088445191b55b8,ee021411832cdef9f5645744af000ace.f365b04dc92a1e1022e0319f12fb190d5704aa90e6338e2d3416f309dfed02a4,ee021411832cdef9f5645744af000ace.931b2ac4399b8a337f8d0ff67bab0e15, ' ||\n' 17f1c830e0e4f4473714a895228afe97.d641e89de57ff11c5990f70965a7a09e1351bbde85c0ab91a84853573cd0dae5,17f1c830e0e4f4473714a895228afe97.1c3f9404c7ddd5254f4ab6865d0c9ae75479098e904da91bb293c4391be1730d,ee021411832cdef9f5645744af000ace.3f5f78a3c918316a0e68170dc6b81e0c7ea8b5b6353c726ed7e410e230c7898b,ee021411832cdef9f5645744af000ace.96c68874ad1f02f292e30bc4034782949b55b8a266a9bb8e1e539a4ced76ec35,ee021411832cdef9f5645744af000ace.42c87cd307c51e63a144309315721b09,ee021411832cdef9f5645744af000ace.b2073366c46944d57f4d0f649386cab31d731bbdc4e3fb69a854112d4982eb99, ' ||\n' ee021411832cdef9f5645744af000ace.df0917aa3fd36489aa4d308fa97b06b76398e8624834825f4604477ca9ac3d8a,ee021411832cdef9f5645744af000ace.c137fdd918ede20e07fec7282883fa34e32f6dd38f333cde68119d1f277367cd, ee021411832cdef9f5645744af000ace.519b0b49b712aeada6335135be5ed90c,ee021411832cdef9f5645744af000ace.ba123fb99b0591dc3db0219d097aa590,ee021411832cdef9f5645744af000ace.46930193dd6f47d2a8ad6a585e4f0be5,17f1c830e0e4f4473714a895228afe97.69cc3d229f9a1af0e9235eb598b0b176,ee021411832cdef9f5645744af000ace.42dd45423319f918e704ed37d4dbb128, ' ||\n' ee021411832cdef9f5645744af000ace.5e937026da90c7e4a4e0bb540e061948eed1259e6b62783c664a0bc2e5e255a4,ee021411832cdef9f5645744af000ace.11da749d2c0d1e21a4c413489daad454,ee021411832cdef9f5645744af000ace.7321a4c88369e6acc22f8952a98e86b3e7fabc080d1e698e1941d756c183e979,ee021411832cdef9f5645744af000ace.b5019e4009d6240fe25b80db390c07601d731bbdc4e3fb69a854112d4982eb99,ee021411832cdef9f5645744af000ace.eacf342f9cfeb8791c58f614d70fdd7e, ';\n\nv_antxn_sql8 := ' ee021411832cdef9f5645744af000ace.b215402101f7a4f20fccac979c4d9b44,ee021411832cdef9f5645744af000ace.2dfeefdbbdd44f6feceb5ad393352003,ee021411832cdef9f5645744af000ace.1f74f0b1b8d3cc48e46d09d810561baafce896ca0fbbf5a5d330f2803036eb44,ee021411832cdef9f5645744af000ace.08ebf39fae82b72111b91ad0e9d1b680f90adc90d03e80e5248398220ac3e975,ee021411832cdef9f5645744af000ace.bd428d343074503f124765bf6dd4405a,ee021411832cdef9f5645744af000ace.a314fdf09456ce4ec24e4a372aadfac4e32f6dd38f333cde68119d1f277367cd, ' ||\n' ee021411832cdef9f5645744af000ace.0a2c5dcda219e7ce0b7d359c1288af1815ebda0b6e5cc8d4c919a8c71a9d07e4,ee021411832cdef9f5645744af000ace.645527f9434dbbc31dc6645c85255afffce896ca0fbbf5a5d330f2803036eb44,ee021411832cdef9f5645744af000ace.23e1fb1fa383dd566a7fa990e93f3b53f90adc90d03e80e5248398220ac3e975,ee021411832cdef9f5645744af000ace.9a862ca7920244817a1ea140c51520d3, CASE WHEN (ee021411832cdef9f5645744af000ace.d1ce6707c3d1cc0e57096fdc21a5e64f<>0) THEN ''CD''     ' ||\n' WHEN (ee021411832cdef9f5645744af000ace.d1ce6707c3d1cc0e57096fdc21a5e64f=0) THEN 17f1c830e0e4f4473714a895228afe97.995423505a0670f0daf31417466a6833 END AS ntv_ord_typ, ee021411832cdef9f5645744af000ace.73fc2afbbbce75dfdb12e62a0b628ace,ee021411832cdef9f5645744af000ace.4f53412a65a5d5ad453a0fed47eff7e2,ee021411832cdef9f5645744af000ace.192a0b9848c9b555676e26cadfe60852280a4c8731f60bb762471fb74030c9a2,ee021411832cdef9f5645744af000ace.721a8ad171b31ae60261431ccd51b52d as orig_ldr_tm,ee021411832cdef9f5645744af000ace.114e45b0f4a93a24527076d8af10c847, ' ||\n' NULL as pick_slot_actl, NVL(ee021411832cdef9f5645744af000ace.8708a839c00cf7a8852df326dbe38f05382d0f5d3019cd2839eb42d66c71274c,9), NVL(ee021411832cdef9f5645744af000ace.8df6e6099ebb67df7a104f33cfbeae411351bbde85c0ab91a84853573cd0dae5,''UNKNOWN''), NVL(ee021411832cdef9f5645744af000ace.106cff97a417dbe6c4979d1de5e4bc76382d0f5d3019cd2839eb42d66c71274c,''UNKNOWN''), ' ||\n' NVL(ee021411832cdef9f5645744af000ace.74b5cefda7cf1a7db3f0a3091333ac05,99999), NVL(ee021411832cdef9f5645744af000ace.c51ab05c6acd87cdbf495339cf5496c0dfb673c032e1fff141ac84551b91849a,''UNKNOWN''), NVL(ee021411832cdef9f5645744af000ace.80f3b424d7258a583f0dff0f4d4b159d382d0f5d3019cd2839eb42d66c71274c,99999),  NVL(ee021411832cdef9f5645744af000ace.f97b65e019a6572a4dfbc160d1d868ff382d0f5d3019cd2839eb42d66c71274c,''UNKNOWN''), ' ||\n' NVL(ee021411832cdef9f5645744af000ace.b5e1ce6b2ac430bf504b82957a3e2685,99999), NVL(ee021411832cdef9f5645744af000ace.8b8c72c349530db846280000957f636d,0), NVL(ee021411832cdef9f5645744af000ace.00d89839907d0ecec58003008d2713675479098e904da91bb293c4391be1730d,''UNKNOWN''), NVL(ee021411832cdef9f5645744af000ace.21a6675858ce67d43a7b6513100e2930dfb673c032e1fff141ac84551b91849a,99999), ';\n\nv_antxn_sql9 := ' ee021411832cdef9f5645744af000ace.d3268eabc4a7d98105fd85f9c9e62cd6e32ad436514bbe822b33de8bead744f3,ee021411832cdef9f5645744af000ace.3fe9d5910e4aa2a286626346047912cd,ee021411832cdef9f5645744af000ace.370a5aec6c948b64a7638f194c6ea1a7,NVL(ee021411832cdef9f5645744af000ace.4b398d884e397727aeb50b1bf2299e60f6283ea3dfab0ee7d1d005a13bf2d220,''000000''),ee021411832cdef9f5645744af000ace.f5dd4374a3e3af6a775cb6d6b22e8162,ee021411832cdef9f5645744af000ace.dc308088c6edc852389e07d62b4e115eb504f2aa575f48bf13473e6822c935b8, ' ||\n' ee021411832cdef9f5645744af000ace.d6feb3ce3930e1df4568d8ad2e34234acf410cec8b66c3bf5244f8405aa08384,NULL as prime_aft_bsis_adj_ind,ee021411832cdef9f5645744af000ace.8925f31e39c47f6a499461c43c69c448b504f2aa575f48bf13473e6822c935b8,ee021411832cdef9f5645744af000ace.5614e3e3773aa0cc945f4ce3d7f55482cf410cec8b66c3bf5244f8405aa08384,NULL as prime_bfr_bsis_adj_ind, ' ||\n' NULL as prime_calc_ind,ee021411832cdef9f5645744af000ace.8f83b112122ab5ea20567a0986f18a4fce26a64a7ac8d188835efcbfda026222,NULL AS prime_cnh_prc_br_cd,ee021411832cdef9f5645744af000ace.46d7a422a8cbe2cc9df276d91cea9b995d217b74c7c7793f18ddf55b60944bdc,ee021411832cdef9f5645744af000ace.46d7a422a8cbe2cc9df276d91cea9b99c275957d3d4505aa3b3f9275fb57479d, ' ||\n' ee021411832cdef9f5645744af000ace.68f9612aa320e6c42f047523bc77265d714ed54de59e7b661fe41c8a4929bcb4,17f1c830e0e4f4473714a895228afe97.9e023e08ce376b6e1b1b18dfa1cd167a11f37ee054443a481b60681df215350c,NULL AS prime_cntrct_each_mrk_typ,NULL AS prime_cntrct_nm,ee021411832cdef9f5645744af000ace.3d500acce5672772d9aaaba93ac5fab58f209e69b46e54a73064904b738a5c3c, ' ||\n' NULL AS prime_cost_by_po_nbr,NULL AS prime_cust_prc_on_ind,ee021411832cdef9f5645744af000ace.5937a869f7bd9c820fe4bbf4390bfe15f4147ca167a57859c2f78f7521e7a9a8,NULL AS prime_dvt_cost_aply,NULL AS Prime_dvt_cost_typ,NULL AS prime_dvtn_grp_nbr, ' ||\n' NULL as prime_dvtn_grp_nm,ee021411832cdef9f5645744af000ace.d25c1c21a833610b8c14ba7dc31f401b34f1d2dfe4534ac6536d03c083887f61, ';\n\nv_antxn_sql10 := ' ee021411832cdef9f5645744af000ace.d4ba11e2e02b33f9fd0b33ac2804b203,NULL AS prime_frght_bsis,NULL AS prime_hcp_pim_cat,NULL AS prime_hcp_pim_cls,NULL AS prime_hcp_pim_grp, ' ||\n' ee021411832cdef9f5645744af000ace.d6460c7c12f703d232e7f6c2e58d51f80f873df5d484258dcc90a1dbb092a70c,ee021411832cdef9f5645744af000ace.7d7fcbe8ff3b7fb363da4430682a5b201d731bbdc4e3fb69a854112d4982eb99,ee021411832cdef9f5645744af000ace.d8443c8ded2334896b08e5ee2acce1b5,NULL AS prime_mrk_ind,ee021411832cdef9f5645744af000ace.d81d4e426128e21b1087dce9be167f7164cec6fed2ad32c265b227fe3b030560, ' ||\n' NULL AS prime_prc_bsis,ee021411832cdef9f5645744af000ace.f6f5826da24fe9b11010359d8c51baf0f4147ca167a57859c2f78f7521e7a9a8,NULL as prime_prc_by,ee021411832cdef9f5645744af000ace.81e531facac782bf0b91d5d1e54849f939597585a983e4f93f6fdead239436bb,ee021411832cdef9f5645744af000ace.81e531facac782bf0b91d5d1e54849f98157f38ee21f2bc13ee1159420a59832,ee021411832cdef9f5645744af000ace.94380371d788e73dd0067ce3c911e2771d731bbdc4e3fb69a854112d4982eb99, ' ||\n' NULL AS prime_rbl_sis_mrgn,NULL AS prime_rbl_sis_per,NULL AS prime_rnd_cd,17f1c830e0e4f4473714a895228afe97.975e3b626d2e6ca06ed84fbbc5558de3bff56d587bce01d32a3d5e44d29ed4fa,NULL AS Prime_sis_flg,NULL AS Prime_updt_cyc, ' ||\n' 17f1c830e0e4f4473714a895228afe97.5b166c5fe66db413f1e228635901a0965479098e904da91bb293c4391be1730d,17f1c830e0e4f4473714a895228afe97.9033b904a17dc722bf77fb076a267f1529ba5ee45e1d87a256e3a1b57750a92a,ee021411832cdef9f5645744af000ace.63a91e2fd122990392b8c1467a67b61e,ee021411832cdef9f5645744af000ace.49dbc899bc8f9659472a5a3b3510790c,ee021411832cdef9f5645744af000ace.deeb4c7020bbcfd9e70cb4a8ed6ea0dc,ee021411832cdef9f5645744af000ace.f4684b698d1e8edd11bf71d8eac02595,ee021411832cdef9f5645744af000ace.ca329b170a83f14795f7d01859b0fe42, ' ||\n' ee021411832cdef9f5645744af000ace.a4657a147b058328748c801964a53707,ee021411832cdef9f5645744af000ace.2d45d761eb8d137835bca7a23010fab4,ee021411832cdef9f5645744af000ace.0a85164948783cdf0d4416f41905a154,ee021411832cdef9f5645744af000ace.6332016ddc9cad43c85dec8c86c2f732,NULL AS prod_stat_ind_actl,ee021411832cdef9f5645744af000ace.af173eb37e528a7cdb955e5b28cc23aa, ';\n\nv_antxn_sql11 := ' ee021411832cdef9f5645744af000ace.4b191f0271f76dbc6e6000be34023a3e,ee021411832cdef9f5645744af000ace.e1b1859b558f14ea9916a5dbcd02473a,ee021411832cdef9f5645744af000ace.82be0aaa7de54349da31cee325ab951e,ee021411832cdef9f5645744af000ace.4b413d0bbcae181494a218cf6afc155f,ee021411832cdef9f5645744af000ace.dc15696e1e997bad6131bf936574f406,ee021411832cdef9f5645744af000ace.082ab98f67c47545852bd9eeb87c14a4,ee021411832cdef9f5645744af000ace.eb518a41a6eb20e8bd4d58f85a481519,ee021411832cdef9f5645744af000ace.eb0ee2e145fdfe7c9893d205317a3e0e,ee021411832cdef9f5645744af000ace.88d58d1ceaa04b12e965be48693946b8, ' ||\n' ee021411832cdef9f5645744af000ace.82bb584f288c6982cf738bddb639ec2a,ee021411832cdef9f5645744af000ace.5b092195a30f8906453974d1170a1ea1,ee021411832cdef9f5645744af000ace.2b326fa6a91e72fbd4db5ddd134f321f,ee021411832cdef9f5645744af000ace.56957d29c1b09ea656dacf8a772dfe5f,ee021411832cdef9f5645744af000ace.7a6fef6a5c75091b25ef6dce0e9427dc,ee021411832cdef9f5645744af000ace.7468b15d94d4d5c372807c8570a644f6,17f1c830e0e4f4473714a895228afe97.9b5a3fd0647f1b6d616bd47466949ec2,ee021411832cdef9f5645744af000ace.5e4ad26cda1ec498500e65e5cc12f845,17f1c830e0e4f4473714a895228afe97.b7a93c415ffd854911e38dbd0033808a,ee021411832cdef9f5645744af000ace.b062726b7cf877dc4379a5ef28a428cb, ' ||\n' ee021411832cdef9f5645744af000ace.8a966af6e86bb16d9de33bf936d4fecb,ee021411832cdef9f5645744af000ace.b9a035db66bd8374526f94bc153f4762,ee021411832cdef9f5645744af000ace.67248d79aea7674e680fd38599fdb6f4,ee021411832cdef9f5645744af000ace.94692a617eedc131dbb1300ec6d66b17,17f1c830e0e4f4473714a895228afe97.caa2824077535938efbfeab4179ac71d,ee021411832cdef9f5645744af000ace.26ac88e7ae671a1b22c14c2fce77aa2d,17f1c830e0e4f4473714a895228afe97.b391f718d41b76652cd5f0d0063372b5,17f1c830e0e4f4473714a895228afe97.d5506821c4ea14a4d9ee0f0ce4e7652d,17f1c830e0e4f4473714a895228afe97.f2afece23955e23b9d2f09fce0b18c61382d0f5d3019cd2839eb42d66c71274c, ' ||\n' 17f1c830e0e4f4473714a895228afe97.0c499b9342241191d5d5fc19d9822401382d0f5d3019cd2839eb42d66c71274c,ee021411832cdef9f5645744af000ace.5c045c6ad55bfb143fea1cb9634d34af,NVL(ee021411832cdef9f5645744af000ace.abfa8e82cd46bbb827127b6cb2f5d6d5,0),ee021411832cdef9f5645744af000ace.bc85f0acd4f5b2becdd7efc34c3a2003,ee021411832cdef9f5645744af000ace.5867b4a2e2d1a7c0792d8569c0d90b1f,ee021411832cdef9f5645744af000ace.e2657ceeba5b709bafb65e0820feb4e2b6e1b396dbe14782b1b65b60d5d80e45,ee021411832cdef9f5645744af000ace.d36e400304221073c1c3bb586ed7de9f,ee021411832cdef9f5645744af000ace.92d4d6b1028cc8f6b6a6a50394af943a, ' ||\n' ee021411832cdef9f5645744af000ace.b7982b81d447f11a0953881190e528cae32f6dd38f333cde68119d1f277367cd,ee021411832cdef9f5645744af000ace.1db1b1099d6c7239a882ba6364f0e12d,ee021411832cdef9f5645744af000ace.c7a5550e66e03d37be3af7810a1cd82e1d731bbdc4e3fb69a854112d4982eb99,ee021411832cdef9f5645744af000ace.b929d681ced63c6b203aa9a1d8973da4,ee021411832cdef9f5645744af000ace.aea2b843066cbf7530af94deb507a420,ee021411832cdef9f5645744af000ace.500f21991e85f5b9a78ad5961f1fbbc7,ee021411832cdef9f5645744af000ace.ccf8d88f2d37f3171da2121ab22e9330, ' ||\n' ee021411832cdef9f5645744af000ace.60a12efca79b9e843a21f9dd325e6a80e32f6dd38f333cde68119d1f277367cd,ee021411832cdef9f5645744af000ace.424607a0ca73330c3cc1e84dfe4afa64,ee021411832cdef9f5645744af000ace.d3e77785919f0b458a86d736b61dd5a7,ee021411832cdef9f5645744af000ace.f2e27750b8738746a93b585e377bbeb9,ee021411832cdef9f5645744af000ace.c2e82d4936217cdd8ea6375bc48b58b2,ee021411832cdef9f5645744af000ace.eaa03e417a6b67a32172cc9dca631f77,ee021411832cdef9f5645744af000ace.224811ad2521818a46ceb20442ea1122,ee021411832cdef9f5645744af000ace.467a168a7499c57b1859198a7dac7be0 ';\n\nIF v_div_nbr = '9999' THEN\nv_antxn_sql12 := ' FROM ' || v_src_tbl || ' an,  txn_hdr slc ' ||\n' WHERE ee021411832cdef9f5645744af000ace.26ac88e7ae671a1b22c14c2fce77aa2d = ''AN'' AND 17f1c830e0e4f4473714a895228afe97.839c4ffb4bfaae1bb58eab4dee67d96a = ee021411832cdef9f5645744af000ace.839c4ffb4bfaae1bb58eab4dee67d96a ' ||\n' AND 17f1c830e0e4f4473714a895228afe97.f5dd4374a3e3af6a775cb6d6b22e8162 = ee021411832cdef9f5645744af000ace.f5dd4374a3e3af6a775cb6d6b22e8162 AND 17f1c830e0e4f4473714a895228afe97.be8d7c2ea76d3152927ebf8709ea0326 = ee021411832cdef9f5645744af000ace.be8d7c2ea76d3152927ebf8709ea0326 AND 17f1c830e0e4f4473714a895228afe97.852fa1e9f02f1ca2c75837f7146b2381 = ee021411832cdef9f5645744af000ace.852fa1e9f02f1ca2c75837f7146b2381 ' ||\n' AND 17f1c830e0e4f4473714a895228afe97.d1ce6707c3d1cc0e57096fdc21a5e64f = ee021411832cdef9f5645744af000ace.d1ce6707c3d1cc0e57096fdc21a5e64f AND 17f1c830e0e4f4473714a895228afe97.1d4c395e47c3a12291a4e6c06178aa0c = 1 AND NVL(ee021411832cdef9f5645744af000ace.2ee1400a0150f0b220dd7bd6268d1e66,0)=0 ' ;\nELSE\n  v_antxn_sql12 := ' FROM ' || v_src_tbl || ' an,  txn_hdr slc ' ||\n' WHERE ee021411832cdef9f5645744af000ace.26ac88e7ae671a1b22c14c2fce77aa2d = ''AN'' AND 17f1c830e0e4f4473714a895228afe97.839c4ffb4bfaae1bb58eab4dee67d96a = ee021411832cdef9f5645744af000ace.839c4ffb4bfaae1bb58eab4dee67d96a ' ||\n' AND 17f1c830e0e4f4473714a895228afe97.f5dd4374a3e3af6a775cb6d6b22e8162 = ee021411832cdef9f5645744af000ace.f5dd4374a3e3af6a775cb6d6b22e8162 AND 17f1c830e0e4f4473714a895228afe97.be8d7c2ea76d3152927ebf8709ea0326 = ee021411832cdef9f5645744af000ace.be8d7c2ea76d3152927ebf8709ea0326 AND 17f1c830e0e4f4473714a895228afe97.852fa1e9f02f1ca2c75837f7146b2381 = ee021411832cdef9f5645744af000ace.852fa1e9f02f1ca2c75837f7146b2381 ' ||\n' AND 17f1c830e0e4f4473714a895228afe97.d1ce6707c3d1cc0e57096fdc21a5e64f = ee021411832cdef9f5645744af000ace.d1ce6707c3d1cc0e57096fdc21a5e64f AND 17f1c830e0e4f4473714a895228afe97.1d4c395e47c3a12291a4e6c06178aa0c = 1 AND 17f1c830e0e4f4473714a895228afe97.839c4ffb4bfaae1bb58eab4dee67d96a = ' || v_div_nbr || '  AND NVL(ee021411832cdef9f5645744af000ace.2ee1400a0150f0b220dd7bd6268d1e66,0)=0 ';\nEND IF;\n\nv_an_addfilter_sql := ' AND ee021411832cdef9f5645744af000ace.f5dd4374a3e3af6a775cb6d6b22e8162 BETWEEN ''' || v_start_dt || ''' AND ''' || v_end_dt || '''';\n\n\nEXECUTE IMMEDIATE v_ins_sql1 || v_ins_sql2 || v_ins_sql3 || v_ins_sql4 || v_ins_sql5 || v_ins_sql6 || v_antxn_sql1 || v_antxn_sql2 || v_antxn_sql3 || v_antxn_sql4 ||\nv_antxn_sql5 || v_antxn_sql6 || v_antxn_sql7 || v_antxn_sql8 || v_antxn_sql9 || v_antxn_sql10 || v_antxn_sql11 || v_antxn_sql12 || v_an_addfilter_sql ;\n\nCOMMIT;\n\ndbms_output.put_line ('STEP 1: Load complete for AN txn');\n\n\nBEGIN\n\nIF v_div_nbr = '9999' THEN \nv_audt_sql1 := ' SELECT COUNT(*), SUM(NVL(GRS_SLS_EXTND,0)), SUM(NVL(QTY_SHIP,0)), SUM(NVL(TTL_DVT,0)), SUM(NVL(NON_PROD_ALWNC,0)), SUM(NVL(NON_PROD_CHRG,0)), SUM(NVL(PROD_ALW,0)), SUM(NVL(PROD_CHRG,0)) FROM '|| v_src_tbl ||\n              ' an WHERE 1=1 AND NVL(ee021411832cdef9f5645744af000ace.2ee1400a0150f0b220dd7bd6268d1e66,0)=0 ' || v_an_addfilter_sql;\n\nv_audt_sql2 := ' SELECT COUNT(*), SUM(NVL(GRS_SLS_EXTND,0)), SUM(NVL(QTY_SHIP,0)), SUM(NVL(TTL_DVT,0)), SUM(NVL(NON_PROD_ALWNC,0)), SUM(NVL(NON_PROD_CHRG,0)), SUM(NVL(PROD_ALW,0)), SUM(NVL(PROD_CHRG,0)) FROM '|| v_tgt_tbl ||\n             ' an WHERE 1=1  AND NVL(ee021411832cdef9f5645744af000ace.2ee1400a0150f0b220dd7bd6268d1e66,0)=0 ' || v_an_addfilter_sql ;\n\nELSE\nv_audt_sql1 := ' SELECT COUNT(*), SUM(NVL(GRS_SLS_EXTND,0)), SUM(NVL(QTY_SHIP,0)), SUM(NVL(TTL_DVT,0)), SUM(NVL(NON_PROD_ALWNC,0)), SUM(NVL(NON_PROD_CHRG,0)), SUM(NVL(PROD_ALW,0)), SUM(NVL(PROD_CHRG,0)) FROM '|| v_src_tbl ||\n              ' an WHERE 1=1 AND div_nbr = ' || v_div_nbr || '  AND NVL(ee021411832cdef9f5645744af000ace.2ee1400a0150f0b220dd7bd6268d1e66,0)=0  ' || v_an_addfilter_sql;\n\nv_audt_sql2 := ' SELECT COUNT(*), SUM(NVL(GRS_SLS_EXTND,0)), SUM(NVL(QTY_SHIP,0)), SUM(NVL(TTL_DVT,0)), SUM(NVL(NON_PROD_ALWNC,0)), SUM(NVL(NON_PROD_CHRG,0)), SUM(NVL(PROD_ALW,0)), SUM(NVL(PROD_CHRG,0)) FROM '|| v_tgt_tbl ||\n             ' an WHERE 1=1 AND div_nbr = ' || v_div_nbr || '  AND NVL(ee021411832cdef9f5645744af000ace.2ee1400a0150f0b220dd7bd6268d1e66,0)=0  ' || v_an_addfilter_sql ;\nEND IF;\n\n\nEXECUTE IMMEDIATE v_audt_sql1 INTO v_src_cnt, v_src_grs_sls, v_src_qty_ship, v_src_ttl_dvt, v_src_np_alw, v_src_np_chrg, v_src_prd_alw, v_src_prd_chrg;\n\nCOMMIT;\n\ndbms_output.put_line ('AUDIT 1: complete first audit');\n\nEXECUTE IMMEDIATE v_audt_sql2 INTO v_tgt_cnt, v_tgt_grs_sls, v_tgt_qty_ship, v_tgt_ttl_dvt, v_tgt_np_alw, v_tgt_np_chrg, v_tgt_prd_alw, v_tgt_prd_chrg;\n\nCOMMIT;\n\ndbms_output.put_line ('AUDIT 2: complete second audit');\n\nIF v_src_cnt > 0 THEN\n  IF (v_src_cnt = v_tgt_cnt) AND (v_src_grs_sls = v_tgt_grs_sls) AND (v_src_qty_ship = v_tgt_qty_ship) AND (v_src_ttl_dvt = v_tgt_ttl_dvt)\n  AND (v_src_np_alw = v_tgt_np_alw) AND (v_src_np_chrg = v_tgt_np_chrg) AND (v_src_prd_alw = v_tgt_prd_alw) AND (v_src_prd_chrg = v_tgt_prd_chrg) THEN\n    dbms_output.put_line ('src cnt ' || v_src_cnt || '; tgt cnt ' || v_tgt_cnt || '; ');\n    dbms_output.put_line ('src grs_sls ' || v_src_grs_sls || '; tgt grs_sls ' || v_tgt_grs_sls || '; ');\n    dbms_output.put_line ('src qty_ship ' || v_src_qty_ship || '; tgt qty_ship ' || v_tgt_qty_ship || '; ');\n    dbms_output.put_line ('src ttl_dvt ' || v_src_ttl_dvt || '; tgt ttl_dvt ' || v_tgt_ttl_dvt || '; ');\n    dbms_output.put_line ('v_src_np_alw ' || v_src_np_alw || '; v_tgt_np_alw ' || v_tgt_np_alw || '; ');\n    dbms_output.put_line ('v_src_np_chrg ' || v_src_np_chrg || '; v_tgt_np_chrg ' || v_tgt_np_chrg || '; ');\n    dbms_output.put_line ('v_src_prd_alw ' || v_src_prd_alw || '; v_tgt_prd_alw ' || v_tgt_prd_alw || '; ');\n    dbms_output.put_line ('v_src_prd_chrg ' || v_src_prd_chrg || '; v_tgt_prd_chrg ' || v_tgt_prd_chrg || '; ');\n\n    RETURN 0; \n  ELSE\n    DBMS_OUTPUT.PUT_LINE ('source count ' || v_src_cnt || ' target count ' || v_tgt_cnt || 'source grs sls ' || v_src_grs_sls || 'target grs sls ' ||\n    v_tgt_grs_sls || 'source qty ship ' || v_src_qty_ship || 'target qty ship ' || v_tgt_qty_ship || 'source ttl dvt ' || v_src_ttl_dvt ||\n    'target ttl dvt ' || v_tgt_ttl_dvt);\n    dbms_output.put_line ('v_src_np_alw ' || v_src_np_alw || '; v_tgt_np_alw ' || v_tgt_np_alw || '; ');\n    dbms_output.put_line ('v_src_np_chrg ' || v_src_np_chrg || '; v_tgt_np_chrg ' || v_tgt_np_chrg || '; ');\n    dbms_output.put_line ('v_src_prd_alw ' || v_src_prd_alw || '; v_tgt_prd_alw ' || v_tgt_prd_alw || '; ');\n    dbms_output.put_line ('v_src_prd_chrg ' || v_src_prd_chrg || '; v_tgt_prd_chrg ' || v_tgt_prd_chrg || '; ');\n    dbms_output.put_line (v_ins_sql1 || v_ins_sql2 || v_ins_sql3 || v_ins_sql4 || v_ins_sql5 || v_ins_sql6 || v_antxn_sql1 || v_antxn_sql2 || v_antxn_sql3 || v_antxn_sql4 ||\n  v_antxn_sql5 || v_antxn_sql6 || v_antxn_sql7 || v_antxn_sql8 || v_antxn_sql9 || v_antxn_sql10 || v_antxn_sql11 || v_antxn_sql12 || v_an_addfilter_sql);\n    RETURN 20;\n  END IF;\nEND IF;\n\nRETURN 0;\n\nEND;\n\n  EXCEPTION\n    WHEN OTHERS THEN\n\n      p_out_message := '*ERROR in AN historical update script ' || SQLCODE || ' ' ||\n                       SQLERRM;\n      dbms_output.put_line(SQLCODE);\n      dbms_output.put_line(SQLERRM);\n      RETURN 20;\n\nEND FN_XDM_SALES_CORP_UPD_AN;\n/",
            "upstream_dependencies": [],
            "downstream_dependencies": [],
            "dag_location": "null",
            "gantt_location": "null",
            "created_at": "null",
            "updated_at": "null"
        },
        {
            "name": "FN_CUST_CLS_DLY",
            "encrypted_name": "e048cb729ea7e0498c639d0c4635e261",
            "type": "function",
            "database": "null",
            "encrypted_database": "null",
            "schema": "XDMADM",
            "encrypted_schema": "0e03d5c46556a742ba46252698396ef2",
            "fully_qualified_name": "XDMADM.FN_CUST_CLS_DLY",
            "encrypted_fqn": "0e03d5c46556a742ba46252698396ef2.e048cb729ea7e0498c639d0c4635e261",
            "synonyms": [],
            "metadata_analysis": "CREATE OR REPLACE FUNCTION \"0e03d5c46556a742ba46252698396ef2\".\"e048cb729ea7e0498c639d0c4635e261\" (v_in_odate     IN VARCHAR2,\n                         v_in_ldr_tm    IN NUMBER,\n                         v_in_div_nbr   IN NUMBER,\n                         v_in_cust_nbr  IN VARCHAR2 DEFAULT NULL)\n   RETURN NUMBER IS\n   \n\n   \n   v_odate                          DATE := TO_DATE(v_in_odate, 'YYYYMMDD');\n   v_src_schema                     VARCHAR2(20) := 'XDMADM';\n   v_tgt_schema                     VARCHAR2(20) := 'XDMADM';\n   v_tbl_prfx                       VARCHAR2(20) := 'CUST_CLSFCTN_';\n   v_end_dt                         DATE;\n   v_fisc_yr                        NUMBER(4);\n   v_cur_fisc_yr                    NUMBER(4);\n   v_fisc_mth_of_yr                 VARCHAR2(2);\n   v_cur_fisc_mth_of_yr             VARCHAR2(2);\n   v_cur_fisc_yr_mth                VARCHAR(18);\n   v_fisc_wk_of_yr                  NUMBER(2);\n   v_fisc_wk_strt_dt                DATE;\n   v_fisc_wk_strt_dt_yrago          DATE;\n   v_fisc_mth_end_dt_yrago          DATE;\n   v_fisc_wk_of_prd                 NUMBER(2);\n   v_py_max_wk                      NUMBER(2);\n   v_2y_ago_max_wk                  NUMBER(2);\n   v_cnt                            NUMBER;\n   v_cnt2                           NUMBER;\n   v_ctas_stmt                      VARCHAR2(32767);\n   v_ctas_stmt1                      VARCHAR2(32767);\n   v_mrg_stmt                       VARCHAR2(5000);\n   v_cust_vw                        VARCHAR2(1000);\n   v_prior_fisc_mth_strt_dt         DATE;\n   v_last_fisc_mth_of_yr            NUMBER;\n   v_fisc_yr_last_mth               NUMBER;\n   v_fisc_mth_strt_dt_yrago         DATE;\n   v_fisc_mth_strt_dt               DATE;\n   v_fisc_mth_end_dt                DATE;\n   v_fisc_yr_three_mth_ago          NUMBER;\n   v_fisc_mth_of_yr_three_mth_ago   VARCHAR(2);\n   v_fisc_yr_six_mth_ago            NUMBER;\n   v_fisc_mth_of_yr_six_mth_ago     VARCHAR(2);\n   v_fisc_yr_mth_six_mth_ago        VARCHAR2(18);\n   v_fisc_yr_mth_three_mth_ago      VARCHAR2(18);\n   v_last_fisc_yr_mth               VARCHAR2(18);\n   v_fisc_yr_mth                    VARCHAR2(18);\n   l_insert_cnt                     NUMBER;\n   l_trans_insert                   VARCHAR2(32767);\n   l_fn_start                       DATE;\n   v_net_acct_pim_suprcls_id        NUMBER;\n\n   \n   CURSOR c_ap_tgp IS\n      SELECT ca9aa42c2ae0d34c5dafc0c63ded894a.852fa1e9f02f1ca2c75837f7146b2381,\n             ca9aa42c2ae0d34c5dafc0c63ded894a.839c4ffb4bfaae1bb58eab4dee67d96a,\n             ca9aa42c2ae0d34c5dafc0c63ded894a.7f599f836c449bebb92bb9757e86c603,\n             ca9aa42c2ae0d34c5dafc0c63ded894a.2603c45be643e5cd8f9c6dad3bee6cb3,\n             ca9aa42c2ae0d34c5dafc0c63ded894a.eeb3cae1b83726e8df7c8d2367b9cf4b1d731bbdc4e3fb69a854112d4982eb99,\n             ca9aa42c2ae0d34c5dafc0c63ded894a.37175a70b8190fbf717de5f6ebc49b0a,\n             CASE\n                WHEN ca9aa42c2ae0d34c5dafc0c63ded894a.37175a70b8190fbf717de5f6ebc49b0a <> 0 THEN CASE WHEN ca9aa42c2ae0d34c5dafc0c63ded894a.5eb47379f9cd1fd0a9110e76b90fc8c4 <> 0 THEN ca9aa42c2ae0d34c5dafc0c63ded894a.37175a70b8190fbf717de5f6ebc49b0a / ca9aa42c2ae0d34c5dafc0c63ded894a.5eb47379f9cd1fd0a9110e76b90fc8c4 ELSE 0 END\n                ELSE NULL\n             END\n                unfrm_grs_tgp_per_drop\n        FROM (  SELECT de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.852fa1e9f02f1ca2c75837f7146b2381,\n                       de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.839c4ffb4bfaae1bb58eab4dee67d96a,\n                       de459e2fe7f96e4d958537b31b946b26.52982d3bbc1ebc2720d9504c7ea2ed3f.7f599f836c449bebb92bb9757e86c603,\n                       de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.2603c45be643e5cd8f9c6dad3bee6cb3,\n                       de459e2fe7f96e4d958537b31b946b26.ca1faaabe4743a8a00a4d208ab58b2b3.eeb3cae1b83726e8df7c8d2367b9cf4b1d731bbdc4e3fb69a854112d4982eb99,\n                       SUM(CASE\n                              WHEN NVL(de459e2fe7f96e4d958537b31b946b26.2c04d82ed0aa1cc9bce2cf2c0548b268.89f3df82917b692fe64dca942d924e7c, 1) <> 97 THEN\n                                 NVL(de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.2ee1400a0150f0b220dd7bd6268d1e66 - de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.c6c7cc45578c678907522e08bb04a4ca - (CASE WHEN de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.487c194c34aee6c67551aa2cdd2358ace32f6dd38f333cde68119d1f277367cd = 'P' THEN NVL(de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.d206d123f59f85e26ec113e33b465295,0) ELSE 0 END) + de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.b7982b81d447f11a0953881190e528cae32f6dd38f333cde68119d1f277367cd, 0)\n                              ELSE\n                                 0\n                           END)\n                          unfrm_grs_tgp,\n                       COUNT(DISTINCT CASE\n                                         WHEN NVL(de459e2fe7f96e4d958537b31b946b26.2c04d82ed0aa1cc9bce2cf2c0548b268.89f3df82917b692fe64dca942d924e7c, 1) <> 97\n                                          AND de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.26ac88e7ae671a1b22c14c2fce77aa2d = 'RT' THEN\n                                            de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.839c4ffb4bfaae1bb58eab4dee67d96a || de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.852fa1e9f02f1ca2c75837f7146b2381 || de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.f5dd4374a3e3af6a775cb6d6b22e8162 || de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.faaaf9cbe8897987592d529a771bbc17 || de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.c4ffe3bd27523a268da639921856c18e\n                                         ELSE\n                                            NULL\n                                      END)\n                          drop_cnt\n                  FROM de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c s,\n                       de459e2fe7f96e4d958537b31b946b26.dec387908a0954ddc8689c4ad37c8a3c d,\n                       de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001 t,\n                       de459e2fe7f96e4d958537b31b946b26.ca1faaabe4743a8a00a4d208ab58b2b3 p,\n                       de459e2fe7f96e4d958537b31b946b26.2c04d82ed0aa1cc9bce2cf2c0548b268 pim,\n                       de459e2fe7f96e4d958537b31b946b26.52982d3bbc1ebc2720d9504c7ea2ed3f c\n                 WHERE NVL(de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.a2b201123c685e8cc48b5468cb4a449361bbd7bc0d2d67c7d7b11cb0a8d18d03, de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.839c4ffb4bfaae1bb58eab4dee67d96a) = de459e2fe7f96e4d958537b31b946b26.dec387908a0954ddc8689c4ad37c8a3c.839c4ffb4bfaae1bb58eab4dee67d96a\n                   AND de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.f5dd4374a3e3af6a775cb6d6b22e8162 = de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.222ccb1d1746bcdb2365f29b3da0b613\n                   AND de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.852fa1e9f02f1ca2c75837f7146b2381 = de459e2fe7f96e4d958537b31b946b26.52982d3bbc1ebc2720d9504c7ea2ed3f.852fa1e9f02f1ca2c75837f7146b2381\n                   AND de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.839c4ffb4bfaae1bb58eab4dee67d96a = de459e2fe7f96e4d958537b31b946b26.52982d3bbc1ebc2720d9504c7ea2ed3f.839c4ffb4bfaae1bb58eab4dee67d96a\n                   AND de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.d3268eabc4a7d98105fd85f9c9e62cd6e32ad436514bbe822b33de8bead744f3 = de459e2fe7f96e4d958537b31b946b26.2c04d82ed0aa1cc9bce2cf2c0548b268.d3268eabc4a7d98105fd85f9c9e62cd6e32ad436514bbe822b33de8bead744f3\n                   AND de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.467a168a7499c57b1859198a7dac7be0 IS NULL\n                   AND de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.2603c45be643e5cd8f9c6dad3bee6cb3 = de459e2fe7f96e4d958537b31b946b26.ca1faaabe4743a8a00a4d208ab58b2b3.2603c45be643e5cd8f9c6dad3bee6cb3\n                   AND de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.839c4ffb4bfaae1bb58eab4dee67d96a = v_in_div_nbr\n                   AND de459e2fe7f96e4d958537b31b946b26.dec387908a0954ddc8689c4ad37c8a3c.b8c6ab19cb6e726c38f24d1885346ea3 <> 'CC'\n\t\t\t\t   AND  (case when NVL (de459e2fe7f96e4d958537b31b946b26.dec387908a0954ddc8689c4ad37c8a3c.c712a9ab5ef100c5807fa96123dac48b,'USF') <> 'USF'\n\t\t\t\t\t\t and NVL(de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.a2b201123c685e8cc48b5468cb4a449361bbd7bc0d2d67c7d7b11cb0a8d18d03, de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.839c4ffb4bfaae1bb58eab4dee67d96a) = de459e2fe7f96e4d958537b31b946b26.dec387908a0954ddc8689c4ad37c8a3c.839c4ffb4bfaae1bb58eab4dee67d96a\n\t\t\t\t\t     and de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.f5dd4374a3e3af6a775cb6d6b22e8162 < NVL(de459e2fe7f96e4d958537b31b946b26.dec387908a0954ddc8689c4ad37c8a3c.3db9275d5f5cb2e9d918e77dbabdd97b,de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.f5dd4374a3e3af6a775cb6d6b22e8162)\n\t\t\t\t\t     then 'NON_USFGL' else 'USFGL' END) ='USFGL'  \n                   \n                   AND EXISTS (SELECT 'X'\n                                 FROM de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c s2, de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001 t2\n                                WHERE de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.f5dd4374a3e3af6a775cb6d6b22e8162 = de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.222ccb1d1746bcdb2365f29b3da0b613\n                                  AND de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.839c4ffb4bfaae1bb58eab4dee67d96a = v_in_div_nbr\n                                  AND de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.467a168a7499c57b1859198a7dac7be0 IS NULL\n                                  AND de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.224811ad2521818a46ceb20442ea1122 IS NULL\n                                  AND de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.721a8ad171b31ae60261431ccd51b52d > v_in_ldr_tm\n                                  AND de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.26ac88e7ae671a1b22c14c2fce77aa2d = 'AP'\n                                  AND de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.852fa1e9f02f1ca2c75837f7146b2381 = de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.852fa1e9f02f1ca2c75837f7146b2381\n                                  AND de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.839c4ffb4bfaae1bb58eab4dee67d96a = de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.839c4ffb4bfaae1bb58eab4dee67d96a\n                                  AND de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.2603c45be643e5cd8f9c6dad3bee6cb3 = de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.2603c45be643e5cd8f9c6dad3bee6cb3)\n              GROUP BY de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.852fa1e9f02f1ca2c75837f7146b2381,\n                       de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.839c4ffb4bfaae1bb58eab4dee67d96a,\n                       de459e2fe7f96e4d958537b31b946b26.52982d3bbc1ebc2720d9504c7ea2ed3f.7f599f836c449bebb92bb9757e86c603,\n                       de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.2603c45be643e5cd8f9c6dad3bee6cb3,\n                       de459e2fe7f96e4d958537b31b946b26.ca1faaabe4743a8a00a4d208ab58b2b3.eeb3cae1b83726e8df7c8d2367b9cf4b1d731bbdc4e3fb69a854112d4982eb99) x;\n\n   TYPE t_ap_tgp IS TABLE OF c_ap_tgp%ROWTYPE;\n\n   r_ap_tgp                         t_ap_tgp;\n\n   \n   CURSOR tagp_drops(\n      c_fisc_yr      IN            NUMBER,\n      c_fisc_mth_of_yr IN          VARCHAR2,\n      c_end_dt       IN            DATE,\n      c_in_div_nbr   IN            NUMBER,\n      c_last_fisc_yr_mth IN        VARCHAR2,\n      c_fisc_yr_mth_three_mth_ago IN VARCHAR2,\n      c_fisc_yr_mth_six_mth_ago IN VARCHAR2,\n      c_prior_fisc_mth_strt_dt IN  DATE) IS\n      WITH cust_list AS (SELECT DISTINCT cust_sk, cust_nbr, div_nbr\n                           FROM de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c\n                          WHERE xfer_from_dt IS NOT NULL\n                            AND div_nbr = v_in_div_nbr\n                            AND ldr_tm > v_in_ldr_tm)\n      SELECT cust_sk,\n             cust_nbr,\n             div_nbr,\n             fisc_yr,\n             fisc_mth_of_yr,\n             fisc_yr_mth,\n             cust_clsfctn,\n             fisc_mth_strt_dt,\n             fisc_mth_end_dt,\n             nbr_of_wk_ordr_last_yr_mth,\n             nbr_of_wk_ordr_this_yr_mth,\n             CASE WHEN fisc_yr_mth < v_last_fisc_yr_mth THEN NVL(next_prd_cust_clsfctn, 'OTHER') ELSE NULL END\n                next_fisc_mth_cust_clsfctn,\n             CASE\n                WHEN fisc_yr_mth < v_fisc_yr_mth_three_mth_ago THEN NVL(three_month_cust_clsfctn, 'OTHER')\n                ELSE NULL\n             END\n                three_mth_cust_clsfctn,\n             CASE WHEN fisc_yr_mth < v_fisc_yr_mth_six_mth_ago THEN NVL(six_month_cust_clsfctn, 'OTHER') ELSE NULL END\n                six_mth_cust_clsfctn,\n             CASE WHEN fisc_yr_mth < v_last_fisc_yr_mth THEN NVL(nbr_of_wk_ordr_next_mth, 0) ELSE 0 END\n                nbr_of_wk_ordr_next_mth,\n             CASE WHEN fisc_yr_mth < v_last_fisc_yr_mth THEN NVL(next_fmth_unfrm_grs_sls_extnd, 0) ELSE 0 END\n                next_fmth_unfrm_grs_sls_extnd, \n             CASE WHEN fisc_yr_mth < v_last_fisc_yr_mth THEN NVL(next_fmth_unfrm_tagp, 0) ELSE 0 END\n                next_fmth_unfrm_tagp, \n             CASE WHEN fisc_yr_mth < v_last_fisc_yr_mth THEN NVL(next_fmth_unfrm_grs_tgp, 0) ELSE 0 END\n                next_fmth_unfrm_grs_tgp,\n             CASE WHEN fisc_yr_mth < v_last_fisc_yr_mth THEN NVL(next_fmth_unfrm_qty_ship, 0) ELSE 0 END\n                next_fmth_unfrm_qty_ship \n        FROM (SELECT de459e2fe7f96e4d958537b31b946b26.1127751f1872aa967342f1fcf6b2ff72e472b097974b0d6a9a7d2ed170324906.7f599f836c449bebb92bb9757e86c603,\n                     de459e2fe7f96e4d958537b31b946b26.1127751f1872aa967342f1fcf6b2ff72e472b097974b0d6a9a7d2ed170324906.852fa1e9f02f1ca2c75837f7146b2381,\n                     de459e2fe7f96e4d958537b31b946b26.1127751f1872aa967342f1fcf6b2ff72e472b097974b0d6a9a7d2ed170324906.839c4ffb4bfaae1bb58eab4dee67d96a,\n                     de459e2fe7f96e4d958537b31b946b26.1127751f1872aa967342f1fcf6b2ff72e472b097974b0d6a9a7d2ed170324906.ab30d6d679879cfacfe389b97d1d3f0e,\n                     de459e2fe7f96e4d958537b31b946b26.1127751f1872aa967342f1fcf6b2ff72e472b097974b0d6a9a7d2ed170324906.e1d446673288adb6d5f219d0aa82d37a,\n                     de459e2fe7f96e4d958537b31b946b26.1127751f1872aa967342f1fcf6b2ff72e472b097974b0d6a9a7d2ed170324906.2603c45be643e5cd8f9c6dad3bee6cb3,\n                     de459e2fe7f96e4d958537b31b946b26.1127751f1872aa967342f1fcf6b2ff72e472b097974b0d6a9a7d2ed170324906.d3ec1a21507970329af1c66ef244cdefe32f6dd38f333cde68119d1f277367cd,\n                     de459e2fe7f96e4d958537b31b946b26.1127751f1872aa967342f1fcf6b2ff72e472b097974b0d6a9a7d2ed170324906.e17b4db24503ad4d9365a15bec98eef6,\n                     nbr_of_wk_ordr_last_yr_mth,\n                     nbr_of_wk_ordr_this_yr_mth,\n                     cust_clsfctn,\n                     LEAD(cust_clsfctn, 1, NULL)\n                        OVER (PARTITION BY de459e2fe7f96e4d958537b31b946b26.1127751f1872aa967342f1fcf6b2ff72e472b097974b0d6a9a7d2ed170324906.852fa1e9f02f1ca2c75837f7146b2381, de459e2fe7f96e4d958537b31b946b26.1127751f1872aa967342f1fcf6b2ff72e472b097974b0d6a9a7d2ed170324906.839c4ffb4bfaae1bb58eab4dee67d96a\n                              ORDER BY de459e2fe7f96e4d958537b31b946b26.1127751f1872aa967342f1fcf6b2ff72e472b097974b0d6a9a7d2ed170324906.839c4ffb4bfaae1bb58eab4dee67d96a,\n                                       de459e2fe7f96e4d958537b31b946b26.1127751f1872aa967342f1fcf6b2ff72e472b097974b0d6a9a7d2ed170324906.852fa1e9f02f1ca2c75837f7146b2381,\n                                       de459e2fe7f96e4d958537b31b946b26.1127751f1872aa967342f1fcf6b2ff72e472b097974b0d6a9a7d2ed170324906.ab30d6d679879cfacfe389b97d1d3f0e,\n                                       de459e2fe7f96e4d958537b31b946b26.1127751f1872aa967342f1fcf6b2ff72e472b097974b0d6a9a7d2ed170324906.e1d446673288adb6d5f219d0aa82d37a)\n                        AS next_prd_cust_clsfctn,\n                     LEAD(de459e2fe7f96e4d958537b31b946b26.1127751f1872aa967342f1fcf6b2ff72e472b097974b0d6a9a7d2ed170324906.8a5c1eda3416fa5daae04a2980452d8a, 3, NULL)\n                        OVER (PARTITION BY de459e2fe7f96e4d958537b31b946b26.1127751f1872aa967342f1fcf6b2ff72e472b097974b0d6a9a7d2ed170324906.852fa1e9f02f1ca2c75837f7146b2381, de459e2fe7f96e4d958537b31b946b26.1127751f1872aa967342f1fcf6b2ff72e472b097974b0d6a9a7d2ed170324906.839c4ffb4bfaae1bb58eab4dee67d96a\n                              ORDER BY de459e2fe7f96e4d958537b31b946b26.1127751f1872aa967342f1fcf6b2ff72e472b097974b0d6a9a7d2ed170324906.839c4ffb4bfaae1bb58eab4dee67d96a,\n                                       de459e2fe7f96e4d958537b31b946b26.1127751f1872aa967342f1fcf6b2ff72e472b097974b0d6a9a7d2ed170324906.852fa1e9f02f1ca2c75837f7146b2381,\n                                       de459e2fe7f96e4d958537b31b946b26.1127751f1872aa967342f1fcf6b2ff72e472b097974b0d6a9a7d2ed170324906.ab30d6d679879cfacfe389b97d1d3f0e,\n                                       de459e2fe7f96e4d958537b31b946b26.1127751f1872aa967342f1fcf6b2ff72e472b097974b0d6a9a7d2ed170324906.e1d446673288adb6d5f219d0aa82d37a)\n                        AS three_month_cust_clsfctn,\n                     LEAD(de459e2fe7f96e4d958537b31b946b26.1127751f1872aa967342f1fcf6b2ff72e472b097974b0d6a9a7d2ed170324906.8a5c1eda3416fa5daae04a2980452d8a, 6, NULL)\n                        OVER (PARTITION BY de459e2fe7f96e4d958537b31b946b26.1127751f1872aa967342f1fcf6b2ff72e472b097974b0d6a9a7d2ed170324906.852fa1e9f02f1ca2c75837f7146b2381, de459e2fe7f96e4d958537b31b946b26.1127751f1872aa967342f1fcf6b2ff72e472b097974b0d6a9a7d2ed170324906.839c4ffb4bfaae1bb58eab4dee67d96a\n                              ORDER BY de459e2fe7f96e4d958537b31b946b26.1127751f1872aa967342f1fcf6b2ff72e472b097974b0d6a9a7d2ed170324906.839c4ffb4bfaae1bb58eab4dee67d96a,\n                                       de459e2fe7f96e4d958537b31b946b26.1127751f1872aa967342f1fcf6b2ff72e472b097974b0d6a9a7d2ed170324906.852fa1e9f02f1ca2c75837f7146b2381,\n                                       de459e2fe7f96e4d958537b31b946b26.1127751f1872aa967342f1fcf6b2ff72e472b097974b0d6a9a7d2ed170324906.ab30d6d679879cfacfe389b97d1d3f0e,\n                                       de459e2fe7f96e4d958537b31b946b26.1127751f1872aa967342f1fcf6b2ff72e472b097974b0d6a9a7d2ed170324906.e1d446673288adb6d5f219d0aa82d37a)\n                        AS six_month_cust_clsfctn,\n                     LEAD(nbr_of_wk_ordr_this_yr_mth, 1, NULL)\n                        OVER (PARTITION BY de459e2fe7f96e4d958537b31b946b26.1127751f1872aa967342f1fcf6b2ff72e472b097974b0d6a9a7d2ed170324906.852fa1e9f02f1ca2c75837f7146b2381, de459e2fe7f96e4d958537b31b946b26.1127751f1872aa967342f1fcf6b2ff72e472b097974b0d6a9a7d2ed170324906.839c4ffb4bfaae1bb58eab4dee67d96a\n                              ORDER BY de459e2fe7f96e4d958537b31b946b26.1127751f1872aa967342f1fcf6b2ff72e472b097974b0d6a9a7d2ed170324906.839c4ffb4bfaae1bb58eab4dee67d96a,\n                                       de459e2fe7f96e4d958537b31b946b26.1127751f1872aa967342f1fcf6b2ff72e472b097974b0d6a9a7d2ed170324906.852fa1e9f02f1ca2c75837f7146b2381,\n                                       de459e2fe7f96e4d958537b31b946b26.1127751f1872aa967342f1fcf6b2ff72e472b097974b0d6a9a7d2ed170324906.ab30d6d679879cfacfe389b97d1d3f0e,\n                                       de459e2fe7f96e4d958537b31b946b26.1127751f1872aa967342f1fcf6b2ff72e472b097974b0d6a9a7d2ed170324906.e1d446673288adb6d5f219d0aa82d37a)\n                        AS nbr_of_wk_ordr_next_mth,\n                     LEAD(unfrm_grs_sls_extnd, 1, NULL)\n                        OVER (PARTITION BY de459e2fe7f96e4d958537b31b946b26.1127751f1872aa967342f1fcf6b2ff72e472b097974b0d6a9a7d2ed170324906.852fa1e9f02f1ca2c75837f7146b2381, de459e2fe7f96e4d958537b31b946b26.1127751f1872aa967342f1fcf6b2ff72e472b097974b0d6a9a7d2ed170324906.839c4ffb4bfaae1bb58eab4dee67d96a\n                              ORDER BY de459e2fe7f96e4d958537b31b946b26.1127751f1872aa967342f1fcf6b2ff72e472b097974b0d6a9a7d2ed170324906.839c4ffb4bfaae1bb58eab4dee67d96a,\n                                       de459e2fe7f96e4d958537b31b946b26.1127751f1872aa967342f1fcf6b2ff72e472b097974b0d6a9a7d2ed170324906.852fa1e9f02f1ca2c75837f7146b2381,\n                                       de459e2fe7f96e4d958537b31b946b26.1127751f1872aa967342f1fcf6b2ff72e472b097974b0d6a9a7d2ed170324906.ab30d6d679879cfacfe389b97d1d3f0e,\n                                       de459e2fe7f96e4d958537b31b946b26.1127751f1872aa967342f1fcf6b2ff72e472b097974b0d6a9a7d2ed170324906.e1d446673288adb6d5f219d0aa82d37a)\n                        AS next_fmth_unfrm_grs_sls_extnd, \n                     LEAD(unfrm_tagp, 1, NULL)\n                        OVER (PARTITION BY de459e2fe7f96e4d958537b31b946b26.1127751f1872aa967342f1fcf6b2ff72e472b097974b0d6a9a7d2ed170324906.852fa1e9f02f1ca2c75837f7146b2381, de459e2fe7f96e4d958537b31b946b26.1127751f1872aa967342f1fcf6b2ff72e472b097974b0d6a9a7d2ed170324906.839c4ffb4bfaae1bb58eab4dee67d96a\n                              ORDER BY de459e2fe7f96e4d958537b31b946b26.1127751f1872aa967342f1fcf6b2ff72e472b097974b0d6a9a7d2ed170324906.839c4ffb4bfaae1bb58eab4dee67d96a,\n                                       de459e2fe7f96e4d958537b31b946b26.1127751f1872aa967342f1fcf6b2ff72e472b097974b0d6a9a7d2ed170324906.852fa1e9f02f1ca2c75837f7146b2381,\n                                       de459e2fe7f96e4d958537b31b946b26.1127751f1872aa967342f1fcf6b2ff72e472b097974b0d6a9a7d2ed170324906.ab30d6d679879cfacfe389b97d1d3f0e,\n                                       de459e2fe7f96e4d958537b31b946b26.1127751f1872aa967342f1fcf6b2ff72e472b097974b0d6a9a7d2ed170324906.e1d446673288adb6d5f219d0aa82d37a)\n                        AS next_fmth_unfrm_tagp, \n                     LEAD(unfrm_grs_tgp, 1, NULL)\n                        OVER (PARTITION BY de459e2fe7f96e4d958537b31b946b26.1127751f1872aa967342f1fcf6b2ff72e472b097974b0d6a9a7d2ed170324906.852fa1e9f02f1ca2c75837f7146b2381, de459e2fe7f96e4d958537b31b946b26.1127751f1872aa967342f1fcf6b2ff72e472b097974b0d6a9a7d2ed170324906.839c4ffb4bfaae1bb58eab4dee67d96a\n                              ORDER BY de459e2fe7f96e4d958537b31b946b26.1127751f1872aa967342f1fcf6b2ff72e472b097974b0d6a9a7d2ed170324906.839c4ffb4bfaae1bb58eab4dee67d96a,\n                                       de459e2fe7f96e4d958537b31b946b26.1127751f1872aa967342f1fcf6b2ff72e472b097974b0d6a9a7d2ed170324906.852fa1e9f02f1ca2c75837f7146b2381,\n                                       de459e2fe7f96e4d958537b31b946b26.1127751f1872aa967342f1fcf6b2ff72e472b097974b0d6a9a7d2ed170324906.ab30d6d679879cfacfe389b97d1d3f0e,\n                                       de459e2fe7f96e4d958537b31b946b26.1127751f1872aa967342f1fcf6b2ff72e472b097974b0d6a9a7d2ed170324906.e1d446673288adb6d5f219d0aa82d37a)\n                        AS next_fmth_unfrm_grs_tgp,\n                     LEAD(unfrm_qty_ship, 1, NULL)\n                        OVER (PARTITION BY de459e2fe7f96e4d958537b31b946b26.1127751f1872aa967342f1fcf6b2ff72e472b097974b0d6a9a7d2ed170324906.852fa1e9f02f1ca2c75837f7146b2381, de459e2fe7f96e4d958537b31b946b26.1127751f1872aa967342f1fcf6b2ff72e472b097974b0d6a9a7d2ed170324906.839c4ffb4bfaae1bb58eab4dee67d96a\n                              ORDER BY de459e2fe7f96e4d958537b31b946b26.1127751f1872aa967342f1fcf6b2ff72e472b097974b0d6a9a7d2ed170324906.839c4ffb4bfaae1bb58eab4dee67d96a,\n                                       de459e2fe7f96e4d958537b31b946b26.1127751f1872aa967342f1fcf6b2ff72e472b097974b0d6a9a7d2ed170324906.852fa1e9f02f1ca2c75837f7146b2381,\n                                       de459e2fe7f96e4d958537b31b946b26.1127751f1872aa967342f1fcf6b2ff72e472b097974b0d6a9a7d2ed170324906.ab30d6d679879cfacfe389b97d1d3f0e,\n                                       de459e2fe7f96e4d958537b31b946b26.1127751f1872aa967342f1fcf6b2ff72e472b097974b0d6a9a7d2ed170324906.e1d446673288adb6d5f219d0aa82d37a)\n                        AS next_fmth_unfrm_qty_ship \n                FROM de459e2fe7f96e4d958537b31b946b26.1127751f1872aa967342f1fcf6b2ff72e472b097974b0d6a9a7d2ed170324906 c\n               WHERE de459e2fe7f96e4d958537b31b946b26.1127751f1872aa967342f1fcf6b2ff72e472b097974b0d6a9a7d2ed170324906.d3ec1a21507970329af1c66ef244cdefe32f6dd38f333cde68119d1f277367cd <= v_prior_fisc_mth_strt_dt\n                 AND de459e2fe7f96e4d958537b31b946b26.1127751f1872aa967342f1fcf6b2ff72e472b097974b0d6a9a7d2ed170324906.839c4ffb4bfaae1bb58eab4dee67d96a = v_in_div_nbr\n                 AND de459e2fe7f96e4d958537b31b946b26.1127751f1872aa967342f1fcf6b2ff72e472b097974b0d6a9a7d2ed170324906.852fa1e9f02f1ca2c75837f7146b2381 IN (SELECT DISTINCT cust_nbr FROM cust_list));\n\n   TYPE t_tagp_drops IS TABLE OF tagp_drops%ROWTYPE;\n\n   r_tagp_drops                     t_tagp_drops;\nBEGIN\n   l_fn_start   := SYSDATE;\n\n   \n   \n   \n   \n   \n   CASE TRIM(TO_CHAR(v_odate, 'DAY'))\n      WHEN 'SATURDAY' THEN\n         v_end_dt   := v_odate;\n      ELSE\n         v_end_dt   := TRUNC(v_odate, 'DAY') - 1; \n   END CASE;\n\n   SELECT de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.ab30d6d679879cfacfe389b97d1d3f0e, de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.e1d446673288adb6d5f219d0aa82d37a, de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.2603c45be643e5cd8f9c6dad3bee6cb3\n     INTO v_fisc_yr, v_fisc_mth_of_yr, v_fisc_yr_mth\n     FROM de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001 t\n    WHERE de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.222ccb1d1746bcdb2365f29b3da0b613 = v_end_dt;\n\n   SELECT de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.ab30d6d679879cfacfe389b97d1d3f0e,\n          de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.e1d446673288adb6d5f219d0aa82d37a,\n          de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.cb5e253886eb30a93e66cbf95203a754,\n          de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.3f2fdebe4ba3a24bdf16fdac5827ebfb,\n          de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.2603c45be643e5cd8f9c6dad3bee6cb3\n     INTO v_cur_fisc_yr,\n          v_cur_fisc_mth_of_yr,\n          v_fisc_wk_of_yr,\n          v_fisc_wk_of_prd,\n          v_cur_fisc_yr_mth\n     FROM de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001 t\n    WHERE de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.222ccb1d1746bcdb2365f29b3da0b613 = v_odate;\n\n   SELECT MIN(de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.222ccb1d1746bcdb2365f29b3da0b613), MIN(de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.7953dad27b9ff5d770ad768175bcaa56)\n     INTO v_fisc_wk_strt_dt, v_fisc_wk_strt_dt_yrago\n     FROM de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001 t\n    WHERE de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.ab30d6d679879cfacfe389b97d1d3f0e = v_cur_fisc_yr\n      AND de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.cb5e253886eb30a93e66cbf95203a754 = v_fisc_wk_of_yr;\n\n   SELECT MAX(de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.7953dad27b9ff5d770ad768175bcaa56),\n          MIN(clndr_dt_yrago),\n          MIN(clndr_dt),\n          MAX(clndr_dt)\n     INTO v_fisc_mth_end_dt_yrago,\n          v_fisc_mth_strt_dt_yrago,\n          v_fisc_mth_strt_dt,\n          v_fisc_mth_end_dt\n     FROM de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001 t\n    WHERE de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.ab30d6d679879cfacfe389b97d1d3f0e = v_cur_fisc_yr\n      AND de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.e1d446673288adb6d5f219d0aa82d37a = v_cur_fisc_mth_of_yr;\n\n   SELECT MAX(de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.cb5e253886eb30a93e66cbf95203a754)\n     INTO v_py_max_wk \n     FROM de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001 t\n    WHERE de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.ab30d6d679879cfacfe389b97d1d3f0e = v_fisc_yr - 1;\n\n   SELECT MAX(de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.cb5e253886eb30a93e66cbf95203a754)\n     INTO v_2y_ago_max_wk \n     FROM de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001 t\n    WHERE de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.ab30d6d679879cfacfe389b97d1d3f0e = v_fisc_yr - 2;\n\n   IF v_fisc_wk_of_prd <> 1 THEN\n      v_fisc_wk_strt_dt_yrago   := NULL;\n      v_fisc_mth_end_dt_yrago   := NULL;\n   END IF;\n\n   SELECT MIN(clndr_dt)\n     INTO v_prior_fisc_mth_strt_dt\n     FROM de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001\n    WHERE fisc_yr_mth IN (SELECT MAX(de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.2603c45be643e5cd8f9c6dad3bee6cb3)\n                            FROM de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001 a\n                           WHERE de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.2603c45be643e5cd8f9c6dad3bee6cb3 < (SELECT de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.2603c45be643e5cd8f9c6dad3bee6cb3\n                                                    FROM de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001 a\n                                                   WHERE de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.222ccb1d1746bcdb2365f29b3da0b613 = v_odate));\n\n   SELECT MAX(fisc_mth_of_yr), MAX(fisc_yr), MAX(fisc_yr_mth)\n     INTO v_last_fisc_mth_of_yr, v_fisc_yr_last_mth, v_last_fisc_yr_mth\n     FROM de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001 a\n    WHERE fisc_yr_mth = (SELECT MAX(de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.2603c45be643e5cd8f9c6dad3bee6cb3) \n                           FROM de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001 a\n                          WHERE de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.2603c45be643e5cd8f9c6dad3bee6cb3 < (SELECT de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.2603c45be643e5cd8f9c6dad3bee6cb3\n                                                   FROM de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001 a\n                                                  WHERE de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.222ccb1d1746bcdb2365f29b3da0b613 = v_odate));\n\n   \n\n   SELECT CASE WHEN fisc_mth_of_yr > 6 THEN fisc_yr_mth - 6 ELSE fisc_yr_mth - 94 END\n     INTO v_fisc_yr_mth_six_mth_ago\n     FROM de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001\n    WHERE clndr_dt = v_odate;\n\n   \n   SELECT CASE WHEN fisc_mth_of_yr > 3 THEN fisc_yr_mth - 3 ELSE fisc_yr_mth - 91 END\n     INTO v_fisc_yr_mth_three_mth_ago\n     FROM de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001\n    WHERE clndr_dt = v_odate;\n\n   \n   SELECT param_value_nbr\n     INTO v_net_acct_pim_suprcls_id\n     FROM de459e2fe7f96e4d958537b31b946b26.de40ae7be8b2eb3858d46af8d107f3db\n    WHERE app_name = 'MERLIN'\n      AND param_type = 'NON_ADMIN_PIM_SUPRCLS_ID'\n      AND param_code = 'UPPER_LIMIT';\n\n   DBMS_OUTPUT.put_line('Processing year: ' || v_fisc_yr || ' period: ' || v_fisc_mth_of_yr || ' ' || SYSTIMESTAMP);\n\n   IF v_in_cust_nbr IS NULL THEN\n      \n      SELECT COUNT( * )\n        INTO v_cnt\n        FROM de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c\n       WHERE div_nbr = v_in_div_nbr\n         AND xfer_from_dt IS NOT NULL\n         AND ldr_tm > v_in_ldr_tm;\n\n      \n      \n      v_cust_vw   :=\n         q'[(SELECT de459e2fe7f96e4d958537b31b946b26.52982d3bbc1ebc2720d9504c7ea2ed3f.7f599f836c449bebb92bb9757e86c603, de459e2fe7f96e4d958537b31b946b26.52982d3bbc1ebc2720d9504c7ea2ed3f.852fa1e9f02f1ca2c75837f7146b2381, de459e2fe7f96e4d958537b31b946b26.52982d3bbc1ebc2720d9504c7ea2ed3f.839c4ffb4bfaae1bb58eab4dee67d96a, de459e2fe7f96e4d958537b31b946b26.52982d3bbc1ebc2720d9504c7ea2ed3f.55739765f192316a366e35ac5cc043c2561b89cb9074f747f5165d6920afabf2\n             FROM de459e2fe7f96e4d958537b31b946b26.52982d3bbc1ebc2720d9504c7ea2ed3f cc\n             WHERE EXISTS (SELECT 'X'\n                     FROM de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c\n                    WHERE div_nbr = ]'\n                  || v_in_div_nbr\n                  || q'[ AND xfer_from_dt IS NOT NULL\n                      AND ldr_tm > ]'\n                     || v_in_ldr_tm\n                     || q'[ AND cust_nbr = de459e2fe7f96e4d958537b31b946b26.52982d3bbc1ebc2720d9504c7ea2ed3f.852fa1e9f02f1ca2c75837f7146b2381\n                      AND div_nbr = de459e2fe7f96e4d958537b31b946b26.52982d3bbc1ebc2720d9504c7ea2ed3f.839c4ffb4bfaae1bb58eab4dee67d96a)) c]';\n\n   ELSE \n      \n      SELECT COUNT( * )\n        INTO v_cnt\n        FROM de459e2fe7f96e4d958537b31b946b26.52982d3bbc1ebc2720d9504c7ea2ed3f\n       WHERE div_nbr = v_in_div_nbr\n         AND cust_nbr = v_in_cust_nbr;\n\n      \n      \n      v_cust_vw   :=\n         '(SELECT  cust_nbr, div_nbr, cust_sk, first_rt_fisc_yr_mth FROM de459e2fe7f96e4d958537b31b946b26.52982d3bbc1ebc2720d9504c7ea2ed3f\n              WHERE   div_nbr = '\n         || v_in_div_nbr\n         || ' AND     cust_nbr = '''\n         || v_in_cust_nbr\n         || ''') c ';\n   END IF;\n\n   DBMS_OUTPUT.put_line('v_cnt ' || v_cnt);\n\n   IF v_cnt > 0 THEN\n      \n      DBMS_OUTPUT.put_line(\n         'Dropping table ' || v_src_schema || '.' || v_tbl_prfx || v_in_div_nbr || ' ' || SYSTIMESTAMP);\n\n      BEGIN\n         EXECUTE IMMEDIATE 'DROP TABLE ' || v_src_schema || '.' || v_tbl_prfx || v_in_div_nbr;\n\n         DBMS_OUTPUT.put_line(\n            'Table ' || v_src_schema || '.' || v_tbl_prfx || v_in_div_nbr || ' dropped ' || SYSTIMESTAMP);\n      EXCEPTION\n         WHEN OTHERS THEN\n            DBMS_OUTPUT.put_line(   'Table '\n                                 || v_src_schema\n                                 || '.'\n                                 || v_tbl_prfx\n                                 || v_in_div_nbr\n                                 || ' does not exist. Continue processing...');\n      END;\n\n      \n      v_ctas_stmt    :=\n         'CREATE TABLE ' || v_src_schema || '.' || v_tbl_prfx || v_in_div_nbr\n         || q'[ TABLESPACE SALES_TS NOLOGGING AS\n                   \n                   SELECT aaaa197c8a04b78be299c4e8679a5a84.852fa1e9f02f1ca2c75837f7146b2381,\n                          aaaa197c8a04b78be299c4e8679a5a84.839c4ffb4bfaae1bb58eab4dee67d96a,\n                          aaaa197c8a04b78be299c4e8679a5a84.ab30d6d679879cfacfe389b97d1d3f0e,\n                          aaaa197c8a04b78be299c4e8679a5a84.e1d446673288adb6d5f219d0aa82d37a,\n                          0 as fisc_wk_of_yr,\n                            CASE\n                               WHEN no_cd_unfrm_sales_ty > 0\n                                AND no_cd_unfrm_sales_ly > 0 THEN\n                                  'PRIOR YEAR'\n                               WHEN no_cd_unfrm_sales_ty > 0\n                                AND no_cd_unfrm_sales_ly <= 0 THEN\n                                  'NEW'\n                               WHEN no_cd_unfrm_sales_ty <= 0\n                                AND no_cd_unfrm_sales_ly > 0 THEN\n                                  'LOST'\n                               ELSE\n                                  'OTHER'\n                            END\n                               AS cust_clsfctn,\n                          de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.d3ec1a21507970329af1c66ef244cdefe32f6dd38f333cde68119d1f277367cd,\n                          de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.e17b4db24503ad4d9365a15bec98eef6,\n                          de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.d3ec1a21507970329af1c66ef244cdefb274599470f4daf85f36de136c376169,\n                          de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.21c571650d05fd041faddc812b8444acf43d3e611ef8d78ea0e7840aa66f8834,\n                          sysdate as crt_dt,\n                          nbr_wk_ly as nbr_of_wk_ordr_last_yr_mth,\n                          nbr_wk_ty as nbr_of_wk_ordr_this_yr_mth,\n                          aaaa197c8a04b78be299c4e8679a5a84.7f599f836c449bebb92bb9757e86c603,\n                          aaaa197c8a04b78be299c4e8679a5a84.2603c45be643e5cd8f9c6dad3bee6cb3,\n                          aaaa197c8a04b78be299c4e8679a5a84.eb6a312932db943ec140f42c7c8998cf,\n                          aaaa197c8a04b78be299c4e8679a5a84.630c48bbfe25ea68a239339f24d37c79,\n                          aaaa197c8a04b78be299c4e8679a5a84.8f04118f95170a63ad8f7d89fff56418,\n                          aaaa197c8a04b78be299c4e8679a5a84.2ee1400a0150f0b220dd7bd6268d1e66,\n                          aaaa197c8a04b78be299c4e8679a5a84.dc15696e1e997bad6131bf936574f406,\n                          aaaa197c8a04b78be299c4e8679a5a84.afcae1f8310cd038c0633aeaa179c10c280a4c8731f60bb762471fb74030c9a2,\n                          aaaa197c8a04b78be299c4e8679a5a84.56d34efa4c0a22d07b3f8a07122ca048,\n                          aaaa197c8a04b78be299c4e8679a5a84.ccf8d88f2d37f3171da2121ab22e9330,\n                          aaaa197c8a04b78be299c4e8679a5a84.8ce27e49d994e1c605cb69746b9cfcb2 as fisc_mth_sos_cnt,\n                          aaaa197c8a04b78be299c4e8679a5a84.c3a904d6986fe2e41d14bc8e27a86788,\n                          aaaa197c8a04b78be299c4e8679a5a84.37175a70b8190fbf717de5f6ebc49b0a,\n                          CASE\n                             WHEN aaaa197c8a04b78be299c4e8679a5a84.37175a70b8190fbf717de5f6ebc49b0a <> 0 THEN CASE WHEN drops <> 0 THEN aaaa197c8a04b78be299c4e8679a5a84.37175a70b8190fbf717de5f6ebc49b0a / aaaa197c8a04b78be299c4e8679a5a84.630c48bbfe25ea68a239339f24d37c79 ELSE 0 END\n                             ELSE NULL\n                          END\n                             unfrm_grs_tgp_per_drop,\n                          aaaa197c8a04b78be299c4e8679a5a84.e8a9f207120b23947059cce42696d8f133cb242de526ddafe282bd57488cedea,\n                          CASE WHEN NVL(net_acct_flg, 'N') = 'Y' THEN aaaa197c8a04b78be299c4e8679a5a84.7f599f836c449bebb92bb9757e86c603 ELSE NULL END net_acct_cust_sk\n                   FROM (SELECT cust_nbr,\n                                div_nbr,\n                                fisc_yr,\n                                fisc_mth_of_yr,\n                                sum(NVL(sales_ty,0)) AS sales_ty,\n                                sum(NVL(sales_ly,0)) AS sales_ly,\n                                SUM(NVL(no_cd_unfrm_sales_ty, 0)) AS no_cd_unfrm_sales_ty,\n                                SUM(NVL(no_cd_unfrm_sales_ly, 0)) AS no_cd_unfrm_sales_ly,\n                                sum(nvl(nbr_wk_ly,0)) nbr_wk_ly,\n                                sum(nvl(nbr_wk_ty,0)) nbr_wk_ty,\n                                cust_sk,\n                                fisc_yr_mth,\n                                sum(nvl(tagp,0)) tagp,\n                                sum(nvl(drops,0)) drops,\n                                sum(nvl(tagp_per_drop,0)) tagp_per_drop,\n                                sum(nvl(grs_sls_extnd,0)) grs_sls_extnd,\n                                sum(nvl(qty_ship,0)) qty_ship,\n                                sum(nvl(unfrm_grs_sls_extnd,0)) unfrm_grs_sls_extnd,\n                                sum(nvl(unfrm_tagp,0)) unfrm_tagp,\n                                sum(nvl(unfrm_qty_ship,0)) unfrm_qty_ship,\n                                sum(nvl(sos_cnt,0)) sos_cnt,\n                                MAX(NVL(cat_sold, 0)) cat_sold,\n                                SUM(NVL(unfrm_grs_tgp, 0)) unfrm_grs_tgp,\n                                cust_tenure_mth_actl,\n                                MAX(NVL(net_acct_flg, 0)) net_acct_flg\n                         FROM\n                         (SELECT 6f037dd8c55b34c0a958bc6e5d1c45f6.852fa1e9f02f1ca2c75837f7146b2381,\n                                6f037dd8c55b34c0a958bc6e5d1c45f6.839c4ffb4bfaae1bb58eab4dee67d96a,\n                                6f037dd8c55b34c0a958bc6e5d1c45f6.ab30d6d679879cfacfe389b97d1d3f0e,\n                                6f037dd8c55b34c0a958bc6e5d1c45f6.e1d446673288adb6d5f219d0aa82d37a,\n                                CASE\n                                  WHEN 15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.ab30d6d679879cfacfe389b97d1d3f0e = ]'\n         || v_fisc_yr\n         || q'[ THEN NVL(15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.2ee1400a0150f0b220dd7bd6268d1e66,0)\n                                  ELSE 0\n                                END sales_ty,\n                                CASE\n                                  WHEN 15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.ab30d6d679879cfacfe389b97d1d3f0e = ]'\n         || v_fisc_yr\n         || q'[-1 THEN NVL(15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.2ee1400a0150f0b220dd7bd6268d1e66,0)\n                                  ELSE 0\n                                END sales_ly,\n                                CASE\n                                  WHEN 15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.ab30d6d679879cfacfe389b97d1d3f0e = ]'\n         || v_fisc_yr\n         || q'[ THEN NVL(15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.ab081c412fc18694a8297c8dfdea984cd9542f5039f4af6f9fa4a3007112f536,0)\n                                  ELSE 0\n                                END no_cd_unfrm_sales_ty,\n                                CASE\n                                  WHEN 15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.ab30d6d679879cfacfe389b97d1d3f0e = ]'\n         || v_fisc_yr\n         || q'[-1 THEN NVL(15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.ab081c412fc18694a8297c8dfdea984cd9542f5039f4af6f9fa4a3007112f536,0)\n                                  ELSE 0\n                                END no_cd_unfrm_sales_ly,\n                                case when 15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.ab30d6d679879cfacfe389b97d1d3f0e = ]'\n         || v_fisc_yr\n         || q'[-1 then 15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.b8329c7377e022434715b0dbbad8440e end nbr_wk_ly,\n                                case when 15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.ab30d6d679879cfacfe389b97d1d3f0e = ]'\n         || v_fisc_yr\n         || q'[ then 15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.b8329c7377e022434715b0dbbad8440e end nbr_wk_ty,\n                                6f037dd8c55b34c0a958bc6e5d1c45f6.7f599f836c449bebb92bb9757e86c603,\n                                6f037dd8c55b34c0a958bc6e5d1c45f6.2603c45be643e5cd8f9c6dad3bee6cb3,\n                                6f037dd8c55b34c0a958bc6e5d1c45f6.e8a9f207120b23947059cce42696d8f133cb242de526ddafe282bd57488cedea,\n                                case when 15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.ab30d6d679879cfacfe389b97d1d3f0e = ]'\n         || v_fisc_yr\n         || q'[ then 15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.eb6a312932db943ec140f42c7c8998cf end tagp,\n                                case when 15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.ab30d6d679879cfacfe389b97d1d3f0e = ]'\n         || v_fisc_yr\n         || q'[ then 15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.630c48bbfe25ea68a239339f24d37c79 end drops,\n                                case when 15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.ab30d6d679879cfacfe389b97d1d3f0e = ]'\n         || v_fisc_yr\n         || q'[ then 15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.8f04118f95170a63ad8f7d89fff56418 end tagp_per_drop,\n                                case when 15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.ab30d6d679879cfacfe389b97d1d3f0e = ]'\n         || v_fisc_yr\n         || q'[ then 15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.2ee1400a0150f0b220dd7bd6268d1e66 end grs_sls_extnd,\n                                case when 15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.ab30d6d679879cfacfe389b97d1d3f0e = ]'\n         || v_fisc_yr\n         || q'[ then 15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.dc15696e1e997bad6131bf936574f406 end qty_ship,\n                                case when 15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.ab30d6d679879cfacfe389b97d1d3f0e = ]'\n         || v_fisc_yr\n         || q'[ then 15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.afcae1f8310cd038c0633aeaa179c10c280a4c8731f60bb762471fb74030c9a2 end unfrm_grs_sls_extnd,\n                                case when 15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.ab30d6d679879cfacfe389b97d1d3f0e = ]'\n         || v_fisc_yr\n         || q'[ then 15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.56d34efa4c0a22d07b3f8a07122ca048 end unfrm_tagp,\n                                case when 15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.ab30d6d679879cfacfe389b97d1d3f0e = ]'\n         || v_fisc_yr\n         || q'[ then 15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.ccf8d88f2d37f3171da2121ab22e9330 end unfrm_qty_ship,\n                                case when 15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.ab30d6d679879cfacfe389b97d1d3f0e = ]'\n         || v_fisc_yr\n         || q'[ then 8ce27e49d994e1c605cb69746b9cfcb2.8ce27e49d994e1c605cb69746b9cfcb2 end sos_cnt,\n                                case when 15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.ab30d6d679879cfacfe389b97d1d3f0e = ]'\n         || v_fisc_yr\n         || q'[ then 15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.37175a70b8190fbf717de5f6ebc49b0a end unfrm_grs_tgp,\n                                case when 15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.ab30d6d679879cfacfe389b97d1d3f0e = ]'\n         || v_fisc_yr\n         || q'[ then 15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.c3a904d6986fe2e41d14bc8e27a86788 end cat_sold,\n                                case when 15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.ab30d6d679879cfacfe389b97d1d3f0e = ]'\n         || v_fisc_yr\n         || q'[ then 15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.5525c623c7224d514a55baf79c2ef08f end net_acct_flg\n                         FROM (SELECT aaaa197c8a04b78be299c4e8679a5a84.839c4ffb4bfaae1bb58eab4dee67d96a,\n                                      aaaa197c8a04b78be299c4e8679a5a84.852fa1e9f02f1ca2c75837f7146b2381,\n                                      de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.ab30d6d679879cfacfe389b97d1d3f0e,\n                                      de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.e1d446673288adb6d5f219d0aa82d37a,\n                                      de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.2603c45be643e5cd8f9c6dad3bee6cb3,\n                                      aaaa197c8a04b78be299c4e8679a5a84.7f599f836c449bebb92bb9757e86c603,\n                                      (SELECT COUNT(fisc_yr_mth) - 2\n                                                   FROM de459e2fe7f96e4d958537b31b946b26.ca1faaabe4743a8a00a4d208ab58b2b3\n                                                  WHERE fisc_yr_mth BETWEEN aaaa197c8a04b78be299c4e8679a5a84.55739765f192316a366e35ac5cc043c2561b89cb9074f747f5165d6920afabf2 AND de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.2603c45be643e5cd8f9c6dad3bee6cb3)\n                                           cust_tenure_mth_actl\n                               FROM ]'\n         || v_cust_vw\n         || q'[,\n                                    (SELECT de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.ab30d6d679879cfacfe389b97d1d3f0e, de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.e1d446673288adb6d5f219d0aa82d37a, de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.2603c45be643e5cd8f9c6dad3bee6cb3\n                                     FROM de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001 t\n                                     WHERE de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.ab30d6d679879cfacfe389b97d1d3f0e = ]'\n         || v_fisc_yr\n         || q'[ AND de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.e1d446673288adb6d5f219d0aa82d37a <= ']'\n         || v_fisc_mth_of_yr\n         || q'[' GROUP BY de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.ab30d6d679879cfacfe389b97d1d3f0e, de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.e1d446673288adb6d5f219d0aa82d37a, de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.2603c45be643e5cd8f9c6dad3bee6cb3) t) cust_list,\n                                 (select cust_nbr, div_nbr, fisc_yr_mth, count(sos_id) sos_cnt\n                                    from de459e2fe7f96e4d958537b31b946b26.cceb59010ea14489122210934cea0e44\n                                    where inact_dt is null\n                                   and fisc_yr_mth <= ']'\n         || v_fisc_yr_mth\n         || q'[' group by cust_nbr, div_nbr, fisc_yr_mth) sos_cnt,\n                              (SELECT de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.839c4ffb4bfaae1bb58eab4dee67d96a,\n                                      de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.852fa1e9f02f1ca2c75837f7146b2381,\n                                      de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.ab30d6d679879cfacfe389b97d1d3f0e,\n                                      de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.e1d446673288adb6d5f219d0aa82d37a,\n                                      count(distinct de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.3f2fdebe4ba3a24bdf16fdac5827ebfb) nbr_wk,\n                                      SUM (NVL (de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.1afca342ab89e5b8c65c6c4c634b2186, 0)) TAGP,\n                                     count(distinct case when de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.26ac88e7ae671a1b22c14c2fce77aa2d = 'RT' AND pim_suprcls_id_actl <> 97 AND pim_suprcls_id_actl IS NOT NULL then de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.4fdc122fb2d10dd764e32cbc98972eca||de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.9f055ebf334db6c50bbcab4ff14bd2ae||INV_DT||nvl(DLVR_RTE,'')||PRCS_DT else NULL end) DROPS,\n                                     case when count(distinct case when de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.26ac88e7ae671a1b22c14c2fce77aa2d = 'RT' then de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.4fdc122fb2d10dd764e32cbc98972eca||de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.9f055ebf334db6c50bbcab4ff14bd2ae||INV_DT||nvl(DLVR_RTE,'')||PRCS_DT else NULL end) > 0\n                                          then SUM (NVL (de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.1afca342ab89e5b8c65c6c4c634b2186, 0)) /count(distinct case when de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.26ac88e7ae671a1b22c14c2fce77aa2d = 'RT' then de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.4fdc122fb2d10dd764e32cbc98972eca||de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.9f055ebf334db6c50bbcab4ff14bd2ae||INV_DT||nvl(DLVR_RTE,'')||PRCS_DT else NULL end)\n                                          else 0 end TAGP_PER_DROP,\n                                     SUM (grs_sls_extnd) AS GRS_SLS_EXTND,\n                                     SUM(CASE\n                                                WHEN de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.26ac88e7ae671a1b22c14c2fce77aa2d IN ('RT', 'VS', 'WC')\n                                                 AND de459e2fe7f96e4d958537b31b946b26.2c04d82ed0aa1cc9bce2cf2c0548b268.89f3df82917b692fe64dca942d924e7c <> 97\n                                                 AND de459e2fe7f96e4d958537b31b946b26.2c04d82ed0aa1cc9bce2cf2c0548b268.89f3df82917b692fe64dca942d924e7c is not null THEN\n                                                   de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.2ee1400a0150f0b220dd7bd6268d1e66\n                                                ELSE\n                                                   NULL\n                                             END)\n                                            no_cd_unfrm_grs_sls_extnd,\n                                     SUM(QTY_SHIP) as QTY_SHIP,\n                                     SUM(UNFRM_QTY_SHIP)UNFRM_QTY_SHIP,\n                                     sum(case when de459e2fe7f96e4d958537b31b946b26.2c04d82ed0aa1cc9bce2cf2c0548b268.89f3df82917b692fe64dca942d924e7c <> 97\n                                          and de459e2fe7f96e4d958537b31b946b26.2c04d82ed0aa1cc9bce2cf2c0548b268.89f3df82917b692fe64dca942d924e7c is not null\n                                         then grs_sls_extnd\n                                         else 0\n                                         END) UNFRM_GRS_SLS_EXTND,\n                                     sum(case when de459e2fe7f96e4d958537b31b946b26.2c04d82ed0aa1cc9bce2cf2c0548b268.89f3df82917b692fe64dca942d924e7c <> 97\n                                         and de459e2fe7f96e4d958537b31b946b26.2c04d82ed0aa1cc9bce2cf2c0548b268.89f3df82917b692fe64dca942d924e7c is not null\n                                         then actl_gp\n                                          else 0\n                                     END) UNFRM_TAGP,\n                                    SUM(CASE\n                                                WHEN de459e2fe7f96e4d958537b31b946b26.2c04d82ed0aa1cc9bce2cf2c0548b268.89f3df82917b692fe64dca942d924e7c <> 97\n                                                 AND de459e2fe7f96e4d958537b31b946b26.2c04d82ed0aa1cc9bce2cf2c0548b268.89f3df82917b692fe64dca942d924e7c IS NOT NULL THEN\n                                                   NVL(de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.2ee1400a0150f0b220dd7bd6268d1e66 - de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.c6c7cc45578c678907522e08bb04a4ca - (CASE WHEN de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.487c194c34aee6c67551aa2cdd2358ace32f6dd38f333cde68119d1f277367cd = 'P' THEN NVL(de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.d206d123f59f85e26ec113e33b465295,0) ELSE 0 END) + de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.b7982b81d447f11a0953881190e528cae32f6dd38f333cde68119d1f277367cd, 0)\n                                                ELSE\n                                                   0\n                                             END)\n                                            unfrm_grs_tgp,\n                                         COUNT(\n                                            DISTINCT (CASE\n                                                         WHEN de459e2fe7f96e4d958537b31b946b26.2c04d82ed0aa1cc9bce2cf2c0548b268.89f3df82917b692fe64dca942d924e7c <= ]'\n         || v_net_acct_pim_suprcls_id\n         || q'[ THEN\n                                                            de459e2fe7f96e4d958537b31b946b26.2c04d82ed0aa1cc9bce2cf2c0548b268.89f3df82917b692fe64dca942d924e7c\n                                                         ELSE\n                                                            NULL\n                                                      END))\n                                            cat_sold,\n                                         MAX(CASE\n                                                WHEN de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.26ac88e7ae671a1b22c14c2fce77aa2d IN ('RT', 'VS', 'WC')\n                                                 AND de459e2fe7f96e4d958537b31b946b26.2c04d82ed0aa1cc9bce2cf2c0548b268.89f3df82917b692fe64dca942d924e7c <> 97\n                                                 AND de459e2fe7f96e4d958537b31b946b26.2c04d82ed0aa1cc9bce2cf2c0548b268.89f3df82917b692fe64dca942d924e7c IS NOT NULL THEN\n                                                   'Y'\n                                                ELSE\n                                                   'N'\n                                             END)\n                                            net_acct_flg\n                               FROM de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001 t,\n                                    de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c s,\n                                    de459e2fe7f96e4d958537b31b946b26.2c04d82ed0aa1cc9bce2cf2c0548b268 pim,\n                                    de459e2fe7f96e4d958537b31b946b26.dec387908a0954ddc8689c4ad37c8a3c d, ]'\n         || v_cust_vw\n         || q'[ WHERE     de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.ab30d6d679879cfacfe389b97d1d3f0e in (]'\n         || v_fisc_yr\n         || ','\n         || v_fisc_yr\n         || q'[-1)\n                                     AND de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.e1d446673288adb6d5f219d0aa82d37a <= ']'\n         || v_fisc_mth_of_yr\n         || q'[' AND de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.cb5e253886eb30a93e66cbf95203a754 <> CASE\n                                                               WHEN de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.ab30d6d679879cfacfe389b97d1d3f0e = (]'\n         || v_fisc_yr\n         || q'[-1) AND ']'\n         || v_fisc_mth_of_yr\n         || q'[' = '12' AND ]'\n         || v_py_max_wk\n         || q'[= 53 THEN 53    \n                                                               ELSE 99    \n                                                            END\n                                     AND de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.222ccb1d1746bcdb2365f29b3da0b613 <= ']'\n         || v_end_dt;\n\n           v_ctas_stmt1 := q'[' AND e9a95106e01380a7834d36560e919770.f5dd4374a3e3af6a775cb6d6b22e8162 = 1d731bbdc4e3fb69a854112d4982eb99.222ccb1d1746bcdb2365f29b3da0b613\n                                     AND e9a95106e01380a7834d36560e919770.467a168a7499c57b1859198a7dac7be0 IS NULL\n                                     AND e9a95106e01380a7834d36560e919770.839c4ffb4bfaae1bb58eab4dee67d96a = d2450100e2dda59c2b7828b4daff7f8c.839c4ffb4bfaae1bb58eab4dee67d96a\n                                     AND e9a95106e01380a7834d36560e919770.852fa1e9f02f1ca2c75837f7146b2381 = d2450100e2dda59c2b7828b4daff7f8c.852fa1e9f02f1ca2c75837f7146b2381\n                                     AND e9a95106e01380a7834d36560e919770.d3268eabc4a7d98105fd85f9c9e62cd6e32ad436514bbe822b33de8bead744f3 = c1f84e8860c9acbd312fc2d82a40cc08.d3268eabc4a7d98105fd85f9c9e62cd6e32ad436514bbe822b33de8bead744f3\n                                     AND NVL(e9a95106e01380a7834d36560e919770.a2b201123c685e8cc48b5468cb4a449361bbd7bc0d2d67c7d7b11cb0a8d18d03, e9a95106e01380a7834d36560e919770.839c4ffb4bfaae1bb58eab4dee67d96a) = fce896ca0fbbf5a5d330f2803036eb44.839c4ffb4bfaae1bb58eab4dee67d96a\n                                     AND fce896ca0fbbf5a5d330f2803036eb44.b8c6ab19cb6e726c38f24d1885346ea3 <> 'CC'\n\t\t\t\t\t\t\t\t     AND  (case when NVL (fce896ca0fbbf5a5d330f2803036eb44.c712a9ab5ef100c5807fa96123dac48b,'USF') <> 'USF'\n\t\t\t\t\t\t\t\t    \t and NVL(e9a95106e01380a7834d36560e919770.a2b201123c685e8cc48b5468cb4a449361bbd7bc0d2d67c7d7b11cb0a8d18d03, e9a95106e01380a7834d36560e919770.839c4ffb4bfaae1bb58eab4dee67d96a) = fce896ca0fbbf5a5d330f2803036eb44.839c4ffb4bfaae1bb58eab4dee67d96a\n\t\t\t\t\t\t\t\t\t     and e9a95106e01380a7834d36560e919770.f5dd4374a3e3af6a775cb6d6b22e8162 < NVL(fce896ca0fbbf5a5d330f2803036eb44.3db9275d5f5cb2e9d918e77dbabdd97b,e9a95106e01380a7834d36560e919770.f5dd4374a3e3af6a775cb6d6b22e8162)\n\t\t\t\t\t\t\t\t\t     then 'NON_USFGL' else 'USFGL' END) ='USFGL'\n                                     GROUP BY e9a95106e01380a7834d36560e919770.839c4ffb4bfaae1bb58eab4dee67d96a, e9a95106e01380a7834d36560e919770.852fa1e9f02f1ca2c75837f7146b2381, 1d731bbdc4e3fb69a854112d4982eb99.ab30d6d679879cfacfe389b97d1d3f0e, 1d731bbdc4e3fb69a854112d4982eb99.e1d446673288adb6d5f219d0aa82d37a) cust_sales_ty_ly \n                         WHERE     6f037dd8c55b34c0a958bc6e5d1c45f6.852fa1e9f02f1ca2c75837f7146b2381 = 15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.852fa1e9f02f1ca2c75837f7146b2381(+)\n                               AND 6f037dd8c55b34c0a958bc6e5d1c45f6.839c4ffb4bfaae1bb58eab4dee67d96a = 15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.839c4ffb4bfaae1bb58eab4dee67d96a(+)\n                               AND 6f037dd8c55b34c0a958bc6e5d1c45f6.e1d446673288adb6d5f219d0aa82d37a = 15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.e1d446673288adb6d5f219d0aa82d37a(+)\n                               AND 6f037dd8c55b34c0a958bc6e5d1c45f6.2603c45be643e5cd8f9c6dad3bee6cb3 = 8ce27e49d994e1c605cb69746b9cfcb2.2603c45be643e5cd8f9c6dad3bee6cb3(+)\n                               AND 6f037dd8c55b34c0a958bc6e5d1c45f6.852fa1e9f02f1ca2c75837f7146b2381 = 8ce27e49d994e1c605cb69746b9cfcb2.852fa1e9f02f1ca2c75837f7146b2381(+)\n                               AND 6f037dd8c55b34c0a958bc6e5d1c45f6.839c4ffb4bfaae1bb58eab4dee67d96a = 8ce27e49d994e1c605cb69746b9cfcb2.839c4ffb4bfaae1bb58eab4dee67d96a(+))\n                         GROUP by\n                                cust_sk,\n                                cust_nbr,\n                                div_nbr,\n                                fisc_yr,\n                                fisc_mth_of_yr,\n                                fisc_yr_mth,\n                                cust_tenure_mth_actl\n                               ) c,\n                         (select fisc_yr, fisc_mth_of_yr, fisc_yr_mth,\n                                 min(clndr_dt) fisc_mth_strt_dt,\n                                 max(clndr_dt) fisc_mth_end_dt,\n                                 min(clndr_dt_yrago) fisc_mth_strt_dt_yrago,\n                                 max(clndr_dt_yrago) fisc_mth_end_dt_yrago\n                                 from de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001\n                                 group by fisc_yr, fisc_mth_of_yr, fisc_yr_mth) t\n                         where de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.ab30d6d679879cfacfe389b97d1d3f0e = aaaa197c8a04b78be299c4e8679a5a84.ab30d6d679879cfacfe389b97d1d3f0e\n                           and de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.e1d446673288adb6d5f219d0aa82d37a = aaaa197c8a04b78be299c4e8679a5a84.e1d446673288adb6d5f219d0aa82d37a\n                   UNION ALL\n                   \n                   SELECT aaaa197c8a04b78be299c4e8679a5a84.852fa1e9f02f1ca2c75837f7146b2381,\n                          aaaa197c8a04b78be299c4e8679a5a84.839c4ffb4bfaae1bb58eab4dee67d96a,\n                          aaaa197c8a04b78be299c4e8679a5a84.ab30d6d679879cfacfe389b97d1d3f0e,\n                          aaaa197c8a04b78be299c4e8679a5a84.e1d446673288adb6d5f219d0aa82d37a,\n                          0 as fisc_wk_of_yr,\n                            CASE\n                               WHEN no_cd_unfrm_sales_ty > 0\n                                AND no_cd_unfrm_sales_ly > 0 THEN\n                                  'PRIOR YEAR'\n                               WHEN no_cd_unfrm_sales_ty > 0\n                                AND no_cd_unfrm_sales_ly <= 0 THEN\n                                  'NEW'\n                               WHEN no_cd_unfrm_sales_ty <= 0\n                                AND no_cd_unfrm_sales_ly > 0 THEN\n                                  'LOST'\n                               ELSE\n                                  'OTHER'\n                            END\n                               AS cust_clsfctn,\n                          de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.d3ec1a21507970329af1c66ef244cdefe32f6dd38f333cde68119d1f277367cd,\n                          de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.e17b4db24503ad4d9365a15bec98eef6,\n                          de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.d3ec1a21507970329af1c66ef244cdefb274599470f4daf85f36de136c376169,\n                          de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.21c571650d05fd041faddc812b8444acf43d3e611ef8d78ea0e7840aa66f8834,\n                          sysdate as crt_dt,\n                          nbr_wk_ly,\n                          nbr_wk_ty,\n                          aaaa197c8a04b78be299c4e8679a5a84.7f599f836c449bebb92bb9757e86c603,\n                          aaaa197c8a04b78be299c4e8679a5a84.2603c45be643e5cd8f9c6dad3bee6cb3,\n                          aaaa197c8a04b78be299c4e8679a5a84.eb6a312932db943ec140f42c7c8998cf,\n                          aaaa197c8a04b78be299c4e8679a5a84.630c48bbfe25ea68a239339f24d37c79,\n                          aaaa197c8a04b78be299c4e8679a5a84.8f04118f95170a63ad8f7d89fff56418,\n                          aaaa197c8a04b78be299c4e8679a5a84.2ee1400a0150f0b220dd7bd6268d1e66,\n                          aaaa197c8a04b78be299c4e8679a5a84.dc15696e1e997bad6131bf936574f406,\n                          aaaa197c8a04b78be299c4e8679a5a84.afcae1f8310cd038c0633aeaa179c10c280a4c8731f60bb762471fb74030c9a2,\n                          aaaa197c8a04b78be299c4e8679a5a84.56d34efa4c0a22d07b3f8a07122ca048,\n                          aaaa197c8a04b78be299c4e8679a5a84.ccf8d88f2d37f3171da2121ab22e9330,\n                          aaaa197c8a04b78be299c4e8679a5a84.8ce27e49d994e1c605cb69746b9cfcb2 as fisc_mth_sos_cnt,\n                          aaaa197c8a04b78be299c4e8679a5a84.c3a904d6986fe2e41d14bc8e27a86788,\n                          aaaa197c8a04b78be299c4e8679a5a84.37175a70b8190fbf717de5f6ebc49b0a,\n                          CASE\n                             WHEN aaaa197c8a04b78be299c4e8679a5a84.37175a70b8190fbf717de5f6ebc49b0a <> 0 THEN CASE WHEN drops <> 0 THEN aaaa197c8a04b78be299c4e8679a5a84.37175a70b8190fbf717de5f6ebc49b0a / aaaa197c8a04b78be299c4e8679a5a84.630c48bbfe25ea68a239339f24d37c79 ELSE 0 END\n                             ELSE NULL\n                          END\n                             unfrm_grs_tgp_per_drop,\n                          aaaa197c8a04b78be299c4e8679a5a84.e8a9f207120b23947059cce42696d8f133cb242de526ddafe282bd57488cedea,\n                          CASE WHEN NVL(net_acct_flg, 'N') = 'Y' THEN aaaa197c8a04b78be299c4e8679a5a84.7f599f836c449bebb92bb9757e86c603 ELSE NULL END net_acct_cust_sk\n                   FROM (SELECT cust_nbr,\n                                div_nbr,\n                                fisc_yr,\n                                fisc_mth_of_yr,\n                                sum(NVL(sales_ty,0)) AS sales_ty,\n                                sum(NVL(sales_ly,0)) AS sales_ly,\n                                SUM(NVL(no_cd_unfrm_sales_ty, 0)) AS no_cd_unfrm_sales_ty,\n                                SUM(NVL(no_cd_unfrm_sales_ly, 0)) AS no_cd_unfrm_sales_ly,\n                                sum(nvl(nbr_wk_ly,0)) nbr_wk_ly,\n                                sum(nvl(nbr_wk_ty,0)) nbr_wk_ty,\n                                cust_sk,\n                                fisc_yr_mth,\n                                sum(nvl(tagp,0)) tagp,\n                                sum(nvl(drops,0)) drops,\n                                sum(nvl(tagp_per_drop,0)) tagp_per_drop,\n                                sum(nvl(grs_sls_extnd,0)) grs_sls_extnd,\n                                sum(nvl(qty_ship,0)) qty_ship,\n                                sum(nvl(unfrm_grs_sls_extnd,0)) unfrm_grs_sls_extnd,\n                                sum(nvl(unfrm_tagp,0)) unfrm_tagp,\n                                sum(nvl(unfrm_qty_ship,0)) unfrm_qty_ship,\n                                sum(nvl(sos_cnt,0)) sos_cnt,\n                                MAX(NVL(cat_sold, 0)) cat_sold,\n                                SUM(NVL(unfrm_grs_tgp, 0)) unfrm_grs_tgp,\n                                cust_tenure_mth_actl,\n                                MAX(NVL(net_acct_flg, 0)) net_acct_flg\n                         FROM\n                         (SELECT 6f037dd8c55b34c0a958bc6e5d1c45f6.852fa1e9f02f1ca2c75837f7146b2381,\n                                6f037dd8c55b34c0a958bc6e5d1c45f6.839c4ffb4bfaae1bb58eab4dee67d96a,\n                                6f037dd8c55b34c0a958bc6e5d1c45f6.ab30d6d679879cfacfe389b97d1d3f0e,\n                                6f037dd8c55b34c0a958bc6e5d1c45f6.e1d446673288adb6d5f219d0aa82d37a,\n                                CASE\n                                  WHEN 15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.ab30d6d679879cfacfe389b97d1d3f0e = ]'\n         || v_fisc_yr\n         || q'[-1 THEN NVL(15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.2ee1400a0150f0b220dd7bd6268d1e66,0)\n                                  ELSE 0\n                                END sales_ty,\n                                CASE\n                                  WHEN 15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.ab30d6d679879cfacfe389b97d1d3f0e = ]'\n         || v_fisc_yr\n         || q'[-2 THEN NVL(15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.2ee1400a0150f0b220dd7bd6268d1e66,0)\n                                  ELSE 0\n                                END sales_ly,\n                                CASE\n                                  WHEN 15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.ab30d6d679879cfacfe389b97d1d3f0e = ]'\n         || v_fisc_yr\n         || q'[-1 THEN NVL(15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.ab081c412fc18694a8297c8dfdea984cd9542f5039f4af6f9fa4a3007112f536,0)\n                                  ELSE 0\n                                END no_cd_unfrm_sales_ty,\n                                CASE\n                                  WHEN 15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.ab30d6d679879cfacfe389b97d1d3f0e = ]'\n         || v_fisc_yr\n         || q'[-2 THEN NVL(15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.ab081c412fc18694a8297c8dfdea984cd9542f5039f4af6f9fa4a3007112f536,0)\n                                  ELSE 0\n                                END no_cd_unfrm_sales_ly,\n                                case when 15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.ab30d6d679879cfacfe389b97d1d3f0e = ]'\n         || v_fisc_yr\n         || q'[-2 then 15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.b8329c7377e022434715b0dbbad8440e end nbr_wk_ly,\n                                case when 15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.ab30d6d679879cfacfe389b97d1d3f0e = ]'\n         || v_fisc_yr\n         || q'[-1 then 15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.b8329c7377e022434715b0dbbad8440e end nbr_wk_ty,\n                                6f037dd8c55b34c0a958bc6e5d1c45f6.7f599f836c449bebb92bb9757e86c603,\n                                6f037dd8c55b34c0a958bc6e5d1c45f6.2603c45be643e5cd8f9c6dad3bee6cb3,\n                                6f037dd8c55b34c0a958bc6e5d1c45f6.e8a9f207120b23947059cce42696d8f133cb242de526ddafe282bd57488cedea,\n                                case when 15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.ab30d6d679879cfacfe389b97d1d3f0e = ]'\n         || v_fisc_yr\n         || q'[-1 then 15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.eb6a312932db943ec140f42c7c8998cf end tagp,\n                                case when 15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.ab30d6d679879cfacfe389b97d1d3f0e = ]'\n         || v_fisc_yr\n         || q'[-1 then 15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.630c48bbfe25ea68a239339f24d37c79 end drops,\n                                case when 15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.ab30d6d679879cfacfe389b97d1d3f0e = ]'\n         || v_fisc_yr\n         || q'[-1 then 15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.8f04118f95170a63ad8f7d89fff56418 end tagp_per_drop,\n                                case when 15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.ab30d6d679879cfacfe389b97d1d3f0e = ]'\n         || v_fisc_yr\n         || q'[-1 then 15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.2ee1400a0150f0b220dd7bd6268d1e66 end grs_sls_extnd,\n                                case when 15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.ab30d6d679879cfacfe389b97d1d3f0e = ]'\n         || v_fisc_yr\n         || q'[-1 then 15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.dc15696e1e997bad6131bf936574f406 end qty_ship,\n                                case when 15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.ab30d6d679879cfacfe389b97d1d3f0e = ]'\n         || v_fisc_yr\n         || q'[-1 then 15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.afcae1f8310cd038c0633aeaa179c10c280a4c8731f60bb762471fb74030c9a2 end unfrm_grs_sls_extnd,\n                                case when 15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.ab30d6d679879cfacfe389b97d1d3f0e = ]'\n         || v_fisc_yr\n         || q'[-1 then 15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.56d34efa4c0a22d07b3f8a07122ca048 end unfrm_tagp,\n                                case when 15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.ab30d6d679879cfacfe389b97d1d3f0e = ]'\n         || v_fisc_yr\n         || q'[-1 then 15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.ccf8d88f2d37f3171da2121ab22e9330 end unfrm_qty_ship,\n                                case when 15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.ab30d6d679879cfacfe389b97d1d3f0e = ]'\n         || v_fisc_yr\n         || q'[-1 then 8ce27e49d994e1c605cb69746b9cfcb2.8ce27e49d994e1c605cb69746b9cfcb2 end sos_cnt,\n                                case when 15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.ab30d6d679879cfacfe389b97d1d3f0e = ]'\n         || v_fisc_yr\n         || q'[-1  then 15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.37175a70b8190fbf717de5f6ebc49b0a end unfrm_grs_tgp,\n                                case when 15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.ab30d6d679879cfacfe389b97d1d3f0e = ]'\n         || v_fisc_yr\n         || q'[-1  then 15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.c3a904d6986fe2e41d14bc8e27a86788 end cat_sold,\n                                case when 15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.ab30d6d679879cfacfe389b97d1d3f0e = ]'\n         || v_fisc_yr\n         || q'[-1  then 15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.5525c623c7224d514a55baf79c2ef08f end net_acct_flg\n                         FROM (SELECT aaaa197c8a04b78be299c4e8679a5a84.839c4ffb4bfaae1bb58eab4dee67d96a,\n                                      aaaa197c8a04b78be299c4e8679a5a84.852fa1e9f02f1ca2c75837f7146b2381,\n                                      de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.ab30d6d679879cfacfe389b97d1d3f0e,\n                                      de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.e1d446673288adb6d5f219d0aa82d37a,\n                                      de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.2603c45be643e5cd8f9c6dad3bee6cb3,\n                                      aaaa197c8a04b78be299c4e8679a5a84.7f599f836c449bebb92bb9757e86c603,\n                                      (SELECT COUNT(fisc_yr_mth) - 2\n                                                   FROM de459e2fe7f96e4d958537b31b946b26.ca1faaabe4743a8a00a4d208ab58b2b3\n                                                  WHERE fisc_yr_mth BETWEEN aaaa197c8a04b78be299c4e8679a5a84.55739765f192316a366e35ac5cc043c2561b89cb9074f747f5165d6920afabf2 AND de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.2603c45be643e5cd8f9c6dad3bee6cb3)\n                                           cust_tenure_mth_actl\n                               FROM ]'\n         || v_cust_vw\n         || q'[,\n                                    (SELECT de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.ab30d6d679879cfacfe389b97d1d3f0e, de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.e1d446673288adb6d5f219d0aa82d37a, de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.2603c45be643e5cd8f9c6dad3bee6cb3\n                                     FROM de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001 t\n                                     WHERE de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.ab30d6d679879cfacfe389b97d1d3f0e = ]'\n         || v_fisc_yr\n         || q'[ -1\n                                     GROUP BY de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.ab30d6d679879cfacfe389b97d1d3f0e, de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.e1d446673288adb6d5f219d0aa82d37a, de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.2603c45be643e5cd8f9c6dad3bee6cb3) t) cust_list,\n                                 (select cust_nbr, div_nbr, fisc_yr_mth, count(sos_id) sos_cnt\n                                    from de459e2fe7f96e4d958537b31b946b26.cceb59010ea14489122210934cea0e44\n                                    where inact_dt is null\n                                   and fisc_yr_mth <= ']'\n         || v_fisc_yr_mth\n         || q'[' group by cust_nbr, div_nbr, fisc_yr_mth) sos_cnt,\n                              (SELECT de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.839c4ffb4bfaae1bb58eab4dee67d96a,\n                                      de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.852fa1e9f02f1ca2c75837f7146b2381,\n                                      de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.ab30d6d679879cfacfe389b97d1d3f0e,\n                                      de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.e1d446673288adb6d5f219d0aa82d37a,\n                                      count(distinct de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.3f2fdebe4ba3a24bdf16fdac5827ebfb) nbr_wk,\n                                      SUM (NVL (de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.1afca342ab89e5b8c65c6c4c634b2186, 0)) TAGP,\n                                     count(distinct case when de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.26ac88e7ae671a1b22c14c2fce77aa2d = 'RT' AND pim_suprcls_id_actl <> 97 AND pim_suprcls_id_actl IS NOT NULL then de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.4fdc122fb2d10dd764e32cbc98972eca||de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.9f055ebf334db6c50bbcab4ff14bd2ae||INV_DT||nvl(DLVR_RTE,'')||PRCS_DT else NULL end) DROPS,\n                                     case when count(distinct case when de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.26ac88e7ae671a1b22c14c2fce77aa2d = 'RT' then de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.4fdc122fb2d10dd764e32cbc98972eca||de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.9f055ebf334db6c50bbcab4ff14bd2ae||INV_DT||nvl(DLVR_RTE,'')||PRCS_DT else NULL end) > 0\n                                          then SUM (NVL (de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.1afca342ab89e5b8c65c6c4c634b2186, 0)) /count(distinct case when de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.26ac88e7ae671a1b22c14c2fce77aa2d = 'RT' then de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.4fdc122fb2d10dd764e32cbc98972eca||de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.9f055ebf334db6c50bbcab4ff14bd2ae||INV_DT||nvl(DLVR_RTE,'')||PRCS_DT else NULL end)\n                                          else 0 end TAGP_PER_DROP,\n                                     SUM (grs_sls_extnd) AS GRS_SLS_EXTND,\n                                     SUM(CASE\n                                                WHEN de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.26ac88e7ae671a1b22c14c2fce77aa2d IN ('RT', 'VS', 'WC')\n                                                 AND de459e2fe7f96e4d958537b31b946b26.2c04d82ed0aa1cc9bce2cf2c0548b268.89f3df82917b692fe64dca942d924e7c <> 97\n                                                 AND de459e2fe7f96e4d958537b31b946b26.2c04d82ed0aa1cc9bce2cf2c0548b268.89f3df82917b692fe64dca942d924e7c is not null THEN\n                                                   de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.2ee1400a0150f0b220dd7bd6268d1e66\n                                                ELSE\n                                                   NULL\n                                             END)\n                                            no_cd_unfrm_grs_sls_extnd,\n                                     SUM(QTY_SHIP) as QTY_SHIP,\n                                     SUM(UNFRM_QTY_SHIP)UNFRM_QTY_SHIP,\n                                     sum(case when de459e2fe7f96e4d958537b31b946b26.2c04d82ed0aa1cc9bce2cf2c0548b268.89f3df82917b692fe64dca942d924e7c <> 97\n                                          and de459e2fe7f96e4d958537b31b946b26.2c04d82ed0aa1cc9bce2cf2c0548b268.89f3df82917b692fe64dca942d924e7c is not null\n                                         then grs_sls_extnd\n                                         else 0\n                                         END) UNFRM_GRS_SLS_EXTND,\n                                     sum(case when de459e2fe7f96e4d958537b31b946b26.2c04d82ed0aa1cc9bce2cf2c0548b268.89f3df82917b692fe64dca942d924e7c <> 97\n                                         and de459e2fe7f96e4d958537b31b946b26.2c04d82ed0aa1cc9bce2cf2c0548b268.89f3df82917b692fe64dca942d924e7c is not null\n                                         then actl_gp\n                                          else 0\n                                     END) UNFRM_TAGP,\n                                    SUM(CASE\n                                                WHEN de459e2fe7f96e4d958537b31b946b26.2c04d82ed0aa1cc9bce2cf2c0548b268.89f3df82917b692fe64dca942d924e7c <> 97\n                                                 AND de459e2fe7f96e4d958537b31b946b26.2c04d82ed0aa1cc9bce2cf2c0548b268.89f3df82917b692fe64dca942d924e7c IS NOT NULL THEN\n                                                   NVL(de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.2ee1400a0150f0b220dd7bd6268d1e66 - de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.c6c7cc45578c678907522e08bb04a4ca - (CASE WHEN de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.487c194c34aee6c67551aa2cdd2358ace32f6dd38f333cde68119d1f277367cd = 'P' THEN NVL(de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.d206d123f59f85e26ec113e33b465295,0) ELSE 0 END) + de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.b7982b81d447f11a0953881190e528cae32f6dd38f333cde68119d1f277367cd, 0)\n                                                ELSE\n                                                   0\n                                             END)\n                                            unfrm_grs_tgp,\n                                         COUNT(\n                                            DISTINCT (CASE\n                                                         WHEN de459e2fe7f96e4d958537b31b946b26.2c04d82ed0aa1cc9bce2cf2c0548b268.89f3df82917b692fe64dca942d924e7c <= ]'\n         || v_net_acct_pim_suprcls_id\n         || q'[ THEN\n                                                            de459e2fe7f96e4d958537b31b946b26.2c04d82ed0aa1cc9bce2cf2c0548b268.89f3df82917b692fe64dca942d924e7c\n                                                         ELSE\n                                                            NULL\n                                                      END))\n                                            cat_sold,\n                                         MAX(CASE\n                                                WHEN de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.26ac88e7ae671a1b22c14c2fce77aa2d IN ('RT', 'VS', 'WC')\n                                                 AND de459e2fe7f96e4d958537b31b946b26.2c04d82ed0aa1cc9bce2cf2c0548b268.89f3df82917b692fe64dca942d924e7c <> 97\n                                                 AND de459e2fe7f96e4d958537b31b946b26.2c04d82ed0aa1cc9bce2cf2c0548b268.89f3df82917b692fe64dca942d924e7c IS NOT NULL THEN\n                                                   'Y'\n                                                ELSE\n                                                   'N'\n                                             END)\n                                            net_acct_flg\n                               FROM de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001 t,\n                                    de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c s,\n                                    de459e2fe7f96e4d958537b31b946b26.2c04d82ed0aa1cc9bce2cf2c0548b268 pim,\n                                    de459e2fe7f96e4d958537b31b946b26.dec387908a0954ddc8689c4ad37c8a3c d, ]'\n         || v_cust_vw\n         || q'[ WHERE     de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.ab30d6d679879cfacfe389b97d1d3f0e in (]'\n         || v_fisc_yr\n         || '-1, '\n         || v_fisc_yr\n         || '-2)'\n         || q'[ AND de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.cb5e253886eb30a93e66cbf95203a754 <> CASE\n                                                               WHEN de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.ab30d6d679879cfacfe389b97d1d3f0e = ]'\n         || v_fisc_yr\n         || q'[-2 AND\n                                                                    de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.e1d446673288adb6d5f219d0aa82d37a = '12' AND ]'\n         || v_2y_ago_max_wk\n         || q'[ = 53 THEN 53    \n                                                               ELSE 99    \n                                                            END\n                                     AND de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.f5dd4374a3e3af6a775cb6d6b22e8162 = de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.222ccb1d1746bcdb2365f29b3da0b613\n                                     AND de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.467a168a7499c57b1859198a7dac7be0 IS NULL\n                                     AND de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.839c4ffb4bfaae1bb58eab4dee67d96a = aaaa197c8a04b78be299c4e8679a5a84.839c4ffb4bfaae1bb58eab4dee67d96a\n                                     AND de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.852fa1e9f02f1ca2c75837f7146b2381 = aaaa197c8a04b78be299c4e8679a5a84.852fa1e9f02f1ca2c75837f7146b2381\n                                     AND de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.d3268eabc4a7d98105fd85f9c9e62cd6e32ad436514bbe822b33de8bead744f3 = de459e2fe7f96e4d958537b31b946b26.2c04d82ed0aa1cc9bce2cf2c0548b268.d3268eabc4a7d98105fd85f9c9e62cd6e32ad436514bbe822b33de8bead744f3\n                                     AND NVL(de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.a2b201123c685e8cc48b5468cb4a449361bbd7bc0d2d67c7d7b11cb0a8d18d03, de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.839c4ffb4bfaae1bb58eab4dee67d96a) = de459e2fe7f96e4d958537b31b946b26.dec387908a0954ddc8689c4ad37c8a3c.839c4ffb4bfaae1bb58eab4dee67d96a\n                                     AND de459e2fe7f96e4d958537b31b946b26.dec387908a0954ddc8689c4ad37c8a3c.b8c6ab19cb6e726c38f24d1885346ea3 <> 'CC'\n\t\t\t\t\t\t\t\t     AND  (case when NVL (de459e2fe7f96e4d958537b31b946b26.dec387908a0954ddc8689c4ad37c8a3c.c712a9ab5ef100c5807fa96123dac48b,'USF') <> 'USF'\n\t\t\t\t\t\t\t\t\t and NVL(de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.a2b201123c685e8cc48b5468cb4a449361bbd7bc0d2d67c7d7b11cb0a8d18d03, de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.839c4ffb4bfaae1bb58eab4dee67d96a) = de459e2fe7f96e4d958537b31b946b26.dec387908a0954ddc8689c4ad37c8a3c.839c4ffb4bfaae1bb58eab4dee67d96a\n\t\t\t\t\t\t\t\t\t and de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.f5dd4374a3e3af6a775cb6d6b22e8162 < NVL(de459e2fe7f96e4d958537b31b946b26.dec387908a0954ddc8689c4ad37c8a3c.3db9275d5f5cb2e9d918e77dbabdd97b,de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.f5dd4374a3e3af6a775cb6d6b22e8162)\n\t\t\t\t\t\t\t\t\t then 'NON_USFGL' else 'USFGL' END) ='USFGL'\n                                     GROUP BY de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.839c4ffb4bfaae1bb58eab4dee67d96a, de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.852fa1e9f02f1ca2c75837f7146b2381, de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.ab30d6d679879cfacfe389b97d1d3f0e, de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.e1d446673288adb6d5f219d0aa82d37a) cust_sales_ty_ly \n                         WHERE     6f037dd8c55b34c0a958bc6e5d1c45f6.852fa1e9f02f1ca2c75837f7146b2381 = 15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.852fa1e9f02f1ca2c75837f7146b2381(+)\n                               AND 6f037dd8c55b34c0a958bc6e5d1c45f6.839c4ffb4bfaae1bb58eab4dee67d96a = 15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.839c4ffb4bfaae1bb58eab4dee67d96a(+)\n                               AND 6f037dd8c55b34c0a958bc6e5d1c45f6.e1d446673288adb6d5f219d0aa82d37a = 15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.e1d446673288adb6d5f219d0aa82d37a(+)\n                               AND 6f037dd8c55b34c0a958bc6e5d1c45f6.2603c45be643e5cd8f9c6dad3bee6cb3 = 8ce27e49d994e1c605cb69746b9cfcb2.2603c45be643e5cd8f9c6dad3bee6cb3(+)\n                               AND 6f037dd8c55b34c0a958bc6e5d1c45f6.852fa1e9f02f1ca2c75837f7146b2381 = 8ce27e49d994e1c605cb69746b9cfcb2.852fa1e9f02f1ca2c75837f7146b2381(+)\n                               AND 6f037dd8c55b34c0a958bc6e5d1c45f6.839c4ffb4bfaae1bb58eab4dee67d96a = 8ce27e49d994e1c605cb69746b9cfcb2.839c4ffb4bfaae1bb58eab4dee67d96a(+))\n                         GROUP by\n                                cust_sk,\n                                cust_nbr,\n                                div_nbr,\n                                fisc_yr,\n                                fisc_mth_of_yr,\n                                fisc_yr_mth,\n                                cust_tenure_mth_actl\n                               ) c,\n                         (select fisc_yr, fisc_mth_of_yr,fisc_yr_mth,\n                                 min(clndr_dt) fisc_mth_strt_dt,\n                                 max(clndr_dt) fisc_mth_end_dt,\n                                 min(clndr_dt_yrago) fisc_mth_strt_dt_yrago,\n                                 max(clndr_dt_yrago) fisc_mth_end_dt_yrago\n                                 from de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001\n                                 group by fisc_yr, fisc_mth_of_yr, fisc_yr_mth) t\n                         where de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.ab30d6d679879cfacfe389b97d1d3f0e = aaaa197c8a04b78be299c4e8679a5a84.ab30d6d679879cfacfe389b97d1d3f0e\n                           and de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.e1d446673288adb6d5f219d0aa82d37a = aaaa197c8a04b78be299c4e8679a5a84.e1d446673288adb6d5f219d0aa82d37a]';\n\n      DBMS_OUTPUT.put_line(v_ctas_stmt);\n      DBMS_OUTPUT.put_line(v_ctas_stmt1);\n\n      EXECUTE IMMEDIATE v_ctas_stmt||' '||v_ctas_stmt1;\n\n      COMMIT;\n\n      DBMS_OUTPUT.put_line(\n         'Table ' || v_src_schema || '.' || v_tbl_prfx || v_in_div_nbr || ' created ' || SYSTIMESTAMP);\n\n      DBMS_OUTPUT.put_line('Start Transfered Insert');\n\n      \n      l_trans_insert   :=\n         'INSERT INTO ' || v_src_schema || '.' || v_tbl_prfx || v_in_div_nbr\n         || q'[\n           (SELECT aaaa197c8a04b78be299c4e8679a5a84.852fa1e9f02f1ca2c75837f7146b2381,\n                          aaaa197c8a04b78be299c4e8679a5a84.839c4ffb4bfaae1bb58eab4dee67d96a,\n                          aaaa197c8a04b78be299c4e8679a5a84.ab30d6d679879cfacfe389b97d1d3f0e,\n                          aaaa197c8a04b78be299c4e8679a5a84.e1d446673288adb6d5f219d0aa82d37a,\n                          0 as fisc_wk_of_yr,\n                          'OTHER' cust_clsfctn,\n                          de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.d3ec1a21507970329af1c66ef244cdefe32f6dd38f333cde68119d1f277367cd,\n                          de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.e17b4db24503ad4d9365a15bec98eef6,\n                          de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.d3ec1a21507970329af1c66ef244cdefb274599470f4daf85f36de136c376169,\n                          de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.21c571650d05fd041faddc812b8444acf43d3e611ef8d78ea0e7840aa66f8834,\n                          sysdate as crt_dt,\n                          NULL nbr_of_wk_ordr_last_yr_mth,\n                          nbr_wk_ty as nbr_of_wk_ordr_this_yr_mth,\n                          aaaa197c8a04b78be299c4e8679a5a84.7f599f836c449bebb92bb9757e86c603,\n                          aaaa197c8a04b78be299c4e8679a5a84.2603c45be643e5cd8f9c6dad3bee6cb3,\n                          aaaa197c8a04b78be299c4e8679a5a84.eb6a312932db943ec140f42c7c8998cf,\n                          aaaa197c8a04b78be299c4e8679a5a84.630c48bbfe25ea68a239339f24d37c79,\n                          aaaa197c8a04b78be299c4e8679a5a84.8f04118f95170a63ad8f7d89fff56418,\n                          aaaa197c8a04b78be299c4e8679a5a84.2ee1400a0150f0b220dd7bd6268d1e66,\n                          aaaa197c8a04b78be299c4e8679a5a84.dc15696e1e997bad6131bf936574f406,\n                          aaaa197c8a04b78be299c4e8679a5a84.afcae1f8310cd038c0633aeaa179c10c280a4c8731f60bb762471fb74030c9a2,\n                          aaaa197c8a04b78be299c4e8679a5a84.56d34efa4c0a22d07b3f8a07122ca048,\n                          aaaa197c8a04b78be299c4e8679a5a84.ccf8d88f2d37f3171da2121ab22e9330,\n                          aaaa197c8a04b78be299c4e8679a5a84.8ce27e49d994e1c605cb69746b9cfcb2 as fisc_mth_sos_cnt,\n                          aaaa197c8a04b78be299c4e8679a5a84.c3a904d6986fe2e41d14bc8e27a86788,\n                          aaaa197c8a04b78be299c4e8679a5a84.37175a70b8190fbf717de5f6ebc49b0a,\n                          CASE\n                             WHEN aaaa197c8a04b78be299c4e8679a5a84.37175a70b8190fbf717de5f6ebc49b0a <> 0 THEN CASE WHEN drops <> 0 THEN aaaa197c8a04b78be299c4e8679a5a84.37175a70b8190fbf717de5f6ebc49b0a / aaaa197c8a04b78be299c4e8679a5a84.630c48bbfe25ea68a239339f24d37c79 ELSE 0 END\n                             ELSE NULL\n                          END\n                             unfrm_grs_tgp_per_drop,\n                          aaaa197c8a04b78be299c4e8679a5a84.e8a9f207120b23947059cce42696d8f133cb242de526ddafe282bd57488cedea,\n                          CASE WHEN NVL(net_acct_flg, 'N') = 'Y' THEN aaaa197c8a04b78be299c4e8679a5a84.7f599f836c449bebb92bb9757e86c603 ELSE NULL END net_acct_cust_sk\n                   FROM (SELECT cust_nbr,\n                                div_nbr,\n                                fisc_yr,\n                                fisc_mth_of_yr,\n                                sum(nvl(nbr_wk_ty,0)) nbr_wk_ty,\n                                cust_sk,\n                                fisc_yr_mth,\n                                sum(nvl(tagp,0)) tagp,\n                                sum(nvl(drops,0)) drops,\n                                sum(nvl(tagp_per_drop,0)) tagp_per_drop,\n                                sum(nvl(grs_sls_extnd,0)) grs_sls_extnd,\n                                sum(nvl(qty_ship,0)) qty_ship,\n                                sum(nvl(unfrm_grs_sls_extnd,0)) unfrm_grs_sls_extnd,\n                                sum(nvl(unfrm_tagp,0)) unfrm_tagp,\n                                sum(nvl(unfrm_qty_ship,0)) unfrm_qty_ship,\n                                sum(nvl(sos_cnt,0)) sos_cnt,\n                                MAX(NVL(cat_sold, 0)) cat_sold,\n                                SUM(NVL(unfrm_grs_tgp, 0)) unfrm_grs_tgp,\n                                cust_tenure_mth_actl,\n                                MAX(NVL(net_acct_flg, 0)) net_acct_flg\n                         FROM\n                         (SELECT 6f037dd8c55b34c0a958bc6e5d1c45f6.852fa1e9f02f1ca2c75837f7146b2381,\n                                6f037dd8c55b34c0a958bc6e5d1c45f6.839c4ffb4bfaae1bb58eab4dee67d96a,\n                                6f037dd8c55b34c0a958bc6e5d1c45f6.ab30d6d679879cfacfe389b97d1d3f0e,\n                                6f037dd8c55b34c0a958bc6e5d1c45f6.e1d446673288adb6d5f219d0aa82d37a,\n                                15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.b8329c7377e022434715b0dbbad8440e nbr_wk_ty,\n                                6f037dd8c55b34c0a958bc6e5d1c45f6.7f599f836c449bebb92bb9757e86c603,\n                                6f037dd8c55b34c0a958bc6e5d1c45f6.2603c45be643e5cd8f9c6dad3bee6cb3,\n                                6f037dd8c55b34c0a958bc6e5d1c45f6.e8a9f207120b23947059cce42696d8f133cb242de526ddafe282bd57488cedea,\n                                15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.eb6a312932db943ec140f42c7c8998cf  tagp,\n                                15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.630c48bbfe25ea68a239339f24d37c79  drops,\n                                15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.8f04118f95170a63ad8f7d89fff56418 tagp_per_drop,\n                                15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.2ee1400a0150f0b220dd7bd6268d1e66 grs_sls_extnd,\n                                15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.dc15696e1e997bad6131bf936574f406 qty_ship,\n                                15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.afcae1f8310cd038c0633aeaa179c10c280a4c8731f60bb762471fb74030c9a2 unfrm_grs_sls_extnd,\n                                15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.56d34efa4c0a22d07b3f8a07122ca048 unfrm_tagp,\n                                15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.ccf8d88f2d37f3171da2121ab22e9330 unfrm_qty_ship,\n                                8ce27e49d994e1c605cb69746b9cfcb2.8ce27e49d994e1c605cb69746b9cfcb2 sos_cnt,\n                                15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.37175a70b8190fbf717de5f6ebc49b0a unfrm_grs_tgp,\n                                15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.c3a904d6986fe2e41d14bc8e27a86788 cat_sold,\n                                15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.5525c623c7224d514a55baf79c2ef08f net_acct_flg\n                         FROM (SELECT aaaa197c8a04b78be299c4e8679a5a84.839c4ffb4bfaae1bb58eab4dee67d96a,\n                                      aaaa197c8a04b78be299c4e8679a5a84.852fa1e9f02f1ca2c75837f7146b2381,\n                                      de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.ab30d6d679879cfacfe389b97d1d3f0e,\n                                      de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.e1d446673288adb6d5f219d0aa82d37a,\n                                      de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.2603c45be643e5cd8f9c6dad3bee6cb3,\n                                      aaaa197c8a04b78be299c4e8679a5a84.7f599f836c449bebb92bb9757e86c603,\n                                      (SELECT COUNT(fisc_yr_mth) - 2\n                                                   FROM de459e2fe7f96e4d958537b31b946b26.ca1faaabe4743a8a00a4d208ab58b2b3\n                                                  WHERE fisc_yr_mth BETWEEN aaaa197c8a04b78be299c4e8679a5a84.55739765f192316a366e35ac5cc043c2561b89cb9074f747f5165d6920afabf2 AND de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.2603c45be643e5cd8f9c6dad3bee6cb3)\n                                           cust_tenure_mth_actl\n                               FROM ]'\n         || v_cust_vw\n         || q'[,\n                                    (SELECT de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.ab30d6d679879cfacfe389b97d1d3f0e, de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.e1d446673288adb6d5f219d0aa82d37a, de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.2603c45be643e5cd8f9c6dad3bee6cb3\n                                     FROM de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001 t\n                                     WHERE de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.ab30d6d679879cfacfe389b97d1d3f0e = ]'\n         || v_fisc_yr\n         || q'[-2]'\n         || q'[ GROUP BY de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.ab30d6d679879cfacfe389b97d1d3f0e, de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.e1d446673288adb6d5f219d0aa82d37a, de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.2603c45be643e5cd8f9c6dad3bee6cb3) t) cust_list,\n                                 (select cust_nbr, div_nbr, fisc_yr_mth, count(sos_id) sos_cnt\n                                    from de459e2fe7f96e4d958537b31b946b26.cceb59010ea14489122210934cea0e44\n                                    where inact_dt is null\n                                   and fisc_yr_mth <= ']'\n         || v_fisc_yr_mth\n         || q'[' group by cust_nbr, div_nbr, fisc_yr_mth) sos_cnt,\n                              (SELECT de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.839c4ffb4bfaae1bb58eab4dee67d96a,\n                                      de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.852fa1e9f02f1ca2c75837f7146b2381,\n                                      de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.ab30d6d679879cfacfe389b97d1d3f0e,\n                                      de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.e1d446673288adb6d5f219d0aa82d37a,\n                                      count(distinct de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.3f2fdebe4ba3a24bdf16fdac5827ebfb) nbr_wk,\n                                      SUM (NVL (de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.1afca342ab89e5b8c65c6c4c634b2186, 0)) TAGP,\n                                     count(distinct case when de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.26ac88e7ae671a1b22c14c2fce77aa2d = 'RT' AND pim_suprcls_id_actl <> 97 AND pim_suprcls_id_actl IS NOT NULL then de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.4fdc122fb2d10dd764e32cbc98972eca||de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.9f055ebf334db6c50bbcab4ff14bd2ae||INV_DT||nvl(DLVR_RTE,'')||PRCS_DT else NULL end) DROPS,\n                                     case when count(distinct case when de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.26ac88e7ae671a1b22c14c2fce77aa2d = 'RT' then de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.4fdc122fb2d10dd764e32cbc98972eca||de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.9f055ebf334db6c50bbcab4ff14bd2ae||INV_DT||nvl(DLVR_RTE,'')||PRCS_DT else NULL end) > 0\n                                          then SUM (NVL (de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.1afca342ab89e5b8c65c6c4c634b2186, 0)) /count(distinct case when de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.26ac88e7ae671a1b22c14c2fce77aa2d = 'RT' then de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.4fdc122fb2d10dd764e32cbc98972eca||de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.9f055ebf334db6c50bbcab4ff14bd2ae||INV_DT||nvl(DLVR_RTE,'')||PRCS_DT else NULL end)\n                                          else 0 end TAGP_PER_DROP,\n                                     SUM (grs_sls_extnd) AS GRS_SLS_EXTND,\n                                     SUM(CASE\n                                                WHEN de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.26ac88e7ae671a1b22c14c2fce77aa2d IN ('RT', 'VS', 'WC')\n                                                 AND de459e2fe7f96e4d958537b31b946b26.2c04d82ed0aa1cc9bce2cf2c0548b268.89f3df82917b692fe64dca942d924e7c <> 97\n                                                 AND de459e2fe7f96e4d958537b31b946b26.2c04d82ed0aa1cc9bce2cf2c0548b268.89f3df82917b692fe64dca942d924e7c is not null THEN\n                                                   de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.2ee1400a0150f0b220dd7bd6268d1e66\n                                                ELSE\n                                                   NULL\n                                             END)\n                                            no_cd_unfrm_grs_sls_extnd,\n                                     SUM(QTY_SHIP) as QTY_SHIP,\n                                     SUM(UNFRM_QTY_SHIP)UNFRM_QTY_SHIP,\n                                     sum(case when de459e2fe7f96e4d958537b31b946b26.2c04d82ed0aa1cc9bce2cf2c0548b268.89f3df82917b692fe64dca942d924e7c <> 97\n                                          and de459e2fe7f96e4d958537b31b946b26.2c04d82ed0aa1cc9bce2cf2c0548b268.89f3df82917b692fe64dca942d924e7c is not null\n                                         then grs_sls_extnd\n                                         else 0\n                                         END) UNFRM_GRS_SLS_EXTND,\n                                     sum(case when de459e2fe7f96e4d958537b31b946b26.2c04d82ed0aa1cc9bce2cf2c0548b268.89f3df82917b692fe64dca942d924e7c <> 97\n                                         and de459e2fe7f96e4d958537b31b946b26.2c04d82ed0aa1cc9bce2cf2c0548b268.89f3df82917b692fe64dca942d924e7c is not null\n                                         then actl_gp\n                                          else 0\n                                     END) UNFRM_TAGP,\n                                    SUM(CASE\n                                                WHEN de459e2fe7f96e4d958537b31b946b26.2c04d82ed0aa1cc9bce2cf2c0548b268.89f3df82917b692fe64dca942d924e7c <> 97\n                                                 AND de459e2fe7f96e4d958537b31b946b26.2c04d82ed0aa1cc9bce2cf2c0548b268.89f3df82917b692fe64dca942d924e7c IS NOT NULL THEN\n                                                   NVL(de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.2ee1400a0150f0b220dd7bd6268d1e66 - de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.c6c7cc45578c678907522e08bb04a4ca - (CASE WHEN de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.487c194c34aee6c67551aa2cdd2358ace32f6dd38f333cde68119d1f277367cd = 'P' THEN NVL(de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.d206d123f59f85e26ec113e33b465295,0) ELSE 0 END) + de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.b7982b81d447f11a0953881190e528cae32f6dd38f333cde68119d1f277367cd, 0)\n                                                ELSE\n                                                   0\n                                             END)\n                                            unfrm_grs_tgp,\n                                         COUNT(\n                                            DISTINCT (CASE\n                                                         WHEN de459e2fe7f96e4d958537b31b946b26.2c04d82ed0aa1cc9bce2cf2c0548b268.89f3df82917b692fe64dca942d924e7c <= ]'\n         || v_net_acct_pim_suprcls_id\n         || q'[ THEN\n                                                            de459e2fe7f96e4d958537b31b946b26.2c04d82ed0aa1cc9bce2cf2c0548b268.89f3df82917b692fe64dca942d924e7c\n                                                         ELSE\n                                                            NULL\n                                                      END))\n                                            cat_sold,\n                                         MAX(CASE\n                                                WHEN de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.26ac88e7ae671a1b22c14c2fce77aa2d IN ('RT', 'VS', 'WC')\n                                                 AND de459e2fe7f96e4d958537b31b946b26.2c04d82ed0aa1cc9bce2cf2c0548b268.89f3df82917b692fe64dca942d924e7c <> 97\n                                                 AND de459e2fe7f96e4d958537b31b946b26.2c04d82ed0aa1cc9bce2cf2c0548b268.89f3df82917b692fe64dca942d924e7c IS NOT NULL THEN\n                                                   'Y'\n                                                ELSE\n                                                   'N'\n                                             END)\n                                            net_acct_flg\n                               FROM de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001 t,\n                                    de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c s,\n                                    de459e2fe7f96e4d958537b31b946b26.2c04d82ed0aa1cc9bce2cf2c0548b268 pim,\n                                    de459e2fe7f96e4d958537b31b946b26.dec387908a0954ddc8689c4ad37c8a3c d, ]'\n         || v_cust_vw\n         || q'[ WHERE     de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.ab30d6d679879cfacfe389b97d1d3f0e =]'\n         || v_fisc_yr\n         || q'[-2 AND de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.cb5e253886eb30a93e66cbf95203a754 <> CASE\n                                                               WHEN de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.ab30d6d679879cfacfe389b97d1d3f0e = (]'\n         || v_fisc_yr\n         || q'[-2) AND ']'\n         || v_fisc_mth_of_yr\n         || q'[' = '12' AND ]'\n         || v_py_max_wk\n         || q'[= 53 THEN 53    \n                                                               ELSE 99    \n                                                            END\n                                     AND de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.222ccb1d1746bcdb2365f29b3da0b613 <= ']'\n         || v_end_dt\n         || \n           q'[' AND de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.f5dd4374a3e3af6a775cb6d6b22e8162 = de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.222ccb1d1746bcdb2365f29b3da0b613\n                                     AND de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.467a168a7499c57b1859198a7dac7be0 IS NULL\n                                     AND de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.839c4ffb4bfaae1bb58eab4dee67d96a = aaaa197c8a04b78be299c4e8679a5a84.839c4ffb4bfaae1bb58eab4dee67d96a\n                                     AND de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.852fa1e9f02f1ca2c75837f7146b2381 = aaaa197c8a04b78be299c4e8679a5a84.852fa1e9f02f1ca2c75837f7146b2381\n                                     AND de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.d3268eabc4a7d98105fd85f9c9e62cd6e32ad436514bbe822b33de8bead744f3 = de459e2fe7f96e4d958537b31b946b26.2c04d82ed0aa1cc9bce2cf2c0548b268.d3268eabc4a7d98105fd85f9c9e62cd6e32ad436514bbe822b33de8bead744f3\n                                     AND NVL(de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.a2b201123c685e8cc48b5468cb4a449361bbd7bc0d2d67c7d7b11cb0a8d18d03, de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.839c4ffb4bfaae1bb58eab4dee67d96a) = de459e2fe7f96e4d958537b31b946b26.dec387908a0954ddc8689c4ad37c8a3c.839c4ffb4bfaae1bb58eab4dee67d96a\n                                     AND de459e2fe7f96e4d958537b31b946b26.dec387908a0954ddc8689c4ad37c8a3c.b8c6ab19cb6e726c38f24d1885346ea3 <> 'CC'\n\t\t\t\t\t\t\t\t\t AND (case when NVL (de459e2fe7f96e4d958537b31b946b26.dec387908a0954ddc8689c4ad37c8a3c.c712a9ab5ef100c5807fa96123dac48b,'USF') <> 'USF'\n\t\t\t\t\t\t\t\t\t and NVL(de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.a2b201123c685e8cc48b5468cb4a449361bbd7bc0d2d67c7d7b11cb0a8d18d03, de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.839c4ffb4bfaae1bb58eab4dee67d96a) = de459e2fe7f96e4d958537b31b946b26.dec387908a0954ddc8689c4ad37c8a3c.839c4ffb4bfaae1bb58eab4dee67d96a\n\t\t\t\t\t\t\t\t\t and de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.f5dd4374a3e3af6a775cb6d6b22e8162 < NVL(de459e2fe7f96e4d958537b31b946b26.dec387908a0954ddc8689c4ad37c8a3c.3db9275d5f5cb2e9d918e77dbabdd97b,de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.f5dd4374a3e3af6a775cb6d6b22e8162)\n\t\t\t\t\t\t\t\t\t then 'NON_USFGL' else 'USFGL' END) ='USFGL'\n                                     GROUP BY de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.839c4ffb4bfaae1bb58eab4dee67d96a, de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.852fa1e9f02f1ca2c75837f7146b2381, de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.ab30d6d679879cfacfe389b97d1d3f0e, de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.e1d446673288adb6d5f219d0aa82d37a) cust_sales_ty_ly \n                         WHERE     6f037dd8c55b34c0a958bc6e5d1c45f6.852fa1e9f02f1ca2c75837f7146b2381 = 15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.852fa1e9f02f1ca2c75837f7146b2381(+)\n                               AND 6f037dd8c55b34c0a958bc6e5d1c45f6.839c4ffb4bfaae1bb58eab4dee67d96a = 15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.839c4ffb4bfaae1bb58eab4dee67d96a(+)\n                               AND 6f037dd8c55b34c0a958bc6e5d1c45f6.e1d446673288adb6d5f219d0aa82d37a = 15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.e1d446673288adb6d5f219d0aa82d37a(+)\n                               AND 6f037dd8c55b34c0a958bc6e5d1c45f6.2603c45be643e5cd8f9c6dad3bee6cb3 = 8ce27e49d994e1c605cb69746b9cfcb2.2603c45be643e5cd8f9c6dad3bee6cb3(+)\n                               AND 6f037dd8c55b34c0a958bc6e5d1c45f6.852fa1e9f02f1ca2c75837f7146b2381 = 8ce27e49d994e1c605cb69746b9cfcb2.852fa1e9f02f1ca2c75837f7146b2381(+)\n                               AND 6f037dd8c55b34c0a958bc6e5d1c45f6.839c4ffb4bfaae1bb58eab4dee67d96a = 8ce27e49d994e1c605cb69746b9cfcb2.839c4ffb4bfaae1bb58eab4dee67d96a(+))\n                         GROUP by\n                                cust_sk,\n                                cust_nbr,\n                                div_nbr,\n                                fisc_yr,\n                                fisc_mth_of_yr,\n                                fisc_yr_mth,\n                                cust_tenure_mth_actl\n                               ) c,\n                         (select fisc_yr, fisc_mth_of_yr, fisc_yr_mth,\n                                 min(clndr_dt) fisc_mth_strt_dt,\n                                 max(clndr_dt) fisc_mth_end_dt,\n                                 min(clndr_dt_yrago) fisc_mth_strt_dt_yrago,\n                                 max(clndr_dt_yrago) fisc_mth_end_dt_yrago\n                                 from de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001\n                                 group by fisc_yr, fisc_mth_of_yr, fisc_yr_mth) t\n                         where de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.ab30d6d679879cfacfe389b97d1d3f0e = aaaa197c8a04b78be299c4e8679a5a84.ab30d6d679879cfacfe389b97d1d3f0e\n                           and de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.e1d446673288adb6d5f219d0aa82d37a = aaaa197c8a04b78be299c4e8679a5a84.e1d446673288adb6d5f219d0aa82d37a)]';\n\n      DBMS_OUTPUT.put_line(l_trans_insert);\n\n      EXECUTE IMMEDIATE l_trans_insert;\n\n      l_insert_cnt   := sql%ROWCOUNT;\n\n      COMMIT;\n      DBMS_OUTPUT.put_line(\n         'Inserted ' || l_insert_cnt || ' rows in ' || TO_CHAR(ROUND((SYSDATE - l_fn_start) * 86400)) || ' seconds');\n\n      \n      v_mrg_stmt     :=\n         q'[MERGE INTO de459e2fe7f96e4d958537b31b946b26.1127751f1872aa967342f1fcf6b2ff72e472b097974b0d6a9a7d2ed170324906 tgt\n           USING (select cust_nbr, div_nbr, fisc_yr, fisc_mth_of_yr, fisc_wk_of_yr, cust_clsfctn, FISC_MTH_STRT_DT, FISC_MTH_END_DT, FISC_MTH_STRT_DT_YRAGO,\n                  fisc_mth_end_dt_yrago, crt_dt, nbr_of_wk_ordr_last_yr_mth, nbr_of_wk_ordr_this_yr_mth, cust_sk, fisc_yr_mth, tagp, drops, tagp_per_drop,\n                  grs_sls_extnd, qty_ship, unfrm_grs_sls_extnd, unfrm_tagp, unfrm_qty_ship, fisc_mth_sos_cnt,\n                  cat_sold, unfrm_grs_tgp, unfrm_grs_tgp_per_drop, cust_tenure_mth_actl, net_acct_cust_sk\n                  FROM ]'\n         || v_src_schema\n         || '.'\n         || v_tbl_prfx\n         || v_in_div_nbr\n         || q'[) src\n           ON (c87bbaf85002563e56e2c571e0e1c5a2.852fa1e9f02f1ca2c75837f7146b2381 = a1fa0f79e78ad884522822d320ab5272.852fa1e9f02f1ca2c75837f7146b2381 AND\n               c87bbaf85002563e56e2c571e0e1c5a2.839c4ffb4bfaae1bb58eab4dee67d96a = a1fa0f79e78ad884522822d320ab5272.839c4ffb4bfaae1bb58eab4dee67d96a AND\n               c87bbaf85002563e56e2c571e0e1c5a2.ab30d6d679879cfacfe389b97d1d3f0e = a1fa0f79e78ad884522822d320ab5272.ab30d6d679879cfacfe389b97d1d3f0e AND\n               c87bbaf85002563e56e2c571e0e1c5a2.e1d446673288adb6d5f219d0aa82d37a = a1fa0f79e78ad884522822d320ab5272.e1d446673288adb6d5f219d0aa82d37a AND\n               c87bbaf85002563e56e2c571e0e1c5a2.cb5e253886eb30a93e66cbf95203a754 = a1fa0f79e78ad884522822d320ab5272.cb5e253886eb30a93e66cbf95203a754)\n           WHEN MATCHED THEN UPDATE SET c87bbaf85002563e56e2c571e0e1c5a2.8a5c1eda3416fa5daae04a2980452d8a = a1fa0f79e78ad884522822d320ab5272.8a5c1eda3416fa5daae04a2980452d8a, c87bbaf85002563e56e2c571e0e1c5a2.f9d3f1cf71ad099f3e404366a88eb995e32f6dd38f333cde68119d1f277367cd = a1fa0f79e78ad884522822d320ab5272.f9d3f1cf71ad099f3e404366a88eb995e32f6dd38f333cde68119d1f277367cd,\n                                c87bbaf85002563e56e2c571e0e1c5a2.8d20e02b62aba6f2a610c2e8dcd7dcf6 = a1fa0f79e78ad884522822d320ab5272.8d20e02b62aba6f2a610c2e8dcd7dcf6,\n                                c87bbaf85002563e56e2c571e0e1c5a2.f9d3f1cf71ad099f3e404366a88eb9953e902a3843024b64fae1a7f98676270b = a1fa0f79e78ad884522822d320ab5272.f9d3f1cf71ad099f3e404366a88eb9953e902a3843024b64fae1a7f98676270b,\n                                c87bbaf85002563e56e2c571e0e1c5a2.68862784d9a64a36cb8af335ab89c2915ccf1cab80154371bc83602e54166aa6 = a1fa0f79e78ad884522822d320ab5272.68862784d9a64a36cb8af335ab89c2915ccf1cab80154371bc83602e54166aa6,\n                                c87bbaf85002563e56e2c571e0e1c5a2.7a133759cd0bf9f99c4a5301a550aed5 = (select sysdate from dual),\n                                c87bbaf85002563e56e2c571e0e1c5a2.b510300e3201ebdc74ca77e145879977a60007b116184ea39d15d05e56cd3bd4 = a1fa0f79e78ad884522822d320ab5272.b510300e3201ebdc74ca77e145879977a60007b116184ea39d15d05e56cd3bd4,\n                                c87bbaf85002563e56e2c571e0e1c5a2.60c87cc02b8c8cefb8bba2a977223d5f38ee6547beafb256a1079a3b44ded48f= a1fa0f79e78ad884522822d320ab5272.60c87cc02b8c8cefb8bba2a977223d5f38ee6547beafb256a1079a3b44ded48f,\n                                c87bbaf85002563e56e2c571e0e1c5a2.eb6a312932db943ec140f42c7c8998cf= a1fa0f79e78ad884522822d320ab5272.eb6a312932db943ec140f42c7c8998cf, c87bbaf85002563e56e2c571e0e1c5a2.630c48bbfe25ea68a239339f24d37c79= a1fa0f79e78ad884522822d320ab5272.630c48bbfe25ea68a239339f24d37c79,\n                                c87bbaf85002563e56e2c571e0e1c5a2.dc15696e1e997bad6131bf936574f406 = a1fa0f79e78ad884522822d320ab5272.dc15696e1e997bad6131bf936574f406,\n                                c87bbaf85002563e56e2c571e0e1c5a2.2ee1400a0150f0b220dd7bd6268d1e66 = a1fa0f79e78ad884522822d320ab5272.2ee1400a0150f0b220dd7bd6268d1e66, c87bbaf85002563e56e2c571e0e1c5a2.afcae1f8310cd038c0633aeaa179c10c280a4c8731f60bb762471fb74030c9a2 = a1fa0f79e78ad884522822d320ab5272.afcae1f8310cd038c0633aeaa179c10c280a4c8731f60bb762471fb74030c9a2,\n                                c87bbaf85002563e56e2c571e0e1c5a2.56d34efa4c0a22d07b3f8a07122ca048 = a1fa0f79e78ad884522822d320ab5272.56d34efa4c0a22d07b3f8a07122ca048, c87bbaf85002563e56e2c571e0e1c5a2.ccf8d88f2d37f3171da2121ab22e9330 = a1fa0f79e78ad884522822d320ab5272.ccf8d88f2d37f3171da2121ab22e9330,\n                                c87bbaf85002563e56e2c571e0e1c5a2.bf06ba7d684771516450326e880739f3e32f6dd38f333cde68119d1f277367cd = a1fa0f79e78ad884522822d320ab5272.bf06ba7d684771516450326e880739f3e32f6dd38f333cde68119d1f277367cd,\n                                c87bbaf85002563e56e2c571e0e1c5a2.c3a904d6986fe2e41d14bc8e27a86788 = a1fa0f79e78ad884522822d320ab5272.c3a904d6986fe2e41d14bc8e27a86788,\n                                c87bbaf85002563e56e2c571e0e1c5a2.37175a70b8190fbf717de5f6ebc49b0a = a1fa0f79e78ad884522822d320ab5272.37175a70b8190fbf717de5f6ebc49b0a,\n                                c87bbaf85002563e56e2c571e0e1c5a2.e6160a512e148d90c7df38ae2e16368dcd30f368447f67a772f6e122173aa0f4 = a1fa0f79e78ad884522822d320ab5272.e6160a512e148d90c7df38ae2e16368dcd30f368447f67a772f6e122173aa0f4,\n                                c87bbaf85002563e56e2c571e0e1c5a2.e8a9f207120b23947059cce42696d8f133cb242de526ddafe282bd57488cedea = a1fa0f79e78ad884522822d320ab5272.e8a9f207120b23947059cce42696d8f133cb242de526ddafe282bd57488cedea,\n                                c87bbaf85002563e56e2c571e0e1c5a2.427b165a60053aea6330e695e94a70a7e32f6dd38f333cde68119d1f277367cd = a1fa0f79e78ad884522822d320ab5272.427b165a60053aea6330e695e94a70a7e32f6dd38f333cde68119d1f277367cd\n           WHEN NOT MATCHED THEN INSERT (cust_sk,cust_nbr, div_nbr, fisc_yr, fisc_mth_of_yr, fisc_yr_mth, fisc_wk_of_yr, cust_clsfctn, FISC_MTH_STRT_DT, FISC_MTH_END_DT,\n                                         FISC_MTH_STRT_DT_YRAGO, FISC_MTH_END_DT_YRAGO, crt_dt,nbr_of_wk_ordr_last_yr_mth, nbr_of_wk_ordr_this_yr_mth,\n                                         grs_sls_extnd, qty_ship, unfrm_grs_sls_extnd, unfrm_tagp, unfrm_qty_ship, fisc_mth_sos_cnt,\n                                         cat_sold, unfrm_grs_tgp, unfrm_grs_tgp_per_drop, cust_tenure_mth_actl, net_acct_cust_sk)\n           VALUES(a1fa0f79e78ad884522822d320ab5272.7f599f836c449bebb92bb9757e86c603, a1fa0f79e78ad884522822d320ab5272.852fa1e9f02f1ca2c75837f7146b2381, a1fa0f79e78ad884522822d320ab5272.839c4ffb4bfaae1bb58eab4dee67d96a, a1fa0f79e78ad884522822d320ab5272.ab30d6d679879cfacfe389b97d1d3f0e, a1fa0f79e78ad884522822d320ab5272.e1d446673288adb6d5f219d0aa82d37a, a1fa0f79e78ad884522822d320ab5272.2603c45be643e5cd8f9c6dad3bee6cb3, a1fa0f79e78ad884522822d320ab5272.cb5e253886eb30a93e66cbf95203a754, a1fa0f79e78ad884522822d320ab5272.8a5c1eda3416fa5daae04a2980452d8a, a1fa0f79e78ad884522822d320ab5272.f9d3f1cf71ad099f3e404366a88eb995e32f6dd38f333cde68119d1f277367cd, a1fa0f79e78ad884522822d320ab5272.8d20e02b62aba6f2a610c2e8dcd7dcf6,\n                  a1fa0f79e78ad884522822d320ab5272.f9d3f1cf71ad099f3e404366a88eb9953e902a3843024b64fae1a7f98676270b, a1fa0f79e78ad884522822d320ab5272.68862784d9a64a36cb8af335ab89c2915ccf1cab80154371bc83602e54166aa6, a1fa0f79e78ad884522822d320ab5272.44db07dca7893985ce87192c7f358f75, a1fa0f79e78ad884522822d320ab5272.b510300e3201ebdc74ca77e145879977a60007b116184ea39d15d05e56cd3bd4, a1fa0f79e78ad884522822d320ab5272.60c87cc02b8c8cefb8bba2a977223d5f38ee6547beafb256a1079a3b44ded48f,\n                  a1fa0f79e78ad884522822d320ab5272.2ee1400a0150f0b220dd7bd6268d1e66, a1fa0f79e78ad884522822d320ab5272.dc15696e1e997bad6131bf936574f406, a1fa0f79e78ad884522822d320ab5272.afcae1f8310cd038c0633aeaa179c10c280a4c8731f60bb762471fb74030c9a2, a1fa0f79e78ad884522822d320ab5272.56d34efa4c0a22d07b3f8a07122ca048, a1fa0f79e78ad884522822d320ab5272.ccf8d88f2d37f3171da2121ab22e9330, a1fa0f79e78ad884522822d320ab5272.bf06ba7d684771516450326e880739f3e32f6dd38f333cde68119d1f277367cd,\n                  a1fa0f79e78ad884522822d320ab5272.c3a904d6986fe2e41d14bc8e27a86788, a1fa0f79e78ad884522822d320ab5272.37175a70b8190fbf717de5f6ebc49b0a, a1fa0f79e78ad884522822d320ab5272.e6160a512e148d90c7df38ae2e16368dcd30f368447f67a772f6e122173aa0f4, a1fa0f79e78ad884522822d320ab5272.e8a9f207120b23947059cce42696d8f133cb242de526ddafe282bd57488cedea, a1fa0f79e78ad884522822d320ab5272.427b165a60053aea6330e695e94a70a7e32f6dd38f333cde68119d1f277367cd)]';\n\n      DBMS_OUTPUT.put_line(v_mrg_stmt);\n\n      EXECUTE IMMEDIATE v_mrg_stmt;\n\n      COMMIT;\n\n      DBMS_OUTPUT.put_line('Table 0e03d5c46556a742ba46252698396ef2.721891e4514843e572b9cce1f6313467fe1273d196c209677ff154534715415c updated ' || SYSTIMESTAMP);\n\n      EXECUTE IMMEDIATE 'DROP TABLE ' || v_src_schema || '.' || v_tbl_prfx || v_in_div_nbr;\n\n      DBMS_OUTPUT.put_line(\n         'Table ' || v_src_schema || '.' || v_tbl_prfx || v_in_div_nbr || ' dropped ' || SYSTIMESTAMP);\n   ELSE\n      DBMS_OUTPUT.put_line('No customer(s) to reclassify ' || SYSTIMESTAMP);\n   END IF;\n\n   IF v_in_cust_nbr IS NULL THEN\n      \n      \n      SELECT COUNT( * )\n        INTO v_cnt2\n        FROM de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c\n       WHERE div_nbr = v_in_div_nbr\n         AND xfer_to_dt IS NOT NULL\n         AND ldr_tm > v_in_ldr_tm;\n\n      DBMS_OUTPUT.put_line('v_cnt2 ' || v_cnt2);\n\n      IF v_cnt2 > 0 THEN\n         DELETE FROM de459e2fe7f96e4d958537b31b946b26.1127751f1872aa967342f1fcf6b2ff72e472b097974b0d6a9a7d2ed170324906\n               WHERE div_nbr = v_in_div_nbr\n                 AND cust_nbr IN (SELECT DISTINCT cust_nbr\n                                    FROM de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c\n                                   WHERE div_nbr = v_in_div_nbr\n                                     AND xfer_to_dt IS NOT NULL\n                                     AND ldr_tm > v_in_ldr_tm);\n\n         COMMIT;\n         DBMS_OUTPUT.put_line('Deleted customers that were transferred out ' || SYSTIMESTAMP);\n      END IF;\n\n      \n      \n      INSERT INTO de459e2fe7f96e4d958537b31b946b26.1127751f1872aa967342f1fcf6b2ff72e472b097974b0d6a9a7d2ed170324906(cust_sk, cust_nbr, div_nbr, fisc_yr, fisc_mth_of_yr, fisc_yr_mth,\n                                           fisc_wk_of_yr, cust_clsfctn, fisc_mth_strt_dt, fisc_mth_end_dt, fisc_mth_strt_dt_yrago, fisc_mth_end_dt_yrago,\n                                           crt_dt, tagp, drops, tagp_per_drop, cat_sold, cust_tenure_mth_actl)\n         SELECT 79bce3e4027780054b8a49ac57719e09.7f599f836c449bebb92bb9757e86c603,\n                79bce3e4027780054b8a49ac57719e09.852fa1e9f02f1ca2c75837f7146b2381,\n                79bce3e4027780054b8a49ac57719e09.839c4ffb4bfaae1bb58eab4dee67d96a,\n                79bce3e4027780054b8a49ac57719e09.ab30d6d679879cfacfe389b97d1d3f0e,\n                79bce3e4027780054b8a49ac57719e09.e1d446673288adb6d5f219d0aa82d37a,\n                79bce3e4027780054b8a49ac57719e09.2603c45be643e5cd8f9c6dad3bee6cb3,\n                0 \n                 ,\n                NULL,\n                v_fisc_mth_strt_dt,\n                v_fisc_mth_end_dt,\n                v_fisc_mth_strt_dt_yrago,\n                v_fisc_mth_end_dt_yrago,\n                SYSDATE,\n                NULL,\n                NULL,\n                NULL,\n                0, \n                (SELECT COUNT(fisc_yr_mth) - 2\n                   FROM de459e2fe7f96e4d958537b31b946b26.ca1faaabe4743a8a00a4d208ab58b2b3, de459e2fe7f96e4d958537b31b946b26.52982d3bbc1ebc2720d9504c7ea2ed3f cc\n                  WHERE fisc_yr_mth BETWEEN de459e2fe7f96e4d958537b31b946b26.52982d3bbc1ebc2720d9504c7ea2ed3f.55739765f192316a366e35ac5cc043c2561b89cb9074f747f5165d6920afabf2 AND v_cur_fisc_yr_mth\n                    AND de459e2fe7f96e4d958537b31b946b26.52982d3bbc1ebc2720d9504c7ea2ed3f.852fa1e9f02f1ca2c75837f7146b2381 = 79bce3e4027780054b8a49ac57719e09.852fa1e9f02f1ca2c75837f7146b2381\n                    AND de459e2fe7f96e4d958537b31b946b26.52982d3bbc1ebc2720d9504c7ea2ed3f.839c4ffb4bfaae1bb58eab4dee67d96a = 79bce3e4027780054b8a49ac57719e09.839c4ffb4bfaae1bb58eab4dee67d96a)\n                   cust_tenure_mth_actl \n           FROM (SELECT DISTINCT de459e2fe7f96e4d958537b31b946b26.52982d3bbc1ebc2720d9504c7ea2ed3f.7f599f836c449bebb92bb9757e86c603,\n                                 de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.839c4ffb4bfaae1bb58eab4dee67d96a,\n                                 de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.852fa1e9f02f1ca2c75837f7146b2381,\n                                 v_cur_fisc_yr AS fisc_yr,\n                                 v_cur_fisc_mth_of_yr AS fisc_mth_of_yr,\n                                 v_cur_fisc_yr_mth AS fisc_yr_mth\n                   FROM de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001 t, de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c s, de459e2fe7f96e4d958537b31b946b26.52982d3bbc1ebc2720d9504c7ea2ed3f cc\n                  WHERE de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.ab30d6d679879cfacfe389b97d1d3f0e = v_cur_fisc_yr\n                    AND de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.cb5e253886eb30a93e66cbf95203a754 = v_fisc_wk_of_yr\n                    AND de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.f5dd4374a3e3af6a775cb6d6b22e8162 = de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.222ccb1d1746bcdb2365f29b3da0b613\n                    AND de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.839c4ffb4bfaae1bb58eab4dee67d96a = v_in_div_nbr\n                    AND de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.852fa1e9f02f1ca2c75837f7146b2381 = de459e2fe7f96e4d958537b31b946b26.52982d3bbc1ebc2720d9504c7ea2ed3f.852fa1e9f02f1ca2c75837f7146b2381\n                    AND de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.839c4ffb4bfaae1bb58eab4dee67d96a = de459e2fe7f96e4d958537b31b946b26.52982d3bbc1ebc2720d9504c7ea2ed3f.839c4ffb4bfaae1bb58eab4dee67d96a\n                    AND de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.467a168a7499c57b1859198a7dac7be0 IS NULL\n                 MINUS\n                 SELECT cust_sk,\n                        div_nbr,\n                        cust_nbr,\n                        fisc_yr,\n                        fisc_mth_of_yr,\n                        fisc_yr_mth\n                   FROM de459e2fe7f96e4d958537b31b946b26.1127751f1872aa967342f1fcf6b2ff72e472b097974b0d6a9a7d2ed170324906\n                  WHERE div_nbr = v_in_div_nbr\n                    AND fisc_yr = v_cur_fisc_yr\n                    AND fisc_mth_of_yr = v_cur_fisc_mth_of_yr) cust;\n   END IF;\n\n   DBMS_OUTPUT.put_line('v_cnt ' || v_cnt);\n\n   IF v_cnt > 0 THEN\n      OPEN tagp_drops(v_fisc_yr,\n                      v_fisc_mth_of_yr,\n                      v_end_dt,\n                      v_in_div_nbr,\n                      v_last_fisc_yr_mth,\n                      v_fisc_yr_mth_three_mth_ago,\n                      v_fisc_yr_mth_six_mth_ago,\n                      v_prior_fisc_mth_strt_dt);\n\n      LOOP\n         EXIT WHEN tagp_drops%NOTFOUND;\n\n         DBMS_OUTPUT.put_line('loop');\n\n         FETCH tagp_drops\n         BULK COLLECT INTO r_tagp_drops\n         LIMIT 1000;\n\n         FORALL i IN 1 .. 2abd397b42f698e88c7f8e93c8e526ac.c838adb0c77d39edf51006214ba6e643()\n            UPDATE \n                  de459e2fe7f96e4d958537b31b946b26.1127751f1872aa967342f1fcf6b2ff72e472b097974b0d6a9a7d2ed170324906 b\n               SET next_fisc_mth_cust_clsfctn      = r_tagp_drops(i).next_fisc_mth_cust_clsfctn,\n                   third_fisc_mth_cust_clsfctn     = r_tagp_drops(i).three_mth_cust_clsfctn,\n                   sixth_fisc_mth_cust_clsfctn     = r_tagp_drops(i).six_mth_cust_clsfctn,\n                   nbr_of_wk_ordr_next_fisc_mth    = r_tagp_drops(i).nbr_of_wk_ordr_next_mth,\n                   next_fmth_unfrm_grs_sls_extnd   = r_tagp_drops(i).next_fmth_unfrm_grs_sls_extnd, \n                   next_fmth_unfrm_tagp            = r_tagp_drops(i).next_fmth_unfrm_tagp, \n                   next_fmth_unfrm_grs_tgp         = r_tagp_drops(i).next_fmth_unfrm_grs_tgp,\n                   next_fmth_unfrm_qty_ship        = r_tagp_drops(i).next_fmth_unfrm_qty_ship \n             WHERE 6d9b37be5a083f8b78d676aba846c823.839c4ffb4bfaae1bb58eab4dee67d96a = r_tagp_drops(i).div_nbr\n               AND 6d9b37be5a083f8b78d676aba846c823.852fa1e9f02f1ca2c75837f7146b2381 = r_tagp_drops(i).cust_nbr\n               AND 6d9b37be5a083f8b78d676aba846c823.d3ec1a21507970329af1c66ef244cdefe32f6dd38f333cde68119d1f277367cd = r_tagp_drops(i).fisc_mth_strt_dt\n               AND 6d9b37be5a083f8b78d676aba846c823.7f599f836c449bebb92bb9757e86c603 = r_tagp_drops(i).cust_sk;\n      END LOOP;\n\n      DBMS_OUTPUT.put_line('Rows Updated' || sql%ROWCOUNT);\n\n      CLOSE tagp_drops;\n   ELSE\n      DBMS_OUTPUT.put_line('No customer(s) to update ' || SYSTIMESTAMP);\n   END IF;\n\n   COMMIT;\n\n   \n   OPEN c_ap_tgp;\n\n   LOOP\n      EXIT WHEN c_ap_tgp%NOTFOUND;\n\n      FETCH c_ap_tgp\n      BULK COLLECT INTO r_ap_tgp\n      LIMIT 10000;\n\n      FORALL i IN 1 .. caccafa413afe7566d178b5d61b27be2.c838adb0c77d39edf51006214ba6e643()\n         UPDATE \n               de459e2fe7f96e4d958537b31b946b26.1127751f1872aa967342f1fcf6b2ff72e472b097974b0d6a9a7d2ed170324906 b\n            SET unfrm_grs_tgp = r_ap_tgp(i).unfrm_grs_tgp, unfrm_grs_tgp_per_drop = r_ap_tgp(i).unfrm_grs_tgp_per_drop\n          WHERE 6d9b37be5a083f8b78d676aba846c823.839c4ffb4bfaae1bb58eab4dee67d96a = r_ap_tgp(i).div_nbr\n            AND 6d9b37be5a083f8b78d676aba846c823.852fa1e9f02f1ca2c75837f7146b2381 = r_ap_tgp(i).cust_nbr\n            AND 6d9b37be5a083f8b78d676aba846c823.d3ec1a21507970329af1c66ef244cdefe32f6dd38f333cde68119d1f277367cd = r_ap_tgp(i).fisc_mth_start_dt\n            AND 6d9b37be5a083f8b78d676aba846c823.7f599f836c449bebb92bb9757e86c603 = r_ap_tgp(i).cust_sk;\n\n      DBMS_OUTPUT.put_line('Rows Updated' || sql%ROWCOUNT);\n      COMMIT;\n   END LOOP;\n\n   CLOSE c_ap_tgp;\n\n   RETURN 0;\nEXCEPTION\n   WHEN OTHERS THEN\n      DBMS_OUTPUT.put_line('Error in 0e03d5c46556a742ba46252698396ef2.e048cb729ea7e0498c639d0c4635e261:' || SQLCODE || ' ' || SQLERRM);\n      RETURN 1;\nEND fn_cust_cls_dly;\n/",
            "upstream_dependencies": [],
            "downstream_dependencies": [],
            "dag_location": "null",
            "gantt_location": "null",
            "created_at": "null",
            "updated_at": "null"
        },
        {
            "name": "FN_CUST_CLS_CORP_WKLY_RECLS",
            "encrypted_name": "6ed4b6f3334125cd8e95581577ce6a607f6e73c66a4a5e01d3b1c9c28dca86ff",
            "type": "function",
            "database": "null",
            "encrypted_database": "null",
            "schema": "XDMADM",
            "encrypted_schema": "0e03d5c46556a742ba46252698396ef2",
            "fully_qualified_name": "XDMADM.FN_CUST_CLS_CORP_WKLY_RECLS",
            "encrypted_fqn": "0e03d5c46556a742ba46252698396ef2.6ed4b6f3334125cd8e95581577ce6a607f6e73c66a4a5e01d3b1c9c28dca86ff",
            "synonyms": [],
            "metadata_analysis": "CREATE OR REPLACE FUNCTION \"0e03d5c46556a742ba46252698396ef2\".\"6ed4b6f3334125cd8e95581577ce6a607f6e73c66a4a5e01d3b1c9c28dca86ff\" (v_in_odate     IN VARCHAR2,\n                         v_in_ldr_tm    IN NUMBER,\n                         v_in_div_nbr   IN NUMBER,\n                         v_in_cust_nbr  IN VARCHAR2 DEFAULT NULL)\n   RETURN NUMBER IS\n   \n\n   \n   v_odate                          DATE := TO_DATE(v_in_odate, 'YYYYMMDD');\n   v_src_schema                     VARCHAR2(20) := 'XDMADM';\n   v_tgt_schema                     VARCHAR2(20) := 'XDMADM';\n   v_tbl_prfx                       VARCHAR2(20) := 'CUST_CLSFCTN_WKLY_';\n   v_end_dt                         DATE;\n   v_fisc_yr                        NUMBER(4);\n   v_cur_fisc_yr                    NUMBER(4);\n   v_fisc_mth_of_yr                 VARCHAR2(2);\n   v_cur_fisc_mth_of_yr             VARCHAR2(2);\n   v_cur_fisc_yr_mth                VARCHAR(18);\n   v_fisc_wk_of_yr                  NUMBER(2);\n   v_fisc_wk_strt_dt                DATE;\n   v_fisc_wk_strt_dt_yrago          DATE;\n   v_fisc_wk_end_dt                 DATE;\n   v_fisc_wk_end_dt_yrago           DATE;\n   v_fisc_mth_end_dt_yrago          DATE;\n   v_fisc_wk_of_prd                 NUMBER(2);\n   v_py_max_wk                      NUMBER(2);\n   v_2y_ago_max_wk                  NUMBER(2);\n   v_cnt                            NUMBER;\n   v_cnt2                           NUMBER;\n   v_ctas_stmt                      VARCHAR2(32767);\n   v_mrg_stmt                       VARCHAR2(5000);\n   v_cust_vw                        VARCHAR2(1000);\n   v_prior_fisc_mth_strt_dt         DATE;\n   v_last_fisc_mth_of_yr            NUMBER;\n   v_fisc_yr_last_mth               NUMBER;\n   v_fisc_mth_strt_dt_yrago         DATE;\n   v_fisc_mth_strt_dt               DATE;\n   v_fisc_mth_end_dt                DATE;\n   v_fisc_yr_three_mth_ago          NUMBER;\n   v_fisc_mth_of_yr_three_mth_ago   VARCHAR(2);\n   v_fisc_yr_six_mth_ago            NUMBER;\n   v_fisc_mth_of_yr_six_mth_ago     VARCHAR(2);\n   v_fisc_yr_mth_six_mth_ago        VARCHAR2(18);\n   v_fisc_yr_mth_three_mth_ago      VARCHAR2(18);\n   v_last_fisc_yr_mth               VARCHAR2(18);\n   v_fisc_yr_mth                    VARCHAR2(18);\n   l_insert_cnt                     NUMBER;\n   l_trans_insert                   VARCHAR2(32767);\n   l_fn_start                       DATE;\n   v_net_acct_pim_suprcls_id        NUMBER;\n\n   \n   CURSOR c_ap_tgp IS\n      SELECT ca9aa42c2ae0d34c5dafc0c63ded894a.852fa1e9f02f1ca2c75837f7146b2381,\n             ca9aa42c2ae0d34c5dafc0c63ded894a.839c4ffb4bfaae1bb58eab4dee67d96a,\n             ca9aa42c2ae0d34c5dafc0c63ded894a.7f599f836c449bebb92bb9757e86c603,\n             ca9aa42c2ae0d34c5dafc0c63ded894a.f2de255a7553ba934b1f05ae7699ae4c,\n             ca9aa42c2ae0d34c5dafc0c63ded894a.dfe42c57475d9fd89d96ed9e57b69306,\n             ca9aa42c2ae0d34c5dafc0c63ded894a.37175a70b8190fbf717de5f6ebc49b0a,\n             CASE\n                WHEN ca9aa42c2ae0d34c5dafc0c63ded894a.37175a70b8190fbf717de5f6ebc49b0a <> 0 THEN CASE WHEN ca9aa42c2ae0d34c5dafc0c63ded894a.5eb47379f9cd1fd0a9110e76b90fc8c4 <> 0 THEN ca9aa42c2ae0d34c5dafc0c63ded894a.37175a70b8190fbf717de5f6ebc49b0a / ca9aa42c2ae0d34c5dafc0c63ded894a.5eb47379f9cd1fd0a9110e76b90fc8c4 ELSE 0 END\n                ELSE NULL\n             END\n                unfrm_grs_tgp_per_drop\n        FROM (  SELECT de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.852fa1e9f02f1ca2c75837f7146b2381,\n                       de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.839c4ffb4bfaae1bb58eab4dee67d96a,\n                       de459e2fe7f96e4d958537b31b946b26.52982d3bbc1ebc2720d9504c7ea2ed3f.7f599f836c449bebb92bb9757e86c603,\n                       de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.f2de255a7553ba934b1f05ae7699ae4c,\n                       de459e2fe7f96e4d958537b31b946b26.c063519e87e23d735cdb53a35832f0ff.c9ed3827968a72723f7e114f602d0196e32f6dd38f333cde68119d1f277367cd as fisc_wk_strt_dt,\n                       SUM(CASE\n                              WHEN NVL(de459e2fe7f96e4d958537b31b946b26.2c04d82ed0aa1cc9bce2cf2c0548b268.89f3df82917b692fe64dca942d924e7c, 1) <> 97 THEN\n                                 NVL(de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.2ee1400a0150f0b220dd7bd6268d1e66 - de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.c6c7cc45578c678907522e08bb04a4ca + de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.b7982b81d447f11a0953881190e528cae32f6dd38f333cde68119d1f277367cd\n                                        - CASE\n                                            WHEN de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.487c194c34aee6c67551aa2cdd2358ace32f6dd38f333cde68119d1f277367cd = 'P' THEN NVL(de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.d206d123f59f85e26ec113e33b465295,0)\n                                            ELSE 0\n                                          END, 0)\n                              ELSE\n                                 0\n                           END)\n                          unfrm_grs_tgp,\n                       COUNT(DISTINCT CASE\n                                         WHEN NVL(de459e2fe7f96e4d958537b31b946b26.2c04d82ed0aa1cc9bce2cf2c0548b268.89f3df82917b692fe64dca942d924e7c, 1) <> 97\n                                          AND de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.26ac88e7ae671a1b22c14c2fce77aa2d = 'RT' THEN\n                                            de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.839c4ffb4bfaae1bb58eab4dee67d96a || de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.852fa1e9f02f1ca2c75837f7146b2381 || de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.f5dd4374a3e3af6a775cb6d6b22e8162 || de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.faaaf9cbe8897987592d529a771bbc17 || de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.c4ffe3bd27523a268da639921856c18e\n                                         ELSE\n                                            NULL\n                                      END)\n                          drop_cnt\n                  FROM de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c s,\n                       de459e2fe7f96e4d958537b31b946b26.dec387908a0954ddc8689c4ad37c8a3c d,\n                       de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001 t,\n                       de459e2fe7f96e4d958537b31b946b26.c063519e87e23d735cdb53a35832f0ff p,\n                       de459e2fe7f96e4d958537b31b946b26.2c04d82ed0aa1cc9bce2cf2c0548b268 pim,\n                       de459e2fe7f96e4d958537b31b946b26.52982d3bbc1ebc2720d9504c7ea2ed3f c\n                 WHERE NVL(de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.a2b201123c685e8cc48b5468cb4a449361bbd7bc0d2d67c7d7b11cb0a8d18d03, de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.839c4ffb4bfaae1bb58eab4dee67d96a) = de459e2fe7f96e4d958537b31b946b26.dec387908a0954ddc8689c4ad37c8a3c.839c4ffb4bfaae1bb58eab4dee67d96a\n                   AND de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.f5dd4374a3e3af6a775cb6d6b22e8162 = de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.222ccb1d1746bcdb2365f29b3da0b613\n                   AND de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.852fa1e9f02f1ca2c75837f7146b2381 = de459e2fe7f96e4d958537b31b946b26.52982d3bbc1ebc2720d9504c7ea2ed3f.852fa1e9f02f1ca2c75837f7146b2381\n                   AND de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.839c4ffb4bfaae1bb58eab4dee67d96a = de459e2fe7f96e4d958537b31b946b26.52982d3bbc1ebc2720d9504c7ea2ed3f.839c4ffb4bfaae1bb58eab4dee67d96a\n                   AND de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.d3268eabc4a7d98105fd85f9c9e62cd6e32ad436514bbe822b33de8bead744f3 = de459e2fe7f96e4d958537b31b946b26.2c04d82ed0aa1cc9bce2cf2c0548b268.d3268eabc4a7d98105fd85f9c9e62cd6e32ad436514bbe822b33de8bead744f3\n                   AND de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.467a168a7499c57b1859198a7dac7be0 IS NULL\n                   AND de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.f2de255a7553ba934b1f05ae7699ae4c = de459e2fe7f96e4d958537b31b946b26.c063519e87e23d735cdb53a35832f0ff.f2de255a7553ba934b1f05ae7699ae4c\n                   AND de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.839c4ffb4bfaae1bb58eab4dee67d96a = v_in_div_nbr\n                   AND de459e2fe7f96e4d958537b31b946b26.dec387908a0954ddc8689c4ad37c8a3c.b8c6ab19cb6e726c38f24d1885346ea3 <> 'CC'\n\t\t\t\t   AND  (case when NVL (de459e2fe7f96e4d958537b31b946b26.dec387908a0954ddc8689c4ad37c8a3c.c712a9ab5ef100c5807fa96123dac48b,'USF') <> 'USF'\n\t\t\t\t\t and NVL(de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.a2b201123c685e8cc48b5468cb4a449361bbd7bc0d2d67c7d7b11cb0a8d18d03, de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.839c4ffb4bfaae1bb58eab4dee67d96a) = de459e2fe7f96e4d958537b31b946b26.dec387908a0954ddc8689c4ad37c8a3c.839c4ffb4bfaae1bb58eab4dee67d96a\n\t\t\t\t\t and de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.f5dd4374a3e3af6a775cb6d6b22e8162 < NVL(de459e2fe7f96e4d958537b31b946b26.dec387908a0954ddc8689c4ad37c8a3c.3db9275d5f5cb2e9d918e77dbabdd97b,de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.f5dd4374a3e3af6a775cb6d6b22e8162)\n\t\t\t\t\t then 'NON_USFGL' else 'USFGL' END) ='USFGL'\n\n                   AND EXISTS (SELECT 'X'\n                                 FROM de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c s2, de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001 t2\n                                WHERE de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.f5dd4374a3e3af6a775cb6d6b22e8162 = de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.222ccb1d1746bcdb2365f29b3da0b613\n                                  AND de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.839c4ffb4bfaae1bb58eab4dee67d96a = v_in_div_nbr\n                                  AND de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.467a168a7499c57b1859198a7dac7be0 IS NULL\n                                  AND de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.224811ad2521818a46ceb20442ea1122 IS NULL\n                                  AND de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.721a8ad171b31ae60261431ccd51b52d > v_in_ldr_tm\n                                  AND de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.26ac88e7ae671a1b22c14c2fce77aa2d = 'AP'\n                                  AND de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.852fa1e9f02f1ca2c75837f7146b2381 = de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.852fa1e9f02f1ca2c75837f7146b2381\n                                  AND de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.839c4ffb4bfaae1bb58eab4dee67d96a = de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.839c4ffb4bfaae1bb58eab4dee67d96a\n                                  AND de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.f2de255a7553ba934b1f05ae7699ae4c = de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.f2de255a7553ba934b1f05ae7699ae4c)\n              GROUP BY de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.852fa1e9f02f1ca2c75837f7146b2381,\n                       de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.839c4ffb4bfaae1bb58eab4dee67d96a,\n                       de459e2fe7f96e4d958537b31b946b26.52982d3bbc1ebc2720d9504c7ea2ed3f.7f599f836c449bebb92bb9757e86c603,\n                       de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.f2de255a7553ba934b1f05ae7699ae4c,\n                       de459e2fe7f96e4d958537b31b946b26.c063519e87e23d735cdb53a35832f0ff.c9ed3827968a72723f7e114f602d0196e32f6dd38f333cde68119d1f277367cd) x;\n\n   TYPE t_ap_tgp IS TABLE OF c_ap_tgp%ROWTYPE;\n\n   r_ap_tgp                         t_ap_tgp;\n\n\nBEGIN\n   l_fn_start   := SYSDATE;\n\n   \n   \n   \n\n\n\tv_end_dt   := v_odate;\n\n   SELECT de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.ab30d6d679879cfacfe389b97d1d3f0e, de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.e1d446673288adb6d5f219d0aa82d37a, de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.2603c45be643e5cd8f9c6dad3bee6cb3\n     INTO v_fisc_yr, v_fisc_mth_of_yr, v_fisc_yr_mth\n     FROM de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001 t\n    WHERE de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.222ccb1d1746bcdb2365f29b3da0b613 = v_end_dt;\n\n   SELECT de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.ab30d6d679879cfacfe389b97d1d3f0e,\n          de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.e1d446673288adb6d5f219d0aa82d37a,\n          de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.cb5e253886eb30a93e66cbf95203a754,\n          de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.3f2fdebe4ba3a24bdf16fdac5827ebfb,\n          de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.2603c45be643e5cd8f9c6dad3bee6cb3\n     INTO v_cur_fisc_yr,\n          v_cur_fisc_mth_of_yr,\n          v_fisc_wk_of_yr,\n          v_fisc_wk_of_prd,\n          v_cur_fisc_yr_mth\n     FROM de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001 t\n    WHERE de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.222ccb1d1746bcdb2365f29b3da0b613 = v_odate;\n\n   SELECT MIN(de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.222ccb1d1746bcdb2365f29b3da0b613), MIN(de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.7953dad27b9ff5d770ad768175bcaa56),MAX(de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.222ccb1d1746bcdb2365f29b3da0b613),MAX(de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.7953dad27b9ff5d770ad768175bcaa56)\n     INTO v_fisc_wk_strt_dt, v_fisc_wk_strt_dt_yrago ,v_fisc_wk_end_dt,v_fisc_wk_end_dt_yrago\n     FROM de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001 t\n    WHERE de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.ab30d6d679879cfacfe389b97d1d3f0e = v_cur_fisc_yr\n      AND de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.cb5e253886eb30a93e66cbf95203a754 = v_fisc_wk_of_yr;\n\n   SELECT MAX(de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.7953dad27b9ff5d770ad768175bcaa56),\n          MIN(clndr_dt_yrago),\n          MIN(clndr_dt),\n          MAX(clndr_dt)\n     INTO v_fisc_mth_end_dt_yrago,\n          v_fisc_mth_strt_dt_yrago,\n          v_fisc_mth_strt_dt,\n          v_fisc_mth_end_dt\n     FROM de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001 t\n    WHERE de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.ab30d6d679879cfacfe389b97d1d3f0e = v_cur_fisc_yr\n      AND de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.e1d446673288adb6d5f219d0aa82d37a = v_cur_fisc_mth_of_yr;\n\n   SELECT MAX(de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.cb5e253886eb30a93e66cbf95203a754)\n     INTO v_py_max_wk \n     FROM de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001 t\n    WHERE de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.ab30d6d679879cfacfe389b97d1d3f0e = v_fisc_yr - 1;\n\n   SELECT MAX(de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.cb5e253886eb30a93e66cbf95203a754)\n     INTO v_2y_ago_max_wk \n     FROM de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001 t\n    WHERE de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.ab30d6d679879cfacfe389b97d1d3f0e = v_fisc_yr - 2;\n\n   IF v_fisc_wk_of_prd <> 1 THEN\n      v_fisc_wk_strt_dt_yrago   := NULL;\n      v_fisc_mth_end_dt_yrago   := NULL;\n   END IF;\n\n   SELECT MIN(clndr_dt)\n     INTO v_prior_fisc_mth_strt_dt\n     FROM de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001\n    WHERE fisc_yr_mth IN (SELECT MAX(de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.2603c45be643e5cd8f9c6dad3bee6cb3)\n                            FROM de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001 a\n                           WHERE de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.2603c45be643e5cd8f9c6dad3bee6cb3 < (SELECT de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.2603c45be643e5cd8f9c6dad3bee6cb3\n                                                    FROM de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001 a\n                                                   WHERE de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.222ccb1d1746bcdb2365f29b3da0b613 = v_odate));\n\n   SELECT MAX(fisc_mth_of_yr), MAX(fisc_yr), MAX(fisc_yr_mth)\n     INTO v_last_fisc_mth_of_yr, v_fisc_yr_last_mth, v_last_fisc_yr_mth\n     FROM de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001 a\n    WHERE fisc_yr_mth = (SELECT MAX(de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.2603c45be643e5cd8f9c6dad3bee6cb3) \n                           FROM de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001 a\n                          WHERE de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.2603c45be643e5cd8f9c6dad3bee6cb3 < (SELECT de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.2603c45be643e5cd8f9c6dad3bee6cb3\n                                                   FROM de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001 a\n                                                  WHERE de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.222ccb1d1746bcdb2365f29b3da0b613 = v_odate));\n\n\n\n\n\n   DBMS_OUTPUT.put_line('Processing year: ' || v_fisc_yr || ' period: ' || v_fisc_mth_of_yr || ' ' || SYSTIMESTAMP);\n\n   IF v_in_cust_nbr IS NULL THEN\n      \n      SELECT COUNT( * )\n        INTO v_cnt\n        FROM de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c\n       WHERE div_nbr = v_in_div_nbr\n         AND xfer_from_dt IS NOT NULL\n         AND ldr_tm > v_in_ldr_tm;\n\n      \n      \n      v_cust_vw   :=\n         q'[(SELECT de459e2fe7f96e4d958537b31b946b26.52982d3bbc1ebc2720d9504c7ea2ed3f.7f599f836c449bebb92bb9757e86c603, de459e2fe7f96e4d958537b31b946b26.52982d3bbc1ebc2720d9504c7ea2ed3f.852fa1e9f02f1ca2c75837f7146b2381, de459e2fe7f96e4d958537b31b946b26.52982d3bbc1ebc2720d9504c7ea2ed3f.839c4ffb4bfaae1bb58eab4dee67d96a, de459e2fe7f96e4d958537b31b946b26.52982d3bbc1ebc2720d9504c7ea2ed3f.55739765f192316a366e35ac5cc043c2561b89cb9074f747f5165d6920afabf2\n             FROM de459e2fe7f96e4d958537b31b946b26.52982d3bbc1ebc2720d9504c7ea2ed3f cc\n             WHERE EXISTS (SELECT 'X'\n                     FROM de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c\n                    WHERE div_nbr = ]'\n                  || v_in_div_nbr\n                  || q'[ AND xfer_from_dt IS NOT NULL\n                      AND ldr_tm > ]'\n                     || v_in_ldr_tm\n                     || q'[ AND cust_nbr = de459e2fe7f96e4d958537b31b946b26.52982d3bbc1ebc2720d9504c7ea2ed3f.852fa1e9f02f1ca2c75837f7146b2381\n                      AND div_nbr = de459e2fe7f96e4d958537b31b946b26.52982d3bbc1ebc2720d9504c7ea2ed3f.839c4ffb4bfaae1bb58eab4dee67d96a)) c]';\n\n   ELSE \n      \n      SELECT COUNT( * )\n        INTO v_cnt\n        FROM de459e2fe7f96e4d958537b31b946b26.52982d3bbc1ebc2720d9504c7ea2ed3f\n       WHERE div_nbr = v_in_div_nbr\n         AND cust_nbr = v_in_cust_nbr;\n\n      \n      \n      v_cust_vw   :=\n         '(SELECT  cust_nbr, div_nbr, cust_sk, first_rt_fisc_yr_mth FROM de459e2fe7f96e4d958537b31b946b26.52982d3bbc1ebc2720d9504c7ea2ed3f\n              WHERE   div_nbr = '\n         || v_in_div_nbr\n         || ' AND     cust_nbr = '''\n         || v_in_cust_nbr\n         || ''') c ';\n   END IF;\n\n   DBMS_OUTPUT.put_line('v_cnt ' || v_cnt);\n\n   IF v_cnt > 0 THEN\n      \n      DBMS_OUTPUT.put_line(\n         'Dropping table ' || v_src_schema || '.' || v_tbl_prfx || v_in_div_nbr || ' ' || SYSTIMESTAMP);\n\n      BEGIN\n         EXECUTE IMMEDIATE 'DROP TABLE ' || v_src_schema || '.' || v_tbl_prfx || v_in_div_nbr;\n\n         DBMS_OUTPUT.put_line(\n            'Table ' || v_src_schema || '.' || v_tbl_prfx || v_in_div_nbr || ' dropped ' || SYSTIMESTAMP);\n      EXCEPTION\n         WHEN OTHERS THEN\n            DBMS_OUTPUT.put_line(   'Table '\n                                 || v_src_schema\n                                 || '.'\n                                 || v_tbl_prfx\n                                 || v_in_div_nbr\n                                 || ' does not exist. Continue processing...');\n      END;\n\n      \n      v_ctas_stmt    :=\n         'CREATE TABLE ' || v_src_schema || '.' || v_tbl_prfx || v_in_div_nbr\n         || q'[ TABLESPACE SALES_TS NOLOGGING AS\n                   \n                   SELECT aab0feb533f73234f61772945fe4678b.852fa1e9f02f1ca2c75837f7146b2381,\n             aab0feb533f73234f61772945fe4678b.839c4ffb4bfaae1bb58eab4dee67d96a,\n             aab0feb533f73234f61772945fe4678b.ab30d6d679879cfacfe389b97d1d3f0e,\n             aab0feb533f73234f61772945fe4678b.e1d446673288adb6d5f219d0aa82d37a,\n\t\t\t aab0feb533f73234f61772945fe4678b.f2de255a7553ba934b1f05ae7699ae4c,\n             aab0feb533f73234f61772945fe4678b.cb5e253886eb30a93e66cbf95203a754,\n             CASE\n                WHEN no_cd_unfrm_sales_ty > 0\n                 AND no_cd_unfrm_sales_ly > 0 THEN\n                   'PENETRATION'\n                WHEN no_cd_unfrm_sales_ty > 0\n                 AND no_cd_unfrm_sales_ly <= 0 THEN\n                   'NEW'\n                WHEN no_cd_unfrm_sales_ty <= 0\n                 AND no_cd_unfrm_sales_ly > 0 THEN\n                   'LOST'\n                ELSE\n                   'OTHER'\n             END\n                AS cust_clsfctn,\n             de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.dfe42c57475d9fd89d96ed9e57b69306,\n             de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.74b6de95f34ea7c017ab8b68a54fe70b,\n             de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.72d6de60a9cbb2a2d78a2a36297e55f1f43d3e611ef8d78ea0e7840aa66f8834,\n             de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.2cbaab6f2111487297b7d37f7d42883a04f2c76b85d3b6c683ff67d7fcfe6fae,\n             SYSDATE AS crt_dt,\n\t\t\t SYSDATE AS upd_dt,\n             aab0feb533f73234f61772945fe4678b.630c48bbfe25ea68a239339f24d37c79,\n             aab0feb533f73234f61772945fe4678b.2ee1400a0150f0b220dd7bd6268d1e66,\n             aab0feb533f73234f61772945fe4678b.dc15696e1e997bad6131bf936574f406,\n             aab0feb533f73234f61772945fe4678b.afcae1f8310cd038c0633aeaa179c10c280a4c8731f60bb762471fb74030c9a2,\n\t\t\t aab0feb533f73234f61772945fe4678b.4f2731c61a8e37dc3b1cb4eb301ef71f96a8e7c926d4a6d230ee2652a5996563,\n\t\t\t aab0feb533f73234f61772945fe4678b.e511ce5564513d6f81e8798ab8caf3b23c6ba3def1a8b441a85fc7b3bcb1d0d6,\n\t\t\t aab0feb533f73234f61772945fe4678b.ccf8d88f2d37f3171da2121ab22e9330,\n             aab0feb533f73234f61772945fe4678b.37175a70b8190fbf717de5f6ebc49b0a,\n             CASE\n                WHEN aab0feb533f73234f61772945fe4678b.37175a70b8190fbf717de5f6ebc49b0a <> 0 THEN CASE WHEN drops <> 0 THEN aab0feb533f73234f61772945fe4678b.37175a70b8190fbf717de5f6ebc49b0a / aab0feb533f73234f61772945fe4678b.630c48bbfe25ea68a239339f24d37c79 ELSE 0 END\n                ELSE NULL\n             END\n                unfrm_grs_tgp_per_drop\n\n        FROM (  SELECT cust_nbr,\n                       div_nbr,\n                       fisc_yr,\n                       fisc_mth_of_yr,\n\t\t\t\t\t   fisc_yr_wk,\n\t\t\t\t\t   fisc_wk_of_yr,\n                       SUM(NVL(sales_ty, 0)) AS sales_ty,\n                       SUM(NVL(sales_ly, 0)) AS sales_ly,\n                       SUM(NVL(no_cd_unfrm_sales_ty, 0)) AS no_cd_unfrm_sales_ty,\n                       SUM(NVL(no_cd_unfrm_sales_ly, 0)) AS no_cd_unfrm_sales_ly,\n                       SUM(NVL(drops, 0)) drops,\n                       SUM(NVL(grs_sls_extnd, 0)) grs_sls_extnd,\n                       SUM(NVL(qty_ship, 0)) qty_ship,\n                       SUM(NVL(unfrm_grs_sls_extnd, 0)) unfrm_grs_sls_extnd,\n                       SUM(NVL(unfrm_dwa_cost_extnd, 0)) unfrm_dwa_cost_extnd,\n\t\t\t\t\t   SUM(NVL(unfrm_ttl_vndr_fnd_dvt, 0)) unfrm_ttl_vndr_fnd_dvt,\n                       SUM(NVL(unfrm_qty_ship, 0)) unfrm_qty_ship,\n                       SUM(NVL(unfrm_grs_tgp, 0)) unfrm_grs_tgp\n                       FROM (SELECT 6f037dd8c55b34c0a958bc6e5d1c45f6.852fa1e9f02f1ca2c75837f7146b2381,\n                               6f037dd8c55b34c0a958bc6e5d1c45f6.839c4ffb4bfaae1bb58eab4dee67d96a,\n                               6f037dd8c55b34c0a958bc6e5d1c45f6.ab30d6d679879cfacfe389b97d1d3f0e,\n                               6f037dd8c55b34c0a958bc6e5d1c45f6.e1d446673288adb6d5f219d0aa82d37a,\n\t\t\t\t\t\t\t   6f037dd8c55b34c0a958bc6e5d1c45f6.f2de255a7553ba934b1f05ae7699ae4c,\n\t\t\t\t\t\t\t   6f037dd8c55b34c0a958bc6e5d1c45f6.cb5e253886eb30a93e66cbf95203a754,\n                                CASE\n                                  WHEN 15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.ab30d6d679879cfacfe389b97d1d3f0e = ]'\n         || v_fisc_yr\n         || q'[ THEN NVL(15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.2ee1400a0150f0b220dd7bd6268d1e66,0)\n                                  ELSE 0\n                                END sales_ty,\n                                CASE\n                                  WHEN 15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.ab30d6d679879cfacfe389b97d1d3f0e = ]'\n         || v_fisc_yr\n         || q'[-1 THEN NVL(15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.2ee1400a0150f0b220dd7bd6268d1e66,0)\n                                  ELSE 0\n                                END sales_ly,\n                                CASE\n                                  WHEN 15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.ab30d6d679879cfacfe389b97d1d3f0e = ]'\n         || v_fisc_yr\n         || q'[ THEN NVL(15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.ab081c412fc18694a8297c8dfdea984cd9542f5039f4af6f9fa4a3007112f536,0)\n                                  ELSE 0\n                                END no_cd_unfrm_sales_ty,\n                                CASE\n                                  WHEN 15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.ab30d6d679879cfacfe389b97d1d3f0e = ]'\n         || v_fisc_yr\n         || q'[-1 THEN NVL(15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.ab081c412fc18694a8297c8dfdea984cd9542f5039f4af6f9fa4a3007112f536,0)\n                                  ELSE 0\n                                END no_cd_unfrm_sales_ly,\n                                case when 15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.ab30d6d679879cfacfe389b97d1d3f0e = ]'\n         || v_fisc_yr\n         || q'[ then 15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.630c48bbfe25ea68a239339f24d37c79 end drops,\n                                case when 15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.ab30d6d679879cfacfe389b97d1d3f0e = ]'\n         || v_fisc_yr\n         || q'[ then 15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.2ee1400a0150f0b220dd7bd6268d1e66 end grs_sls_extnd,\n                                case when 15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.ab30d6d679879cfacfe389b97d1d3f0e = ]'\n         || v_fisc_yr\n         || q'[ then 15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.dc15696e1e997bad6131bf936574f406 end qty_ship,\n                                case when 15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.ab30d6d679879cfacfe389b97d1d3f0e = ]'\n         || v_fisc_yr\n         || q'[ then 15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.afcae1f8310cd038c0633aeaa179c10c280a4c8731f60bb762471fb74030c9a2 end unfrm_grs_sls_extnd,\n\t\t                        case when 15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.ab30d6d679879cfacfe389b97d1d3f0e = ]'\n         || v_fisc_yr\n         || q'[ then 15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.4f2731c61a8e37dc3b1cb4eb301ef71f96a8e7c926d4a6d230ee2652a5996563 end unfrm_dwa_cost_extnd,\n                                case when 15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.ab30d6d679879cfacfe389b97d1d3f0e = ]'\n         || v_fisc_yr\n         || q'[ then 15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.e511ce5564513d6f81e8798ab8caf3b23c6ba3def1a8b441a85fc7b3bcb1d0d6 end unfrm_ttl_vndr_fnd_dvt,\n                                case when 15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.ab30d6d679879cfacfe389b97d1d3f0e = ]'\n         || v_fisc_yr\n         || q'[ then 15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.ccf8d88f2d37f3171da2121ab22e9330 end unfrm_qty_ship,\n                                case when 15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.ab30d6d679879cfacfe389b97d1d3f0e = ]'\n         || v_fisc_yr\n         || q'[ then 15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.37175a70b8190fbf717de5f6ebc49b0a end unfrm_grs_tgp\n\n                         FROM (SELECT aab0feb533f73234f61772945fe4678b.839c4ffb4bfaae1bb58eab4dee67d96a,\n                                      aab0feb533f73234f61772945fe4678b.852fa1e9f02f1ca2c75837f7146b2381,\n                                      de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.ab30d6d679879cfacfe389b97d1d3f0e,\n                                      de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.e1d446673288adb6d5f219d0aa82d37a,\n                                      de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.f2de255a7553ba934b1f05ae7699ae4c,\n\t\t\t\t\t\t\t\t\t  de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.cb5e253886eb30a93e66cbf95203a754,\n                                      aab0feb533f73234f61772945fe4678b.7f599f836c449bebb92bb9757e86c603\n\n                               FROM ]'\n         || v_cust_vw\n         || q'[,\n                                    (SELECT de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.ab30d6d679879cfacfe389b97d1d3f0e, de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.e1d446673288adb6d5f219d0aa82d37a, de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.f2de255a7553ba934b1f05ae7699ae4c,de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.cb5e253886eb30a93e66cbf95203a754\n                                     FROM de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001 t\n                                     WHERE de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.ab30d6d679879cfacfe389b97d1d3f0e = ]'\n         || v_fisc_yr\n         || q'[ AND de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.cb5e253886eb30a93e66cbf95203a754 <= ']'\n         || v_fisc_wk_of_yr\n         || q'[' GROUP BY de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.ab30d6d679879cfacfe389b97d1d3f0e, de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.e1d446673288adb6d5f219d0aa82d37a, de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.f2de255a7553ba934b1f05ae7699ae4c,de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.cb5e253886eb30a93e66cbf95203a754) t) cust_list,\n                               (SELECT de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.839c4ffb4bfaae1bb58eab4dee67d96a,\n                                      de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.852fa1e9f02f1ca2c75837f7146b2381,\n                                      de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.ab30d6d679879cfacfe389b97d1d3f0e,\n                                      de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.e1d446673288adb6d5f219d0aa82d37a,\n\t\t\t\t\t\t\t\t\t  de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.f2de255a7553ba934b1f05ae7699ae4c,\n\t\t\t\t\t\t\t\t\t  de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.cb5e253886eb30a93e66cbf95203a754,\n                                      count(distinct case when de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.26ac88e7ae671a1b22c14c2fce77aa2d = 'RT' AND pim_suprcls_id_actl <> 97 AND pim_suprcls_id_actl IS NOT NULL then de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.4fdc122fb2d10dd764e32cbc98972eca||de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.9f055ebf334db6c50bbcab4ff14bd2ae||INV_DT||nvl(DLVR_RTE,'')||PRCS_DT else NULL end) DROPS,\n                                     SUM (grs_sls_extnd) AS GRS_SLS_EXTND,\n                                     SUM(CASE\n                                                WHEN de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.26ac88e7ae671a1b22c14c2fce77aa2d IN ('RT', 'VS', 'WC')\n                                                 AND de459e2fe7f96e4d958537b31b946b26.2c04d82ed0aa1cc9bce2cf2c0548b268.89f3df82917b692fe64dca942d924e7c <> 97\n                                                 AND de459e2fe7f96e4d958537b31b946b26.2c04d82ed0aa1cc9bce2cf2c0548b268.89f3df82917b692fe64dca942d924e7c is not null THEN\n                                                   de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.2ee1400a0150f0b220dd7bd6268d1e66\n                                                ELSE\n                                                   NULL\n                                             END)\n                                            no_cd_unfrm_grs_sls_extnd,\n                                     SUM(QTY_SHIP) as QTY_SHIP,\n                                     SUM(UNFRM_QTY_SHIP)UNFRM_QTY_SHIP,\n                                     sum(case when de459e2fe7f96e4d958537b31b946b26.2c04d82ed0aa1cc9bce2cf2c0548b268.89f3df82917b692fe64dca942d924e7c <> 97\n                                          and de459e2fe7f96e4d958537b31b946b26.2c04d82ed0aa1cc9bce2cf2c0548b268.89f3df82917b692fe64dca942d924e7c is not null\n                                         then grs_sls_extnd\n                                         else 0\n                                         END) UNFRM_GRS_SLS_EXTND,\n\t\t\t\t\t\t\t\t\tsum(case when de459e2fe7f96e4d958537b31b946b26.2c04d82ed0aa1cc9bce2cf2c0548b268.89f3df82917b692fe64dca942d924e7c <> 97\n                                          and de459e2fe7f96e4d958537b31b946b26.2c04d82ed0aa1cc9bce2cf2c0548b268.89f3df82917b692fe64dca942d924e7c is not null\n                                         then ttl_vndr_fnd_dvt\n                                         else 0\n                                         END) unfrm_ttl_vndr_fnd_dvt,\n                                     sum(case when de459e2fe7f96e4d958537b31b946b26.2c04d82ed0aa1cc9bce2cf2c0548b268.89f3df82917b692fe64dca942d924e7c <> 97\n                                          and de459e2fe7f96e4d958537b31b946b26.2c04d82ed0aa1cc9bce2cf2c0548b268.89f3df82917b692fe64dca942d924e7c is not null\n                                         then dwa_cost_extnd\n                                         else 0\n                                         END) unfrm_dwa_cost_extnd,\n                                     SUM(CASE\n                                                WHEN de459e2fe7f96e4d958537b31b946b26.2c04d82ed0aa1cc9bce2cf2c0548b268.89f3df82917b692fe64dca942d924e7c <> 97\n                                                 AND de459e2fe7f96e4d958537b31b946b26.2c04d82ed0aa1cc9bce2cf2c0548b268.89f3df82917b692fe64dca942d924e7c IS NOT NULL THEN\n                                                   NVL(de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.2ee1400a0150f0b220dd7bd6268d1e66 - de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.c6c7cc45578c678907522e08bb04a4ca + de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.b7982b81d447f11a0953881190e528cae32f6dd38f333cde68119d1f277367cd\n                                                        - CASE\n                                                            WHEN de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.487c194c34aee6c67551aa2cdd2358ace32f6dd38f333cde68119d1f277367cd = 'P' THEN NVL(de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.d206d123f59f85e26ec113e33b465295,0)\n                                                            ELSE 0\n                                                          END, 0)\n                                                ELSE\n                                                   0\n                                             END)\n                                            unfrm_grs_tgp\n\n                               FROM de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001 t,\n                                    de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c s,\n                                    de459e2fe7f96e4d958537b31b946b26.2c04d82ed0aa1cc9bce2cf2c0548b268 pim,\n                                    de459e2fe7f96e4d958537b31b946b26.dec387908a0954ddc8689c4ad37c8a3c d, ]'\n         || v_cust_vw\n         || q'[ WHERE     de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.ab30d6d679879cfacfe389b97d1d3f0e in (]'\n         || v_fisc_yr\n         || ','\n         || v_fisc_yr\n         || q'[-1)\n                                     AND de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.cb5e253886eb30a93e66cbf95203a754 <= ']'\n         || v_fisc_wk_of_yr\n         || q'[' AND de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.cb5e253886eb30a93e66cbf95203a754 <> CASE\n                                                               WHEN de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.ab30d6d679879cfacfe389b97d1d3f0e = (]'\n         || v_fisc_yr\n         || q'[-1) AND ']'\n         || v_fisc_mth_of_yr\n         || q'[' = '12' AND ]'\n         || v_py_max_wk\n         || q'[= 53 THEN 53    \n                                                               ELSE 99    \n                                                            END\n                                     AND de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.222ccb1d1746bcdb2365f29b3da0b613 <= ']'\n         || v_end_dt\n         ||\n           q'[' AND de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.f5dd4374a3e3af6a775cb6d6b22e8162 = de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.222ccb1d1746bcdb2365f29b3da0b613\n                                     AND de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.467a168a7499c57b1859198a7dac7be0 IS NULL\n                                     AND de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.839c4ffb4bfaae1bb58eab4dee67d96a = aab0feb533f73234f61772945fe4678b.839c4ffb4bfaae1bb58eab4dee67d96a\n                                     AND de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.852fa1e9f02f1ca2c75837f7146b2381 = aab0feb533f73234f61772945fe4678b.852fa1e9f02f1ca2c75837f7146b2381\n                                     AND de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.d3268eabc4a7d98105fd85f9c9e62cd6e32ad436514bbe822b33de8bead744f3 = de459e2fe7f96e4d958537b31b946b26.2c04d82ed0aa1cc9bce2cf2c0548b268.d3268eabc4a7d98105fd85f9c9e62cd6e32ad436514bbe822b33de8bead744f3\n                                     AND NVL(de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.a2b201123c685e8cc48b5468cb4a449361bbd7bc0d2d67c7d7b11cb0a8d18d03, de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.839c4ffb4bfaae1bb58eab4dee67d96a) = de459e2fe7f96e4d958537b31b946b26.dec387908a0954ddc8689c4ad37c8a3c.839c4ffb4bfaae1bb58eab4dee67d96a\n                                     AND de459e2fe7f96e4d958537b31b946b26.dec387908a0954ddc8689c4ad37c8a3c.b8c6ab19cb6e726c38f24d1885346ea3 <> 'CC'\n\t\t\t\t\t\t\t\t     AND  (case when NVL (de459e2fe7f96e4d958537b31b946b26.dec387908a0954ddc8689c4ad37c8a3c.c712a9ab5ef100c5807fa96123dac48b,'USF') <> 'USF'\n\t\t\t\t\t\t\t\t     and NVL(de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.a2b201123c685e8cc48b5468cb4a449361bbd7bc0d2d67c7d7b11cb0a8d18d03, de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.839c4ffb4bfaae1bb58eab4dee67d96a) = de459e2fe7f96e4d958537b31b946b26.dec387908a0954ddc8689c4ad37c8a3c.839c4ffb4bfaae1bb58eab4dee67d96a\n\t\t\t\t\t\t\t\t\t and de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.f5dd4374a3e3af6a775cb6d6b22e8162 < NVL(de459e2fe7f96e4d958537b31b946b26.dec387908a0954ddc8689c4ad37c8a3c.3db9275d5f5cb2e9d918e77dbabdd97b,de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.f5dd4374a3e3af6a775cb6d6b22e8162)\n\t\t\t\t\t\t\t\t\t then 'NON_USFGL' else 'USFGL' END) ='USFGL'\n                         GROUP BY de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.839c4ffb4bfaae1bb58eab4dee67d96a, de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.852fa1e9f02f1ca2c75837f7146b2381, de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.ab30d6d679879cfacfe389b97d1d3f0e, de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.e1d446673288adb6d5f219d0aa82d37a,de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.f2de255a7553ba934b1f05ae7699ae4c,de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.cb5e253886eb30a93e66cbf95203a754) cust_sales_ty_ly \n                         WHERE     6f037dd8c55b34c0a958bc6e5d1c45f6.852fa1e9f02f1ca2c75837f7146b2381 = 15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.852fa1e9f02f1ca2c75837f7146b2381(+)\n                               AND 6f037dd8c55b34c0a958bc6e5d1c45f6.839c4ffb4bfaae1bb58eab4dee67d96a = 15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.839c4ffb4bfaae1bb58eab4dee67d96a(+)\n                               AND 6f037dd8c55b34c0a958bc6e5d1c45f6.cb5e253886eb30a93e66cbf95203a754 = 15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.cb5e253886eb30a93e66cbf95203a754(+))\n\n                         GROUP by\n                                cust_nbr,\n                                div_nbr,\n                                fisc_yr,\n                                fisc_mth_of_yr,\n                                fisc_yr_wk,\n                                fisc_wk_of_yr\n                               ) c,\n                         (select fisc_yr, fisc_mth_of_yr, fisc_yr_wk,fisc_wk_of_yr,\n                                 min(clndr_dt) fisc_wk_strt_dt,\n                                 max(clndr_dt) fisc_wk_end_dt,\n                                 min(clndr_dt_yrago) fisc_wk_strt_dt_yrago,\n                                 max(clndr_dt_yrago) fisc_wk_end_dt_yrago\n                                 from de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001\n                                 group by fisc_yr, fisc_mth_of_yr, fisc_yr_wk,fisc_wk_of_yr) t\n                         where de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.ab30d6d679879cfacfe389b97d1d3f0e = aab0feb533f73234f61772945fe4678b.ab30d6d679879cfacfe389b97d1d3f0e\n                           and de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.cb5e253886eb30a93e66cbf95203a754 = aab0feb533f73234f61772945fe4678b.cb5e253886eb30a93e66cbf95203a754\n                   UNION ALL\n                   \n                   SELECT aab0feb533f73234f61772945fe4678b.852fa1e9f02f1ca2c75837f7146b2381,\n             aab0feb533f73234f61772945fe4678b.839c4ffb4bfaae1bb58eab4dee67d96a,\n             aab0feb533f73234f61772945fe4678b.ab30d6d679879cfacfe389b97d1d3f0e,\n             aab0feb533f73234f61772945fe4678b.e1d446673288adb6d5f219d0aa82d37a,\n\t\t\t aab0feb533f73234f61772945fe4678b.f2de255a7553ba934b1f05ae7699ae4c,\n             aab0feb533f73234f61772945fe4678b.cb5e253886eb30a93e66cbf95203a754,\n             CASE\n                WHEN no_cd_unfrm_sales_ty > 0\n                 AND no_cd_unfrm_sales_ly > 0 THEN\n                   'PENETRATION'\n                WHEN no_cd_unfrm_sales_ty > 0\n                 AND no_cd_unfrm_sales_ly <= 0 THEN\n                   'NEW'\n                WHEN no_cd_unfrm_sales_ty <= 0\n                 AND no_cd_unfrm_sales_ly > 0 THEN\n                   'LOST'\n                ELSE\n                   'OTHER'\n             END\n                AS cust_clsfctn,\n             de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.dfe42c57475d9fd89d96ed9e57b69306,\n             de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.74b6de95f34ea7c017ab8b68a54fe70b,\n             de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.72d6de60a9cbb2a2d78a2a36297e55f1f43d3e611ef8d78ea0e7840aa66f8834,\n             de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.2cbaab6f2111487297b7d37f7d42883a04f2c76b85d3b6c683ff67d7fcfe6fae,\n             SYSDATE AS crt_dt,\n\t\t\t SYSDATE AS upd_dt,\n             aab0feb533f73234f61772945fe4678b.630c48bbfe25ea68a239339f24d37c79,\n             aab0feb533f73234f61772945fe4678b.2ee1400a0150f0b220dd7bd6268d1e66,\n             aab0feb533f73234f61772945fe4678b.dc15696e1e997bad6131bf936574f406,\n             aab0feb533f73234f61772945fe4678b.afcae1f8310cd038c0633aeaa179c10c280a4c8731f60bb762471fb74030c9a2,\n\t\t\t aab0feb533f73234f61772945fe4678b.4f2731c61a8e37dc3b1cb4eb301ef71f96a8e7c926d4a6d230ee2652a5996563,\n\t\t\t aab0feb533f73234f61772945fe4678b.e511ce5564513d6f81e8798ab8caf3b23c6ba3def1a8b441a85fc7b3bcb1d0d6,\n\t\t\t aab0feb533f73234f61772945fe4678b.ccf8d88f2d37f3171da2121ab22e9330,\n             aab0feb533f73234f61772945fe4678b.37175a70b8190fbf717de5f6ebc49b0a,\n             CASE\n                WHEN aab0feb533f73234f61772945fe4678b.37175a70b8190fbf717de5f6ebc49b0a <> 0 THEN CASE WHEN drops <> 0 THEN aab0feb533f73234f61772945fe4678b.37175a70b8190fbf717de5f6ebc49b0a / aab0feb533f73234f61772945fe4678b.630c48bbfe25ea68a239339f24d37c79 ELSE 0 END\n                ELSE NULL\n             END\n                unfrm_grs_tgp_per_drop\n\n        FROM (  SELECT cust_nbr,\n                       div_nbr,\n                       fisc_yr,\n                       fisc_mth_of_yr,\n\t\t\t\t\t   fisc_yr_wk,\n\t\t\t\t\t   fisc_wk_of_yr,\n                       SUM(NVL(sales_ty, 0)) AS sales_ty,\n                       SUM(NVL(sales_ly, 0)) AS sales_ly,\n                       SUM(NVL(no_cd_unfrm_sales_ty, 0)) AS no_cd_unfrm_sales_ty,\n                       SUM(NVL(no_cd_unfrm_sales_ly, 0)) AS no_cd_unfrm_sales_ly,\n                       SUM(NVL(drops, 0)) drops,\n                       SUM(NVL(grs_sls_extnd, 0)) grs_sls_extnd,\n                       SUM(NVL(qty_ship, 0)) qty_ship,\n                       SUM(NVL(unfrm_grs_sls_extnd, 0)) unfrm_grs_sls_extnd,\n                       SUM(NVL(unfrm_dwa_cost_extnd, 0)) unfrm_dwa_cost_extnd,\n\t\t\t\t\t   SUM(NVL(unfrm_ttl_vndr_fnd_dvt, 0)) unfrm_ttl_vndr_fnd_dvt,\n                       SUM(NVL(unfrm_qty_ship, 0)) unfrm_qty_ship,\n                       SUM(NVL(unfrm_grs_tgp, 0)) unfrm_grs_tgp\n                       FROM (SELECT 6f037dd8c55b34c0a958bc6e5d1c45f6.852fa1e9f02f1ca2c75837f7146b2381,\n                               6f037dd8c55b34c0a958bc6e5d1c45f6.839c4ffb4bfaae1bb58eab4dee67d96a,\n                               6f037dd8c55b34c0a958bc6e5d1c45f6.ab30d6d679879cfacfe389b97d1d3f0e,\n                               6f037dd8c55b34c0a958bc6e5d1c45f6.e1d446673288adb6d5f219d0aa82d37a,\n\t\t\t\t\t\t\t   6f037dd8c55b34c0a958bc6e5d1c45f6.f2de255a7553ba934b1f05ae7699ae4c,\n\t\t\t\t\t\t\t   6f037dd8c55b34c0a958bc6e5d1c45f6.cb5e253886eb30a93e66cbf95203a754,\n                                CASE\n                                  WHEN 15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.ab30d6d679879cfacfe389b97d1d3f0e = ]'\n         || v_fisc_yr\n         || q'[-1 THEN NVL(15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.2ee1400a0150f0b220dd7bd6268d1e66,0)\n                                  ELSE 0\n                                END sales_ty,\n                                CASE\n                                  WHEN 15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.ab30d6d679879cfacfe389b97d1d3f0e = ]'\n         || v_fisc_yr\n         || q'[-2 THEN NVL(15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.2ee1400a0150f0b220dd7bd6268d1e66,0)\n                                  ELSE 0\n                                END sales_ly,\n                                CASE\n                                  WHEN 15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.ab30d6d679879cfacfe389b97d1d3f0e = ]'\n         || v_fisc_yr\n         || q'[-1 THEN NVL(15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.ab081c412fc18694a8297c8dfdea984cd9542f5039f4af6f9fa4a3007112f536,0)\n                                  ELSE 0\n                                END no_cd_unfrm_sales_ty,\n                                CASE\n                                  WHEN 15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.ab30d6d679879cfacfe389b97d1d3f0e = ]'\n         || v_fisc_yr\n         || q'[-2 THEN NVL(15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.ab081c412fc18694a8297c8dfdea984cd9542f5039f4af6f9fa4a3007112f536,0)\n                                  ELSE 0\n                                END no_cd_unfrm_sales_ly,\n                                case when 15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.ab30d6d679879cfacfe389b97d1d3f0e = ]'\n         || v_fisc_yr\n         || q'[-1 then 15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.630c48bbfe25ea68a239339f24d37c79 end drops,\n                                case when 15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.ab30d6d679879cfacfe389b97d1d3f0e = ]'\n         || v_fisc_yr\n         || q'[-1 then 15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.2ee1400a0150f0b220dd7bd6268d1e66 end grs_sls_extnd,\n                                case when 15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.ab30d6d679879cfacfe389b97d1d3f0e = ]'\n         || v_fisc_yr\n         || q'[-1 then 15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.dc15696e1e997bad6131bf936574f406 end qty_ship,\n                                case when 15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.ab30d6d679879cfacfe389b97d1d3f0e = ]'\n         || v_fisc_yr\n         || q'[-1 then 15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.afcae1f8310cd038c0633aeaa179c10c280a4c8731f60bb762471fb74030c9a2 end unfrm_grs_sls_extnd,\n\t\t                        case when 15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.ab30d6d679879cfacfe389b97d1d3f0e = ]'\n         || v_fisc_yr\n         || q'[-1 then 15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.4f2731c61a8e37dc3b1cb4eb301ef71f96a8e7c926d4a6d230ee2652a5996563 end unfrm_dwa_cost_extnd,\n                                case when 15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.ab30d6d679879cfacfe389b97d1d3f0e = ]'\n         || v_fisc_yr\n         || q'[-1 then 15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.e511ce5564513d6f81e8798ab8caf3b23c6ba3def1a8b441a85fc7b3bcb1d0d6 end unfrm_ttl_vndr_fnd_dvt,\n                                case when 15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.ab30d6d679879cfacfe389b97d1d3f0e = ]'\n         || v_fisc_yr\n         || q'[-1 then 15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.ccf8d88f2d37f3171da2121ab22e9330 end unfrm_qty_ship,\n                                case when 15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.ab30d6d679879cfacfe389b97d1d3f0e = ]'\n         || v_fisc_yr\n         || q'[-1 then 15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.37175a70b8190fbf717de5f6ebc49b0a end unfrm_grs_tgp\n\n                         FROM (SELECT aab0feb533f73234f61772945fe4678b.839c4ffb4bfaae1bb58eab4dee67d96a,\n                                      aab0feb533f73234f61772945fe4678b.852fa1e9f02f1ca2c75837f7146b2381,\n                                      de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.ab30d6d679879cfacfe389b97d1d3f0e,\n                                      de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.e1d446673288adb6d5f219d0aa82d37a,\n                                      de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.f2de255a7553ba934b1f05ae7699ae4c,\n\t\t\t\t\t\t\t\t\t  de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.cb5e253886eb30a93e66cbf95203a754,\n                                      aab0feb533f73234f61772945fe4678b.7f599f836c449bebb92bb9757e86c603\n\n                               FROM ]'\n         || v_cust_vw\n         || q'[,\n                                    (SELECT de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.ab30d6d679879cfacfe389b97d1d3f0e, de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.e1d446673288adb6d5f219d0aa82d37a, de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.f2de255a7553ba934b1f05ae7699ae4c,de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.cb5e253886eb30a93e66cbf95203a754\n                                     FROM de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001 t\n                                     WHERE de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.ab30d6d679879cfacfe389b97d1d3f0e = ]'\n         || v_fisc_yr\n         || q'[-1 AND de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.cb5e253886eb30a93e66cbf95203a754 <= ']'\n         || v_fisc_wk_of_yr\n         || q'[' GROUP BY de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.ab30d6d679879cfacfe389b97d1d3f0e, de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.e1d446673288adb6d5f219d0aa82d37a, de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.f2de255a7553ba934b1f05ae7699ae4c,de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.cb5e253886eb30a93e66cbf95203a754) t) cust_list,\n                               (SELECT de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.839c4ffb4bfaae1bb58eab4dee67d96a,\n                                      de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.852fa1e9f02f1ca2c75837f7146b2381,\n                                      de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.ab30d6d679879cfacfe389b97d1d3f0e,\n                                      de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.e1d446673288adb6d5f219d0aa82d37a,\n\t\t\t\t\t\t\t\t\t  de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.f2de255a7553ba934b1f05ae7699ae4c,\n\t\t\t\t\t\t\t\t\t  de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.cb5e253886eb30a93e66cbf95203a754,\n                                      count(distinct case when de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.26ac88e7ae671a1b22c14c2fce77aa2d = 'RT' AND pim_suprcls_id_actl <> 97 AND pim_suprcls_id_actl IS NOT NULL then de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.4fdc122fb2d10dd764e32cbc98972eca||de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.9f055ebf334db6c50bbcab4ff14bd2ae||INV_DT||nvl(DLVR_RTE,'')||PRCS_DT else NULL end) DROPS,\n                                     SUM (grs_sls_extnd) AS GRS_SLS_EXTND,\n                                     SUM(CASE\n                                                WHEN de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.26ac88e7ae671a1b22c14c2fce77aa2d IN ('RT', 'VS', 'WC')\n                                                 AND de459e2fe7f96e4d958537b31b946b26.2c04d82ed0aa1cc9bce2cf2c0548b268.89f3df82917b692fe64dca942d924e7c <> 97\n                                                 AND de459e2fe7f96e4d958537b31b946b26.2c04d82ed0aa1cc9bce2cf2c0548b268.89f3df82917b692fe64dca942d924e7c is not null THEN\n                                                   de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.2ee1400a0150f0b220dd7bd6268d1e66\n                                                ELSE\n                                                   NULL\n                                             END)\n                                            no_cd_unfrm_grs_sls_extnd,\n                                     SUM(QTY_SHIP) as QTY_SHIP,\n                                     SUM(UNFRM_QTY_SHIP)UNFRM_QTY_SHIP,\n                                     sum(case when de459e2fe7f96e4d958537b31b946b26.2c04d82ed0aa1cc9bce2cf2c0548b268.89f3df82917b692fe64dca942d924e7c <> 97\n                                          and de459e2fe7f96e4d958537b31b946b26.2c04d82ed0aa1cc9bce2cf2c0548b268.89f3df82917b692fe64dca942d924e7c is not null\n                                         then grs_sls_extnd\n                                         else 0\n                                         END) UNFRM_GRS_SLS_EXTND,\n\t\t\t\t\t\t\t\t\tsum(case when de459e2fe7f96e4d958537b31b946b26.2c04d82ed0aa1cc9bce2cf2c0548b268.89f3df82917b692fe64dca942d924e7c <> 97\n                                          and de459e2fe7f96e4d958537b31b946b26.2c04d82ed0aa1cc9bce2cf2c0548b268.89f3df82917b692fe64dca942d924e7c is not null\n                                         then ttl_vndr_fnd_dvt\n                                         else 0\n                                         END) unfrm_ttl_vndr_fnd_dvt,\n                                     sum(case when de459e2fe7f96e4d958537b31b946b26.2c04d82ed0aa1cc9bce2cf2c0548b268.89f3df82917b692fe64dca942d924e7c <> 97\n                                          and de459e2fe7f96e4d958537b31b946b26.2c04d82ed0aa1cc9bce2cf2c0548b268.89f3df82917b692fe64dca942d924e7c is not null\n                                         then dwa_cost_extnd\n                                         else 0\n                                         END) unfrm_dwa_cost_extnd,\n                                     SUM(CASE\n                                                WHEN de459e2fe7f96e4d958537b31b946b26.2c04d82ed0aa1cc9bce2cf2c0548b268.89f3df82917b692fe64dca942d924e7c <> 97\n                                                 AND de459e2fe7f96e4d958537b31b946b26.2c04d82ed0aa1cc9bce2cf2c0548b268.89f3df82917b692fe64dca942d924e7c IS NOT NULL THEN\n                                                   NVL(de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.2ee1400a0150f0b220dd7bd6268d1e66 - de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.c6c7cc45578c678907522e08bb04a4ca + de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.b7982b81d447f11a0953881190e528cae32f6dd38f333cde68119d1f277367cd\n                                                       - CASE\n                                                            WHEN de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.487c194c34aee6c67551aa2cdd2358ace32f6dd38f333cde68119d1f277367cd = 'P' THEN NVL(de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.d206d123f59f85e26ec113e33b465295,0)\n                                                            ELSE 0\n                                                          END, 0)\n                                                ELSE\n                                                   0\n                                             END)\n                                            unfrm_grs_tgp\n\n                               FROM de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001 t,\n                                    de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c s,\n                                    de459e2fe7f96e4d958537b31b946b26.2c04d82ed0aa1cc9bce2cf2c0548b268 pim,\n                                    de459e2fe7f96e4d958537b31b946b26.dec387908a0954ddc8689c4ad37c8a3c d, ]'\n         || v_cust_vw\n         || q'[ WHERE     de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.ab30d6d679879cfacfe389b97d1d3f0e in (]'\n         || v_fisc_yr\n         || '-1,'\n         || v_fisc_yr\n         || q'[-2)\n                                     AND de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.cb5e253886eb30a93e66cbf95203a754 <= ']'\n         || v_fisc_wk_of_yr\n         || q'[' AND de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.cb5e253886eb30a93e66cbf95203a754 <> CASE\n                                                               WHEN de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.ab30d6d679879cfacfe389b97d1d3f0e = (]'\n         || v_fisc_yr\n         || q'[-2) AND ']'\n         || v_fisc_mth_of_yr\n         || q'[' = '12' AND ]'\n         || v_py_max_wk\n         || q'[= 53 THEN 53    \n                                                               ELSE 99    \n                                                            END\n                                     AND de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.222ccb1d1746bcdb2365f29b3da0b613 <= ']'\n         || v_end_dt\n         ||\n           q'[' AND de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.f5dd4374a3e3af6a775cb6d6b22e8162 = de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.222ccb1d1746bcdb2365f29b3da0b613\n                                     AND de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.467a168a7499c57b1859198a7dac7be0 IS NULL\n                                     AND de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.839c4ffb4bfaae1bb58eab4dee67d96a = aab0feb533f73234f61772945fe4678b.839c4ffb4bfaae1bb58eab4dee67d96a\n                                     AND de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.852fa1e9f02f1ca2c75837f7146b2381 = aab0feb533f73234f61772945fe4678b.852fa1e9f02f1ca2c75837f7146b2381\n                                     AND de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.d3268eabc4a7d98105fd85f9c9e62cd6e32ad436514bbe822b33de8bead744f3 = de459e2fe7f96e4d958537b31b946b26.2c04d82ed0aa1cc9bce2cf2c0548b268.d3268eabc4a7d98105fd85f9c9e62cd6e32ad436514bbe822b33de8bead744f3\n                                     AND NVL(de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.a2b201123c685e8cc48b5468cb4a449361bbd7bc0d2d67c7d7b11cb0a8d18d03, de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.839c4ffb4bfaae1bb58eab4dee67d96a) = de459e2fe7f96e4d958537b31b946b26.dec387908a0954ddc8689c4ad37c8a3c.839c4ffb4bfaae1bb58eab4dee67d96a\n                                     AND de459e2fe7f96e4d958537b31b946b26.dec387908a0954ddc8689c4ad37c8a3c.b8c6ab19cb6e726c38f24d1885346ea3 <> 'CC'\n\t\t\t\t\t\t\t\t     AND  (case when NVL (de459e2fe7f96e4d958537b31b946b26.dec387908a0954ddc8689c4ad37c8a3c.c712a9ab5ef100c5807fa96123dac48b,'USF') <> 'USF'\n\t\t\t\t\t\t\t\t     and NVL(de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.a2b201123c685e8cc48b5468cb4a449361bbd7bc0d2d67c7d7b11cb0a8d18d03, de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.839c4ffb4bfaae1bb58eab4dee67d96a) = de459e2fe7f96e4d958537b31b946b26.dec387908a0954ddc8689c4ad37c8a3c.839c4ffb4bfaae1bb58eab4dee67d96a\n\t\t\t\t\t\t\t\t\t and de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.f5dd4374a3e3af6a775cb6d6b22e8162 < NVL(de459e2fe7f96e4d958537b31b946b26.dec387908a0954ddc8689c4ad37c8a3c.3db9275d5f5cb2e9d918e77dbabdd97b,de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.f5dd4374a3e3af6a775cb6d6b22e8162)\n\t\t\t\t\t\t\t\t\t then 'NON_USFGL' else 'USFGL' END) ='USFGL'\n                         GROUP BY de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.839c4ffb4bfaae1bb58eab4dee67d96a, de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.852fa1e9f02f1ca2c75837f7146b2381, de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.ab30d6d679879cfacfe389b97d1d3f0e, de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.e1d446673288adb6d5f219d0aa82d37a,de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.f2de255a7553ba934b1f05ae7699ae4c,de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.cb5e253886eb30a93e66cbf95203a754) cust_sales_ty_ly \n                         WHERE     6f037dd8c55b34c0a958bc6e5d1c45f6.852fa1e9f02f1ca2c75837f7146b2381 = 15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.852fa1e9f02f1ca2c75837f7146b2381(+)\n                               AND 6f037dd8c55b34c0a958bc6e5d1c45f6.839c4ffb4bfaae1bb58eab4dee67d96a = 15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.839c4ffb4bfaae1bb58eab4dee67d96a(+)\n                               AND 6f037dd8c55b34c0a958bc6e5d1c45f6.cb5e253886eb30a93e66cbf95203a754 = 15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.cb5e253886eb30a93e66cbf95203a754(+))\n\n                         GROUP by\n                                cust_nbr,\n                                div_nbr,\n                                fisc_yr,\n                                fisc_mth_of_yr,\n                                fisc_yr_wk,\n                                fisc_wk_of_yr\n                               ) c,\n                         (select fisc_yr, fisc_mth_of_yr, fisc_yr_wk,fisc_wk_of_yr,\n                                 min(clndr_dt) fisc_wk_strt_dt,\n                                 max(clndr_dt) fisc_wk_end_dt,\n                                 min(clndr_dt_yrago) fisc_wk_strt_dt_yrago,\n                                 max(clndr_dt_yrago) fisc_wk_end_dt_yrago\n                                 from de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001\n                                 group by fisc_yr, fisc_mth_of_yr, fisc_yr_wk,fisc_wk_of_yr) t\n                         where de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.ab30d6d679879cfacfe389b97d1d3f0e = aab0feb533f73234f61772945fe4678b.ab30d6d679879cfacfe389b97d1d3f0e\n                           and de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.cb5e253886eb30a93e66cbf95203a754 = aab0feb533f73234f61772945fe4678b.cb5e253886eb30a93e66cbf95203a754]';\n\n      DBMS_OUTPUT.put_line(v_ctas_stmt);\n\n      EXECUTE IMMEDIATE v_ctas_stmt;\n\n      COMMIT;\n\n      DBMS_OUTPUT.put_line(\n         'Table ' || v_src_schema || '.' || v_tbl_prfx || v_in_div_nbr || ' created ' || SYSTIMESTAMP);\n\n      DBMS_OUTPUT.put_line('Start Transfered Insert');\n\n      \n      l_trans_insert   :=\n         'INSERT INTO ' || v_src_schema || '.' || v_tbl_prfx || v_in_div_nbr\n         || q'[\n           (      SELECT d2450100e2dda59c2b7828b4daff7f8c.852fa1e9f02f1ca2c75837f7146b2381,\n             d2450100e2dda59c2b7828b4daff7f8c.839c4ffb4bfaae1bb58eab4dee67d96a,\n             d2450100e2dda59c2b7828b4daff7f8c.ab30d6d679879cfacfe389b97d1d3f0e,\n             d2450100e2dda59c2b7828b4daff7f8c.e1d446673288adb6d5f219d0aa82d37a,\n\t\t\t d2450100e2dda59c2b7828b4daff7f8c.f2de255a7553ba934b1f05ae7699ae4c,\n             d2450100e2dda59c2b7828b4daff7f8c.cb5e253886eb30a93e66cbf95203a754,\n             CASE\n                WHEN no_cd_unfrm_sales_ty > 0\n                 AND no_cd_unfrm_sales_ly > 0 THEN\n                   'PENETRATION'\n                WHEN no_cd_unfrm_sales_ty > 0\n                 AND no_cd_unfrm_sales_ly <= 0 THEN\n                   'NEW'\n                WHEN no_cd_unfrm_sales_ty <= 0\n                 AND no_cd_unfrm_sales_ly > 0 THEN\n                   'LOST'\n                ELSE\n                   'OTHER'\n             END\n                AS cust_clsfctn,\n             1d731bbdc4e3fb69a854112d4982eb99.dfe42c57475d9fd89d96ed9e57b69306,\n             1d731bbdc4e3fb69a854112d4982eb99.74b6de95f34ea7c017ab8b68a54fe70b,\n             1d731bbdc4e3fb69a854112d4982eb99.72d6de60a9cbb2a2d78a2a36297e55f1f43d3e611ef8d78ea0e7840aa66f8834,\n             1d731bbdc4e3fb69a854112d4982eb99.2cbaab6f2111487297b7d37f7d42883a04f2c76b85d3b6c683ff67d7fcfe6fae,\n             SYSDATE AS crt_dt,\n\t\t\t SYSDATE AS upd_dt,\n             d2450100e2dda59c2b7828b4daff7f8c.630c48bbfe25ea68a239339f24d37c79,\n             d2450100e2dda59c2b7828b4daff7f8c.2ee1400a0150f0b220dd7bd6268d1e66,\n             d2450100e2dda59c2b7828b4daff7f8c.dc15696e1e997bad6131bf936574f406,\n             d2450100e2dda59c2b7828b4daff7f8c.afcae1f8310cd038c0633aeaa179c10c280a4c8731f60bb762471fb74030c9a2,\n\t\t\t d2450100e2dda59c2b7828b4daff7f8c.4f2731c61a8e37dc3b1cb4eb301ef71f96a8e7c926d4a6d230ee2652a5996563,\n\t\t\t d2450100e2dda59c2b7828b4daff7f8c.e511ce5564513d6f81e8798ab8caf3b23c6ba3def1a8b441a85fc7b3bcb1d0d6,\n\t\t\t d2450100e2dda59c2b7828b4daff7f8c.ccf8d88f2d37f3171da2121ab22e9330,\n             d2450100e2dda59c2b7828b4daff7f8c.37175a70b8190fbf717de5f6ebc49b0a,\n             CASE\n                WHEN d2450100e2dda59c2b7828b4daff7f8c.37175a70b8190fbf717de5f6ebc49b0a <> 0 THEN CASE WHEN drops <> 0 THEN d2450100e2dda59c2b7828b4daff7f8c.37175a70b8190fbf717de5f6ebc49b0a / d2450100e2dda59c2b7828b4daff7f8c.630c48bbfe25ea68a239339f24d37c79 ELSE 0 END\n                ELSE NULL\n             END\n                unfrm_grs_tgp_per_drop\n\n        FROM (  SELECT cust_nbr,\n                       div_nbr,\n                       fisc_yr,\n                       fisc_mth_of_yr,\n\t\t\t\t\t   fisc_yr_wk,\n\t\t\t\t\t   fisc_wk_of_yr,\n                       SUM(NVL(sales_ty, 0)) AS sales_ty,\n                       SUM(NVL(sales_ly, 0)) AS sales_ly,\n                       SUM(NVL(no_cd_unfrm_sales_ty, 0)) AS no_cd_unfrm_sales_ty,\n                       SUM(NVL(no_cd_unfrm_sales_ly, 0)) AS no_cd_unfrm_sales_ly,\n                       SUM(NVL(drops, 0)) drops,\n                       SUM(NVL(grs_sls_extnd, 0)) grs_sls_extnd,\n                       SUM(NVL(qty_ship, 0)) qty_ship,\n                       SUM(NVL(unfrm_grs_sls_extnd, 0)) unfrm_grs_sls_extnd,\n                       SUM(NVL(unfrm_dwa_cost_extnd, 0)) unfrm_dwa_cost_extnd,\n\t\t\t\t\t   SUM(NVL(unfrm_ttl_vndr_fnd_dvt, 0)) unfrm_ttl_vndr_fnd_dvt,\n                       SUM(NVL(unfrm_qty_ship, 0)) unfrm_qty_ship,\n                       SUM(NVL(unfrm_grs_tgp, 0)) unfrm_grs_tgp\n                       FROM (SELECT 6f037dd8c55b34c0a958bc6e5d1c45f6.852fa1e9f02f1ca2c75837f7146b2381,\n                               6f037dd8c55b34c0a958bc6e5d1c45f6.839c4ffb4bfaae1bb58eab4dee67d96a,\n                               6f037dd8c55b34c0a958bc6e5d1c45f6.ab30d6d679879cfacfe389b97d1d3f0e,\n                               6f037dd8c55b34c0a958bc6e5d1c45f6.e1d446673288adb6d5f219d0aa82d37a,\n\t\t\t\t\t\t\t   6f037dd8c55b34c0a958bc6e5d1c45f6.f2de255a7553ba934b1f05ae7699ae4c,\n\t\t\t\t\t\t\t   6f037dd8c55b34c0a958bc6e5d1c45f6.cb5e253886eb30a93e66cbf95203a754,\n                                CASE\n                                  WHEN 15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.ab30d6d679879cfacfe389b97d1d3f0e = ]'\n         || v_fisc_yr\n         || q'[-2 THEN NVL(15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.2ee1400a0150f0b220dd7bd6268d1e66,0)\n                                  ELSE 0\n                                END sales_ty,\n                                CASE\n                                  WHEN 15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.ab30d6d679879cfacfe389b97d1d3f0e = ]'\n         || v_fisc_yr\n         || q'[-3 THEN NVL(15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.2ee1400a0150f0b220dd7bd6268d1e66,0)\n                                  ELSE 0\n                                END sales_ly,\n                                CASE\n                                  WHEN 15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.ab30d6d679879cfacfe389b97d1d3f0e = ]'\n         || v_fisc_yr\n         || q'[-2 THEN NVL(15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.ab081c412fc18694a8297c8dfdea984cd9542f5039f4af6f9fa4a3007112f536,0)\n                                  ELSE 0\n                                END no_cd_unfrm_sales_ty,\n                                CASE\n                                  WHEN 15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.ab30d6d679879cfacfe389b97d1d3f0e = ]'\n         || v_fisc_yr\n         || q'[-3 THEN NVL(15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.ab081c412fc18694a8297c8dfdea984cd9542f5039f4af6f9fa4a3007112f536,0)\n                                  ELSE 0\n                                END no_cd_unfrm_sales_ly,\n                                case when 15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.ab30d6d679879cfacfe389b97d1d3f0e = ]'\n         || v_fisc_yr\n         || q'[-2 then 15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.630c48bbfe25ea68a239339f24d37c79 end drops,\n                                case when 15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.ab30d6d679879cfacfe389b97d1d3f0e = ]'\n         || v_fisc_yr\n         || q'[-2 then 15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.2ee1400a0150f0b220dd7bd6268d1e66 end grs_sls_extnd,\n                                case when 15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.ab30d6d679879cfacfe389b97d1d3f0e = ]'\n         || v_fisc_yr\n         || q'[-2 then 15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.dc15696e1e997bad6131bf936574f406 end qty_ship,\n                                case when 15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.ab30d6d679879cfacfe389b97d1d3f0e = ]'\n         || v_fisc_yr\n         || q'[-2 then 15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.afcae1f8310cd038c0633aeaa179c10c280a4c8731f60bb762471fb74030c9a2 end unfrm_grs_sls_extnd,\n\t\t                        case when 15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.ab30d6d679879cfacfe389b97d1d3f0e = ]'\n         || v_fisc_yr\n         || q'[-2 then 15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.4f2731c61a8e37dc3b1cb4eb301ef71f96a8e7c926d4a6d230ee2652a5996563 end unfrm_dwa_cost_extnd,\n                                case when 15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.ab30d6d679879cfacfe389b97d1d3f0e = ]'\n         || v_fisc_yr\n         || q'[-2 then 15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.e511ce5564513d6f81e8798ab8caf3b23c6ba3def1a8b441a85fc7b3bcb1d0d6 end unfrm_ttl_vndr_fnd_dvt,\n                                case when 15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.ab30d6d679879cfacfe389b97d1d3f0e = ]'\n         || v_fisc_yr\n         || q'[-2 then 15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.ccf8d88f2d37f3171da2121ab22e9330 end unfrm_qty_ship,\n                                case when 15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.ab30d6d679879cfacfe389b97d1d3f0e = ]'\n         || v_fisc_yr\n         || q'[-2 then 15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.37175a70b8190fbf717de5f6ebc49b0a end unfrm_grs_tgp\n\n                         FROM (SELECT d2450100e2dda59c2b7828b4daff7f8c.839c4ffb4bfaae1bb58eab4dee67d96a,\n                                      d2450100e2dda59c2b7828b4daff7f8c.852fa1e9f02f1ca2c75837f7146b2381,\n                                      1d731bbdc4e3fb69a854112d4982eb99.ab30d6d679879cfacfe389b97d1d3f0e,\n                                      1d731bbdc4e3fb69a854112d4982eb99.e1d446673288adb6d5f219d0aa82d37a,\n                                      1d731bbdc4e3fb69a854112d4982eb99.f2de255a7553ba934b1f05ae7699ae4c,\n\t\t\t\t\t\t\t\t\t  1d731bbdc4e3fb69a854112d4982eb99.cb5e253886eb30a93e66cbf95203a754,\n                                      d2450100e2dda59c2b7828b4daff7f8c.7f599f836c449bebb92bb9757e86c603\n\n                               FROM ]'\n         || v_cust_vw\n         || q'[,\n                                    (SELECT 1d731bbdc4e3fb69a854112d4982eb99.ab30d6d679879cfacfe389b97d1d3f0e, 1d731bbdc4e3fb69a854112d4982eb99.e1d446673288adb6d5f219d0aa82d37a, 1d731bbdc4e3fb69a854112d4982eb99.f2de255a7553ba934b1f05ae7699ae4c,1d731bbdc4e3fb69a854112d4982eb99.cb5e253886eb30a93e66cbf95203a754\n                                     FROM de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001 t\n                                     WHERE 1d731bbdc4e3fb69a854112d4982eb99.ab30d6d679879cfacfe389b97d1d3f0e = ]'\n         || v_fisc_yr\n         || q'[-2 AND 1d731bbdc4e3fb69a854112d4982eb99.cb5e253886eb30a93e66cbf95203a754 <= ']'\n         || v_fisc_wk_of_yr\n         || q'[' GROUP BY 1d731bbdc4e3fb69a854112d4982eb99.ab30d6d679879cfacfe389b97d1d3f0e, 1d731bbdc4e3fb69a854112d4982eb99.e1d446673288adb6d5f219d0aa82d37a, 1d731bbdc4e3fb69a854112d4982eb99.f2de255a7553ba934b1f05ae7699ae4c,1d731bbdc4e3fb69a854112d4982eb99.cb5e253886eb30a93e66cbf95203a754) t) cust_list,\n                               (SELECT e9a95106e01380a7834d36560e919770.839c4ffb4bfaae1bb58eab4dee67d96a,\n                                      e9a95106e01380a7834d36560e919770.852fa1e9f02f1ca2c75837f7146b2381,\n                                      1d731bbdc4e3fb69a854112d4982eb99.ab30d6d679879cfacfe389b97d1d3f0e,\n                                      1d731bbdc4e3fb69a854112d4982eb99.e1d446673288adb6d5f219d0aa82d37a,\n\t\t\t\t\t\t\t\t\t  1d731bbdc4e3fb69a854112d4982eb99.f2de255a7553ba934b1f05ae7699ae4c,\n\t\t\t\t\t\t\t\t\t  1d731bbdc4e3fb69a854112d4982eb99.cb5e253886eb30a93e66cbf95203a754,\n                                      count(distinct case when e9a95106e01380a7834d36560e919770.26ac88e7ae671a1b22c14c2fce77aa2d = 'RT' AND pim_suprcls_id_actl <> 97 AND pim_suprcls_id_actl IS NOT NULL then e9a95106e01380a7834d36560e919770.4fdc122fb2d10dd764e32cbc98972eca||e9a95106e01380a7834d36560e919770.9f055ebf334db6c50bbcab4ff14bd2ae||INV_DT||nvl(DLVR_RTE,'')||PRCS_DT else NULL end) DROPS,\n                                     SUM (grs_sls_extnd) AS GRS_SLS_EXTND,\n                                     SUM(CASE\n                                                WHEN e9a95106e01380a7834d36560e919770.26ac88e7ae671a1b22c14c2fce77aa2d IN ('RT', 'VS', 'WC')\n                                                 AND c1f84e8860c9acbd312fc2d82a40cc08.89f3df82917b692fe64dca942d924e7c <> 97\n                                                 AND c1f84e8860c9acbd312fc2d82a40cc08.89f3df82917b692fe64dca942d924e7c is not null THEN\n                                                   e9a95106e01380a7834d36560e919770.2ee1400a0150f0b220dd7bd6268d1e66\n                                                ELSE\n                                                   NULL\n                                             END)\n                                            no_cd_unfrm_grs_sls_extnd,\n                                     SUM(QTY_SHIP) as QTY_SHIP,\n                                     SUM(UNFRM_QTY_SHIP)UNFRM_QTY_SHIP,\n                                     sum(case when c1f84e8860c9acbd312fc2d82a40cc08.89f3df82917b692fe64dca942d924e7c <> 97\n                                          and c1f84e8860c9acbd312fc2d82a40cc08.89f3df82917b692fe64dca942d924e7c is not null\n                                         then grs_sls_extnd\n                                         else 0\n                                         END) UNFRM_GRS_SLS_EXTND,\n\t\t\t\t\t\t\t\t\tsum(case when c1f84e8860c9acbd312fc2d82a40cc08.89f3df82917b692fe64dca942d924e7c <> 97\n                                          and c1f84e8860c9acbd312fc2d82a40cc08.89f3df82917b692fe64dca942d924e7c is not null\n                                         then ttl_vndr_fnd_dvt\n                                         else 0\n                                         END) unfrm_ttl_vndr_fnd_dvt,\n                                     sum(case when c1f84e8860c9acbd312fc2d82a40cc08.89f3df82917b692fe64dca942d924e7c <> 97\n                                          and c1f84e8860c9acbd312fc2d82a40cc08.89f3df82917b692fe64dca942d924e7c is not null\n                                         then dwa_cost_extnd\n                                         else 0\n                                         END) unfrm_dwa_cost_extnd,\n                                     SUM(CASE\n                                                WHEN c1f84e8860c9acbd312fc2d82a40cc08.89f3df82917b692fe64dca942d924e7c <> 97\n                                                 AND c1f84e8860c9acbd312fc2d82a40cc08.89f3df82917b692fe64dca942d924e7c IS NOT NULL THEN\n                                                   NVL(e9a95106e01380a7834d36560e919770.2ee1400a0150f0b220dd7bd6268d1e66 - e9a95106e01380a7834d36560e919770.c6c7cc45578c678907522e08bb04a4ca + e9a95106e01380a7834d36560e919770.b7982b81d447f11a0953881190e528cae32f6dd38f333cde68119d1f277367cd\n                                                       - CASE\n                                                            WHEN e9a95106e01380a7834d36560e919770.487c194c34aee6c67551aa2cdd2358ace32f6dd38f333cde68119d1f277367cd = 'P' THEN NVL(e9a95106e01380a7834d36560e919770.d206d123f59f85e26ec113e33b465295,0)\n                                                            ELSE 0\n                                                          END, 0)\n                                                ELSE\n                                                   0\n                                             END)\n                                            unfrm_grs_tgp\n\n                               FROM de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001 t,\n                                    de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c s,\n                                    de459e2fe7f96e4d958537b31b946b26.2c04d82ed0aa1cc9bce2cf2c0548b268 pim,\n                                    de459e2fe7f96e4d958537b31b946b26.dec387908a0954ddc8689c4ad37c8a3c d, ]'\n         || v_cust_vw\n         || q'[ WHERE     1d731bbdc4e3fb69a854112d4982eb99.ab30d6d679879cfacfe389b97d1d3f0e in (]'\n         || v_fisc_yr\n         || '-2,'\n         || v_fisc_yr\n         || q'[-3)\n                                     AND 1d731bbdc4e3fb69a854112d4982eb99.cb5e253886eb30a93e66cbf95203a754 <= ']'\n         || v_fisc_wk_of_yr\n         || q'[' AND 1d731bbdc4e3fb69a854112d4982eb99.cb5e253886eb30a93e66cbf95203a754 <> CASE\n                                                               WHEN 1d731bbdc4e3fb69a854112d4982eb99.ab30d6d679879cfacfe389b97d1d3f0e = (]'\n         || v_fisc_yr\n         || q'[-3) AND ']'\n         || v_fisc_mth_of_yr\n         || q'[' = '12' AND ]'\n         || v_py_max_wk\n         || q'[= 53 THEN 53    \n                                                               ELSE 99    \n                                                            END\n                                     AND 1d731bbdc4e3fb69a854112d4982eb99.222ccb1d1746bcdb2365f29b3da0b613 <= ']'\n         || v_end_dt\n         ||\n           q'[' AND e9a95106e01380a7834d36560e919770.f5dd4374a3e3af6a775cb6d6b22e8162 = 1d731bbdc4e3fb69a854112d4982eb99.222ccb1d1746bcdb2365f29b3da0b613\n                                     AND e9a95106e01380a7834d36560e919770.467a168a7499c57b1859198a7dac7be0 IS NULL\n                                     AND e9a95106e01380a7834d36560e919770.839c4ffb4bfaae1bb58eab4dee67d96a = d2450100e2dda59c2b7828b4daff7f8c.839c4ffb4bfaae1bb58eab4dee67d96a\n                                     AND e9a95106e01380a7834d36560e919770.852fa1e9f02f1ca2c75837f7146b2381 = d2450100e2dda59c2b7828b4daff7f8c.852fa1e9f02f1ca2c75837f7146b2381\n                                     AND e9a95106e01380a7834d36560e919770.d3268eabc4a7d98105fd85f9c9e62cd6e32ad436514bbe822b33de8bead744f3 = c1f84e8860c9acbd312fc2d82a40cc08.d3268eabc4a7d98105fd85f9c9e62cd6e32ad436514bbe822b33de8bead744f3\n                                     AND NVL(e9a95106e01380a7834d36560e919770.a2b201123c685e8cc48b5468cb4a449361bbd7bc0d2d67c7d7b11cb0a8d18d03, e9a95106e01380a7834d36560e919770.839c4ffb4bfaae1bb58eab4dee67d96a) = fce896ca0fbbf5a5d330f2803036eb44.839c4ffb4bfaae1bb58eab4dee67d96a\n                                     AND fce896ca0fbbf5a5d330f2803036eb44.b8c6ab19cb6e726c38f24d1885346ea3 <> 'CC'\n\t\t\t\t\t\t\t\t     AND  (case when NVL (fce896ca0fbbf5a5d330f2803036eb44.c712a9ab5ef100c5807fa96123dac48b,'USF') <> 'USF'\n\t\t\t\t\t\t\t\t     and NVL(e9a95106e01380a7834d36560e919770.a2b201123c685e8cc48b5468cb4a449361bbd7bc0d2d67c7d7b11cb0a8d18d03, e9a95106e01380a7834d36560e919770.839c4ffb4bfaae1bb58eab4dee67d96a) = fce896ca0fbbf5a5d330f2803036eb44.839c4ffb4bfaae1bb58eab4dee67d96a\n\t\t\t\t\t\t\t\t\t and e9a95106e01380a7834d36560e919770.f5dd4374a3e3af6a775cb6d6b22e8162 < NVL(fce896ca0fbbf5a5d330f2803036eb44.3db9275d5f5cb2e9d918e77dbabdd97b,e9a95106e01380a7834d36560e919770.f5dd4374a3e3af6a775cb6d6b22e8162)\n\t\t\t\t\t\t\t\t\t then 'NON_USFGL' else 'USFGL' END) ='USFGL'\n                         GROUP BY e9a95106e01380a7834d36560e919770.839c4ffb4bfaae1bb58eab4dee67d96a, e9a95106e01380a7834d36560e919770.852fa1e9f02f1ca2c75837f7146b2381, 1d731bbdc4e3fb69a854112d4982eb99.ab30d6d679879cfacfe389b97d1d3f0e, 1d731bbdc4e3fb69a854112d4982eb99.e1d446673288adb6d5f219d0aa82d37a,1d731bbdc4e3fb69a854112d4982eb99.f2de255a7553ba934b1f05ae7699ae4c,1d731bbdc4e3fb69a854112d4982eb99.cb5e253886eb30a93e66cbf95203a754) cust_sales_ty_ly \n                         WHERE     6f037dd8c55b34c0a958bc6e5d1c45f6.852fa1e9f02f1ca2c75837f7146b2381 = 15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.852fa1e9f02f1ca2c75837f7146b2381(+)\n                               AND 6f037dd8c55b34c0a958bc6e5d1c45f6.839c4ffb4bfaae1bb58eab4dee67d96a = 15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.839c4ffb4bfaae1bb58eab4dee67d96a(+)\n                               AND 6f037dd8c55b34c0a958bc6e5d1c45f6.cb5e253886eb30a93e66cbf95203a754 = 15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.cb5e253886eb30a93e66cbf95203a754(+))\n\n                         GROUP by\n                                cust_nbr,\n                                div_nbr,\n                                fisc_yr,\n                                fisc_mth_of_yr,\n                                fisc_yr_wk,\n                                fisc_wk_of_yr\n                               ) c,\n                         (select fisc_yr, fisc_mth_of_yr, fisc_yr_wk,fisc_wk_of_yr,\n                                 min(clndr_dt) fisc_wk_strt_dt,\n                                 max(clndr_dt) fisc_wk_end_dt,\n                                 min(clndr_dt_yrago) fisc_wk_strt_dt_yrago,\n                                 max(clndr_dt_yrago) fisc_wk_end_dt_yrago\n                                 from de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001\n                                 group by fisc_yr, fisc_mth_of_yr, fisc_yr_wk,fisc_wk_of_yr) t\n                         where 1d731bbdc4e3fb69a854112d4982eb99.ab30d6d679879cfacfe389b97d1d3f0e = d2450100e2dda59c2b7828b4daff7f8c.ab30d6d679879cfacfe389b97d1d3f0e\n                           and 1d731bbdc4e3fb69a854112d4982eb99.cb5e253886eb30a93e66cbf95203a754 = d2450100e2dda59c2b7828b4daff7f8c.cb5e253886eb30a93e66cbf95203a754)]';\n\n      DBMS_OUTPUT.put_line(l_trans_insert);\n\n      EXECUTE IMMEDIATE l_trans_insert;\n\n      l_insert_cnt   := sql%ROWCOUNT;\n\n      COMMIT;\n      DBMS_OUTPUT.put_line(\n         'Inserted ' || l_insert_cnt || ' rows in ' || TO_CHAR(ROUND((SYSDATE - l_fn_start) * 86400)) || ' seconds');\n\n      \n      v_mrg_stmt     :=\n         q'[MERGE INTO de459e2fe7f96e4d958537b31b946b26.8f230825af6a32c108cd49878ff72f863896c74fc5f3a866bc8d8582e2fba0b4 tgt\n           USING (select cust_nbr, div_nbr, fisc_yr, fisc_mth_of_yr,fisc_yr_wk, fisc_wk_of_yr, cust_clsfctn,\n                  fisc_wk_strt_dt, fisc_wk_end_dt, fisc_wk_strt_dt_yrago, fisc_wk_end_dt_yrago, crt_dt, upd_dt, drops, grs_sls_extnd,\n                  qty_ship,unfrm_grs_sls_extnd, unfrm_dwa_cost_extnd, unfrm_ttl_vndr_fnd_dvt, unfrm_qty_ship, unfrm_grs_tgp, unfrm_grs_tgp_per_drop\n                  FROM ]'\n         || v_src_schema\n         || '.'\n         || v_tbl_prfx\n         || v_in_div_nbr\n         || q'[) src\n           ON (c87bbaf85002563e56e2c571e0e1c5a2.852fa1e9f02f1ca2c75837f7146b2381 = a1fa0f79e78ad884522822d320ab5272.852fa1e9f02f1ca2c75837f7146b2381\n           AND c87bbaf85002563e56e2c571e0e1c5a2.839c4ffb4bfaae1bb58eab4dee67d96a = a1fa0f79e78ad884522822d320ab5272.839c4ffb4bfaae1bb58eab4dee67d96a\n           AND c87bbaf85002563e56e2c571e0e1c5a2.ab30d6d679879cfacfe389b97d1d3f0e = a1fa0f79e78ad884522822d320ab5272.ab30d6d679879cfacfe389b97d1d3f0e\n           AND c87bbaf85002563e56e2c571e0e1c5a2.e1d446673288adb6d5f219d0aa82d37a = a1fa0f79e78ad884522822d320ab5272.e1d446673288adb6d5f219d0aa82d37a\n           AND c87bbaf85002563e56e2c571e0e1c5a2.cb5e253886eb30a93e66cbf95203a754 = a1fa0f79e78ad884522822d320ab5272.cb5e253886eb30a93e66cbf95203a754)\n   WHEN MATCHED THEN\n      UPDATE SET c87bbaf85002563e56e2c571e0e1c5a2.8a5c1eda3416fa5daae04a2980452d8a                 = a1fa0f79e78ad884522822d320ab5272.8a5c1eda3416fa5daae04a2980452d8a,\n                 c87bbaf85002563e56e2c571e0e1c5a2.dfe42c57475d9fd89d96ed9e57b69306             = a1fa0f79e78ad884522822d320ab5272.dfe42c57475d9fd89d96ed9e57b69306,\n                 c87bbaf85002563e56e2c571e0e1c5a2.74b6de95f34ea7c017ab8b68a54fe70b              = a1fa0f79e78ad884522822d320ab5272.74b6de95f34ea7c017ab8b68a54fe70b,\n                 c87bbaf85002563e56e2c571e0e1c5a2.72d6de60a9cbb2a2d78a2a36297e55f1f43d3e611ef8d78ea0e7840aa66f8834       = a1fa0f79e78ad884522822d320ab5272.72d6de60a9cbb2a2d78a2a36297e55f1f43d3e611ef8d78ea0e7840aa66f8834,\n                 c87bbaf85002563e56e2c571e0e1c5a2.2cbaab6f2111487297b7d37f7d42883a04f2c76b85d3b6c683ff67d7fcfe6fae        = a1fa0f79e78ad884522822d320ab5272.2cbaab6f2111487297b7d37f7d42883a04f2c76b85d3b6c683ff67d7fcfe6fae,\n                 c87bbaf85002563e56e2c571e0e1c5a2.7a133759cd0bf9f99c4a5301a550aed5                       = (    SELECT SYSDATE FROM DUAL),\n                 c87bbaf85002563e56e2c571e0e1c5a2.630c48bbfe25ea68a239339f24d37c79                        = a1fa0f79e78ad884522822d320ab5272.630c48bbfe25ea68a239339f24d37c79,\n                 c87bbaf85002563e56e2c571e0e1c5a2.2ee1400a0150f0b220dd7bd6268d1e66                = a1fa0f79e78ad884522822d320ab5272.2ee1400a0150f0b220dd7bd6268d1e66,\n                 c87bbaf85002563e56e2c571e0e1c5a2.dc15696e1e997bad6131bf936574f406                     = a1fa0f79e78ad884522822d320ab5272.dc15696e1e997bad6131bf936574f406,\n                 c87bbaf85002563e56e2c571e0e1c5a2.afcae1f8310cd038c0633aeaa179c10c280a4c8731f60bb762471fb74030c9a2          = a1fa0f79e78ad884522822d320ab5272.afcae1f8310cd038c0633aeaa179c10c280a4c8731f60bb762471fb74030c9a2,\n\t\t\t\t c87bbaf85002563e56e2c571e0e1c5a2.4f2731c61a8e37dc3b1cb4eb301ef71f96a8e7c926d4a6d230ee2652a5996563         = a1fa0f79e78ad884522822d320ab5272.4f2731c61a8e37dc3b1cb4eb301ef71f96a8e7c926d4a6d230ee2652a5996563,\n\t\t\t\t c87bbaf85002563e56e2c571e0e1c5a2.e511ce5564513d6f81e8798ab8caf3b23c6ba3def1a8b441a85fc7b3bcb1d0d6       = a1fa0f79e78ad884522822d320ab5272.e511ce5564513d6f81e8798ab8caf3b23c6ba3def1a8b441a85fc7b3bcb1d0d6,\n                 c87bbaf85002563e56e2c571e0e1c5a2.ccf8d88f2d37f3171da2121ab22e9330               = a1fa0f79e78ad884522822d320ab5272.ccf8d88f2d37f3171da2121ab22e9330,\n                 c87bbaf85002563e56e2c571e0e1c5a2.37175a70b8190fbf717de5f6ebc49b0a                = a1fa0f79e78ad884522822d320ab5272.37175a70b8190fbf717de5f6ebc49b0a,\n                 c87bbaf85002563e56e2c571e0e1c5a2.e6160a512e148d90c7df38ae2e16368dcd30f368447f67a772f6e122173aa0f4       = a1fa0f79e78ad884522822d320ab5272.e6160a512e148d90c7df38ae2e16368dcd30f368447f67a772f6e122173aa0f4\n           WHEN NOT MATCHED THEN INSERT  ( cust_nbr, div_nbr, fisc_yr, fisc_mth_of_yr, fisc_yr_wk,\n                         fisc_wk_of_yr, cust_clsfctn, fisc_wk_strt_dt, fisc_wk_end_dt, fisc_wk_strt_dt_yrago, fisc_wk_end_dt_yrago,\n                         crt_dt,  drops, grs_sls_extnd, qty_ship, unfrm_grs_sls_extnd, unfrm_dwa_cost_extnd,unfrm_ttl_vndr_fnd_dvt, unfrm_qty_ship,\n                          unfrm_grs_tgp, unfrm_grs_tgp_per_drop )\n           VALUES ( a1fa0f79e78ad884522822d320ab5272.852fa1e9f02f1ca2c75837f7146b2381, a1fa0f79e78ad884522822d320ab5272.839c4ffb4bfaae1bb58eab4dee67d96a, a1fa0f79e78ad884522822d320ab5272.ab30d6d679879cfacfe389b97d1d3f0e,a1fa0f79e78ad884522822d320ab5272.e1d446673288adb6d5f219d0aa82d37a,a1fa0f79e78ad884522822d320ab5272.f2de255a7553ba934b1f05ae7699ae4c, a1fa0f79e78ad884522822d320ab5272.cb5e253886eb30a93e66cbf95203a754, a1fa0f79e78ad884522822d320ab5272.8a5c1eda3416fa5daae04a2980452d8a, a1fa0f79e78ad884522822d320ab5272.dfe42c57475d9fd89d96ed9e57b69306,\n                  a1fa0f79e78ad884522822d320ab5272.74b6de95f34ea7c017ab8b68a54fe70b, a1fa0f79e78ad884522822d320ab5272.72d6de60a9cbb2a2d78a2a36297e55f1f43d3e611ef8d78ea0e7840aa66f8834,a1fa0f79e78ad884522822d320ab5272.2cbaab6f2111487297b7d37f7d42883a04f2c76b85d3b6c683ff67d7fcfe6fae,a1fa0f79e78ad884522822d320ab5272.44db07dca7893985ce87192c7f358f75, 0, a1fa0f79e78ad884522822d320ab5272.2ee1400a0150f0b220dd7bd6268d1e66, a1fa0f79e78ad884522822d320ab5272.dc15696e1e997bad6131bf936574f406, a1fa0f79e78ad884522822d320ab5272.afcae1f8310cd038c0633aeaa179c10c280a4c8731f60bb762471fb74030c9a2,\n\t\t\t\t  a1fa0f79e78ad884522822d320ab5272.4f2731c61a8e37dc3b1cb4eb301ef71f96a8e7c926d4a6d230ee2652a5996563,a1fa0f79e78ad884522822d320ab5272.e511ce5564513d6f81e8798ab8caf3b23c6ba3def1a8b441a85fc7b3bcb1d0d6, a1fa0f79e78ad884522822d320ab5272.ccf8d88f2d37f3171da2121ab22e9330, a1fa0f79e78ad884522822d320ab5272.37175a70b8190fbf717de5f6ebc49b0a, a1fa0f79e78ad884522822d320ab5272.e6160a512e148d90c7df38ae2e16368dcd30f368447f67a772f6e122173aa0f4)]';\n\n      DBMS_OUTPUT.put_line(v_mrg_stmt);\n\n      EXECUTE IMMEDIATE v_mrg_stmt;\n\n      COMMIT;\n\n      DBMS_OUTPUT.put_line('Table 0e03d5c46556a742ba46252698396ef2.b7f9a8d8e9c3da66d1e4bda132607882cb2679e98630ca77e1c5d57222adb2cf updated ' || SYSTIMESTAMP);\n\n      EXECUTE IMMEDIATE 'DROP TABLE ' || v_src_schema || '.' || v_tbl_prfx || v_in_div_nbr;\n\n      DBMS_OUTPUT.put_line(\n         'Table ' || v_src_schema || '.' || v_tbl_prfx || v_in_div_nbr || ' dropped ' || SYSTIMESTAMP);\n   ELSE\n      DBMS_OUTPUT.put_line('No customer(s) to reclassify ' || SYSTIMESTAMP);\n   END IF;\n\n   IF v_in_cust_nbr IS NULL THEN\n      \n      \n      SELECT COUNT( * )\n        INTO v_cnt2\n        FROM de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c\n       WHERE div_nbr = v_in_div_nbr\n         AND xfer_to_dt IS NOT NULL\n         AND ldr_tm > v_in_ldr_tm;\n\n      DBMS_OUTPUT.put_line('v_cnt2 ' || v_cnt2);\n\n      IF v_cnt2 > 0 THEN\n         DELETE FROM de459e2fe7f96e4d958537b31b946b26.b7f9a8d8e9c3da66d1e4bda132607882cb2679e98630ca77e1c5d57222adb2cf\n               WHERE div_nbr = v_in_div_nbr\n                 AND cust_nbr IN (SELECT DISTINCT cust_nbr\n                                    FROM de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c\n                                   WHERE div_nbr = v_in_div_nbr\n                                     AND xfer_to_dt IS NOT NULL\n                                     AND ldr_tm > v_in_ldr_tm);\n\n         COMMIT;\n         DBMS_OUTPUT.put_line('Deleted customers that were transferred out ' || SYSTIMESTAMP);\n      END IF;\n\n\n\n   COMMIT;\n\n   \n   OPEN c_ap_tgp;\n\n   LOOP\n      EXIT WHEN c_ap_tgp%NOTFOUND;\n\n      FETCH c_ap_tgp\n      BULK COLLECT INTO r_ap_tgp\n      LIMIT 10000;\n\n      FORALL i IN 1 .. caccafa413afe7566d178b5d61b27be2.c838adb0c77d39edf51006214ba6e643()\n         UPDATE \n               de459e2fe7f96e4d958537b31b946b26.8f230825af6a32c108cd49878ff72f863896c74fc5f3a866bc8d8582e2fba0b4 b\n            SET unfrm_grs_tgp = r_ap_tgp(i).unfrm_grs_tgp, unfrm_grs_tgp_per_drop = r_ap_tgp(i).unfrm_grs_tgp_per_drop\n          WHERE 6d9b37be5a083f8b78d676aba846c823.839c4ffb4bfaae1bb58eab4dee67d96a = r_ap_tgp(i).div_nbr\n            AND 6d9b37be5a083f8b78d676aba846c823.852fa1e9f02f1ca2c75837f7146b2381 = r_ap_tgp(i).cust_nbr\n            AND 6d9b37be5a083f8b78d676aba846c823.dfe42c57475d9fd89d96ed9e57b69306 = r_ap_tgp(i).fisc_wk_strt_dt;\n\n\n      DBMS_OUTPUT.put_line('Rows Updated' || sql%ROWCOUNT);\n      COMMIT;\n   END LOOP;\n\n   CLOSE c_ap_tgp;\n\n   RETURN 0;\n\n\n   END IF;\n   EXCEPTION\nWHEN OTHERS THEN\n      DBMS_OUTPUT.put_line('Error in 0e03d5c46556a742ba46252698396ef2.6ed4b6f3334125cd8e95581577ce6a607f6e73c66a4a5e01d3b1c9c28dca86ff:' || SQLCODE || ' ' || SQLERRM);\n      RETURN 1;\n\nEND FN_CUST_CLS_CORP_WKLY_RECLS;\n/",
            "upstream_dependencies": [],
            "downstream_dependencies": [],
            "dag_location": "null",
            "gantt_location": "null",
            "created_at": "null",
            "updated_at": "null"
        },
        {
            "name": "FN_CRT_SYNONYM",
            "encrypted_name": "60ac4f2269d203f666e8df2b3b5485d6",
            "type": "function",
            "database": "null",
            "encrypted_database": "null",
            "schema": "XDMADM",
            "encrypted_schema": "0e03d5c46556a742ba46252698396ef2",
            "fully_qualified_name": "XDMADM.FN_CRT_SYNONYM",
            "encrypted_fqn": "0e03d5c46556a742ba46252698396ef2.60ac4f2269d203f666e8df2b3b5485d6",
            "synonyms": [],
            "metadata_analysis": "CREATE OR REPLACE FUNCTION \"0e03d5c46556a742ba46252698396ef2\".\"60ac4f2269d203f666e8df2b3b5485d6\"\n   (p_syn_nm IN VARCHAR2, p_tbl_owner VARCHAR2 , p_tbl_nm VARCHAR2 )\n      RETURN NUMBER\n   AS\n   v_dyn_sql    VARCHAR2(500);\nBEGIN\n\n    v_dyn_sql := 'CREATE OR REPLACE SYNONYM '||p_syn_nm ||' FOR '||p_tbl_owner||'.'||p_tbl_nm;\n    DBMS_OUTPUT.PUT_LINE (v_dyn_sql);\n    execute immediate v_dyn_sql;\n    return 0;\n\nEXCEPTION\n    WHEN OTHERS THEN\n        DBMS_OUTPUT.PUT_LINE ('error in de459e2fe7f96e4d958537b31b946b26.f21751d25bb3675b2a3778f4f03c7da6 while creating the '||p_syn_nm||' synonym on '||p_tbl_owner||'.'||p_tbl_nm);\n        DBMS_OUTPUT.put_line ('ERROR:' || SQLCODE || ',' || SQLERRM);\n        RETURN 1;\nEND;\n/",
            "upstream_dependencies": [],
            "downstream_dependencies": [],
            "dag_location": "null",
            "gantt_location": "null",
            "created_at": "null",
            "updated_at": "null"
        },
        {
            "name": "FN_ACQSTN_SLS_EXCLUDE_VPD",
            "encrypted_name": "fceb5158121ed80c87b34472f6b284952880ee29336f388c5a42fe7ae1fc13a0",
            "type": "function",
            "database": "null",
            "encrypted_database": "null",
            "schema": "XDMADM",
            "encrypted_schema": "0e03d5c46556a742ba46252698396ef2",
            "fully_qualified_name": "XDMADM.FN_ACQSTN_SLS_EXCLUDE_VPD",
            "encrypted_fqn": "0e03d5c46556a742ba46252698396ef2.fceb5158121ed80c87b34472f6b284952880ee29336f388c5a42fe7ae1fc13a0",
            "synonyms": [],
            "metadata_analysis": "CREATE OR REPLACE FUNCTION \"0e03d5c46556a742ba46252698396ef2\".\"fceb5158121ed80c87b34472f6b284952880ee29336f388c5a42fe7ae1fc13a0\" (p_schema       IN VARCHAR2,\n                                                        p_objname      IN VARCHAR2)\n   RETURN VARCHAR2 AS\n   \n   c_start                CONSTANT NUMBER := DBMS_UTILITY.get_time;\n   c_fn_nm                CONSTANT VARCHAR2(30) := 'FN_ACQSTN_SLS_EXCLUDE_VPD';\n   l_security_predicate   VARCHAR2(4000) DEFAULT NULL;\n   l_cur_sql              VARCHAR2(4000) := SYS_CONTEXT('USERENV', 'CURRENT_SQL');\n   l_sbjct_area           VARCHAR2(100) := SYS_CONTEXT(9751bbbcfea690cc0be4d58830a6fe2e.9bfb5eb7793dc8fa6800d5a61e5e3e4e1e2f6ec194927f064ce6cb31fba71a32.f4a54ebc6f2c591ed4266aafe66971af, 9751bbbcfea690cc0be4d58830a6fe2e.9bfb5eb7793dc8fa6800d5a61e5e3e4e1e2f6ec194927f064ce6cb31fba71a32.3b1288ed835b1b524e9500bb13544956e6e6300089dae5a98e31814d0406060f);\n   l_vpd_exempt           VARCHAR2(1) := SYS_CONTEXT(9751bbbcfea690cc0be4d58830a6fe2e.9bfb5eb7793dc8fa6800d5a61e5e3e4e1e2f6ec194927f064ce6cb31fba71a32.f4a54ebc6f2c591ed4266aafe66971af, 9751bbbcfea690cc0be4d58830a6fe2e.9bfb5eb7793dc8fa6800d5a61e5e3e4e1e2f6ec194927f064ce6cb31fba71a32.0eaf613ab52a53601d1496b5650de81e);\n   l_all_divs             VARCHAR2(1) := SYS_CONTEXT(9751bbbcfea690cc0be4d58830a6fe2e.9bfb5eb7793dc8fa6800d5a61e5e3e4e1e2f6ec194927f064ce6cb31fba71a32.f4a54ebc6f2c591ed4266aafe66971af, 9751bbbcfea690cc0be4d58830a6fe2e.9bfb5eb7793dc8fa6800d5a61e5e3e4e1e2f6ec194927f064ce6cb31fba71a32.0f460756ee76d4a2460733464cda5f95);\n\n   l_div_count            NUMBER := 0;\n   l_first                BOOLEAN := TRUE;\n\n   CURSOR all_divs_c IS\n      SELECT \n            de459e2fe7f96e4d958537b31b946b26.dec387908a0954ddc8689c4ad37c8a3c.839c4ffb4bfaae1bb58eab4dee67d96a\n        FROM de459e2fe7f96e4d958537b31b946b26.dec387908a0954ddc8689c4ad37c8a3c dc\n       WHERE nvl(ACQSTN_CMPNY_NM,'USF') <> 'USF' ;\n\n   all_divs_rec           all_divs_c%ROWTYPE;\nBEGIN\n   \n\n   IF l_sbjct_area IS NULL THEN\n      l_security_predicate   := '1=2';\n      9751bbbcfea690cc0be4d58830a6fe2e.d4abe88ed2062b430c927bc84d61faf1f9a7aadf5998d448c2e2d1b0b47a3056.7d64937276682b23a0e16e5c61dad7aa('NO SA',\n                                          c_fn_nm,\n                                          USER,\n                                          p_schema,\n                                          p_objname,\n                                          l_sbjct_area,\n                                          l_vpd_exempt,\n                                          l_all_divs,\n                                          l_cur_sql,\n                                          l_security_predicate,\n                                          (DBMS_UTILITY.get_time - c_start) / 100);\n\n      RETURN l_security_predicate;\n   END IF;\n\n   \n   \n\n   IF l_vpd_exempt = 'Y' THEN\n      l_security_predicate   := '1=1';\n      9751bbbcfea690cc0be4d58830a6fe2e.d4abe88ed2062b430c927bc84d61faf1f9a7aadf5998d448c2e2d1b0b47a3056.7d64937276682b23a0e16e5c61dad7aa('EXEMPT',\n                                          c_fn_nm,\n                                          USER,\n                                          p_schema,\n                                          p_objname,\n                                          l_sbjct_area,\n                                          l_vpd_exempt,\n                                          l_all_divs,\n                                          l_cur_sql,\n                                          l_security_predicate,\n                                          (DBMS_UTILITY.get_time - c_start) / 100);\n\n      RETURN l_security_predicate;\n   END IF;\n\n   \n   \n\n   SELECT COUNT( * )\n     INTO l_div_count\n     FROM de459e2fe7f96e4d958537b31b946b26.dec387908a0954ddc8689c4ad37c8a3c dc\n    WHERE nvl(ACQSTN_CMPNY_NM,'USF') <> 'USF' ;\n\n   IF l_div_count > 0 THEN\n      l_first                := TRUE;\n\n      OPEN all_divs_c;\n\n      LOOP\n         FETCH all_divs_c INTO all_divs_rec;\n\n         EXIT WHEN all_divs_c%NOTFOUND;\n\n         IF l_first THEN\n            l_security_predicate   := 'SLS_REVENUE_DIV_NBR NOT IN (' || 05809d328a80b20ac6b3d7abdb3f24ec.839c4ffb4bfaae1bb58eab4dee67d96a;\n            l_first                := FALSE;\n         ELSE\n            l_security_predicate   := l_security_predicate || ',' || 05809d328a80b20ac6b3d7abdb3f24ec.839c4ffb4bfaae1bb58eab4dee67d96a;\n         END IF;\n      END LOOP;\n\n      CLOSE all_divs_c;\n\n      l_security_predicate   := l_security_predicate || ')';\n   ELSE\n      l_security_predicate   := '1=1';\n   END IF;\n\n   9751bbbcfea690cc0be4d58830a6fe2e.d4abe88ed2062b430c927bc84d61faf1f9a7aadf5998d448c2e2d1b0b47a3056.7d64937276682b23a0e16e5c61dad7aa('ALL DIVS',\n                                       c_fn_nm,\n                                       USER,\n                                       p_schema,\n                                       p_objname,\n                                       l_sbjct_area,\n                                       l_vpd_exempt,\n                                       l_all_divs,\n                                       l_cur_sql,\n                                       l_security_predicate,\n                                       (DBMS_UTILITY.get_time - c_start) / 100);\n\n   RETURN l_security_predicate;\nEXCEPTION\n   WHEN OTHERS THEN\n      l_security_predicate   := '1=2';\n      9751bbbcfea690cc0be4d58830a6fe2e.d4abe88ed2062b430c927bc84d61faf1f9a7aadf5998d448c2e2d1b0b47a3056.7d64937276682b23a0e16e5c61dad7aa(SQLCODE || '-' || SQLERRM,\n                                          c_fn_nm,\n                                          USER,\n                                          p_schema,\n                                          p_objname,\n                                          l_sbjct_area,\n                                          l_vpd_exempt,\n                                          NULL,\n                                          l_cur_sql,\n                                          l_security_predicate,\n                                          (DBMS_UTILITY.get_time - c_start) / 100);\n\n      RETURN l_security_predicate;\nEND fn_acqstn_sls_exclude_vpd;\n/",
            "upstream_dependencies": [],
            "downstream_dependencies": [],
            "dag_location": "null",
            "gantt_location": "null",
            "created_at": "null",
            "updated_at": "null"
        },
        {
            "name": "FN_FWB_CYCLE_LOAD",
            "encrypted_name": "f605c9c0dcb6ca53aa18de96c97195f1a95a09b2641cac5597ee63e380dd2738",
            "type": "function",
            "database": "null",
            "encrypted_database": "null",
            "schema": "XDMADM",
            "encrypted_schema": "0e03d5c46556a742ba46252698396ef2",
            "fully_qualified_name": "XDMADM.FN_FWB_CYCLE_LOAD",
            "encrypted_fqn": "0e03d5c46556a742ba46252698396ef2.f605c9c0dcb6ca53aa18de96c97195f1a95a09b2641cac5597ee63e380dd2738",
            "synonyms": [],
            "metadata_analysis": "CREATE OR REPLACE FUNCTION \"0e03d5c46556a742ba46252698396ef2\".\"f605c9c0dcb6ca53aa18de96c97195f1a95a09b2641cac5597ee63e380dd2738\" (p_odate VARCHAR2)\n   RETURN NUMBER IS\n   \n\n\n   con_process_name   CONSTANT VARCHAR2(40) := 'FN_FWB_CYCLE_LOAD';\n   con_prrty_severe   CONSTANT INTEGER := 1;\n   con_prrty_warn     CONSTANT INTEGER := 2;\n   con_prrty_info     CONSTANT INTEGER := 3;\n   con_prrty_debug    CONSTANT INTEGER := 4;\n   con_err_lvl        CONSTANT INTEGER := 3;\n   v_prcs_err_cd      NUMBER;\n   v_prcs_err_msg     VARCHAR2(500);\n   v_prcs_nm          VARCHAR2(30);\n   v_prcs_stp         VARCHAR2(500);\n\n   v_dba_func_msg     VARCHAR2(2000) := 'oXo';\n   v_sql_string       VARCHAR2(32767);\n   v_table_owner      VARCHAR2(40) := 'XDMADM'; \n   v_table_name       VARCHAR2(40) := 'FWB_CYCLE';\n\n   v_odate_str        VARCHAR2(8) := p_odate;\n   v_fwb_mdl_rec      de459e2fe7f96e4d958537b31b946b26.3ac217a6e67d8f0b8bacb7eae897ec01%ROWTYPE;\nBEGIN\n   v_prcs_nm    := con_process_name;\n   v_prcs_stp   := 'Start Process';\n   DBMS_OUTPUT.put_line(TO_CHAR(SYSDATE, 'YYYY-MM-DD HH24:MI:SS     ') || v_prcs_stp);\n\n   BEGIN\n      \n      v_prcs_stp   := 'Verify ' || v_table_owner || '.' || v_table_name || ' exists';\n      DBMS_OUTPUT.put_line(TO_CHAR(SYSDATE, 'YYYY-MM-DD HH24:MI:SS     ') || v_prcs_stp);\n\n      IF NOT (8e64339f96bb08058f5d52f1c04f954a.8ffe4678890c39c7d4ed38c2ed759e24.2f1d213103845249503667f0017db7e0(v_dba_func_msg,\n                                            v_table_owner,\n                                            v_table_name,\n                                            NULL,\n                                            NULL)) THEN\n         v_prcs_err_msg   := ': Table ' || v_table_owner || '.' || v_table_name || ' does not exist';\n         v_prcs_err_cd    := SQLCODE;\n         DBMS_OUTPUT.put_line(TO_CHAR(SYSDATE, 'YYYY-MM-DD HH24:MI:SS     ') || 'Error Message: ' || v_prcs_err_msg);\n         DBMS_OUTPUT.put_line(TO_CHAR(SYSDATE, 'YYYY-MM-DD HH24:MI:SS     ') || 'Error Code: ' || v_prcs_err_cd);\n         RETURN 2;\n      END IF;\n   EXCEPTION\n      WHEN OTHERS THEN\n         v_prcs_err_msg   := SQLERRM;\n         v_prcs_err_cd    := SQLCODE;\n         DBMS_OUTPUT.put_line(\n            TO_CHAR(SYSDATE, 'YYYY-MM-DD HH24:MI:SS     ') || '**********ERROR IN TABLE VERIFY BLOCK**********');\n         DBMS_OUTPUT.put_line(TO_CHAR(SYSDATE, 'YYYY-MM-DD HH24:MI:SS     ') || 'Error Message: ' || v_prcs_err_msg);\n         DBMS_OUTPUT.put_line(TO_CHAR(SYSDATE, 'YYYY-MM-DD HH24:MI:SS     ') || 'Error Code: ' || v_prcs_err_cd);\n         DBMS_OUTPUT.put_line(\n            TO_CHAR(SYSDATE, 'YYYY-MM-DD HH24:MI:SS     ') || '***********************************************');\n         RETURN 3;\n   END;\n\n   \n\n   BEGIN\n      v_prcs_stp   := 'Beginning MERGE...';\n      DBMS_OUTPUT.put_line(TO_CHAR(SYSDATE, 'YYYY-MM-DD HH24:MI:SS     ') || v_prcs_stp);\n\n      MERGE INTO de459e2fe7f96e4d958537b31b946b26.e134eedaf83e18e198cbf98be1cfca38 tgt\n           USING (  SELECT fwb_cyc_id,\n                           fwb_cyc_typ,\n                           fwb_cyc_nm,\n                           fwb_recmd_nm,\n                           \n\n                           MIN(strt_dt) strt_dt,\n                           MAX(eff_dt) eff_dt,\n                           TRUNC(crt_dt) crt_dt,\n                           crt_userid\n                      FROM de459e2fe7f96e4d958537b31b946b26.3ac217a6e67d8f0b8bacb7eae897ec01\n                     WHERE eff_dt >= TO_DATE(v_odate_str, 'YYYYMMDD')\n                       AND inact_dt IS NULL\n                  GROUP BY fwb_cyc_id,\n                           fwb_cyc_typ,\n                           fwb_cyc_nm,\n                           fwb_recmd_nm,\n                           \n                           TRUNC(crt_dt),\n                           crt_userid) src\n              ON (c87bbaf85002563e56e2c571e0e1c5a2.1d3f35cf8fe3d610d6c6d6282b3298f4 = a1fa0f79e78ad884522822d320ab5272.1d3f35cf8fe3d610d6c6d6282b3298f4\n              AND c87bbaf85002563e56e2c571e0e1c5a2.223b465d99ce0b2ddf59cb7c68e88cf6 = a1fa0f79e78ad884522822d320ab5272.223b465d99ce0b2ddf59cb7c68e88cf6)\n      WHEN MATCHED THEN\n         UPDATE SET c87bbaf85002563e56e2c571e0e1c5a2.bae319e6ce5336c7607b3d9c43450f6c   = a1fa0f79e78ad884522822d320ab5272.bae319e6ce5336c7607b3d9c43450f6c,\n                    \n                    c87bbaf85002563e56e2c571e0e1c5a2.991fe21b85ec11ac431b2cdceef32b44        = a1fa0f79e78ad884522822d320ab5272.991fe21b85ec11ac431b2cdceef32b44,\n                    c87bbaf85002563e56e2c571e0e1c5a2.797aa00fde2c4463b39b877aaafc02c4         = a1fa0f79e78ad884522822d320ab5272.797aa00fde2c4463b39b877aaafc02c4,\n                    c87bbaf85002563e56e2c571e0e1c5a2.44db07dca7893985ce87192c7f358f75         = a1fa0f79e78ad884522822d320ab5272.44db07dca7893985ce87192c7f358f75,\n                    c87bbaf85002563e56e2c571e0e1c5a2.44a3d91f316ab016d71762826e0b13fe     = a1fa0f79e78ad884522822d320ab5272.44a3d91f316ab016d71762826e0b13fe\n      WHEN NOT MATCHED THEN\n         INSERT            (fwb_cyc_id, fwb_cyc_typ, fwb_cyc_nm, fwb_recmd_nm, \n                                                                              strt_dt, eff_dt,\n                            crt_dt, crt_userid)\n             VALUES (a1fa0f79e78ad884522822d320ab5272.1d3f35cf8fe3d610d6c6d6282b3298f4,\n                     a1fa0f79e78ad884522822d320ab5272.223b465d99ce0b2ddf59cb7c68e88cf6,\n                     a1fa0f79e78ad884522822d320ab5272.855c24997cb811d7c5ea6695c83b0112,\n                     a1fa0f79e78ad884522822d320ab5272.bae319e6ce5336c7607b3d9c43450f6c,\n                     \n                     a1fa0f79e78ad884522822d320ab5272.991fe21b85ec11ac431b2cdceef32b44,\n                     a1fa0f79e78ad884522822d320ab5272.797aa00fde2c4463b39b877aaafc02c4,\n                     a1fa0f79e78ad884522822d320ab5272.44db07dca7893985ce87192c7f358f75,\n                     a1fa0f79e78ad884522822d320ab5272.44a3d91f316ab016d71762826e0b13fe);\n   \n\n\n   EXCEPTION\n      WHEN OTHERS THEN\n         v_prcs_err_msg   := SQLERRM;\n         v_prcs_err_cd    := SQLCODE;\n         DBMS_OUTPUT.put_line(\n            TO_CHAR(SYSDATE, 'YYYY-MM-DD HH24:MI:SS     ') || '**********ERROR IN MERGE BLOCK**********');\n         DBMS_OUTPUT.put_line(TO_CHAR(SYSDATE, 'YYYY-MM-DD HH24:MI:SS     ') || 'Error Message: ' || v_prcs_err_msg);\n         DBMS_OUTPUT.put_line(TO_CHAR(SYSDATE, 'YYYY-MM-DD HH24:MI:SS     ') || 'Error Code: ' || v_prcs_err_cd);\n         DBMS_OUTPUT.put_line(\n            TO_CHAR(SYSDATE, 'YYYY-MM-DD HH24:MI:SS     ') || '****************************************');\n         ROLLBACK;\n         RETURN 4;\n   END;\n\n   v_prcs_stp   := 'Function Completed Successfully:  ' || sql%ROWCOUNT || ' rows merged';\n   DBMS_OUTPUT.put_line(TO_CHAR(SYSDATE, 'YYYY-MM-DD HH24:MI:SS     ') || v_prcs_stp);\n\n   COMMIT;\n   RETURN 0;\nEXCEPTION\n   WHEN OTHERS THEN\n      v_prcs_err_msg   := SQLERRM;\n      v_prcs_err_cd    := SQLCODE;\n      DBMS_OUTPUT.put_line(TO_CHAR(SYSDATE, 'YYYY-MM-DD HH24:MI:SS     ') || '**********GENERAL ERROR**********');\n      DBMS_OUTPUT.put_line(TO_CHAR(SYSDATE, 'YYYY-MM-DD HH24:MI:SS     ') || 'Error Message: ' || v_prcs_err_msg);\n      DBMS_OUTPUT.put_line(TO_CHAR(SYSDATE, 'YYYY-MM-DD HH24:MI:SS     ') || 'Error Code: ' || v_prcs_err_cd);\n      DBMS_OUTPUT.put_line(TO_CHAR(SYSDATE, 'YYYY-MM-DD HH24:MI:SS     ') || '*********************************');\n\n      ROLLBACK;\n\n      RETURN 5;\nEND fn_fwb_cycle_load;\n/",
            "upstream_dependencies": [],
            "downstream_dependencies": [],
            "dag_location": "null",
            "gantt_location": "null",
            "created_at": "null",
            "updated_at": "null"
        },
        {
            "name": "FN_ACQSTN_AGGR_LOAD",
            "encrypted_name": "3eef0a9f26803c56343159adeaca10f8a7d2c123ab08f9acde20fb7e42f4f726",
            "type": "function",
            "database": "null",
            "encrypted_database": "null",
            "schema": "XDMADM",
            "encrypted_schema": "0e03d5c46556a742ba46252698396ef2",
            "fully_qualified_name": "XDMADM.FN_ACQSTN_AGGR_LOAD",
            "encrypted_fqn": "0e03d5c46556a742ba46252698396ef2.3eef0a9f26803c56343159adeaca10f8a7d2c123ab08f9acde20fb7e42f4f726",
            "synonyms": [],
            "metadata_analysis": "CREATE OR REPLACE FUNCTION \"0e03d5c46556a742ba46252698396ef2\".\"3eef0a9f26803c56343159adeaca10f8a7d2c123ab08f9acde20fb7e42f4f726\" (odate IN DATE)\n   RETURN NUMBER IS\n   \n   con_process_name    CONSTANT VARCHAR2(40) := 'FN_ACQSTN_AGGR_LOAD';\n   v_table_owner       VARCHAR2(40) := 'XDMADM';\n   v_table_nm          VARCHAR2(40) := 'ACQSTN_AGGR';\n   v_prcs_nm           VARCHAR2(100);\n   v_prcs_stp          VARCHAR2(100);\n   v_out_msg           VARCHAR2(256);\n   v_truncate_tbl      NUMBER(3);\n   v_acqstn_corp_cnt   NUMBER := 0;\n   v_acqstn_aggr_cnt   NUMBER := 0;\n   v_base_cnt          NUMBER := 0;\n   v_base_cases_cnt    NUMBER;\n   v_base_sales        NUMBER;\n   v_aggr_cases_cnt    NUMBER;\n   v_aggr_sales        NUMBER;\n   v_curr_yr           NUMBER(4);\n   v_curr_yr_minus1yr  NUMBER(4);\n   v_return_code       NUMBER := 0;\n   l_aggr_insert       VARCHAR2(32000);\n   l_insert_cnt        NUMBER;\n   l_insert_shrd_cnt   NUMBER;\n   l_fn_start          DATE;\n   l_fisc_yr_wk        VARCHAR2(18 BYTE);\n   e_analyze_table exception;\n   all_exceptions exception;\n\n\n\n\nBEGIN\n   v_prcs_nm        := con_process_name;\n   v_prcs_stp       := 'Start Process';\n   DBMS_OUTPUT.put_line('Start Time:' || TO_CHAR(SYSDATE, 'YYYY-MM-DD HH24:MI:SS'));\n\n   \n   \n   \n\n   DBMS_OUTPUT.put_line('Truncating/Deleting records from 0e03d5c46556a742ba46252698396ef2.69946ec4ed2cfdf1999258c0448b6080');\n\n   v_truncate_tbl   := 8e64339f96bb08058f5d52f1c04f954a.8ffe4678890c39c7d4ed38c2ed759e24.e4b5db2b3f9b19accbb8cddbfcd05bac(v_out_msg, v_table_owner, v_table_nm);\n\n   DBMS_OUTPUT.put_line(v_out_msg);\n\n   IF v_truncate_tbl != 0 THEN\n      DBMS_OUTPUT.put_line('Error in Truncating the ' || v_table_nm || ' table');\n      RAISE all_exceptions;\n   END IF;\n\n   DBMS_OUTPUT.put_line('0e03d5c46556a742ba46252698396ef2.69946ec4ed2cfdf1999258c0448b6080 table truncated successfully');\n\n   \n   \n   \n\n   \n   l_fn_start       := SYSDATE;\n\n   \n   \n   \n\n   SELECT fisc_yr,fisc_yr-1\n   INTO  v_curr_yr,v_curr_yr_minus1yr\n     FROM de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001\n    WHERE clndr_dt =  odate;\n\n   DBMS_OUTPUT.put_line('v_curr_yr = ' || v_curr_yr);\n\n  \n   DBMS_OUTPUT.put_line('v_curr_yr_minus1yr = ' || v_curr_yr_minus1yr);\n\n   \n   \n   \n\n   BEGIN\n      DBMS_OUTPUT.put_line('Inserting Rows into 0e03d5c46556a742ba46252698396ef2.69946ec4ed2cfdf1999258c0448b6080 table');\n\n      INSERT \n            INTO de459e2fe7f96e4d958537b31b946b26.69946ec4ed2cfdf1999258c0448b6080(div_nbr, prcs_dt, pyr_seg_cd, cust_acqstn_stat_actl, cust_acqstn_div_nbr,\n                                    unfrm_qty_ship,\n                                                 unfrm_qty_ship_ly,\n                                                          grs_tgp,\n                                                                  grs_tgp_ly)\n WITH base_sls\n     AS (  SELECT \n                  0e03d5c46556a742ba46252698396ef2.ba895e03efb94ae98b1f05b09c21d08b.839c4ffb4bfaae1bb58eab4dee67d96a,\n                  de459e2fe7f96e4d958537b31b946b26.52982d3bbc1ebc2720d9504c7ea2ed3f.852fa1e9f02f1ca2c75837f7146b2381,\n                  0e03d5c46556a742ba46252698396ef2.1609b28739e207519049a2cf090bfd19.b6935cb812047e6ad9836a4d84b74f28,\n                  0e03d5c46556a742ba46252698396ef2.1609b28739e207519049a2cf090bfd19.7953dad27b9ff5d770ad768175bcaa56,\n                  NVL (7bbc500993f8c1384ba73fe9d8ff44f8.c712a9ab5ef100c5807fa96123dac48b, 'USF') sls_org,\n                  SUM (0e03d5c46556a742ba46252698396ef2.744733b0938dd8b442c799cb31a8176d.66fc553d154587c127728f14e8997e5a) AS base_UNFRM_QTY_SHIP,\n                  SUM(NVL((0e03d5c46556a742ba46252698396ef2.744733b0938dd8b442c799cb31a8176d.2ee1400a0150f0b220dd7bd6268d1e66 - 0e03d5c46556a742ba46252698396ef2.744733b0938dd8b442c799cb31a8176d.c6c7cc45578c678907522e08bb04a4ca) - (CASE WHEN 0e03d5c46556a742ba46252698396ef2.744733b0938dd8b442c799cb31a8176d.487c194c34aee6c67551aa2cdd2358ace32f6dd38f333cde68119d1f277367cd = 'P' THEN NVL(0e03d5c46556a742ba46252698396ef2.744733b0938dd8b442c799cb31a8176d.d206d123f59f85e26ec113e33b465295,0) ELSE 0 END) + (0e03d5c46556a742ba46252698396ef2.744733b0938dd8b442c799cb31a8176d.b7982b81d447f11a0953881190e528cae32f6dd38f333cde68119d1f277367cd), 0)) base_grs_tgp\n             FROM 0e03d5c46556a742ba46252698396ef2.ba895e03efb94ae98b1f05b09c21d08b div,\n                  0e03d5c46556a742ba46252698396ef2.66613dfc6f78c05df904895d31551d61 pim,\n                  0e03d5c46556a742ba46252698396ef2.8d75a8f2ab4850b84709184da29f9cdb acq_div,\n                  0e03d5c46556a742ba46252698396ef2.8d75a8f2ab4850b84709184da29f9cdb rev_div,\n                  0e03d5c46556a742ba46252698396ef2.e869ae975d524d2ee7be81b5d832da80 cust,\n                  0e03d5c46556a742ba46252698396ef2.1609b28739e207519049a2cf090bfd19 tm,\n                  0e03d5c46556a742ba46252698396ef2.744733b0938dd8b442c799cb31a8176d sls\n            WHERE     7bbc500993f8c1384ba73fe9d8ff44f8.9390381abcb131475214e65c6374a79c NOT IN ('CC')\n                  AND 7bbc500993f8c1384ba73fe9d8ff44f8.4fdc122fb2d10dd764e32cbc98972eca =\n                         NVL (0e03d5c46556a742ba46252698396ef2.744733b0938dd8b442c799cb31a8176d.dd95a4741b2ab36b2428b3c42ef8b0448cd47113485ed05c776655af504ed664, 0e03d5c46556a742ba46252698396ef2.744733b0938dd8b442c799cb31a8176d.4fdc122fb2d10dd764e32cbc98972eca)\n                  AND 0e03d5c46556a742ba46252698396ef2.744733b0938dd8b442c799cb31a8176d.157c48272056e529c950ffdfaf3d08457a4c85629563c6f5e8cfd6c776d09466 = 0e03d5c46556a742ba46252698396ef2.66613dfc6f78c05df904895d31551d61.157c48272056e529c950ffdfaf3d08457a4c85629563c6f5e8cfd6c776d09466\n                  AND 0e03d5c46556a742ba46252698396ef2.744733b0938dd8b442c799cb31a8176d.902b48cba39dd1df9f7d50635277b70c = 0e03d5c46556a742ba46252698396ef2.1609b28739e207519049a2cf090bfd19.685f02b2cc5f46d05942f765fa918af7\n                  AND 0e03d5c46556a742ba46252698396ef2.744733b0938dd8b442c799cb31a8176d.9f055ebf334db6c50bbcab4ff14bd2ae = de459e2fe7f96e4d958537b31b946b26.52982d3bbc1ebc2720d9504c7ea2ed3f.9f055ebf334db6c50bbcab4ff14bd2ae\n                  AND 0e03d5c46556a742ba46252698396ef2.744733b0938dd8b442c799cb31a8176d.4fdc122fb2d10dd764e32cbc98972eca = de459e2fe7f96e4d958537b31b946b26.52982d3bbc1ebc2720d9504c7ea2ed3f.4fdc122fb2d10dd764e32cbc98972eca\n                  AND 0e03d5c46556a742ba46252698396ef2.744733b0938dd8b442c799cb31a8176d.4fdc122fb2d10dd764e32cbc98972eca = 0e03d5c46556a742ba46252698396ef2.ba895e03efb94ae98b1f05b09c21d08b.4fdc122fb2d10dd764e32cbc98972eca\n                  AND 0e03d5c46556a742ba46252698396ef2.744733b0938dd8b442c799cb31a8176d.467a168a7499c57b1859198a7dac7be0 IS NULL\n                  AND a7b4f3424a71c5fa35e0c3ff5021ef1d.4fdc122fb2d10dd764e32cbc98972eca =\n                         NVL (de459e2fe7f96e4d958537b31b946b26.52982d3bbc1ebc2720d9504c7ea2ed3f.0fe944dba32450408a2199bdec16781b8cd47113485ed05c776655af504ed664, de459e2fe7f96e4d958537b31b946b26.52982d3bbc1ebc2720d9504c7ea2ed3f.4fdc122fb2d10dd764e32cbc98972eca)\n                  AND de459e2fe7f96e4d958537b31b946b26.52982d3bbc1ebc2720d9504c7ea2ed3f.a9ac0322f049637317bfc9c6b776a93eee1cdc4e707d028a90faf50643aa7ba3 IN ('NEW/SHARED', 'SHARED')\n                  AND de459e2fe7f96e4d958537b31b946b26.52982d3bbc1ebc2720d9504c7ea2ed3f.9feb6ea9dd58e36310db41f9e4a62b9e = '1'\n                  AND 0e03d5c46556a742ba46252698396ef2.ba895e03efb94ae98b1f05b09c21d08b.9390381abcb131475214e65c6374a79c = 'USF'\n                  AND (0e03d5c46556a742ba46252698396ef2.66613dfc6f78c05df904895d31551d61.9bc4cd136e286b2a5551adc7c1960a4a <> 97 OR 0e03d5c46556a742ba46252698396ef2.66613dfc6f78c05df904895d31551d61.9bc4cd136e286b2a5551adc7c1960a4a IS NULL)\n                  AND 0e03d5c46556a742ba46252698396ef2.1609b28739e207519049a2cf090bfd19.ab30d6d679879cfacfe389b97d1d3f0e = v_curr_yr_minus1yr\n                  AND NVL (7bbc500993f8c1384ba73fe9d8ff44f8.c712a9ab5ef100c5807fa96123dac48b, 'USF') = 'USF'\n         GROUP BY 0e03d5c46556a742ba46252698396ef2.ba895e03efb94ae98b1f05b09c21d08b.839c4ffb4bfaae1bb58eab4dee67d96a,\n                  de459e2fe7f96e4d958537b31b946b26.52982d3bbc1ebc2720d9504c7ea2ed3f.852fa1e9f02f1ca2c75837f7146b2381,\n                  0e03d5c46556a742ba46252698396ef2.1609b28739e207519049a2cf090bfd19.b6935cb812047e6ad9836a4d84b74f28,\n                  0e03d5c46556a742ba46252698396ef2.1609b28739e207519049a2cf090bfd19.7953dad27b9ff5d770ad768175bcaa56,\n                  NVL (7bbc500993f8c1384ba73fe9d8ff44f8.c712a9ab5ef100c5807fa96123dac48b, 'USF')\n                  ),\n     ly_Sls\n     AS (  SELECT \n                 0e03d5c46556a742ba46252698396ef2.ba895e03efb94ae98b1f05b09c21d08b.839c4ffb4bfaae1bb58eab4dee67d96a,\n                  de459e2fe7f96e4d958537b31b946b26.52982d3bbc1ebc2720d9504c7ea2ed3f.852fa1e9f02f1ca2c75837f7146b2381,\n                  0e03d5c46556a742ba46252698396ef2.1609b28739e207519049a2cf090bfd19.b6935cb812047e6ad9836a4d84b74f28,\n                  0e03d5c46556a742ba46252698396ef2.1609b28739e207519049a2cf090bfd19.7953dad27b9ff5d770ad768175bcaa56,\n                  NVL (7bbc500993f8c1384ba73fe9d8ff44f8.c712a9ab5ef100c5807fa96123dac48b, 'USF') sls_org,\n                  SUM (UNFRM_QTY_SHIP) AS UNFRM_QTY_SHIP,\n                  SUM (case when de459e2fe7f96e4d958537b31b946b26.52982d3bbc1ebc2720d9504c7ea2ed3f.2868c06b5395c627547ddf73185989c45479098e904da91bb293c4391be1730d in ('SHARED','NEW/SHARED') and NVL (7bbc500993f8c1384ba73fe9d8ff44f8.c712a9ab5ef100c5807fa96123dac48b, 'USF') = 'USF' then UNFRM_QTY_SHIP else 0 end) AS SU_UNFRM_QTY_SHIP,\n                  SUM(NVL((0e03d5c46556a742ba46252698396ef2.744733b0938dd8b442c799cb31a8176d.2ee1400a0150f0b220dd7bd6268d1e66 - 0e03d5c46556a742ba46252698396ef2.744733b0938dd8b442c799cb31a8176d.c6c7cc45578c678907522e08bb04a4ca) - (CASE WHEN 0e03d5c46556a742ba46252698396ef2.744733b0938dd8b442c799cb31a8176d.487c194c34aee6c67551aa2cdd2358ace32f6dd38f333cde68119d1f277367cd = 'P' THEN NVL(0e03d5c46556a742ba46252698396ef2.744733b0938dd8b442c799cb31a8176d.d206d123f59f85e26ec113e33b465295,0) ELSE 0 END) + (0e03d5c46556a742ba46252698396ef2.744733b0938dd8b442c799cb31a8176d.b7982b81d447f11a0953881190e528cae32f6dd38f333cde68119d1f277367cd), 0)) grs_tgp,\n                  SUM(case when de459e2fe7f96e4d958537b31b946b26.52982d3bbc1ebc2720d9504c7ea2ed3f.2868c06b5395c627547ddf73185989c45479098e904da91bb293c4391be1730d in ('SHARED','NEW/SHARED') and NVL (7bbc500993f8c1384ba73fe9d8ff44f8.c712a9ab5ef100c5807fa96123dac48b, 'USF') = 'USF' then NVL((0e03d5c46556a742ba46252698396ef2.744733b0938dd8b442c799cb31a8176d.2ee1400a0150f0b220dd7bd6268d1e66 - 0e03d5c46556a742ba46252698396ef2.744733b0938dd8b442c799cb31a8176d.c6c7cc45578c678907522e08bb04a4ca) - (CASE WHEN 0e03d5c46556a742ba46252698396ef2.744733b0938dd8b442c799cb31a8176d.487c194c34aee6c67551aa2cdd2358ace32f6dd38f333cde68119d1f277367cd = 'P' THEN NVL(0e03d5c46556a742ba46252698396ef2.744733b0938dd8b442c799cb31a8176d.d206d123f59f85e26ec113e33b465295,0) ELSE 0 END) + (0e03d5c46556a742ba46252698396ef2.744733b0938dd8b442c799cb31a8176d.b7982b81d447f11a0953881190e528cae32f6dd38f333cde68119d1f277367cd), 0) else 0 end ) su_grs_tgp\n             FROM 0e03d5c46556a742ba46252698396ef2.ba895e03efb94ae98b1f05b09c21d08b div\n                                         ,\n                  0e03d5c46556a742ba46252698396ef2.66613dfc6f78c05df904895d31551d61 pim\n                                     ,\n                  0e03d5c46556a742ba46252698396ef2.8d75a8f2ab4850b84709184da29f9cdb acq_div\n                                         ,\n                  0e03d5c46556a742ba46252698396ef2.8d75a8f2ab4850b84709184da29f9cdb rev_div\n                                         ,\n                  0e03d5c46556a742ba46252698396ef2.e869ae975d524d2ee7be81b5d832da80 cust\n                                       ,\n                  0e03d5c46556a742ba46252698396ef2.1609b28739e207519049a2cf090bfd19 tm\n                                     ,\n                  0e03d5c46556a742ba46252698396ef2.744733b0938dd8b442c799cb31a8176d sls\n            WHERE     7bbc500993f8c1384ba73fe9d8ff44f8.9390381abcb131475214e65c6374a79c NOT IN ('CC')\n                  AND 7bbc500993f8c1384ba73fe9d8ff44f8.4fdc122fb2d10dd764e32cbc98972eca =\n                         NVL (0e03d5c46556a742ba46252698396ef2.744733b0938dd8b442c799cb31a8176d.dd95a4741b2ab36b2428b3c42ef8b0448cd47113485ed05c776655af504ed664, 0e03d5c46556a742ba46252698396ef2.744733b0938dd8b442c799cb31a8176d.4fdc122fb2d10dd764e32cbc98972eca)\n                  AND 0e03d5c46556a742ba46252698396ef2.744733b0938dd8b442c799cb31a8176d.157c48272056e529c950ffdfaf3d08457a4c85629563c6f5e8cfd6c776d09466 = 0e03d5c46556a742ba46252698396ef2.66613dfc6f78c05df904895d31551d61.157c48272056e529c950ffdfaf3d08457a4c85629563c6f5e8cfd6c776d09466\n                  AND 0e03d5c46556a742ba46252698396ef2.744733b0938dd8b442c799cb31a8176d.902b48cba39dd1df9f7d50635277b70c = 0e03d5c46556a742ba46252698396ef2.1609b28739e207519049a2cf090bfd19.685f02b2cc5f46d05942f765fa918af7\n                  AND 0e03d5c46556a742ba46252698396ef2.744733b0938dd8b442c799cb31a8176d.9f055ebf334db6c50bbcab4ff14bd2ae = de459e2fe7f96e4d958537b31b946b26.52982d3bbc1ebc2720d9504c7ea2ed3f.9f055ebf334db6c50bbcab4ff14bd2ae\n                  AND 0e03d5c46556a742ba46252698396ef2.744733b0938dd8b442c799cb31a8176d.4fdc122fb2d10dd764e32cbc98972eca = de459e2fe7f96e4d958537b31b946b26.52982d3bbc1ebc2720d9504c7ea2ed3f.4fdc122fb2d10dd764e32cbc98972eca\n                  AND 0e03d5c46556a742ba46252698396ef2.744733b0938dd8b442c799cb31a8176d.4fdc122fb2d10dd764e32cbc98972eca = 0e03d5c46556a742ba46252698396ef2.ba895e03efb94ae98b1f05b09c21d08b.4fdc122fb2d10dd764e32cbc98972eca\n                  AND 0e03d5c46556a742ba46252698396ef2.744733b0938dd8b442c799cb31a8176d.467a168a7499c57b1859198a7dac7be0 IS NULL\n                  AND a7b4f3424a71c5fa35e0c3ff5021ef1d.4fdc122fb2d10dd764e32cbc98972eca =\n                         NVL (de459e2fe7f96e4d958537b31b946b26.52982d3bbc1ebc2720d9504c7ea2ed3f.0fe944dba32450408a2199bdec16781b8cd47113485ed05c776655af504ed664, de459e2fe7f96e4d958537b31b946b26.52982d3bbc1ebc2720d9504c7ea2ed3f.4fdc122fb2d10dd764e32cbc98972eca)\n                  AND de459e2fe7f96e4d958537b31b946b26.52982d3bbc1ebc2720d9504c7ea2ed3f.9feb6ea9dd58e36310db41f9e4a62b9e = '1'\n                  AND 0e03d5c46556a742ba46252698396ef2.ba895e03efb94ae98b1f05b09c21d08b.9390381abcb131475214e65c6374a79c = 'USF'\n                  AND (0e03d5c46556a742ba46252698396ef2.66613dfc6f78c05df904895d31551d61.9bc4cd136e286b2a5551adc7c1960a4a <> 97 OR 0e03d5c46556a742ba46252698396ef2.66613dfc6f78c05df904895d31551d61.9bc4cd136e286b2a5551adc7c1960a4a IS NULL)\n                  AND 0e03d5c46556a742ba46252698396ef2.1609b28739e207519049a2cf090bfd19.ab30d6d679879cfacfe389b97d1d3f0e = v_curr_yr\n                  AND NVL (a7b4f3424a71c5fa35e0c3ff5021ef1d.c712a9ab5ef100c5807fa96123dac48b, 'USF') <> 'USF'\n                  AND de459e2fe7f96e4d958537b31b946b26.52982d3bbc1ebc2720d9504c7ea2ed3f.a9ac0322f049637317bfc9c6b776a93eee1cdc4e707d028a90faf50643aa7ba3 IN ('NEW/SHARED',\n                                                     'SHARED',\n                                                     'NEW')\n         GROUP BY 0e03d5c46556a742ba46252698396ef2.ba895e03efb94ae98b1f05b09c21d08b.839c4ffb4bfaae1bb58eab4dee67d96a,\n                  de459e2fe7f96e4d958537b31b946b26.52982d3bbc1ebc2720d9504c7ea2ed3f.852fa1e9f02f1ca2c75837f7146b2381,\n                  0e03d5c46556a742ba46252698396ef2.1609b28739e207519049a2cf090bfd19.b6935cb812047e6ad9836a4d84b74f28,\n                  0e03d5c46556a742ba46252698396ef2.1609b28739e207519049a2cf090bfd19.7953dad27b9ff5d770ad768175bcaa56,\n                  NVL (7bbc500993f8c1384ba73fe9d8ff44f8.c712a9ab5ef100c5807fa96123dac48b, 'USF')),\n\n     ly_sls_base\n     AS (  SELECT NVL (fe5019a7d8c018fa958980beb2b9cacc.839c4ffb4bfaae1bb58eab4dee67d96a, 99168e6e2dc7c06e57b768e9365da31f.839c4ffb4bfaae1bb58eab4dee67d96a) div_nbr,\n                  NVL (fe5019a7d8c018fa958980beb2b9cacc.852fa1e9f02f1ca2c75837f7146b2381, 99168e6e2dc7c06e57b768e9365da31f.852fa1e9f02f1ca2c75837f7146b2381) cust_nbr,\n                  NVL (fe5019a7d8c018fa958980beb2b9cacc.685f02b2cc5f46d05942f765fa918af7, 99168e6e2dc7c06e57b768e9365da31f.222ccb1d1746bcdb2365f29b3da0b613) clndr_dt_yrago,\n                  NVL (fe5019a7d8c018fa958980beb2b9cacc.b6935cb812047e6ad9836a4d84b74f28, de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.222ccb1d1746bcdb2365f29b3da0b613) clndr_dt,\n                  NVL (fe5019a7d8c018fa958980beb2b9cacc.8f4d6d8fa0113cadf5ac34c8cf7098b0, 99168e6e2dc7c06e57b768e9365da31f.8f4d6d8fa0113cadf5ac34c8cf7098b0) sls_org,\n                  nvl(SUM (fe5019a7d8c018fa958980beb2b9cacc.66fc553d154587c127728f14e8997e5a),0) UNFRM_QTY_SHIP,\n                  nvl(SUM (fe5019a7d8c018fa958980beb2b9cacc.6ed06b0aa5bbe9d8034b5e74f6aa13cdfe1273d196c209677ff154534715415c),0) su_UNFRM_QTY_SHIP,\n                  nvl(SUM (99168e6e2dc7c06e57b768e9365da31f.d27a73368586eae26f03fbfb0b184d57363120fb00aecc7c6043a8a905117997),0) base_UNFRM_QTY_SHIP,\n                  nvl(sum(fe5019a7d8c018fa958980beb2b9cacc.4f1272f7dffc94b9e882fd01e6907270),0) grs_tgp,\n                   nvl(sum(fe5019a7d8c018fa958980beb2b9cacc.dc58ac9596218470f7fe65d32ce72dd1),0) su_grs_tgp,\n                  nvl(sum(99168e6e2dc7c06e57b768e9365da31f.cce93b71369505895d2c3a4efc439cbe),0) base_grs_tgp\n             FROM ly_sls ls\n                  FULL OUTER JOIN base_sls bs\n                     ON (    fe5019a7d8c018fa958980beb2b9cacc.839c4ffb4bfaae1bb58eab4dee67d96a = 99168e6e2dc7c06e57b768e9365da31f.839c4ffb4bfaae1bb58eab4dee67d96a\n                         AND fe5019a7d8c018fa958980beb2b9cacc.852fa1e9f02f1ca2c75837f7146b2381 = 99168e6e2dc7c06e57b768e9365da31f.852fa1e9f02f1ca2c75837f7146b2381\n                         AND fe5019a7d8c018fa958980beb2b9cacc.685f02b2cc5f46d05942f765fa918af7 = 99168e6e2dc7c06e57b768e9365da31f.222ccb1d1746bcdb2365f29b3da0b613\n                         AND fe5019a7d8c018fa958980beb2b9cacc.8f4d6d8fa0113cadf5ac34c8cf7098b0 = 99168e6e2dc7c06e57b768e9365da31f.8f4d6d8fa0113cadf5ac34c8cf7098b0\n                         ) , de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001 t\n                                where nvl(99168e6e2dc7c06e57b768e9365da31f.222ccb1d1746bcdb2365f29b3da0b613,fe5019a7d8c018fa958980beb2b9cacc.685f02b2cc5f46d05942f765fa918af7) = de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.7953dad27b9ff5d770ad768175bcaa56\n         GROUP BY NVL (fe5019a7d8c018fa958980beb2b9cacc.839c4ffb4bfaae1bb58eab4dee67d96a, 99168e6e2dc7c06e57b768e9365da31f.839c4ffb4bfaae1bb58eab4dee67d96a),\n                  NVL (fe5019a7d8c018fa958980beb2b9cacc.852fa1e9f02f1ca2c75837f7146b2381, 99168e6e2dc7c06e57b768e9365da31f.852fa1e9f02f1ca2c75837f7146b2381),\n                  NVL (fe5019a7d8c018fa958980beb2b9cacc.685f02b2cc5f46d05942f765fa918af7, 99168e6e2dc7c06e57b768e9365da31f.222ccb1d1746bcdb2365f29b3da0b613),\n                  NVL (fe5019a7d8c018fa958980beb2b9cacc.b6935cb812047e6ad9836a4d84b74f28, de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.222ccb1d1746bcdb2365f29b3da0b613),\n                  NVL (fe5019a7d8c018fa958980beb2b9cacc.8f4d6d8fa0113cadf5ac34c8cf7098b0, 99168e6e2dc7c06e57b768e9365da31f.8f4d6d8fa0113cadf5ac34c8cf7098b0)),\n\n     TY_SLS\n     AS (  SELECT \n                 0e03d5c46556a742ba46252698396ef2.ba895e03efb94ae98b1f05b09c21d08b.839c4ffb4bfaae1bb58eab4dee67d96a,\n                  de459e2fe7f96e4d958537b31b946b26.52982d3bbc1ebc2720d9504c7ea2ed3f.852fa1e9f02f1ca2c75837f7146b2381,\n                  0e03d5c46556a742ba46252698396ef2.1609b28739e207519049a2cf090bfd19.b6935cb812047e6ad9836a4d84b74f28,\n                  0e03d5c46556a742ba46252698396ef2.1609b28739e207519049a2cf090bfd19.7953dad27b9ff5d770ad768175bcaa56,\n                  NVL (7bbc500993f8c1384ba73fe9d8ff44f8.c712a9ab5ef100c5807fa96123dac48b, 'USF') sls_org,\n                  SUM (UNFRM_QTY_SHIP) AS UNFRM_QTY_SHIP,\n                  SUM(NVL((0e03d5c46556a742ba46252698396ef2.744733b0938dd8b442c799cb31a8176d.2ee1400a0150f0b220dd7bd6268d1e66 - 0e03d5c46556a742ba46252698396ef2.744733b0938dd8b442c799cb31a8176d.c6c7cc45578c678907522e08bb04a4ca) - (CASE WHEN 0e03d5c46556a742ba46252698396ef2.744733b0938dd8b442c799cb31a8176d.487c194c34aee6c67551aa2cdd2358ace32f6dd38f333cde68119d1f277367cd = 'P' THEN NVL(0e03d5c46556a742ba46252698396ef2.744733b0938dd8b442c799cb31a8176d.d206d123f59f85e26ec113e33b465295,0) ELSE 0 END) + (0e03d5c46556a742ba46252698396ef2.744733b0938dd8b442c799cb31a8176d.b7982b81d447f11a0953881190e528cae32f6dd38f333cde68119d1f277367cd), 0)) grs_tgp\n             FROM 0e03d5c46556a742ba46252698396ef2.ba895e03efb94ae98b1f05b09c21d08b div\n                                         ,\n                  0e03d5c46556a742ba46252698396ef2.66613dfc6f78c05df904895d31551d61 pim\n                                     ,\n                  0e03d5c46556a742ba46252698396ef2.8d75a8f2ab4850b84709184da29f9cdb acq_div\n                                         ,\n                  0e03d5c46556a742ba46252698396ef2.8d75a8f2ab4850b84709184da29f9cdb rev_div\n                                         ,\n                  0e03d5c46556a742ba46252698396ef2.e869ae975d524d2ee7be81b5d832da80 cust\n                                       ,\n                  0e03d5c46556a742ba46252698396ef2.1609b28739e207519049a2cf090bfd19 tm\n                                     ,\n                  0e03d5c46556a742ba46252698396ef2.744733b0938dd8b442c799cb31a8176d sls\n            WHERE     7bbc500993f8c1384ba73fe9d8ff44f8.9390381abcb131475214e65c6374a79c NOT IN ('CC')\n                  AND 7bbc500993f8c1384ba73fe9d8ff44f8.4fdc122fb2d10dd764e32cbc98972eca =\n                         NVL (0e03d5c46556a742ba46252698396ef2.744733b0938dd8b442c799cb31a8176d.dd95a4741b2ab36b2428b3c42ef8b0448cd47113485ed05c776655af504ed664, 0e03d5c46556a742ba46252698396ef2.744733b0938dd8b442c799cb31a8176d.4fdc122fb2d10dd764e32cbc98972eca)\n                  AND 0e03d5c46556a742ba46252698396ef2.744733b0938dd8b442c799cb31a8176d.157c48272056e529c950ffdfaf3d08457a4c85629563c6f5e8cfd6c776d09466 = 0e03d5c46556a742ba46252698396ef2.66613dfc6f78c05df904895d31551d61.157c48272056e529c950ffdfaf3d08457a4c85629563c6f5e8cfd6c776d09466\n                  AND 0e03d5c46556a742ba46252698396ef2.744733b0938dd8b442c799cb31a8176d.902b48cba39dd1df9f7d50635277b70c = 0e03d5c46556a742ba46252698396ef2.1609b28739e207519049a2cf090bfd19.b6935cb812047e6ad9836a4d84b74f28\n                  AND 0e03d5c46556a742ba46252698396ef2.744733b0938dd8b442c799cb31a8176d.9f055ebf334db6c50bbcab4ff14bd2ae = de459e2fe7f96e4d958537b31b946b26.52982d3bbc1ebc2720d9504c7ea2ed3f.9f055ebf334db6c50bbcab4ff14bd2ae\n                  AND 0e03d5c46556a742ba46252698396ef2.744733b0938dd8b442c799cb31a8176d.4fdc122fb2d10dd764e32cbc98972eca = de459e2fe7f96e4d958537b31b946b26.52982d3bbc1ebc2720d9504c7ea2ed3f.4fdc122fb2d10dd764e32cbc98972eca\n                  AND 0e03d5c46556a742ba46252698396ef2.744733b0938dd8b442c799cb31a8176d.4fdc122fb2d10dd764e32cbc98972eca = 0e03d5c46556a742ba46252698396ef2.ba895e03efb94ae98b1f05b09c21d08b.4fdc122fb2d10dd764e32cbc98972eca\n                  AND 0e03d5c46556a742ba46252698396ef2.744733b0938dd8b442c799cb31a8176d.467a168a7499c57b1859198a7dac7be0 IS NULL\n                  AND a7b4f3424a71c5fa35e0c3ff5021ef1d.4fdc122fb2d10dd764e32cbc98972eca =\n                         NVL (de459e2fe7f96e4d958537b31b946b26.52982d3bbc1ebc2720d9504c7ea2ed3f.0fe944dba32450408a2199bdec16781b8cd47113485ed05c776655af504ed664, de459e2fe7f96e4d958537b31b946b26.52982d3bbc1ebc2720d9504c7ea2ed3f.4fdc122fb2d10dd764e32cbc98972eca)\n                  AND de459e2fe7f96e4d958537b31b946b26.52982d3bbc1ebc2720d9504c7ea2ed3f.9feb6ea9dd58e36310db41f9e4a62b9e = '1'\n                  AND 0e03d5c46556a742ba46252698396ef2.ba895e03efb94ae98b1f05b09c21d08b.9390381abcb131475214e65c6374a79c = 'USF'\n                  AND (0e03d5c46556a742ba46252698396ef2.66613dfc6f78c05df904895d31551d61.9bc4cd136e286b2a5551adc7c1960a4a <> 97 OR 0e03d5c46556a742ba46252698396ef2.66613dfc6f78c05df904895d31551d61.9bc4cd136e286b2a5551adc7c1960a4a IS NULL)\n                  AND 0e03d5c46556a742ba46252698396ef2.1609b28739e207519049a2cf090bfd19.222ccb1d1746bcdb2365f29b3da0b613 <= odate\n                  AND 0e03d5c46556a742ba46252698396ef2.1609b28739e207519049a2cf090bfd19.ab30d6d679879cfacfe389b97d1d3f0e = v_curr_yr\n                  AND NVL (a7b4f3424a71c5fa35e0c3ff5021ef1d.c712a9ab5ef100c5807fa96123dac48b, 'USF') <> 'USF'\n                  AND de459e2fe7f96e4d958537b31b946b26.52982d3bbc1ebc2720d9504c7ea2ed3f.a9ac0322f049637317bfc9c6b776a93eee1cdc4e707d028a90faf50643aa7ba3 IN ('NEW/SHARED',\n                                                     'SHARED',\n                                                     'NEW')\n         GROUP BY 0e03d5c46556a742ba46252698396ef2.ba895e03efb94ae98b1f05b09c21d08b.839c4ffb4bfaae1bb58eab4dee67d96a,\n                  de459e2fe7f96e4d958537b31b946b26.52982d3bbc1ebc2720d9504c7ea2ed3f.852fa1e9f02f1ca2c75837f7146b2381,\n                  0e03d5c46556a742ba46252698396ef2.1609b28739e207519049a2cf090bfd19.b6935cb812047e6ad9836a4d84b74f28,\n                  0e03d5c46556a742ba46252698396ef2.1609b28739e207519049a2cf090bfd19.7953dad27b9ff5d770ad768175bcaa56,\n                  NVL (7bbc500993f8c1384ba73fe9d8ff44f8.c712a9ab5ef100c5807fa96123dac48b, 'USF')\n                  )\n  SELECT NVL (553b3981cf791bcd71b2b504a2ec83d3.839c4ffb4bfaae1bb58eab4dee67d96a, d86c4297d1dfa4940a5f9895871a4cb2.839c4ffb4bfaae1bb58eab4dee67d96a) div_nbr,\n         NVL (553b3981cf791bcd71b2b504a2ec83d3.b6935cb812047e6ad9836a4d84b74f28, d86c4297d1dfa4940a5f9895871a4cb2.222ccb1d1746bcdb2365f29b3da0b613) clndr_dt,\n         de459e2fe7f96e4d958537b31b946b26.52982d3bbc1ebc2720d9504c7ea2ed3f.156f54b388a4986aa3d3d8e74d0fc0cd,\n         de459e2fe7f96e4d958537b31b946b26.52982d3bbc1ebc2720d9504c7ea2ed3f.2868c06b5395c627547ddf73185989c45479098e904da91bb293c4391be1730d,\n         de459e2fe7f96e4d958537b31b946b26.52982d3bbc1ebc2720d9504c7ea2ed3f.c6beba6dee0b78f2b585fc0a5882fe9b61bbd7bc0d2d67c7d7b11cb0a8d18d03,\n         SUM (case when de459e2fe7f96e4d958537b31b946b26.52982d3bbc1ebc2720d9504c7ea2ed3f.6ec421913df99898efb43a7602717956ca7a896ae00545952f4724f089603b58 is not null and NVL (d86c4297d1dfa4940a5f9895871a4cb2.b6935cb812047e6ad9836a4d84b74f28, 553b3981cf791bcd71b2b504a2ec83d3.222ccb1d1746bcdb2365f29b3da0b613) > de459e2fe7f96e4d958537b31b946b26.52982d3bbc1ebc2720d9504c7ea2ed3f.f8da58fcaeae111be63b687aae6fe1cc+365 then nvl(d86c4297d1dfa4940a5f9895871a4cb2.66fc553d154587c127728f14e8997e5a,0) - nvl(553b3981cf791bcd71b2b504a2ec83d3.d27a73368586eae26f03fbfb0b184d57363120fb00aecc7c6043a8a905117997,0) else case when NVL(553b3981cf791bcd71b2b504a2ec83d3.b6935cb812047e6ad9836a4d84b74f28, d86c4297d1dfa4940a5f9895871a4cb2.222ccb1d1746bcdb2365f29b3da0b613) >= de459e2fe7f96e4d958537b31b946b26.52982d3bbc1ebc2720d9504c7ea2ed3f.6ec421913df99898efb43a7602717956ca7a896ae00545952f4724f089603b58 then nvl(d86c4297d1dfa4940a5f9895871a4cb2.66fc553d154587c127728f14e8997e5a,0) - nvl(553b3981cf791bcd71b2b504a2ec83d3.6ed06b0aa5bbe9d8034b5e74f6aa13cdfe1273d196c209677ff154534715415c,0) else case when nvl(d86c4297d1dfa4940a5f9895871a4cb2.8f4d6d8fa0113cadf5ac34c8cf7098b0,553b3981cf791bcd71b2b504a2ec83d3.8f4d6d8fa0113cadf5ac34c8cf7098b0) <> 'USF' then nvl(d86c4297d1dfa4940a5f9895871a4cb2.66fc553d154587c127728f14e8997e5a,0) else 0 end end end) UNFRM_QTY_SHIP,\n         SUM (case when de459e2fe7f96e4d958537b31b946b26.52982d3bbc1ebc2720d9504c7ea2ed3f.6ec421913df99898efb43a7602717956ca7a896ae00545952f4724f089603b58 < nvl(553b3981cf791bcd71b2b504a2ec83d3.7953dad27b9ff5d770ad768175bcaa56,d86c4297d1dfa4940a5f9895871a4cb2.7953dad27b9ff5d770ad768175bcaa56) then nvl(553b3981cf791bcd71b2b504a2ec83d3.66fc553d154587c127728f14e8997e5a,0) - nvl(553b3981cf791bcd71b2b504a2ec83d3.d27a73368586eae26f03fbfb0b184d57363120fb00aecc7c6043a8a905117997,0) else case when nvl(553b3981cf791bcd71b2b504a2ec83d3.8f4d6d8fa0113cadf5ac34c8cf7098b0,d86c4297d1dfa4940a5f9895871a4cb2.8f4d6d8fa0113cadf5ac34c8cf7098b0) <> 'USF' then nvl(553b3981cf791bcd71b2b504a2ec83d3.66fc553d154587c127728f14e8997e5a,0) else 0 end end) UNFRM_QTY_SHIP_LY,\n         SUM (case when de459e2fe7f96e4d958537b31b946b26.52982d3bbc1ebc2720d9504c7ea2ed3f.6ec421913df99898efb43a7602717956ca7a896ae00545952f4724f089603b58 is not null and nvl(d86c4297d1dfa4940a5f9895871a4cb2.222ccb1d1746bcdb2365f29b3da0b613,553b3981cf791bcd71b2b504a2ec83d3.222ccb1d1746bcdb2365f29b3da0b613) > de459e2fe7f96e4d958537b31b946b26.52982d3bbc1ebc2720d9504c7ea2ed3f.f8da58fcaeae111be63b687aae6fe1cc+365 then nvl(d86c4297d1dfa4940a5f9895871a4cb2.4f1272f7dffc94b9e882fd01e6907270,0) - nvl(553b3981cf791bcd71b2b504a2ec83d3.cce93b71369505895d2c3a4efc439cbe,0) else case when NVL(553b3981cf791bcd71b2b504a2ec83d3.b6935cb812047e6ad9836a4d84b74f28, d86c4297d1dfa4940a5f9895871a4cb2.222ccb1d1746bcdb2365f29b3da0b613) >= de459e2fe7f96e4d958537b31b946b26.52982d3bbc1ebc2720d9504c7ea2ed3f.6ec421913df99898efb43a7602717956ca7a896ae00545952f4724f089603b58 then nvl(d86c4297d1dfa4940a5f9895871a4cb2.4f1272f7dffc94b9e882fd01e6907270,0) - nvl(553b3981cf791bcd71b2b504a2ec83d3.dc58ac9596218470f7fe65d32ce72dd1,0) else case when nvl(d86c4297d1dfa4940a5f9895871a4cb2.8f4d6d8fa0113cadf5ac34c8cf7098b0,553b3981cf791bcd71b2b504a2ec83d3.8f4d6d8fa0113cadf5ac34c8cf7098b0) <> 'USF' then nvl(d86c4297d1dfa4940a5f9895871a4cb2.4f1272f7dffc94b9e882fd01e6907270,0) else 0 end end end) grs_tgp,\n         SUM (case when de459e2fe7f96e4d958537b31b946b26.52982d3bbc1ebc2720d9504c7ea2ed3f.6ec421913df99898efb43a7602717956ca7a896ae00545952f4724f089603b58 < nvl(553b3981cf791bcd71b2b504a2ec83d3.7953dad27b9ff5d770ad768175bcaa56,d86c4297d1dfa4940a5f9895871a4cb2.7953dad27b9ff5d770ad768175bcaa56) then nvl(553b3981cf791bcd71b2b504a2ec83d3.4f1272f7dffc94b9e882fd01e6907270,0) - nvl(553b3981cf791bcd71b2b504a2ec83d3.cce93b71369505895d2c3a4efc439cbe,0) else case when nvl(553b3981cf791bcd71b2b504a2ec83d3.8f4d6d8fa0113cadf5ac34c8cf7098b0,d86c4297d1dfa4940a5f9895871a4cb2.8f4d6d8fa0113cadf5ac34c8cf7098b0) <> 'USF' then nvl(553b3981cf791bcd71b2b504a2ec83d3.4f1272f7dffc94b9e882fd01e6907270,0) else 0 end end) grs_tgp_LY\n   FROM ly_sls_base lsb\n         FULL OUTER JOIN ty_sls ts\n            ON (    553b3981cf791bcd71b2b504a2ec83d3.839c4ffb4bfaae1bb58eab4dee67d96a = d86c4297d1dfa4940a5f9895871a4cb2.839c4ffb4bfaae1bb58eab4dee67d96a\n                AND 553b3981cf791bcd71b2b504a2ec83d3.852fa1e9f02f1ca2c75837f7146b2381 = d86c4297d1dfa4940a5f9895871a4cb2.852fa1e9f02f1ca2c75837f7146b2381\n                AND 553b3981cf791bcd71b2b504a2ec83d3.b6935cb812047e6ad9836a4d84b74f28 = d86c4297d1dfa4940a5f9895871a4cb2.222ccb1d1746bcdb2365f29b3da0b613\n                AND 553b3981cf791bcd71b2b504a2ec83d3.8f4d6d8fa0113cadf5ac34c8cf7098b0 = d86c4297d1dfa4940a5f9895871a4cb2.8f4d6d8fa0113cadf5ac34c8cf7098b0\n               ) , de459e2fe7f96e4d958537b31b946b26.52982d3bbc1ebc2720d9504c7ea2ed3f cust\n                where de459e2fe7f96e4d958537b31b946b26.52982d3bbc1ebc2720d9504c7ea2ed3f.839c4ffb4bfaae1bb58eab4dee67d96a = NVL (553b3981cf791bcd71b2b504a2ec83d3.839c4ffb4bfaae1bb58eab4dee67d96a, d86c4297d1dfa4940a5f9895871a4cb2.839c4ffb4bfaae1bb58eab4dee67d96a)\n                  and de459e2fe7f96e4d958537b31b946b26.52982d3bbc1ebc2720d9504c7ea2ed3f.852fa1e9f02f1ca2c75837f7146b2381 = NVL(553b3981cf791bcd71b2b504a2ec83d3.852fa1e9f02f1ca2c75837f7146b2381,d86c4297d1dfa4940a5f9895871a4cb2.852fa1e9f02f1ca2c75837f7146b2381)\nGROUP BY NVL (553b3981cf791bcd71b2b504a2ec83d3.839c4ffb4bfaae1bb58eab4dee67d96a, d86c4297d1dfa4940a5f9895871a4cb2.839c4ffb4bfaae1bb58eab4dee67d96a),\n         NVL (553b3981cf791bcd71b2b504a2ec83d3.b6935cb812047e6ad9836a4d84b74f28, d86c4297d1dfa4940a5f9895871a4cb2.222ccb1d1746bcdb2365f29b3da0b613),\n         de459e2fe7f96e4d958537b31b946b26.52982d3bbc1ebc2720d9504c7ea2ed3f.156f54b388a4986aa3d3d8e74d0fc0cd,\n         de459e2fe7f96e4d958537b31b946b26.52982d3bbc1ebc2720d9504c7ea2ed3f.2868c06b5395c627547ddf73185989c45479098e904da91bb293c4391be1730d,\n         de459e2fe7f96e4d958537b31b946b26.52982d3bbc1ebc2720d9504c7ea2ed3f.c6beba6dee0b78f2b585fc0a5882fe9b61bbd7bc0d2d67c7d7b11cb0a8d18d03;\n\n      l_insert_cnt        := sql%ROWCOUNT;\n      DBMS_OUTPUT.put_line(\n         'Inserted ' || l_insert_cnt || ' rows in ' || TO_CHAR(ROUND((SYSDATE - l_fn_start) * 86400)) || ' seconds');\n\n\n      COMMIT;\n      RETURN 0;\n   END;\n\n  \n  \n  \n  <<Wrap_Program>>\n   DBMS_OUTPUT.put_line('End Time:' || TO_CHAR(SYSDATE, 'YYYY-MM-DD HH24:MI:SS'));\n\n   v_prcs_stp       := 'Final Commit';\n\n   COMMIT;\n\n   RETURN 0;\n\n\n\nEXCEPTION\n   WHEN OTHERS THEN\n      DBMS_OUTPUT.put_line('Error in 0e03d5c46556a742ba46252698396ef2.f6b13127aaed8c2d5dab660e3592a8f909407c8b2e5a4583e4773894e4cae814:' || SQLCODE || ' ' || SQLERRM);\n      RETURN 1;\nEND;\n/",
            "upstream_dependencies": [],
            "downstream_dependencies": [],
            "dag_location": "null",
            "gantt_location": "null",
            "created_at": "null",
            "updated_at": "null"
        },
        {
            "name": "FN_XDM_SALES_MKTPLUS_AGGR_LOAD",
            "encrypted_name": "6171714221d0069ddcdc7b81983cee54dfa3c71a89585da450b005deb0a7b9c7",
            "type": "function",
            "database": "null",
            "encrypted_database": "null",
            "schema": "XDMADM",
            "encrypted_schema": "0e03d5c46556a742ba46252698396ef2",
            "fully_qualified_name": "XDMADM.FN_XDM_SALES_MKTPLUS_AGGR_LOAD",
            "encrypted_fqn": "0e03d5c46556a742ba46252698396ef2.6171714221d0069ddcdc7b81983cee54dfa3c71a89585da450b005deb0a7b9c7",
            "synonyms": [],
            "metadata_analysis": "CREATE OR REPLACE FUNCTION \"0e03d5c46556a742ba46252698396ef2\".\"6171714221d0069ddcdc7b81983cee54dfa3c71a89585da450b005deb0a7b9c7\" (\n   odate           IN VARCHAR2,\n   v_tbl_to_load   IN VARCHAR2\n)\n   RETURN NUMBER\n\nAS\n   max_fisc_yr_mth     0e03d5c46556a742ba46252698396ef2.476a877ff313a9e06b3ba262c317b001.2603c45be643e5cd8f9c6dad3bee6cb3%TYPE;\n   min_fisc_yr_mth     0e03d5c46556a742ba46252698396ef2.476a877ff313a9e06b3ba262c317b001.2603c45be643e5cd8f9c6dad3bee6cb3%TYPE;\n   FISC_YR_MTH_F       0e03d5c46556a742ba46252698396ef2.476a877ff313a9e06b3ba262c317b001.2603c45be643e5cd8f9c6dad3bee6cb3%TYPE;\n   net_sls_lwr_lmt     0e03d5c46556a742ba46252698396ef2.de40ae7be8b2eb3858d46af8d107f3db.4e4c064c6b37bfa7ee40a435e09d8a01%TYPE;\n   net_sls_upr_lmt     0e03d5c46556a742ba46252698396ef2.de40ae7be8b2eb3858d46af8d107f3db.4e4c064c6b37bfa7ee40a435e09d8a01%TYPE;\n   cogs_lwr_lmt        0e03d5c46556a742ba46252698396ef2.de40ae7be8b2eb3858d46af8d107f3db.4e4c064c6b37bfa7ee40a435e09d8a01%TYPE;\n   cogs_upr_lmt        0e03d5c46556a742ba46252698396ef2.de40ae7be8b2eb3858d46af8d107f3db.4e4c064c6b37bfa7ee40a435e09d8a01%TYPE;\n   p_start_date        0e03d5c46556a742ba46252698396ef2.476a877ff313a9e06b3ba262c317b001.222ccb1d1746bcdb2365f29b3da0b613%TYPE;\n   p_end_date          0e03d5c46556a742ba46252698396ef2.476a877ff313a9e06b3ba262c317b001.222ccb1d1746bcdb2365f29b3da0b613%TYPE;\n   p_min_fisc_yr_mth   0e03d5c46556a742ba46252698396ef2.476a877ff313a9e06b3ba262c317b001.2603c45be643e5cd8f9c6dad3bee6cb3%TYPE;\n   p_max_fisc_yr_mth   0e03d5c46556a742ba46252698396ef2.476a877ff313a9e06b3ba262c317b001.2603c45be643e5cd8f9c6dad3bee6cb3%TYPE;\n   newest_mp_data      0e03d5c46556a742ba46252698396ef2.fcc55a82da91e429eaffc482050485ebe472b097974b0d6a9a7d2ed170324906.2603c45be643e5cd8f9c6dad3bee6cb3%TYPE;\n   oldest_mp_data      0e03d5c46556a742ba46252698396ef2.fcc55a82da91e429eaffc482050485ebe472b097974b0d6a9a7d2ed170324906.2603c45be643e5cd8f9c6dad3bee6cb3%TYPE;\n   v_sql               VARCHAR2 (32767);\n   v_schema_nm         VARCHAR2 (10) := 'XDMADM';\n   v_prspct_tbl_inactv VARCHAR2 (40 BYTE);\n   v_prspct_syn_nm 42183b964ff47e407206508ef9606770.b6b353c534e61967560fe35bfd68bab2.5e4be82fa55134ee91432a9d827d6cfb%TYPE\n         := 'CUST_PLUS_PRSPCT_CORP' ;\nBEGIN\n   EXECUTE IMMEDIATE 'alter session  set NLS_DATE_FORMAT=''YYYYMMDD''';\n\n   SELECT   MIN (fisc_yr_mth), MAX (fisc_yr_mth)\n     INTO   min_fisc_yr_mth, max_fisc_yr_mth\n     FROM   de459e2fe7f96e4d958537b31b946b26.fcc55a82da91e429eaffc482050485ebe472b097974b0d6a9a7d2ed170324906;\n\n     SELECT   tbl_nm\n     INTO   v_prspct_tbl_inactv\n     FROM   9751bbbcfea690cc0be4d58830a6fe2e.56ac3befbcbada23fa9268d8fe6d5242\n    WHERE   synonym_nm = v_prspct_syn_nm AND actv_ind = 'N';\n\n   SELECT   param_value_nbr\n     INTO   net_sls_lwr_lmt\n     FROM   de459e2fe7f96e4d958537b31b946b26.de40ae7be8b2eb3858d46af8d107f3db\n    WHERE   param_type = 'AR_GL_ACCT_LOWER_LMT'\n            AND param_code = 'NET_SLS_AR_GL_LWR_LMT';\n\n   SELECT   param_value_nbr\n     INTO   net_sls_upr_lmt\n     FROM   de459e2fe7f96e4d958537b31b946b26.de40ae7be8b2eb3858d46af8d107f3db\n    WHERE   param_type = 'AR_GL_ACCT_UPPER_LMT'\n            AND param_code = 'NET_SLS_AR_GL_UPR_LMT';\n\n   SELECT   param_value_nbr\n     INTO   cogs_lwr_lmt\n     FROM   de459e2fe7f96e4d958537b31b946b26.de40ae7be8b2eb3858d46af8d107f3db\n    WHERE   param_type = 'AR_GL_ACCT_LOWER_LMT'\n            AND param_code = 'COGS_AR_GL_LWR_LMT';\n\n   SELECT   param_value_nbr\n     INTO   cogs_upr_lmt\n     FROM   de459e2fe7f96e4d958537b31b946b26.de40ae7be8b2eb3858d46af8d107f3db\n    WHERE   param_type = 'AR_GL_ACCT_UPPER_LMT'\n            AND param_code = 'COGS_AR_GL_UPR_LMT';\n\n   SELECT   MAX (fisc_yr_mth), MIN (fisc_yr_mth)\n     INTO   newest_mp_data, oldest_mp_data\n     FROM   de459e2fe7f96e4d958537b31b946b26.fcc55a82da91e429eaffc482050485ebe472b097974b0d6a9a7d2ed170324906;\n\nSELECT MIN (start_date), MAX (end_date)\n INTO p_start_date, p_end_date\nFROM ( SELECT fisc_yr_mth,\nMIN (clndr_dt) start_date,\nMAX (clndr_dt) end_date\nFROM de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001 t1\nWHERE de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.222ccb1d1746bcdb2365f29b3da0b613 >=\n(SELECT MIN (clndr_dt) dt\nFROM de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001\nWHERE fisc_yr =\n(SELECT fisc_yr - 2\nFROM de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001\nWHERE clndr_dt =\nTO_DATE (odate, 'YYYYMMDD')))\n\nGROUP BY fisc_yr_mth)\nWHERE end_date <= TO_DATE (odate, 'YYYYMMDD');\n\nSELECT MIN (fisc_yr_mth), MAX (fisc_yr_mth)\n INTO p_min_fisc_yr_mth, p_max_fisc_yr_mth\nFROM ( SELECT fisc_yr_mth,\nMIN (clndr_dt) start_date,\nMAX (clndr_dt) end_date\nFROM de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001 t1\nWHERE de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.222ccb1d1746bcdb2365f29b3da0b613 >=\n(SELECT MIN (clndr_dt) dt\nFROM de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001\nWHERE fisc_yr =\n(SELECT fisc_yr - 2\nFROM de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001\nWHERE clndr_dt =\nTO_DATE (odate, 'YYYYMMDD')))\n\n\nGROUP BY fisc_yr_mth)\nwhere end_date <= TO_DATE (odate, 'YYYYMMDD');\n   \n   v_sql :=\n         'INSERT\n      \n    INTO '\n      || v_schema_nm\n      || '.'\n      || v_tbl_to_load\n      || ' SELECT CUST_PLUS_PRSPCT_SK,\n      FISC_YR_MTH,\n      MP_CHD_ID,\n      MP_US_FOODS_ID,\n      div_nbr,\n      cust_nbr,\n      CURR_IND_VAL ,\n      NVL(LDR_TM_VAL, to_char(sysdate, ''YYYYMMDDHH24MISS'')) ,\n      MP_MSTR_ID_VAL ,\n      RES_TYP_IND_VAL ,\n      MP_FOOD_BVRG_DSPSBL_PRCH,\n      MP_FOOD_DSPSBL_PRCH ,\n      MP_TTL_CAT_DRY,\n      MP_TTL_CAT_FRSH,\n      MP_TTL_CAT_FRZ ,\n      MP_TTL_CAT_PROTN ,\n      MP_TTL_CAT_BVRG ,\n      MP_TTL_CAT_DSPSBL ,\n      MP_TTL_CAT_FRSH_FRZ ,\n      NVL(ROUND( MP_FOOD_BVRG_DSPSBL_PRCH / 12, 4), 0),\n      NVL(ROUND( mp_food_dspsbl_prch / 12, 4), 0),\n      NVL(ROUND( mp_ttl_cat_dry      / 12, 4), 0),\n      NVL(ROUND( mp_ttl_cat_frsh     / 12, 4), 0),\n      NVL(ROUND( mp_ttl_cat_frz      / 12, 4), 0),\n      NVL(ROUND( mp_ttl_cat_protn    / 12, 4), 0),\n      NVL(ROUND( mp_ttl_cat_bvrg     / 12, 4), 0),\n      NVL(ROUND( mp_ttl_cat_dspsbl   / 12, 4), 0),\n      NVL(ROUND(mp_ttl_cat_frsh_frz  / 12, 4), 0),\n      gross_sales_extended,\n      lnd_actl_gp,\n      net_weight_shipped,\n      dvt_cost_extnd,\n      prod_alw,\n      net_sls_extnd,\n      dwa_cost_extnd,\n      nid,\n      lid,\n      natl_vndr_fnd_dvt,\n      loc_vndr_fnd_dvt,\n      ttl_loc_alwnc,\n      ttl_natl_alwnc,\n      natl_prom_alwnc_pgms,\n      natl_one_tm,\n      loc_prom_alwnc_pgms,\n      loc_mrktng_alwnc_pgms,\n      loc_one_tm,\n      natl_mrktng_alwnc_pgms,\n      inv_actl_gp,\n      cases,\n      tagp,\n      drops,\n      gross_sales_extended + alwnc_chg - rebates net_sales,\n      tagp                 + alwnc_chg - rebates - cogs_alwnc_chg net_tagp,\n      gross_tgp,\n      (gross_sales_extended + alwnc_chg - rebates) - dwa_cost_extnd + natl_vndr_fnd_dvt + loc_vndr_fnd_dvt + cogs_alwnc_chg net_tgp,\n      sagp,\n      pas,\n      alwnc_chg,\n      rebates,\n      cogs_alwnc_chg\n    FROM\n      (SELECT CUST_PLUS_PRSPCT_SK,\n        88cd8b7e560f52ff0ab4b3ace0b5666c.0a34d2db43f5e66e56ec87466eb900da,\n        88cd8b7e560f52ff0ab4b3ace0b5666c.0682c5ad0d2565a2cdc1818412780aeb,\n        NVL(88cd8b7e560f52ff0ab4b3ace0b5666c.8aedf38f859dc7094794af43294d5bd8, ''999999999'') MP_US_FOODS_ID,\n        88cd8b7e560f52ff0ab4b3ace0b5666c.839c4ffb4bfaae1bb58eab4dee67d96a,\n        88cd8b7e560f52ff0ab4b3ace0b5666c.852fa1e9f02f1ca2c75837f7146b2381,\n        CASE\n          WHEN 88cd8b7e560f52ff0ab4b3ace0b5666c.0a34d2db43f5e66e56ec87466eb900da >= '''\n      || min_fisc_yr_mth\n      || '''\n          AND 88cd8b7e560f52ff0ab4b3ace0b5666c.0a34d2db43f5e66e56ec87466eb900da  <= '''\n      || max_fisc_yr_mth\n      || '''\n          THEN CURR_IND\n          WHEN 88cd8b7e560f52ff0ab4b3ace0b5666c.0a34d2db43f5e66e56ec87466eb900da < '''\n      || min_fisc_yr_mth\n      || '''\n          THEN ''H''\n          WHEN 88cd8b7e560f52ff0ab4b3ace0b5666c.0a34d2db43f5e66e56ec87466eb900da > '''\n      || max_fisc_yr_mth\n      || '''\n          THEN ''F''\n        END CURR_IND_VAL ,\n        CASE\n          WHEN 88cd8b7e560f52ff0ab4b3ace0b5666c.0a34d2db43f5e66e56ec87466eb900da >= '''\n      || min_fisc_yr_mth\n      || '''\n          AND 88cd8b7e560f52ff0ab4b3ace0b5666c.0a34d2db43f5e66e56ec87466eb900da  <= '''\n      || max_fisc_yr_mth\n      || '''\n          THEN NVL(LDR_TM, to_char(sysdate, ''YYYYMMDDHH24MISS''))\n          WHEN 88cd8b7e560f52ff0ab4b3ace0b5666c.0a34d2db43f5e66e56ec87466eb900da < '''\n      || min_fisc_yr_mth\n      || '''\n            AND '''\n      || min_fisc_yr_mth\n      || ''' =  FISC_YR_MTH_F\n          THEN NVL(LDR_TM_F, to_char(sysdate, ''YYYYMMDDHH24MISS''))\n          WHEN 88cd8b7e560f52ff0ab4b3ace0b5666c.0a34d2db43f5e66e56ec87466eb900da > '''\n      || max_fisc_yr_mth\n      || '''\n          THEN NVL(LDR_TM_L, to_char(sysdate, ''YYYYMMDDHH24MISS''))\n            ELSE to_char(sysdate, ''YYYYMMDDHH24MISS'')\n        END LDR_TM_VAL ,\n        CASE\n          WHEN 88cd8b7e560f52ff0ab4b3ace0b5666c.0a34d2db43f5e66e56ec87466eb900da >= '''\n      || min_fisc_yr_mth\n      || '''\n          AND 88cd8b7e560f52ff0ab4b3ace0b5666c.0a34d2db43f5e66e56ec87466eb900da  <= '''\n      || max_fisc_yr_mth\n      || '''\n          THEN MP_MSTR_ID\n          WHEN 88cd8b7e560f52ff0ab4b3ace0b5666c.0a34d2db43f5e66e56ec87466eb900da < '''\n      || min_fisc_yr_mth\n      || '''\n            AND '''\n      || min_fisc_yr_mth\n      || ''' =  FISC_YR_MTH_F\n          THEN MP_MSTR_ID_F\n          WHEN 88cd8b7e560f52ff0ab4b3ace0b5666c.0a34d2db43f5e66e56ec87466eb900da > '''\n      || max_fisc_yr_mth\n      || '''\n          THEN MP_MSTR_ID_L\n        END MP_MSTR_ID_VAL ,\n        CASE\n          WHEN 88cd8b7e560f52ff0ab4b3ace0b5666c.0a34d2db43f5e66e56ec87466eb900da >= '''\n      || min_fisc_yr_mth\n      || '''\n          AND 88cd8b7e560f52ff0ab4b3ace0b5666c.0a34d2db43f5e66e56ec87466eb900da  <= '''\n      || max_fisc_yr_mth\n      || '''\n          THEN RES_TYP_IND\n          WHEN 88cd8b7e560f52ff0ab4b3ace0b5666c.0a34d2db43f5e66e56ec87466eb900da < '''\n      || min_fisc_yr_mth\n      || '''\n            AND '''\n      || min_fisc_yr_mth\n      || ''' =  FISC_YR_MTH_F\n          THEN RES_TYP_IND_F\n          WHEN 88cd8b7e560f52ff0ab4b3ace0b5666c.0a34d2db43f5e66e56ec87466eb900da > '''\n      || max_fisc_yr_mth\n      || '''\n          THEN RES_TYP_IND_L\n        END RES_TYP_IND_VAL ,\n        CASE\n          WHEN 88cd8b7e560f52ff0ab4b3ace0b5666c.0a34d2db43f5e66e56ec87466eb900da >= '''\n      || min_fisc_yr_mth\n      || '''\n          AND 88cd8b7e560f52ff0ab4b3ace0b5666c.0a34d2db43f5e66e56ec87466eb900da  <= '''\n      || max_fisc_yr_mth\n      || '''\n          THEN NVL(0273314c3a92e41958f0a854a352c1f1.c67e714c50092871e215f33a602c124d339d6512d0af0b6fe1f57edcdf48f234,0)\n          WHEN 88cd8b7e560f52ff0ab4b3ace0b5666c.0a34d2db43f5e66e56ec87466eb900da < '''\n      || min_fisc_yr_mth\n      || '''\n          AND '''\n      || min_fisc_yr_mth\n      || ''' =  FISC_YR_MTH_F\n          THEN NVL(88cd8b7e560f52ff0ab4b3ace0b5666c.c67e714c50092871e215f33a602c124dcbd7091f908e8e1345f7bd44fbcab35c,0)\n          WHEN 88cd8b7e560f52ff0ab4b3ace0b5666c.0a34d2db43f5e66e56ec87466eb900da > '''\n      || max_fisc_yr_mth\n      || '''\n          THEN NVL(88cd8b7e560f52ff0ab4b3ace0b5666c.c67e714c50092871e215f33a602c124ded9b76413a8e1bf7c0b1e0efda14ffe1,0)\n          ELSE 0\n        END MP_FOOD_BVRG_DSPSBL_PRCH ,\n        CASE\n          WHEN 88cd8b7e560f52ff0ab4b3ace0b5666c.0a34d2db43f5e66e56ec87466eb900da >= '''\n      || min_fisc_yr_mth\n      || '''\n          AND 88cd8b7e560f52ff0ab4b3ace0b5666c.0a34d2db43f5e66e56ec87466eb900da  <= '''\n      || max_fisc_yr_mth\n      || '''\n          THEN NVL(0273314c3a92e41958f0a854a352c1f1.37967ee337509dc618f2894310219ef9c3704fac6ea8a82dd05490dc67905b3e,0)\n          WHEN 88cd8b7e560f52ff0ab4b3ace0b5666c.0a34d2db43f5e66e56ec87466eb900da < '''\n      || min_fisc_yr_mth\n      || '''\n           AND '''\n      || min_fisc_yr_mth\n      || ''' =  FISC_YR_MTH_F\n          THEN NVL(88cd8b7e560f52ff0ab4b3ace0b5666c.37967ee337509dc618f2894310219ef9b44960abe49c849daed2596623196e93,0)\n          WHEN 88cd8b7e560f52ff0ab4b3ace0b5666c.0a34d2db43f5e66e56ec87466eb900da > '''\n      || max_fisc_yr_mth\n      || '''\n          THEN NVL(88cd8b7e560f52ff0ab4b3ace0b5666c.37967ee337509dc618f2894310219ef92535b586f8cab36fbc214ad2fca460c9,0)\n          ELSE 0\n        END MP_FOOD_DSPSBL_PRCH ,\n        CASE\n          WHEN 88cd8b7e560f52ff0ab4b3ace0b5666c.0a34d2db43f5e66e56ec87466eb900da >= '''\n      || min_fisc_yr_mth\n      || '''\n          AND 88cd8b7e560f52ff0ab4b3ace0b5666c.0a34d2db43f5e66e56ec87466eb900da  <= '''\n      || max_fisc_yr_mth\n      || '''\n          THEN NVL(0273314c3a92e41958f0a854a352c1f1.93e3b8a09752a4f8c5e42c382be1d0c8,0)\n          WHEN 88cd8b7e560f52ff0ab4b3ace0b5666c.0a34d2db43f5e66e56ec87466eb900da < '''\n      || min_fisc_yr_mth\n      || '''\n           AND '''\n      || min_fisc_yr_mth\n      || ''' =  FISC_YR_MTH_F\n          THEN NVL(88cd8b7e560f52ff0ab4b3ace0b5666c.24d6cfd48262c9a3a3b5c21a09db1124e32f6dd38f333cde68119d1f277367cd,0)\n          WHEN 88cd8b7e560f52ff0ab4b3ace0b5666c.0a34d2db43f5e66e56ec87466eb900da > '''\n      || max_fisc_yr_mth\n      || '''\n          THEN NVL(88cd8b7e560f52ff0ab4b3ace0b5666c.80e1871d17832530ef0c834bdd8ff952e32f6dd38f333cde68119d1f277367cd,0)\n          ELSE 0\n        END MP_TTL_CAT_DRY,\n        CASE\n          WHEN 88cd8b7e560f52ff0ab4b3ace0b5666c.0a34d2db43f5e66e56ec87466eb900da >= '''\n      || min_fisc_yr_mth\n      || '''\n           AND 88cd8b7e560f52ff0ab4b3ace0b5666c.0a34d2db43f5e66e56ec87466eb900da  <= '''\n      || max_fisc_yr_mth\n      || '''\n           THEN NVL(0273314c3a92e41958f0a854a352c1f1.84485bfc20488143cdc5015961760a79,0)\n           WHEN 88cd8b7e560f52ff0ab4b3ace0b5666c.0a34d2db43f5e66e56ec87466eb900da < '''\n      || min_fisc_yr_mth\n      || '''\n            AND '''\n      || min_fisc_yr_mth\n      || ''' =  FISC_YR_MTH_F\n           THEN NVL(88cd8b7e560f52ff0ab4b3ace0b5666c.24eee6f111474c84f94c1b4f1be533db3f7ab8a329bcc4187f623227ac49be31,0)\n          WHEN 88cd8b7e560f52ff0ab4b3ace0b5666c.0a34d2db43f5e66e56ec87466eb900da > '''\n      || max_fisc_yr_mth\n      || '''\n           THEN NVL(88cd8b7e560f52ff0ab4b3ace0b5666c.24eee6f111474c84f94c1b4f1be533dbe7f1bb4487d12718c0cdcdefab6381f3,0)\n          ELSE 0\n        END MP_TTL_CAT_FRSH,\n        CASE\n          WHEN 88cd8b7e560f52ff0ab4b3ace0b5666c.0a34d2db43f5e66e56ec87466eb900da >= '''\n      || min_fisc_yr_mth\n      || '''\n           AND 88cd8b7e560f52ff0ab4b3ace0b5666c.0a34d2db43f5e66e56ec87466eb900da  <= '''\n      || max_fisc_yr_mth\n      || '''\n           THEN NVL(0273314c3a92e41958f0a854a352c1f1.61941f29ea187095c7004e12249c2cd4,0)\n          WHEN 88cd8b7e560f52ff0ab4b3ace0b5666c.0a34d2db43f5e66e56ec87466eb900da < '''\n      || min_fisc_yr_mth\n      || '''\n           AND '''\n      || min_fisc_yr_mth\n      || ''' =  FISC_YR_MTH_F\n           THEN NVL(88cd8b7e560f52ff0ab4b3ace0b5666c.ab871958a2b1d84341aa3e9a8cd9c04ee32f6dd38f333cde68119d1f277367cd,0)\n          WHEN 88cd8b7e560f52ff0ab4b3ace0b5666c.0a34d2db43f5e66e56ec87466eb900da > '''\n      || max_fisc_yr_mth\n      || '''\n           THEN NVL(88cd8b7e560f52ff0ab4b3ace0b5666c.2d29ef79b710ac8e80418e49bd0d2a2fe32f6dd38f333cde68119d1f277367cd,0)\n          ELSE 0\n        END MP_TTL_CAT_FRZ ,\n        CASE\n          WHEN 88cd8b7e560f52ff0ab4b3ace0b5666c.0a34d2db43f5e66e56ec87466eb900da >= '''\n      || min_fisc_yr_mth\n      || '''\n           AND 88cd8b7e560f52ff0ab4b3ace0b5666c.0a34d2db43f5e66e56ec87466eb900da  <= '''\n      || max_fisc_yr_mth\n      || '''\n           THEN NVL(0273314c3a92e41958f0a854a352c1f1.c606f1132824c001a8117a3856ab0da9e32f6dd38f333cde68119d1f277367cd,0)\n          WHEN 88cd8b7e560f52ff0ab4b3ace0b5666c.0a34d2db43f5e66e56ec87466eb900da < '''\n      || min_fisc_yr_mth\n      || '''\n           AND '''\n      || min_fisc_yr_mth\n      || ''' =  FISC_YR_MTH_F\n           THEN NVL(88cd8b7e560f52ff0ab4b3ace0b5666c.c606f1132824c001a8117a3856ab0da99c3c52ee59a09fd1ff4348227531cad0,0)\n          WHEN 88cd8b7e560f52ff0ab4b3ace0b5666c.0a34d2db43f5e66e56ec87466eb900da > '''\n      || max_fisc_yr_mth\n      || '''\n           THEN NVL(88cd8b7e560f52ff0ab4b3ace0b5666c.c606f1132824c001a8117a3856ab0da9c311a2d8593bbe614df80aa6c3a5c92c,0)\n            ELSE 0\n        END MP_TTL_CAT_PROTN ,\n        CASE\n          WHEN 88cd8b7e560f52ff0ab4b3ace0b5666c.0a34d2db43f5e66e56ec87466eb900da >= '''\n      || min_fisc_yr_mth\n      || '''\n           AND 88cd8b7e560f52ff0ab4b3ace0b5666c.0a34d2db43f5e66e56ec87466eb900da  <= '''\n      || max_fisc_yr_mth\n      || '''\n           THEN NVL(0273314c3a92e41958f0a854a352c1f1.aed79c20bb6c3637da3e7c982d572e35 ,0)\n          WHEN 88cd8b7e560f52ff0ab4b3ace0b5666c.0a34d2db43f5e66e56ec87466eb900da < '''\n      || min_fisc_yr_mth\n      || '''\n           AND '''\n      || min_fisc_yr_mth\n      || ''' =  FISC_YR_MTH_F\n           THEN NVL(88cd8b7e560f52ff0ab4b3ace0b5666c.0489dea46fa616bb76d1460f130803e73f7ab8a329bcc4187f623227ac49be31,0)\n          WHEN 88cd8b7e560f52ff0ab4b3ace0b5666c.0a34d2db43f5e66e56ec87466eb900da > '''\n      || max_fisc_yr_mth\n      || '''\n           THEN NVL(88cd8b7e560f52ff0ab4b3ace0b5666c.0489dea46fa616bb76d1460f130803e7e7f1bb4487d12718c0cdcdefab6381f3,0)\n            ELSE 0\n        END MP_TTL_CAT_BVRG ,\n        CASE\n          WHEN 88cd8b7e560f52ff0ab4b3ace0b5666c.0a34d2db43f5e66e56ec87466eb900da >= '''\n      || min_fisc_yr_mth\n      || '''\n           AND 88cd8b7e560f52ff0ab4b3ace0b5666c.0a34d2db43f5e66e56ec87466eb900da  <= '''\n      || max_fisc_yr_mth\n      || '''\n           THEN NVL(0273314c3a92e41958f0a854a352c1f1.8d6b5f5ebcdc60182ee248616af47b3ee7f1bb4487d12718c0cdcdefab6381f3 ,0)\n          WHEN 88cd8b7e560f52ff0ab4b3ace0b5666c.0a34d2db43f5e66e56ec87466eb900da < '''\n      || min_fisc_yr_mth\n      || '''\n           AND '''\n      || min_fisc_yr_mth\n      || ''' =  FISC_YR_MTH_F\n           THEN NVL(88cd8b7e560f52ff0ab4b3ace0b5666c.8d6b5f5ebcdc60182ee248616af47b3e6b78a7e01b2b5550cbbb8c40c3ea8578,0)\n          WHEN 88cd8b7e560f52ff0ab4b3ace0b5666c.0a34d2db43f5e66e56ec87466eb900da > '''\n      || max_fisc_yr_mth\n      || '''\n           THEN NVL(88cd8b7e560f52ff0ab4b3ace0b5666c.8d6b5f5ebcdc60182ee248616af47b3e685aeb5934aa672a29795ecea4bab1c4,0)\n          ELSE 0\n        END MP_TTL_CAT_DSPSBL ,\n        CASE\n          WHEN 88cd8b7e560f52ff0ab4b3ace0b5666c.0a34d2db43f5e66e56ec87466eb900da >= '''\n      || min_fisc_yr_mth\n      || '''\n           AND 88cd8b7e560f52ff0ab4b3ace0b5666c.0a34d2db43f5e66e56ec87466eb900da  <= '''\n      || max_fisc_yr_mth\n      || '''\n           THEN NVL(0273314c3a92e41958f0a854a352c1f1.24eee6f111474c84f94c1b4f1be533db648fd7c9e66a64a95103d4e740959b0b,0)\n          WHEN 88cd8b7e560f52ff0ab4b3ace0b5666c.0a34d2db43f5e66e56ec87466eb900da < '''\n      || min_fisc_yr_mth\n      || '''\n           AND '''\n      || min_fisc_yr_mth\n      || ''' =  FISC_YR_MTH_F\n           THEN NVL(88cd8b7e560f52ff0ab4b3ace0b5666c.24eee6f111474c84f94c1b4f1be533db11af44291cb26b7ef31df90b67f14db4,0)\n          WHEN 88cd8b7e560f52ff0ab4b3ace0b5666c.0a34d2db43f5e66e56ec87466eb900da > '''\n      || max_fisc_yr_mth\n      || '''\n           THEN NVL(88cd8b7e560f52ff0ab4b3ace0b5666c.24eee6f111474c84f94c1b4f1be533db8fbbb8d040a8e50028ad4a6f8f74769e,0)\n          ELSE 0\n        END MP_TTL_CAT_FRSH_FRZ ,\n        gross_sales_extended,\n        lnd_actl_gp,\n        net_weight_shipped,\n        dvt_cost_extnd,\n        prod_alw,\n        net_sls_extnd,\n        dwa_cost_extnd,\n        natl_vndr_fnd_dvt,\n        loc_vndr_fnd_dvt,\n        ttl_loc_alwnc,\n        ttl_natl_alwnc,\n        loc_prom_alwnc_pgms,\n        loc_mrktng_alwnc_pgms,\n        natl_mrktng_alwnc_pgms,\n        loc_one_tm,\n        natl_prom_alwnc_pgms,\n        inv_actl_gp,\n        cases,\n        tagp,\n        drops,\n        gross_tgp,\n        sagp,\n        pas,\n        alwnc_chg,\n        rebates,\n        cogs_alwnc_chg,\n        natl_one_tm,\n        nid,\n        lid\n      FROM\n        (SELECT a1.*,\n          NVL(FISC_YR_MTH_S,0) FISC_YR_MTH,\n          gross_sales_extended,\n          net_weight_shipped,\n          dwa_cost_extnd,\n          cases,\n          tagp,\n          lnd_actl_gp,\n          dvt_cost_extnd,\n          prod_alw,\n          net_sls_extnd,\n          natl_vndr_fnd_dvt,\n          loc_vndr_fnd_dvt,\n          ttl_loc_alwnc,\n          ttl_natl_alwnc,\n          natl_prom_alwnc_pgms,\n          natl_one_tm,\n          loc_prom_alwnc_pgms,\n          loc_mrktng_alwnc_pgms,\n          loc_one_tm,\n          natl_mrktng_alwnc_pgms,\n          inv_actl_gp,\n          drops,\n          alwnc_chg,\n          rebates,\n          cogs_alwnc_chg,\n          gross_tgp,\n          tagp + alwnc_chg - rebates - cogs_alwnc_chg AS net_tgp,\n          sagp,\n          pas,\n          lid,\n          nid\n        FROM '\n      || v_schema_nm\n      || '.'\n      || v_prspct_tbl_inactv || ' a1\n        INNER JOIN\n          (SELECT de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.839c4ffb4bfaae1bb58eab4dee67d96a,\n            cust_nbr,\n            57a3138978a711d200b2c78dfa82e0b5.0a34d2db43f5e66e56ec87466eb900da FISC_YR_MTH_S ,\n            SUM(de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.c4e3a9f99fa6f955de390a93819085ae) AS lnd_actl_gp,\n            SUM(dwa_cost_extnd) dwa_cost_extnd,\n            SUM(de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.237609d37bbd0b9a205aa95e75daf38b)         AS dvt_cost_extnd,\n            SUM(de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.63a91e2fd122990392b8c1467a67b61e)               AS prod_alw ,\n            SUM(de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.eacf342f9cfeb8791c58f614d70fdd7e)          AS net_sls_extnd ,\n            SUM(de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.b5019e4009d6240fe25b80db390c07601d731bbdc4e3fb69a854112d4982eb99)      AS natl_vndr_fnd_dvt ,\n            SUM(de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.c137fdd918ede20e07fec7282883fa34e32f6dd38f333cde68119d1f277367cd)       AS loc_vndr_fnd_dvt ,\n            SUM(de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.d36e400304221073c1c3bb586ed7de9f)          AS ttl_loc_alwnc ,\n            SUM(de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.92d4d6b1028cc8f6b6a6a50394af943a)         AS ttl_natl_alwnc ,\n            SUM(de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.7321a4c88369e6acc22f8952a98e86b3e7fabc080d1e698e1941d756c183e979)   AS natl_prom_alwnc_pgms ,\n            SUM(de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.11da749d2c0d1e21a4c413489daad454)            AS natl_one_tm ,\n            SUM(de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.df0917aa3fd36489aa4d308fa97b06b76398e8624834825f4604477ca9ac3d8a)    AS loc_prom_alwnc_pgms ,\n            SUM(de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.3f5f78a3c918316a0e68170dc6b81e0c7ea8b5b6353c726ed7e410e230c7898b)  AS loc_mrktng_alwnc_pgms ,\n            SUM(de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.42c87cd307c51e63a144309315721b09)             AS loc_one_tm,\n            SUM(de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.5e937026da90c7e4a4e0bb540e061948eed1259e6b62783c664a0bc2e5e255a4) AS natl_mrktng_alwnc_pgms ,\n            SUM(de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.8a3a832e9ed55880c82a6085970dfe5d)            AS inv_actl_gp ,\n            COUNT (DISTINCT DECODE(de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.26ac88e7ae671a1b22c14c2fce77aa2d, ''RT'', de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.839c4ffb4bfaae1bb58eab4dee67d96a\n            || de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.852fa1e9f02f1ca2c75837f7146b2381\n            || de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.faaaf9cbe8897987592d529a771bbc17\n            || de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.f5dd4374a3e3af6a775cb6d6b22e8162\n            || de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.c4ffe3bd27523a268da639921856c18e) ) AS drops ,\n            SUM(\n            CASE\n              WHEN de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.6363e9ad7bc2d03871ced34810bbcc9cde922b42cda877bb335f20b7c10e0802 <> ''Y''\n              AND de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.5b031577f28cabdc6c0e17d15a4e0aa0 BETWEEN '\n      || net_sls_lwr_lmt\n      || ' AND '\n      || net_sls_upr_lmt\n      || ' THEN NVL(de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.63a91e2fd122990392b8c1467a67b61e, 0) + NVL(de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.f4684b698d1e8edd11bf71d8eac02595, 0) + NVL(de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.2dfeefdbbdd44f6feceb5ad393352003, 0) + NVL(de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.bd428d343074503f124765bf6dd4405a, 0)\n              ELSE 0\n            END)                                                                                                                      AS alwnc_chg,\n            SUM(NVL(de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.5a946c48d4cb9b1b6880bf6386e276781d731bbdc4e3fb69a854112d4982eb99, 0) + NVL(de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.6ec51d00c0df5a2c35ea4dc79b992a0ef4147ca167a57859c2f78f7521e7a9a8, 0) + NVL(de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.bb26587da7cde1ca1883d4ac6949a349, 0) + NVL(de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.d2a9879c73e438cd42a66e4ee567caf5e32f6dd38f333cde68119d1f277367cd, 0) ) AS rebates ,\n            SUM(\n            CASE\n              WHEN de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.6363e9ad7bc2d03871ced34810bbcc9cde922b42cda877bb335f20b7c10e0802 <> ''Y''\n              AND de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.5b031577f28cabdc6c0e17d15a4e0aa0 BETWEEN '\n      || cogs_lwr_lmt\n      || ' AND '\n      || cogs_upr_lmt\n      || '\n              THEN NVL(de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.63a91e2fd122990392b8c1467a67b61e, 0) + NVL(de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.f4684b698d1e8edd11bf71d8eac02595, 0) + NVL(de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.2dfeefdbbdd44f6feceb5ad393352003, 0) + NVL(de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.bd428d343074503f124765bf6dd4405a, 0)\n              ELSE 0\n            END )                                                        AS cogs_alwnc_chg ,\n            SUM(de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.2ee1400a0150f0b220dd7bd6268d1e66)                                         AS gross_sales_extended,\n            SUM(de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.ccf8d88f2d37f3171da2121ab22e9330 )                                       AS cases,\n            SUM(NVL(de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.1afca342ab89e5b8c65c6c4c634b2186, 0) )                                      AS tagp,\n            SUM(de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.2ee1400a0150f0b220dd7bd6268d1e66 - de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.c6c7cc45578c678907522e08bb04a4ca - (CASE WHEN de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.487c194c34aee6c67551aa2cdd2358ace32f6dd38f333cde68119d1f277367cd = ''P'' THEN NVL(de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.d206d123f59f85e26ec113e33b465295,0) ELSE 0 END) + de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.b7982b81d447f11a0953881190e528cae32f6dd38f333cde68119d1f277367cd) AS gross_tgp ,\n            SUM(de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.c4e3a9f99fa6f955de390a93819085ae   + (de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.d522ff7fd338224e811132198cf36dfe * de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.afe8a28a2196dfa51419cb51dd86a332))      AS sagp,\n            SUM(de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.b215402101f7a4f20fccac979c4d9b44)                                           AS net_weight_shipped,\n            SUM(de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.d36e400304221073c1c3bb586ed7de9f + de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.92d4d6b1028cc8f6b6a6a50394af943a)                      AS pas,\n            SUM(de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.c6c7cc45578c678907522e08bb04a4ca)                                        AS true_cost_extended,\n            SUM(de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.42dd45423319f918e704ed37d4dbb128)                                          AS nid,\n            SUM(de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.931b2ac4399b8a337f8d0ff67bab0e15)                                           AS lid\n          FROM de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c s,\n            de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001 t,\n            de459e2fe7f96e4d958537b31b946b26.dec387908a0954ddc8689c4ad37c8a3c d\n          WHERE de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.839c4ffb4bfaae1bb58eab4dee67d96a      = de459e2fe7f96e4d958537b31b946b26.dec387908a0954ddc8689c4ad37c8a3c.839c4ffb4bfaae1bb58eab4dee67d96a\n          AND de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.f5dd4374a3e3af6a775cb6d6b22e8162        = de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.222ccb1d1746bcdb2365f29b3da0b613\n          AND prcs_dt         >= '''\n      || p_start_date\n      || '''\n           AND prcs_dt         <= '''\n      || p_end_date\n      || '''\n           AND bd4f6be5a9a2a84272b99dc7c512050f.c47a1dbdf9c0ce987de4ca2fcd0d5038    IS NULL\n          AND CONV_TO_DIV_NBR IS NULL\n          AND BRNCH_CD        <> ''-999''\n          GROUP BY de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.839c4ffb4bfaae1bb58eab4dee67d96a,\n            cust_nbr,\n            57a3138978a711d200b2c78dfa82e0b5.0a34d2db43f5e66e56ec87466eb900da\n          )b\n        ON 1806c896b7bb39ee4ba5c6b28fc687e7.852fa1e9f02f1ca2c75837f7146b2381 = 6d9b37be5a083f8b78d676aba846c823.852fa1e9f02f1ca2c75837f7146b2381\n        AND 1806c896b7bb39ee4ba5c6b28fc687e7.839c4ffb4bfaae1bb58eab4dee67d96a = 6d9b37be5a083f8b78d676aba846c823.839c4ffb4bfaae1bb58eab4dee67d96a\n        ) AGG\n      LEFT OUTER JOIN de459e2fe7f96e4d958537b31b946b26.fcc55a82da91e429eaffc482050485ebe472b097974b0d6a9a7d2ed170324906 chd_h\n      ON 651bdec14189a0c6c8d0942de6de2f0d.e31a13b0019fa14358cccecf46ab6bac       = 7b47d9e838fd67702453508564ca22b3.e31a13b0019fa14358cccecf46ab6bac\n      AND 88cd8b7e560f52ff0ab4b3ace0b5666c.839c4ffb4bfaae1bb58eab4dee67d96a        = 7b47d9e838fd67702453508564ca22b3.839c4ffb4bfaae1bb58eab4dee67d96a\n      AND 88cd8b7e560f52ff0ab4b3ace0b5666c.33cde6b92bd1b2a3d489b84803485187 = 7b47d9e838fd67702453508564ca22b3.33cde6b92bd1b2a3d489b84803485187\n      AND 88cd8b7e560f52ff0ab4b3ace0b5666c.2603c45be643e5cd8f9c6dad3bee6cb3    = 7b47d9e838fd67702453508564ca22b3.2603c45be643e5cd8f9c6dad3bee6cb3\n      ) a';\n   \n\n   EXECUTE IMMEDIATE v_sql;\n\n   DBMS_OUTPUT.put_line ('Rows processed: ' || SQL%ROWCOUNT);\n   COMMIT;\n   v_sql :=\n         'INSERT \n    INTO '\n      || v_schema_nm\n      || '.'\n      || v_tbl_to_load\n      || ' SELECT CUST_PLUS_PRSPCT_SK,\n      MTH,\n      MP_CHD_ID,\n      MP_US_FOODS_ID,\n      div_nbr,\n      cust_nbr,\n      ''F'' CURR_IND_L ,\n      NVL(LDR_TM_L, to_char(sysdate, ''YYYYMMDDHH24MISS'')) ,\n      MP_MSTR_ID_L ,\n      RES_TYP_IND_L ,\n      MP_FOOD_BVRG_DSPSBL_PRCH_L,\n      MP_FOOD_DSPSBL_PRCH_L ,\n      MP_TTL_CAT_DRY_L,\n      MP_TTL_CAT_FRSH_L,\n      MP_TTL_CAT_FRZ_L ,\n      MP_TTL_CAT_PROTN_L ,\n      MP_TTL_CAT_BVRG_L ,\n      MP_TTL_CAT_DSPSBL_L ,\n      MP_TTL_CAT_FRSH_FRZ_L ,\n      NVL(ROUND( MP_FOOD_BVRG_DSPSBL_PRCH_L / 12, 4), 0),\n      NVL(ROUND( mp_food_dspsbl_prch_L / 12, 4), 0),\n      NVL(ROUND( mp_ttl_cat_dry_L      / 12, 4), 0),\n      NVL(ROUND( mp_ttl_cat_frsh_L     / 12, 4), 0),\n      NVL(ROUND( mp_ttl_cat_frz_L      / 12, 4), 0),\n      NVL(ROUND( mp_ttl_cat_protn_L    / 12, 4), 0),\n      NVL(ROUND( mp_ttl_cat_bvrg_L     / 12, 4), 0),\n      NVL(ROUND( mp_ttl_cat_dspsbl_L   / 12, 4), 0),\n      NVL(ROUND(mp_ttl_cat_frsh_frz_L  / 12, 4), 0),\n      0,\n      0,\n      0,\n      0,\n      0,\n      0,\n      0,\n      0,\n      0,\n      0,\n      0,\n      0,\n      0,\n      0,\n      0,\n      0,\n      0,\n      0,\n      0,\n      0,\n      0,\n      0,\n      0,\n      0,\n      0,\n      0,\n      0,\n      0,\n      0,\n      0,\n      0,\n      0\n    FROM\n      (SELECT a1.* ,\n        mth\n      FROM '\n      || v_schema_nm\n      || '.'\n      || v_prspct_tbl_inactv || ' a1 ,\n        (SELECT DISTINCT 0e03d5c46556a742ba46252698396ef2.1609b28739e207519049a2cf090bfd19.2603c45be643e5cd8f9c6dad3bee6cb3 MTH\n        FROM 0e03d5c46556a742ba46252698396ef2.1609b28739e207519049a2cf090bfd19 t,\n          de459e2fe7f96e4d958537b31b946b26.fcc55a82da91e429eaffc482050485ebe472b097974b0d6a9a7d2ed170324906 cp \n        WHERE 0e03d5c46556a742ba46252698396ef2.1609b28739e207519049a2cf090bfd19.2603c45be643e5cd8f9c6dad3bee6cb3 > (select max(fisc_yr_mth) from de459e2fe7f96e4d958537b31b946b26.fcc55a82da91e429eaffc482050485ebe472b097974b0d6a9a7d2ed170324906)\n        AND 0e03d5c46556a742ba46252698396ef2.1609b28739e207519049a2cf090bfd19.2603c45be643e5cd8f9c6dad3bee6cb3   <= '\n      || p_max_fisc_yr_mth\n      || '\n        ) mth\n        where fisc_yr_mth_l = '\n      || max_fisc_yr_mth\n      || '\n      ) agg \n    WHERE NOT EXISTS\n      (SELECT 1\n      FROM '\n      || v_schema_nm\n      || '.'\n      || v_tbl_to_load\n      || ' CHD_H\n      WHERE \n        651bdec14189a0c6c8d0942de6de2f0d.e31a13b0019fa14358cccecf46ab6bac        = 7b47d9e838fd67702453508564ca22b3.e31a13b0019fa14358cccecf46ab6bac\n      AND 88cd8b7e560f52ff0ab4b3ace0b5666c.839c4ffb4bfaae1bb58eab4dee67d96a        = 7b47d9e838fd67702453508564ca22b3.839c4ffb4bfaae1bb58eab4dee67d96a\n      AND 88cd8b7e560f52ff0ab4b3ace0b5666c.33cde6b92bd1b2a3d489b84803485187 = 7b47d9e838fd67702453508564ca22b3.33cde6b92bd1b2a3d489b84803485187\n      AND 88cd8b7e560f52ff0ab4b3ace0b5666c.1495a070b2c37631a8b62c73a8b1f10c            = 7b47d9e838fd67702453508564ca22b3.2603c45be643e5cd8f9c6dad3bee6cb3\n      )';\n   DBMS_OUTPUT.put_line (v_sql);\n\n   EXECUTE IMMEDIATE v_sql;\n\n   DBMS_OUTPUT.put_line ('Rows processed: ' || SQL%ROWCOUNT);\n   COMMIT;\n   v_sql :=\n         'INSERT \n    INTO '\n      || v_schema_nm\n      || '.'\n      || v_tbl_to_load\n      || ' SELECT CUST_PLUS_PRSPCT_SK,\n      MTH,\n      MP_CHD_ID,\n      MP_US_FOODS_ID,\n      div_nbr,\n      cust_nbr,\n      ''H'' CURR_IND_F ,\n      NVL(LDR_TM_F, to_char(sysdate, ''YYYYMMDDHH24MISS'')) ,\n      MP_MSTR_ID_F ,\n      RES_TYP_IND_F ,\n      MP_FOOD_BVRG_DSPSBL_PRCH_F,\n      MP_FOOD_DSPSBL_PRCH_F ,\n      MP_TTL_CAT_DRY_F,\n      MP_TTL_CAT_FRSH_F,\n      MP_TTL_CAT_FRZ_F ,\n      MP_TTL_CAT_PROTN_F ,\n      MP_TTL_CAT_BVRG_F ,\n      MP_TTL_CAT_DSPSBL_F ,\n      MP_TTL_CAT_FRSH_FRZ_F ,\n      NVL(ROUND( MP_FOOD_BVRG_DSPSBL_PRCH_F / 12, 4), 0),\n      NVL(ROUND( mp_food_dspsbl_prch_f / 12, 4), 0),\n      NVL(ROUND( mp_ttl_cat_dry_f      / 12, 4), 0),\n      NVL(ROUND( mp_ttl_cat_frsh_f     / 12, 4), 0),\n      NVL(ROUND( mp_ttl_cat_frz_f      / 12, 4), 0),\n      NVL(ROUND( mp_ttl_cat_protn_f    / 12, 4), 0),\n      NVL(ROUND( mp_ttl_cat_bvrg_f     / 12, 4), 0),\n      NVL(ROUND( mp_ttl_cat_dspsbl_f   / 12, 4), 0),\n      NVL(ROUND(mp_ttl_cat_frsh_frz_f  / 12, 4), 0),\n      0,\n      0,\n      0,\n      0,\n      0,\n      0,\n      0,\n      0,\n      0,\n      0,\n      0,\n      0,\n      0,\n      0,\n      0,\n      0,\n      0,\n      0,\n      0,\n      0,\n      0,\n      0,\n      0,\n      0,\n      0,\n      0,\n      0,\n      0,\n      0,\n      0,\n      0,\n      0\n    FROM\n      (SELECT a1.* ,\n        mth\n      FROM '\n      || v_schema_nm\n      || '.'\n      || v_prspct_tbl_inactv || ' a1 ,\n        (SELECT DISTINCT 0e03d5c46556a742ba46252698396ef2.1609b28739e207519049a2cf090bfd19.2603c45be643e5cd8f9c6dad3bee6cb3 MTH\n        FROM 0e03d5c46556a742ba46252698396ef2.1609b28739e207519049a2cf090bfd19 t,\n          de459e2fe7f96e4d958537b31b946b26.fcc55a82da91e429eaffc482050485ebe472b097974b0d6a9a7d2ed170324906 cp \n        WHERE 0e03d5c46556a742ba46252698396ef2.1609b28739e207519049a2cf090bfd19.2603c45be643e5cd8f9c6dad3bee6cb3 <= de459e2fe7f96e4d958537b31b946b26.fcc55a82da91e429eaffc482050485ebe472b097974b0d6a9a7d2ed170324906.2603c45be643e5cd8f9c6dad3bee6cb3\n        AND 0e03d5c46556a742ba46252698396ef2.1609b28739e207519049a2cf090bfd19.2603c45be643e5cd8f9c6dad3bee6cb3 >='\n      || p_min_fisc_yr_mth\n      || ' AND 0e03d5c46556a742ba46252698396ef2.1609b28739e207519049a2cf090bfd19.2603c45be643e5cd8f9c6dad3bee6cb3 < '\n      || min_fisc_yr_mth\n      || '\n        ) mth\n        where fisc_yr_mth_f = '\n      || min_fisc_yr_mth\n      || '\n      ) agg\n      \n    WHERE NOT EXISTS\n      (SELECT 1\n      FROM '\n      || v_schema_nm\n      || '.'\n      || v_tbl_to_load\n      || ' CHD_H\n      WHERE \n        651bdec14189a0c6c8d0942de6de2f0d.e31a13b0019fa14358cccecf46ab6bac        = 7b47d9e838fd67702453508564ca22b3.e31a13b0019fa14358cccecf46ab6bac\n      AND 88cd8b7e560f52ff0ab4b3ace0b5666c.839c4ffb4bfaae1bb58eab4dee67d96a        = 7b47d9e838fd67702453508564ca22b3.839c4ffb4bfaae1bb58eab4dee67d96a\n      AND 88cd8b7e560f52ff0ab4b3ace0b5666c.33cde6b92bd1b2a3d489b84803485187 = 7b47d9e838fd67702453508564ca22b3.33cde6b92bd1b2a3d489b84803485187\n      AND 88cd8b7e560f52ff0ab4b3ace0b5666c.1495a070b2c37631a8b62c73a8b1f10c            = 7b47d9e838fd67702453508564ca22b3.2603c45be643e5cd8f9c6dad3bee6cb3\n      )';\n   DBMS_OUTPUT.put_line (v_sql);\n\n   EXECUTE IMMEDIATE v_sql;\n\n   DBMS_OUTPUT.put_line ('Rows processed: ' || SQL%ROWCOUNT);\n   COMMIT;\n   v_sql :=\n         'INSERT \n    INTO '\n      || v_schema_nm\n      || '.'\n      || v_tbl_to_load\n      || ' SELECT CUST_PLUS_PRSPCT_SK,\n      fisc_yr_MTH,\n      MP_CHD_ID,\n      MP_US_FOODS_ID,\n      div_nbr,\n      cust_nbr,\n      CURR_IND ,\n      NVL(LDR_TM, to_char(sysdate, ''YYYYMMDDHH24MISS'')) ,\n      MP_MSTR_ID ,\n      RES_TYP_IND ,\n      MP_FOOD_BVRG_DSPSBL_PRCH,\n      MP_FOOD_DSPSBL_PRCH ,\n      MP_TTL_CAT_DRY,\n      MP_TTL_CAT_FRSH,\n      MP_TTL_CAT_FRZ ,\n      MP_TTL_CAT_PROTN ,\n      MP_TTL_CAT_BVRG ,\n      MP_TTL_CAT_DSPSBL ,\n      MP_TTL_CAT_FRSH_FRZ ,\n      NVL(ROUND( MP_FOOD_BVRG_DSPSBL_PRCH / 12, 4), 0),\n      NVL(ROUND( mp_food_dspsbl_prch / 12, 4), 0),\n      NVL(ROUND( mp_ttl_cat_dry      / 12, 4), 0),\n      NVL(ROUND( mp_ttl_cat_frsh     / 12, 4), 0),\n      NVL(ROUND( mp_ttl_cat_frz      / 12, 4), 0),\n      NVL(ROUND( mp_ttl_cat_protn    / 12, 4), 0),\n      NVL(ROUND( mp_ttl_cat_bvrg     / 12, 4), 0),\n      NVL(ROUND( mp_ttl_cat_dspsbl   / 12, 4), 0),\n      NVL(ROUND(mp_ttl_cat_frsh_frz  / 12, 4), 0),\n      0,\n      0,\n      0,\n      0,\n      0,\n      0,\n      0,\n      0,\n      0,\n      0,\n      0,\n      0,\n      0,\n      0,\n      0,\n      0,\n      0,\n      0,\n      0,\n      0,\n      0,\n      0,\n      0,\n      0,\n      0,\n      0,\n      0,\n      0,\n      0,\n      0,\n      0,\n      0\n    FROM\n      (SELECT 1806c896b7bb39ee4ba5c6b28fc687e7.12668f8ce2bdbc340c772ba6d81b03c17ad9557effa62b81ac09018d90f3c4fe ,\n        1806c896b7bb39ee4ba5c6b28fc687e7.0682c5ad0d2565a2cdc1818412780aeb ,\n        1806c896b7bb39ee4ba5c6b28fc687e7.8aedf38f859dc7094794af43294d5bd8 ,\n        1806c896b7bb39ee4ba5c6b28fc687e7.9f055ebf334db6c50bbcab4ff14bd2ae ,\n        1806c896b7bb39ee4ba5c6b28fc687e7.4fdc122fb2d10dd764e32cbc98972eca,\n        fisc_yr_mth,\n        CURR_IND ,\n        LDR_TM ,\n        MP_MSTR_ID ,\n        RES_TYP_IND ,\n        MP_FOOD_BVRG_DSPSBL_PRCH,\n        MP_FOOD_DSPSBL_PRCH ,\n        MP_TTL_CAT_DRY,\n        MP_TTL_CAT_FRSH,\n        MP_TTL_CAT_FRZ ,\n        MP_TTL_CAT_PROTN ,\n        MP_TTL_CAT_BVRG ,\n        MP_TTL_CAT_DSPSBL ,\n        MP_TTL_CAT_FRSH_FRZ\n      FROM '\n      || v_schema_nm\n      || '.'\n      || v_prspct_tbl_inactv || ' a1\n      INNER JOIN de459e2fe7f96e4d958537b31b946b26.fcc55a82da91e429eaffc482050485ebe472b097974b0d6a9a7d2ed170324906 chd \n      ON 1806c896b7bb39ee4ba5c6b28fc687e7.e31a13b0019fa14358cccecf46ab6bac       = de459e2fe7f96e4d958537b31b946b26.fcc55a82da91e429eaffc482050485ebe472b097974b0d6a9a7d2ed170324906.e31a13b0019fa14358cccecf46ab6bac\n      AND 1806c896b7bb39ee4ba5c6b28fc687e7.839c4ffb4bfaae1bb58eab4dee67d96a        = de459e2fe7f96e4d958537b31b946b26.fcc55a82da91e429eaffc482050485ebe472b097974b0d6a9a7d2ed170324906.839c4ffb4bfaae1bb58eab4dee67d96a\n      AND 1806c896b7bb39ee4ba5c6b28fc687e7.33cde6b92bd1b2a3d489b84803485187 = de459e2fe7f96e4d958537b31b946b26.fcc55a82da91e429eaffc482050485ebe472b097974b0d6a9a7d2ed170324906.33cde6b92bd1b2a3d489b84803485187\n      WHERE NOT EXISTS\n        (SELECT 1\n        FROM '\n      || v_schema_nm\n      || '.'\n      || v_tbl_to_load\n      || ' CHD_H\n        WHERE \n          1806c896b7bb39ee4ba5c6b28fc687e7.e31a13b0019fa14358cccecf46ab6bac        = 7b47d9e838fd67702453508564ca22b3.e31a13b0019fa14358cccecf46ab6bac\n        AND 1806c896b7bb39ee4ba5c6b28fc687e7.839c4ffb4bfaae1bb58eab4dee67d96a        = 7b47d9e838fd67702453508564ca22b3.839c4ffb4bfaae1bb58eab4dee67d96a\n        AND 1806c896b7bb39ee4ba5c6b28fc687e7.33cde6b92bd1b2a3d489b84803485187 = 7b47d9e838fd67702453508564ca22b3.33cde6b92bd1b2a3d489b84803485187\n        AND de459e2fe7f96e4d958537b31b946b26.fcc55a82da91e429eaffc482050485ebe472b097974b0d6a9a7d2ed170324906.2603c45be643e5cd8f9c6dad3bee6cb3   = 7b47d9e838fd67702453508564ca22b3.2603c45be643e5cd8f9c6dad3bee6cb3\n        )\n      )';\n   DBMS_OUTPUT.put_line (v_sql);\n\n   EXECUTE IMMEDIATE v_sql;\n\n   DBMS_OUTPUT.put_line ('Rows processed: ' || SQL%ROWCOUNT);\n   COMMIT;\n\n   EXECUTE IMMEDIATE 'alter session  set NLS_DATE_FORMAT=''DD-MON-YY''';\n\n   RETURN 0;\nEXCEPTION\n   WHEN OTHERS\n   THEN\n      DBMS_OUTPUT.put_line (SQLERRM);\n      RETURN SQLCODE;\nEND fn_xdm_sales_mktplus_aggr_load;\n/",
            "upstream_dependencies": [],
            "downstream_dependencies": [],
            "dag_location": "null",
            "gantt_location": "null",
            "created_at": "null",
            "updated_at": "null"
        },
        {
            "name": "FN_SLS_SUMM_CLNDRMO_RFRSH",
            "encrypted_name": "902847b34476217ba69f6ad1b09299eff7d3324de0c6c5829d4545718335f281",
            "type": "function",
            "database": "null",
            "encrypted_database": "null",
            "schema": "XDMADM",
            "encrypted_schema": "0e03d5c46556a742ba46252698396ef2",
            "fully_qualified_name": "XDMADM.FN_SLS_SUMM_CLNDRMO_RFRSH",
            "encrypted_fqn": "0e03d5c46556a742ba46252698396ef2.902847b34476217ba69f6ad1b09299eff7d3324de0c6c5829d4545718335f281",
            "synonyms": [],
            "metadata_analysis": "CREATE OR REPLACE FUNCTION \"0e03d5c46556a742ba46252698396ef2\".\"902847b34476217ba69f6ad1b09299eff7d3324de0c6c5829d4545718335f281\"\n   (p_prcs_dt IN VARCHAR2)\n      RETURN NUMBER\n   AS\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n  CON_PROCESS_NAME  CONSTANT varchar2(40) := 'FN_SLS_SUMM_CLNDRMO_RFRSH';\n  CON_PRRTY_SEVERE  CONSTANT INTEGER := 1;\n  CON_PRRTY_WARN    CONSTANT INTEGER := 2;\n  CON_PRRTY_INFO    CONSTANT INTEGER := 3;\n  CON_PRRTY_DEBUG   CONSTANT INTEGER := 4;\n  CON_ERR_LVL       CONSTANT INTEGER := 3;\n  CON_REC_LIMIT     CONSTANT NUMBER := 500;\n  CON_COMM_LIMIT    CONSTANT NUMBER := 1000;\n\n\n\n      v_fisc_yr_mth    varchar2 (06);\n      n_syn_count      number(1) := -1;\n      v_syn_tbl_nm     varchar2(100);\n      n_re_run         number(2) := -1;\n      d_run_frm_dt     date;\n      d_run_to_dt      date;\n      d_prcs_dt        date := to_date(p_prcs_dt,'YYYYMMDD');\n      b_trunc_allow    boolean;\n      n_trunc_ret           number(3);\n      d_first_day_curr_run  date;\n      d_last_day_curr_run   date;\n      n_insert_start_flag   number(1) :=-1;\n      n_rows_inserted       number(15);\n      n_tot_rows_inserted   number(15) := 0;\n      i                     number(15);  \n      n_no_of_periods_frm_log     number(2);\n      n_tot_rows_inserted_frm_log number(15);\n      v_synonym_nm      varchar2(50) := 'SALES_SUMM_CLNDRMO_CORP';\n      v_usr_div_date    varchar2 (20)       DEFAULT NULL;\n      v_sales_vpd       varchar2 (4000)     DEFAULT NULL;\n      v_div_vpd         varchar2 (4000)     DEFAULT NULL;\n\n\n\n   v_prcs_nm            varchar(100);\n   v_prcs_stp           varchar(100);\n   v_prcs_pram          varchar(100);\n   v_prcs_err_cd        varchar(200);\n   v_prcs_err_msg       varchar(200);\n   v_dba_func_msg       varchar(200);\n\n\n\n   v_compress_retval    varchar(200);\n   v_dis_ind_retval     varchar(200);\n   v_enb_ind_retval     varchar(200);\n   v_trunc_ret_cd       varchar(200);\n   v_tbl_prt_name       varchar(60);\n   v_out_msg            varchar(200);\n   v_dyn_sql_stmt       varchar(32767);\n   v_tgt_table_owner    varchar2(30):='XDMADM';\n   v_tgt_table_name     varchar2(30):='ERROR_IN_TBL_NAME';\n\n\n\n   ALL_EXCEPTIONS       EXCEPTION;\n\n\n\n\n    \n    CURSOR c_get_dt_range (p_dt_frm date, p_dt_to date) IS\n        SELECT clndr_yr_qtr, MIN(clndr_dt) dt_frm, MAX(clndr_dt) dt_to\n        FROM de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001\n        WHERE\n        clndr_dt BETWEEN p_dt_frm AND p_dt_to\n        GROUP BY clndr_yr_qtr  ORDER BY 2 ASC;\n\n    TYPE  rt_get_dt_range IS TABLE OF c_get_dt_range%ROWTYPE;\n    rec_get_dt_range    rt_get_dt_range;\n\n\n\n   BEGIN\n        dbms_output.put_line('Start Process '||CON_PROCESS_NAME);\n        dbms_output.put_line('Start Time:'||TO_CHAR(SYSDATE,'YYYY-MM-DD HH24:MI:SS'));\n        v_prcs_nm  := CON_PROCESS_NAME ;\n        v_prcs_pram:= '   PARAM1 = '||p_prcs_dt;\n        v_prcs_stp := 'Start Process '||CON_PROCESS_NAME;\n\n\n\n   <<SELECT_INCT_TABLE>>\n   v_prcs_stp := 'Select Inactive table to load';\n   SELECT tbl_nm INTO v_tgt_table_name FROM 9751bbbcfea690cc0be4d58830a6fe2e.56ac3befbcbada23fa9268d8fe6d5242 WHERE actv_ind = 'N' AND synonym_nm = v_synonym_nm;\n   dbms_output.put_line('Inactive Table which will be loaded:'||v_tgt_table_name);\n\n\n\n\n   <<VALIDATE_TABLE>>\n   v_prcs_stp := 'Validate if synonym is pointing to active table only';\n   SELECT count(*) INTO n_syn_count\n   FROM ALL_SYNONYMS\n   WHERE   owner = 'XDMADM'\n   AND     synonym_name = v_synonym_nm\n   AND     table_name   = (SELECT tbl_nm\n                              FROM   9751bbbcfea690cc0be4d58830a6fe2e.56ac3befbcbada23fa9268d8fe6d5242\n                              WHERE  actv_ind = 'Y'\n                              AND    synonym_nm = v_synonym_nm\n                          );\n\n   IF n_syn_count > 0 THEN\n        dbms_output.put_line('Synonym verified');\n   ELSE\n        dbms_output.put_line('Synonym Verification Failed');\n        RAISE ALL_EXCEPTIONS;\n   END IF;\n\n\n\n\n   <<FIND_RUN_FROM_AND_TO_DATE>>\n   v_prcs_stp := 'Check if current execution is Re-Run';\n   DBMS_OUTPUT.put_line ('Fetching data from 9751bbbcfea690cc0be4d58830a6fe2e.d824420d4aeadbc3ae2b1e8abb64645b80699da2b1f33333141b43ab7c54627d to check if this is Re-run');\n\n   SELECT count(*) INTO n_re_run\n        FROM 9751bbbcfea690cc0be4d58830a6fe2e.d824420d4aeadbc3ae2b1e8abb64645b80699da2b1f33333141b43ab7c54627d\n        WHERE 1=1\n        AND prcs_date = d_prcs_dt\n       AND tbl_nm like 'SALES_SUMM_CLNDRMO_CORP%' \n        AND ld_status  <> 'SUCCESS'\n        AND ld_status  <> 'VLD-FAIL';\n\n   DBMS_OUTPUT.put_line ('Records successfully fetched from 9751bbbcfea690cc0be4d58830a6fe2e.d824420d4aeadbc3ae2b1e8abb64645b80699da2b1f33333141b43ab7c54627d');\n   DBMS_OUTPUT.put_line ('Calculating Dates');\n\n   d_run_to_dt  := LAST_DAY(TO_DATE(p_prcs_dt,'YYYYMMDD'));\n\n   \n   \n       select\n       to_date(case when FISC_YR < clndr_yr then to_char(add_months(trunc(d_prcs_dt, 'YYYY'), -36))  else to_char(add_months(trunc(d_prcs_dt, 'YYYY'), -24))  end )\n        into d_first_day_curr_run\n       from de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001  where clndr_dt = trunc(d_prcs_dt);\n\n\n   DBMS_OUTPUT.put_line ('Calculating Dates Completed ');\n\n   DBMS_OUTPUT.put_line ('Checking Re-Run');\n   IF n_re_run > 0 THEN      \n        select min(ld_dt_rng_frm) INTO d_run_frm_dt\n          from 9751bbbcfea690cc0be4d58830a6fe2e.d824420d4aeadbc3ae2b1e8abb64645b80699da2b1f33333141b43ab7c54627d\n         where prcs_date = to_date(d_prcs_dt)\n           and tbl_nm like 'SALES_SUMM_CLNDRMO_CORP%' \n           and ld_status  <> 'SUCCESS'\n           and ld_status  <> 'VLD-FAIL';\n\n        DBMS_OUTPUT.put_line ('It is Re-run from date '||d_run_frm_dt);\n   ELSE\n        d_run_frm_dt := d_first_day_curr_run;\n        DBMS_OUTPUT.put_line ('It is a new run from date '||d_run_frm_dt);\n   END IF;\n   DBMS_OUTPUT.put_line ('Checking Re-Run Completed');\n\n\n\n\n\n   <<GET_QTR_LIST>>\n   v_prcs_stp := 'Retrieve the Months List need to load during current run';\n   DBMS_OUTPUT.put_line ('Opeing Cursor p_dt_frm:'||d_run_frm_dt||'   p_dt_to:'||d_run_to_dt);\n   OPEN c_get_dt_range(d_run_frm_dt, d_run_to_dt);\n   FETCH c_get_dt_range BULK COLLECT INTO rec_get_dt_range;\n   CLOSE c_get_dt_range;\n   DBMS_OUTPUT.put_line ('Closing Cursor');\n   DBMS_OUTPUT.put_line ('No of Periods will be loaded in this Run: '||15d086c625deab5ea8dd7dc95d07567ce32f6dd38f333cde68119d1f277367cd.26fd1c0cd65cf53eadf725ede4bbd5f1);\n\n\n\n\n   <<LOAD_BLANK_REC_IN_LOG_TABLE>>\n   v_prcs_stp := 'Loading the dcom_sales_summ_load_log Table with blank entries';\n   IF NOT n_re_run > 0 THEN \n       DBMS_OUTPUT.put_line (v_prcs_stp);\n       DELETE FROM 9751bbbcfea690cc0be4d58830a6fe2e.d824420d4aeadbc3ae2b1e8abb64645b80699da2b1f33333141b43ab7c54627d WHERE tbl_nm like 'SALES_SUMM_CLNDRMO_CORP%' ; \n       \n       DBMS_OUTPUT.PUT_LINE('Deleting from 42183b964ff47e407206508ef9606770.582c1d61f9a55f903dc0f8730989b03dec48b6067e2263fb17fd625a84d00b57 table' );\n\n       \n           \n              \n              \n\n\n       DBMS_OUTPUT.PUT_LINE('42183b964ff47e407206508ef9606770.582c1d61f9a55f903dc0f8730989b03dec48b6067e2263fb17fd625a84d00b57 table deleted successfully');\n\n\n       FOR i IN 15d086c625deab5ea8dd7dc95d07567ce32f6dd38f333cde68119d1f277367cd.553895e5e063ac6e43387e4f18a91e29..15d086c625deab5ea8dd7dc95d07567ce32f6dd38f333cde68119d1f277367cd.41be50fc80e1234211b6c5a37e8fdbb9\n       LOOP\n            INSERT INTO 9751bbbcfea690cc0be4d58830a6fe2e.d824420d4aeadbc3ae2b1e8abb64645b80699da2b1f33333141b43ab7c54627d\n            VALUES (d_prcs_dt,\n                    v_tgt_table_name,\n                    rec_get_dt_range(i).dt_frm,\n                    rec_get_dt_range(i).dt_to,\n                    'NT-STRTD',\n                    null,\n                    null,\n                    null,\n                    null,\n                    sysdate\n                    );\n       END LOOP;\n       COMMIT;\n       DBMS_OUTPUT.put_line ('Completed '||v_prcs_stp);\n   END IF;\n\n\n\n\n   <<TRUNCATE_TARGET_TABLE>>\n   v_prcs_stp := 'Truncating/Deleting records from the target Table';\n   \n   IF NOT n_re_run > 0 THEN \n        b_trunc_allow := 8e64339f96bb08058f5d52f1c04f954a.8ffe4678890c39c7d4ed38c2ed759e24.f660a96a1e6148d27632607509978dd33ecff2bdb6f53706c5ac7bc53ac16112 (v_out_msg, v_tgt_table_owner,v_tgt_table_name);\n        DBMS_OUTPUT.PUT_LINE(v_out_msg);\n        IF b_trunc_allow = TRUE THEN\n            n_trunc_ret := 8e64339f96bb08058f5d52f1c04f954a.8ffe4678890c39c7d4ed38c2ed759e24.e4b5db2b3f9b19accbb8cddbfcd05bac(v_out_msg, v_tgt_table_owner,v_tgt_table_name);\n            DBMS_OUTPUT.PUT_LINE(v_out_msg);\n            IF n_trunc_ret != 0 THEN\n                DBMS_OUTPUT.PUT_LINE('Error in Truncating the '||v_tgt_table_name||' table');\n                RAISE ALL_EXCEPTIONS;\n            END IF;\n        ELSE\n            DBMS_OUTPUT.PUT_LINE('USFDBA Security doesn''t allow to truncate '||v_tgt_table_name||' table');\n            DBMS_OUTPUT.PUT_LINE('     Check entry in 7540495dc7d95c8483c39c98db3db89c.3c6e9cb9d3836831584b90275ef803f4 table for '||v_tgt_table_name||' table');\n            RAISE ALL_EXCEPTIONS;\n        END IF;\n\n    END IF;\n\n\n\n\n\n   <<SALES_VPD>>\n\n    BEGIN\n\n\n           \n              SELECT TO_CHAR(MIN(div_load_ts), 'YYYYMMDDHH24MISS')\n                INTO v_usr_div_date\n                FROM de459e2fe7f96e4d958537b31b946b26.0b3320d3f985cd20d1ec65d9dfeed2de\n               WHERE div_load_stat = 0\n                    AND fact_table = 'SALES_CORP';\n\n              IF v_usr_div_date IS NOT NULL\n                THEN\n                  v_sales_vpd := ' and TO_DATE(to_char(NVL(e9a95106e01380a7834d36560e919770.6aad564fb2381f50b58f8d5a0fb08cbd,e9a95106e01380a7834d36560e919770.721a8ad171b31ae60261431ccd51b52d)),''YYYYMMDDHH24MISS'') <  TO_DATE('''||v_usr_div_date||''',''YYYYMMDDHH24MISS'')';\n                  v_sales_vpd := v_sales_vpd || ' and e9a95106e01380a7834d36560e919770.467a168a7499c57b1859198a7dac7be0 IS NULL';\n              ELSE\n                  v_sales_vpd := ' and e9a95106e01380a7834d36560e919770.467a168a7499c57b1859198a7dac7be0 is null';\n              END IF;\n    END;\n\n   <<DIV_VPD>>\n\n           v_div_vpd :=  '                AND ( fce896ca0fbbf5a5d330f2803036eb44.2edfd837e0441242d7eed4e0cdf56652 IS NULL OR fce896ca0fbbf5a5d330f2803036eb44.6d74bb3e26f02dd707dc6b3b68070169 > SYSDATE)';\n\n\n\n\n\n\n   <<LOAD_DCOM_SALES_AGG_TABLE>>\n\n   BEGIN\n\n       v_prcs_stp := 'Insert data into target table';\n\n       FOR i IN 15d086c625deab5ea8dd7dc95d07567ce32f6dd38f333cde68119d1f277367cd.553895e5e063ac6e43387e4f18a91e29..15d086c625deab5ea8dd7dc95d07567ce32f6dd38f333cde68119d1f277367cd.41be50fc80e1234211b6c5a37e8fdbb9\n       LOOP\n           BEGIN\n                n_insert_start_flag := 1;\n                v_prcs_stp := 'Inserting for Period '||rec_get_dt_range(i).clndr_yr_qtr;\n                DBMS_OUTPUT.put_line (v_prcs_stp);\n\n\n                UPDATE 9751bbbcfea690cc0be4d58830a6fe2e.d824420d4aeadbc3ae2b1e8abb64645b80699da2b1f33333141b43ab7c54627d\n                SET ld_status = 'INS-STRT',\n                    prcs_step  = v_prcs_stp,\n                    last_updt = sysdate\n                WHERE prcs_date = d_prcs_dt\n                AND   tbl_nm = v_tgt_table_name\n                AND   ld_dt_rng_frm = to_date(rec_get_dt_range(i).dt_frm)\n                AND   ld_dt_rng_to = to_date(rec_get_dt_range(i).dt_to);\n\n                COMMIT;\n\n\n                \n                \n\n                v_dyn_sql_stmt:=\n                   ' INSERT  INTO '\n             || v_tgt_table_owner||'.'||v_tgt_table_name||' NOLOGGGING  '\n             ||' SELECT\n             de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.852fa1e9f02f1ca2c75837f7146b2381,\n             de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.839c4ffb4bfaae1bb58eab4dee67d96a,\n             de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.2d45d761eb8d137835bca7a23010fab4,\n             de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.ace2a1073ed6fb5bfaada3f8d55c487b,\n             de459e2fe7f96e4d958537b31b946b26.2c04d82ed0aa1cc9bce2cf2c0548b268.d3268eabc4a7d98105fd85f9c9e62cd6e32ad436514bbe822b33de8bead744f3,\n             nvl(de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.abfa8e82cd46bbb827127b6cb2f5d6d5,0),\n             trunc(de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.222ccb1d1746bcdb2365f29b3da0b613,''MON''),\n             last_day(de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.222ccb1d1746bcdb2365f29b3da0b613),\n             sum(de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.baa23b8932072303310f88d528c93b04),\n             sum(de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.eaa03e417a6b67a32172cc9dca631f77),\n             sum(de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.dc15696e1e997bad6131bf936574f406),\n             sum(de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.ccf8d88f2d37f3171da2121ab22e9330),\n             sum(de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.b215402101f7a4f20fccac979c4d9b44),\n             sum(de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.d4e40e976e264ee8a5a57f4f800d6c3b),\n             sum(de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.424607a0ca73330c3cc1e84dfe4afa64),\n             sum(de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.e1b1859b558f14ea9916a5dbcd02473a),\n             sum(de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.d16361da5462bcd47e380bc6594c4a0b),\n             sum(de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.2ee1400a0150f0b220dd7bd6268d1e66),\n             sum(de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.63a91e2fd122990392b8c1467a67b61e),\n             sum(de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.f4684b698d1e8edd11bf71d8eac02595),\n             sum(de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.b929d681ced63c6b203aa9a1d8973da4),\n             sum(de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.60a12efca79b9e843a21f9dd325e6a80e32f6dd38f333cde68119d1f277367cd),\n             sum(de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.aea2b843066cbf7530af94deb507a420)\n              FROM de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c s,\n             de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001 t,\n             de459e2fe7f96e4d958537b31b946b26.2c04d82ed0aa1cc9bce2cf2c0548b268 p,\n             de459e2fe7f96e4d958537b31b946b26.dec387908a0954ddc8689c4ad37c8a3c d,\n             de459e2fe7f96e4d958537b31b946b26.dec387908a0954ddc8689c4ad37c8a3c rev_div\n             WHERE 1=1   '\n             ||      v_sales_vpd   ||\n           ' AND de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.f5dd4374a3e3af6a775cb6d6b22e8162= de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.222ccb1d1746bcdb2365f29b3da0b613\n             AND de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.fa741a84bd7a01a1c4b5dc91364baac5 = de459e2fe7f96e4d958537b31b946b26.dec387908a0954ddc8689c4ad37c8a3c.fa741a84bd7a01a1c4b5dc91364baac5\n             AND de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.8b8c72c349530db846280000957f636d = de459e2fe7f96e4d958537b31b946b26.2c04d82ed0aa1cc9bce2cf2c0548b268.8b8c72c349530db846280000957f636d\n             AND de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.26ac88e7ae671a1b22c14c2fce77aa2d not in (''AP'') '\n             || v_div_vpd      ||\n           ' AND de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.222ccb1d1746bcdb2365f29b3da0b613 between :dt_frm and :dt_to\n             AND NVL (a95a09b2641cac5597ee63e380dd2738.fb77d39bc5d09c4429027637da8ca1f3,''USF'') = ''USF''\n             And NVL (bd4f6be5a9a2a84272b99dc7c512050f.dd95a4741b2ab36b2428b3c42ef8b0448cd47113485ed05c776655af504ed664, bd4f6be5a9a2a84272b99dc7c512050f.4fdc122fb2d10dd764e32cbc98972eca) = 7bbc500993f8c1384ba73fe9d8ff44f8.4fdc122fb2d10dd764e32cbc98972eca\n             GROUP BY de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.852fa1e9f02f1ca2c75837f7146b2381,\n             de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.839c4ffb4bfaae1bb58eab4dee67d96a,\n             de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.2d45d761eb8d137835bca7a23010fab4,\n             de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.ace2a1073ed6fb5bfaada3f8d55c487b,\n             de459e2fe7f96e4d958537b31b946b26.2c04d82ed0aa1cc9bce2cf2c0548b268.d3268eabc4a7d98105fd85f9c9e62cd6e32ad436514bbe822b33de8bead744f3,\n             nvl(de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.abfa8e82cd46bbb827127b6cb2f5d6d5,0),\n             trunc(de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.222ccb1d1746bcdb2365f29b3da0b613,''MON''),\n             last_day(de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.222ccb1d1746bcdb2365f29b3da0b613)   '\n             ;\n\n\n\n              EXECUTE IMMEDIATE v_dyn_sql_stmt USING rec_get_dt_range(i).dt_frm, rec_get_dt_range(i).dt_to;\n\n              n_rows_inserted := SQL%ROWCOUNT;\n\n              n_tot_rows_inserted := n_tot_rows_inserted + n_rows_inserted;\n\n              UPDATE 9751bbbcfea690cc0be4d58830a6fe2e.d824420d4aeadbc3ae2b1e8abb64645b80699da2b1f33333141b43ab7c54627d\n                SET ld_status = 'SUCCESS',\n                    prcs_step  = v_prcs_stp,\n                    recs_insrtd = n_rows_inserted,\n                    last_updt = sysdate\n                WHERE prcs_date = d_prcs_dt\n                AND   tbl_nm = v_tgt_table_name\n                AND   ld_dt_rng_frm = to_date(rec_get_dt_range(i).dt_frm)\n                AND   ld_dt_rng_to  = to_date(rec_get_dt_range(i).dt_to);\n\n              COMMIT;\n              DBMS_OUTPUT.put_line ('Rows Inserted for '||rec_get_dt_range(i).clndr_yr_qtr||' period: ' || n_rows_inserted);\n\n            EXCEPTION\n              WHEN OTHERS THEN\n                ROLLBACK;\n                UPDATE 9751bbbcfea690cc0be4d58830a6fe2e.d824420d4aeadbc3ae2b1e8abb64645b80699da2b1f33333141b43ab7c54627d\n                SET ld_status = 'LD-FAIL',\n                    prcs_step  = v_prcs_stp,\n                    last_updt = sysdate\n                WHERE prcs_date = d_prcs_dt\n                AND   tbl_nm = v_tgt_table_name\n                AND   ld_dt_rng_frm = to_date(rec_get_dt_range(i).dt_frm)\n                AND   ld_dt_rng_to  = to_date(rec_get_dt_range(i).dt_to);\n                COMMIT;\n                RAISE;\n            END;\n        END LOOP;\n   END;\n\n   DBMS_OUTPUT.PUT_LINE (v_dyn_sql_stmt);\n\n   DBMS_OUTPUT.put_line ('Total Rows Inserted : '|| n_tot_rows_inserted);\n\n\n\n\n   v_prcs_stp := 'Retrieve the total list of all Months loaded';\n   DBMS_OUTPUT.put_line ('Opeing Cursor p_dt_frm:'||d_run_frm_dt||'   p_dt_to:'||d_run_to_dt);\n   OPEN c_get_dt_range(d_first_day_curr_run, d_run_to_dt);\n   FETCH c_get_dt_range BULK COLLECT INTO rec_get_dt_range;\n   CLOSE c_get_dt_range;\n   DBMS_OUTPUT.put_line ('Closing Cursor');\n   DBMS_OUTPUT.put_line ('Total No of Periods should be loaded : '||15d086c625deab5ea8dd7dc95d07567ce32f6dd38f333cde68119d1f277367cd.26fd1c0cd65cf53eadf725ede4bbd5f1);\n\n\n\n\n\n    SELECT count(*) INTO n_no_of_periods_frm_log\n                        FROM 9751bbbcfea690cc0be4d58830a6fe2e.d824420d4aeadbc3ae2b1e8abb64645b80699da2b1f33333141b43ab7c54627d\n                        WHERE ld_status = 'SUCCESS'\n                     AND   tbl_nm = v_tgt_table_name\n                        group by prcs_date;\n\n    IF 15d086c625deab5ea8dd7dc95d07567ce32f6dd38f333cde68119d1f277367cd.26fd1c0cd65cf53eadf725ede4bbd5f1 <> n_no_of_periods_frm_log THEN\n        DBMS_OUTPUT.put_line ('Validation Failed for Number of Periods');\n        DBMS_OUTPUT.put_line ('No of Periods ('||15d086c625deab5ea8dd7dc95d07567ce32f6dd38f333cde68119d1f277367cd.26fd1c0cd65cf53eadf725ede4bbd5f1||') <> No of Periods from Log ('||n_no_of_periods_frm_log||')');\n        UPDATE 9751bbbcfea690cc0be4d58830a6fe2e.d824420d4aeadbc3ae2b1e8abb64645b80699da2b1f33333141b43ab7c54627d\n           SET ld_status = 'VLD-FAIL'\n         WHERE prcs_date = to_date(d_prcs_dt)\n         AND   tbl_nm = v_tgt_table_name;\n        COMMIT;\n        RAISE ALL_EXCEPTIONS;\n    ELSE\n        DBMS_OUTPUT.put_line ('No of Periods ('||15d086c625deab5ea8dd7dc95d07567ce32f6dd38f333cde68119d1f277367cd.26fd1c0cd65cf53eadf725ede4bbd5f1||') = No of Periods from Log ('||n_no_of_periods_frm_log||')');\n    END IF;\n\n\n\n\n  <<Wrap_Program>>\n\n      v_prcs_stp := 'Final Commit';\n\n      COMMIT;\n\n      dbms_output.put_line('End Process '||CON_PROCESS_NAME);\n      dbms_output.put_line('End Time:'||TO_CHAR(SYSDATE,'YYYY-MM-DD HH24:MI:SS'));\n\n      RETURN 0;\n\n\n\n   EXCEPTION\n      WHEN ALL_EXCEPTIONS\n      THEN\n         ROLLBACK;\n         DBMS_OUTPUT.put_line ('error raised at step:');\n         DBMS_OUTPUT.put_line ('******'||v_prcs_stp);\n         RETURN 1;\n      WHEN OTHERS\n      THEN\n          ROLLBACK;\n         DBMS_OUTPUT.put_line ('ERROR:' || SQLCODE || ',' || SQLERRM);\n         DBMS_OUTPUT.put_line (v_dyn_sql_stmt);\n         DBMS_OUTPUT.PUT_LINE(       v_prcs_nm\n                            ||' - '||v_prcs_stp\n                            ||' - '||v_prcs_pram);\n         RETURN 2;\n   END FN_SLS_SUMM_CLNDRMO_RFRSH;\n/",
            "upstream_dependencies": [],
            "downstream_dependencies": [],
            "dag_location": "null",
            "gantt_location": "null",
            "created_at": "null",
            "updated_at": "null"
        },
        {
            "name": "FN_PYR_SLS_SYN_SWAP",
            "encrypted_name": "a4628e525d38523907591ec36481d1e98013bf5b8be037b748b31a500198bbd1",
            "type": "function",
            "database": "null",
            "encrypted_database": "null",
            "schema": "XDMADM",
            "encrypted_schema": "0e03d5c46556a742ba46252698396ef2",
            "fully_qualified_name": "XDMADM.FN_PYR_SLS_SYN_SWAP",
            "encrypted_fqn": "0e03d5c46556a742ba46252698396ef2.a4628e525d38523907591ec36481d1e98013bf5b8be037b748b31a500198bbd1",
            "synonyms": [],
            "metadata_analysis": "CREATE OR REPLACE FUNCTION \"0e03d5c46556a742ba46252698396ef2\".\"a4628e525d38523907591ec36481d1e98013bf5b8be037b748b31a500198bbd1\" (odate IN DATE)\n   RETURN NUMBER AS\n   \n\n   \n   l_aggr_active_tbl        VARCHAR2(30);\n   l_aggr_inactive_tbl      VARCHAR2(30);\n   v_clndr_day_nm           VARCHAR2(30);  \n   v_sat                    DATE;          \n\n \n\n   l_cust_pyr_active_tbl    VARCHAR2(30);  \n   l_cust_pyr_inactive_tbl  VARCHAR2(30);  \n   l_pim_pyr_active_tbl     VARCHAR2(30);  \n   l_pim_pyr_inactive_tbl   VARCHAR2(30);  \n\n\n   l_sls_mrch_active_tbl    VARCHAR2(30);  \n   l_sls_mrch_inactive_tbl  VARCHAR2(30);  \n   l_pim_mrch_active_tbl    VARCHAR2(30);  \n   l_pim_mrch_inactive_tbl  VARCHAR2(30);  \n\n   v_prcs_stp               VARCHAR2(256);\n   l_active_vw              VARCHAR2(30);\n   l_inactive_vw            VARCHAR2(30);\n   l_return_code            NUMBER := 0;\n   l_object_nm              VARCHAR2(30);\n   l_out_msg                VARCHAR2(256);\n   e_create_synonym exception;\n   e_truncate_table exception;\nBEGIN\n\n\n\n\nv_prcs_stp := 'Start Process - Sales Pyramid Aggregate Table';\n\n   \n\n   l_aggr_active_tbl     := 6726798abbc757d8442516fefb8c40e9.764db46f8b9234b5e07a7d1d4ce8fcd8(6726798abbc757d8442516fefb8c40e9.716900750ba6b5d499e5b9bc59348974, 'Y');\n   l_aggr_inactive_tbl   := 6726798abbc757d8442516fefb8c40e9.764db46f8b9234b5e07a7d1d4ce8fcd8(6726798abbc757d8442516fefb8c40e9.716900750ba6b5d499e5b9bc59348974, 'N');\n\n   \n\n   6726798abbc757d8442516fefb8c40e9.81dd02b30e5e0bfc7e15dd5a941ade88(l_aggr_active_tbl, 'N');\n   6726798abbc757d8442516fefb8c40e9.81dd02b30e5e0bfc7e15dd5a941ade88(l_aggr_inactive_tbl, 'Y');\n\n   \n\n   l_return_code         := fn_crt_synonym(6726798abbc757d8442516fefb8c40e9.716900750ba6b5d499e5b9bc59348974, 6726798abbc757d8442516fefb8c40e9.01ad20b6c8a2d0aaccf3dde9aaedb75e, l_aggr_inactive_tbl);\n\n   IF (l_return_code <> 0) THEN\n      l_object_nm   := 6726798abbc757d8442516fefb8c40e9.716900750ba6b5d499e5b9bc59348974;\n      RAISE e_create_synonym;\n   END IF;\n\n   \n   l_return_code         := 8e64339f96bb08058f5d52f1c04f954a.8ffe4678890c39c7d4ed38c2ed759e24.e4b5db2b3f9b19accbb8cddbfcd05bac(l_out_msg, 6726798abbc757d8442516fefb8c40e9.01ad20b6c8a2d0aaccf3dde9aaedb75e, l_aggr_active_tbl);\n\n   IF (l_return_code <> 0) THEN\n      l_object_nm   := l_aggr_active_tbl;\n      RAISE e_truncate_table;\n   END IF;\n\n   DBMS_OUTPUT.put_line('Previous active aggregate table: ' || l_aggr_active_tbl);\n   DBMS_OUTPUT.put_line('New active aggregate table: ' || l_aggr_inactive_tbl);\n   DBMS_OUTPUT.put_line('Truncated table: ' || l_aggr_active_tbl);\n\nv_prcs_stp := 'End Process - Sales Pyramid Aggregate Table';\n\n\n\n\n\n\n   v_prcs_stp := 'Start Process - Exec Summ Customer Dimension Table';\n\n  \n\n   l_cust_pyr_active_tbl      := 6726798abbc757d8442516fefb8c40e9.764db46f8b9234b5e07a7d1d4ce8fcd8(6726798abbc757d8442516fefb8c40e9.c096eb07ba7cd7f4e86307b893587b1798df5d6b623334f2e9631188cca4cfd6, 'Y');\n   l_cust_pyr_inactive_tbl    := 6726798abbc757d8442516fefb8c40e9.764db46f8b9234b5e07a7d1d4ce8fcd8(6726798abbc757d8442516fefb8c40e9.c096eb07ba7cd7f4e86307b893587b1798df5d6b623334f2e9631188cca4cfd6, 'N');\n\n   \n   6726798abbc757d8442516fefb8c40e9.81dd02b30e5e0bfc7e15dd5a941ade88(l_cust_pyr_active_tbl, 'N');\n   6726798abbc757d8442516fefb8c40e9.81dd02b30e5e0bfc7e15dd5a941ade88(l_cust_pyr_inactive_tbl, 'Y');\n\n   \n   l_return_code         := fn_crt_synonym(6726798abbc757d8442516fefb8c40e9.c096eb07ba7cd7f4e86307b893587b1798df5d6b623334f2e9631188cca4cfd6, 6726798abbc757d8442516fefb8c40e9.01ad20b6c8a2d0aaccf3dde9aaedb75e, l_cust_pyr_inactive_tbl);\n\n   IF (l_return_code <> 0) THEN\n      l_object_nm   := 6726798abbc757d8442516fefb8c40e9.c096eb07ba7cd7f4e86307b893587b1798df5d6b623334f2e9631188cca4cfd6;\n      RAISE e_create_synonym;\n   END IF;\n\n  \n   l_return_code         := 8e64339f96bb08058f5d52f1c04f954a.8ffe4678890c39c7d4ed38c2ed759e24.e4b5db2b3f9b19accbb8cddbfcd05bac(l_out_msg, 6726798abbc757d8442516fefb8c40e9.01ad20b6c8a2d0aaccf3dde9aaedb75e, l_cust_pyr_active_tbl);\n\n   IF (l_return_code <> 0) THEN\n      l_object_nm   := l_cust_pyr_active_tbl;\n      RAISE e_truncate_table;\n   END IF;\n\n   DBMS_OUTPUT.put_line('Previous active Cust Merchandising table: ' || l_cust_pyr_active_tbl);\n   DBMS_OUTPUT.put_line('New active Cust Merchandising table: ' || l_cust_pyr_inactive_tbl);\n   DBMS_OUTPUT.put_line('Truncated Cust Merchandising table: ' || l_cust_pyr_active_tbl);\n\n   v_prcs_stp := 'End Process - Exec Summ Customer Dimension Table';\n\n\n\n   v_prcs_stp := 'Start Process - Exec Summ PIM Dimension Table';\n\n   \n\n   l_pim_pyr_active_tbl      := 6726798abbc757d8442516fefb8c40e9.764db46f8b9234b5e07a7d1d4ce8fcd8(6726798abbc757d8442516fefb8c40e9.4d4b0cb35bdf9d8d3a1e5a31cbfcdbece32f6dd38f333cde68119d1f277367cd, 'Y');\n   l_pim_pyr_inactive_tbl    := 6726798abbc757d8442516fefb8c40e9.764db46f8b9234b5e07a7d1d4ce8fcd8(6726798abbc757d8442516fefb8c40e9.4d4b0cb35bdf9d8d3a1e5a31cbfcdbece32f6dd38f333cde68119d1f277367cd, 'N');\n\n   \n   6726798abbc757d8442516fefb8c40e9.81dd02b30e5e0bfc7e15dd5a941ade88(l_pim_pyr_active_tbl, 'N');\n   6726798abbc757d8442516fefb8c40e9.81dd02b30e5e0bfc7e15dd5a941ade88(l_pim_pyr_inactive_tbl, 'Y');\n\n   \n   l_return_code         := fn_crt_synonym(6726798abbc757d8442516fefb8c40e9.4d4b0cb35bdf9d8d3a1e5a31cbfcdbece32f6dd38f333cde68119d1f277367cd, 6726798abbc757d8442516fefb8c40e9.01ad20b6c8a2d0aaccf3dde9aaedb75e, l_pim_pyr_inactive_tbl);\n\n   IF (l_return_code <> 0) THEN\n      l_object_nm   := 6726798abbc757d8442516fefb8c40e9.4d4b0cb35bdf9d8d3a1e5a31cbfcdbece32f6dd38f333cde68119d1f277367cd;\n      RAISE e_create_synonym;\n   END IF;\n\n  \n   l_return_code         := 8e64339f96bb08058f5d52f1c04f954a.8ffe4678890c39c7d4ed38c2ed759e24.e4b5db2b3f9b19accbb8cddbfcd05bac(l_out_msg, 6726798abbc757d8442516fefb8c40e9.01ad20b6c8a2d0aaccf3dde9aaedb75e, l_pim_pyr_active_tbl);\n\n   IF (l_return_code <> 0) THEN\n      l_object_nm   := l_pim_pyr_active_tbl;\n      RAISE e_truncate_table;\n   END IF;\n\n   DBMS_OUTPUT.put_line('Previous active Cust Merchandising table: ' || l_pim_pyr_active_tbl);\n   DBMS_OUTPUT.put_line('New active Cust Merchandising table: ' || l_pim_pyr_inactive_tbl);\n   DBMS_OUTPUT.put_line('Truncated Cust Merchandising table: ' || l_pim_pyr_active_tbl);\n\n   v_prcs_stp := 'End Process - Exec Summ PIM Dimension Table';\n\n   \n\n\n\n\n\n\n   v_prcs_stp := 'Start Process - Sales Merchandising Aggregate Table';\n\n   \n   l_sls_mrch_active_tbl      := 6726798abbc757d8442516fefb8c40e9.764db46f8b9234b5e07a7d1d4ce8fcd8(6726798abbc757d8442516fefb8c40e9.f64584bea00f2f62789af96e13a5718b, 'Y');\n   l_sls_mrch_inactive_tbl    := 6726798abbc757d8442516fefb8c40e9.764db46f8b9234b5e07a7d1d4ce8fcd8(6726798abbc757d8442516fefb8c40e9.f64584bea00f2f62789af96e13a5718b, 'N');\n\n   \n   6726798abbc757d8442516fefb8c40e9.81dd02b30e5e0bfc7e15dd5a941ade88(l_sls_mrch_active_tbl, 'N');\n   6726798abbc757d8442516fefb8c40e9.81dd02b30e5e0bfc7e15dd5a941ade88(l_sls_mrch_inactive_tbl, 'Y');\n\n   \n   l_return_code         := fn_crt_synonym(6726798abbc757d8442516fefb8c40e9.f64584bea00f2f62789af96e13a5718b, 6726798abbc757d8442516fefb8c40e9.01ad20b6c8a2d0aaccf3dde9aaedb75e, l_sls_mrch_inactive_tbl);\n\n   IF (l_return_code <> 0) THEN\n      l_object_nm   := 6726798abbc757d8442516fefb8c40e9.f64584bea00f2f62789af96e13a5718b;\n      RAISE e_create_synonym;\n   END IF;\n\n  \n   l_return_code         := 8e64339f96bb08058f5d52f1c04f954a.8ffe4678890c39c7d4ed38c2ed759e24.e4b5db2b3f9b19accbb8cddbfcd05bac(l_out_msg, 6726798abbc757d8442516fefb8c40e9.01ad20b6c8a2d0aaccf3dde9aaedb75e, l_sls_mrch_active_tbl);\n\n   IF (l_return_code <> 0) THEN\n      l_object_nm   := l_sls_mrch_active_tbl;\n      RAISE e_truncate_table;\n   END IF;\n\n   DBMS_OUTPUT.put_line('Previous active Sales Merchandising table: ' || l_sls_mrch_active_tbl);\n   DBMS_OUTPUT.put_line('New active Sales Merchandising table: ' || l_sls_mrch_inactive_tbl);\n   DBMS_OUTPUT.put_line('Truncated Sales Merchandising table: ' || l_sls_mrch_active_tbl);\n\n   v_prcs_stp := 'End Process - Sales Merchandising Aggregate Table';\n\n\n\n\nv_prcs_stp := 'Start Process - Merchandising PIM Dimension Table';\n\n   \n\n   l_pim_mrch_active_tbl      := 6726798abbc757d8442516fefb8c40e9.764db46f8b9234b5e07a7d1d4ce8fcd8(6726798abbc757d8442516fefb8c40e9.e7eabc3a27076642820a21655ce65199259d3a801bce8877572f4504a8fe6a5e, 'Y');\n   l_pim_mrch_inactive_tbl    := 6726798abbc757d8442516fefb8c40e9.764db46f8b9234b5e07a7d1d4ce8fcd8(6726798abbc757d8442516fefb8c40e9.e7eabc3a27076642820a21655ce65199259d3a801bce8877572f4504a8fe6a5e, 'N');\n\n   \n   6726798abbc757d8442516fefb8c40e9.81dd02b30e5e0bfc7e15dd5a941ade88(l_pim_mrch_active_tbl, 'N');\n   6726798abbc757d8442516fefb8c40e9.81dd02b30e5e0bfc7e15dd5a941ade88(l_pim_mrch_inactive_tbl, 'Y');\n\n  \n   l_return_code         := fn_crt_synonym(6726798abbc757d8442516fefb8c40e9.e7eabc3a27076642820a21655ce65199259d3a801bce8877572f4504a8fe6a5e, 6726798abbc757d8442516fefb8c40e9.01ad20b6c8a2d0aaccf3dde9aaedb75e, l_pim_mrch_inactive_tbl);\n\n   IF (l_return_code <> 0) THEN\n      l_object_nm   := 6726798abbc757d8442516fefb8c40e9.f64584bea00f2f62789af96e13a5718b;\n      RAISE e_create_synonym;\n   END IF;\n\n  \n   l_return_code         := 8e64339f96bb08058f5d52f1c04f954a.8ffe4678890c39c7d4ed38c2ed759e24.e4b5db2b3f9b19accbb8cddbfcd05bac(l_out_msg, 6726798abbc757d8442516fefb8c40e9.01ad20b6c8a2d0aaccf3dde9aaedb75e, l_pim_mrch_active_tbl);\n\n   IF (l_return_code <> 0) THEN\n      l_object_nm   := l_pim_mrch_active_tbl;\n      RAISE e_truncate_table;\n   END IF;\n\n   DBMS_OUTPUT.put_line('Previous active PIM Merchandising table: ' || l_pim_mrch_active_tbl);\n   DBMS_OUTPUT.put_line('New active PIM Merchandising table: ' || l_pim_mrch_inactive_tbl);\n   DBMS_OUTPUT.put_line('Truncated PIM Merchandising table: ' || l_pim_mrch_active_tbl);\n\nv_prcs_stp := 'End Process - Merchandising PIM Dimension Table';\n\n\n\n\n     \n   UPDATE de459e2fe7f96e4d958537b31b946b26.0b3320d3f985cd20d1ec65d9dfeed2de\n      SET div_load_stat = 1, div_load_ts = TRUNC(odate)\n    WHERE fact_table = 6726798abbc757d8442516fefb8c40e9.f64584bea00f2f62789af96e13a5718b;\n\n   \n   IF (sql%ROWCOUNT = 0) THEN\n      INSERT INTO de459e2fe7f96e4d958537b31b946b26.0b3320d3f985cd20d1ec65d9dfeed2de(fact_table, div_nbr, fact_table_dsply_nm, fact_typ_desc, latest_prcs_dt,\n                                        div_load_stat, div_load_ts, prcs_dt, load_freq, rpt_dsply_ind)\n          VALUES (6726798abbc757d8442516fefb8c40e9.f64584bea00f2f62789af96e13a5718b, 0, 'Sales Merchandising', 'Sales Merchandising Aggregate', SYSDATE, 1,\n                  TRUNC(odate), TRUNC(odate) + 1, 'DAILY', 'Y'); \n   END IF;\n\n   COMMIT;\n\n\n      \n\n   BEGIN   \n           select clndr_day_nm into v_clndr_day_nm from de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001 where clndr_dt = TRUNC(odate);\n           if v_clndr_day_nm='SUNDAY' THEN\n                   dbms_output.put_line('Sunday process date. Update with Saturday date.');\n                   v_sat := odate -1;\n                   UPDATE de459e2fe7f96e4d958537b31b946b26.0b3320d3f985cd20d1ec65d9dfeed2de\n                   SET div_load_stat = 1, div_load_ts = TRUNC(v_sat) \n                   WHERE fact_table = 6726798abbc757d8442516fefb8c40e9.716900750ba6b5d499e5b9bc59348974;\n\n                   \n                   IF (sql%ROWCOUNT = 0) THEN\n                      INSERT INTO de459e2fe7f96e4d958537b31b946b26.0b3320d3f985cd20d1ec65d9dfeed2de(fact_table, div_nbr, fact_table_dsply_nm, fact_typ_desc, latest_prcs_dt,\n                                                        div_load_stat, div_load_ts, prcs_dt, load_freq, rpt_dsply_ind)\n                          VALUES (6726798abbc757d8442516fefb8c40e9.716900750ba6b5d499e5b9bc59348974, 0, 'Pyramid Segmentation', 'Pyramid Segmentation', SYSDATE, 1,\n                                  TRUNC(v_sat), TRUNC(v_sat) + 1, 'DAILY', 'Y');\n                    END IF;\n           ELSE    \n                  dbms_output.put_line('It is not a Sunday Date');\n                  \n                    UPDATE de459e2fe7f96e4d958537b31b946b26.0b3320d3f985cd20d1ec65d9dfeed2de\n                    SET div_load_stat = 1, div_load_ts = TRUNC(odate)\n                    WHERE fact_table = 6726798abbc757d8442516fefb8c40e9.716900750ba6b5d499e5b9bc59348974;\n\n                   \n                   IF (sql%ROWCOUNT = 0) THEN\n                      INSERT INTO de459e2fe7f96e4d958537b31b946b26.0b3320d3f985cd20d1ec65d9dfeed2de(fact_table, div_nbr, fact_table_dsply_nm, fact_typ_desc, latest_prcs_dt,\n                                                        div_load_stat, div_load_ts, prcs_dt, load_freq, rpt_dsply_ind)\n                          VALUES (6726798abbc757d8442516fefb8c40e9.716900750ba6b5d499e5b9bc59348974, 0, 'Pyramid Segmentation', 'Pyramid Segmentation', SYSDATE, 1,\n                                  TRUNC(odate), TRUNC(odate) + 1, 'DAILY', 'Y'); \n                   END IF;\n           END IF;\n   END;        \n   COMMIT;\n\n\n\n\n   DBMS_OUTPUT.put_line('Previous active view: ' || l_active_vw);\n   DBMS_OUTPUT.put_line('New active view: ' || l_inactive_vw);\n   RETURN 6726798abbc757d8442516fefb8c40e9.79565b4ea20e0d36bc7365f1c4259002;\nEXCEPTION\n   WHEN e_create_synonym THEN\n      DBMS_OUTPUT.put_line('Error Swapping Synonym: ' || l_object_nm || '. Requires manual update.');\n      RETURN 6726798abbc757d8442516fefb8c40e9.de3afdf274dc4a6f320906a012ba2f12;\n   WHEN e_truncate_table THEN\n      DBMS_OUTPUT.put_line('Error Truncating Table: ' || l_object_nm || '. Requires manual update.');\n      DBMS_OUTPUT.put_line(l_out_msg);\n      RETURN 6726798abbc757d8442516fefb8c40e9.de3afdf274dc4a6f320906a012ba2f12;\n   WHEN OTHERS THEN\n      ROLLBACK;\n      DBMS_OUTPUT.put_line('Unexpected Error In Synonym Swap Procedure. Requires manual update.');\n      DBMS_OUTPUT.put_line(SQLCODE || ': ' || SQLERRM);\n      RETURN 6726798abbc757d8442516fefb8c40e9.de3afdf274dc4a6f320906a012ba2f12;\nEND;\n/",
            "upstream_dependencies": [],
            "downstream_dependencies": [],
            "dag_location": "null",
            "gantt_location": "null",
            "created_at": "null",
            "updated_at": "null"
        },
        {
            "name": "FN_XDM_CUST_PRSPCT_LOAD",
            "encrypted_name": "24eb58bafbe385c02936b04ede7b1696217c80690c883eb1a2d192ffbb747dd4",
            "type": "function",
            "database": "null",
            "encrypted_database": "null",
            "schema": "XDMADM",
            "encrypted_schema": "0e03d5c46556a742ba46252698396ef2",
            "fully_qualified_name": "XDMADM.FN_XDM_CUST_PRSPCT_LOAD",
            "encrypted_fqn": "0e03d5c46556a742ba46252698396ef2.24eb58bafbe385c02936b04ede7b1696217c80690c883eb1a2d192ffbb747dd4",
            "synonyms": [],
            "metadata_analysis": "CREATE OR REPLACE FUNCTION \"0e03d5c46556a742ba46252698396ef2\".\"24eb58bafbe385c02936b04ede7b1696217c80690c883eb1a2d192ffbb747dd4\"\n    (\n      odate IN VARCHAR2,\n      v_tbl_to_load IN VARCHAR2\n    )\n    RETURN NUMBER\n    \n  AS\ncon_process_name CONSTANT VARCHAR2(40) := 'FN_XDM_CUST_PRSPCT_LOAD';\nv_schema_nm        VARCHAR2(30) := 'XDMADM';\nv_tbl_cnt NUMBER       := 0;\nv_return_code      NUMBER       := 0;\nv_object_nm        VARCHAR2(30);\nv_out_msg          VARCHAR2(256);\ne_truncate_table   EXCEPTION;\nALL_EXCEPTIONS   EXCEPTION;\nv_ret_val     NUMBER;\nv_sql              VARCHAR2(32767);\nv_odate            date;\nBEGIN\ndbms_output.put_line('Start Process '||con_process_name);\ndbms_output.put_line('Start Time: '||TO_CHAR(SYSDATE,'YYYY-MM-DD HH24:MI:SS'));\nEXECUTE immediate 'alter session  set NLS_DATE_FORMAT=''DD-MON-YY''';\nv_sql := 'INSERT\n    INTO ' || v_schema_nm || '.' || v_tbl_to_load ||\n      '(\n        CUST_PLUS_PRSPCT_SK,\n        MP_CHD_ID,\n        MP_US_FOODS_ID,\n        CUST_NBR,\n        DIV_NBR,\n        FISC_YR_MTH_F,\n        CURR_IND_F,\n        LDR_TM_F,\n        MP_MSTR_ID_F,\n        RES_TYP_IND_F,\n        MP_FOOD_DSPSBL_PRCH_F,\n        MP_TTL_CAT_DRY_F,\n        MP_TTL_CAT_FRSH_F,\n        MP_TTL_CAT_FRZ_F,\n        MP_TTL_CAT_PROTN_F,\n        MP_TTL_CAT_BVRG_F,\n        MP_TTL_CAT_DSPSBL_F,\n        MP_TTL_CAT_FRSH_FRZ_F,\n        MP_CHD_ID_F,\n        MP_US_FOODS_ID_F,\n        FISC_YR_MTH_L,\n        CURR_IND_L,\n        LDR_TM_L,\n        MP_MSTR_ID_L,\n        RES_TYP_IND_L,\n        MP_FOOD_DSPSBL_PRCH_L,\n        MP_TTL_CAT_DRY_L,\n        MP_TTL_CAT_FRSH_L,\n        MP_TTL_CAT_FRZ_L,\n        MP_TTL_CAT_PROTN_L,\n        MP_TTL_CAT_BVRG_L,\n        MP_TTL_CAT_DSPSBL_L,\n        MP_TTL_CAT_FRSH_FRZ_L,\n        MP_CHD_ID_L,\n        MP_US_FOODS_ID_L,\n        MP_FOOD_BVRG_DSPSBL_PRCH_F,\n        MP_FOOD_BVRG_DSPSBL_PRCH_L\n      )\n    SELECT ' || v_schema_nm || '.' || '2017e2fedae91411c32ac0e32c9dfae981bcb3d6a032ee37e9519cff17fe00d1.62f8a3a8f852f40aa2997ab17a708cbd CUST_PLUS_PRSPCT_SK,\n      MP_CHD_ID,\n      MP_US_FOODS_ID,\n      CUST_NBR,\n      DIV_NBR,\n      FISC_YR_MTH_F,\n      CURR_IND_F,\n      LDR_TM_F,\n      MP_MSTR_ID_F,\n      RES_TYP_IND_F,\n      MP_FOOD_DSPSBL_PRCH_F,\n      MP_TTL_CAT_DRY_F,\n      MP_TTL_CAT_FRSH_F,\n      MP_TTL_CAT_FRZ_F,\n      MP_TTL_CAT_PROTN_F,\n      MP_TTL_CAT_BVRG_F,\n      MP_TTL_CAT_DSPSBL_F,\n      MP_TTL_CAT_FRSH_FRZ_F,\n      MP_CHD_ID_F,\n      MP_US_FOODS_ID_F,\n      FISC_YR_MTH_L,\n      CURR_IND_L,\n      LDR_TM_L,\n      MP_MSTR_ID_L,\n      RES_TYP_IND_L,\n      MP_FOOD_DSPSBL_PRCH_L,\n      MP_TTL_CAT_DRY_L,\n      MP_TTL_CAT_FRSH_L,\n      MP_TTL_CAT_FRZ_L,\n      MP_TTL_CAT_PROTN_L,\n      MP_TTL_CAT_BVRG_L,\n      MP_TTL_CAT_DSPSBL_L,\n      MP_TTL_CAT_FRSH_FRZ_L,\n      MP_CHD_ID_L,\n      MP_US_FOODS_ID_L,\n      MP_FOOD_BVRG_DSPSBL_PRCH_F,\n      MP_FOOD_BVRG_DSPSBL_PRCH_L\n    FROM\n      (WITH two_yago AS\n      (SELECT MIN(clndr_dt) dt\n      FROM de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001\n      WHERE fisc_yr =\n        (SELECT fisc_yr -2\n        FROM de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001\n        WHERE clndr_dt = TRUNC(to_date(''' || odate || '''' || ',' || '''YYYYMMDD''))\n        )\n      ),\n      usf_cust AS\n      (SELECT de459e2fe7f96e4d958537b31b946b26.52982d3bbc1ebc2720d9504c7ea2ed3f.e31a13b0019fa14358cccecf46ab6bac,\n        de459e2fe7f96e4d958537b31b946b26.52982d3bbc1ebc2720d9504c7ea2ed3f.33cde6b92bd1b2a3d489b84803485187,\n        de459e2fe7f96e4d958537b31b946b26.52982d3bbc1ebc2720d9504c7ea2ed3f.852fa1e9f02f1ca2c75837f7146b2381,\n        de459e2fe7f96e4d958537b31b946b26.dec387908a0954ddc8689c4ad37c8a3c.839c4ffb4bfaae1bb58eab4dee67d96a,\n        NVL(de459e2fe7f96e4d958537b31b946b26.dec387908a0954ddc8689c4ad37c8a3c.3ad9e70cf16862b1ecd4e1a0ecde3783, ''31-DEC-4700'') inact_dt,\n        NVL(de459e2fe7f96e4d958537b31b946b26.52982d3bbc1ebc2720d9504c7ea2ed3f.3b57b086211a36d7e8377ee4c0785e8a, ''01-JAN-1980'') dt_last_ord\n      FROM de459e2fe7f96e4d958537b31b946b26.52982d3bbc1ebc2720d9504c7ea2ed3f c,\n        de459e2fe7f96e4d958537b31b946b26.dec387908a0954ddc8689c4ad37c8a3c d\n      WHERE de459e2fe7f96e4d958537b31b946b26.dec387908a0954ddc8689c4ad37c8a3c.2edfd837e0441242d7eed4e0cdf56652 IS NULL\n      AND de459e2fe7f96e4d958537b31b946b26.dec387908a0954ddc8689c4ad37c8a3c.5f9b93eee5a541bbfc51bec17780fa18            != ''-999''\n      AND de459e2fe7f96e4d958537b31b946b26.dec387908a0954ddc8689c4ad37c8a3c.3230c1dfdc87290e4bc50e7b3e6e928d          != ''-999''\n      AND de459e2fe7f96e4d958537b31b946b26.dec387908a0954ddc8689c4ad37c8a3c.839c4ffb4bfaae1bb58eab4dee67d96a            = de459e2fe7f96e4d958537b31b946b26.52982d3bbc1ebc2720d9504c7ea2ed3f.839c4ffb4bfaae1bb58eab4dee67d96a\n      AND de459e2fe7f96e4d958537b31b946b26.52982d3bbc1ebc2720d9504c7ea2ed3f.16e5296d034422f9dbc310fded5af15ce32f6dd38f333cde68119d1f277367cd  IS NULL\n      ),\n      latest_chd_cust AS\n      (SELECT mp_chd_id,\n        mp_us_foods_id,\n        cust_nbr,\n        div_nbr\n      FROM de459e2fe7f96e4d958537b31b946b26.fcc55a82da91e429eaffc482050485ebe472b097974b0d6a9a7d2ed170324906 mp\n      WHERE de459e2fe7f96e4d958537b31b946b26.fcc55a82da91e429eaffc482050485ebe472b097974b0d6a9a7d2ed170324906.17a7541ba0af7b39947d91f68f8cf748 = ''Y''\n      and (de459e2fe7f96e4d958537b31b946b26.fcc55a82da91e429eaffc482050485ebe472b097974b0d6a9a7d2ed170324906.852fa1e9f02f1ca2c75837f7146b2381 is null or exists\n      (select 1 from usf_cust))\n      )\n    SELECT COALESCE(d08a232a3ca40bc5d4049102ca60cd72.e31a13b0019fa14358cccecf46ab6bac, NVL(c6e0668f8899a92a5445cbb6d1e12bd8.e31a13b0019fa14358cccecf46ab6bac, ''999999999''))      AS mp_chd_id,\n      COALESCE(d08a232a3ca40bc5d4049102ca60cd72.33cde6b92bd1b2a3d489b84803485187, NVL(c6e0668f8899a92a5445cbb6d1e12bd8.33cde6b92bd1b2a3d489b84803485187, ''999999999'')) AS mp_us_foods_id,\n      COALESCE(c6e0668f8899a92a5445cbb6d1e12bd8.852fa1e9f02f1ca2c75837f7146b2381, d08a232a3ca40bc5d4049102ca60cd72.852fa1e9f02f1ca2c75837f7146b2381)                               AS cust_nbr,\n      COALESCE(c6e0668f8899a92a5445cbb6d1e12bd8.839c4ffb4bfaae1bb58eab4dee67d96a, d08a232a3ca40bc5d4049102ca60cd72.839c4ffb4bfaae1bb58eab4dee67d96a)                                 AS div_nbr\n    FROM\n      (SELECT mp_chd_id,\n        mp_us_foods_id,\n        cust_nbr,\n        div_nbr\n      FROM usf_cust,\n        two_yago\n      WHERE 23bbb7be013b4438d4c86c292320ac0c.3ad9e70cf16862b1ecd4e1a0ecde3783  > a42244a8cae2356557230a0046e5d040.33709dad7fa5eac8c1c3486b35956c3e\n      AND 23bbb7be013b4438d4c86c292320ac0c.3b57b086211a36d7e8377ee4c0785e8a > a42244a8cae2356557230a0046e5d040.33709dad7fa5eac8c1c3486b35956c3e\n      ) c1\n    FULL OUTER JOIN latest_chd_cust c2\n    ON d08a232a3ca40bc5d4049102ca60cd72.852fa1e9f02f1ca2c75837f7146b2381 = c6e0668f8899a92a5445cbb6d1e12bd8.852fa1e9f02f1ca2c75837f7146b2381\n    AND d08a232a3ca40bc5d4049102ca60cd72.839c4ffb4bfaae1bb58eab4dee67d96a = c6e0668f8899a92a5445cbb6d1e12bd8.839c4ffb4bfaae1bb58eab4dee67d96a\n      ) q1\n    LEFT OUTER JOIN\n      (SELECT frst.*,\n        lst.*\n      FROM\n        (SELECT *\n        FROM\n          (SELECT cust_nbr CUST_NBR_F,\n            div_nbr DIV_NBR_F,\n            fisc_yr_mth FISC_YR_MTH_F,\n            CURR_IND CURR_IND_F,\n            LDR_TM LDR_TM_F,\n            MP_MSTR_ID MP_MSTR_ID_F,\n            RES_TYP_IND RES_TYP_IND_F,\n            MP_FOOD_DSPSBL_PRCH MP_FOOD_DSPSBL_PRCH_F,\n            MP_TTL_CAT_DRY MP_TTL_CAT_DRY_F,\n            MP_TTL_CAT_FRSH MP_TTL_CAT_FRSH_F,\n            MP_TTL_CAT_FRZ MP_TTL_CAT_FRZ_F,\n            MP_TTL_CAT_PROTN MP_TTL_CAT_PROTN_F,\n            MP_TTL_CAT_BVRG MP_TTL_CAT_BVRG_F,\n            MP_TTL_CAT_DSPSBL MP_TTL_CAT_DSPSBL_F,\n            MP_TTL_CAT_FRSH_FRZ MP_TTL_CAT_FRSH_FRZ_F,\n            mp_chd_id MP_CHD_ID_F,\n            mp_us_foods_id MP_US_FOODS_ID_F,\n            MP_FOOD_BVRG_DSPSBL_PRCH      MP_FOOD_BVRG_DSPSBL_PRCH_F,\n            row_number() OVER (PARTITION BY mp_chd_id, div_nbr, mp_us_foods_id ORDER BY fisc_yr_mth) RNK_F\n          FROM de459e2fe7f96e4d958537b31b946b26.fcc55a82da91e429eaffc482050485ebe472b097974b0d6a9a7d2ed170324906\n          ) CHD1\n        WHERE rnk_f = 1\n        ) frst,\n        (SELECT *\n        FROM\n          (SELECT cust_nbr CUST_NBR_L,\n            div_nbr DIV_NBR_L,\n            fisc_yr_mth FISC_YR_MTH_L,\n            CURR_IND CURR_IND_L,\n            LDR_TM LDR_TM_L,\n            MP_MSTR_ID MP_MSTR_ID_L,\n            RES_TYP_IND RES_TYP_IND_L,\n            MP_FOOD_DSPSBL_PRCH MP_FOOD_DSPSBL_PRCH_L,\n            MP_TTL_CAT_DRY MP_TTL_CAT_DRY_L,\n            MP_TTL_CAT_FRSH MP_TTL_CAT_FRSH_L,\n            MP_TTL_CAT_FRZ MP_TTL_CAT_FRZ_L,\n            MP_TTL_CAT_PROTN MP_TTL_CAT_PROTN_L,\n            MP_TTL_CAT_BVRG MP_TTL_CAT_BVRG_L,\n            MP_TTL_CAT_DSPSBL MP_TTL_CAT_DSPSBL_L,\n            MP_TTL_CAT_FRSH_FRZ MP_TTL_CAT_FRSH_FRZ_L,\n            mp_chd_id MP_CHD_ID_L,\n            mp_us_foods_id MP_US_FOODS_ID_L,\n            MP_FOOD_BVRG_DSPSBL_PRCH      MP_FOOD_BVRG_DSPSBL_PRCH_L,\n            row_number() OVER (PARTITION BY mp_chd_id, div_nbr, mp_us_foods_id ORDER BY fisc_yr_mth DESC) RNK_L\n          FROM de459e2fe7f96e4d958537b31b946b26.fcc55a82da91e429eaffc482050485ebe472b097974b0d6a9a7d2ed170324906\n          ) CHD2\n        WHERE rnk_l = 1\n        ) Lst\n      WHERE fb8492ce5dd6996b26175ebf508667f0.9bc83739921d25266dfde81f55ef4144    = e5b96ce7fa8ee47446dc2b43626c7cfc.ee396157a7d6711b293045d8bba6aa00\n      AND e5b96ce7fa8ee47446dc2b43626c7cfc.485607ae1626072929f428ac5aeb617f       = fb8492ce5dd6996b26175ebf508667f0.722c663e7f753bbadf3179bef3c0a35b\n      AND fb8492ce5dd6996b26175ebf508667f0.70bd17d5969a173e1c35e0526dae4751e32f6dd38f333cde68119d1f277367cd = e5b96ce7fa8ee47446dc2b43626c7cfc.2f9bcf6d2d3591db0e1ffdd79f1bc81be32f6dd38f333cde68119d1f277367cd\n      ) q2\n    ON 180539c7b86bf67b92d22ffb309c0771.e31a13b0019fa14358cccecf46ab6bac       = 1f5571c927b07410b41fc40227a5d289.ee396157a7d6711b293045d8bba6aa00\n    AND 180539c7b86bf67b92d22ffb309c0771.839c4ffb4bfaae1bb58eab4dee67d96a        = 1f5571c927b07410b41fc40227a5d289.485607ae1626072929f428ac5aeb617f\n    AND 180539c7b86bf67b92d22ffb309c0771.33cde6b92bd1b2a3d489b84803485187 = 1f5571c927b07410b41fc40227a5d289.2f9bcf6d2d3591db0e1ffdd79f1bc81be32f6dd38f333cde68119d1f277367cd';\n    \n    Execute immediate v_sql;\n    dbms_output.put_line('Rows processed: ' || SQL%rowcount);\n    dbms_output.put_line('End Time: '||TO_CHAR(SYSDATE,'YYYY-MM-DD HH24:MI:SS'));\n    COMMIT;\nv_sql := 'INSERT\n    INTO ' || v_schema_nm || '.' || v_tbl_to_load ||\n      '(\n        CUST_PLUS_PRSPCT_SK,\n        MP_CHD_ID,\n        MP_US_FOODS_ID,\n        CUST_NBR,\n        DIV_NBR,\n        FISC_YR_MTH_F,\n        CURR_IND_F,\n        LDR_TM_F,\n        MP_MSTR_ID_F,\n        RES_TYP_IND_F,\n        MP_FOOD_DSPSBL_PRCH_F,\n        MP_TTL_CAT_DRY_F,\n        MP_TTL_CAT_FRSH_F,\n        MP_TTL_CAT_FRZ_F,\n        MP_TTL_CAT_PROTN_F,\n        MP_TTL_CAT_BVRG_F,\n        MP_TTL_CAT_DSPSBL_F,\n        MP_TTL_CAT_FRSH_FRZ_F,\n        MP_CHD_ID_F,\n        MP_US_FOODS_ID_F,\n        FISC_YR_MTH_L,\n        CURR_IND_L,\n        LDR_TM_L,\n        MP_MSTR_ID_L,\n        RES_TYP_IND_L,\n        MP_FOOD_DSPSBL_PRCH_L,\n        MP_TTL_CAT_DRY_L,\n        MP_TTL_CAT_FRSH_L,\n        MP_TTL_CAT_FRZ_L,\n        MP_TTL_CAT_PROTN_L,\n        MP_TTL_CAT_BVRG_L,\n        MP_TTL_CAT_DSPSBL_L,\n        MP_TTL_CAT_FRSH_FRZ_L,\n        MP_CHD_ID_L,\n        MP_US_FOODS_ID_L,\n        MP_FOOD_BVRG_DSPSBL_PRCH_F,\n        MP_FOOD_BVRG_DSPSBL_PRCH_L\n      )\n    SELECT ' || v_schema_nm || '.' || '2017e2fedae91411c32ac0e32c9dfae981bcb3d6a032ee37e9519cff17fe00d1.62f8a3a8f852f40aa2997ab17a708cbd CUST_PLUS_PRSPCT_SK,\nMP_CHD_ID_F,\nMP_US_FOODS_ID_F,\nCUST_NBR_F,\nDIV_NBR_F,\nFISC_YR_MTH_F,\nCURR_IND_F,\nLDR_TM_F,\nMP_MSTR_ID_F,\nRES_TYP_IND_F,\nMP_FOOD_DSPSBL_PRCH_F,\nMP_TTL_CAT_DRY_F,\nMP_TTL_CAT_FRSH_F,\nMP_TTL_CAT_FRZ_F,\nMP_TTL_CAT_PROTN_F,\nMP_TTL_CAT_BVRG_F,\nMP_TTL_CAT_DSPSBL_F,\nMP_TTL_CAT_FRSH_FRZ_F,\nMP_CHD_ID_F,\nMP_US_FOODS_ID_F,\nFISC_YR_MTH_L,\nCURR_IND_L,\nLDR_TM_L,\nMP_MSTR_ID_L,\nRES_TYP_IND_L,\nMP_FOOD_DSPSBL_PRCH_L,\nMP_TTL_CAT_DRY_L,\nMP_TTL_CAT_FRSH_L,\nMP_TTL_CAT_FRZ_L,\nMP_TTL_CAT_PROTN_L,\nMP_TTL_CAT_BVRG_L,\nMP_TTL_CAT_DSPSBL_L,\nMP_TTL_CAT_FRSH_FRZ_L,\nMP_CHD_ID_L,\nMP_US_FOODS_ID_L,\nMP_FOOD_BVRG_DSPSBL_PRCH_F,\nMP_FOOD_BVRG_DSPSBL_PRCH_L\nfrom\n(SELECT cust_nbr CUST_NBR_F,\n            div_nbr DIV_NBR_F,\n            fisc_yr_mth FISC_YR_MTH_F,\n            CURR_IND CURR_IND_F,\n            LDR_TM LDR_TM_F,\n            MP_MSTR_ID MP_MSTR_ID_F,\n            RES_TYP_IND RES_TYP_IND_F,\n            MP_FOOD_DSPSBL_PRCH MP_FOOD_DSPSBL_PRCH_F,\n            MP_TTL_CAT_DRY MP_TTL_CAT_DRY_F,\n            MP_TTL_CAT_FRSH MP_TTL_CAT_FRSH_F,\n            MP_TTL_CAT_FRZ MP_TTL_CAT_FRZ_F,\n            MP_TTL_CAT_PROTN MP_TTL_CAT_PROTN_F,\n            MP_TTL_CAT_BVRG MP_TTL_CAT_BVRG_F,\n            MP_TTL_CAT_DSPSBL MP_TTL_CAT_DSPSBL_F,\n            MP_TTL_CAT_FRSH_FRZ MP_TTL_CAT_FRSH_FRZ_F,\n            mp_chd_id MP_CHD_ID_F,\n            mp_us_foods_id MP_US_FOODS_ID_F,\n            MP_FOOD_BVRG_DSPSBL_PRCH      MP_FOOD_BVRG_DSPSBL_PRCH_F,\n            rnk rnk_f\nfrom\n(select frst.*, row_number() over (partition by mp_chd_id order by summ asc nulls last) rnk from\n(select de459e2fe7f96e4d958537b31b946b26.fcc55a82da91e429eaffc482050485ebe472b097974b0d6a9a7d2ed170324906.*, (MP_TTL_CAT_DRY +\n    NVL(MP_TTL_CAT_FRSH, 0) +\n    NVL(MP_TTL_CAT_FRZ, 0) +\n    NVL(MP_TTL_CAT_PROTN, 0) +\n    NVL(MP_TTL_CAT_BVRG, 0) +\n    NVL(MP_TTL_CAT_DSPSBL, 0) +\n    NVL(MP_TTL_CAT_FRSH_FRZ, 0)) summ\nfrom de459e2fe7f96e4d958537b31b946b26.fcc55a82da91e429eaffc482050485ebe472b097974b0d6a9a7d2ed170324906 chd\nwhere curr_ind = ''Y'' and not exists\n(select 1  from ' || v_schema_nm || '.' || v_tbl_to_load || ' p where de459e2fe7f96e4d958537b31b946b26.fcc55a82da91e429eaffc482050485ebe472b097974b0d6a9a7d2ed170324906.e31a13b0019fa14358cccecf46ab6bac = e472b097974b0d6a9a7d2ed170324906.e31a13b0019fa14358cccecf46ab6bac)) frst) where rnk = 1) chd1,\n(SELECT cust_nbr CUST_NBR_L,\n            div_nbr DIV_NBR_L,\n            fisc_yr_mth FISC_YR_MTH_L,\n            CURR_IND CURR_IND_L,\n            LDR_TM LDR_TM_L,\n            MP_MSTR_ID MP_MSTR_ID_L,\n            RES_TYP_IND RES_TYP_IND_L,\n            MP_FOOD_DSPSBL_PRCH MP_FOOD_DSPSBL_PRCH_L,\n            MP_TTL_CAT_DRY MP_TTL_CAT_DRY_L,\n            MP_TTL_CAT_FRSH MP_TTL_CAT_FRSH_L,\n            MP_TTL_CAT_FRZ MP_TTL_CAT_FRZ_L,\n            MP_TTL_CAT_PROTN MP_TTL_CAT_PROTN_L,\n            MP_TTL_CAT_BVRG MP_TTL_CAT_BVRG_L,\n            MP_TTL_CAT_DSPSBL MP_TTL_CAT_DSPSBL_L,\n            MP_TTL_CAT_FRSH_FRZ MP_TTL_CAT_FRSH_FRZ_L,\n            mp_chd_id MP_CHD_ID_L,\n            mp_us_foods_id MP_US_FOODS_ID_L,\n            MP_FOOD_BVRG_DSPSBL_PRCH      MP_FOOD_BVRG_DSPSBL_PRCH_L,\n            rnk rnk_l\nfrom\n(select lst.*, row_number() over (partition by mp_chd_id order by summ desc) rnk from\n(select de459e2fe7f96e4d958537b31b946b26.fcc55a82da91e429eaffc482050485ebe472b097974b0d6a9a7d2ed170324906.*, (MP_TTL_CAT_DRY +\n    NVL(MP_TTL_CAT_FRSH, 0) +\n    NVL(MP_TTL_CAT_FRZ, 0) +\n    NVL(MP_TTL_CAT_PROTN, 0) +\n    NVL(MP_TTL_CAT_BVRG, 0) +\n    NVL(MP_TTL_CAT_DSPSBL, 0) +\n    NVL(MP_TTL_CAT_FRSH_FRZ, 0)) summ\nfrom de459e2fe7f96e4d958537b31b946b26.fcc55a82da91e429eaffc482050485ebe472b097974b0d6a9a7d2ed170324906 chd\nwhere curr_ind = ''Y'' and not exists\n(select 1  from ' || v_schema_nm || '.' || v_tbl_to_load || ' p where de459e2fe7f96e4d958537b31b946b26.fcc55a82da91e429eaffc482050485ebe472b097974b0d6a9a7d2ed170324906.e31a13b0019fa14358cccecf46ab6bac = e472b097974b0d6a9a7d2ed170324906.e31a13b0019fa14358cccecf46ab6bac)) lst) where rnk = 1) chd2\n     WHERE 5f6d677b0ab91e15383abf1d969101e7.ee396157a7d6711b293045d8bba6aa00    = ed57afba9e3e9351abac95050c93e66a.9bc83739921d25266dfde81f55ef4144\n      ';\n    \n    Execute immediate v_sql;\n    dbms_output.put_line('Rows processed: ' || SQL%rowcount);\n    dbms_output.put_line('End Time: '||TO_CHAR(SYSDATE,'YYYY-MM-DD HH24:MI:SS'));\n    COMMIT;\n    EXECUTE immediate 'alter session  set NLS_DATE_FORMAT=''MM/DD/YYYY''';\n    RETURN 0;\n  EXCEPTION\n  WHEN OTHERS THEN\n    DBMS_OUTPUT.put_line('Error inserting into cust_plus_prspct_corp');\n    DBMS_OUTPUT.put_line(SQLCODE || ': ' || SQLERRM);\n    RETURN 1;\n  END FN_XDM_CUST_PRSPCT_LOAD;\n/",
            "upstream_dependencies": [],
            "downstream_dependencies": [],
            "dag_location": "null",
            "gantt_location": "null",
            "created_at": "null",
            "updated_at": "null"
        },
        {
            "name": "FN_CUST_WK_AGGR_SYN",
            "encrypted_name": "2ebfd02960dfc60d4e4216bc68c3ff4d4ed5d7418efdff0224f78050bb9d6c48",
            "type": "function",
            "database": "null",
            "encrypted_database": "null",
            "schema": "XDMADM",
            "encrypted_schema": "0e03d5c46556a742ba46252698396ef2",
            "fully_qualified_name": "XDMADM.FN_CUST_WK_AGGR_SYN",
            "encrypted_fqn": "0e03d5c46556a742ba46252698396ef2.2ebfd02960dfc60d4e4216bc68c3ff4d4ed5d7418efdff0224f78050bb9d6c48",
            "synonyms": [],
            "metadata_analysis": "CREATE OR REPLACE FUNCTION \"0e03d5c46556a742ba46252698396ef2\".\"2ebfd02960dfc60d4e4216bc68c3ff4d4ed5d7418efdff0224f78050bb9d6c48\" (odate IN DATE)\n   RETURN NUMBER AS\n   \n   c_success            CONSTANT NUMBER := 0;\n   c_error              CONSTANT NUMBER := 0;\n   c_schema             CONSTANT VARCHAR2(30) := 'XDMADM';\n   c_aggr_tbl_syn_nm    CONSTANT VARCHAR2(30) := 'CUST_WK_AGGR';\n   c_aggr_load_syn_nm   CONSTANT VARCHAR2(30) := 'CUST_WK_AGGR_LOAD';\n   l_return_code        NUMBER;\n   l_out_msg            VARCHAR2(256);\n\n   l_aggr_tbl_nm        VARCHAR2(30);\n   l_load_tbl_nm        VARCHAR2(30);\nBEGIN\n   \n   IF (odate IS NULL) THEN\n      DBMS_OUTPUT.put_line('Error: Invalid Parameters: Date is required');\n      RETURN c_error;\n   END IF;\n\n   \n   EXECUTE IMMEDIATE 'SELECT table_name FROM user_synonyms WHERE synonym_name = ''' || c_aggr_tbl_syn_nm || ''''\n      INTO l_aggr_tbl_nm;\n\n   EXECUTE IMMEDIATE 'SELECT table_name FROM user_synonyms WHERE synonym_name = ''' || c_aggr_load_syn_nm || ''''\n      INTO l_load_tbl_nm;\n\n   DBMS_OUTPUT.put_line('Aggr Table: ' || l_aggr_tbl_nm);\n   DBMS_OUTPUT.put_line('Load Table: ' || l_load_tbl_nm);\n\n   \n   l_return_code   := de459e2fe7f96e4d958537b31b946b26.9b3711c37bca8fd1d7c76527508615f9(c_schema, l_load_tbl_nm);\n   DBMS_OUTPUT.put_line('Analyze Return: ' || l_return_code);\n\n   IF (l_return_code <> 0) THEN\n      DBMS_OUTPUT.put_line('Error: Failed to analyze table');\n      RETURN c_error;\n   END IF;\n\n   \n   l_return_code   := de459e2fe7f96e4d958537b31b946b26.f21751d25bb3675b2a3778f4f03c7da6(c_aggr_tbl_syn_nm, c_schema, l_load_tbl_nm);\n   DBMS_OUTPUT.put_line(\n      'Create synonym ' || c_aggr_tbl_syn_nm || ' for ' || c_schema || '.' || l_load_tbl_nm || ': ' || l_return_code);\n\n   IF (l_return_code <> 0) THEN\n      DBMS_OUTPUT.put_line('Error: Failed to create synonym for aggregate table');\n      RETURN c_error;\n   END IF;\n\n   l_return_code   := de459e2fe7f96e4d958537b31b946b26.f21751d25bb3675b2a3778f4f03c7da6(c_aggr_load_syn_nm, c_schema, l_aggr_tbl_nm);\n   DBMS_OUTPUT.put_line(\n      'Create synonym ' || c_aggr_load_syn_nm || ' for ' || c_schema || '.' || l_aggr_tbl_nm || ': ' || l_return_code);\n\n   IF (l_return_code <> 0) THEN\n      DBMS_OUTPUT.put_line('Error: Failed to create synonym for aggregate table');\n      RETURN c_error;\n   END IF;\n\n   \n   l_return_code   := 8e64339f96bb08058f5d52f1c04f954a.8ffe4678890c39c7d4ed38c2ed759e24.e4b5db2b3f9b19accbb8cddbfcd05bac(l_out_msg, c_schema, l_aggr_tbl_nm);\n   DBMS_OUTPUT.put_line('Truncate Prev Aggr Table Return: ' || l_return_code || ' - ' || l_out_msg);\n\n   IF (l_return_code <> 0) THEN\n      DBMS_OUTPUT.put_line('Error: Failed to truncate table');\n      RETURN c_error;\n   END IF;\n\n   RETURN c_success;\nEXCEPTION\n   WHEN OTHERS THEN\n      DBMS_OUTPUT.put_line('Unexepected error');\n      DBMS_OUTPUT.put_line(SQLCODE || ': ' || SQLERRM);\n      RETURN c_error;\nEND;\n/",
            "upstream_dependencies": [],
            "downstream_dependencies": [],
            "dag_location": "null",
            "gantt_location": "null",
            "created_at": "null",
            "updated_at": "null"
        },
        {
            "name": "FN_RGN_SLS_SYN_SWAP",
            "encrypted_name": "a292a8ff5202643cb4f9d751c3e975c98013bf5b8be037b748b31a500198bbd1",
            "type": "function",
            "database": "null",
            "encrypted_database": "null",
            "schema": "XDMADM",
            "encrypted_schema": "0e03d5c46556a742ba46252698396ef2",
            "fully_qualified_name": "XDMADM.FN_RGN_SLS_SYN_SWAP",
            "encrypted_fqn": "0e03d5c46556a742ba46252698396ef2.a292a8ff5202643cb4f9d751c3e975c98013bf5b8be037b748b31a500198bbd1",
            "synonyms": [],
            "metadata_analysis": "CREATE OR REPLACE FUNCTION \"0e03d5c46556a742ba46252698396ef2\".\"a292a8ff5202643cb4f9d751c3e975c98013bf5b8be037b748b31a500198bbd1\" (odate IN DATE)\n   RETURN NUMBER AS\n   \n   l_aggr_active_tbl     VARCHAR2(30);\n   l_aggr_inactive_tbl   VARCHAR2(30);\n   l_prj_active_tbl      VARCHAR2(30);\n   l_prj_inactive_tbl    VARCHAR2(30);\n   l_active_vw           VARCHAR2(30);\n   l_inactive_vw         VARCHAR2(30);\n   l_return_code         NUMBER := 0;\n   l_object_nm           VARCHAR2(30);\n   l_out_msg             VARCHAR2(256);\n   e_create_synonym exception;\n   e_truncate_table exception;\nBEGIN\n   \n   l_aggr_active_tbl     := 76ded3481abebe7e101f31e7e9fb1d50.764db46f8b9234b5e07a7d1d4ce8fcd8(76ded3481abebe7e101f31e7e9fb1d50.716900750ba6b5d499e5b9bc59348974, 'Y');\n   l_aggr_inactive_tbl   := 76ded3481abebe7e101f31e7e9fb1d50.764db46f8b9234b5e07a7d1d4ce8fcd8(76ded3481abebe7e101f31e7e9fb1d50.716900750ba6b5d499e5b9bc59348974, 'N');\n\n   \n   76ded3481abebe7e101f31e7e9fb1d50.81dd02b30e5e0bfc7e15dd5a941ade88(l_aggr_active_tbl, 'N');\n   76ded3481abebe7e101f31e7e9fb1d50.81dd02b30e5e0bfc7e15dd5a941ade88(l_aggr_inactive_tbl, 'Y');\n\n   \n   l_return_code         := fn_crt_synonym(76ded3481abebe7e101f31e7e9fb1d50.716900750ba6b5d499e5b9bc59348974, 76ded3481abebe7e101f31e7e9fb1d50.01ad20b6c8a2d0aaccf3dde9aaedb75e, l_aggr_inactive_tbl);\n\n   IF (l_return_code <> 0) THEN\n      l_object_nm   := 76ded3481abebe7e101f31e7e9fb1d50.682fb8bee72728857645bccb5103cb23;\n      RAISE e_create_synonym;\n   END IF;\n\n   l_return_code         := 8e64339f96bb08058f5d52f1c04f954a.8ffe4678890c39c7d4ed38c2ed759e24.e4b5db2b3f9b19accbb8cddbfcd05bac(l_out_msg, 76ded3481abebe7e101f31e7e9fb1d50.01ad20b6c8a2d0aaccf3dde9aaedb75e, l_aggr_active_tbl);\n\n   IF (l_return_code <> 0) THEN\n      l_object_nm   := l_aggr_active_tbl;\n      RAISE e_truncate_table;\n   END IF;\n\n   DBMS_OUTPUT.put_line('Previous active aggregate table: ' || l_aggr_active_tbl);\n   DBMS_OUTPUT.put_line('New active aggregate table: ' || l_aggr_inactive_tbl);\n   DBMS_OUTPUT.put_line('Truncated table: ' || l_aggr_active_tbl);\n\n   \n   l_prj_active_tbl      := 76ded3481abebe7e101f31e7e9fb1d50.764db46f8b9234b5e07a7d1d4ce8fcd8(76ded3481abebe7e101f31e7e9fb1d50.682fb8bee72728857645bccb5103cb23, 'Y');\n   l_prj_inactive_tbl    := 76ded3481abebe7e101f31e7e9fb1d50.764db46f8b9234b5e07a7d1d4ce8fcd8(76ded3481abebe7e101f31e7e9fb1d50.682fb8bee72728857645bccb5103cb23, 'N');\n\n   \n   76ded3481abebe7e101f31e7e9fb1d50.81dd02b30e5e0bfc7e15dd5a941ade88(l_prj_active_tbl, 'N');\n   76ded3481abebe7e101f31e7e9fb1d50.81dd02b30e5e0bfc7e15dd5a941ade88(l_prj_inactive_tbl, 'Y');\n\n   \n   l_return_code         := fn_crt_synonym(76ded3481abebe7e101f31e7e9fb1d50.682fb8bee72728857645bccb5103cb23, 76ded3481abebe7e101f31e7e9fb1d50.01ad20b6c8a2d0aaccf3dde9aaedb75e, l_prj_inactive_tbl);\n\n   IF (l_return_code <> 0) THEN\n      l_object_nm   := 76ded3481abebe7e101f31e7e9fb1d50.682fb8bee72728857645bccb5103cb23;\n      RAISE e_create_synonym;\n   END IF;\n\n   l_return_code         := 8e64339f96bb08058f5d52f1c04f954a.8ffe4678890c39c7d4ed38c2ed759e24.e4b5db2b3f9b19accbb8cddbfcd05bac(l_out_msg, 76ded3481abebe7e101f31e7e9fb1d50.01ad20b6c8a2d0aaccf3dde9aaedb75e, l_prj_active_tbl);\n\n   IF (l_return_code <> 0) THEN\n      l_object_nm   := l_prj_inactive_tbl;\n      RAISE e_truncate_table;\n   END IF;\n\n   DBMS_OUTPUT.put_line('Previous active projection table: ' || l_prj_active_tbl);\n   DBMS_OUTPUT.put_line('New active projection table: ' || l_prj_inactive_tbl);\n   DBMS_OUTPUT.put_line('Truncated table: ' || l_prj_active_tbl);\n\n   \n   UPDATE de459e2fe7f96e4d958537b31b946b26.0b3320d3f985cd20d1ec65d9dfeed2de\n      SET div_load_stat = 1,\n\t\t\t                    div_load_ts = TRUNC(odate),\n\t\t\t\t\t\t\t\t\t\t\t\t\tlatest_prcs_dt = sysdate\n    WHERE fact_table = 76ded3481abebe7e101f31e7e9fb1d50.716900750ba6b5d499e5b9bc59348974;\n\n   \n   IF (sql%ROWCOUNT = 0) THEN\n      INSERT INTO de459e2fe7f96e4d958537b31b946b26.0b3320d3f985cd20d1ec65d9dfeed2de(fact_table, div_nbr, fact_table_dsply_nm, fact_typ_desc, latest_prcs_dt, div_load_stat, div_load_ts, prcs_dt, load_freq, rpt_dsply_ind)\n          VALUES (76ded3481abebe7e101f31e7e9fb1d50.716900750ba6b5d499e5b9bc59348974,  0, 'EXECUTIVE VIEWS','EXECUTIVE VIEWS',sysdate,1, TRUNC(odate),TRUNC(odate) +1, 'DAILY', 'Y' ); \n   END IF;\n\n   COMMIT;\n   DBMS_OUTPUT.put_line('Previous active view: ' || l_active_vw);\n   DBMS_OUTPUT.put_line('New active view: ' || l_inactive_vw);\n   RETURN 76ded3481abebe7e101f31e7e9fb1d50.79565b4ea20e0d36bc7365f1c4259002;\nEXCEPTION\n   WHEN e_create_synonym THEN\n      DBMS_OUTPUT.put_line('Error Swapping Synonym: ' || l_object_nm || '. Requires manual update.');\n      RETURN 76ded3481abebe7e101f31e7e9fb1d50.de3afdf274dc4a6f320906a012ba2f12;\n   WHEN e_truncate_table THEN\n      DBMS_OUTPUT.put_line('Error Truncating Table: ' || l_object_nm || '. Requires manual update.');\n      DBMS_OUTPUT.put_line(l_out_msg);\n      RETURN 76ded3481abebe7e101f31e7e9fb1d50.de3afdf274dc4a6f320906a012ba2f12;\n   WHEN OTHERS THEN\n      ROLLBACK;\n      DBMS_OUTPUT.put_line('Unexpected Error In Synonym Swap Procedure. Requires manual update.');\n      DBMS_OUTPUT.put_line(SQLCODE || ': ' || SQLERRM);\n      RETURN 76ded3481abebe7e101f31e7e9fb1d50.de3afdf274dc4a6f320906a012ba2f12;\nEND;\n/",
            "upstream_dependencies": [],
            "downstream_dependencies": [],
            "dag_location": "null",
            "gantt_location": "null",
            "created_at": "null",
            "updated_at": "null"
        },
        {
            "name": "FN_CASES_AND_DOLLARS_TEMP_LOAD",
            "encrypted_name": "a35377af85801a576ad44a3ad9cace2de9470df0dd42e4429863cc91496f306a",
            "type": "function",
            "database": "null",
            "encrypted_database": "null",
            "schema": "XDMADM",
            "encrypted_schema": "0e03d5c46556a742ba46252698396ef2",
            "fully_qualified_name": "XDMADM.FN_CASES_AND_DOLLARS_TEMP_LOAD",
            "encrypted_fqn": "0e03d5c46556a742ba46252698396ef2.a35377af85801a576ad44a3ad9cace2de9470df0dd42e4429863cc91496f306a",
            "synonyms": [],
            "metadata_analysis": "CREATE OR REPLACE FUNCTION \"0e03d5c46556a742ba46252698396ef2\".\"a35377af85801a576ad44a3ad9cace2de9470df0dd42e4429863cc91496f306a\" (p_in_odate IN VARCHAR2)\n   RETURN NUMBER IS\n   \n\n   \n   v_const          NUMBER := 2;\n   v_end_dt         DATE;\n   v_strt_dt        DATE;\n   v_odate          DATE := TO_DATE(p_in_odate, 'YYYYMMDD');\n   v_param_date     DATE;\n   v_prcs_stp       VARCHAR2(2000);\n   v_ldr_tm         NUMBER(20);\n   v_out_msg        VARCHAR2(256);\n\n   v_dba_func_msg   VARCHAR2(2000) := 'oXo';\n   dml_err_cnt      NUMBER;\n   v_brnch_cd       VARCHAR2(5) := NULL;\n   v_div_nbr        NUMBER(5) := NULL;\n\n   l_start          NUMBER;\n   l_end            NUMBER;\n   v_table_owner    VARCHAR2(40) := 'XDMADM'; \n   v_table_name1    VARCHAR2(40) := 'CASES_AND_DOLLARS_TEMP';\n   v_table_name2    VARCHAR2(40) := 'DOLLARS_BY_PYR_SEG'; \n   v_table_name3    VARCHAR2(40) := 'CASES_AND_RVNUE_BY_GL_ACCT'; \n   v_truncate_tbl   NUMBER(3);\n\n   CURSOR c_get_dts(p_strt_dt       DATE,\n                    p_end_dt        DATE) IS\n      SELECT fisc_mth_start_dt, fisc_mth_end_dt\n        FROM de459e2fe7f96e4d958537b31b946b26.ca1faaabe4743a8a00a4d208ab58b2b3\n       WHERE fisc_mth_start_dt BETWEEN p_strt_dt AND p_end_dt;\nBEGIN\n   \n\n   BEGIN\n      SELECT param_value_dt\n        INTO v_param_date\n        FROM de459e2fe7f96e4d958537b31b946b26.de40ae7be8b2eb3858d46af8d107f3db\n       WHERE app_name = 'HYP_PLANNING'\n         AND param_type = 'MTH_EXTRACT'\n         AND param_code = 'END_DATE';\n\n      IF v_param_date IS NOT NULL THEN\n         v_odate   := v_param_date;\n\n         DBMS_OUTPUT.put_line('Override ODATE with param date: ' || TO_CHAR(v_param_date, 'DD-MON-YYYY'));\n      END IF;\n   EXCEPTION\n      WHEN NO_DATA_FOUND THEN\n         NULL;\n   END;\n\n   \n\n   BEGIN\n      v_prcs_stp       := 'Truncating Table 0e03d5c46556a742ba46252698396ef2.d69b2a68d4571dbb66aa4a659b0dcaa3fdb3e034ed603176c32e2a1046ec1f69..... ';\n\n      DBMS_OUTPUT.put_line('Truncating/Deleting records from CASES_AND_DOLLARS_TEMP');\n      v_truncate_tbl   := 8e64339f96bb08058f5d52f1c04f954a.8ffe4678890c39c7d4ed38c2ed759e24.e4b5db2b3f9b19accbb8cddbfcd05bac(v_out_msg, v_table_owner, v_table_name1);\n      DBMS_OUTPUT.put_line(v_out_msg);\n\n      IF v_truncate_tbl != 0 THEN\n         DBMS_OUTPUT.put_line('Error in Truncating the ' || v_table_name1 || ' table');\n         RETURN 500;\n      END IF;\n\n      DBMS_OUTPUT.put_line('0e03d5c46556a742ba46252698396ef2.d69b2a68d4571dbb66aa4a659b0dcaa3fdb3e034ed603176c32e2a1046ec1f69 table truncated successfully');\n   END;\n\n   \n\n   BEGIN\n      v_prcs_stp       := 'Truncating Table 0e03d5c46556a742ba46252698396ef2.ba14007a01f75b8e8b4274a5b262c17d56faed417eee791d565438865e909e90..... ';\n\n      DBMS_OUTPUT.put_line('Truncating/Deleting records from DOLLARS_BY_PYR_SEG');\n      v_truncate_tbl   := 8e64339f96bb08058f5d52f1c04f954a.8ffe4678890c39c7d4ed38c2ed759e24.e4b5db2b3f9b19accbb8cddbfcd05bac(v_out_msg, v_table_owner, v_table_name2);\n      DBMS_OUTPUT.put_line(v_out_msg);\n\n      IF v_truncate_tbl != 0 THEN\n         DBMS_OUTPUT.put_line('Error in Truncating the ' || v_table_name2 || ' table');\n         RETURN 500;\n      END IF;\n\n      DBMS_OUTPUT.put_line('0e03d5c46556a742ba46252698396ef2.ba14007a01f75b8e8b4274a5b262c17d56faed417eee791d565438865e909e90 table truncated successfully');\n   END;\n\n   \n\n   BEGIN\n      v_prcs_stp       := 'Truncating Table 0e03d5c46556a742ba46252698396ef2.0bc437e6dbeee36674bbae9feb068aa40dd4ce2b7ae4c9cdc3aa8ea0ad37a2da..... ';\n\n      DBMS_OUTPUT.put_line('Truncating/Deleting records from CASES_AND_RVNUE_BY_GL_ACCT');\n      v_truncate_tbl   := 8e64339f96bb08058f5d52f1c04f954a.8ffe4678890c39c7d4ed38c2ed759e24.e4b5db2b3f9b19accbb8cddbfcd05bac(v_out_msg, v_table_owner, v_table_name3);\n      DBMS_OUTPUT.put_line(v_out_msg);\n\n      IF v_truncate_tbl != 0 THEN\n         DBMS_OUTPUT.put_line('Error in Truncating the ' || v_table_name3 || ' table');\n         RETURN 500;\n      END IF;\n\n      DBMS_OUTPUT.put_line('0e03d5c46556a742ba46252698396ef2.0bc437e6dbeee36674bbae9feb068aa40dd4ce2b7ae4c9cdc3aa8ea0ad37a2da table truncated successfully');\n   END;\n\n   BEGIN\n      v_prcs_stp   := 'GET THE VARIABLES ASSIGNED ';\n\n      \n\n      \n      \n    SELECT MIN(clndr_dt)\n        INTO v_strt_dt\n        FROM de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001\n       WHERE fisc_yr IN (SELECT fisc_yr - (Select param_value_nbr FROM de459e2fe7f96e4d958537b31b946b26.de40ae7be8b2eb3858d46af8d107f3db\n WHERE app_name = 'HYP_PLANNING' and PARAM_TYPE = 'DATE_RANGE' and param_code = 'NOOFYRS'  )\n                               FROM de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001\n                              WHERE clndr_dt = (SELECT clndr_dt_wkago\n                                                  FROM de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001\n                                                 WHERE clndr_dt = v_odate));\n      \n\n      \n      SELECT MAX(clndr_dt)\n        INTO v_end_dt\n        FROM de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001\n       WHERE fisc_yr_wk = (SELECT fisc_yr_wk\n                                 FROM de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001\n                                WHERE clndr_dt = (SELECT clndr_dt_wkago\n                                                    FROM de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001\n                                                   WHERE clndr_dt = v_odate));\n\n      DBMS_OUTPUT.put_line('Start Date is:' || v_strt_dt);\n      DBMS_OUTPUT.put_line('End Date is:' || v_end_dt);\n      DBMS_OUTPUT.put_line('Run Date is:' || v_odate);\n\n      \n\n      SELECT TO_NUMBER(TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')) INTO v_ldr_tm FROM DUAL;\n\n      DBMS_OUTPUT.put_line('LDR_TM is :' || v_ldr_tm);\n   EXCEPTION\n      WHEN OTHERS THEN\n         DBMS_OUTPUT.put_line('Error in v_prcs_stp : ' || v_prcs_stp);\n\n         RETURN 900;\n   END;\n\n   \n   \n   \n   BEGIN\n      v_prcs_stp   := 'INSERT INTO table starts ';\n      l_start      := DBMS_UTILITY.get_time;\n\n      DBMS_OUTPUT.put_line('TIME ' || TO_CHAR(SYSDATE, 'yyyymmdd hh24:mi:ss'));\n\n      FOR r_get_dts IN c_get_dts(v_strt_dt, v_end_dt) LOOP\n         INSERT \n               INTO de459e2fe7f96e4d958537b31b946b26.affa69d2e18d5ca6c7314c74ba00bf4ba435d42d15ea9fc5301ef86c434eccb0(sls_div_nbr, div_nbr, div_typ_cd, fisc_yr, fisc_mth_of_yr, pyr_seg_cd,\n                                                  gl_acct_cd, cust_acctblty_flg, cust_natl_mngd_flg, delivered_type, unfrm_qty_ship, grs_sls_extnd,\n                                                  dwa_cost_extnd, natl_one_tm, natl_prom_alwnc_pgms, loc_mrktng_alwnc_pgms, loc_one_tm, loc_prom_alwnc_pgms,\n                                                  natl_mrktng_alwnc_pgms, rbt_loc_accrl_amt, rbt_natl_accrl_amt, rbt_loc_exp_amt, rbt_natl_exp_amt, loc_int_dvt,\n                                                  loc_vndr_fnd_dvt, natl_int_dvt, natl_vndr_fnd_dvt, ttl_ac, ldr_tm)\n            SELECT *\n              FROM (  SELECT CASE WHEN de459e2fe7f96e4d958537b31b946b26.dec387908a0954ddc8689c4ad37c8a3c.b8c6ab19cb6e726c38f24d1885346ea3 = 'CC' THEN NVL(e9a95106e01380a7834d36560e919770.839c4ffb4bfaae1bb58eab4dee67d96a.a2b201123c685e8cc48b5468cb4a449361bbd7bc0d2d67c7d7b11cb0a8d18d03, e9a95106e01380a7834d36560e919770.839c4ffb4bfaae1bb58eab4dee67d96a.839c4ffb4bfaae1bb58eab4dee67d96a) ELSE e9a95106e01380a7834d36560e919770.839c4ffb4bfaae1bb58eab4dee67d96a.839c4ffb4bfaae1bb58eab4dee67d96a END\n                                sls_div_nbr,\n                             e9a95106e01380a7834d36560e919770.839c4ffb4bfaae1bb58eab4dee67d96a.839c4ffb4bfaae1bb58eab4dee67d96a,\n                             de459e2fe7f96e4d958537b31b946b26.dec387908a0954ddc8689c4ad37c8a3c.b8c6ab19cb6e726c38f24d1885346ea3,\n                             de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.ab30d6d679879cfacfe389b97d1d3f0e,\n                             de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.e1d446673288adb6d5f219d0aa82d37a,\n                             de459e2fe7f96e4d958537b31b946b26.52982d3bbc1ebc2720d9504c7ea2ed3f.156f54b388a4986aa3d3d8e74d0fc0cd,\n                             CASE\n                                WHEN (e9a95106e01380a7834d36560e919770.839c4ffb4bfaae1bb58eab4dee67d96a.5b031577f28cabdc6c0e17d15a4e0aa0 IN (SELECT DISTINCT param_value_chr\n                                                         FROM de459e2fe7f96e4d958537b31b946b26.de40ae7be8b2eb3858d46af8d107f3db\n                                                        WHERE app_name = 'HYP_PLANNING'\n                                                          AND param_type LIKE '%AR_GL_ACCT_CD')) THEN\n                                   CASE WHEN e9a95106e01380a7834d36560e919770.839c4ffb4bfaae1bb58eab4dee67d96a.6363e9ad7bc2d03871ced34810bbcc9cde922b42cda877bb335f20b7c10e0802 <> 'Y' THEN e9a95106e01380a7834d36560e919770.839c4ffb4bfaae1bb58eab4dee67d96a.5b031577f28cabdc6c0e17d15a4e0aa0 ELSE NULL END\n                                ELSE\n                                   0\n                             END\n                                gl_acct_cd,\n                             de459e2fe7f96e4d958537b31b946b26.52982d3bbc1ebc2720d9504c7ea2ed3f.318678c82ff4517124bc3a6b8506d59463f2fe9cc6b573bb859641780443a51b,\n                             de459e2fe7f96e4d958537b31b946b26.52982d3bbc1ebc2720d9504c7ea2ed3f.e33988f12139bfc93f1e7557137feb5a29e110ac67769beb8c9647cf15a66d38,\n                             CASE WHEN NVL(e9a95106e01380a7834d36560e919770.839c4ffb4bfaae1bb58eab4dee67d96a.a2b201123c685e8cc48b5468cb4a449361bbd7bc0d2d67c7d7b11cb0a8d18d03, e9a95106e01380a7834d36560e919770.839c4ffb4bfaae1bb58eab4dee67d96a.839c4ffb4bfaae1bb58eab4dee67d96a) = e9a95106e01380a7834d36560e919770.839c4ffb4bfaae1bb58eab4dee67d96a.839c4ffb4bfaae1bb58eab4dee67d96a THEN 'Y' ELSE 'N' END\n                                delivered_type,\n                             SUM(unfrm_qty_ship) unfrm_qty_ship,\n                             SUM(NVL(grs_sls_extnd, 0)) grs_sls_extnd,\n                             SUM(NVL(dwa_cost_extnd, 0)) dwa_cost_extnd,\n                             SUM(NVL(natl_one_tm, 0)) natl_one_tm,\n                             SUM(NVL(natl_prom_alwnc_pgms, 0)) natl_prom_alwnc_pgms,\n                             SUM(NVL(loc_mrktng_alwnc_pgms, 0)) loc_mrktng_alwnc_pgms,\n                             SUM(NVL(loc_one_tm, 0)) loc_one_tm,\n                             SUM(NVL(loc_prom_alwnc_pgms, 0)) loc_prom_alwnc_pgms,\n                             SUM(NVL(natl_mrktng_alwnc_pgms, 0)) natl_mrktng_alwnc_pgms,\n                             SUM(NVL(rbt_loc_accrl_amt, 0)) rbt_loc_accrl_amt,\n                             SUM(NVL(rbt_natl_accrl_amt, 0)) rbt_natl_accrl_amt,\n                             SUM(NVL(rbt_loc_exp_amt, 0)) rbt_loc_exp_amt,\n                             SUM(NVL(rbt_natl_exp_amt, 0)) rbt_natl_exp_amt,\n                             SUM(CASE WHEN e9a95106e01380a7834d36560e919770.839c4ffb4bfaae1bb58eab4dee67d96a.26ac88e7ae671a1b22c14c2fce77aa2d = 'AP' THEN loc_int_dvt ELSE 0 END) loc_int_dvt,\n                             SUM(CASE WHEN e9a95106e01380a7834d36560e919770.839c4ffb4bfaae1bb58eab4dee67d96a.26ac88e7ae671a1b22c14c2fce77aa2d = 'AP' THEN loc_vndr_fnd_dvt ELSE 0 END) loc_vndr_fnd_dvt,\n                             SUM(CASE WHEN e9a95106e01380a7834d36560e919770.839c4ffb4bfaae1bb58eab4dee67d96a.26ac88e7ae671a1b22c14c2fce77aa2d = 'AP' THEN natl_int_dvt ELSE 0 END) natl_int_dvt,\n                             SUM(CASE WHEN e9a95106e01380a7834d36560e919770.839c4ffb4bfaae1bb58eab4dee67d96a.26ac88e7ae671a1b22c14c2fce77aa2d = 'AP' THEN natl_vndr_fnd_dvt ELSE 0 END) natl_vndr_fnd_dvt,\n                             SUM(CASE\n                                    WHEN e9a95106e01380a7834d36560e919770.839c4ffb4bfaae1bb58eab4dee67d96a.5b031577f28cabdc6c0e17d15a4e0aa0 IN (SELECT DISTINCT param_value_chr\n                                                            FROM de459e2fe7f96e4d958537b31b946b26.de40ae7be8b2eb3858d46af8d107f3db\n                                                           WHERE app_name = 'HYP_PLANNING'\n                                                             AND param_type LIKE '%AR_GL_ACCT_CD') THEN\n                                       CASE\n                                          WHEN e9a95106e01380a7834d36560e919770.839c4ffb4bfaae1bb58eab4dee67d96a.6363e9ad7bc2d03871ced34810bbcc9cde922b42cda877bb335f20b7c10e0802 <> 'Y' THEN\n                                             (  (NVL(e9a95106e01380a7834d36560e919770.839c4ffb4bfaae1bb58eab4dee67d96a.63a91e2fd122990392b8c1467a67b61e, 0))\n                                              + (NVL(e9a95106e01380a7834d36560e919770.839c4ffb4bfaae1bb58eab4dee67d96a.f4684b698d1e8edd11bf71d8eac02595, 0))\n                                              + (NVL(e9a95106e01380a7834d36560e919770.839c4ffb4bfaae1bb58eab4dee67d96a.2dfeefdbbdd44f6feceb5ad393352003, 0))\n                                              + (NVL(e9a95106e01380a7834d36560e919770.839c4ffb4bfaae1bb58eab4dee67d96a.bd428d343074503f124765bf6dd4405a, 0)))\n                                          ELSE\n                                             0\n                                       END\n                                    ELSE\n                                       0\n                                 END)\n                                ttl_ac,\n                             v_ldr_tm\n                        FROM de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c s,\n                             de459e2fe7f96e4d958537b31b946b26.52982d3bbc1ebc2720d9504c7ea2ed3f c,\n                             de459e2fe7f96e4d958537b31b946b26.dec387908a0954ddc8689c4ad37c8a3c d,\n                             de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001 t,\n                             de459e2fe7f96e4d958537b31b946b26.2c04d82ed0aa1cc9bce2cf2c0548b268 p\n                       WHERE e9a95106e01380a7834d36560e919770.839c4ffb4bfaae1bb58eab4dee67d96a.f5dd4374a3e3af6a775cb6d6b22e8162 BETWEEN 21c902912ce01ef59af90ee0a71af15a.eeb3cae1b83726e8df7c8d2367b9cf4b1d731bbdc4e3fb69a854112d4982eb99 AND 21c902912ce01ef59af90ee0a71af15a.e17b4db24503ad4d9365a15bec98eef6\n                         AND e9a95106e01380a7834d36560e919770.839c4ffb4bfaae1bb58eab4dee67d96a.f5dd4374a3e3af6a775cb6d6b22e8162 <= v_end_dt\n                         AND e9a95106e01380a7834d36560e919770.839c4ffb4bfaae1bb58eab4dee67d96a.f5dd4374a3e3af6a775cb6d6b22e8162 = de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.222ccb1d1746bcdb2365f29b3da0b613\n                         AND e9a95106e01380a7834d36560e919770.839c4ffb4bfaae1bb58eab4dee67d96a.852fa1e9f02f1ca2c75837f7146b2381 = de459e2fe7f96e4d958537b31b946b26.52982d3bbc1ebc2720d9504c7ea2ed3f.852fa1e9f02f1ca2c75837f7146b2381\n                         AND de459e2fe7f96e4d958537b31b946b26.52982d3bbc1ebc2720d9504c7ea2ed3f.839c4ffb4bfaae1bb58eab4dee67d96a = de459e2fe7f96e4d958537b31b946b26.dec387908a0954ddc8689c4ad37c8a3c.839c4ffb4bfaae1bb58eab4dee67d96a\n                         AND e9a95106e01380a7834d36560e919770.839c4ffb4bfaae1bb58eab4dee67d96a.d3268eabc4a7d98105fd85f9c9e62cd6e32ad436514bbe822b33de8bead744f3 = de459e2fe7f96e4d958537b31b946b26.2c04d82ed0aa1cc9bce2cf2c0548b268.d3268eabc4a7d98105fd85f9c9e62cd6e32ad436514bbe822b33de8bead744f3\n                         AND CASE\n                                WHEN (NVL(e9a95106e01380a7834d36560e919770.839c4ffb4bfaae1bb58eab4dee67d96a.a2b201123c685e8cc48b5468cb4a449361bbd7bc0d2d67c7d7b11cb0a8d18d03, e9a95106e01380a7834d36560e919770.839c4ffb4bfaae1bb58eab4dee67d96a.839c4ffb4bfaae1bb58eab4dee67d96a) = 0) THEN e9a95106e01380a7834d36560e919770.839c4ffb4bfaae1bb58eab4dee67d96a.839c4ffb4bfaae1bb58eab4dee67d96a\n                                ELSE NVL(e9a95106e01380a7834d36560e919770.839c4ffb4bfaae1bb58eab4dee67d96a.a2b201123c685e8cc48b5468cb4a449361bbd7bc0d2d67c7d7b11cb0a8d18d03, e9a95106e01380a7834d36560e919770.839c4ffb4bfaae1bb58eab4dee67d96a.839c4ffb4bfaae1bb58eab4dee67d96a)\n                             END = de459e2fe7f96e4d958537b31b946b26.dec387908a0954ddc8689c4ad37c8a3c.839c4ffb4bfaae1bb58eab4dee67d96a\n                         AND de459e2fe7f96e4d958537b31b946b26.dec387908a0954ddc8689c4ad37c8a3c.2edfd837e0441242d7eed4e0cdf56652 IS NULL\n                         AND e9a95106e01380a7834d36560e919770.839c4ffb4bfaae1bb58eab4dee67d96a.467a168a7499c57b1859198a7dac7be0 IS NULL\n                         AND de459e2fe7f96e4d958537b31b946b26.52982d3bbc1ebc2720d9504c7ea2ed3f.dd6238100904f569270d672fe0643a5a <> '2'\n                         AND de459e2fe7f96e4d958537b31b946b26.2c04d82ed0aa1cc9bce2cf2c0548b268.89f3df82917b692fe64dca942d924e7c <> 97\n                    GROUP BY CASE\n                                WHEN de459e2fe7f96e4d958537b31b946b26.dec387908a0954ddc8689c4ad37c8a3c.b8c6ab19cb6e726c38f24d1885346ea3 = 'CC' THEN NVL(e9a95106e01380a7834d36560e919770.839c4ffb4bfaae1bb58eab4dee67d96a.a2b201123c685e8cc48b5468cb4a449361bbd7bc0d2d67c7d7b11cb0a8d18d03, e9a95106e01380a7834d36560e919770.839c4ffb4bfaae1bb58eab4dee67d96a.839c4ffb4bfaae1bb58eab4dee67d96a)\n                                ELSE e9a95106e01380a7834d36560e919770.839c4ffb4bfaae1bb58eab4dee67d96a.839c4ffb4bfaae1bb58eab4dee67d96a\n                             END,\n                             e9a95106e01380a7834d36560e919770.839c4ffb4bfaae1bb58eab4dee67d96a.839c4ffb4bfaae1bb58eab4dee67d96a,\n                             de459e2fe7f96e4d958537b31b946b26.dec387908a0954ddc8689c4ad37c8a3c.b8c6ab19cb6e726c38f24d1885346ea3,\n                             de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.ab30d6d679879cfacfe389b97d1d3f0e,\n                             de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.e1d446673288adb6d5f219d0aa82d37a,\n                             de459e2fe7f96e4d958537b31b946b26.52982d3bbc1ebc2720d9504c7ea2ed3f.156f54b388a4986aa3d3d8e74d0fc0cd,\n                             CASE\n                                WHEN (e9a95106e01380a7834d36560e919770.839c4ffb4bfaae1bb58eab4dee67d96a.5b031577f28cabdc6c0e17d15a4e0aa0 IN (SELECT DISTINCT param_value_chr\n                                                         FROM de459e2fe7f96e4d958537b31b946b26.de40ae7be8b2eb3858d46af8d107f3db\n                                                        WHERE app_name = 'HYP_PLANNING'\n                                                          AND param_type LIKE '%AR_GL_ACCT_CD')) THEN\n                                   CASE WHEN e9a95106e01380a7834d36560e919770.839c4ffb4bfaae1bb58eab4dee67d96a.6363e9ad7bc2d03871ced34810bbcc9cde922b42cda877bb335f20b7c10e0802 <> 'Y' THEN e9a95106e01380a7834d36560e919770.839c4ffb4bfaae1bb58eab4dee67d96a.5b031577f28cabdc6c0e17d15a4e0aa0 ELSE NULL END\n                                ELSE\n                                   0\n                             END,\n                             de459e2fe7f96e4d958537b31b946b26.52982d3bbc1ebc2720d9504c7ea2ed3f.318678c82ff4517124bc3a6b8506d59463f2fe9cc6b573bb859641780443a51b,\n                             de459e2fe7f96e4d958537b31b946b26.52982d3bbc1ebc2720d9504c7ea2ed3f.e33988f12139bfc93f1e7557137feb5a29e110ac67769beb8c9647cf15a66d38,\n                             CASE WHEN NVL(e9a95106e01380a7834d36560e919770.839c4ffb4bfaae1bb58eab4dee67d96a.a2b201123c685e8cc48b5468cb4a449361bbd7bc0d2d67c7d7b11cb0a8d18d03, e9a95106e01380a7834d36560e919770.839c4ffb4bfaae1bb58eab4dee67d96a.839c4ffb4bfaae1bb58eab4dee67d96a) = e9a95106e01380a7834d36560e919770.839c4ffb4bfaae1bb58eab4dee67d96a.839c4ffb4bfaae1bb58eab4dee67d96a THEN 'Y' ELSE 'N' END);\n\n         DBMS_OUTPUT.put_line('NO OF ROWS INSERTED:' || sql%ROWCOUNT);\n\n         COMMIT;\n      END LOOP;\n\n      l_end        := DBMS_UTILITY.get_time;\n\n      DBMS_OUTPUT.put_line(ROUND((l_end - l_start) / 100, 2) || ' seconds...');\n      COMMIT;\n      RETURN 0;\n   EXCEPTION\n      WHEN OTHERS THEN\n         DBMS_OUTPUT.put_line('Error in v_prcs_stp:' || v_prcs_stp || SQLCODE || SQLERRM);\n\n         RETURN 701;\n   END;\n\n\n\n\nEXCEPTION\n   WHEN OTHERS THEN\n      ROLLBACK;\n      DBMS_OUTPUT.put_line(SQLCODE);\n      DBMS_OUTPUT.put_line(SQLERRM);\n\n      DBMS_OUTPUT.put_line('Error in function FN_CASES_AND_DOLLARS_TEMP_LOAD');\n      RETURN 600;\nEND fn_cases_and_dollars_temp_load;\n/",
            "upstream_dependencies": [],
            "downstream_dependencies": [],
            "dag_location": "null",
            "gantt_location": "null",
            "created_at": "null",
            "updated_at": "null"
        },
        {
            "name": "FN_CASES_BY_GL_ACCT_LOAD_WK",
            "encrypted_name": "2f8696bfcff6d0014b353a4e3caa58a5c10e2302d31431641848a526ce24a458",
            "type": "function",
            "database": "null",
            "encrypted_database": "null",
            "schema": "XDMADM",
            "encrypted_schema": "0e03d5c46556a742ba46252698396ef2",
            "fully_qualified_name": "XDMADM.FN_CASES_BY_GL_ACCT_LOAD_WK",
            "encrypted_fqn": "0e03d5c46556a742ba46252698396ef2.2f8696bfcff6d0014b353a4e3caa58a5c10e2302d31431641848a526ce24a458",
            "synonyms": [],
            "metadata_analysis": "CREATE OR REPLACE FUNCTION \"0e03d5c46556a742ba46252698396ef2\".\"2f8696bfcff6d0014b353a4e3caa58a5c10e2302d31431641848a526ce24a458\" (p_in_odate IN VARCHAR2)\n   RETURN NUMBER IS\n   \n\n   \n\n\n\n   v_const          NUMBER := 2;\n   v_end_dt         DATE;\n   v_strt_dt        DATE;\n   v_odate          DATE := TO_DATE(p_in_odate, 'YYYYMMDD');\n   v_prcs_stp       VARCHAR2(2000);\n   v_ldr_tm         NUMBER(20);\n   v_out_msg        VARCHAR2(256);\n\n   v_dba_func_msg   VARCHAR2(2000) := 'oXo';\n   dml_err_cnt      NUMBER;\n\n   l_start          NUMBER;\n   l_end            NUMBER;\n   v_table_owner    VARCHAR2(40) := 'XDMADM'; \n   v_table_name     VARCHAR2(40) := 'CASES_AND_RVNUE_BY_GL_ACCT_WK'; \n   v_truncate_tbl   NUMBER(3);\nBEGIN\n   \n   \n   \n   BEGIN\n      v_prcs_stp   := 'INSERT INTO table starts ';\n      l_start      := DBMS_UTILITY.get_time;\n\n      DBMS_OUTPUT.put_line('TIME ' || TO_CHAR(SYSDATE, 'yyyymmdd hh24:mi:ss'));\n\n      INSERT \n            INTO de459e2fe7f96e4d958537b31b946b26.f2712065b4111f67f478dd0b3bf131add5e20efc7ee6c6e059f98dc123224871\n         (  SELECT brnch_cd,\n                   fisc_yr,\n                   fisc_mth_of_yr,\n                   fisc_wk_of_prd,\n                   acct,\n                   gl_account,\n                   cust_acctblty_flg,\n                   cust_natl_mngd_flg,\n                   ROUND(SUM(unfrm_qty_ship), 2) data_value\n              FROM (SELECT de459e2fe7f96e4d958537b31b946b26.dec387908a0954ddc8689c4ad37c8a3c.4855453efe73ff0bd0f7583df58260dd, \n                           503e5bca9f89192fda7def0b8f40adce.839c4ffb4bfaae1bb58eab4dee67d96a,\n                           503e5bca9f89192fda7def0b8f40adce.b8c6ab19cb6e726c38f24d1885346ea3,\n                           503e5bca9f89192fda7def0b8f40adce.ab30d6d679879cfacfe389b97d1d3f0e,\n                           503e5bca9f89192fda7def0b8f40adce.e1d446673288adb6d5f219d0aa82d37a,\n                           503e5bca9f89192fda7def0b8f40adce.3f2fdebe4ba3a24bdf16fdac5827ebfb,\n                           NVL(de459e2fe7f96e4d958537b31b946b26.711f5f4c350254b40ce960d47ae1ab08fc3a5c81683f41af2951fae7621d4729.c2b9ebe664db8cfc1f7a702af0630a5b, 'UNK') pyr_seg_cd,\n                           de459e2fe7f96e4d958537b31b946b26.711f5f4c350254b40ce960d47ae1ab08fc3a5c81683f41af2951fae7621d4729.1a4ac3a5fce36e3190aec2ba5713e1ff,\n                           503e5bca9f89192fda7def0b8f40adce.e3837b6b258b429fa00c148694e11e48,\n                           CASE\n                              WHEN 503e5bca9f89192fda7def0b8f40adce.839c4ffb4bfaae1bb58eab4dee67d96a = 503e5bca9f89192fda7def0b8f40adce.e3837b6b258b429fa00c148694e11e48\n                               AND 503e5bca9f89192fda7def0b8f40adce.b8c6ab19cb6e726c38f24d1885346ea3 = 'CC'\n                               AND de459e2fe7f96e4d958537b31b946b26.711f5f4c350254b40ce960d47ae1ab08fc3a5c81683f41af2951fae7621d4729.b8ee9f6c896415acdd760daefea08893 = 'N' THEN\n                                 '9010220'\n                              ELSE\n                                 de459e2fe7f96e4d958537b31b946b26.711f5f4c350254b40ce960d47ae1ab08fc3a5c81683f41af2951fae7621d4729.f91fd5eae8d27d72b6ab5179e897097f\n                           END\n                              gl_account,\n                           503e5bca9f89192fda7def0b8f40adce.318678c82ff4517124bc3a6b8506d59463f2fe9cc6b573bb859641780443a51b,\n                           503e5bca9f89192fda7def0b8f40adce.e33988f12139bfc93f1e7557137feb5a29e110ac67769beb8c9647cf15a66d38,\n                           503e5bca9f89192fda7def0b8f40adce.ccf8d88f2d37f3171da2121ab22e9330,\n                           de459e2fe7f96e4d958537b31b946b26.711f5f4c350254b40ce960d47ae1ab08fc3a5c81683f41af2951fae7621d4729.6ef3e4abc0d5bd2c29714f3162369e44,\n                           de459e2fe7f96e4d958537b31b946b26.711f5f4c350254b40ce960d47ae1ab08fc3a5c81683f41af2951fae7621d4729.b8ee9f6c896415acdd760daefea08893\n                      FROM       (  SELECT sls_div_nbr,\n                                           div_nbr,\n                                           div_typ_cd,\n                                           fisc_yr,\n                                           fisc_mth_of_yr,\n                                           fisc_wk_of_prd,\n                                           pyr_seg_cd,\n                                           gl_acct_cd,\n                                           cust_acctblty_flg,\n                                           cust_natl_mngd_flg,\n                                           delivered_type,\n                                           SUM(unfrm_qty_ship) unfrm_qty_ship\n                                      FROM de459e2fe7f96e4d958537b31b946b26.affa69d2e18d5ca6c7314c74ba00bf4bb5d21bf767a527919124c3d0d22232bf\n                                  GROUP BY sls_div_nbr,\n                                           div_nbr,\n                                           div_typ_cd,\n                                           fisc_yr,\n                                           fisc_mth_of_yr,\n                                           fisc_wk_of_prd,\n                                           pyr_seg_cd,\n                                           gl_acct_cd,\n                                           cust_acctblty_flg,\n                                           cust_natl_mngd_flg,\n                                           delivered_type) x1\n                              LEFT OUTER JOIN\n                                 de459e2fe7f96e4d958537b31b946b26.711f5f4c350254b40ce960d47ae1ab08fc3a5c81683f41af2951fae7621d4729 x2\n                              ON 503e5bca9f89192fda7def0b8f40adce.156f54b388a4986aa3d3d8e74d0fc0cd = de459e2fe7f96e4d958537b31b946b26.711f5f4c350254b40ce960d47ae1ab08fc3a5c81683f41af2951fae7621d4729.c2b9ebe664db8cfc1f7a702af0630a5b\n                             AND 503e5bca9f89192fda7def0b8f40adce.b8ee9f6c896415acdd760daefea08893 = de459e2fe7f96e4d958537b31b946b26.711f5f4c350254b40ce960d47ae1ab08fc3a5c81683f41af2951fae7621d4729.b8ee9f6c896415acdd760daefea08893 \n                           INNER JOIN\n                              de459e2fe7f96e4d958537b31b946b26.dec387908a0954ddc8689c4ad37c8a3c x3\n                           ON de459e2fe7f96e4d958537b31b946b26.711f5f4c350254b40ce960d47ae1ab08fc3a5c81683f41af2951fae7621d4729.b8c6ab19cb6e726c38f24d1885346ea3 = de459e2fe7f96e4d958537b31b946b26.dec387908a0954ddc8689c4ad37c8a3c.b8c6ab19cb6e726c38f24d1885346ea3\n                          AND NVL(503e5bca9f89192fda7def0b8f40adce.e3837b6b258b429fa00c148694e11e48, 503e5bca9f89192fda7def0b8f40adce.839c4ffb4bfaae1bb58eab4dee67d96a) = de459e2fe7f96e4d958537b31b946b26.dec387908a0954ddc8689c4ad37c8a3c.839c4ffb4bfaae1bb58eab4dee67d96a)\n          GROUP BY brnch_cd,\n                   fisc_yr,\n                   fisc_mth_of_yr,\n                   fisc_wk_of_prd,\n                   acct,\n                   gl_account,\n                   cust_acctblty_flg,\n                   cust_natl_mngd_flg);\n\n      l_end        := DBMS_UTILITY.get_time;\n\n      DBMS_OUTPUT.put_line('NO OF ROWS INSERTED:' || sql%ROWCOUNT);\n\n      DBMS_OUTPUT.put_line(ROUND((l_end - l_start) / 100, 2) || ' seconds...');\n      COMMIT;\n      RETURN 0;\n   EXCEPTION\n      WHEN OTHERS THEN\n         DBMS_OUTPUT.put_line('Error in v_prcs_stp:' || v_prcs_stp || SQLCODE || SQLERRM);\n\n         RETURN 701;\n   END;\n\n\n\n\nEXCEPTION\n   WHEN OTHERS THEN\n      ROLLBACK;\n      DBMS_OUTPUT.put_line(SQLCODE);\n      DBMS_OUTPUT.put_line(SQLERRM);\n\n      DBMS_OUTPUT.put_line('Error in function FN_CASES_BY_GL_ACCT_LOAD');\n      RETURN 600;\nEND fn_cases_by_gl_acct_load_wk;\n/",
            "upstream_dependencies": [],
            "downstream_dependencies": [],
            "dag_location": "null",
            "gantt_location": "null",
            "created_at": "null",
            "updated_at": "null"
        },
        {
            "name": "FN_PIM_CORP_AGGR_LOAD",
            "encrypted_name": "df66b9bd4b64f11b6d366edcb20f62c333458271b6f4a5ac93cddb79fbe15687",
            "type": "function",
            "database": "null",
            "encrypted_database": "null",
            "schema": "XDMADM",
            "encrypted_schema": "0e03d5c46556a742ba46252698396ef2",
            "fully_qualified_name": "XDMADM.FN_PIM_CORP_AGGR_LOAD",
            "encrypted_fqn": "0e03d5c46556a742ba46252698396ef2.df66b9bd4b64f11b6d366edcb20f62c333458271b6f4a5ac93cddb79fbe15687",
            "synonyms": [],
            "metadata_analysis": "CREATE OR REPLACE FUNCTION \"0e03d5c46556a742ba46252698396ef2\".\"df66b9bd4b64f11b6d366edcb20f62c333458271b6f4a5ac93cddb79fbe15687\"\n   RETURN NUMBER IS\n   \n\n   l_fn_start                   DATE;\n   pim_corp_aggr_tbl_cnt        NUMBER := 0;\n   v_pim_corp_cnt               NUMBER := 0;\n   l_load_tbl_cnt               NUMBER := 0;\n   l_return_code                NUMBER := 0;\n   l_object_nm                  VARCHAR2(30);\n   l_out_msg                    VARCHAR2(256);\n   l_load_tbl_nm                VARCHAR2(30);\n\n   c_success                 CONSTANT NUMBER := 0;\n   c_error                   CONSTANT NUMBER := 1;\n   c_schema                  CONSTANT VARCHAR2(30) := 'XDMADM';\n   c_aggr_tbl_syn_nm         CONSTANT VARCHAR2(30) := 'PIM_CORP_AGGR';\n   c_aggr_load_syn_nm        CONSTANT VARCHAR2(30) := 'PIM_CORP_AGGR_LOAD';\n\n\n   all_exceptions exception; \n   e_truncate_table exception;\n   e_analyze_table exception;\n   e_syn exception;\nBEGIN\n\n\n \n\n   EXECUTE IMMEDIATE 'SELECT table_name FROM user_synonyms WHERE synonym_name = ''' || c_aggr_load_syn_nm || ''''\n      INTO l_load_tbl_nm;\n\n\n\n   IF (c_aggr_tbl_syn_nm = l_load_tbl_nm) THEN\n      RAISE e_syn;\n   END IF;\n\n      \n   EXECUTE IMMEDIATE 'SELECT count(1) FROM ' || l_load_tbl_nm INTO l_load_tbl_cnt;\n\n   IF (l_load_tbl_cnt > 0) THEN\n      DBMS_OUTPUT.put_line('Load aggregate table has ' || l_load_tbl_nm || ' records in it');\n\n      l_return_code   := 8e64339f96bb08058f5d52f1c04f954a.8ffe4678890c39c7d4ed38c2ed759e24.e4b5db2b3f9b19accbb8cddbfcd05bac(l_out_msg, c_schema, l_load_tbl_nm);\n\n      DBMS_OUTPUT.put_line('Truncate table Return: ' || l_return_code || ' - ' || l_out_msg);\n\n      IF (l_return_code <> 0) THEN\n         l_object_nm   := l_load_tbl_nm;\n         RAISE e_truncate_table;\n      END IF;\n\n      DBMS_OUTPUT.put_line('Load aggregate table ' || l_load_tbl_nm ||' truncated');\n\n   END IF;\n\n   \n\n   \n\n    l_fn_start       := SYSDATE;\n\n \n    SELECT COUNT(1) INTO v_pim_corp_cnt\n    FROM (\n         SELECT   DISTINCT\n                  de459e2fe7f96e4d958537b31b946b26.0ad6212deb7aa1fcea6c3846d02d7978cdc81057bcd87469c7825d00b68d1ace.b122651d7c06503443c0d820e5e7bda7,\n                  de459e2fe7f96e4d958537b31b946b26.0ad6212deb7aa1fcea6c3846d02d7978cdc81057bcd87469c7825d00b68d1ace.6e4a5754dec237b2d215aa9585f8a4068de1a66bac405de233c8de1af7988b02,\n                  de459e2fe7f96e4d958537b31b946b26.0ad6212deb7aa1fcea6c3846d02d7978cdc81057bcd87469c7825d00b68d1ace.c1a0243994c58a08334e325e29a31260\n    FROM   de459e2fe7f96e4d958537b31b946b26.0ad6212deb7aa1fcea6c3846d02d7978cdc81057bcd87469c7825d00b68d1ace a) ;\n\n   DBMS_OUTPUT.put_line('Distinct PIM attributes in the Sales Pyramid Agg: '||v_pim_corp_cnt );\n\n   DBMS_OUTPUT.put_line('Inserting Rows into PIM_CORP_AGGR_LOAD');\n\n         INSERT INTO PIM_CORP_AGGR_LOAD (\n                             pim_cls_id,\n                             pim_cls_desc,\n                             pim_cls_desc_id,\n                             pim_suprcls_id,\n                             pim_suprcls_desc,\n                             pim_suprcls_desc_id,\n                             pim_brnd_typ,\n                             pim_brnd_typ_desc)\n        SELECT DISTINCT\n                             pim_cls_id,\n                             pim_cls_desc,\n                             pim_cls_desc_id,\n                             pim_suprcls_id_crnt,\n                             pim_suprcls_desc,\n                             pim_suprcls_desc_id,\n                             pim_brnd_typ,\n                             pim_brnd_typ_desc\n        FROM\n             de459e2fe7f96e4d958537b31b946b26.0ad6212deb7aa1fcea6c3846d02d7978cdc81057bcd87469c7825d00b68d1ace agg;\n\n         DBMS_OUTPUT.put_line(\n             'Inserted ' || sql%ROWCOUNT || ' rows in ' || sql%ROWCOUNT || TO_CHAR(ROUND((SYSDATE - l_fn_start) * 86400)) || ' seconds');\n\n        COMMIT;\n\n   \n  SELECT count(1) INTO pim_corp_aggr_tbl_cnt FROM PIM_CORP_AGGR_LOAD;\n DBMS_OUTPUT.put_line('Number of records inserted into PIM_CORP_AGGR_LOAD is ' || pim_corp_aggr_tbl_cnt);\n\n\n \n\n   DBMS_OUTPUT.put_line('Analyze the Load aggregate table ' || l_load_tbl_nm);\n   l_return_code    := de459e2fe7f96e4d958537b31b946b26.9b3711c37bca8fd1d7c76527508615f9(c_schema, l_load_tbl_nm);\n\n   IF (l_return_code <> 0) THEN\n      l_object_nm   := l_load_tbl_nm;\n      RAISE e_analyze_table;\n   END IF;\n\n\n \n \n    If v_pim_corp_cnt = pim_corp_aggr_tbl_cnt\n       THEN\n       DBMS_OUTPUT.PUT_LINE('Distinct record count match the number of records inserted into PIM_CORP_AGGR_LOAD.');\n       RETURN 0;\n       ELSE\n       DBMS_OUTPUT.PUT_LINE('Distinct record count does not match the number of records inserted into PIM_CORP_AGGR_LOAD.');\n       RETURN 1;\n       END IF;\nEXCEPTION\n   WHEN e_syn THEN\n      DBMS_OUTPUT.put_line(\n         'Synonym currently points to Load table: ' || c_aggr_load_syn_nm || '. Requires manual update.');\n      DBMS_OUTPUT.put_line('Verify the ' ||c_aggr_load_syn_nm|| ' and ' ||c_aggr_load_syn_nm|| ' synonyms');\n      RETURN 6726798abbc757d8442516fefb8c40e9.de3afdf274dc4a6f320906a012ba2f12;\n   WHEN e_truncate_table THEN\n      DBMS_OUTPUT.put_line('Error Truncating Table: ' || l_load_tbl_nm || '. Requires manual update.');\n      DBMS_OUTPUT.put_line('Verify '||l_load_tbl_nm||' table has any records');\n      DBMS_OUTPUT.put_line(l_out_msg);\n      RETURN 6726798abbc757d8442516fefb8c40e9.de3afdf274dc4a6f320906a012ba2f12;\n   WHEN e_analyze_table THEN\n      DBMS_OUTPUT.put_line('Error Analyzing Table: ' || l_load_tbl_nm || '. Requires manual update.');\n      DBMS_OUTPUT.put_line(l_out_msg);\n      RETURN 6726798abbc757d8442516fefb8c40e9.de3afdf274dc4a6f320906a012ba2f12;\n   WHEN OTHERS THEN\n      DBMS_OUTPUT.put_line('Error in 0e03d5c46556a742ba46252698396ef2.79e449a938cc07a272f2482bb43f1a16:' || SQLCODE || ' ' || SQLERRM);\n      RETURN 1;\nEND;\n/",
            "upstream_dependencies": [],
            "downstream_dependencies": [],
            "dag_location": "null",
            "gantt_location": "null",
            "created_at": "null",
            "updated_at": "null"
        },
        {
            "name": "FN_PYR_SLS_AGGR_LOAD",
            "encrypted_name": "ab4278f1500ebdb78989a5fd47ca876b0eb3d570257e690253f62cef87e53109",
            "type": "function",
            "database": "null",
            "encrypted_database": "null",
            "schema": "XDMADM",
            "encrypted_schema": "0e03d5c46556a742ba46252698396ef2",
            "fully_qualified_name": "XDMADM.FN_PYR_SLS_AGGR_LOAD",
            "encrypted_fqn": "0e03d5c46556a742ba46252698396ef2.ab4278f1500ebdb78989a5fd47ca876b0eb3d570257e690253f62cef87e53109",
            "synonyms": [],
            "metadata_analysis": "CREATE OR REPLACE FUNCTION \"0e03d5c46556a742ba46252698396ef2\".\"ab4278f1500ebdb78989a5fd47ca876b0eb3d570257e690253f62cef87e53109\" (\n   odate          IN DATE,\n   p_start_date   IN DATE DEFAULT NULL ,\n   p_prev_years   IN NUMBER DEFAULT NULL\n)\n   RETURN NUMBER\nAS\n   \n   l_start_date                  DATE;\n   l_fn_start                    DATE;\n   l_load_tbl_cnt                NUMBER := 0;\n   l_insert_cnt                  NUMBER;\n   v_parm_dt                     DATE;\n   v_ly_fisc_yr_wk               VARCHAR2 (06);\n   v_ly_day_of_wk                NUMBER (1);\n   v_cy_fisc_yr_wk               VARCHAR2 (06);\n   v_cy_day_of_wk                NUMBER (1);\n\n   c_success CONSTANT            NUMBER := 0;\n   c_error CONSTANT              NUMBER := 1;\n   c_schema CONSTANT             VARCHAR2 (30) := 'XDMADM';\n   c_aggr_tbl_syn_nm CONSTANT    VARCHAR2 (30) := 'SALES_SUMM_PYR_WKLY';\n   c_aggr_load_syn_nm CONSTANT   VARCHAR2 (30) := 'SALES_SUMM_PYR_WKLY_LOAD';\n\n   l_load_tbl_nm                 VARCHAR2 (30);\n   l_object_nm                   VARCHAR2 (30);\n   l_return_code                 NUMBER;\n   l_out_msg                     VARCHAR2 (256);\n\n   v_base_cases_cnt              NUMBER;\n   v_base_sales                  NUMBER;\n   v_aggr_cases_cnt              NUMBER;\n   v_aggr_sales                  NUMBER;\n   e_truncate_table exception;\n   e_analyze_table exception;\n   e_syn exception;\n   e_lookup_range exception;\nBEGIN\n   v_parm_dt := TRUNC (odate);\n\n   \n\n   SELECT   fisc_yr_wk, clndr_day_of_wk\n     INTO   v_cy_fisc_yr_wk, v_cy_day_of_wk\n     FROM   de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001\n    WHERE   clndr_dt = v_parm_dt;\n\n   \n\n   SELECT   de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.f2de255a7553ba934b1f05ae7699ae4c, de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.7c53ae8ca5b55e75e8a2957615ed09bb\n     INTO   v_ly_fisc_yr_wk, v_ly_day_of_wk\n     FROM   de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001 tc, de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001 tc2\n    WHERE   de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.caa2824077535938efbfeab4179ac71d = de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.c7b3173a993d42e0cd6a06309b55345d AND de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.222ccb1d1746bcdb2365f29b3da0b613 = v_parm_dt;\n\n   DBMS_OUTPUT.put_line ('Current Fiscal year week:' || v_cy_fisc_yr_wk);\n   DBMS_OUTPUT.put_line ('Last Fiscal year week:' || v_ly_fisc_yr_wk);\n   DBMS_OUTPUT.put_line (\n      'Day of current Fiscal year week:' || v_cy_day_of_wk\n   );\n   DBMS_OUTPUT.put_line ('ODate:' || v_parm_dt);\n\n\n \n\n   EXECUTE IMMEDIATE 'SELECT table_name FROM user_synonyms WHERE synonym_name = ''' || c_aggr_load_syn_nm || ''''\n      INTO l_load_tbl_nm;\n\n\n\n   IF (c_aggr_tbl_syn_nm = l_load_tbl_nm) THEN\n      RAISE e_syn;\n   END IF;\n\n      \n   EXECUTE IMMEDIATE 'SELECT count(1) FROM ' || l_load_tbl_nm INTO l_load_tbl_cnt;\n\n   IF (l_load_tbl_cnt > 0) THEN\n      DBMS_OUTPUT.put_line('Load aggregate table has ' || l_load_tbl_nm || ' records in it');\n\n      l_return_code   := 8e64339f96bb08058f5d52f1c04f954a.8ffe4678890c39c7d4ed38c2ed759e24.e4b5db2b3f9b19accbb8cddbfcd05bac(l_out_msg, c_schema, l_load_tbl_nm);\n\n      DBMS_OUTPUT.put_line('Truncate table Return: ' || l_return_code || ' - ' || l_out_msg);\n\n      IF (l_return_code <> 0) THEN\n         l_object_nm   := l_load_tbl_nm;\n         RAISE e_truncate_table;\n      END IF;\n\n      DBMS_OUTPUT.put_line('Load aggregate table ' || l_load_tbl_nm ||' truncated');\n\n   END IF;\n\n   \n\n   \n\n   l_fn_start := SYSDATE;\n\n\n\n   IF v_cy_day_of_wk <> 7\n   THEN\n         INSERT  INTO de459e2fe7f96e4d958537b31b946b26.111d8403d1a310eaa3e5f5659edd799205555163070770378c1769185c91a16b\n                    ( div_nbr,\n                      fisc_yr_wk,\n                      ly_wtd,\n                      pim_cls_id,\n                      pim_suprcls_id_crnt,\n                      pim_suprcls_id_actl,\n                      trd_cls,\n                      pyr_seg_cd,\n                      corp_mlt_unit_nbr,\n                      prnt_mlt_unit_cd,\n                      pim_brnd_typ,\n                      cust_cntrct_flg,\n                      cust_natl_mngd_flg,\n                      sls_revenue_div_nbr,\n                      cust_acctblty_flg,\n                      grs_sls_extnd,\n                      unfrm_qty_ship,\n                      actl_gp,\n                      ttl_alwnc,\n                      grs_tgp,\n                      net_sls,\n                      net_tgp,\n                      dwa_cost_extnd,\n                      rbt_loc_accrl_amt,\n                      rbt_natl_accrl_amt,\n                      rbt_loc_exp_amt,\n                      rbt_natl_exp_amt,\n                      ttl_int_vndr_fnd_dvt,\n                      comm_bsis_amt_extnd,\n                      dond,\n                      ttl_vndr_fnd_dvt,\n                      fixed_sell,\n                      n_prime_sis,\n                      prc_apprvl,\n                      dwo,\n                      invst_cs_prtcpt,\n                      net_non_prod_chrg,\n                      net_prod_chrg,\n                      net_non_prod_alwnc,\n                      net_prod_alwnc,\n                      usf_gl_ind,\n                      cust_acqstn_stat_crnt,\n                      cust_acqstn_stat_actl,\n                      cust_acqstn_div_nbr,\n                      cust_acqstn_conv_ind_ty,\n                      cust_acqstn_conv_ind_ly,\n                      cust_acqstn_orgnc_ind_ty,\n                      cust_acqstn_orgnc_ind_ly)\n         (  SELECT   div_nbr,\n                     fisc_yr_wk,\n                     ly_wtd,\n                     pim_cls_id,\n                     pim_suprcls_id_crnt,\n                     pim_suprcls_id_actl,\n                     trd_cls,\n                     pyr_seg_cd,\n                     corp_mlt_unit_nbr,\n                     prnt_mlt_unit_cd,\n                     pim_brnd_typ,\n                     cust_cntrct_flg,\n                     cust_natl_mngd_flg,\n                     sls_revenue_div_nbr,\n                     cust_acctblty_flg,\n                     SUM (grs_sls_extnd) grs_sls_extnd,\n                     SUM (unfrm_qty_ship) unfrm_qty_ship,\n                     SUM (actl_gp) actl_gp,\n                     SUM (ttl_alwnc) ttl_alwnc,\n                     SUM (grs_tgp) grs_tgp,\n                     SUM (net_sls) net_sls,\n                     SUM (net_tgp) net_tgp,\n                     SUM (dwa_cost_extnd) dwa_cost_extnd,\n                     SUM (rbt_loc_accrl_amt) rbt_loc_accrl_amt,\n                     SUM (rbt_natl_accrl_amt) rbt_natl_accrl_amt,\n                     SUM (rbt_loc_exp_amt) rbt_loc_exp_amt,\n                     SUM (rbt_natl_exp_amt) rbt_natl_exp_amt,\n                     SUM (ttl_int_vndr_fnd_dvt_IS) ttl_int_vndr_fnd_dvt,  \n                     SUM (comm_bsis_amt_extnd_IS) comm_bsis_amt_extnd,    \n                     SUM (dond_IS) dond,                                  \n                     SUM (ttl_vndr_fnd_dvt) ttl_vndr_fnd_dvt,\n                     SUM (fixed_sell) fixed_sell,\n                     SUM (n_prime_sis) n_prime_sis,\n                     SUM (prc_apprvl) prc_apprvl,\n                     SUM (dwo) dwo,\n                     SUM (invst_cs_prtcpt) invst_cs_prtcpt,\n                     SUM (net_non_prod_chrg) net_non_prod_chrg,\n                     SUM (net_prod_chrg) net_prod_chrg,\n                     SUM (net_non_prod_alwnc) net_non_prod_alwnc,\n                     SUM (net_prod_alwnc) net_prod_alwnc,\n                     usf_gl_ind,\n                     cust_acqstn_stat_crnt,\n                     cust_acqstn_stat_actl,\n                     cust_acqstn_div_nbr,\n                     cust_acqstn_conv_ind_ty,\n                     cust_acqstn_conv_ind_ly,\n                     cust_acqstn_orgnc_ind_ty,\n                     cust_acqstn_orgnc_ind_ly\n              FROM   de459e2fe7f96e4d958537b31b946b26.0ad6212deb7aa1fcea6c3846d02d7978cdc81057bcd87469c7825d00b68d1ace\n             WHERE   FISC_YR_WK <> v_ly_fisc_yr_wk\n          GROUP BY   div_nbr,\n                     fisc_yr_wk,\n                     ly_wtd,\n                     pim_cls_id,\n                     pim_suprcls_id_crnt,\n                     pim_suprcls_id_actl,\n                     trd_cls,\n                     pyr_seg_cd,\n                     corp_mlt_unit_nbr,\n                     prnt_mlt_unit_cd,\n                     pim_brnd_typ,\n                     cust_cntrct_flg,\n                     cust_natl_mngd_flg,\n                     sls_revenue_div_nbr,\n                     cust_acctblty_flg,\n                     usf_gl_ind,\n                     cust_acqstn_stat_crnt,\n                     cust_acqstn_stat_actl,\n                     cust_acqstn_div_nbr,\n                     cust_acqstn_conv_ind_ty,\n                     cust_acqstn_conv_ind_ly,\n                     cust_acqstn_orgnc_ind_ty,\n                     cust_acqstn_orgnc_ind_ly);\n\n      COMMIT;\n\n\n\n      INSERT  INTO de459e2fe7f96e4d958537b31b946b26.111d8403d1a310eaa3e5f5659edd799205555163070770378c1769185c91a16b\n                    ( div_nbr,\n                      fisc_yr_wk,\n                      ly_wtd,\n                      pim_cls_id,\n                      pim_suprcls_id_crnt,\n                      pim_suprcls_id_actl,\n                      trd_cls,\n                      pyr_seg_cd,\n                      corp_mlt_unit_nbr,\n                      prnt_mlt_unit_cd,\n                      pim_brnd_typ,\n                      cust_cntrct_flg,\n                      cust_natl_mngd_flg,\n                      sls_revenue_div_nbr,\n                      cust_acctblty_flg,\n                      grs_sls_extnd,\n                      unfrm_qty_ship,\n                      actl_gp,\n                      ttl_alwnc,\n                      grs_tgp,\n                      net_sls,\n                      net_tgp,\n                      dwa_cost_extnd,\n                      rbt_loc_accrl_amt,\n                      rbt_natl_accrl_amt,\n                      rbt_loc_exp_amt,\n                      rbt_natl_exp_amt,\n                      ttl_int_vndr_fnd_dvt,\n                      comm_bsis_amt_extnd,\n                      dond,\n                      ttl_vndr_fnd_dvt,\n                      fixed_sell,\n                      n_prime_sis,\n                      prc_apprvl,\n                      dwo,\n                      invst_cs_prtcpt,\n                      net_non_prod_chrg,\n                      net_prod_chrg,\n                      net_non_prod_alwnc,\n                      net_prod_alwnc,\n                      usf_gl_ind,\n                      cust_acqstn_stat_crnt,\n                      cust_acqstn_stat_actl,\n                      cust_acqstn_div_nbr,\n                      cust_acqstn_conv_ind_ty,\n                      cust_acqstn_conv_ind_ly,\n                      cust_acqstn_orgnc_ind_ty,\n                      cust_acqstn_orgnc_ind_ly)\n         (  SELECT   div_nbr,\n                     fisc_yr_wk,\n                     ly_wtd,\n                     pim_cls_id,\n                     pim_suprcls_id_crnt,\n                     pim_suprcls_id_actl,\n                     trd_cls,\n                     pyr_seg_cd,\n                     corp_mlt_unit_nbr,\n                     prnt_mlt_unit_cd,\n                     pim_brnd_typ,\n                     cust_cntrct_flg,\n                     cust_natl_mngd_flg,\n                     sls_revenue_div_nbr,\n                     cust_acctblty_flg,\n                     SUM (grs_sls_extnd) grs_sls_extnd,\n                     SUM (unfrm_qty_ship) unfrm_qty_ship,\n                     SUM (actl_gp) actl_gp,\n                     SUM (ttl_alwnc) ttl_alwnc,\n                     SUM (grs_tgp) grs_tgp,\n                     SUM (net_sls) net_sls,\n                     SUM (net_tgp) net_tgp,\n                     SUM (dwa_cost_extnd) dwa_cost_extnd,\n                     SUM (rbt_loc_accrl_amt) rbt_loc_accrl_amt,\n                     SUM (rbt_natl_accrl_amt) rbt_natl_accrl_amt,\n                     SUM (rbt_loc_exp_amt) rbt_loc_exp_amt,\n                     SUM (rbt_natl_exp_amt) rbt_natl_exp_amt,\n                     SUM (ttl_int_vndr_fnd_dvt_IS) ttl_int_vndr_fnd_dvt,  \n                     SUM (comm_bsis_amt_extnd_IS) comm_bsis_amt_extnd,    \n                     SUM (dond_IS) dond,                                  \n                     SUM (ttl_vndr_fnd_dvt) ttl_vndr_fnd_dvt,\n                     SUM (fixed_sell) fixed_sell,\n                     SUM (n_prime_sis) n_prime_sis,\n                     SUM (prc_apprvl) prc_apprvl,\n                     SUM (dwo) dwo,\n                     SUM (invst_cs_prtcpt) invst_cs_prtcpt,\n                     SUM (net_non_prod_chrg) net_non_prod_chrg,\n                     SUM (net_prod_chrg) net_prod_chrg,\n                     SUM (net_non_prod_alwnc) net_non_prod_alwnc,\n                     SUM (net_prod_alwnc) net_prod_alwnc,\n                     usf_gl_ind,\n                     cust_acqstn_stat_crnt,\n                     cust_acqstn_stat_actl,\n                     cust_acqstn_div_nbr,\n                     cust_acqstn_conv_ind_ty,\n                     cust_acqstn_conv_ind_ly,\n                     cust_acqstn_orgnc_ind_ty,\n                     cust_acqstn_orgnc_ind_ly\n              FROM   de459e2fe7f96e4d958537b31b946b26.0ad6212deb7aa1fcea6c3846d02d7978cdc81057bcd87469c7825d00b68d1ace\n             WHERE   LY_WTD = 'Y' and FISC_YR_WK = v_ly_fisc_yr_wk\n          GROUP BY   div_nbr,\n                     fisc_yr_wk,\n                     ly_wtd,\n                     pim_cls_id,\n                     pim_suprcls_id_crnt,\n                     pim_suprcls_id_actl,\n                     trd_cls,\n                     pyr_seg_cd,\n                     corp_mlt_unit_nbr,\n                     prnt_mlt_unit_cd,\n                     pim_brnd_typ,\n                     cust_cntrct_flg,\n                     cust_natl_mngd_flg,\n                     sls_revenue_div_nbr,\n                     cust_acctblty_flg,\n                     usf_gl_ind,\n                     cust_acqstn_stat_crnt,\n                     cust_acqstn_stat_actl,\n                     cust_acqstn_div_nbr,\n                      cust_acqstn_conv_ind_ty,\n                      cust_acqstn_conv_ind_ly,\n                      cust_acqstn_orgnc_ind_ty,\n                      cust_acqstn_orgnc_ind_ly);\n\nCOMMIT;\n\n\n\n      INSERT  INTO de459e2fe7f96e4d958537b31b946b26.111d8403d1a310eaa3e5f5659edd799205555163070770378c1769185c91a16b\n                    ( div_nbr,\n                      fisc_yr_wk,\n                      ly_wtd,\n                      pim_cls_id,\n                      pim_suprcls_id_crnt,\n                      pim_suprcls_id_actl,\n                      trd_cls,\n                      pyr_seg_cd,\n                      corp_mlt_unit_nbr,\n                      prnt_mlt_unit_cd,\n                      pim_brnd_typ,\n                      cust_cntrct_flg,\n                      cust_natl_mngd_flg,\n                      sls_revenue_div_nbr,\n                      cust_acctblty_flg,\n                      grs_sls_extnd,\n                      unfrm_qty_ship,\n                      actl_gp,\n                      ttl_alwnc,\n                      grs_tgp,\n                      net_sls,\n                      net_tgp,\n                      dwa_cost_extnd,\n                      rbt_loc_accrl_amt,\n                      rbt_natl_accrl_amt,\n                      rbt_loc_exp_amt,\n                      rbt_natl_exp_amt,\n                      ttl_int_vndr_fnd_dvt,\n                      comm_bsis_amt_extnd,\n                      dond,\n                      ttl_vndr_fnd_dvt,\n                      fixed_sell,\n                      n_prime_sis,\n                      prc_apprvl,\n                      dwo,\n                      invst_cs_prtcpt,\n                      net_non_prod_chrg,\n                      net_prod_chrg,\n                      net_non_prod_alwnc,\n                      net_prod_alwnc,\n                      usf_gl_ind,\n                      cust_acqstn_stat_crnt,\n                      cust_acqstn_stat_actl,\n                      cust_acqstn_div_nbr,\n                      cust_acqstn_conv_ind_ty,\n                      cust_acqstn_conv_ind_ly,\n                      cust_acqstn_orgnc_ind_ty,\n                      cust_acqstn_orgnc_ind_ly)\n         (  SELECT   div_nbr,\n                     fisc_yr_wk,\n                     'N' ly_wtd,\n                     pim_cls_id,\n                     pim_suprcls_id_crnt,\n                     pim_suprcls_id_actl,\n                     trd_cls,\n                     pyr_seg_cd,\n                     corp_mlt_unit_nbr,\n                     prnt_mlt_unit_cd,\n                     pim_brnd_typ,\n                     cust_cntrct_flg,\n                     cust_natl_mngd_flg,\n                     sls_revenue_div_nbr,\n                     cust_acctblty_flg,\n                     SUM (grs_sls_extnd) grs_sls_extnd,\n                     SUM (unfrm_qty_ship) unfrm_qty_ship,\n                     SUM (actl_gp) actl_gp,\n                     SUM (ttl_alwnc) ttl_alwnc,\n                     SUM (grs_tgp) grs_tgp,\n                     SUM (net_sls) net_sls,\n                     SUM (net_tgp) net_tgp,\n                     SUM (dwa_cost_extnd) dwa_cost_extnd,\n                     SUM (rbt_loc_accrl_amt) rbt_loc_accrl_amt,\n                     SUM (rbt_natl_accrl_amt) rbt_natl_accrl_amt,\n                     SUM (rbt_loc_exp_amt) rbt_loc_exp_amt,\n                     SUM (rbt_natl_exp_amt) rbt_natl_exp_amt,\n                     SUM (ttl_int_vndr_fnd_dvt_IS) ttl_int_vndr_fnd_dvt,  \n                     SUM (comm_bsis_amt_extnd_IS) comm_bsis_amt_extnd,    \n                     SUM (dond_IS) dond,                                  \n                     SUM (ttl_vndr_fnd_dvt) ttl_vndr_fnd_dvt,\n                     SUM (fixed_sell) fixed_sell,\n                     SUM (n_prime_sis) n_prime_sis,\n                     SUM (prc_apprvl) prc_apprvl,\n                     SUM (dwo) dwo,\n                     SUM (invst_cs_prtcpt) invst_cs_prtcpt,\n                     SUM (net_non_prod_chrg) net_non_prod_chrg,\n                     SUM (net_prod_chrg) net_prod_chrg,\n                     SUM (net_non_prod_alwnc) net_non_prod_alwnc,\n                     SUM (net_prod_alwnc) net_prod_alwnc,\n                      usf_gl_ind,\n                      cust_acqstn_stat_crnt,\n                      cust_acqstn_stat_actl,\n                      cust_acqstn_div_nbr,\n                      cust_acqstn_conv_ind_ty,\n                      cust_acqstn_conv_ind_ly,\n                      cust_acqstn_orgnc_ind_ty,\n                      cust_acqstn_orgnc_ind_ly\n              FROM   de459e2fe7f96e4d958537b31b946b26.0ad6212deb7aa1fcea6c3846d02d7978cdc81057bcd87469c7825d00b68d1ace\n             WHERE   FISC_YR_WK = v_ly_fisc_yr_wk\n          GROUP BY   div_nbr,\n                     fisc_yr_wk,\n                     'N',\n                     pim_cls_id,\n                     pim_suprcls_id_crnt,\n                     pim_suprcls_id_actl,\n                     trd_cls,\n                     pyr_seg_cd,\n                     corp_mlt_unit_nbr,\n                     prnt_mlt_unit_cd,\n                     pim_brnd_typ,\n                     cust_cntrct_flg,\n                     cust_natl_mngd_flg,\n                     sls_revenue_div_nbr,\n                     cust_acctblty_flg,\n                      usf_gl_ind,\n                      cust_acqstn_stat_crnt,\n                      cust_acqstn_stat_actl,\n                      cust_acqstn_div_nbr,\n                      cust_acqstn_conv_ind_ty,\n                      cust_acqstn_conv_ind_ly,\n                      cust_acqstn_orgnc_ind_ty,\n                      cust_acqstn_orgnc_ind_ly);\nCOMMIT;\n\n\n\n      INSERT  INTO de459e2fe7f96e4d958537b31b946b26.111d8403d1a310eaa3e5f5659edd799205555163070770378c1769185c91a16b\n                    ( div_nbr,\n                      fisc_yr_wk,\n                      ly_wtd,\n                      pim_cls_id,\n                      pim_suprcls_id_crnt,\n                      pim_suprcls_id_actl,\n                      trd_cls,\n                      pyr_seg_cd,\n                      corp_mlt_unit_nbr,\n                      prnt_mlt_unit_cd,\n                      pim_brnd_typ,\n                      cust_cntrct_flg,\n                      cust_natl_mngd_flg,\n                      sls_revenue_div_nbr,\n                      cust_acctblty_flg,\n                      grs_sls_extnd,\n                      unfrm_qty_ship,\n                      actl_gp,\n                      ttl_alwnc,\n                      grs_tgp,\n                      net_sls,\n                      net_tgp,\n                      dwa_cost_extnd,\n                      rbt_loc_accrl_amt,\n                      rbt_natl_accrl_amt,\n                      rbt_loc_exp_amt,\n                      rbt_natl_exp_amt,\n                      ttl_int_vndr_fnd_dvt,\n                      comm_bsis_amt_extnd,\n                      dond,\n                      ttl_vndr_fnd_dvt,\n                      fixed_sell,\n                      n_prime_sis,\n                      prc_apprvl,\n                      dwo,\n                      invst_cs_prtcpt,\n                      net_non_prod_chrg,\n                      net_prod_chrg,\n                      net_non_prod_alwnc,\n                      net_prod_alwnc,\n                      usf_gl_ind,\n                      cust_acqstn_stat_crnt,\n                      cust_acqstn_stat_actl,\n                      cust_acqstn_div_nbr,\n                      cust_acqstn_conv_ind_ty,\n                      cust_acqstn_conv_ind_ly,\n                      cust_acqstn_orgnc_ind_ty,\n                      cust_acqstn_orgnc_ind_ly)\n         (  SELECT   div_nbr,\n                     fisc_yr_wk,\n                     'N' ly_wtd,\n                     pim_cls_id,\n                     pim_suprcls_id_crnt,\n                     pim_suprcls_id_actl,\n                     trd_cls,\n                     pyr_seg_cd,\n                     corp_mlt_unit_nbr,\n                     prnt_mlt_unit_cd,\n                     pim_brnd_typ,\n                     cust_cntrct_flg,\n                     cust_natl_mngd_flg,\n                     sls_revenue_div_nbr,\n                     cust_acctblty_flg,\n                     SUM (grs_sls_extnd) grs_sls_extnd,\n                     SUM (unfrm_qty_ship) unfrm_qty_ship,\n                     SUM (actl_gp) actl_gp,\n                     SUM (ttl_alwnc) ttl_alwnc,\n                     SUM (grs_tgp) grs_tgp,\n                     SUM (net_sls) net_sls,\n                     SUM (net_tgp) net_tgp,\n                     SUM (dwa_cost_extnd) dwa_cost_extnd,\n                     SUM (rbt_loc_accrl_amt) rbt_loc_accrl_amt,\n                     SUM (rbt_natl_accrl_amt) rbt_natl_accrl_amt,\n                     SUM (rbt_loc_exp_amt) rbt_loc_exp_amt,\n                     SUM (rbt_natl_exp_amt) rbt_natl_exp_amt,\n                     SUM (ttl_int_vndr_fnd_dvt_IS) ttl_int_vndr_fnd_dvt,  \n                     SUM (comm_bsis_amt_extnd_IS) comm_bsis_amt_extnd,    \n                     SUM (dond_IS) dond,                                  \n                     SUM (ttl_vndr_fnd_dvt) ttl_vndr_fnd_dvt,\n                     SUM (fixed_sell) fixed_sell,\n                     SUM (n_prime_sis) n_prime_sis,\n                     SUM (prc_apprvl) prc_apprvl,\n                     SUM (dwo) dwo,\n                     SUM (invst_cs_prtcpt) invst_cs_prtcpt,\n                     SUM (net_non_prod_chrg) net_non_prod_chrg,\n                     SUM (net_prod_chrg) net_prod_chrg,\n                     SUM (net_non_prod_alwnc) net_non_prod_alwnc,\n                     SUM (net_prod_alwnc) net_prod_alwnc,\n                      usf_gl_ind,\n                      cust_acqstn_stat_crnt,\n                      cust_acqstn_stat_actl,\n                      cust_acqstn_div_nbr,\n                      cust_acqstn_conv_ind_ty,\n                      cust_acqstn_conv_ind_ly,\n                      cust_acqstn_orgnc_ind_ty,\n                      cust_acqstn_orgnc_ind_ly\n              FROM   de459e2fe7f96e4d958537b31b946b26.0ad6212deb7aa1fcea6c3846d02d7978cdc81057bcd87469c7825d00b68d1ace\n             WHERE   FISC_YR_WK = v_cy_fisc_yr_wk and pim_suprcls_id_crnt <> '-99'\n          GROUP BY   div_nbr,\n                     fisc_yr_wk,\n                     'N',\n                     pim_cls_id,\n                     pim_suprcls_id_crnt,\n                     pim_suprcls_id_actl,\n                     trd_cls,\n                     pyr_seg_cd,\n                     corp_mlt_unit_nbr,\n                     prnt_mlt_unit_cd,\n                     pim_brnd_typ,\n                     cust_cntrct_flg,\n                     cust_natl_mngd_flg,\n                     sls_revenue_div_nbr,\n                     cust_acctblty_flg,\n                      usf_gl_ind,\n                      cust_acqstn_stat_crnt,\n                      cust_acqstn_stat_actl,\n                      cust_acqstn_div_nbr,\n                      cust_acqstn_conv_ind_ty,\n                      cust_acqstn_conv_ind_ly,\n                      cust_acqstn_orgnc_ind_ty,\n                      cust_acqstn_orgnc_ind_ly);\n\nCOMMIT;\n\nELSE\n\n   \n\n \n\n       INSERT  INTO de459e2fe7f96e4d958537b31b946b26.111d8403d1a310eaa3e5f5659edd799205555163070770378c1769185c91a16b\n              (div_nbr,\n               fisc_yr_wk,\n               ly_wtd,\n               pim_cls_id,\n               pim_suprcls_id_crnt,\n               pim_suprcls_id_actl,\n               trd_cls,\n               pyr_seg_cd,\n               corp_mlt_unit_nbr,\n               prnt_mlt_unit_cd,\n               pim_brnd_typ,\n               cust_cntrct_flg,\n               cust_natl_mngd_flg,\n               sls_revenue_div_nbr,\n               cust_acctblty_flg,\n               grs_sls_extnd,\n               unfrm_qty_ship,\n               actl_gp,\n               ttl_alwnc,\n               grs_tgp,\n               net_sls,\n               net_tgp,\n               dwa_cost_extnd,\n               rbt_loc_accrl_amt,\n               rbt_natl_accrl_amt,\n               rbt_loc_exp_amt,\n               rbt_natl_exp_amt,\n               ttl_int_vndr_fnd_dvt,\n               comm_bsis_amt_extnd,\n               dond,\n               ttl_vndr_fnd_dvt,\n               fixed_sell,\n               n_prime_sis,\n               prc_apprvl,\n               dwo,\n               invst_cs_prtcpt,\n               net_non_prod_chrg,\n               net_prod_chrg,\n               net_non_prod_alwnc,\n               net_prod_alwnc,\n               usf_gl_ind,\n               cust_acqstn_stat_crnt,\n               cust_acqstn_stat_actl,\n               cust_acqstn_div_nbr,\n                      cust_acqstn_conv_ind_ty,\n                      cust_acqstn_conv_ind_ly,\n                      cust_acqstn_orgnc_ind_ty,\n                      cust_acqstn_orgnc_ind_ly)\n               (\n               SELECT\n                  div_nbr,\n                  fisc_yr_wk,\n                  ly_wtd,\n                  pim_cls_id,\n                  pim_suprcls_id_crnt,\n                  pim_suprcls_id_actl,\n                  trd_cls,\n                  pyr_seg_cd,\n                  corp_mlt_unit_nbr,\n                  prnt_mlt_unit_cd,\n                  pim_brnd_typ,\n                  cust_cntrct_flg,\n                  cust_natl_mngd_flg,\n                  sls_revenue_div_nbr,\n                  cust_acctblty_flg,\n                  SUM (grs_sls_extnd) grs_sls_extnd,\n                  SUM (unfrm_qty_ship) unfrm_qty_ship,\n                  SUM (actl_gp) actl_gp,\n                  SUM (ttl_alwnc) ttl_alwnc,\n                  SUM (grs_tgp) grs_tgp,\n                  SUM (net_sls) net_sls,\n                  SUM (net_tgp) net_tgp,\n                  SUM (dwa_cost_extnd) dwa_cost_extnd,\n                  SUM (rbt_loc_accrl_amt) rbt_loc_accrl_amt,\n                  SUM (rbt_natl_accrl_amt) rbt_natl_accrl_amt,\n                  SUM (rbt_loc_exp_amt) rbt_loc_exp_amt,\n                  SUM (rbt_natl_exp_amt) rbt_natl_exp_amt,\n                  SUM (ttl_int_vndr_fnd_dvt_IS) ttl_int_vndr_fnd_dvt,              \n                  SUM (comm_bsis_amt_extnd_IS) comm_bsis_amt_extnd,                \n                  SUM (dond_IS) dond,                                              \n                  SUM (ttl_vndr_fnd_dvt) ttl_vndr_fnd_dvt,\n                  SUM (fixed_sell) fixed_sell,\n                  SUM (n_prime_sis) n_prime_sis,\n                  SUM (prc_apprvl) prc_apprvl,\n                  SUM (dwo) dwo,\n                  SUM (invst_cs_prtcpt) invst_cs_prtcpt,\n                  SUM (net_non_prod_chrg) net_non_prod_chrg,\n                  SUM (net_prod_chrg) net_prod_chrg,\n                  SUM (net_non_prod_alwnc) net_non_prod_alwnc,\n                  SUM (net_prod_alwnc) net_prod_alwnc,\n                  usf_gl_ind,\n                  cust_acqstn_stat_crnt,\n                  cust_acqstn_stat_actl,\n                  cust_acqstn_div_nbr,\n                      cust_acqstn_conv_ind_ty,\n                      cust_acqstn_conv_ind_ly,\n                      cust_acqstn_orgnc_ind_ty,\n                      cust_acqstn_orgnc_ind_ly\n           FROM   de459e2fe7f96e4d958537b31b946b26.0ad6212deb7aa1fcea6c3846d02d7978cdc81057bcd87469c7825d00b68d1ace\n          \n       GROUP BY   div_nbr,\n                  fisc_yr_wk,\n                  ly_wtd,\n                  pim_cls_id,\n                  pim_suprcls_id_crnt,\n                  pim_suprcls_id_actl,\n                  trd_cls,\n                  pyr_seg_cd,\n                  corp_mlt_unit_nbr,\n                  prnt_mlt_unit_cd,\n                  pim_brnd_typ,\n                  cust_cntrct_flg,\n                  cust_natl_mngd_flg,\n                  sls_revenue_div_nbr,\n                  cust_acctblty_flg,\n                  usf_gl_ind,\n                  cust_acqstn_stat_crnt,\n                  cust_acqstn_stat_actl,\n                  cust_acqstn_div_nbr,\n                      cust_acqstn_conv_ind_ty,\n                      cust_acqstn_conv_ind_ly,\n                      cust_acqstn_orgnc_ind_ty,\n                      cust_acqstn_orgnc_ind_ly\n            );\n\n   DBMS_OUTPUT.put_line('Inserted Rows in Load Table for Curr year: ' || sql%ROWCOUNT);\n\n   END IF;\n\n   COMMIT;\n\n\n\n   DBMS_OUTPUT.put_line('Analyze the Load aggregate table ' || l_load_tbl_nm);\n   l_return_code    := de459e2fe7f96e4d958537b31b946b26.9b3711c37bca8fd1d7c76527508615f9(c_schema, l_load_tbl_nm);\n\n   IF (l_return_code <> 0) THEN\n      l_object_nm   := l_load_tbl_nm;\n      RAISE e_analyze_table;\n   END IF;\n\n   \n\n   \n   SELECT   SUM (unfrm_qty_ship), SUM (grs_sls_extnd)\n     INTO   v_base_cases_cnt, v_base_sales\n     FROM   (  SELECT   div_nbr,\n                        fisc_yr_wk,\n                        ly_wtd,\n                        pim_cls_id,\n                        pim_suprcls_id_crnt,\n                        pim_suprcls_id_actl,\n                        trd_cls,\n                        pyr_seg_cd,\n                        corp_mlt_unit_nbr,\n                        prnt_mlt_unit_cd,\n                        pim_brnd_typ,\n                        cust_cntrct_flg,\n                        cust_natl_mngd_flg,\n                        sls_revenue_div_nbr,\n                        cust_acctblty_flg,\n                        SUM (unfrm_qty_ship) unfrm_qty_ship,\n                        SUM (grs_sls_extnd) grs_sls_extnd,\n                        usf_gl_ind,\n                        cust_acqstn_stat_crnt,\n                        cust_acqstn_stat_actl,\n                        cust_acqstn_div_nbr\n                 FROM   de459e2fe7f96e4d958537b31b946b26.0ad6212deb7aa1fcea6c3846d02d7978cdc81057bcd87469c7825d00b68d1ace\n                 WHERE  fisc_yr_wk not in (v_ly_fisc_yr_wk,v_cy_fisc_yr_wk)\n             GROUP BY   div_nbr,\n                        fisc_yr_wk,\n                        ly_wtd,\n                        pim_cls_id,\n                        pim_suprcls_id_crnt,\n                        pim_suprcls_id_actl,\n                        trd_cls,\n                        pyr_seg_cd,\n                        corp_mlt_unit_nbr,\n                        prnt_mlt_unit_cd,\n                        pim_brnd_typ,\n                        cust_cntrct_flg,\n                        cust_natl_mngd_flg,\n                        sls_revenue_div_nbr,\n                        cust_acctblty_flg,\n                        usf_gl_ind,\n                        cust_acqstn_stat_crnt,\n                        cust_acqstn_stat_actl,\n                        cust_acqstn_div_nbr);\n\n    DBMS_OUTPUT.put_line('Base Cases = ' || v_base_cases_cnt);\n    DBMS_OUTPUT.put_line('Base Sales = ' || v_base_sales);\n\n   \n   SELECT  NVL(SUM(unfrm_qty_ship),0),  NVL(SUM(grs_sls_extnd),0)\n           INTO v_aggr_cases_cnt, v_aggr_sales\n   FROM  SALES_SUMM_PYR_WKLY_LOAD\n    WHERE  (fisc_yr_wk not in (v_ly_fisc_yr_wk,v_cy_fisc_yr_wk) );\n\n   DBMS_OUTPUT.put_line('Aggregate Cases = ' || v_aggr_cases_cnt);\n   DBMS_OUTPUT.put_line('Aggregate Sales = ' || v_aggr_sales);\n\n   \n   IF v_base_cases_cnt = v_aggr_cases_cnt  AND v_base_sales = v_aggr_sales THEN\n      DBMS_OUTPUT.put_line('Success: Base and aggregate numbers for cases and sales match');\n      RETURN 6726798abbc757d8442516fefb8c40e9.79565b4ea20e0d36bc7365f1c4259002;\n   ELSE\n      DBMS_OUTPUT.put_line('Error: Base and aggregate numbers for cases and sales do not match');\n      RETURN 6726798abbc757d8442516fefb8c40e9.de3afdf274dc4a6f320906a012ba2f12;\n   END IF;\n\n\n   \n\n\n   RETURN c_success;\nEXCEPTION\n    WHEN e_syn THEN\n      DBMS_OUTPUT.put_line(\n         'Synonym currently points to Load table: ' || c_aggr_load_syn_nm || '. Requires manual update.');\n      DBMS_OUTPUT.put_line('Verify the ' ||c_aggr_load_syn_nm|| ' and ' ||c_aggr_load_syn_nm|| ' synonyms');\n      RETURN 6726798abbc757d8442516fefb8c40e9.de3afdf274dc4a6f320906a012ba2f12;\n   WHEN e_truncate_table THEN\n      DBMS_OUTPUT.put_line('Error Truncating Table: ' || l_load_tbl_nm || '. Requires manual update.');\n      DBMS_OUTPUT.put_line('Verify '||l_load_tbl_nm||' table has any records');\n      DBMS_OUTPUT.put_line(l_out_msg);\n      RETURN 6726798abbc757d8442516fefb8c40e9.de3afdf274dc4a6f320906a012ba2f12;\n   WHEN e_analyze_table THEN\n      DBMS_OUTPUT.put_line('Error Analyzing Table: ' || l_load_tbl_nm || '. Requires manual update.');\n      DBMS_OUTPUT.put_line(l_out_msg);\n      RETURN 6726798abbc757d8442516fefb8c40e9.de3afdf274dc4a6f320906a012ba2f12;\n   WHEN OTHERS THEN\n      DBMS_OUTPUT.put_line('Error creating Sales Pyramid aggregate data');\n      DBMS_OUTPUT.put_line(SQLCODE || ': ' || SQLERRM);\n      RETURN 6726798abbc757d8442516fefb8c40e9.de3afdf274dc4a6f320906a012ba2f12;\nEND;\n/",
            "upstream_dependencies": [],
            "downstream_dependencies": [],
            "dag_location": "null",
            "gantt_location": "null",
            "created_at": "null",
            "updated_at": "null"
        },
        {
            "name": "FN_USR_DIV_ALL_VPD",
            "encrypted_name": "c6aee0e87266ff801fcba6872d6bbcfb9d8b3fe8760b7fe8c45d1255ce1ebaf6",
            "type": "function",
            "database": "null",
            "encrypted_database": "null",
            "schema": "XDMADM",
            "encrypted_schema": "0e03d5c46556a742ba46252698396ef2",
            "fully_qualified_name": "XDMADM.FN_USR_DIV_ALL_VPD",
            "encrypted_fqn": "0e03d5c46556a742ba46252698396ef2.c6aee0e87266ff801fcba6872d6bbcfb9d8b3fe8760b7fe8c45d1255ce1ebaf6",
            "synonyms": [],
            "metadata_analysis": "CREATE OR REPLACE FUNCTION \"0e03d5c46556a742ba46252698396ef2\".\"c6aee0e87266ff801fcba6872d6bbcfb9d8b3fe8760b7fe8c45d1255ce1ebaf6\" (p_schema       IN VARCHAR2,\n                                              p_objname      IN VARCHAR2)\n   RETURN VARCHAR2 AS\n   \n   c_start                CONSTANT NUMBER := DBMS_UTILITY.get_time;\n   c_fn_nm                CONSTANT VARCHAR2(30) := 'FN_USR_DIV_ALL_VPD';\n   l_security_predicate   VARCHAR2(4000) DEFAULT NULL;\n   l_cur_sql              VARCHAR2(4000) := SYS_CONTEXT('USERENV', 'CURRENT_SQL');\n   l_sbjct_area VARCHAR2(100)\n         := SYS_CONTEXT(9751bbbcfea690cc0be4d58830a6fe2e.9bfb5eb7793dc8fa6800d5a61e5e3e4e1e2f6ec194927f064ce6cb31fba71a32.f4a54ebc6f2c591ed4266aafe66971af, 9751bbbcfea690cc0be4d58830a6fe2e.9bfb5eb7793dc8fa6800d5a61e5e3e4e1e2f6ec194927f064ce6cb31fba71a32.3b1288ed835b1b524e9500bb13544956e6e6300089dae5a98e31814d0406060f);\n   l_vpd_exempt VARCHAR2(1)\n         := SYS_CONTEXT(9751bbbcfea690cc0be4d58830a6fe2e.9bfb5eb7793dc8fa6800d5a61e5e3e4e1e2f6ec194927f064ce6cb31fba71a32.f4a54ebc6f2c591ed4266aafe66971af, 9751bbbcfea690cc0be4d58830a6fe2e.9bfb5eb7793dc8fa6800d5a61e5e3e4e1e2f6ec194927f064ce6cb31fba71a32.0eaf613ab52a53601d1496b5650de81e);\n   l_all_divs VARCHAR2(1)\n         := SYS_CONTEXT(9751bbbcfea690cc0be4d58830a6fe2e.9bfb5eb7793dc8fa6800d5a61e5e3e4e1e2f6ec194927f064ce6cb31fba71a32.f4a54ebc6f2c591ed4266aafe66971af, 9751bbbcfea690cc0be4d58830a6fe2e.9bfb5eb7793dc8fa6800d5a61e5e3e4e1e2f6ec194927f064ce6cb31fba71a32.0f460756ee76d4a2460733464cda5f95);\n   l_usr_div_all          VARCHAR2(5);\n   l_div_count            NUMBER := 0;\n   l_usr_div_date         VARCHAR2(11);\n   l_spcl_hndling         VARCHAR2(20) DEFAULT NULL;\n   l_div_nbr              NUMBER := 0;\n   l_first                BOOLEAN := TRUE;\n\n   CURSOR divs_c(p_user          VARCHAR2,\n                 p_sbjct_area    VARCHAR2) IS\n      SELECT 9751bbbcfea690cc0be4d58830a6fe2e.77f574c4275330a2ed961a49e2cb2df5.839c4ffb4bfaae1bb58eab4dee67d96a\n        FROM 9751bbbcfea690cc0be4d58830a6fe2e.77f574c4275330a2ed961a49e2cb2df5 ud, de459e2fe7f96e4d958537b31b946b26.dec387908a0954ddc8689c4ad37c8a3c dc\n       WHERE 9751bbbcfea690cc0be4d58830a6fe2e.77f574c4275330a2ed961a49e2cb2df5.839c4ffb4bfaae1bb58eab4dee67d96a = de459e2fe7f96e4d958537b31b946b26.dec387908a0954ddc8689c4ad37c8a3c.839c4ffb4bfaae1bb58eab4dee67d96a\n         AND UPPER(usr_nm) = p_user\n         AND sbjct_area IN (p_sbjct_area, 'ALL');\n\n   divs_rec               divs_c%ROWTYPE;\nBEGIN\n   \n   IF l_sbjct_area IS NULL THEN\n      l_security_predicate   := '1=2';\n      9751bbbcfea690cc0be4d58830a6fe2e.d4abe88ed2062b430c927bc84d61faf1f9a7aadf5998d448c2e2d1b0b47a3056.7d64937276682b23a0e16e5c61dad7aa('NO SA', c_fn_nm, USER, p_schema, p_objname, l_sbjct_area, l_vpd_exempt,\n      l_all_divs, l_cur_sql, l_security_predicate, (DBMS_UTILITY.get_time - c_start) / 100);\n\n      RETURN l_security_predicate;\n   END IF;\n\n   \n   \n   IF l_vpd_exempt = 'Y' THEN\n      l_security_predicate   := '1=1';\n      9751bbbcfea690cc0be4d58830a6fe2e.d4abe88ed2062b430c927bc84d61faf1f9a7aadf5998d448c2e2d1b0b47a3056.7d64937276682b23a0e16e5c61dad7aa('EXEMPT', c_fn_nm, USER, p_schema, p_objname, l_sbjct_area, l_vpd_exempt,\n      l_all_divs, l_cur_sql, l_security_predicate, (DBMS_UTILITY.get_time - c_start) / 100);\n\n      RETURN l_security_predicate;\n   END IF;\n\n   \n   \n   IF l_all_divs = 'Y' THEN\n      l_security_predicate   := '1=1';\n      9751bbbcfea690cc0be4d58830a6fe2e.d4abe88ed2062b430c927bc84d61faf1f9a7aadf5998d448c2e2d1b0b47a3056.7d64937276682b23a0e16e5c61dad7aa('ALL DIVS', c_fn_nm, USER, p_schema, p_objname, l_sbjct_area, l_vpd_exempt,\n      l_all_divs, l_cur_sql, l_security_predicate, (DBMS_UTILITY.get_time - c_start) / 100);\n\n      RETURN l_security_predicate;\n   END IF;\n\n   SELECT COUNT( * )\n     INTO l_div_count\n     FROM 9751bbbcfea690cc0be4d58830a6fe2e.77f574c4275330a2ed961a49e2cb2df5 ud, de459e2fe7f96e4d958537b31b946b26.dec387908a0954ddc8689c4ad37c8a3c dc\n    WHERE 9751bbbcfea690cc0be4d58830a6fe2e.77f574c4275330a2ed961a49e2cb2df5.839c4ffb4bfaae1bb58eab4dee67d96a = de459e2fe7f96e4d958537b31b946b26.dec387908a0954ddc8689c4ad37c8a3c.839c4ffb4bfaae1bb58eab4dee67d96a\n      AND 9751bbbcfea690cc0be4d58830a6fe2e.77f574c4275330a2ed961a49e2cb2df5.2487b33bfe363b72c30841fcf6b4451b = USER\n      AND 9751bbbcfea690cc0be4d58830a6fe2e.77f574c4275330a2ed961a49e2cb2df5.39ebeb219ed1244dec0e84ff7af83631 IN (l_sbjct_area, 'ALL')\n      AND 9751bbbcfea690cc0be4d58830a6fe2e.77f574c4275330a2ed961a49e2cb2df5.839c4ffb4bfaae1bb58eab4dee67d96a IS NOT NULL;\n\n   IF l_div_count > 0 THEN\n      l_first                := TRUE;\n\n      OPEN divs_c(USER, l_sbjct_area);\n\n      LOOP\n         FETCH divs_c INTO divs_rec;\n\n         EXIT WHEN divs_c%NOTFOUND;\n\n         IF l_first THEN\n            l_security_predicate   := 'DIV_NBR IN (' || 5a219141042999aad7af812b50802575.839c4ffb4bfaae1bb58eab4dee67d96a;\n            l_first                := FALSE;\n         ELSE\n            l_security_predicate   := l_security_predicate || ',' || 5a219141042999aad7af812b50802575.839c4ffb4bfaae1bb58eab4dee67d96a;\n         END IF;\n      END LOOP;\n\n      CLOSE divs_c;\n\n      l_security_predicate   := l_security_predicate || ')';\n   ELSE\n      \n      l_security_predicate   := '1=2';\n   END IF;\n\n   9751bbbcfea690cc0be4d58830a6fe2e.d4abe88ed2062b430c927bc84d61faf1f9a7aadf5998d448c2e2d1b0b47a3056.7d64937276682b23a0e16e5c61dad7aa('USR DIVS', c_fn_nm, USER, p_schema, p_objname, l_sbjct_area, l_vpd_exempt,\n   l_all_divs, l_cur_sql, l_security_predicate, (DBMS_UTILITY.get_time - c_start) / 100);\n\n   RETURN l_security_predicate;\nEXCEPTION\n   WHEN OTHERS THEN\n      l_security_predicate   := '1=2';\n      9751bbbcfea690cc0be4d58830a6fe2e.d4abe88ed2062b430c927bc84d61faf1f9a7aadf5998d448c2e2d1b0b47a3056.7d64937276682b23a0e16e5c61dad7aa(SQLCODE || '-' || SQLERRM, c_fn_nm, USER, p_schema, p_objname, l_sbjct_area,\n      l_vpd_exempt, NULL, l_cur_sql, l_security_predicate, (DBMS_UTILITY.get_time - c_start) / 100);\n\n      RETURN l_security_predicate;\nEND fn_usr_div_all_vpd;\n/",
            "upstream_dependencies": [],
            "downstream_dependencies": [],
            "dag_location": "null",
            "gantt_location": "null",
            "created_at": "null",
            "updated_at": "null"
        },
        {
            "name": "FN_SYN_SWAP",
            "encrypted_name": "b0c7b228cc9d5cd4595cb075b166be06",
            "type": "function",
            "database": "null",
            "encrypted_database": "null",
            "schema": "XDMADM",
            "encrypted_schema": "0e03d5c46556a742ba46252698396ef2",
            "fully_qualified_name": "XDMADM.FN_SYN_SWAP",
            "encrypted_fqn": "0e03d5c46556a742ba46252698396ef2.b0c7b228cc9d5cd4595cb075b166be06",
            "synonyms": [],
            "metadata_analysis": "CREATE OR REPLACE FUNCTION \"0e03d5c46556a742ba46252698396ef2\".\"b0c7b228cc9d5cd4595cb075b166be06\" (p_param_type VARCHAR2, odate IN DATE)\n   RETURN NUMBER AS\n \n\n   v_clndr_day_nm           VARCHAR2(30);  \n   v_sat                    DATE;          \n\n   l_curr_tbl\t\t\t\tVARCHAR2(30);\n   l_load_tbl\t\t\t\tVARCHAR2(30);\n   l_tbl_desc\t\t\t\tVARCHAR2(300);\n\n   l_return_code\t\t\tNUMBER := 0;\n   l_object_nm\t\t\t\tVARCHAR2(30);\n   l_out_msg\t\t\t\tVARCHAR2(256);\n\n   e_create_synonym exception;\n   e_truncate_table exception;\n\n   CURSOR c_get_tbls IS\n   SELECT param_code tbl_nm, param_value_chr description\n   FROM de459e2fe7f96e4d958537b31b946b26.de40ae7be8b2eb3858d46af8d107f3db\n   WHERE app_name = 'ALL'\n   AND param_type = p_param_type;\nBEGIN\n   FOR r_get_tbls IN c_get_tbls LOOP\n      \n      EXECUTE IMMEDIATE 'SELECT table_name FROM user_synonyms WHERE synonym_name = ''' || 95aa360291c8076adc9dfad67c7cb793.80f6badb5be48efbfc5290fa64e4e111 || '''' INTO l_curr_tbl;\n\n      EXECUTE IMMEDIATE 'SELECT table_name FROM user_synonyms WHERE synonym_name = ''' || 95aa360291c8076adc9dfad67c7cb793.80f6badb5be48efbfc5290fa64e4e111 || '_LOAD''' INTO l_load_tbl;\n\n      DBMS_OUTPUT.put_line('Currently Active Table: ' || l_curr_tbl);\n      DBMS_OUTPUT.put_line('Newly Loaded Table: ' || l_load_tbl);\n\n      \n      l_return_code   := de459e2fe7f96e4d958537b31b946b26.f21751d25bb3675b2a3778f4f03c7da6(95aa360291c8076adc9dfad67c7cb793.80f6badb5be48efbfc5290fa64e4e111, 6726798abbc757d8442516fefb8c40e9.01ad20b6c8a2d0aaccf3dde9aaedb75e, l_load_tbl);\n      DBMS_OUTPUT.put_line('Create synonym ' || 95aa360291c8076adc9dfad67c7cb793.80f6badb5be48efbfc5290fa64e4e111 || ' for ' || 6726798abbc757d8442516fefb8c40e9.01ad20b6c8a2d0aaccf3dde9aaedb75e || '.' || l_load_tbl || ': ' || l_return_code);\n\n      IF (l_return_code <> 0) THEN\n\t\tl_object_nm := 95aa360291c8076adc9dfad67c7cb793.80f6badb5be48efbfc5290fa64e4e111;\n\t\tRAISE e_create_synonym;\n      END IF;\n\n      l_return_code   := de459e2fe7f96e4d958537b31b946b26.f21751d25bb3675b2a3778f4f03c7da6(95aa360291c8076adc9dfad67c7cb793.80f6badb5be48efbfc5290fa64e4e111 || '_LOAD', 6726798abbc757d8442516fefb8c40e9.01ad20b6c8a2d0aaccf3dde9aaedb75e, l_curr_tbl);\n      DBMS_OUTPUT.put_line('Create synonym ' || 95aa360291c8076adc9dfad67c7cb793.80f6badb5be48efbfc5290fa64e4e111 || '_LOAD' || ' for ' || 6726798abbc757d8442516fefb8c40e9.01ad20b6c8a2d0aaccf3dde9aaedb75e || '.' || l_curr_tbl || ': ' || l_return_code);\n\n      IF (l_return_code <> 0) THEN\n\t\tl_object_nm := 95aa360291c8076adc9dfad67c7cb793.80f6badb5be48efbfc5290fa64e4e111 || '_LOAD';\n\t\tRAISE e_create_synonym;\n      END IF;\n\n      \n      l_return_code   := 8e64339f96bb08058f5d52f1c04f954a.8ffe4678890c39c7d4ed38c2ed759e24.e4b5db2b3f9b19accbb8cddbfcd05bac(l_out_msg, 6726798abbc757d8442516fefb8c40e9.01ad20b6c8a2d0aaccf3dde9aaedb75e, l_curr_tbl);\n      DBMS_OUTPUT.put_line('Truncate Prev Aggr Table Return: ' || l_return_code || ' - ' || l_out_msg);\n\n      IF (l_return_code <> 0) THEN\n\t\tl_object_nm := l_curr_tbl;\n\t\tRAISE e_truncate_table;\n      END IF;\n\n\t  \n\t  UPDATE de459e2fe7f96e4d958537b31b946b26.0b3320d3f985cd20d1ec65d9dfeed2de\n\t  SET div_load_stat = 1, div_load_ts = TRUNC(odate)\n\t  WHERE fact_table = 95aa360291c8076adc9dfad67c7cb793.80f6badb5be48efbfc5290fa64e4e111;\n\n\t  \n\t  IF (sql%ROWCOUNT = 0) THEN\n\t\tINSERT INTO de459e2fe7f96e4d958537b31b946b26.0b3320d3f985cd20d1ec65d9dfeed2de(fact_table, div_nbr, fact_table_dsply_nm, fact_typ_desc, latest_prcs_dt,\n\t\t\tdiv_load_stat, div_load_ts, prcs_dt, load_freq, rpt_dsply_ind)\n\t\tVALUES (95aa360291c8076adc9dfad67c7cb793.80f6badb5be48efbfc5290fa64e4e111, 0, 95aa360291c8076adc9dfad67c7cb793.657d83391de9d94aae343fef3de23080, 95aa360291c8076adc9dfad67c7cb793.657d83391de9d94aae343fef3de23080, SYSDATE, 1, TRUNC(odate), TRUNC(odate) + 1, 'DAILY', 'Y'); \n\t  END IF;\n\t  COMMIT;\n   \n\n         \n\n   BEGIN   \n           select clndr_day_nm into v_clndr_day_nm from de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001 where clndr_dt = TRUNC(odate);\n           IF v_clndr_day_nm='SUNDAY' THEN\n                   dbms_output.put_line('Sunday process date. Update with Saturday date.');\n                   v_sat := odate -1;\n                   UPDATE de459e2fe7f96e4d958537b31b946b26.0b3320d3f985cd20d1ec65d9dfeed2de\n                   SET div_load_stat = 1, div_load_ts = TRUNC(v_sat) \n                   WHERE fact_table = 95aa360291c8076adc9dfad67c7cb793.80f6badb5be48efbfc5290fa64e4e111;\n\n                   \n                   IF (sql%ROWCOUNT = 0) THEN\n                      INSERT INTO de459e2fe7f96e4d958537b31b946b26.0b3320d3f985cd20d1ec65d9dfeed2de(fact_table, div_nbr, fact_table_dsply_nm, fact_typ_desc, latest_prcs_dt,\n                                                        div_load_stat, div_load_ts, prcs_dt, load_freq, rpt_dsply_ind)\n                          VALUES (6726798abbc757d8442516fefb8c40e9.716900750ba6b5d499e5b9bc59348974, 0, 'Pyramid Aggs', 'Pyramid Aggs', SYSDATE, 1,\n                                  TRUNC(v_sat), TRUNC(v_sat) + 1, 'DAILY', 'Y');\n                    END IF;\n           ELSE    \n                  dbms_output.put_line('It is not a Sunday Date');\n                  \n                    UPDATE de459e2fe7f96e4d958537b31b946b26.0b3320d3f985cd20d1ec65d9dfeed2de\n                    SET div_load_stat = 1, div_load_ts = TRUNC(odate)\n                    WHERE fact_table = 95aa360291c8076adc9dfad67c7cb793.80f6badb5be48efbfc5290fa64e4e111;\n\n                   \n                   IF (sql%ROWCOUNT = 0) THEN\n                      INSERT INTO de459e2fe7f96e4d958537b31b946b26.0b3320d3f985cd20d1ec65d9dfeed2de(fact_table, div_nbr, fact_table_dsply_nm, fact_typ_desc, latest_prcs_dt,\n                                                        div_load_stat, div_load_ts, prcs_dt, load_freq, rpt_dsply_ind)\n                          VALUES (95aa360291c8076adc9dfad67c7cb793.80f6badb5be48efbfc5290fa64e4e111, 0, 'Pyramid Aggs', 'Pyramid Aggs', SYSDATE, 1,\n                                  TRUNC(odate), TRUNC(odate) + 1, 'DAILY', 'Y'); \n                   END IF;\n           END IF;\n   END;        \n   COMMIT;\n\n   END LOOP;\n\n   RETURN 6726798abbc757d8442516fefb8c40e9.79565b4ea20e0d36bc7365f1c4259002;\n\nEXCEPTION\n   WHEN e_create_synonym THEN\n      DBMS_OUTPUT.put_line('Error Creating Synonym: ' || l_object_nm || '. Requires manual update.');\n      RETURN 6726798abbc757d8442516fefb8c40e9.de3afdf274dc4a6f320906a012ba2f12;\n   WHEN e_truncate_table THEN\n      DBMS_OUTPUT.put_line('Error Truncating Table: ' || l_object_nm || '. Requires manual update.');\n      DBMS_OUTPUT.put_line(l_out_msg);\n      RETURN 6726798abbc757d8442516fefb8c40e9.de3afdf274dc4a6f320906a012ba2f12;\n   WHEN OTHERS THEN\n      ROLLBACK;\n      DBMS_OUTPUT.put_line('Unexpected Error In Synonym Swap Procedure. Requires manual update.');\n      DBMS_OUTPUT.put_line(SQLCODE || ': ' || SQLERRM);\n      RETURN 6726798abbc757d8442516fefb8c40e9.de3afdf274dc4a6f320906a012ba2f12;\nEND;\n/",
            "upstream_dependencies": [],
            "downstream_dependencies": [],
            "dag_location": "null",
            "gantt_location": "null",
            "created_at": "null",
            "updated_at": "null"
        },
        {
            "name": "FN_FWB_MDL_BRIDGE_LOAD",
            "encrypted_name": "15d4545d5a22d40c60e901338b3fe0114173ca9ff31147ddcb0ed93eaee4ca62",
            "type": "function",
            "database": "null",
            "encrypted_database": "null",
            "schema": "XDMADM",
            "encrypted_schema": "0e03d5c46556a742ba46252698396ef2",
            "fully_qualified_name": "XDMADM.FN_FWB_MDL_BRIDGE_LOAD",
            "encrypted_fqn": "0e03d5c46556a742ba46252698396ef2.15d4545d5a22d40c60e901338b3fe0114173ca9ff31147ddcb0ed93eaee4ca62",
            "synonyms": [],
            "metadata_analysis": "CREATE OR REPLACE FUNCTION \"0e03d5c46556a742ba46252698396ef2\".\"15d4545d5a22d40c60e901338b3fe0114173ca9ff31147ddcb0ed93eaee4ca62\" (p_odate IN VARCHAR2, p_abort_flg IN VARCHAR2)\nRETURN NUMBER IS\n\n\n\n\n        CON_PROCESS_NAME   CONSTANT      VARCHAR2(40) := 'FN_FWB_MDL_BRIDGE_LOAD';  \n\n        v_prcs_err_cd                    NUMBER;\n        v_prcs_err_msg                   VARCHAR2(500);\n        v_prcs_stp                       VARCHAR2(500);\n\n        v_ddm_owner                      VARCHAR2(40) := 'XDMADM' ;   \n        v_ddm_tbl_nm                     VARCHAR2(40) := 'FWB_MDL_BRIDGE';   \n        v_dba_func_msg                   VARCHAR2(2000) := 'oXo';\n        v_in_str                         VARCHAR2(4000);\n\n        v_excp                          EXCEPTION;\n        opo_no_rows                     EXCEPTION;\n\n        v_opo_corp_stat                 NUMBER;\n        v_odate                         DATE := to_date(p_odate,'yyyymmdd');\n\n        v_gain_end_days                 NUMBER;\n        v_reval_ship_dt_null_days       NUMBER;\n        v_reval_po_lbound_days               NUMBER;\n\n        v_opo_corp_schedule             VARCHAR2(3);\n        v_po_corp_schedule              VARCHAR2(3);\n        v_inventory_schedule            VARCHAR2(3);\n\n\n        int_delete_counter              PLS_INTEGER := 0;\n\n\n\n\nBEGIN\n\n    \n    dbms_output.put_line(' ');\n    v_prcs_stp := 'Populating forward buy values from the de459e2fe7f96e4d958537b31b946b26.02e9d63d10f9b42832e13b830a66cb4e table';\n    dbms_output.put_line(TO_CHAR(SYSDATE,'YYYY-MM-DD HH24:MI:SS     ')||v_prcs_stp);\n\n       SELECT param_code\n       INTO v_gain_end_days\n       FROM de459e2fe7f96e4d958537b31b946b26.de40ae7be8b2eb3858d46af8d107f3db\n       WHERE app_name = 'FORWARD_BUY'\n       AND param_type = 'GAIN_END_DAYS';\n\n\n       SELECT param_code\n       INTO v_reval_ship_dt_null_days\n       FROM de459e2fe7f96e4d958537b31b946b26.de40ae7be8b2eb3858d46af8d107f3db\n       WHERE app_name = 'FORWARD_BUY'\n       AND param_type = 'REVAL_SHIP_DT_NULL_DAYS';\n\n       SELECT param_code\n       INTO v_reval_po_lbound_days\n       FROM de459e2fe7f96e4d958537b31b946b26.de40ae7be8b2eb3858d46af8d107f3db\n       WHERE app_name = 'FORWARD_BUY'\n       AND param_type = 'REVAL_PO_LBOUND_DAYS';\n\n       SELECT param_code\n       INTO v_opo_corp_schedule\n       FROM de459e2fe7f96e4d958537b31b946b26.de40ae7be8b2eb3858d46af8d107f3db\n       WHERE app_name = 'FORWARD_BUY'\n       AND param_type = 'OPO_CORP_SCHEDULE';\n\n\n       SELECT param_code\n       INTO v_po_corp_schedule\n       FROM de459e2fe7f96e4d958537b31b946b26.de40ae7be8b2eb3858d46af8d107f3db\n       WHERE app_name = 'FORWARD_BUY'\n       AND param_type = 'PO_CORP_SCHEDULE';\n\n\n       SELECT param_code\n       INTO v_inventory_schedule\n       FROM de459e2fe7f96e4d958537b31b946b26.de40ae7be8b2eb3858d46af8d107f3db\n       WHERE app_name = 'FORWARD_BUY'\n       AND param_type = 'INVENTORY_SCHEDULE';\n\n\n\n\n\n    \n\n    v_prcs_stp := 'Merging new RECEIVED POs into 0e03d5c46556a742ba46252698396ef2.003af8b8e66651eda0b8717c40420b54';\n    dbms_output.put_line(TO_CHAR(SYSDATE,'YYYY-MM-DD HH24:MI:SS     ')||v_prcs_stp);\n\n         MERGE INTO de459e2fe7f96e4d958537b31b946b26.b6f8651287e7789be91157a4c0e5d70e d\n          USING\n          (\n\n                  SELECT\n                       9286383e21f04b9584c1bc569a201731.839c4ffb4bfaae1bb58eab4dee67d96a,\n                       9286383e21f04b9584c1bc569a201731.75274b7e794ec4ac03e63646e000c70b,\n                       9286383e21f04b9584c1bc569a201731.6bd6b7c188fef616b113c81245338906,\n                       9286383e21f04b9584c1bc569a201731.2d45d761eb8d137835bca7a23010fab4,\n                       9286383e21f04b9584c1bc569a201731.0e55e137a02bb10fcd61e2ad9262eeee,\n                       9286383e21f04b9584c1bc569a201731.f5dd4374a3e3af6a775cb6d6b22e8162,\n                       5d86c9c9e7af657a4afe7a827c8431eb.1d3f35cf8fe3d610d6c6d6282b3298f4,\n                       5d86c9c9e7af657a4afe7a827c8431eb.797aa00fde2c4463b39b877aaafc02c4,\n                       e472b097974b0d6a9a7d2ed170324906.d3268eabc4a7d98105fd85f9c9e62cd6e32ad436514bbe822b33de8bead744f3,\n                       e472b097974b0d6a9a7d2ed170324906.4b398d884e397727aeb50b1bf2299e607e8fe841f8abc0a126967273be28f1b7,\n                       9286383e21f04b9584c1bc569a201731.9510796389298dfcc6b62ae39759608b,\n                       9286383e21f04b9584c1bc569a201731.ce5f82a5e75938dfa35b47989ed3591a,\n                       'PO_CORP' fwb_trans_typ,\n                       v_odate fwb_last_updt_dt,\n                       null inact_dt,\n\n                       TO_NUMBER(TO_CHAR (SYSDATE, 'yyyymmddhh24miss')) ldr_tm,\n                       nvl(9286383e21f04b9584c1bc569a201731.e08d762984b4958fe98ced8ee3e72aba,0) cnfrm_qty_ord,\n\n                       CASE\n                          WHEN (     9286383e21f04b9584c1bc569a201731.9510796389298dfcc6b62ae39759608b='Y'\n                                 AND 9286383e21f04b9584c1bc569a201731.872249fd0d21ce7c8fcb16b448de685a <= 5d86c9c9e7af657a4afe7a827c8431eb.b0f4e0a0a955a0169ea36eacbc9e68ac \n                                )\n                             THEN 'Y'\n                          ELSE 'N'\n                       END PO_CNFRM_ON_TM,\n\n\n                       CASE\n                          WHEN 9286383e21f04b9584c1bc569a201731.9510796389298dfcc6b62ae39759608b='Y' AND 9286383e21f04b9584c1bc569a201731.ce5f82a5e75938dfa35b47989ed3591a <= 5d86c9c9e7af657a4afe7a827c8431eb.0685b12c23282c6454f5cc4153051bbb1d731bbdc4e3fb69a854112d4982eb99\n                             THEN\n                                CASE WHEN\n                                        CASE\n                                          WHEN 5d86c9c9e7af657a4afe7a827c8431eb.70e1c5a02e931a9432af1b4b607d2d39 ='ORDER DATE'\n                                             THEN 9286383e21f04b9584c1bc569a201731.d07269fd715528545216b1ab9353756e\n                                          WHEN ( 5d86c9c9e7af657a4afe7a827c8431eb.70e1c5a02e931a9432af1b4b607d2d39 ='REQUESTED DELIVERY DATE' OR 5d86c9c9e7af657a4afe7a827c8431eb.70e1c5a02e931a9432af1b4b607d2d39='SCHEDULED DELIVERY DATE')\n                                             THEN 9286383e21f04b9584c1bc569a201731.ce5f82a5e75938dfa35b47989ed3591a\n                                          WHEN 5d86c9c9e7af657a4afe7a827c8431eb.70e1c5a02e931a9432af1b4b607d2d39 ='SHIP DATE'\n                                             THEN NVL(9286383e21f04b9584c1bc569a201731.42c0b18f63bab531d16dabbe001c662d, NVL(9286383e21f04b9584c1bc569a201731.75274b7e794ec4ac03e63646e000c70b, 9286383e21f04b9584c1bc569a201731.d07269fd715528545216b1ab9353756e + v_reval_ship_dt_null_days))\n                                        END\n                                        >= 5d86c9c9e7af657a4afe7a827c8431eb.38b0e9c1848b4ea5bf4b37f9d9d62b4f\n                                     THEN 'COMPLETE'\n                                ELSE 'INCOMPLETE'\n                                END\n                          ELSE 'INCOMPLETE'\n                       END PO_STAT \n\n\n                     FROM   de459e2fe7f96e4d958537b31b946b26.3ac217a6e67d8f0b8bacb7eae897ec01 fwb\n\n                            JOIN de459e2fe7f96e4d958537b31b946b26.c437d55d53d88d02ce92bdadaefd8483 po\n                              ON 9286383e21f04b9584c1bc569a201731.839c4ffb4bfaae1bb58eab4dee67d96a=5d86c9c9e7af657a4afe7a827c8431eb.839c4ffb4bfaae1bb58eab4dee67d96a\n                             AND 9286383e21f04b9584c1bc569a201731.2d45d761eb8d137835bca7a23010fab4=5d86c9c9e7af657a4afe7a827c8431eb.2d45d761eb8d137835bca7a23010fab4\n                             AND 9286383e21f04b9584c1bc569a201731.26ac88e7ae671a1b22c14c2fce77aa2d='PR'\n                             AND NVL(9286383e21f04b9584c1bc569a201731.050e954632ba230c235148d0012dc5d7, 'N') = 'N'\n                             AND NVL(9286383e21f04b9584c1bc569a201731.923b0442356c6a25be14424ce1019980, 'N') = 'N'\n\n                            JOIN de459e2fe7f96e4d958537b31b946b26.c50b6339218f0dbbd97ce6557f2b051f p\n                              ON e472b097974b0d6a9a7d2ed170324906.839c4ffb4bfaae1bb58eab4dee67d96a=9286383e21f04b9584c1bc569a201731.839c4ffb4bfaae1bb58eab4dee67d96a\n                             AND e472b097974b0d6a9a7d2ed170324906.839c4ffb4bfaae1bb58eab4dee67d96a=5d86c9c9e7af657a4afe7a827c8431eb.839c4ffb4bfaae1bb58eab4dee67d96a\n                             AND e472b097974b0d6a9a7d2ed170324906.2d45d761eb8d137835bca7a23010fab4=5d86c9c9e7af657a4afe7a827c8431eb.2d45d761eb8d137835bca7a23010fab4\n                             AND fe1273d196c209677ff154534715415c.9115589ec3175cfd4a6812072377449f=09b293b7a02919e49bef87f52ba83107.9115589ec3175cfd4a6812072377449f\n\n                     WHERE\n                            NVL(5d86c9c9e7af657a4afe7a827c8431eb.c268e49ad49183f154b1ef1ec3d2f7c9, 'N') = 'N'\n                        AND NVL(5d86c9c9e7af657a4afe7a827c8431eb.5876993502d1c980263ca75dd0bafd7ade922b42cda877bb335f20b7c10e0802, 'N') = 'N'\n                        AND 5d86c9c9e7af657a4afe7a827c8431eb.3ad9e70cf16862b1ecd4e1a0ecde3783 IS NULL\n\n                        AND 9286383e21f04b9584c1bc569a201731.839c4ffb4bfaae1bb58eab4dee67d96a IN (SELECT a8b084beee2f471520333b3b2e79c7fc.839c4ffb4bfaae1bb58eab4dee67d96a\n                                           FROM de459e2fe7f96e4d958537b31b946b26.0b3320d3f985cd20d1ec65d9dfeed2de fstat\n                                           WHERE a8b084beee2f471520333b3b2e79c7fc.2035d739dc489843c15afb7ce4647338 > 0\n                                             AND a8b084beee2f471520333b3b2e79c7fc.e0b90cffaad9c3cb9c25d00826e70aac = 'PO_CORP'\n                                             AND a8b084beee2f471520333b3b2e79c7fc.b90da9a94c2b509f039383aa5f9015bc = 'RG'\n                                           )\n\n                        AND 6f1eeb8470ea8d06605232caaf9959be.f5dd4374a3e3af6a775cb6d6b22e8162 > (v_odate - v_reval_po_lbound_days)  \n                        AND 5d86c9c9e7af657a4afe7a827c8431eb.223b465d99ce0b2ddf59cb7c68e88cf6 = 'MONTHLY'   \n\n                        AND \n                        (\n                            CASE\n                              WHEN 5d86c9c9e7af657a4afe7a827c8431eb.70e1c5a02e931a9432af1b4b607d2d39 ='ORDER DATE'\n                                 THEN 6f1eeb8470ea8d06605232caaf9959be.d07269fd715528545216b1ab9353756e\n                              WHEN (5d86c9c9e7af657a4afe7a827c8431eb.70e1c5a02e931a9432af1b4b607d2d39 ='REQUESTED DELIVERY DATE' OR 5d86c9c9e7af657a4afe7a827c8431eb.70e1c5a02e931a9432af1b4b607d2d39='SCHEDULED DELIVERY DATE')\n                                 THEN 6f1eeb8470ea8d06605232caaf9959be.ce5f82a5e75938dfa35b47989ed3591a\n                              WHEN 5d86c9c9e7af657a4afe7a827c8431eb.70e1c5a02e931a9432af1b4b607d2d39 ='SHIP DATE'\n                                 THEN NVL(6f1eeb8470ea8d06605232caaf9959be.42c0b18f63bab531d16dabbe001c662d, NVL(6f1eeb8470ea8d06605232caaf9959be.75274b7e794ec4ac03e63646e000c70b, 6f1eeb8470ea8d06605232caaf9959be.d07269fd715528545216b1ab9353756e + v_reval_ship_dt_null_days))\n                            END\n                                >= 5d86c9c9e7af657a4afe7a827c8431eb.38b0e9c1848b4ea5bf4b37f9d9d62b4f\n                        )\n        ) s\n\n\n        on (        fce896ca0fbbf5a5d330f2803036eb44.839c4ffb4bfaae1bb58eab4dee67d96a = e9a95106e01380a7834d36560e919770.839c4ffb4bfaae1bb58eab4dee67d96a\n                and fce896ca0fbbf5a5d330f2803036eb44.2d45d761eb8d137835bca7a23010fab4 = e9a95106e01380a7834d36560e919770.2d45d761eb8d137835bca7a23010fab4\n                and fce896ca0fbbf5a5d330f2803036eb44.6bd6b7c188fef616b113c81245338906 = e9a95106e01380a7834d36560e919770.6bd6b7c188fef616b113c81245338906\n                and fce896ca0fbbf5a5d330f2803036eb44.75274b7e794ec4ac03e63646e000c70b = e9a95106e01380a7834d36560e919770.75274b7e794ec4ac03e63646e000c70b\n                and fce896ca0fbbf5a5d330f2803036eb44.0e55e137a02bb10fcd61e2ad9262eeee = e9a95106e01380a7834d36560e919770.0e55e137a02bb10fcd61e2ad9262eeee\n                and fce896ca0fbbf5a5d330f2803036eb44.f5dd4374a3e3af6a775cb6d6b22e8162 = e9a95106e01380a7834d36560e919770.f5dd4374a3e3af6a775cb6d6b22e8162\n                and fce896ca0fbbf5a5d330f2803036eb44.1d3f35cf8fe3d610d6c6d6282b3298f4 = e9a95106e01380a7834d36560e919770.1d3f35cf8fe3d610d6c6d6282b3298f4\n            )\n\n         WHEN MATCHED THEN UPDATE SET\n                                 fce896ca0fbbf5a5d330f2803036eb44.797aa00fde2c4463b39b877aaafc02c4=e9a95106e01380a7834d36560e919770.797aa00fde2c4463b39b877aaafc02c4,\n                                 fce896ca0fbbf5a5d330f2803036eb44.d3268eabc4a7d98105fd85f9c9e62cd6e32ad436514bbe822b33de8bead744f3=e9a95106e01380a7834d36560e919770.d3268eabc4a7d98105fd85f9c9e62cd6e32ad436514bbe822b33de8bead744f3,\n                                 fce896ca0fbbf5a5d330f2803036eb44.4b398d884e397727aeb50b1bf2299e607e8fe841f8abc0a126967273be28f1b7=e9a95106e01380a7834d36560e919770.4b398d884e397727aeb50b1bf2299e607e8fe841f8abc0a126967273be28f1b7,\n                                 fce896ca0fbbf5a5d330f2803036eb44.721a8ad171b31ae60261431ccd51b52d=e9a95106e01380a7834d36560e919770.721a8ad171b31ae60261431ccd51b52d\n\n         WHEN NOT MATCHED THEN INSERT\n                                ( div_nbr,\n                                  po_rcvd_dt,\n                                  po_nbr,\n                                  prod_nbr,\n                                  line_nbr,\n                                  prcs_dt,\n                                  fwb_cyc_id,\n                                  eff_dt,\n                                  pim_usf_std_prod_cd,\n                                  prch_from_vndr_nbr,\n                                  po_cnfrm_ind,\n                                  arvl_dt,\n                                  po_cnfrm_on_tm,\n                                  cnfrm_qty_ord,\n                                  fwb_trans_typ,\n                                  fwb_last_updt_dt,\n                                  po_stat,\n                                  inact_dt,\n                                  ldr_tm\n                                )\n\n                                values\n                                (\n                                        e9a95106e01380a7834d36560e919770.839c4ffb4bfaae1bb58eab4dee67d96a,\n                                        e9a95106e01380a7834d36560e919770.75274b7e794ec4ac03e63646e000c70b,\n                                        e9a95106e01380a7834d36560e919770.6bd6b7c188fef616b113c81245338906,\n                                        e9a95106e01380a7834d36560e919770.2d45d761eb8d137835bca7a23010fab4,\n                                        e9a95106e01380a7834d36560e919770.0e55e137a02bb10fcd61e2ad9262eeee,\n                                        e9a95106e01380a7834d36560e919770.f5dd4374a3e3af6a775cb6d6b22e8162,\n                                        e9a95106e01380a7834d36560e919770.1d3f35cf8fe3d610d6c6d6282b3298f4,\n                                        e9a95106e01380a7834d36560e919770.797aa00fde2c4463b39b877aaafc02c4,\n                                        e9a95106e01380a7834d36560e919770.d3268eabc4a7d98105fd85f9c9e62cd6e32ad436514bbe822b33de8bead744f3,\n                                        e9a95106e01380a7834d36560e919770.4b398d884e397727aeb50b1bf2299e607e8fe841f8abc0a126967273be28f1b7,\n                                        e9a95106e01380a7834d36560e919770.9510796389298dfcc6b62ae39759608b,\n                                        e9a95106e01380a7834d36560e919770.ce5f82a5e75938dfa35b47989ed3591a,\n                                        e9a95106e01380a7834d36560e919770.ebc0eb2fb6cae4576182f60543ae6b81,\n                                        e9a95106e01380a7834d36560e919770.e08d762984b4958fe98ced8ee3e72aba,\n                                        e9a95106e01380a7834d36560e919770.973be3d7016c197bb40ff85635227e9c,\n                                        e9a95106e01380a7834d36560e919770.ac509ef677b8bd5eb1dc623b4125a53de32f6dd38f333cde68119d1f277367cd,\n                                        e9a95106e01380a7834d36560e919770.a092beea83145614a13636d6603bbdd0,\n                                        e9a95106e01380a7834d36560e919770.3ad9e70cf16862b1ecd4e1a0ecde3783,\n                                        e9a95106e01380a7834d36560e919770.721a8ad171b31ae60261431ccd51b52d\n                                );\n\n             dbms_output.put_line(TO_CHAR(SYSDATE,'YYYY-MM-DD HH24:MI:SS     ')||'     Merge complete. ' || sql%ROWCOUNT || '  rows merged.');\n\n\n    \n        \n\n\n\n    \n        v_prcs_stp := 'Checking Open PO Status';\n        dbms_output.put_line(TO_CHAR(SYSDATE,'YYYY-MM-DD HH24:MI:SS     ')||v_prcs_stp);\n\n        \n        SELECT div_load_stat\n          INTO v_opo_corp_stat\n          FROM de459e2fe7f96e4d958537b31b946b26.0b3320d3f985cd20d1ec65d9dfeed2de\n         WHERE fact_table = 'OPO_CORP'\n           AND ROWNUM = 1\n           AND TRUNC(latest_prcs_dt) = CASE\n                                          WHEN v_opo_corp_schedule = '1-7'\n                                             THEN v_odate\n                                          WHEN v_opo_corp_schedule = '1-6'\n                                             THEN CASE WHEN TO_CHAR(v_odate,'D') = 7 THEN v_odate - 1\n                                                  ELSE v_odate END\n                                          WHEN v_opo_corp_schedule = '2-6'\n                                             THEN CASE WHEN TO_CHAR(v_odate,'D') = 6 THEN v_odate - 1\n                                                       WHEN TO_CHAR(v_odate,'D') = 7 THEN v_odate - 2\n                                                  ELSE v_odate END\n                                       ELSE v_odate\n                                       END;\n\n        \n\n        dbms_output.put_line(TO_CHAR(SYSDATE,'YYYY-MM-DD HH24:MI:SS     ')||'     Open PO status is '||v_opo_corp_stat);\n\n\n\n\n          IF  v_opo_corp_stat > 0 THEN\n\n                      \n                      v_prcs_stp := 'Deleting INCOMPLETEs from 0e03d5c46556a742ba46252698396ef2.003af8b8e66651eda0b8717c40420b54';\n                      dbms_output.put_line(TO_CHAR(SYSDATE,'YYYY-MM-DD HH24:MI:SS     ')||v_prcs_stp);\n\n\n\n                      \n\n                     DELETE FROM de459e2fe7f96e4d958537b31b946b26.b6f8651287e7789be91157a4c0e5d70e b\n                     WHERE (6d9b37be5a083f8b78d676aba846c823.a092beea83145614a13636d6603bbdd0 <> 'COMPLETE' OR 6d9b37be5a083f8b78d676aba846c823.ebc0eb2fb6cae4576182f60543ae6b81 <> 'Y')\n                           AND 6d9b37be5a083f8b78d676aba846c823.973be3d7016c197bb40ff85635227e9c = 'OPO_CORP'\n                           AND EXISTS  (SELECT 1\n                                            FROM de459e2fe7f96e4d958537b31b946b26.3ac217a6e67d8f0b8bacb7eae897ec01 fwb\n                                           WHERE de459e2fe7f96e4d958537b31b946b26.3ac217a6e67d8f0b8bacb7eae897ec01.797aa00fde2c4463b39b877aaafc02c4 = 6d9b37be5a083f8b78d676aba846c823.797aa00fde2c4463b39b877aaafc02c4\n                                             AND de459e2fe7f96e4d958537b31b946b26.3ac217a6e67d8f0b8bacb7eae897ec01.839c4ffb4bfaae1bb58eab4dee67d96a = 6d9b37be5a083f8b78d676aba846c823.839c4ffb4bfaae1bb58eab4dee67d96a\n                                             AND de459e2fe7f96e4d958537b31b946b26.3ac217a6e67d8f0b8bacb7eae897ec01.2d45d761eb8d137835bca7a23010fab4= 6d9b37be5a083f8b78d676aba846c823.2d45d761eb8d137835bca7a23010fab4\n                                             AND de459e2fe7f96e4d958537b31b946b26.3ac217a6e67d8f0b8bacb7eae897ec01.1d3f35cf8fe3d610d6c6d6282b3298f4 = 6d9b37be5a083f8b78d676aba846c823.1d3f35cf8fe3d610d6c6d6282b3298f4\n                                             AND de459e2fe7f96e4d958537b31b946b26.3ac217a6e67d8f0b8bacb7eae897ec01.6caa07324d63f0b538b7b28b47a1f933e32f6dd38f333cde68119d1f277367cd >= v_odate\n                                             AND de459e2fe7f96e4d958537b31b946b26.3ac217a6e67d8f0b8bacb7eae897ec01.223b465d99ce0b2ddf59cb7c68e88cf6 = 'MONTHLY'\n                                          );\n\n                      dbms_output.put_line(TO_CHAR(SYSDATE,'YYYY-MM-DD HH24:MI:SS     ')||'     Deletion complete. ' || sql%ROWCOUNT || '  rows deleted.');\n\n\n\n\n                      \n                      v_prcs_stp := 'Inserting new Open POs into 0e03d5c46556a742ba46252698396ef2.003af8b8e66651eda0b8717c40420b54';\n                      dbms_output.put_line(TO_CHAR(SYSDATE,'YYYY-MM-DD HH24:MI:SS     ')||v_prcs_stp);\n\n                      INSERT INTO de459e2fe7f96e4d958537b31b946b26.b6f8651287e7789be91157a4c0e5d70e\n\n                      SELECT\n                       de459e2fe7f96e4d958537b31b946b26.012d9ba8d175e62146e8b58cab6bff27.839c4ffb4bfaae1bb58eab4dee67d96a,\n                       TO_DATE('01-01-1900','DD-MM-YYYY') po_rcvd_dt, \n                       de459e2fe7f96e4d958537b31b946b26.012d9ba8d175e62146e8b58cab6bff27.6bd6b7c188fef616b113c81245338906,\n                       de459e2fe7f96e4d958537b31b946b26.012d9ba8d175e62146e8b58cab6bff27.2d45d761eb8d137835bca7a23010fab4,\n                       de459e2fe7f96e4d958537b31b946b26.012d9ba8d175e62146e8b58cab6bff27.0e55e137a02bb10fcd61e2ad9262eeee,\n                       de459e2fe7f96e4d958537b31b946b26.012d9ba8d175e62146e8b58cab6bff27.f5dd4374a3e3af6a775cb6d6b22e8162,\n                       aaaa197c8a04b78be299c4e8679a5a84.1d3f35cf8fe3d610d6c6d6282b3298f4,\n                       aaaa197c8a04b78be299c4e8679a5a84.797aa00fde2c4463b39b877aaafc02c4,\n                       de459e2fe7f96e4d958537b31b946b26.c50b6339218f0dbbd97ce6557f2b051f.d3268eabc4a7d98105fd85f9c9e62cd6e32ad436514bbe822b33de8bead744f3,\n                       de459e2fe7f96e4d958537b31b946b26.c50b6339218f0dbbd97ce6557f2b051f.4b398d884e397727aeb50b1bf2299e607e8fe841f8abc0a126967273be28f1b7,\n                       de459e2fe7f96e4d958537b31b946b26.012d9ba8d175e62146e8b58cab6bff27.9510796389298dfcc6b62ae39759608b,\n                       de459e2fe7f96e4d958537b31b946b26.012d9ba8d175e62146e8b58cab6bff27.ce5f82a5e75938dfa35b47989ed3591a,\n\n                      CASE\n                          WHEN (      de459e2fe7f96e4d958537b31b946b26.012d9ba8d175e62146e8b58cab6bff27.9510796389298dfcc6b62ae39759608b='Y'\n                                  AND de459e2fe7f96e4d958537b31b946b26.012d9ba8d175e62146e8b58cab6bff27.872249fd0d21ce7c8fcb16b448de685a <= aaaa197c8a04b78be299c4e8679a5a84.6caa07324d63f0b538b7b28b47a1f933e32f6dd38f333cde68119d1f277367cd\n                                )\n                                  THEN 'Y'\n                          ELSE 'N'\n                       END po_cnfrm_on_tm, \n\n\n\n                       nvl(e9e4e236680089f6bdfb406badeee242.e08d762984b4958fe98ced8ee3e72aba,0) cnfrm_qty_ord,\n                       'OPO_CORP' fwb_trans_typ,\n                       v_odate fwb_last_updt_dt,\n\n\n                       CASE\n                          WHEN de459e2fe7f96e4d958537b31b946b26.012d9ba8d175e62146e8b58cab6bff27.9510796389298dfcc6b62ae39759608b='Y' AND de459e2fe7f96e4d958537b31b946b26.012d9ba8d175e62146e8b58cab6bff27.ce5f82a5e75938dfa35b47989ed3591a <= aaaa197c8a04b78be299c4e8679a5a84.0685b12c23282c6454f5cc4153051bbb1d731bbdc4e3fb69a854112d4982eb99\n                             THEN\n                                CASE WHEN\n                                        CASE\n                                          WHEN aaaa197c8a04b78be299c4e8679a5a84.70e1c5a02e931a9432af1b4b607d2d39 ='ORDER DATE'\n                                             THEN de459e2fe7f96e4d958537b31b946b26.012d9ba8d175e62146e8b58cab6bff27.d07269fd715528545216b1ab9353756e\n                                          WHEN ( aaaa197c8a04b78be299c4e8679a5a84.70e1c5a02e931a9432af1b4b607d2d39 ='REQUESTED DELIVERY DATE' OR aaaa197c8a04b78be299c4e8679a5a84.70e1c5a02e931a9432af1b4b607d2d39='SCHEDULED DELIVERY DATE')\n                                             THEN de459e2fe7f96e4d958537b31b946b26.012d9ba8d175e62146e8b58cab6bff27.ce5f82a5e75938dfa35b47989ed3591a\n                                          WHEN aaaa197c8a04b78be299c4e8679a5a84.70e1c5a02e931a9432af1b4b607d2d39 ='SHIP DATE'\n                                             THEN NVL(de459e2fe7f96e4d958537b31b946b26.012d9ba8d175e62146e8b58cab6bff27.42c0b18f63bab531d16dabbe001c662d, de459e2fe7f96e4d958537b31b946b26.012d9ba8d175e62146e8b58cab6bff27.d07269fd715528545216b1ab9353756e + v_reval_ship_dt_null_days)\n                                        END\n                                        >= aaaa197c8a04b78be299c4e8679a5a84.38b0e9c1848b4ea5bf4b37f9d9d62b4f\n                                     THEN 'COMPLETE'\n                                ELSE 'INCOMPLETE'\n                                END\n                          ELSE 'INCOMPLETE'\n                       END PO_STAT, \n\n                       null inact_dt,\n                       TO_NUMBER(TO_CHAR (SYSDATE, 'yyyymmddhh24miss')) ldr_trm,\n                       NULL, \n                       NULL, \n                       NULL \n\n                     FROM   de459e2fe7f96e4d958537b31b946b26.3ac217a6e67d8f0b8bacb7eae897ec01 fwb\n                            JOIN de459e2fe7f96e4d958537b31b946b26.012d9ba8d175e62146e8b58cab6bff27 opo\n                              ON de459e2fe7f96e4d958537b31b946b26.012d9ba8d175e62146e8b58cab6bff27.839c4ffb4bfaae1bb58eab4dee67d96a=aaaa197c8a04b78be299c4e8679a5a84.839c4ffb4bfaae1bb58eab4dee67d96a\n                             AND de459e2fe7f96e4d958537b31b946b26.012d9ba8d175e62146e8b58cab6bff27.2d45d761eb8d137835bca7a23010fab4=aaaa197c8a04b78be299c4e8679a5a84.2d45d761eb8d137835bca7a23010fab4\n                             AND NVL(de459e2fe7f96e4d958537b31b946b26.012d9ba8d175e62146e8b58cab6bff27.050e954632ba230c235148d0012dc5d7, 'N') = 'N'\n                             AND NVL(de459e2fe7f96e4d958537b31b946b26.012d9ba8d175e62146e8b58cab6bff27.923b0442356c6a25be14424ce1019980, 'N') = 'N'\n\n                            JOIN de459e2fe7f96e4d958537b31b946b26.c50b6339218f0dbbd97ce6557f2b051f p\n                              ON de459e2fe7f96e4d958537b31b946b26.c50b6339218f0dbbd97ce6557f2b051f.839c4ffb4bfaae1bb58eab4dee67d96a=de459e2fe7f96e4d958537b31b946b26.012d9ba8d175e62146e8b58cab6bff27.839c4ffb4bfaae1bb58eab4dee67d96a\n                             AND de459e2fe7f96e4d958537b31b946b26.c50b6339218f0dbbd97ce6557f2b051f.839c4ffb4bfaae1bb58eab4dee67d96a=aaaa197c8a04b78be299c4e8679a5a84.839c4ffb4bfaae1bb58eab4dee67d96a\n                             AND de459e2fe7f96e4d958537b31b946b26.c50b6339218f0dbbd97ce6557f2b051f.2d45d761eb8d137835bca7a23010fab4=aaaa197c8a04b78be299c4e8679a5a84.2d45d761eb8d137835bca7a23010fab4\n                             AND de459e2fe7f96e4d958537b31b946b26.c50b6339218f0dbbd97ce6557f2b051f.2d45d761eb8d137835bca7a23010fab4=de459e2fe7f96e4d958537b31b946b26.012d9ba8d175e62146e8b58cab6bff27.2d45d761eb8d137835bca7a23010fab4\n\n                     WHERE aaaa197c8a04b78be299c4e8679a5a84.223b465d99ce0b2ddf59cb7c68e88cf6 IN ('MONTHLY', 'DEALS')\n                      AND NVL(aaaa197c8a04b78be299c4e8679a5a84.b6a6ef53e1a4aaad28e23468251a5a75e32f6dd38f333cde68119d1f277367cd, 'NO PO') <> 'COMPLETE'\n                      AND NVL(aaaa197c8a04b78be299c4e8679a5a84.5876993502d1c980263ca75dd0bafd7ade922b42cda877bb335f20b7c10e0802, 'N') = 'N'\n                      AND NVL(aaaa197c8a04b78be299c4e8679a5a84.c268e49ad49183f154b1ef1ec3d2f7c9, 'N') = 'N'\n                      AND aaaa197c8a04b78be299c4e8679a5a84.3ad9e70cf16862b1ecd4e1a0ecde3783 IS NULL\n                      AND aaaa197c8a04b78be299c4e8679a5a84.6caa07324d63f0b538b7b28b47a1f933e32f6dd38f333cde68119d1f277367cd >= v_odate \n\n                      AND NOT EXISTS (SELECT 1\n                                        FROM de459e2fe7f96e4d958537b31b946b26.b6f8651287e7789be91157a4c0e5d70e completed\n                                       WHERE 1a27a5cd35501ae5304e6b2970918c57.839c4ffb4bfaae1bb58eab4dee67d96a = aaaa197c8a04b78be299c4e8679a5a84.839c4ffb4bfaae1bb58eab4dee67d96a\n                                         AND 1a27a5cd35501ae5304e6b2970918c57.2d45d761eb8d137835bca7a23010fab4 = aaaa197c8a04b78be299c4e8679a5a84.2d45d761eb8d137835bca7a23010fab4\n                                         AND 56f1ec1f28e908d7175df246a8772231.7ee034abb7795b53a78b4666beac3a56 = aaaa197c8a04b78be299c4e8679a5a84.7ee034abb7795b53a78b4666beac3a56\n                                         AND 1a27a5cd35501ae5304e6b2970918c57.1d3f35cf8fe3d610d6c6d6282b3298f4=aaaa197c8a04b78be299c4e8679a5a84.1d3f35cf8fe3d610d6c6d6282b3298f4 \n                                         AND 1a27a5cd35501ae5304e6b2970918c57.973be3d7016c197bb40ff85635227e9c = 'PO_CORP'\n                                     )\n\n                      AND\n                      (    de459e2fe7f96e4d958537b31b946b26.012d9ba8d175e62146e8b58cab6bff27.d07269fd715528545216b1ab9353756e BETWEEN aaaa197c8a04b78be299c4e8679a5a84.38b0e9c1848b4ea5bf4b37f9d9d62b4f AND aaaa197c8a04b78be299c4e8679a5a84.6caa07324d63f0b538b7b28b47a1f933e32f6dd38f333cde68119d1f277367cd \n                        OR\n                            (\n                                  (aaaa197c8a04b78be299c4e8679a5a84.70e1c5a02e931a9432af1b4b607d2d39 ='REQUESTED DELIVERY DATE' OR aaaa197c8a04b78be299c4e8679a5a84.70e1c5a02e931a9432af1b4b607d2d39='SCHEDULED DELIVERY DATE')\n                              AND de459e2fe7f96e4d958537b31b946b26.012d9ba8d175e62146e8b58cab6bff27.ce5f82a5e75938dfa35b47989ed3591a >= aaaa197c8a04b78be299c4e8679a5a84.38b0e9c1848b4ea5bf4b37f9d9d62b4f\n                            )\n                        OR\n                            (      aaaa197c8a04b78be299c4e8679a5a84.70e1c5a02e931a9432af1b4b607d2d39 ='SHIP DATE'\n                              AND NVL(de459e2fe7f96e4d958537b31b946b26.012d9ba8d175e62146e8b58cab6bff27.42c0b18f63bab531d16dabbe001c662d, (de459e2fe7f96e4d958537b31b946b26.012d9ba8d175e62146e8b58cab6bff27.d07269fd715528545216b1ab9353756e + v_reval_ship_dt_null_days)) >= aaaa197c8a04b78be299c4e8679a5a84.38b0e9c1848b4ea5bf4b37f9d9d62b4f\n                            )\n                      ) \n\n                      ;\n\n                      dbms_output.put_line(TO_CHAR(SYSDATE,'YYYY-MM-DD HH24:MI:SS     ')||'     Insert complete. ' || sql%ROWCOUNT || '  rows inserted.');\n\n\n          ELSIF p_abort_flg = 'Y' THEN\n               \n               RAISE opo_no_rows;\n               ROLLBACK;\n               RETURN 1;\n\n          ELSIF p_abort_flg = 'N' THEN\n               \n               NULL;\n          END IF;\n\n\n\n\n\n            \n\n                v_prcs_stp := 'DELETION of multiple completed cycles from 0e03d5c46556a742ba46252698396ef2.003af8b8e66651eda0b8717c40420b54';\n                dbms_output.put_line(TO_CHAR(SYSDATE,'YYYY-MM-DD HH24:MI:SS     ')||v_prcs_stp);\n\n                FOR c_bridge IN\n\n                (\n                SELECT de459e2fe7f96e4d958537b31b946b26.b6f8651287e7789be91157a4c0e5d70e.839c4ffb4bfaae1bb58eab4dee67d96a, de459e2fe7f96e4d958537b31b946b26.b6f8651287e7789be91157a4c0e5d70e.2d45d761eb8d137835bca7a23010fab4, de459e2fe7f96e4d958537b31b946b26.b6f8651287e7789be91157a4c0e5d70e.1d3f35cf8fe3d610d6c6d6282b3298f4\n                FROM de459e2fe7f96e4d958537b31b946b26.b6f8651287e7789be91157a4c0e5d70e fmb, de459e2fe7f96e4d958537b31b946b26.3ac217a6e67d8f0b8bacb7eae897ec01 mdl\n                WHERE de459e2fe7f96e4d958537b31b946b26.b6f8651287e7789be91157a4c0e5d70e.797aa00fde2c4463b39b877aaafc02c4 = de459e2fe7f96e4d958537b31b946b26.3ac217a6e67d8f0b8bacb7eae897ec01.797aa00fde2c4463b39b877aaafc02c4\n                AND de459e2fe7f96e4d958537b31b946b26.b6f8651287e7789be91157a4c0e5d70e.839c4ffb4bfaae1bb58eab4dee67d96a = de459e2fe7f96e4d958537b31b946b26.3ac217a6e67d8f0b8bacb7eae897ec01.839c4ffb4bfaae1bb58eab4dee67d96a\n                AND de459e2fe7f96e4d958537b31b946b26.b6f8651287e7789be91157a4c0e5d70e.2d45d761eb8d137835bca7a23010fab4= de459e2fe7f96e4d958537b31b946b26.3ac217a6e67d8f0b8bacb7eae897ec01.2d45d761eb8d137835bca7a23010fab4\n                AND de459e2fe7f96e4d958537b31b946b26.b6f8651287e7789be91157a4c0e5d70e.1d3f35cf8fe3d610d6c6d6282b3298f4 = de459e2fe7f96e4d958537b31b946b26.3ac217a6e67d8f0b8bacb7eae897ec01.1d3f35cf8fe3d610d6c6d6282b3298f4\n                AND de459e2fe7f96e4d958537b31b946b26.3ac217a6e67d8f0b8bacb7eae897ec01.223b465d99ce0b2ddf59cb7c68e88cf6 IN ('MONTHLY', 'DEALS')\n                GROUP BY de459e2fe7f96e4d958537b31b946b26.b6f8651287e7789be91157a4c0e5d70e.839c4ffb4bfaae1bb58eab4dee67d96a, de459e2fe7f96e4d958537b31b946b26.b6f8651287e7789be91157a4c0e5d70e.2d45d761eb8d137835bca7a23010fab4, de459e2fe7f96e4d958537b31b946b26.b6f8651287e7789be91157a4c0e5d70e.1d3f35cf8fe3d610d6c6d6282b3298f4\n                HAVING SUM(CASE WHEN de459e2fe7f96e4d958537b31b946b26.b6f8651287e7789be91157a4c0e5d70e.a092beea83145614a13636d6603bbdd0 = 'COMPLETE' AND de459e2fe7f96e4d958537b31b946b26.b6f8651287e7789be91157a4c0e5d70e.ebc0eb2fb6cae4576182f60543ae6b81 ='Y' THEN 1 ELSE 0 END) > 0\n                 \n                )\n\n\n                LOOP\n                   v_prcs_stp := '     Deleting multiple COMPLETED for cycle: '||39bcd8a3cf4c6299907092eead388520.839c4ffb4bfaae1bb58eab4dee67d96a||', division: '||39bcd8a3cf4c6299907092eead388520.839c4ffb4bfaae1bb58eab4dee67d96a||', product: '||39bcd8a3cf4c6299907092eead388520.2d45d761eb8d137835bca7a23010fab4;\n                   \n\n\n                   DELETE\n                   FROM de459e2fe7f96e4d958537b31b946b26.b6f8651287e7789be91157a4c0e5d70e a\n                   WHERE 24934fba42408e39f74a76ffdec4e8fa.839c4ffb4bfaae1bb58eab4dee67d96a=39bcd8a3cf4c6299907092eead388520.839c4ffb4bfaae1bb58eab4dee67d96a\n                   AND 24934fba42408e39f74a76ffdec4e8fa.2d45d761eb8d137835bca7a23010fab4=39bcd8a3cf4c6299907092eead388520.2d45d761eb8d137835bca7a23010fab4\n                   AND 24934fba42408e39f74a76ffdec4e8fa.1d3f35cf8fe3d610d6c6d6282b3298f4=39bcd8a3cf4c6299907092eead388520.1d3f35cf8fe3d610d6c6d6282b3298f4\n                   AND rowid IN\n                   (\n                    SELECT rowid\n                      FROM\n                        (\n                        SELECT rowid,\n                               row_number() over (partition by div_nbr, prod_nbr, fwb_cyc_id order by fwb_trans_typ desc, po_stat, po_cnfrm_on_tm desc) rownumber\n                        FROM de459e2fe7f96e4d958537b31b946b26.b6f8651287e7789be91157a4c0e5d70e b\n                                WHERE de459e2fe7f96e4d958537b31b946b26.b6f8651287e7789be91157a4c0e5d70e.839c4ffb4bfaae1bb58eab4dee67d96a = 39bcd8a3cf4c6299907092eead388520.839c4ffb4bfaae1bb58eab4dee67d96a\n                                  AND de459e2fe7f96e4d958537b31b946b26.b6f8651287e7789be91157a4c0e5d70e.2d45d761eb8d137835bca7a23010fab4 = 39bcd8a3cf4c6299907092eead388520.2d45d761eb8d137835bca7a23010fab4\n                                  AND de459e2fe7f96e4d958537b31b946b26.b6f8651287e7789be91157a4c0e5d70e.1d3f35cf8fe3d610d6c6d6282b3298f4 = 39bcd8a3cf4c6299907092eead388520.1d3f35cf8fe3d610d6c6d6282b3298f4\n                        )\n                      where rownumber > 1\n                   );\n\n\n                   int_delete_counter := int_delete_counter + sql%ROWCOUNT;\n\n                END LOOP;\n\n\n                dbms_output.put_line(TO_CHAR(SYSDATE,'YYYY-MM-DD HH24:MI:SS     ')||'     Deletions complete. ' || int_delete_counter || '  rows deleted.');\n\n\n\n      COMMIT;\n      dbms_output.put_line(TO_CHAR(SYSDATE,'YYYY-MM-DD HH24:MI:SS     ')||'PROCESS COMMITED');\n      RETURN 0;\n\n\nEXCEPTION\n\nWHEN no_data_found THEN\n        dbms_output.put_line(TO_CHAR(SYSDATE,'YYYY-MM-DD HH24:MI:SS     ')||'*****NO DATA FOUND ERROR!*****');\n        dbms_output.put_line(TO_CHAR(SYSDATE,'YYYY-MM-DD HH24:MI:SS     ')||'ERROR IN STEP:  ' || v_prcs_stp);\n        v_prcs_err_msg:= ' SQLERRM: '||Sqlerrm||' Sqlcode: '||SQLCODE;\n        dbms_output.put_line(TO_CHAR(SYSDATE,'YYYY-MM-DD HH24:MI:SS     ')||'Messages: '||v_prcs_err_msg);\n        ROLLBACK;\n        Return 1;\n\n\nWHEN OTHERS THEN\n        dbms_output.put_line(TO_CHAR(SYSDATE,'YYYY-MM-DD HH24:MI:SS     ')||'*****GENERAL ERROR!*****');\n        dbms_output.put_line(TO_CHAR(SYSDATE,'YYYY-MM-DD HH24:MI:SS     ')||'ERROR IN STEP:  ' || v_prcs_stp);\n        v_prcs_err_msg:= ' SQLERRM: '||Sqlerrm||' Sqlcode: '||SQLCODE;\n        dbms_output.put_line(TO_CHAR(SYSDATE,'YYYY-MM-DD HH24:MI:SS     ')||'Messages: '||v_prcs_err_msg);\n        ROLLBACK;\n        RETURN 1;\nEND;\n/",
            "upstream_dependencies": [],
            "downstream_dependencies": [],
            "dag_location": "null",
            "gantt_location": "null",
            "created_at": "null",
            "updated_at": "null"
        },
        {
            "name": "FN_FWB_PURGE",
            "encrypted_name": "a93ba0884a2d1758654db9afe97084d3",
            "type": "function",
            "database": "null",
            "encrypted_database": "null",
            "schema": "XDMADM",
            "encrypted_schema": "0e03d5c46556a742ba46252698396ef2",
            "fully_qualified_name": "XDMADM.FN_FWB_PURGE",
            "encrypted_fqn": "0e03d5c46556a742ba46252698396ef2.a93ba0884a2d1758654db9afe97084d3",
            "synonyms": [],
            "metadata_analysis": "CREATE OR REPLACE FUNCTION \"0e03d5c46556a742ba46252698396ef2\".\"a93ba0884a2d1758654db9afe97084d3\"\n   (ODATE IN VARCHAR2)\n      RETURN NUMBER\n   AS\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n  CON_PROCESS_NAME  CONSTANT varchar2(40) := 'FN_FWB_PURGE';\n\n\n\n    V_SUNDAY                  VARCHAR2 (10):= 'SUNDAY';\n    V_FISC_YR_WK_MIN_20       VARCHAR2(10);\n    V_INV_PARTITION_NAME      VARCHAR2(100);\n    V_MDL_PARTITION_NAME      VARCHAR2(100);\n    V_BRIDGE_PARTITION_NAME   VARCHAR2(100);\n    V_PART_DT                 VARCHAR2(25);\n    V_INV_CODE                NUMBER;\n    V_MDL_CODE                NUMBER;\n    V_BRIDGE_CODE             NUMBER;\n    V_OUT_MSG                 VARCHAR2(255);\n    V_MINUS_140               DATE;\n    V_CLNDR_DT                DATE;\n    V_STRT_DT                 DATE;\n    V_END_DT                  DATE;\n    V_OPER_DT                 DATE := TO_DATE(ODATE,'YYYYMMDD');\n    V_SUBOBJECT_NAME          VARCHAR2(255);\n    V_SEVEN_DAYS              NUMBER:=7;\n    V_ONE_DAY                 NUMBER:=1;\n    V_140_DAYS                NUMBER:=140;\n    \n    \n    \n     V_OWNER                   VARCHAR2(40) := 'XDMADM' ;\n     V_FWB_TABLE_NAME          VARCHAR2(40) := 'FWB_MDL';\n     V_BRIDGE_TABLE_NAME       VARCHAR2(40) := 'FWB_MDL_BRIDGE';\n     V_INV_TABLE_NAME          VARCHAR2(40) := 'INVNTY_TRK_CORP_DLY';\n     V_TGT_TABLE_OWNER         VARCHAR2(30):='XDMADM';\n     V_TGT_TABLE_NAME          VARCHAR2(30):='ERROR_IN_TBL_NAME';\n\n\n\n\n   V_PRCS_NM            VARCHAR(100);\n   v_prcs_stp           varchar(125);\n   v_prcs_pram          varchar(100);\n   v_prcs_err_cd        varchar(200);\n   v_prcs_err_msg       varchar(200);\n\n\n\n   ALL_EXCEPTIONS       EXCEPTION;\n\n\n\n\n   BEGIN\n        V_PRCS_STP := 'Start Process '||CON_PROCESS_NAME;\n        DBMS_OUTPUT.PUT_LINE (V_PRCS_STP);\n        V_PRCS_STP := 'Start Time:'||TO_CHAR(SYSDATE,'YYYY-MM-DD HH24:MI:SS');\n        DBMS_OUTPUT.PUT_LINE (V_PRCS_STP);\n        V_PRCS_NM  := CON_PROCESS_NAME ;\n        DBMS_OUTPUT.PUT_LINE (V_PRCS_NM);\n        V_PRCS_PRAM:= '   ODATE = '||ODATE;\n        DBMS_OUTPUT.PUT_LINE (V_PRCS_PRAM);\n\n\n\n\n\n\n   V_MINUS_140 :=V_OPER_DT-V_140_DAYS;\n\n   V_PRCS_STP :='ODATE - 140 DAYS= '||V_MINUS_140;\n   DBMS_OUTPUT.PUT_LINE (V_PRCS_STP);\n\n    IF V_OPER_DT > SYSDATE THEN\n        V_PRCS_STP := 'Error: ODATE is greater than sysdate: '||V_OPER_DT;\n        DBMS_OUTPUT.PUT_LINE (V_PRCS_STP);\n        RETURN 1;\n     END IF;\n\n\n    SELECT FISC_YR_WK\n    INTO V_FISC_YR_WK_MIN_20\n    FROM 0e03d5c46556a742ba46252698396ef2.1609b28739e207519049a2cf090bfd19\n    WHERE CLNDR_DT=V_MINUS_140;\n\n    \n\n\n    SELECT CLNDR_DT\n    INTO V_CLNDR_DT\n    FROM 0e03d5c46556a742ba46252698396ef2.1609b28739e207519049a2cf090bfd19\n    WHERE FISC_YR_WK=V_FISC_YR_WK_MIN_20\n    AND FISC_DAY_NM=V_SUNDAY;\n\n    \n    \n\n    V_STRT_DT:=V_CLNDR_DT-V_SEVEN_DAYS;\n    \n\n    V_END_DT:=V_CLNDR_DT-V_ONE_DAY;\n\n    \n\n\n\n\n\n\n       V_PRCS_STP := 'Begin drop partition process ';\n        DBMS_OUTPUT.PUT_LINE (V_PRCS_STP);\n\n       \n     BEGIN\n        SELECT SUBOBJECT_NAME\n         INTO V_INV_PARTITION_NAME\n         FROM 0e03d5c46556a742ba46252698396ef2.02689ad9650ea6795990dfe9192e53f1cdc4c9c2344109b5eec03e92ba32688a M,\n          (SELECT DATA_OBJECT_ID, SUBOBJECT_NAME FROM ALL_OBJECTS\n            WHERE OWNER = V_OWNER AND\n                  OBJECT_NAME = V_INV_TABLE_NAME AND\n                  OBJECT_TYPE = 'TABLE PARTITION') PARTS\n            WHERE 0e03d5c46556a742ba46252698396ef2.02689ad9650ea6795990dfe9192e53f1cdc4c9c2344109b5eec03e92ba32688a.f904b8c873c74e95191a6893d2c3bdf0 BETWEEN V_STRT_DT AND V_END_DT\n            AND ROWNUM = 1\n            AND DATA_OBJECT_ID = DBMS_MVIEW.PMARKER(0e03d5c46556a742ba46252698396ef2.02689ad9650ea6795990dfe9192e53f1cdc4c9c2344109b5eec03e92ba32688a.4e293bb8123d167d419c2f932a359951);\n\n        v_prcs_stp := 'Dly Inv partition name dropped '||V_INV_PARTITION_NAME;\n        DBMS_OUTPUT.PUT_LINE (V_PRCS_STP);\n\n         \n\n\n       \n       V_INV_CODE:= 7540495dc7d95c8483c39c98db3db89c.72d996f41712e622935d17bc9cb23cfa.daf8cb22c40bc2001571d8d7a77005d9(V_OUT_MSG\n                                                    ,V_OWNER\n                                                    ,V_INV_TABLE_NAME\n                                                    ,V_INV_PARTITION_NAME);\n\n      \n      \n      \n\n     EXCEPTION\n     WHEN NO_DATA_FOUND THEN\n          V_PRCS_STP :='INV Partition not found, Do not fail ,SQLCODE:  ' || SQLCODE || ' , ' || SQLERRM;\n          DBMS_OUTPUT.PUT_LINE (V_PRCS_STP);\n     END;\n\n\n     BEGIN\n        \n         SELECT SUBOBJECT_NAME\n         INTO V_MDL_PARTITION_NAME\n         FROM 0e03d5c46556a742ba46252698396ef2.bafb9d68e2767872ac5c686049022ebd M,\n               (SELECT DATA_OBJECT_ID, SUBOBJECT_NAME FROM ALL_OBJECTS\n                WHERE OWNER = V_OWNER AND\n                      OBJECT_NAME = V_FWB_TABLE_NAME AND\n                      OBJECT_TYPE = 'TABLE PARTITION') PARTS\n          WHERE 0e03d5c46556a742ba46252698396ef2.bafb9d68e2767872ac5c686049022ebd.24fc0a779c3fa6af3db98de0b9fae031 BETWEEN V_STRT_DT AND V_END_DT\n          AND ROWNUM = 1\n          AND DATA_OBJECT_ID = DBMS_MVIEW.PMARKER(0e03d5c46556a742ba46252698396ef2.bafb9d68e2767872ac5c686049022ebd.4e293bb8123d167d419c2f932a359951);\n\n        V_PRCS_STP := 'FWB_MDL  partition name to be dropped '||V_MDL_PARTITION_NAME;\n        DBMS_OUTPUT.PUT_LINE (V_PRCS_STP);\n\n        \n\n\n       \n       V_MDL_CODE:= 7540495dc7d95c8483c39c98db3db89c.72d996f41712e622935d17bc9cb23cfa.daf8cb22c40bc2001571d8d7a77005d9(V_OUT_MSG\n                                                    ,V_OWNER\n                                                    ,V_FWB_TABLE_NAME\n                                                    ,V_MDL_PARTITION_NAME);\n\n      \n      \n      \n\n    EXCEPTION\n     WHEN NO_DATA_FOUND THEN\n         v_prcs_stp :='FWB_MDL Partition not found, Do not fail , SQLCODE: ' || SQLCODE || ' , ' || SQLERRM;\n         DBMS_OUTPUT.PUT_LINE (V_PRCS_STP);\n     END;\n\n    BEGIN\n        \n         SELECT SUBOBJECT_NAME\n         INTO V_BRIDGE_PARTITION_NAME\n         FROM 0e03d5c46556a742ba46252698396ef2.003af8b8e66651eda0b8717c40420b54 M,\n               (SELECT DATA_OBJECT_ID, SUBOBJECT_NAME FROM ALL_OBJECTS\n                WHERE OWNER = V_OWNER AND\n                      OBJECT_NAME = V_BRIDGE_TABLE_NAME AND\n                      OBJECT_TYPE = 'TABLE PARTITION') PARTS\n          WHERE 0e03d5c46556a742ba46252698396ef2.003af8b8e66651eda0b8717c40420b54.902b48cba39dd1df9f7d50635277b70c BETWEEN V_STRT_DT AND V_END_DT\n          AND ROWNUM = 1\n          AND DATA_OBJECT_ID = DBMS_MVIEW.PMARKER(0e03d5c46556a742ba46252698396ef2.003af8b8e66651eda0b8717c40420b54.4e293bb8123d167d419c2f932a359951);\n\n        V_PRCS_STP := 'FWB_MDL_BRIDGE  partition name to be dropped '||V_BRIDGE_PARTITION_NAME;\n        DBMS_OUTPUT.PUT_LINE (V_PRCS_STP);\n\n\n         \n\n       \n       V_BRIDGE_CODE:= 7540495dc7d95c8483c39c98db3db89c.72d996f41712e622935d17bc9cb23cfa.daf8cb22c40bc2001571d8d7a77005d9(V_OUT_MSG\n                                                      ,V_OWNER\n                                                      ,V_BRIDGE_TABLE_NAME\n                                                      ,V_BRIDGE_PARTITION_NAME);\n\n      \n      \n      \n\n    EXCEPTION\n     WHEN NO_DATA_FOUND THEN\n         V_PRCS_STP :='BRIDGE Partition not found, Do not fail , SQLCODE: ' || SQLCODE || ' , ' || SQLERRM;\n         DBMS_OUTPUT.PUT_LINE (V_PRCS_STP);\n     END;\n\n  \n  \n  \n\n      V_PRCS_STP :='End Process: '||CON_PROCESS_NAME;\n      DBMS_OUTPUT.PUT_LINE (V_PRCS_STP);\n      V_PRCS_STP :='End Time:'||TO_CHAR(SYSDATE,'YYYY-MM-DD HH24:MI:SS');\n      DBMS_OUTPUT.PUT_LINE (V_PRCS_STP);\n\n      RETURN 0;\n\n\n\n   EXCEPTION\n      WHEN OTHERS\n      THEN\n         V_PRCS_STP :='Catch all - SQLCODE , SQLERRM :' || SQLCODE || ' , ' || SQLERRM;\n          DBMS_OUTPUT.PUT_LINE (V_PRCS_STP);\n          V_PRCS_STP :=V_PRCS_NM||' - '||V_PRCS_PRAM;\n          DBMS_OUTPUT.PUT_LINE (V_PRCS_STP);\n         return 1;\n   END;\n/",
            "upstream_dependencies": [],
            "downstream_dependencies": [],
            "dag_location": "null",
            "gantt_location": "null",
            "created_at": "null",
            "updated_at": "null"
        },
        {
            "name": "FN_RNK_EXCLUDE_VPD",
            "encrypted_name": "a59faff99f77e1b37b9a35aed0e628999d8b3fe8760b7fe8c45d1255ce1ebaf6",
            "type": "function",
            "database": "null",
            "encrypted_database": "null",
            "schema": "XDMADM",
            "encrypted_schema": "0e03d5c46556a742ba46252698396ef2",
            "fully_qualified_name": "XDMADM.FN_RNK_EXCLUDE_VPD",
            "encrypted_fqn": "0e03d5c46556a742ba46252698396ef2.a59faff99f77e1b37b9a35aed0e628999d8b3fe8760b7fe8c45d1255ce1ebaf6",
            "synonyms": [],
            "metadata_analysis": "CREATE OR REPLACE FUNCTION \"0e03d5c46556a742ba46252698396ef2\".\"a59faff99f77e1b37b9a35aed0e628999d8b3fe8760b7fe8c45d1255ce1ebaf6\" (p_schema       IN VARCHAR2,\n                                                     p_objname      IN VARCHAR2)\n   RETURN VARCHAR2 AS\n   \n   c_start                CONSTANT NUMBER := DBMS_UTILITY.get_time;\n   c_fn_nm                CONSTANT VARCHAR2(30) := 'FN_RNK_EXCLUDE_VPD';\n   l_security_predicate   VARCHAR2(4000) DEFAULT NULL;\n   l_cur_sql              VARCHAR2(4000) := SYS_CONTEXT('USERENV', 'CURRENT_SQL');\n   l_sbjct_area           VARCHAR2(100) := SYS_CONTEXT(9751bbbcfea690cc0be4d58830a6fe2e.9bfb5eb7793dc8fa6800d5a61e5e3e4e1e2f6ec194927f064ce6cb31fba71a32.f4a54ebc6f2c591ed4266aafe66971af, 9751bbbcfea690cc0be4d58830a6fe2e.9bfb5eb7793dc8fa6800d5a61e5e3e4e1e2f6ec194927f064ce6cb31fba71a32.3b1288ed835b1b524e9500bb13544956e6e6300089dae5a98e31814d0406060f);\n   l_vpd_exempt           VARCHAR2(1) := SYS_CONTEXT(9751bbbcfea690cc0be4d58830a6fe2e.9bfb5eb7793dc8fa6800d5a61e5e3e4e1e2f6ec194927f064ce6cb31fba71a32.f4a54ebc6f2c591ed4266aafe66971af, 9751bbbcfea690cc0be4d58830a6fe2e.9bfb5eb7793dc8fa6800d5a61e5e3e4e1e2f6ec194927f064ce6cb31fba71a32.0eaf613ab52a53601d1496b5650de81e);\n   l_all_divs             VARCHAR2(1) := SYS_CONTEXT(9751bbbcfea690cc0be4d58830a6fe2e.9bfb5eb7793dc8fa6800d5a61e5e3e4e1e2f6ec194927f064ce6cb31fba71a32.f4a54ebc6f2c591ed4266aafe66971af, 9751bbbcfea690cc0be4d58830a6fe2e.9bfb5eb7793dc8fa6800d5a61e5e3e4e1e2f6ec194927f064ce6cb31fba71a32.0f460756ee76d4a2460733464cda5f95);\n   l_exclude_cnt          NUMBER;\nBEGIN\n   \n   IF l_sbjct_area IS NULL THEN\n      l_security_predicate   := '1=2';\n      9751bbbcfea690cc0be4d58830a6fe2e.d4abe88ed2062b430c927bc84d61faf1f9a7aadf5998d448c2e2d1b0b47a3056.7d64937276682b23a0e16e5c61dad7aa('NO SA',\n                                          c_fn_nm,\n                                          USER,\n                                          p_schema,\n                                          p_objname,\n                                          l_sbjct_area,\n                                          l_vpd_exempt,\n                                          l_all_divs,\n                                          l_cur_sql,\n                                          l_security_predicate,\n                                          (DBMS_UTILITY.get_time - c_start) / 100);\n\n      RETURN l_security_predicate;\n   END IF;\n\n   \n   \n   IF l_vpd_exempt = 'Y' THEN\n      l_security_predicate   := '1=1';\n      9751bbbcfea690cc0be4d58830a6fe2e.d4abe88ed2062b430c927bc84d61faf1f9a7aadf5998d448c2e2d1b0b47a3056.7d64937276682b23a0e16e5c61dad7aa('EXEMPT',\n                                          c_fn_nm,\n                                          USER,\n                                          p_schema,\n                                          p_objname,\n                                          l_sbjct_area,\n                                          l_vpd_exempt,\n                                          l_all_divs,\n                                          l_cur_sql,\n                                          l_security_predicate,\n                                          (DBMS_UTILITY.get_time - c_start) / 100);\n\n      RETURN l_security_predicate;\n   END IF;\n\n   \n   \n   IF l_all_divs = 'Y' THEN\n      l_security_predicate   := '1=1';\n      9751bbbcfea690cc0be4d58830a6fe2e.d4abe88ed2062b430c927bc84d61faf1f9a7aadf5998d448c2e2d1b0b47a3056.7d64937276682b23a0e16e5c61dad7aa('ALL DIVS',\n                                          c_fn_nm,\n                                          USER,\n                                          p_schema,\n                                          p_objname,\n                                          l_sbjct_area,\n                                          l_vpd_exempt,\n                                          l_all_divs,\n                                          l_cur_sql,\n                                          l_security_predicate,\n                                          (DBMS_UTILITY.get_time - c_start) / 100);\n\n      RETURN l_security_predicate;\n   END IF;\n\n   SELECT COUNT( * )\n     INTO l_exclude_cnt\n     FROM de459e2fe7f96e4d958537b31b946b26.1531773130eedd41bd3a1fa8035bfa17c73cfccbabc9dd99fae7eea844197a25 ad\n    WHERE username = USER\n      AND EXISTS (SELECT 'X'\n                    FROM de459e2fe7f96e4d958537b31b946b26.de40ae7be8b2eb3858d46af8d107f3db\n                   WHERE app_name = 'SLS_RNK'\n                     AND param_type = 'EXCLUDE_BRNCH_CD'\n                     AND param_value_chr = de459e2fe7f96e4d958537b31b946b26.1531773130eedd41bd3a1fa8035bfa17c73cfccbabc9dd99fae7eea844197a25.4855453efe73ff0bd0f7583df58260dd);\n\n   IF (l_exclude_cnt > 0) THEN\n      l_security_predicate   := '1=2';\n      9751bbbcfea690cc0be4d58830a6fe2e.d4abe88ed2062b430c927bc84d61faf1f9a7aadf5998d448c2e2d1b0b47a3056.7d64937276682b23a0e16e5c61dad7aa('EXCLUDE BRNCH',\n                                          c_fn_nm,\n                                          USER,\n                                          p_schema,\n                                          p_objname,\n                                          l_sbjct_area,\n                                          l_vpd_exempt,\n                                          l_all_divs,\n                                          l_cur_sql,\n                                          l_security_predicate,\n                                          (DBMS_UTILITY.get_time - c_start) / 100);\n      RETURN l_security_predicate;\n   ELSE\n      l_security_predicate   := '1=1';\n      9751bbbcfea690cc0be4d58830a6fe2e.d4abe88ed2062b430c927bc84d61faf1f9a7aadf5998d448c2e2d1b0b47a3056.7d64937276682b23a0e16e5c61dad7aa('NO EXCLUDE',\n                                          c_fn_nm,\n                                          USER,\n                                          p_schema,\n                                          p_objname,\n                                          l_sbjct_area,\n                                          l_vpd_exempt,\n                                          l_all_divs,\n                                          l_cur_sql,\n                                          l_security_predicate,\n                                          (DBMS_UTILITY.get_time - c_start) / 100);\n      RETURN l_security_predicate;\n   END IF;\nEXCEPTION\n   WHEN OTHERS THEN\n      l_security_predicate   := '1=2';\n      9751bbbcfea690cc0be4d58830a6fe2e.d4abe88ed2062b430c927bc84d61faf1f9a7aadf5998d448c2e2d1b0b47a3056.7d64937276682b23a0e16e5c61dad7aa(SQLCODE || '-' || SQLERRM,\n                                          c_fn_nm,\n                                          USER,\n                                          p_schema,\n                                          p_objname,\n                                          l_sbjct_area,\n                                          l_vpd_exempt,\n                                          NULL,\n                                          l_cur_sql,\n                                          l_security_predicate,\n                                          (DBMS_UTILITY.get_time - c_start) / 100);\n\n      RETURN l_security_predicate;\nEND fn_rnk_exclude_vpd;\n/",
            "upstream_dependencies": [],
            "downstream_dependencies": [],
            "dag_location": "null",
            "gantt_location": "null",
            "created_at": "null",
            "updated_at": "null"
        },
        {
            "name": "FN_CUST_CLSFCTN_CORP_WKLY",
            "encrypted_name": "5a29470c6a3d464325075a185f279be578927c4aa5b984a887dc1b46384bc787",
            "type": "function",
            "database": "null",
            "encrypted_database": "null",
            "schema": "XDMADM",
            "encrypted_schema": "0e03d5c46556a742ba46252698396ef2",
            "fully_qualified_name": "XDMADM.FN_CUST_CLSFCTN_CORP_WKLY",
            "encrypted_fqn": "0e03d5c46556a742ba46252698396ef2.5a29470c6a3d464325075a185f279be578927c4aa5b984a887dc1b46384bc787",
            "synonyms": [],
            "metadata_analysis": "CREATE OR REPLACE FUNCTION \"0e03d5c46556a742ba46252698396ef2\".\"5a29470c6a3d464325075a185f279be578927c4aa5b984a887dc1b46384bc787\" (v_in_odate IN VARCHAR2)\n   RETURN NUMBER IS\n   \n\n   \n   v_odate                        DATE := TO_DATE(v_in_odate, 'YYYYMMDD');\n   v_end_dt                       DATE;\n   v_fisc_mth_strt_dt             DATE;\n   v_fisc_mth_end_dt              DATE;\n   v_fisc_wk_strt_dt_yrago        DATE;\n   v_fisc_wk_end_dt_yrago         DATE;\n   v_fisc_mth_strt_dt_yrago       DATE;\n   v_fisc_mth_end_dt_yrago        DATE;\n   v_fisc_yr                      NUMBER(4);\n   v_fisc_mth_of_yr               VARCHAR2(2);\n   v_fisc_wk_of_yr                NUMBER(2);\n   v_py_max_wk                    NUMBER(2);\n   v_last_fisc_mth_of_yr          NUMBER;\n   v_fisc_yr_last_mth             NUMBER;\n   v_last_fisc_mth_strt_dt        DATE;\n   v_fisc_yr_mth                  NUMBER;\n   v_prd_strt_dt                  DATE;\n   v_prd_end_dt                   DATE;\n   v_fisc_wk_strt_dt              DATE;\n   v_fisc_wk_end_dt               DATE;\n   v_fisc_yr_wk                   NUMBER;\n\n\nBEGIN\n   \n   \n   \n   \n\n         v_end_dt   := v_odate;\n\n    SELECT de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.ab30d6d679879cfacfe389b97d1d3f0e, de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.cb5e253886eb30a93e66cbf95203a754, de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.f2de255a7553ba934b1f05ae7699ae4c\n     INTO v_fisc_yr, v_fisc_wk_of_yr, v_fisc_yr_wk\n     FROM de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001 t\n    WHERE de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.222ccb1d1746bcdb2365f29b3da0b613 = v_end_dt;\n\n   SELECT  de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.e1d446673288adb6d5f219d0aa82d37a, de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.2603c45be643e5cd8f9c6dad3bee6cb3\n     INTO  v_fisc_mth_of_yr, v_fisc_yr_mth\n     FROM de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001 t\n    WHERE de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.222ccb1d1746bcdb2365f29b3da0b613 = v_end_dt;\n\n   SELECT MIN(clndr_dt), MAX(clndr_dt)\n     INTO v_prd_strt_dt, v_prd_end_dt\n     FROM de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001\n    WHERE fisc_yr_mth = v_fisc_yr_mth;\n\n   SELECT MIN(de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.222ccb1d1746bcdb2365f29b3da0b613),\n          MAX(de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.222ccb1d1746bcdb2365f29b3da0b613),\n\t\t  MIN(clndr_dt_yrago),\n          MAX(clndr_dt_yrago)\n     INTO v_fisc_wk_strt_dt,\n\t      v_fisc_wk_end_dt,\n\t\t  v_fisc_wk_strt_dt_yrago,\n\t      v_fisc_wk_end_dt_yrago\n     FROM de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001 t\n    WHERE de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.f2de255a7553ba934b1f05ae7699ae4c IN (SELECT fisc_yr_wk\n                             FROM de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001\n                            WHERE clndr_dt = v_end_dt);\n\n\n   SELECT MIN(clndr_dt),\n          MAX(clndr_dt),\n          MIN(clndr_dt_yrago),\n          MAX(clndr_dt_yrago)\n     INTO v_fisc_mth_strt_dt,\n          v_fisc_mth_end_dt,\n          v_fisc_mth_strt_dt_yrago,\n          v_fisc_mth_end_dt_yrago\n     FROM de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001 t\n    WHERE de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.ab30d6d679879cfacfe389b97d1d3f0e = v_fisc_yr\n      AND de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.e1d446673288adb6d5f219d0aa82d37a = v_fisc_mth_of_yr;\n\n   SELECT MAX(de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.cb5e253886eb30a93e66cbf95203a754)\n     INTO v_py_max_wk \n     FROM de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001 t\n    WHERE de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.ab30d6d679879cfacfe389b97d1d3f0e = v_fisc_yr - 1;\n\n   SELECT MAX(fisc_mth_of_yr), MAX(fisc_yr), MIN(clndr_dt)\n     INTO v_last_fisc_mth_of_yr, v_fisc_yr_last_mth, v_last_fisc_mth_strt_dt\n     FROM de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001 a\n    WHERE fisc_yr_mth = (SELECT MAX(de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.2603c45be643e5cd8f9c6dad3bee6cb3) \n                           FROM de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001 a\n                          WHERE de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.2603c45be643e5cd8f9c6dad3bee6cb3 < (SELECT de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.2603c45be643e5cd8f9c6dad3bee6cb3\n                                                   FROM de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001 a\n                                                  WHERE de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.222ccb1d1746bcdb2365f29b3da0b613 = v_end_dt));\n\n\n   \n   EXECUTE IMMEDIATE 'TRUNCATE TABLE CUST_CLSFCTN_WKLY_WRK';\n\n   DBMS_OUTPUT.put_line('Table de459e2fe7f96e4d958537b31b946b26.b7f9a8d8e9c3da66d1e4bda132607882eb49044daf1df0e986047f8a5ffaa633 truncated ' || SYSTIMESTAMP);\n\n   \n   INSERT INTO de459e2fe7f96e4d958537b31b946b26.b7f9a8d8e9c3da66d1e4bda132607882eb49044daf1df0e986047f8a5ffaa633(cust_nbr, div_nbr, fisc_yr, fisc_mth_of_yr,fisc_yr_wk, fisc_wk_of_yr, cust_clsfctn,\n                                   fisc_wk_strt_dt, fisc_wk_end_dt, fisc_wk_strt_dt_yrago, fisc_wk_end_dt_yrago, crt_dt, upd_dt, drops, grs_sls_extnd,\n                                   qty_ship,unfrm_grs_sls_extnd, unfrm_dwa_cost_extnd, unfrm_ttl_vndr_fnd_dvt, unfrm_qty_ship, unfrm_grs_tgp, unfrm_grs_tgp_per_drop)\n      SELECT aab0feb533f73234f61772945fe4678b.852fa1e9f02f1ca2c75837f7146b2381,\n             aab0feb533f73234f61772945fe4678b.839c4ffb4bfaae1bb58eab4dee67d96a,\n             aab0feb533f73234f61772945fe4678b.ab30d6d679879cfacfe389b97d1d3f0e,\n             aab0feb533f73234f61772945fe4678b.e1d446673288adb6d5f219d0aa82d37a,\n\t\t\t aab0feb533f73234f61772945fe4678b.f2de255a7553ba934b1f05ae7699ae4c,\n             aab0feb533f73234f61772945fe4678b.cb5e253886eb30a93e66cbf95203a754,\n             CASE\n                WHEN no_cd_unfrm_sales_ty > 0\n                 AND no_cd_unfrm_sales_ly > 0 THEN\n                   'PENETRATION'\n                WHEN no_cd_unfrm_sales_ty > 0\n                 AND no_cd_unfrm_sales_ly <= 0 THEN\n                   'NEW'\n                WHEN no_cd_unfrm_sales_ty <= 0\n                 AND no_cd_unfrm_sales_ly > 0 THEN\n                   'LOST'\n                ELSE\n                   'OTHER'\n             END\n                AS cust_clsfctn,\n             v_fisc_wk_strt_dt,\n             v_fisc_wk_end_dt,\n             v_fisc_wk_strt_dt_yrago,\n             v_fisc_wk_end_dt_yrago,\n             SYSDATE AS crt_dt,\n\t\t\t SYSDATE AS upd_dt,\n             aab0feb533f73234f61772945fe4678b.630c48bbfe25ea68a239339f24d37c79,\n             aab0feb533f73234f61772945fe4678b.2ee1400a0150f0b220dd7bd6268d1e66,\n             aab0feb533f73234f61772945fe4678b.dc15696e1e997bad6131bf936574f406,\n             aab0feb533f73234f61772945fe4678b.afcae1f8310cd038c0633aeaa179c10c280a4c8731f60bb762471fb74030c9a2,\n\t\t\t aab0feb533f73234f61772945fe4678b.4f2731c61a8e37dc3b1cb4eb301ef71f96a8e7c926d4a6d230ee2652a5996563,\n\t\t\t aab0feb533f73234f61772945fe4678b.e511ce5564513d6f81e8798ab8caf3b23c6ba3def1a8b441a85fc7b3bcb1d0d6,\n\t\t\t aab0feb533f73234f61772945fe4678b.ccf8d88f2d37f3171da2121ab22e9330,\n             aab0feb533f73234f61772945fe4678b.37175a70b8190fbf717de5f6ebc49b0a,\n             CASE\n                WHEN aab0feb533f73234f61772945fe4678b.37175a70b8190fbf717de5f6ebc49b0a <> 0 THEN CASE WHEN drops <> 0 THEN aab0feb533f73234f61772945fe4678b.37175a70b8190fbf717de5f6ebc49b0a / aab0feb533f73234f61772945fe4678b.630c48bbfe25ea68a239339f24d37c79 ELSE 0 END\n                ELSE NULL\n             END\n                unfrm_grs_tgp_per_drop\n\n        FROM (  SELECT cust_nbr,\n                       div_nbr,\n                       fisc_yr,\n                       fisc_mth_of_yr,\n\t\t\t\t\t   fisc_yr_wk,\n\t\t\t\t\t   fisc_wk_of_yr,\n                       SUM(NVL(sales_ty, 0)) AS sales_ty,\n                       SUM(NVL(sales_ly, 0)) AS sales_ly,\n                       SUM(NVL(no_cd_unfrm_sales_ty, 0)) AS no_cd_unfrm_sales_ty,\n                       SUM(NVL(no_cd_unfrm_sales_ly, 0)) AS no_cd_unfrm_sales_ly,\n                       SUM(NVL(drops, 0)) drops,\n                       SUM(NVL(grs_sls_extnd, 0)) grs_sls_extnd,\n                       SUM(NVL(qty_ship, 0)) qty_ship,\n                       SUM(NVL(unfrm_grs_sls_extnd, 0)) unfrm_grs_sls_extnd,\n                       SUM(NVL(unfrm_dwa_cost_extnd, 0)) unfrm_dwa_cost_extnd,\n\t\t\t\t\t   SUM(NVL(unfrm_ttl_vndr_fnd_dvt, 0)) unfrm_ttl_vndr_fnd_dvt,\n                       SUM(NVL(unfrm_qty_ship, 0)) unfrm_qty_ship,\n                       SUM(NVL(unfrm_grs_tgp, 0)) unfrm_grs_tgp\n                       FROM (SELECT 6f037dd8c55b34c0a958bc6e5d1c45f6.852fa1e9f02f1ca2c75837f7146b2381,\n                               6f037dd8c55b34c0a958bc6e5d1c45f6.839c4ffb4bfaae1bb58eab4dee67d96a,\n                               6f037dd8c55b34c0a958bc6e5d1c45f6.ab30d6d679879cfacfe389b97d1d3f0e,\n                               6f037dd8c55b34c0a958bc6e5d1c45f6.e1d446673288adb6d5f219d0aa82d37a,\n\t\t\t\t\t\t\t   6f037dd8c55b34c0a958bc6e5d1c45f6.f2de255a7553ba934b1f05ae7699ae4c,\n\t\t\t\t\t\t\t   6f037dd8c55b34c0a958bc6e5d1c45f6.cb5e253886eb30a93e66cbf95203a754,\n                               CASE\n                                  WHEN 15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.ab30d6d679879cfacfe389b97d1d3f0e = v_fisc_yr THEN NVL(15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.2ee1400a0150f0b220dd7bd6268d1e66, 0)\n                                  ELSE 0\n                               END\n                                  sales_ty,\n                               CASE\n                                  WHEN 15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.ab30d6d679879cfacfe389b97d1d3f0e = v_fisc_yr - 1 THEN\n                                     NVL(15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.2ee1400a0150f0b220dd7bd6268d1e66, 0)\n                                  ELSE\n                                     0\n                               END\n                                  sales_ly,\n                               CASE\n                                  WHEN 15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.ab30d6d679879cfacfe389b97d1d3f0e = v_fisc_yr THEN\n                                     NVL(15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.ab081c412fc18694a8297c8dfdea984cd9542f5039f4af6f9fa4a3007112f536, 0)\n                                  ELSE\n                                     0\n                               END\n                                  no_cd_unfrm_sales_ty,\n                               CASE\n                                  WHEN 15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.ab30d6d679879cfacfe389b97d1d3f0e = v_fisc_yr - 1 THEN\n                                     NVL(15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.ab081c412fc18694a8297c8dfdea984cd9542f5039f4af6f9fa4a3007112f536, 0)\n                                  ELSE\n                                     0\n                               END\n                                  no_cd_unfrm_sales_ly,\n                               CASE WHEN 15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.ab30d6d679879cfacfe389b97d1d3f0e = v_fisc_yr THEN 15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.630c48bbfe25ea68a239339f24d37c79 END drops,\n                               CASE WHEN 15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.ab30d6d679879cfacfe389b97d1d3f0e = v_fisc_yr THEN 15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.2ee1400a0150f0b220dd7bd6268d1e66 END\n                                  grs_sls_extnd,\n                               CASE WHEN 15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.ab30d6d679879cfacfe389b97d1d3f0e = v_fisc_yr THEN 15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.dc15696e1e997bad6131bf936574f406 END qty_ship,\n                               CASE\n                                  WHEN 15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.ab30d6d679879cfacfe389b97d1d3f0e = v_fisc_yr THEN 15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.afcae1f8310cd038c0633aeaa179c10c280a4c8731f60bb762471fb74030c9a2\n                               END\n                                  unfrm_grs_sls_extnd,\n\t\t\t\t\t\t\t\tCASE\n                                  WHEN 15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.ab30d6d679879cfacfe389b97d1d3f0e = v_fisc_yr THEN 15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.4f2731c61a8e37dc3b1cb4eb301ef71f96a8e7c926d4a6d230ee2652a5996563\n                               END\n                                  unfrm_dwa_cost_extnd,\n\t\t\t\t\t\t\t\tCASE\n                                  WHEN 15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.ab30d6d679879cfacfe389b97d1d3f0e = v_fisc_yr THEN 15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.e511ce5564513d6f81e8798ab8caf3b23c6ba3def1a8b441a85fc7b3bcb1d0d6\n                               END\n                                  unfrm_ttl_vndr_fnd_dvt,\n\n                               CASE WHEN 15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.ab30d6d679879cfacfe389b97d1d3f0e = v_fisc_yr THEN 15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.ccf8d88f2d37f3171da2121ab22e9330 END\n                                  unfrm_qty_ship,\n                              CASE WHEN 15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.ab30d6d679879cfacfe389b97d1d3f0e = v_fisc_yr THEN 15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.37175a70b8190fbf717de5f6ebc49b0a END\n                                  unfrm_grs_tgp\n\n                               FROM (SELECT DISTINCT de459e2fe7f96e4d958537b31b946b26.52982d3bbc1ebc2720d9504c7ea2ed3f.7f599f836c449bebb92bb9757e86c603,\n                                                de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.839c4ffb4bfaae1bb58eab4dee67d96a,\n                                                de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.852fa1e9f02f1ca2c75837f7146b2381,\n                                                v_fisc_yr AS fisc_yr,\n                                                v_fisc_mth_of_yr AS fisc_mth_of_yr,\n                                                v_fisc_yr_wk AS fisc_yr_wk,\n\t\t\t\t\t\t\t\t\t\t\t\tv_fisc_wk_of_yr as fisc_wk_of_yr\n\n                                  FROM de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001 t,\n                                       de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c s,\n                                       de459e2fe7f96e4d958537b31b946b26.dec387908a0954ddc8689c4ad37c8a3c d,\n                                       de459e2fe7f96e4d958537b31b946b26.52982d3bbc1ebc2720d9504c7ea2ed3f cc\n                                 WHERE de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.ab30d6d679879cfacfe389b97d1d3f0e IN (v_fisc_yr - 1, v_fisc_yr)\n                                   \n                                   AND de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.f5dd4374a3e3af6a775cb6d6b22e8162 = de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.222ccb1d1746bcdb2365f29b3da0b613\n                                   AND de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.839c4ffb4bfaae1bb58eab4dee67d96a = de459e2fe7f96e4d958537b31b946b26.dec387908a0954ddc8689c4ad37c8a3c.839c4ffb4bfaae1bb58eab4dee67d96a\n                                   AND de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.852fa1e9f02f1ca2c75837f7146b2381 = de459e2fe7f96e4d958537b31b946b26.52982d3bbc1ebc2720d9504c7ea2ed3f.852fa1e9f02f1ca2c75837f7146b2381\n                                   AND de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.839c4ffb4bfaae1bb58eab4dee67d96a = de459e2fe7f96e4d958537b31b946b26.52982d3bbc1ebc2720d9504c7ea2ed3f.839c4ffb4bfaae1bb58eab4dee67d96a\n                                   AND de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.467a168a7499c57b1859198a7dac7be0 IS NULL\n                                   AND (de459e2fe7f96e4d958537b31b946b26.dec387908a0954ddc8689c4ad37c8a3c.2edfd837e0441242d7eed4e0cdf56652 IS NULL\n                                     OR de459e2fe7f96e4d958537b31b946b26.dec387908a0954ddc8689c4ad37c8a3c.6d74bb3e26f02dd707dc6b3b68070169 > SYSDATE)) cust_list,\n                               (  SELECT de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.839c4ffb4bfaae1bb58eab4dee67d96a,\n                                         de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.852fa1e9f02f1ca2c75837f7146b2381,\n                                         de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.ab30d6d679879cfacfe389b97d1d3f0e,\n                                         de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.e1d446673288adb6d5f219d0aa82d37a AS fisc_mth_of_yr,\n                                         de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.f2de255a7553ba934b1f05ae7699ae4c AS fisc_yr_wk,\n\t\t\t\t\t\t\t\t\t\t de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.cb5e253886eb30a93e66cbf95203a754 AS fisc_wk_of_yr,\n                                         COUNT(\n                                            DISTINCT CASE\n                                                        WHEN de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.26ac88e7ae671a1b22c14c2fce77aa2d = 'RT'\n                                                         AND de459e2fe7f96e4d958537b31b946b26.2c04d82ed0aa1cc9bce2cf2c0548b268.89f3df82917b692fe64dca942d924e7c <> 97\n                                                         AND de459e2fe7f96e4d958537b31b946b26.2c04d82ed0aa1cc9bce2cf2c0548b268.89f3df82917b692fe64dca942d924e7c IS NOT NULL THEN\n                                                           de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.839c4ffb4bfaae1bb58eab4dee67d96a || cust_nbr || inv_dt || NVL(dlvr_rte, '') || prcs_dt\n                                                        ELSE\n                                                           NULL\n                                                     END)\n                                            drops,\n                                         SUM(grs_sls_extnd) AS grs_sls_extnd,\n                                         SUM(CASE\n                                                WHEN de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.26ac88e7ae671a1b22c14c2fce77aa2d IN ('RT', 'VS', 'WC')\n                                                 AND de459e2fe7f96e4d958537b31b946b26.2c04d82ed0aa1cc9bce2cf2c0548b268.89f3df82917b692fe64dca942d924e7c <> 97\n                                                 AND de459e2fe7f96e4d958537b31b946b26.2c04d82ed0aa1cc9bce2cf2c0548b268.89f3df82917b692fe64dca942d924e7c IS NOT NULL THEN\n                                                   de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.2ee1400a0150f0b220dd7bd6268d1e66\n                                                ELSE\n                                                   NULL\n                                             END)\n                                            no_cd_unfrm_grs_sls_extnd,\n                                         SUM(qty_ship) AS qty_ship,\n\n                                         SUM(CASE\n                                                WHEN de459e2fe7f96e4d958537b31b946b26.2c04d82ed0aa1cc9bce2cf2c0548b268.89f3df82917b692fe64dca942d924e7c <> 97\n                                                 AND de459e2fe7f96e4d958537b31b946b26.2c04d82ed0aa1cc9bce2cf2c0548b268.89f3df82917b692fe64dca942d924e7c IS NOT NULL THEN\n                                                   grs_sls_extnd\n                                                ELSE\n                                                   0\n                                             END)\n                                            unfrm_grs_sls_extnd,\n\n                                         SUM(CASE\n                                                WHEN de459e2fe7f96e4d958537b31b946b26.2c04d82ed0aa1cc9bce2cf2c0548b268.89f3df82917b692fe64dca942d924e7c <> 97\n                                                 AND de459e2fe7f96e4d958537b31b946b26.2c04d82ed0aa1cc9bce2cf2c0548b268.89f3df82917b692fe64dca942d924e7c IS NOT NULL THEN\n                                                   NVL(de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.c6c7cc45578c678907522e08bb04a4ca , 0)\n                                                ELSE\n                                                   0\n                                             END)\n                                            unfrm_dwa_cost_extnd,\n\t\t\t\t\t\t\t\t\t\t\t SUM(CASE\n                                                WHEN de459e2fe7f96e4d958537b31b946b26.2c04d82ed0aa1cc9bce2cf2c0548b268.89f3df82917b692fe64dca942d924e7c <> 97\n                                                 AND de459e2fe7f96e4d958537b31b946b26.2c04d82ed0aa1cc9bce2cf2c0548b268.89f3df82917b692fe64dca942d924e7c IS NOT NULL THEN\n                                                   NVL(de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.b7982b81d447f11a0953881190e528cae32f6dd38f333cde68119d1f277367cd , 0)\n                                                ELSE\n                                                   0\n                                             END)\n                                            unfrm_ttl_vndr_fnd_dvt,\n\n\t\t\t\t\t\t\t\t\t\t\tSUM(unfrm_qty_ship) unfrm_qty_ship,\n\n                                         SUM(CASE\n                                                WHEN de459e2fe7f96e4d958537b31b946b26.2c04d82ed0aa1cc9bce2cf2c0548b268.89f3df82917b692fe64dca942d924e7c <> 97\n                                                 AND de459e2fe7f96e4d958537b31b946b26.2c04d82ed0aa1cc9bce2cf2c0548b268.89f3df82917b692fe64dca942d924e7c IS NOT NULL THEN\n                                                   NVL(de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.2ee1400a0150f0b220dd7bd6268d1e66 - de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.c6c7cc45578c678907522e08bb04a4ca - (CASE WHEN de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.487c194c34aee6c67551aa2cdd2358ace32f6dd38f333cde68119d1f277367cd = 'P' THEN NVL(de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.d206d123f59f85e26ec113e33b465295,0) ELSE 0 END) + de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.b7982b81d447f11a0953881190e528cae32f6dd38f333cde68119d1f277367cd, 0)\n                                                ELSE\n                                                   0\n                                             END)\n                                            unfrm_grs_tgp\n\n                                    FROM de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001 t,\n                                         de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c s,\n                                         de459e2fe7f96e4d958537b31b946b26.dec387908a0954ddc8689c4ad37c8a3c d,\n                                         de459e2fe7f96e4d958537b31b946b26.dec387908a0954ddc8689c4ad37c8a3c d2,\n                                         de459e2fe7f96e4d958537b31b946b26.2c04d82ed0aa1cc9bce2cf2c0548b268 p\n                                   WHERE de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.ab30d6d679879cfacfe389b97d1d3f0e IN (v_fisc_yr, v_fisc_yr - 1)\n                                     AND de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.cb5e253886eb30a93e66cbf95203a754 = v_fisc_wk_of_yr\n                                     AND de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.d3268eabc4a7d98105fd85f9c9e62cd6e32ad436514bbe822b33de8bead744f3 = de459e2fe7f96e4d958537b31b946b26.2c04d82ed0aa1cc9bce2cf2c0548b268.d3268eabc4a7d98105fd85f9c9e62cd6e32ad436514bbe822b33de8bead744f3\n                                     AND de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.cb5e253886eb30a93e66cbf95203a754 <> CASE\n                                                               WHEN de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.ab30d6d679879cfacfe389b97d1d3f0e = v_fisc_yr - 1\n                                                                AND v_fisc_mth_of_yr = '12'\n                                                                AND v_py_max_wk = 53 THEN\n                                                                  53 \n                                                               ELSE\n                                                                  99 \n                                                            END\n                                     AND de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.222ccb1d1746bcdb2365f29b3da0b613 <= v_end_dt \n                                     AND de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.f5dd4374a3e3af6a775cb6d6b22e8162 = de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.222ccb1d1746bcdb2365f29b3da0b613\n                                     AND de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.839c4ffb4bfaae1bb58eab4dee67d96a = de459e2fe7f96e4d958537b31b946b26.dec387908a0954ddc8689c4ad37c8a3c.839c4ffb4bfaae1bb58eab4dee67d96a\n                                     AND (de459e2fe7f96e4d958537b31b946b26.dec387908a0954ddc8689c4ad37c8a3c.2edfd837e0441242d7eed4e0cdf56652 IS NULL\n                                       OR de459e2fe7f96e4d958537b31b946b26.dec387908a0954ddc8689c4ad37c8a3c.6d74bb3e26f02dd707dc6b3b68070169 > SYSDATE)\n                                     AND de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.467a168a7499c57b1859198a7dac7be0 IS NULL\n                                     AND NVL(de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.a2b201123c685e8cc48b5468cb4a449361bbd7bc0d2d67c7d7b11cb0a8d18d03, de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.839c4ffb4bfaae1bb58eab4dee67d96a) = de459e2fe7f96e4d958537b31b946b26.dec387908a0954ddc8689c4ad37c8a3c.839c4ffb4bfaae1bb58eab4dee67d96a\n                                     AND de459e2fe7f96e4d958537b31b946b26.dec387908a0954ddc8689c4ad37c8a3c.b8c6ab19cb6e726c38f24d1885346ea3 <> 'CC'\n\t\t\t\t\t\t\t\t\t AND  (case when NVL (de459e2fe7f96e4d958537b31b946b26.dec387908a0954ddc8689c4ad37c8a3c.c712a9ab5ef100c5807fa96123dac48b,'USF') <> 'USF'\n\t\t\t\t\t\t\t\t\t and NVL(de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.a2b201123c685e8cc48b5468cb4a449361bbd7bc0d2d67c7d7b11cb0a8d18d03, de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.839c4ffb4bfaae1bb58eab4dee67d96a) = de459e2fe7f96e4d958537b31b946b26.dec387908a0954ddc8689c4ad37c8a3c.839c4ffb4bfaae1bb58eab4dee67d96a\n\t\t\t\t\t\t\t\t\t and de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.f5dd4374a3e3af6a775cb6d6b22e8162 < NVL(de459e2fe7f96e4d958537b31b946b26.dec387908a0954ddc8689c4ad37c8a3c.3db9275d5f5cb2e9d918e77dbabdd97b,de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.f5dd4374a3e3af6a775cb6d6b22e8162)\n\t\t\t\t\t\t\t\t\t then 'NON_USFGL' else 'USFGL' END) ='USFGL'\n\t\t\t\t\t\t\t\t\t \n                                GROUP BY de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.839c4ffb4bfaae1bb58eab4dee67d96a,\n                                         de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.852fa1e9f02f1ca2c75837f7146b2381,\n                                         de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.ab30d6d679879cfacfe389b97d1d3f0e,\n                                         de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.e1d446673288adb6d5f219d0aa82d37a,\n                                         de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.f2de255a7553ba934b1f05ae7699ae4c,\n                                         de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.cb5e253886eb30a93e66cbf95203a754) cust_sales_ty_ly \n                         WHERE 6f037dd8c55b34c0a958bc6e5d1c45f6.852fa1e9f02f1ca2c75837f7146b2381 = 15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.852fa1e9f02f1ca2c75837f7146b2381(+) \n                           AND 6f037dd8c55b34c0a958bc6e5d1c45f6.839c4ffb4bfaae1bb58eab4dee67d96a = 15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.839c4ffb4bfaae1bb58eab4dee67d96a(+) \n                           AND 6f037dd8c55b34c0a958bc6e5d1c45f6.cb5e253886eb30a93e66cbf95203a754 = 15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.cb5e253886eb30a93e66cbf95203a754(+))\n              GROUP BY\n                       cust_nbr,\n                       div_nbr,\n                       fisc_yr,\n                       fisc_mth_of_yr,\n                       fisc_wk_of_yr,\n                       fisc_yr_wk\n                       ) c;\n\n   COMMIT;\n\n   DBMS_OUTPUT.put_line('Table de459e2fe7f96e4d958537b31b946b26.8a5c1eda3416fa5daae04a2980452d8a loaded ' || SYSTIMESTAMP);\n\n   \n   MERGE INTO de459e2fe7f96e4d958537b31b946b26.8f230825af6a32c108cd49878ff72f863896c74fc5f3a866bc8d8582e2fba0b4 tgt\n        USING (SELECT cust_nbr,\n                      div_nbr,\n                      fisc_yr,\n                      fisc_mth_of_yr,\n                      fisc_yr_wk,\n\t\t\t\t\t  fisc_wk_of_yr,\n                      cust_clsfctn,\n                      fisc_wk_strt_dt,\n                      fisc_wk_end_dt,\n                      fisc_wk_strt_dt_yrago,\n                      fisc_wk_end_dt_yrago,\n                      crt_dt,\n\t\t\t\t\t  upd_dt,\n                      drops,\n                      grs_sls_extnd,\n                      qty_ship,\n                      unfrm_grs_sls_extnd,\n\t\t\t\t\t  unfrm_dwa_cost_extnd,\n\t\t\t\t\t  unfrm_ttl_vndr_fnd_dvt,\n                      unfrm_qty_ship,\n                      unfrm_grs_tgp,\n                      unfrm_grs_tgp_per_drop\n                      FROM de459e2fe7f96e4d958537b31b946b26.b7f9a8d8e9c3da66d1e4bda132607882eb49044daf1df0e986047f8a5ffaa633) src\n           ON (c87bbaf85002563e56e2c571e0e1c5a2.852fa1e9f02f1ca2c75837f7146b2381 = a1fa0f79e78ad884522822d320ab5272.852fa1e9f02f1ca2c75837f7146b2381\n           AND c87bbaf85002563e56e2c571e0e1c5a2.839c4ffb4bfaae1bb58eab4dee67d96a = a1fa0f79e78ad884522822d320ab5272.839c4ffb4bfaae1bb58eab4dee67d96a\n           AND c87bbaf85002563e56e2c571e0e1c5a2.ab30d6d679879cfacfe389b97d1d3f0e = a1fa0f79e78ad884522822d320ab5272.ab30d6d679879cfacfe389b97d1d3f0e\n           AND c87bbaf85002563e56e2c571e0e1c5a2.e1d446673288adb6d5f219d0aa82d37a = a1fa0f79e78ad884522822d320ab5272.e1d446673288adb6d5f219d0aa82d37a\n           AND c87bbaf85002563e56e2c571e0e1c5a2.cb5e253886eb30a93e66cbf95203a754 = a1fa0f79e78ad884522822d320ab5272.cb5e253886eb30a93e66cbf95203a754)\n   WHEN MATCHED THEN\n      UPDATE SET c87bbaf85002563e56e2c571e0e1c5a2.8a5c1eda3416fa5daae04a2980452d8a                 = a1fa0f79e78ad884522822d320ab5272.8a5c1eda3416fa5daae04a2980452d8a,\n                 c87bbaf85002563e56e2c571e0e1c5a2.dfe42c57475d9fd89d96ed9e57b69306             = a1fa0f79e78ad884522822d320ab5272.dfe42c57475d9fd89d96ed9e57b69306,\n                 c87bbaf85002563e56e2c571e0e1c5a2.74b6de95f34ea7c017ab8b68a54fe70b              = a1fa0f79e78ad884522822d320ab5272.74b6de95f34ea7c017ab8b68a54fe70b,\n                 c87bbaf85002563e56e2c571e0e1c5a2.72d6de60a9cbb2a2d78a2a36297e55f1f43d3e611ef8d78ea0e7840aa66f8834       = a1fa0f79e78ad884522822d320ab5272.72d6de60a9cbb2a2d78a2a36297e55f1f43d3e611ef8d78ea0e7840aa66f8834,\n                 c87bbaf85002563e56e2c571e0e1c5a2.2cbaab6f2111487297b7d37f7d42883a04f2c76b85d3b6c683ff67d7fcfe6fae        = a1fa0f79e78ad884522822d320ab5272.2cbaab6f2111487297b7d37f7d42883a04f2c76b85d3b6c683ff67d7fcfe6fae,\n                 c87bbaf85002563e56e2c571e0e1c5a2.7a133759cd0bf9f99c4a5301a550aed5                       = (    SELECT SYSDATE FROM DUAL),\n                 c87bbaf85002563e56e2c571e0e1c5a2.630c48bbfe25ea68a239339f24d37c79                        = a1fa0f79e78ad884522822d320ab5272.630c48bbfe25ea68a239339f24d37c79,\n                 c87bbaf85002563e56e2c571e0e1c5a2.2ee1400a0150f0b220dd7bd6268d1e66                = a1fa0f79e78ad884522822d320ab5272.2ee1400a0150f0b220dd7bd6268d1e66,\n                 c87bbaf85002563e56e2c571e0e1c5a2.dc15696e1e997bad6131bf936574f406                     = a1fa0f79e78ad884522822d320ab5272.dc15696e1e997bad6131bf936574f406,\n                 c87bbaf85002563e56e2c571e0e1c5a2.afcae1f8310cd038c0633aeaa179c10c280a4c8731f60bb762471fb74030c9a2          = a1fa0f79e78ad884522822d320ab5272.afcae1f8310cd038c0633aeaa179c10c280a4c8731f60bb762471fb74030c9a2,\n\t\t\t\t c87bbaf85002563e56e2c571e0e1c5a2.4f2731c61a8e37dc3b1cb4eb301ef71f96a8e7c926d4a6d230ee2652a5996563         = a1fa0f79e78ad884522822d320ab5272.4f2731c61a8e37dc3b1cb4eb301ef71f96a8e7c926d4a6d230ee2652a5996563,\n\t\t\t\t c87bbaf85002563e56e2c571e0e1c5a2.e511ce5564513d6f81e8798ab8caf3b23c6ba3def1a8b441a85fc7b3bcb1d0d6       = a1fa0f79e78ad884522822d320ab5272.e511ce5564513d6f81e8798ab8caf3b23c6ba3def1a8b441a85fc7b3bcb1d0d6,\n                 c87bbaf85002563e56e2c571e0e1c5a2.ccf8d88f2d37f3171da2121ab22e9330               = a1fa0f79e78ad884522822d320ab5272.ccf8d88f2d37f3171da2121ab22e9330,\n                 c87bbaf85002563e56e2c571e0e1c5a2.37175a70b8190fbf717de5f6ebc49b0a                = a1fa0f79e78ad884522822d320ab5272.37175a70b8190fbf717de5f6ebc49b0a,\n                 c87bbaf85002563e56e2c571e0e1c5a2.e6160a512e148d90c7df38ae2e16368dcd30f368447f67a772f6e122173aa0f4       = a1fa0f79e78ad884522822d320ab5272.e6160a512e148d90c7df38ae2e16368dcd30f368447f67a772f6e122173aa0f4\n\n   WHEN NOT MATCHED THEN\n      INSERT            ( cust_nbr, div_nbr, fisc_yr, fisc_mth_of_yr, fisc_yr_wk,\n                         fisc_wk_of_yr, cust_clsfctn, fisc_wk_strt_dt, fisc_wk_end_dt, fisc_wk_strt_dt_yrago, fisc_wk_end_dt_yrago,\n                         crt_dt,  drops, grs_sls_extnd, qty_ship, unfrm_grs_sls_extnd, unfrm_dwa_cost_extnd,unfrm_ttl_vndr_fnd_dvt, unfrm_qty_ship,\n                          unfrm_grs_tgp, unfrm_grs_tgp_per_drop )\n          VALUES ( a1fa0f79e78ad884522822d320ab5272.852fa1e9f02f1ca2c75837f7146b2381,\n                  a1fa0f79e78ad884522822d320ab5272.839c4ffb4bfaae1bb58eab4dee67d96a,\n                  a1fa0f79e78ad884522822d320ab5272.ab30d6d679879cfacfe389b97d1d3f0e,\n                  a1fa0f79e78ad884522822d320ab5272.e1d446673288adb6d5f219d0aa82d37a,\n                  a1fa0f79e78ad884522822d320ab5272.f2de255a7553ba934b1f05ae7699ae4c,\n                  a1fa0f79e78ad884522822d320ab5272.cb5e253886eb30a93e66cbf95203a754,\n                  a1fa0f79e78ad884522822d320ab5272.8a5c1eda3416fa5daae04a2980452d8a,\n                  a1fa0f79e78ad884522822d320ab5272.dfe42c57475d9fd89d96ed9e57b69306,\n                  a1fa0f79e78ad884522822d320ab5272.74b6de95f34ea7c017ab8b68a54fe70b,\n                  a1fa0f79e78ad884522822d320ab5272.72d6de60a9cbb2a2d78a2a36297e55f1f43d3e611ef8d78ea0e7840aa66f8834,\n                  a1fa0f79e78ad884522822d320ab5272.2cbaab6f2111487297b7d37f7d42883a04f2c76b85d3b6c683ff67d7fcfe6fae,\n                  a1fa0f79e78ad884522822d320ab5272.44db07dca7893985ce87192c7f358f75,\n                  a1fa0f79e78ad884522822d320ab5272.630c48bbfe25ea68a239339f24d37c79,\n                  a1fa0f79e78ad884522822d320ab5272.2ee1400a0150f0b220dd7bd6268d1e66,\n                  a1fa0f79e78ad884522822d320ab5272.dc15696e1e997bad6131bf936574f406,\n                  a1fa0f79e78ad884522822d320ab5272.afcae1f8310cd038c0633aeaa179c10c280a4c8731f60bb762471fb74030c9a2,\n\t\t\t\t  a1fa0f79e78ad884522822d320ab5272.4f2731c61a8e37dc3b1cb4eb301ef71f96a8e7c926d4a6d230ee2652a5996563,\n\t\t\t\t  a1fa0f79e78ad884522822d320ab5272.e511ce5564513d6f81e8798ab8caf3b23c6ba3def1a8b441a85fc7b3bcb1d0d6,\n                  a1fa0f79e78ad884522822d320ab5272.ccf8d88f2d37f3171da2121ab22e9330,\n                  a1fa0f79e78ad884522822d320ab5272.37175a70b8190fbf717de5f6ebc49b0a,\n                  a1fa0f79e78ad884522822d320ab5272.e6160a512e148d90c7df38ae2e16368dcd30f368447f67a772f6e122173aa0f4\n                  );\n\n   COMMIT;\n\n   RETURN 0;\n\n   \n   \n       \n           \n           \n         \n          \n\n\nEXCEPTION\n   WHEN OTHERS THEN\n      DBMS_OUTPUT.put_line('Error in 0e03d5c46556a742ba46252698396ef2.d31d456b3b71968c2bcc2bc00fccf9c8b8118fbe09cac1ff360826b195459559:' || SQLCODE || ' ' || SQLERRM);\n      RETURN 1;\nEND fn_cust_clsfctn_corp_wkly;\n/",
            "upstream_dependencies": [],
            "downstream_dependencies": [],
            "dag_location": "null",
            "gantt_location": "null",
            "created_at": "null",
            "updated_at": "null"
        },
        {
            "name": "FN_SALES_SUMM_CUST_DLY_LOAD",
            "encrypted_name": "a9ca92b9d6fb7b13e7a2fefda1446c433bcc2e4a396c374ad5b2fffde085ad4b",
            "type": "function",
            "database": "null",
            "encrypted_database": "null",
            "schema": "XDMADM",
            "encrypted_schema": "0e03d5c46556a742ba46252698396ef2",
            "fully_qualified_name": "XDMADM.FN_SALES_SUMM_CUST_DLY_LOAD",
            "encrypted_fqn": "0e03d5c46556a742ba46252698396ef2.a9ca92b9d6fb7b13e7a2fefda1446c433bcc2e4a396c374ad5b2fffde085ad4b",
            "synonyms": [],
            "metadata_analysis": "CREATE OR REPLACE FUNCTION \"0e03d5c46556a742ba46252698396ef2\".\"a9ca92b9d6fb7b13e7a2fefda1446c433bcc2e4a396c374ad5b2fffde085ad4b\" (p_odate IN DATE)\n    RETURN NUMBER\nAS\n    \n    l_ld_trm                    VARCHAR2 (30) := TO_NUMBER (TO_CHAR (SYSDATE, 'yyyymmddhh24miss'));\n    l_fisc_yr_mth               VARCHAR2 (8 Byte);\n    l_fisc_wks_this_pd          NUMBER;\n    l_update_cnt                NUMBER;\n    l_12_prd_strt_dt            DATE;\n    l_12_prd_end_dt             DATE;\n    l_param_value               NUMBER;\n\n   \n\n         \n    cursor cust_summ( c_fisc_wks_this_pd IN NUMBER, c_12_prd_end_dt IN DATE, c_12_prd_strt_dt IN DATE, c_param_value IN NUMBER) IS\n      with pntrtn_rate as\n             (select e9a95106e01380a7834d36560e919770.852fa1e9f02f1ca2c75837f7146b2381, e9a95106e01380a7834d36560e919770.839c4ffb4bfaae1bb58eab4dee67d96a,\n                    (SUM (NVL (e9a95106e01380a7834d36560e919770.2ee1400a0150f0b220dd7bd6268d1e66, 0))/nvl(98df5d6b623334f2e9631188cca4cfd6.46c15f2e85fafbfae0610bbb6710e373, l_param_value))/12 as cust_ttl_ptnl\n                from de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c s,\n                (SELECT DISTINCT DIV_NBR,CUST_NBR FROM de459e2fe7f96e4d958537b31b946b26.bb4fad8c05e6d50c9bbc691859c8f84376a46060b6abc8bd7ebc61fc049d1578)  c1,\n                     de459e2fe7f96e4d958537b31b946b26.d26d0e860281f1968d53c43aaaab9ae554a969d2d379cfdbd590ec1ebc278741 m, \n                     de459e2fe7f96e4d958537b31b946b26.52982d3bbc1ebc2720d9504c7ea2ed3f c,\n                     de459e2fe7f96e4d958537b31b946b26.dec387908a0954ddc8689c4ad37c8a3c div                                                             \n               where nvl(e9a95106e01380a7834d36560e919770.dd95a4741b2ab36b2428b3c42ef8b0448cd47113485ed05c776655af504ed664,e9a95106e01380a7834d36560e919770.839c4ffb4bfaae1bb58eab4dee67d96a) = 1ef1e03241fd3a9ca5a803b6fd417083.4fdc122fb2d10dd764e32cbc98972eca and 1ef1e03241fd3a9ca5a803b6fd417083.b8c6ab19cb6e726c38f24d1885346ea3 <> 'CC'   \n                 and 98df5d6b623334f2e9631188cca4cfd6.0e5400811a26142f22e82e8c549073a6(+) = d2450100e2dda59c2b7828b4daff7f8c.0e5400811a26142f22e82e8c549073a6 \n                 and e9a95106e01380a7834d36560e919770.852fa1e9f02f1ca2c75837f7146b2381 = d2450100e2dda59c2b7828b4daff7f8c.852fa1e9f02f1ca2c75837f7146b2381\n                 and e9a95106e01380a7834d36560e919770.839c4ffb4bfaae1bb58eab4dee67d96a = d2450100e2dda59c2b7828b4daff7f8c.839c4ffb4bfaae1bb58eab4dee67d96a\n                 and d2450100e2dda59c2b7828b4daff7f8c.839c4ffb4bfaae1bb58eab4dee67d96a = c6e0668f8899a92a5445cbb6d1e12bd8.839c4ffb4bfaae1bb58eab4dee67d96a\n                 and d2450100e2dda59c2b7828b4daff7f8c.852fa1e9f02f1ca2c75837f7146b2381 = c6e0668f8899a92a5445cbb6d1e12bd8.852fa1e9f02f1ca2c75837f7146b2381\n                 and XFER_TO_DT IS NULL\n                 and e9a95106e01380a7834d36560e919770.f5dd4374a3e3af6a775cb6d6b22e8162 BETWEEN l_12_prd_strt_dt AND l_12_prd_end_dt\n            group by e9a95106e01380a7834d36560e919770.852fa1e9f02f1ca2c75837f7146b2381, e9a95106e01380a7834d36560e919770.839c4ffb4bfaae1bb58eab4dee67d96a, avg_pntrtn_rate)\n     select e9a95106e01380a7834d36560e919770.6dd428a3f871172c89169d4cc67d9b90 rw,d2450100e2dda59c2b7828b4daff7f8c.839c4ffb4bfaae1bb58eab4dee67d96a,d2450100e2dda59c2b7828b4daff7f8c.852fa1e9f02f1ca2c75837f7146b2381,d2450100e2dda59c2b7828b4daff7f8c.0e5400811a26142f22e82e8c549073a6 as new_menu_typ_cd,e9a95106e01380a7834d36560e919770.0e5400811a26142f22e82e8c549073a6 as old_menu_typ_cd,aaa8ac27774f42d3fee3e769d8566bc8.5aeb276d6e88a3ea87ca7a7dd9ffa3a698df5d6b623334f2e9631188cca4cfd6,cust_ttl_ptnl,   \n               CASE\n                       WHEN d2450100e2dda59c2b7828b4daff7f8c.7c69e8dbcf1eb7c5ac686fa0156ed0ebcd29164cb73cbe96e5420c0f260e477e = 'N' AND NVL(5a8ba83b92507b51b8a983637834aad0.c67e714c50092871e215f33a602c124d339d6512d0af0b6fe1f57edcdf48f234,0) = 0 AND NVL(d2450100e2dda59c2b7828b4daff7f8c.692d5399871e27b127ba4e3b3b7320ca382d0f5d3019cd2839eb42d66c71274c,0) <> 0\n                       THEN d2450100e2dda59c2b7828b4daff7f8c.692d5399871e27b127ba4e3b3b7320ca382d0f5d3019cd2839eb42d66c71274c * l_fisc_wks_this_pd\n                       WHEN d2450100e2dda59c2b7828b4daff7f8c.7c69e8dbcf1eb7c5ac686fa0156ed0ebcd29164cb73cbe96e5420c0f260e477e = 'N' AND NVL(5a8ba83b92507b51b8a983637834aad0.c67e714c50092871e215f33a602c124d339d6512d0af0b6fe1f57edcdf48f234,0) <> 0\n                       THEN (00188d7b6099d6fea4f0f38e04574d7b.9cd2aa2a4161fda471ecbb591b3bd2f5fff9944709e8751521a61766c272dd58 / 52) * l_fisc_wks_this_pd\n                       WHEN 4fcab0626d2a3e4fc09b21cf8e6124c5.46a1d305db3a3ec822e32ba64d8368c9c355dee0d4b8b9ac1b8e508c590373d3 = 'Y' AND NVL(4fcab0626d2a3e4fc09b21cf8e6124c5.60b6d3b655afc3fa3fe57ec97a06d77ce7f1bb4487d12718c0cdcdefab6381f3,0) = 0 AND NVL(5a8ba83b92507b51b8a983637834aad0.c67e714c50092871e215f33a602c124d339d6512d0af0b6fe1f57edcdf48f234,0) <> 0\n                       THEN (00188d7b6099d6fea4f0f38e04574d7b.9cd2aa2a4161fda471ecbb591b3bd2f5fff9944709e8751521a61766c272dd58 / 52) * l_fisc_wks_this_pd\n                       WHEN 4fcab0626d2a3e4fc09b21cf8e6124c5.46a1d305db3a3ec822e32ba64d8368c9c355dee0d4b8b9ac1b8e508c590373d3 = 'Y' AND NVL(4fcab0626d2a3e4fc09b21cf8e6124c5.60b6d3b655afc3fa3fe57ec97a06d77ce7f1bb4487d12718c0cdcdefab6381f3,0) <> 0\n                       THEN  d2450100e2dda59c2b7828b4daff7f8c.692d5399871e27b127ba4e3b3b7320ca382d0f5d3019cd2839eb42d66c71274c * l_fisc_wks_this_pd\n                       ELSE cust_ttl_ptnl\n                       END new_ttl_mthly_ptnl,\n               e9a95106e01380a7834d36560e919770.07b97fa018e30cbd966f21c9e50dd5e9 as old_ttl_mthly_ptnl,\n               e9a95106e01380a7834d36560e919770.beb5785e3d7a9dbdf6a6bbfea7b99bb572b849fbff7c001c386aa148f05345ea old_ntl_avg_spnd_prcnt,\n               aaa8ac27774f42d3fee3e769d8566bc8.beb5785e3d7a9dbdf6a6bbfea7b99bb572b849fbff7c001c386aa148f05345ea  as new_ntl_avg_spnd_prcnt\n         from de459e2fe7f96e4d958537b31b946b26.52982d3bbc1ebc2720d9504c7ea2ed3f c,\n              de459e2fe7f96e4d958537b31b946b26.bb4fad8c05e6d50c9bbc691859c8f84376a46060b6abc8bd7ebc61fc049d1578 s,\n              de459e2fe7f96e4d958537b31b946b26.fcc55a82da91e429eaffc482050485ebe472b097974b0d6a9a7d2ed170324906 cm,\n              de459e2fe7f96e4d958537b31b946b26.163ed59da4f9e6a8bce446b0df2de84163f2fe9cc6b573bb859641780443a51b cat,\n              pntrtn_rate p\n        where d2450100e2dda59c2b7828b4daff7f8c.839c4ffb4bfaae1bb58eab4dee67d96a = e9a95106e01380a7834d36560e919770.839c4ffb4bfaae1bb58eab4dee67d96a\n          and e9a95106e01380a7834d36560e919770.852fa1e9f02f1ca2c75837f7146b2381 = e472b097974b0d6a9a7d2ed170324906.852fa1e9f02f1ca2c75837f7146b2381\n          and e9a95106e01380a7834d36560e919770.839c4ffb4bfaae1bb58eab4dee67d96a = e472b097974b0d6a9a7d2ed170324906.839c4ffb4bfaae1bb58eab4dee67d96a\n          and d2450100e2dda59c2b7828b4daff7f8c.852fa1e9f02f1ca2c75837f7146b2381 = e9a95106e01380a7834d36560e919770.852fa1e9f02f1ca2c75837f7146b2381\n          and aaa8ac27774f42d3fee3e769d8566bc8.0e5400811a26142f22e82e8c549073a6 = d2450100e2dda59c2b7828b4daff7f8c.0e5400811a26142f22e82e8c549073a6  \n          and aaa8ac27774f42d3fee3e769d8566bc8.5aeb276d6e88a3ea87ca7a7dd9ffa3a698df5d6b623334f2e9631188cca4cfd6 = e9a95106e01380a7834d36560e919770.5aeb276d6e88a3ea87ca7a7dd9ffa3a698df5d6b623334f2e9631188cca4cfd6\n          and d2450100e2dda59c2b7828b4daff7f8c.839c4ffb4bfaae1bb58eab4dee67d96a = 00188d7b6099d6fea4f0f38e04574d7b.839c4ffb4bfaae1bb58eab4dee67d96a (+)\n          and d2450100e2dda59c2b7828b4daff7f8c.852fa1e9f02f1ca2c75837f7146b2381 = 00188d7b6099d6fea4f0f38e04574d7b.852fa1e9f02f1ca2c75837f7146b2381 (+)\n          and 00188d7b6099d6fea4f0f38e04574d7b.17a7541ba0af7b39947d91f68f8cf748 (+) = 'Y'\n          and (d2450100e2dda59c2b7828b4daff7f8c.0e5400811a26142f22e82e8c549073a6 <> e9a95106e01380a7834d36560e919770.0e5400811a26142f22e82e8c549073a6    \n                or CASE\n                       WHEN d2450100e2dda59c2b7828b4daff7f8c.7c69e8dbcf1eb7c5ac686fa0156ed0ebcd29164cb73cbe96e5420c0f260e477e = 'N' AND NVL(5a8ba83b92507b51b8a983637834aad0.c67e714c50092871e215f33a602c124d339d6512d0af0b6fe1f57edcdf48f234,0) = 0 AND NVL(d2450100e2dda59c2b7828b4daff7f8c.692d5399871e27b127ba4e3b3b7320ca382d0f5d3019cd2839eb42d66c71274c,0) <> 0\n                       THEN  d2450100e2dda59c2b7828b4daff7f8c.692d5399871e27b127ba4e3b3b7320ca382d0f5d3019cd2839eb42d66c71274c * l_fisc_wks_this_pd\n                       WHEN d2450100e2dda59c2b7828b4daff7f8c.7c69e8dbcf1eb7c5ac686fa0156ed0ebcd29164cb73cbe96e5420c0f260e477e = 'N' AND NVL(5a8ba83b92507b51b8a983637834aad0.c67e714c50092871e215f33a602c124d339d6512d0af0b6fe1f57edcdf48f234,0) <> 0\n                       THEN (00188d7b6099d6fea4f0f38e04574d7b.9cd2aa2a4161fda471ecbb591b3bd2f5fff9944709e8751521a61766c272dd58 / 52) * l_fisc_wks_this_pd\n                       WHEN 4fcab0626d2a3e4fc09b21cf8e6124c5.46a1d305db3a3ec822e32ba64d8368c9c355dee0d4b8b9ac1b8e508c590373d3 = 'Y' AND NVL(4fcab0626d2a3e4fc09b21cf8e6124c5.60b6d3b655afc3fa3fe57ec97a06d77ce7f1bb4487d12718c0cdcdefab6381f3,0) = 0 AND NVL(5a8ba83b92507b51b8a983637834aad0.c67e714c50092871e215f33a602c124d339d6512d0af0b6fe1f57edcdf48f234,0) <> 0\n                       THEN (00188d7b6099d6fea4f0f38e04574d7b.9cd2aa2a4161fda471ecbb591b3bd2f5fff9944709e8751521a61766c272dd58 / 52) * l_fisc_wks_this_pd\n                       WHEN 4fcab0626d2a3e4fc09b21cf8e6124c5.46a1d305db3a3ec822e32ba64d8368c9c355dee0d4b8b9ac1b8e508c590373d3 = 'Y' AND NVL(4fcab0626d2a3e4fc09b21cf8e6124c5.60b6d3b655afc3fa3fe57ec97a06d77ce7f1bb4487d12718c0cdcdefab6381f3,0) <> 0\n                       THEN d2450100e2dda59c2b7828b4daff7f8c.692d5399871e27b127ba4e3b3b7320ca382d0f5d3019cd2839eb42d66c71274c * l_fisc_wks_this_pd\n                       ELSE cust_ttl_ptnl\n                       END <> nvl(e9a95106e01380a7834d36560e919770.8a541975069ba347bc75b7be6e718a8b,0));\n\n\n                  TYPE t_cust_summ IS TABLE OF cust_summ%rowtype;\n                      r_cust_summ               t_cust_summ;\nBEGIN\n\n\n    BEGIN\n\n     DBMS_OUTPUT.put_line ('Get Fisc Yr Mth from Sales_summ_cust_mrch Table');\n\n select distinct fisc_yr_mth\n into l_fisc_yr_mth\n from de459e2fe7f96e4d958537b31b946b26.bb4fad8c05e6d50c9bbc691859c8f84376a46060b6abc8bd7ebc61fc049d1578;\n\n\n    select max(clndr_dt)\n    INTO l_12_prd_end_dt\n    from de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001\n    where fisc_yr_mth in (\n          SELECT MAX (de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.2603c45be643e5cd8f9c6dad3bee6cb3)\n                 FROM de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001 a\n                 WHERE de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.2603c45be643e5cd8f9c6dad3bee6cb3 < (SELECT de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.2603c45be643e5cd8f9c6dad3bee6cb3\n                                           FROM de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001 a\n                                          WHERE de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.222ccb1d1746bcdb2365f29b3da0b613 = TRUNC (p_odate)));\n\n  DBMS_OUTPUT.put_line('End Date: '||l_12_prd_end_dt);\n\n     select min(clndr_dt)\n   into  l_12_prd_strt_dt\n     from de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001\n    where fisc_yr_mth in\n              (select  fisc_yr_mth - 100 as \"12_Mth_Ago\"\n                 from   de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001\n                 where  clndr_dt = trunc(p_odate));\n\n DBMS_OUTPUT.put_line('Start Date: '||l_12_prd_strt_dt);\n\n   EXCEPTION\n      WHEN OTHERS THEN\n        DBMS_OUTPUT.put_line ('No Data Found 0e03d5c46556a742ba46252698396ef2.aad5b6383877e92e377a8b7762bfc22e1142da7474c5333276de128373309516 is Empty');\n         RETURN 30;\n   END;\n\n\n select distinct fisc_wks_this_pd\n   into l_fisc_wks_this_pd\n  from de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001\n where fisc_yr_mth = l_fisc_yr_mth;\n\nDBMS_OUTPUT.put_line (\n            'fisc_yr_mth:' || l_fisc_yr_mth || ' fisc weeks this prd :'||l_fisc_wks_this_pd);\n\n SELECT   param_value_nbr\n   INTO   l_param_value\n   FROM   de459e2fe7f96e4d958537b31b946b26.de40ae7be8b2eb3858d46af8d107f3db\n WHERE   app_name = 'SALES_COVERAGE_MMA'\n   AND   param_type ='DEFAULT_PNTRTN_RATE';\n\n   OPEN cust_summ(l_fisc_wks_this_pd, l_12_prd_strt_dt, l_12_prd_end_dt, l_param_value);\n\n   LOOP\n     EXIT WHEN cust_summ%NOTFOUND;\n\nDBMS_OUTPUT.put_line ('loop');\n   FETCH cust_summ\n   BULK COLLECT INTO r_cust_summ LIMIT 1000;\n\n    forall i in  1 .. 2e941c2b2ae9c28c9905251308f052c6.26fd1c0cd65cf53eadf725ede4bbd5f1()\n        update de459e2fe7f96e4d958537b31b946b26.bb4fad8c05e6d50c9bbc691859c8f84376a46060b6abc8bd7ebc61fc049d1578 b\n      set  menu_typ_cd = r_cust_summ(i).new_menu_typ_cd,    \n           ttl_mthly_ptnl = r_cust_summ(i).new_ttl_mthly_ptnl,\n           ntl_avg_spnd_prcnt = r_cust_summ(i).new_ntl_avg_spnd_prcnt\n     where 6d9b37be5a083f8b78d676aba846c823.6dd428a3f871172c89169d4cc67d9b90 =  r_cust_summ(i).rw;\n     \n   DBMS_OUTPUT.put_line ('Rows Updated' ||SQL%rowcount);\n\n    END LOOP;\n\n\n    CLOSE cust_summ;\n\n    commit;\n    return 0;\n\nEXCEPTION\n    WHEN OTHERS\n    THEN\n        DBMS_OUTPUT.put_line (\n            'Error:' || SQLCODE || ' ' || SQLERRM);\n        RETURN 1;\n\nEND;\n/",
            "upstream_dependencies": [],
            "downstream_dependencies": [],
            "dag_location": "null",
            "gantt_location": "null",
            "created_at": "null",
            "updated_at": "null"
        },
        {
            "name": "FN_XDM_SALES_CORP_UPD_AP",
            "encrypted_name": "8a7dc331f2181d5e6ec25c055901932fa57ac70fbb19e03921766fa61d3932fb",
            "type": "function",
            "database": "null",
            "encrypted_database": "null",
            "schema": "XDMADM",
            "encrypted_schema": "0e03d5c46556a742ba46252698396ef2",
            "fully_qualified_name": "XDMADM.FN_XDM_SALES_CORP_UPD_AP",
            "encrypted_fqn": "0e03d5c46556a742ba46252698396ef2.8a7dc331f2181d5e6ec25c055901932fa57ac70fbb19e03921766fa61d3932fb",
            "synonyms": [],
            "metadata_analysis": "CREATE OR REPLACE FUNCTION \"0e03d5c46556a742ba46252698396ef2\".\"8a7dc331f2181d5e6ec25c055901932fa57ac70fbb19e03921766fa61d3932fb\" (\n                                P_IN_DIV_NBR    IN NUMBER,\n                                P_IN_SRC_TBL    IN VARCHAR2,\n                                P_IN_TGT_TBL    IN VARCHAR2,\n                                P_IN_START_DT   IN VARCHAR2,\n                                P_IN_END_DT     IN VARCHAR2,\n                                p_out_message   IN OUT VARCHAR2) RETURN NUMBER  IS\n\n\n   v_return_nbr              NUMBER         := 0;\n   v_err_msg                 VARCHAR2(32767) := NULL;\n   n_return_code             NUMBER         := 0;\n   v_return_message          VARCHAR2(32767) := NULL;\n\n   v_src_cnt                 NUMBER;\n   v_src_grs_sls             NUMBER;\n   v_src_qty_ship            NUMBER;\n   v_src_ttl_dvt             NUMBER;\n   v_src_prd_alw             NUMBER;\n   v_src_prd_chrg            NUMBER;\n   v_src_ttl_alwnc           NUMBER;\n\n   v_tgt_cnt                 NUMBER;\n   v_tgt_grs_sls             NUMBER;\n   v_tgt_qty_ship            NUMBER;\n   v_tgt_ttl_dvt             NUMBER;\n   v_tgt_prd_alw             NUMBER;\n   v_tgt_prd_chrg            NUMBER;\n   v_tgt_ttl_alwnc           NUMBER;\n\n   v_ins_sql1         VARCHAR2(32767);\n   v_ins_sql2         VARCHAR2(32767);\n   v_ins_sql3          VARCHAR2(32767);\n   v_ins_sql4          VARCHAR2(32767);\n   v_ins_sql5         VARCHAR2(32767);\n   v_ins_sql6         VARCHAR2(32767);\n\n   v_apwith_sql1   VARCHAR2(32767);\n   v_apwith_sql2   VARCHAR2(32767);\n   v_apwith_sql3   VARCHAR2(32767);\n\n   v_aptxn_sql1         VARCHAR2(32767);\n   v_aptxn_sql2         VARCHAR2(32767);\n   v_aptxn_sql3         VARCHAR2(32767);\n   v_aptxn_sql4         VARCHAR2(32767);\n   v_aptxn_sql5         VARCHAR2(32767);\n   v_aptxn_sql6         VARCHAR2(32767);\n   v_aptxn_sql7         VARCHAR2(32767);\n   v_aptxn_sql8         VARCHAR2(32767);\n\n   v_ap_addfilter_sql     VARCHAR2(32767);\n\n   v_div_nbr           NUMBER;\n   v_src_tbl           VARCHAR2(50);\n   v_tgt_tbl           VARCHAR2(50);\n   v_start_dt           VARCHAR2(12) := p_in_start_dt;\n   v_end_dt             VARCHAR2(12) := p_in_end_dt;\n   v_audt_sql1     VARCHAR2(2000);\n   v_audt_sql2     VARCHAR2(2000);\n\nBEGIN\n\n   v_div_nbr  := p_in_div_nbr;\n   v_src_tbl  := p_in_src_tbl;\n   v_tgt_tbl  := p_in_tgt_tbl;\n\nv_ins_sql1 := 'INSERT  INTO ' || v_tgt_tbl || ' (acct_typ_cd_actl, acct_typ_cd_desc_actl, actl_cst, actl_extnd, actl_gp, adj_markout, alw_chrg_cd, ' ||\n ' ap_cost, ap_gain, ap_vndr_nbr_actl, brk_srchrg, bsis_alw_amt, bsis_alw_applied, bsis_alw_ind, bsis_amt, carr_addr_txt, carr_alt_id, carr_alt_id_typ_cd, ' ||\n ' carr_city_nm, carr_cmnt, carr_cntct, carr_ctry_txt, carr_data_src_cd, carr_dot_nbr, carr_email_txt, carr_eqmt_mark_typ_cd, ' ||\n ' carr_fax_nbr, carr_inv_user_id, carr_motor_carr_nbr, carr_nm, carr_phn_nbr, carr_scac_cd, ';\n\nv_ins_sql2 := ' carr_st_cd, carr_stat_cd, carr_updt_dt, carr_updt_tm, carr_updt_user_id, carr_usf_nbr, carr_zip_cd, cde, cmpny_vndr_nbr_actl, cmsn_sls_extnd, ' ||\n ' cntrct_cpr_amt, cntrct_cpr_amt_ind, cntrct_cpr_bsis, cntrct_cpr_bsis_dt, cntrct_cpr_calc, cntrct_cpr_grp_typ, cntrct_cpr_nbr, cntrct_cpr_prod_grp, ' ||\n ' COMM_BSIS_AMT, corp_dvt_sls_base_rbt, corp_mlt_unit_desc_actl, corp_mlt_unit_nbr_actl, corp_non_dvt_sls_base_rbt, corp_prch_base_rbt, cr_dbt_rsn_cd, ' ||\n ' cr_dbt_rsn_desc, cr_memo_dlr, cr_memo_dt, cr_memo_dwa, cr_memo_nbr, cust_bus_seg_actl, cust_bus_seg_desc_actl, cust_nbr, cust_po_nbr, cust_prod_nbr, ' ||\n ' cust_sk, div_nbr, div_sk, dlvr_rte, dlvr_seq_nbr, drvr, dry_each, dry_unit, dry_wt, dstrct_cd_actl, dstrct_nm_actl, dstrct_sls_mgr_id_actl, ' ||\n ' dstrct_sls_mgr_nm_actl, ';\n\nv_ins_sql3 := ' dvt_cost_extnd, dwa_cost_extnd, each_conv_fctr, END_DAY_CD, each_ord, each_orig, each_prc, each_rsrv, each_ship, extnd_fctr, frght_cost, ' ||\n ' frz_each, frz_unit, frz_wt, gl_sbsys_cd, grs_sls_extnd, inside_pad, inv_actl_gp, inv_dt, inv_gp, inv_nbr, lagp_per_case, ldr, ldr_seq_nbr, ' ||\n ' ldr_tm, lic_prod_extnd, lic_tot_extnd, line_nbr, lnd_actl_gp, lnd_gp, loc_dvt_sls_base_rbt, loc_int_dvt, loc_mlt_unit_desc_actl, loc_mlt_unit_nbr_actl, '||\n ' loc_mrktng_alwnc_pgms, loc_non_dvt_sls_base_rbt, loc_one_tm, loc_prch_base_rbt, loc_prom_alwnc_pgms, loc_vndr_fnd_dvt, lpp, mkt_prod_extnd, ' ||\n ' mkt_tot_extnd, mrgn_bsis, natl_int_dvt, natl_mrktng_alwnc_pgms, natl_one_tm, natl_prom_alwnc_pgms, natl_vndr_fnd_dvt, net_sls_extnd, net_wt_ship, ' ||\n ' non_prod_alwnc, non_prod_alwnc_cd, non_prod_alwnc_desc, non_prod_chrg, non_prod_chrg_cd, non_prod_chrg_desc, ';\n\nv_ins_sql4 := ' ntv_cr_dbt_rsn_cd, ntv_cr_dbt_rsn_desc, ntv_ord_cls, ntv_ord_typ, ord_src, ord_tkr, orig_dwa_cost_extnd, orig_ldr_tm, orig_ord_dt, ' ||\n ' pick_slot_actl, pim_brnd_typ_actl, pim_brnd_typ_desc_actl, pim_cls_desc_actl, pim_cls_id_actl, pim_ctgry_desc_actl, ' ||\n ' pim_ctgry_id_actl, pim_grp_desc_actl, pim_grp_id_actl, pim_sk, pim_suprcls_desc_actl, pim_suprcls_id_actl, pim_usf_std_prod_cd, prc_mrgn, ' ||\n ' prc_src, prch_from_vndr_nbr_actl, prcs_dt, prime_aft_adj_dlr_amt, prime_aft_bsis_adj_amt, prime_aft_bsis_adj_ind, ' ||\n ' prime_bfr_adj_dlr_amt, prime_bfr_bsis_adj_amt, prime_bfr_bsis_adj_ind, prime_calc_ind, prime_cnh_cntrct_nbr, prime_cnh_prc_br_cd, ' ||\n ' prime_cns_cost_pt_mrk, prime_cns_cost_pt_rng, prime_cntrct_calc_bsis_amt, prime_cntrct_each_mrk_amt, prime_cntrct_each_mrk_typ, prime_cntrct_nm, ' ||\n ' prime_cntrct_prod_excpt_ind, prime_cost_by_po_nbr, prime_cust_prc_on_ind, prime_dvt_cost_amt, prime_dvt_cost_aply, prime_dvt_cost_typ, ';\n\nv_ins_sql5 := ' prime_dvtn_grp_nbr, prime_dvtn_grp_nm, prime_extnd_rbl_sis_amt, prime_frght_amt, prime_frght_bsis, prime_hcp_pim_cat, prime_hcp_pim_cls, ' ||\n' prime_hcp_pim_grp, prime_hcp_usf_std_prod_cd, prime_min_mrk_amt, prime_mrk_amt, prime_mrk_ind, prime_ord_orig_unit_prc, prime_prc_bsis, ' ||\n' prime_prc_bsis_amt, prime_prc_by, prime_prc_cost_tbl_eff_dt, prime_prc_cost_tbl_eff_tm, prime_rbl_sis_amt, prime_rbl_sis_mrgn, prime_rbl_sis_per, ' ||\n' prime_rnd_cd, prime_sbtyp_prc_by, prime_sis_flg, prime_updt_cyc, prnt_mlt_unit_cd_actl, prnt_mlt_unit_desc_actl, prod_alw, prod_alwnc_cd, ' ||\n' prod_alwnc_desc, prod_chrg, prod_chrg_cd, prod_chrg_desc, prod_nbr, prod_sk, prod_sls_tax, prod_stat_ind_actl, qty_dvt, qty_markout, qty_ord, ' ||\n' qty_orig, qty_rsrv, qty_ship, qty_subbed, rcrd_stat, rcvng_po_nbr, ';\n\nv_ins_sql6 := ' rep_cost_extnd, rfrgrt_each, rfrgrt_unit, rfrgrt_wt, rtd_ind, sample_ord_ind, ship_from, ship_to_id, sls_mrgn, sls_uom, srchrg, ' ||\n' sub_for, sub_prod_ind, tagp_per_case, tax_typ, tm_sk, trans_typ, trd_cls_actl, trtry_cd_actl, trtry_mgr_id_actl, trtry_mgr_nm_actl, ' ||\n' true_gp, true_mfr, ttl_alwnc, ttl_dvt, ttl_int_vndr_fnd_dvt, ttl_loc_alwnc, ttl_natl_alwnc, ttl_vndr_fnd_dvt, unfrm_qty_dvt, ' ||\n' unfrm_qty_markout, unfrm_qty_ord, unfrm_qty_orig, unfrm_qty_rsrv, unfrm_qty_ship, unfrm_qty_subbed, unit_ord, unit_orig, unit_prc, ' ||\n' unit_rsrv, unit_ship, xfer_from_dt, xfer_to_dt) ';\n\nv_apwith_sql1 := 'WITH first_rec AS (SELECT 17f1c830e0e4f4473714a895228afe97.7c11ab787cf6f310ca23c850e9034413e32f6dd38f333cde68119d1f277367cd,17f1c830e0e4f4473714a895228afe97.97ca09d0543afec109dac3f8d90db5305479098e904da91bb293c4391be1730d,17f1c830e0e4f4473714a895228afe97.7d5c34ff491d8080f7cce12ef8714e0c,17f1c830e0e4f4473714a895228afe97.5bbae4d36d584cb827876fa4cf42a7bfe32f6dd38f333cde68119d1f277367cd,17f1c830e0e4f4473714a895228afe97.a95d417d16e7214ab26b755260f9b58ae32f6dd38f333cde68119d1f277367cd,17f1c830e0e4f4473714a895228afe97.c822610ebab898cac56b201bbbbf3be0, ' ||\n' 17f1c830e0e4f4473714a895228afe97.76e1f04d1a3ab6533bd5dcf8b6682679932f120c97751cb6f536c08acbd63fcc,17f1c830e0e4f4473714a895228afe97.64598583bb1c514bf2374e1725ea8b0f,17f1c830e0e4f4473714a895228afe97.1ad8179bb058c680d70c6f9663dba4e7, 17f1c830e0e4f4473714a895228afe97.264e2d06211e3158081e62ae5103c845feddad254bfd5abc6373653d075ee11b,17f1c830e0e4f4473714a895228afe97.3377a56ac3a8caf2bec5d2e95319521429ba5ee45e1d87a256e3a1b57750a92a,17f1c830e0e4f4473714a895228afe97.5112ab47fb19df73f8ed2678ddc0ecdb34ceb39ae2f66f21170198c2e55391b5, ' ||\n' 17f1c830e0e4f4473714a895228afe97.07310c912dd99ea9c810de3167989b0f,17f1c830e0e4f4473714a895228afe97.1855265b91ccef6e842d6a431c0295fc,17f1c830e0e4f4473714a895228afe97.0054744cef9d8175c53e48a21807c4b4382d0f5d3019cd2839eb42d66c71274c,17f1c830e0e4f4473714a895228afe97.fecdf2b578d5771c3c985bce98c0022f1351bbde85c0ab91a84853573cd0dae5,17f1c830e0e4f4473714a895228afe97.90ac752a9aacd6b72bdb4028510b579d,17f1c830e0e4f4473714a895228afe97.7f599f836c449bebb92bb9757e86c603,  '||\n' 17f1c830e0e4f4473714a895228afe97.d55fbc4a3259962a8ab4fbedc0065134,17f1c830e0e4f4473714a895228afe97.e8a1b74c58655c6b8ffcb348b45f0a27,17f1c830e0e4f4473714a895228afe97.f3c7ed306cc6a6b3d6cfb40db08ba919e18a0efa177931495b66865407b6da30,17f1c830e0e4f4473714a895228afe97.58b87fef0b56bd2bd029967f2dfe55798b31ebbdd4a917cc13e004a9efd1e6bd,17f1c830e0e4f4473714a895228afe97.ae40ab54d363f05f40ae79e99066b4c9, ';\n\nv_apwith_sql2 := ' 17f1c830e0e4f4473714a895228afe97.d641e89de57ff11c5990f70965a7a09e1351bbde85c0ab91a84853573cd0dae5,17f1c830e0e4f4473714a895228afe97.1c3f9404c7ddd5254f4ab6865d0c9ae75479098e904da91bb293c4391be1730d,17f1c830e0e4f4473714a895228afe97.23e1fb1fa383dd566a7fa990e93f3b53f90adc90d03e80e5248398220ac3e975, 80c15249ee3f130f29772b090372d47d.99e791e1aafa049aec3923187c3b00221cf240fcaae44c33abd4128d66c11fd9, ' ||\n' 17f1c830e0e4f4473714a895228afe97.995423505a0670f0daf31417466a6833, 17f1c830e0e4f4473714a895228afe97.e0ebc2677f8d7eb0a98246b4cb3db329, 17f1c830e0e4f4473714a895228afe97.8708a839c00cf7a8852df326dbe38f05382d0f5d3019cd2839eb42d66c71274c,17f1c830e0e4f4473714a895228afe97.8df6e6099ebb67df7a104f33cfbeae411351bbde85c0ab91a84853573cd0dae5,17f1c830e0e4f4473714a895228afe97.106cff97a417dbe6c4979d1de5e4bc76382d0f5d3019cd2839eb42d66c71274c,17f1c830e0e4f4473714a895228afe97.74b5cefda7cf1a7db3f0a3091333ac05,17f1c830e0e4f4473714a895228afe97.c51ab05c6acd87cdbf495339cf5496c0dfb673c032e1fff141ac84551b91849a, ' ||\n' 17f1c830e0e4f4473714a895228afe97.80f3b424d7258a583f0dff0f4d4b159d382d0f5d3019cd2839eb42d66c71274c, 17f1c830e0e4f4473714a895228afe97.f97b65e019a6572a4dfbc160d1d868ff382d0f5d3019cd2839eb42d66c71274c,17f1c830e0e4f4473714a895228afe97.b5e1ce6b2ac430bf504b82957a3e2685,17f1c830e0e4f4473714a895228afe97.00d89839907d0ecec58003008d2713675479098e904da91bb293c4391be1730d, 17f1c830e0e4f4473714a895228afe97.21a6675858ce67d43a7b6513100e2930dfb673c032e1fff141ac84551b91849a, 17f1c830e0e4f4473714a895228afe97.4b398d884e397727aeb50b1bf2299e60f6283ea3dfab0ee7d1d005a13bf2d220, ' ||\n' 17f1c830e0e4f4473714a895228afe97.d6feb3ce3930e1df4568d8ad2e34234a601fa525a9ae6adbe4075e99e3bc2cf7, 17f1c830e0e4f4473714a895228afe97.5614e3e3773aa0cc945f4ce3d7f55482601fa525a9ae6adbe4075e99e3bc2cf7,17f1c830e0e4f4473714a895228afe97.d4b886ec9db9850e79e0b6d4cf1585d4,17f1c830e0e4f4473714a895228afe97.d89005a8280032bffbf811a9534ce895e32ad436514bbe822b33de8bead744f3, 17f1c830e0e4f4473714a895228afe97.9b5a3fd0647f1b6d616bd47466949ec2, 17f1c830e0e4f4473714a895228afe97.69cc3d229f9a1af0e9235eb598b0b176, ';\n\nv_apwith_sql3 := ' 17f1c830e0e4f4473714a895228afe97.9e023e08ce376b6e1b1b18dfa1cd167a11f37ee054443a481b60681df215350c,17f1c830e0e4f4473714a895228afe97.e8175059b727a2e4e5a33fb6528a9eec, 17f1c830e0e4f4473714a895228afe97.b894aa64cb1e7288637754771f2d1b0633709dad7fa5eac8c1c3486b35956c3e, 17f1c830e0e4f4473714a895228afe97.ffe40dcb6bc0e52a6e16f71f92936b55,17f1c830e0e4f4473714a895228afe97.55758ba3499240fc41103cdeb54dabdcce26a64a7ac8d188835efcbfda026222,17f1c830e0e4f4473714a895228afe97.02c48591889a5fa84ba70163595e3cd4cd0030bf918e8eee8bdc28cab59f8e90, 17f1c830e0e4f4473714a895228afe97.677b20030e97fe7a072c96e3023ab27b75a332bf028585250008d9183409dc25,17f1c830e0e4f4473714a895228afe97.896062ff14ee1e0e09184e57f315ec807e8fe841f8abc0a126967273be28f1b7,17f1c830e0e4f4473714a895228afe97.896062ff14ee1e0e09184e57f315ec8098df5d6b623334f2e9631188cca4cfd6,  17f1c830e0e4f4473714a895228afe97.559effe9c0b926e97c1a592970005d05e32f6dd38f333cde68119d1f277367cd,17f1c830e0e4f4473714a895228afe97.c75cfeffaba16c33a08fd34fd23f01971d731bbdc4e3fb69a854112d4982eb99,17f1c830e0e4f4473714a895228afe97.085ad920c0177cbda11e444d47a41c95e9a95106e01380a7834d36560e919770, ' ||\n ' 17f1c830e0e4f4473714a895228afe97.36e83390e6cef790558b8ec37de1f4fee472b097974b0d6a9a7d2ed170324906,17f1c830e0e4f4473714a895228afe97.210f742c7a4e17979d08976db76abf6f, 17f1c830e0e4f4473714a895228afe97.72fe1ee604357ed2ad1717cc673f8d1b,17f1c830e0e4f4473714a895228afe97.3b18c8d346bdbe03ccf6d8560029ef43,17f1c830e0e4f4473714a895228afe97.4545f9b55765471ccd2e57bda93403c8d24b2fb1eee3864a9486359f68c4e118,17f1c830e0e4f4473714a895228afe97.7e96684bc4ed02b9ccf63d2f52a43b84e6e6300089dae5a98e31814d0406060f,17f1c830e0e4f4473714a895228afe97.6a04130b896c82c2b3b22b337cad2a56,  17f1c830e0e4f4473714a895228afe97.975e3b626d2e6ca06ed84fbbc5558de3bff56d587bce01d32a3d5e44d29ed4fa,17f1c830e0e4f4473714a895228afe97.ccc371b06f1e0daed88f223211b2e790,17f1c830e0e4f4473714a895228afe97.6a57525895fd55cd1da456566ea80c1d,17f1c830e0e4f4473714a895228afe97.5b166c5fe66db413f1e228635901a0965479098e904da91bb293c4391be1730d,17f1c830e0e4f4473714a895228afe97.9033b904a17dc722bf77fb076a267f1529ba5ee45e1d87a256e3a1b57750a92a, ' ||\n ' 17f1c830e0e4f4473714a895228afe97.49dbc899bc8f9659472a5a3b3510790c,17f1c830e0e4f4473714a895228afe97.deeb4c7020bbcfd9e70cb4a8ed6ea0dc,17f1c830e0e4f4473714a895228afe97.ca329b170a83f14795f7d01859b0fe42,17f1c830e0e4f4473714a895228afe97.a4657a147b058328748c801964a53707,17f1c830e0e4f4473714a895228afe97.a00b7aac034b1de6ebfabe4a7097af1b3c072b0281819f75f19257cd7009a1b3, 17f1c830e0e4f4473714a895228afe97.b391f718d41b76652cd5f0d0063372b5, 17f1c830e0e4f4473714a895228afe97.839c4ffb4bfaae1bb58eab4dee67d96a, 17f1c830e0e4f4473714a895228afe97.d1ce6707c3d1cc0e57096fdc21a5e64f, '||\n ' 17f1c830e0e4f4473714a895228afe97.be8d7c2ea76d3152927ebf8709ea0326, 17f1c830e0e4f4473714a895228afe97.2d45d761eb8d137835bca7a23010fab4, 17f1c830e0e4f4473714a895228afe97.852fa1e9f02f1ca2c75837f7146b2381, 17f1c830e0e4f4473714a895228afe97.63a91e2fd122990392b8c1467a67b61e, 17f1c830e0e4f4473714a895228afe97.4c5fd6201abd060f4708bd2893dacabadfb673c032e1fff141ac84551b91849a, 17f1c830e0e4f4473714a895228afe97.26ac88e7ae671a1b22c14c2fce77aa2d, 17f1c830e0e4f4473714a895228afe97.caa2824077535938efbfeab4179ac71d, 17f1c830e0e4f4473714a895228afe97.abfa8e82cd46bbb827127b6cb2f5d6d5, 17f1c830e0e4f4473714a895228afe97.b7a93c415ffd854911e38dbd0033808a,17f1c830e0e4f4473714a895228afe97.370a5aec6c948b64a7638f194c6ea1a7, ' ||\n ' 17f1c830e0e4f4473714a895228afe97.d5506821c4ea14a4d9ee0f0ce4e7652d,17f1c830e0e4f4473714a895228afe97.f2afece23955e23b9d2f09fce0b18c61382d0f5d3019cd2839eb42d66c71274c,17f1c830e0e4f4473714a895228afe97.49a0a9be0a1154a8d1362e9b1213782e0f94938f8d42ec5a784edd3e75fceb1b, 17f1c830e0e4f4473714a895228afe97.0c499b9342241191d5d5fc19d9822401382d0f5d3019cd2839eb42d66c71274c, 17f1c830e0e4f4473714a895228afe97.f5dd4374a3e3af6a775cb6d6b22e8162, 17f1c830e0e4f4473714a895228afe97.8b8c72c349530db846280000957f636d, 17f1c830e0e4f4473714a895228afe97.f4684b698d1e8edd11bf71d8eac02595, rank() OVER ' ||\n ' (PARTITION BY 17f1c830e0e4f4473714a895228afe97.839c4ffb4bfaae1bb58eab4dee67d96a, 17f1c830e0e4f4473714a895228afe97.be8d7c2ea76d3152927ebf8709ea0326, 17f1c830e0e4f4473714a895228afe97.2d45d761eb8d137835bca7a23010fab4, 17f1c830e0e4f4473714a895228afe97.852fa1e9f02f1ca2c75837f7146b2381, 17f1c830e0e4f4473714a895228afe97.f5dd4374a3e3af6a775cb6d6b22e8162 ORDER BY 17f1c830e0e4f4473714a895228afe97.d1ce6707c3d1cc0e57096fdc21a5e64f, 17f1c830e0e4f4473714a895228afe97.0e55e137a02bb10fcd61e2ad9262eeee) as ldrtm_ranking ' ||\n ' FROM ' || v_src_tbl || ' slc  WHERE 17f1c830e0e4f4473714a895228afe97.26ac88e7ae671a1b22c14c2fce77aa2d IN (''RT'',''VS'',''WC'',''CD'') ' ||\n ' AND ((17f1c830e0e4f4473714a895228afe97.2633936e94c628e8eb6e5631ec0c5768 IS NULL AND 17f1c830e0e4f4473714a895228afe97.5a10715569533ce7e5409867b2262134 IS NULL) OR (17f1c830e0e4f4473714a895228afe97.2633936e94c628e8eb6e5631ec0c5768=0 AND 17f1c830e0e4f4473714a895228afe97.5a10715569533ce7e5409867b2262134=0)) ' ||\n ' AND 17f1c830e0e4f4473714a895228afe97.f5dd4374a3e3af6a775cb6d6b22e8162 BETWEEN ''' || v_start_dt || ''' AND ''' || v_end_dt || ''')';\n\nv_aptxn_sql1 := ' SELECT 17f1c830e0e4f4473714a895228afe97.7c11ab787cf6f310ca23c850e9034413e32f6dd38f333cde68119d1f277367cd,17f1c830e0e4f4473714a895228afe97.97ca09d0543afec109dac3f8d90db5305479098e904da91bb293c4391be1730d,d19b9362bad81ce264aea08ea7ccfe0e.21c984990c46996e1ca85db8ed7b326f,d19b9362bad81ce264aea08ea7ccfe0e.d16361da5462bcd47e380bc6594c4a0b,d19b9362bad81ce264aea08ea7ccfe0e.1afca342ab89e5b8c65c6c4c634b2186,d19b9362bad81ce264aea08ea7ccfe0e.46b0f23abe1bbed246cdeae858a9d7c0,17f1c830e0e4f4473714a895228afe97.7d5c34ff491d8080f7cce12ef8714e0c, ' ||\n' d19b9362bad81ce264aea08ea7ccfe0e.879553e6f3c76406b6c8d29e37a2e69a,d19b9362bad81ce264aea08ea7ccfe0e.518556df822338be02791d180820e13d,NVL(17f1c830e0e4f4473714a895228afe97.5bbae4d36d584cb827876fa4cf42a7bfe32f6dd38f333cde68119d1f277367cd,''0000000''),d19b9362bad81ce264aea08ea7ccfe0e.2900b8b236fcbe8e44fe5fcfac669c47,d19b9362bad81ce264aea08ea7ccfe0e.b504056baae1285c544838b332f2aca8,17f1c830e0e4f4473714a895228afe97.a95d417d16e7214ab26b755260f9b58ae32f6dd38f333cde68119d1f277367cd,17f1c830e0e4f4473714a895228afe97.c822610ebab898cac56b201bbbbf3be0, ' ||\n' d19b9362bad81ce264aea08ea7ccfe0e.fd14faf665d1fba59e286a758cfc3f36,d19b9362bad81ce264aea08ea7ccfe0e.d177076d05b72fe78cc13e30e11297c3,d19b9362bad81ce264aea08ea7ccfe0e.44a426a92c76e990f2c56bbb0de32572,d19b9362bad81ce264aea08ea7ccfe0e.bd944ad07a61f08a440316f300f49e5e51dd26a73c58dc7a9a33b2c1a62da4d3,d19b9362bad81ce264aea08ea7ccfe0e.14c7293453586609fa21a9e804c67eb4,d19b9362bad81ce264aea08ea7ccfe0e.573c1824f5c3781a8948011d0d6c3ba0,d19b9362bad81ce264aea08ea7ccfe0e.256c83b1469edbf80b14f57cca8165ae,d19b9362bad81ce264aea08ea7ccfe0e.de9589972fae450afab915cf8cb14f35, ' ||\n' d19b9362bad81ce264aea08ea7ccfe0e.c4287395385650d3d248e8156d4567fce32f6dd38f333cde68119d1f277367cd,d19b9362bad81ce264aea08ea7ccfe0e.148c3c4861243c3f12c31758272b07c8,d19b9362bad81ce264aea08ea7ccfe0e.ade04172dd0f8d09e65cf48322dce6dc,d19b9362bad81ce264aea08ea7ccfe0e.402439cf67ca5cfb8f1a0fcd4b2b57232d455cc26a95f84625118b8a36838b8e,d19b9362bad81ce264aea08ea7ccfe0e.15ff7b1b1e28686e2149bef07efdc76f,d19b9362bad81ce264aea08ea7ccfe0e.434a532d8f1cef2bd0fd568bb6b6caf6e32f6dd38f333cde68119d1f277367cd,d19b9362bad81ce264aea08ea7ccfe0e.9c99f24fffd97c0c09611fa2974b4ab461bbd7bc0d2d67c7d7b11cb0a8d18d03, ' ||\n' d19b9362bad81ce264aea08ea7ccfe0e.5938af20283ebdf83028907a807f67fd,d19b9362bad81ce264aea08ea7ccfe0e.27f4ff9d0a4a317e520e8da1e1945338,d19b9362bad81ce264aea08ea7ccfe0e.b642618fb5eebe48633e5a178b756487,d19b9362bad81ce264aea08ea7ccfe0e.d9b9c5751b188cc971fb6f5b0300aa48,d19b9362bad81ce264aea08ea7ccfe0e.57ba888a8306534b2dd97cec40a0e9bf,d19b9362bad81ce264aea08ea7ccfe0e.b82d2514c0cd80b4085c0ce92d576b5e,d19b9362bad81ce264aea08ea7ccfe0e.72d511475d7f9d12b8b9cc719bb17c21, ';\n\nv_aptxn_sql2 := ' d19b9362bad81ce264aea08ea7ccfe0e.73e2bcc2359fe903f78484b1e3b30d39fce896ca0fbbf5a5d330f2803036eb44,d19b9362bad81ce264aea08ea7ccfe0e.1b3974313149f303f5e793165a21379b,d19b9362bad81ce264aea08ea7ccfe0e.7e3de7c40f0ad40445e80e83750bf747,d19b9362bad81ce264aea08ea7ccfe0e.adf5289e9a866af8b69b5e9d035b790b,NVL(17f1c830e0e4f4473714a895228afe97.4c5fd6201abd060f4708bd2893dacabadfb673c032e1fff141ac84551b91849a,0),d19b9362bad81ce264aea08ea7ccfe0e.a793addd328c78704a7e0e45ea3001d4,d19b9362bad81ce264aea08ea7ccfe0e.2ba3341ec6405c796e064d0d56de134d, ' ||\n' 17f1c830e0e4f4473714a895228afe97.76e1f04d1a3ab6533bd5dcf8b6682679932f120c97751cb6f536c08acbd63fcc,17f1c830e0e4f4473714a895228afe97.64598583bb1c514bf2374e1725ea8b0f,17f1c830e0e4f4473714a895228afe97.b894aa64cb1e7288637754771f2d1b0633709dad7fa5eac8c1c3486b35956c3e,17f1c830e0e4f4473714a895228afe97.51a81ef30e84b502295c6528bdc86143,d19b9362bad81ce264aea08ea7ccfe0e.4af993e73e888cc9b53304f9d31806e075a332bf028585250008d9183409dc25,17f1c830e0e4f4473714a895228afe97.1ad8179bb058c680d70c6f9663dba4e7, ' ||\n' 17f1c830e0e4f4473714a895228afe97.264e2d06211e3158081e62ae5103c845feddad254bfd5abc6373653d075ee11b,0 as comm_bsis_amt,d19b9362bad81ce264aea08ea7ccfe0e.01114b0b258a9dd7a6bb11579f76b0f55cb85c0b89d2f6a64dbcbd9b2c83fb90,17f1c830e0e4f4473714a895228afe97.3377a56ac3a8caf2bec5d2e95319521429ba5ee45e1d87a256e3a1b57750a92a,17f1c830e0e4f4473714a895228afe97.5112ab47fb19df73f8ed2678ddc0ecdb34ceb39ae2f66f21170198c2e55391b5, ' ||\n' d19b9362bad81ce264aea08ea7ccfe0e.18359c91426b88e025cb389d4ba884d3cab538eaa715f7ec4a49d35342504bda,d19b9362bad81ce264aea08ea7ccfe0e.0d90dd7ce0016ac875611e81ff7dd7f040ac87632f536029556cbb1d9cc5b05b,17f1c830e0e4f4473714a895228afe97.07310c912dd99ea9c810de3167989b0f,17f1c830e0e4f4473714a895228afe97.1855265b91ccef6e842d6a431c0295fc,d19b9362bad81ce264aea08ea7ccfe0e.582bd9075c3cdfa71b2052bbedf48cd5,d19b9362bad81ce264aea08ea7ccfe0e.666f5a215737b7caeb73d3450f23b384, ' ||\n' d19b9362bad81ce264aea08ea7ccfe0e.c3f74ba437664ccb638c59297216940a,d19b9362bad81ce264aea08ea7ccfe0e.d1ce6707c3d1cc0e57096fdc21a5e64f,17f1c830e0e4f4473714a895228afe97.0054744cef9d8175c53e48a21807c4b4382d0f5d3019cd2839eb42d66c71274c,17f1c830e0e4f4473714a895228afe97.fecdf2b578d5771c3c985bce98c0022f1351bbde85c0ab91a84853573cd0dae5,d19b9362bad81ce264aea08ea7ccfe0e.852fa1e9f02f1ca2c75837f7146b2381,d19b9362bad81ce264aea08ea7ccfe0e.90680862928e1dcb55a4787b6ef9f3c2,17f1c830e0e4f4473714a895228afe97.90ac752a9aacd6b72bdb4028510b579d,17f1c830e0e4f4473714a895228afe97.7f599f836c449bebb92bb9757e86c603, ' ||\n' d19b9362bad81ce264aea08ea7ccfe0e.839c4ffb4bfaae1bb58eab4dee67d96a,d19b9362bad81ce264aea08ea7ccfe0e.fa741a84bd7a01a1c4b5dc91364baac5,d19b9362bad81ce264aea08ea7ccfe0e.c4ffe3bd27523a268da639921856c18e,d19b9362bad81ce264aea08ea7ccfe0e.f971ad6dea1e4dd7fd2fbd36d31a3ae5,d19b9362bad81ce264aea08ea7ccfe0e.20f36943212d3ebf01d42fc2a58a878e,d19b9362bad81ce264aea08ea7ccfe0e.7e33db42f9c57a6374e01e1886e762b2,d19b9362bad81ce264aea08ea7ccfe0e.b204827e6d3f8c94592eef11de23cb12,d19b9362bad81ce264aea08ea7ccfe0e.11212ff4cad5193c5fabb7a5d519894b, ';\n\nv_aptxn_sql3 := ' 17f1c830e0e4f4473714a895228afe97.d55fbc4a3259962a8ab4fbedc0065134,17f1c830e0e4f4473714a895228afe97.e8a1b74c58655c6b8ffcb348b45f0a27,17f1c830e0e4f4473714a895228afe97.f3c7ed306cc6a6b3d6cfb40db08ba919e18a0efa177931495b66865407b6da30,17f1c830e0e4f4473714a895228afe97.58b87fef0b56bd2bd029967f2dfe55798b31ebbdd4a917cc13e004a9efd1e6bd,d19b9362bad81ce264aea08ea7ccfe0e.237609d37bbd0b9a205aa95e75daf38b, ' ||\n' d19b9362bad81ce264aea08ea7ccfe0e.c6c7cc45578c678907522e08bb04a4ca,17f1c830e0e4f4473714a895228afe97.ae40ab54d363f05f40ae79e99066b4c9,NULL as END_DAY_CD,d19b9362bad81ce264aea08ea7ccfe0e.d4e40e976e264ee8a5a57f4f800d6c3b,d19b9362bad81ce264aea08ea7ccfe0e.1b4f3e751f125481ce5a66b8a939dec8,d19b9362bad81ce264aea08ea7ccfe0e.0cba16030608e3ed20685d2d8baffd65,d19b9362bad81ce264aea08ea7ccfe0e.233e8c6acbaa45d323ec940cedfa07b4,d19b9362bad81ce264aea08ea7ccfe0e.baa23b8932072303310f88d528c93b04,d19b9362bad81ce264aea08ea7ccfe0e.d522ff7fd338224e811132198cf36dfe, ' ||\n' d19b9362bad81ce264aea08ea7ccfe0e.caa7253bb26c1be62d920c15aa47acc7,d19b9362bad81ce264aea08ea7ccfe0e.54edae7157431b18e6d2baa702518a1c,d19b9362bad81ce264aea08ea7ccfe0e.f7a32a3094075407e6262fa7b4099334,d19b9362bad81ce264aea08ea7ccfe0e.db506a9e456768af2c1d2fe201b53b40,d19b9362bad81ce264aea08ea7ccfe0e.94885bbd805e611e54ee0eb5fb602d46,d19b9362bad81ce264aea08ea7ccfe0e.2ee1400a0150f0b220dd7bd6268d1e66,d19b9362bad81ce264aea08ea7ccfe0e.47d7f1b55574f6efb03d7bd7c85359bf,d19b9362bad81ce264aea08ea7ccfe0e.8a3a832e9ed55880c82a6085970dfe5d,d19b9362bad81ce264aea08ea7ccfe0e.faaaf9cbe8897987592d529a771bbc17,d19b9362bad81ce264aea08ea7ccfe0e.b89d8f9a5bec26add637853438d6311f, ' ||\n' d19b9362bad81ce264aea08ea7ccfe0e.be8d7c2ea76d3152927ebf8709ea0326,d19b9362bad81ce264aea08ea7ccfe0e.594b02cf2e907a3b818937eeeb74f778,d19b9362bad81ce264aea08ea7ccfe0e.d57db2a07c9cf48d0fc5985b35080af3,d19b9362bad81ce264aea08ea7ccfe0e.f49440ef078632ba0e0dd973e4161bbd ,d19b9362bad81ce264aea08ea7ccfe0e.721a8ad171b31ae60261431ccd51b52d as ap_ldr_tm,d19b9362bad81ce264aea08ea7ccfe0e.ef84040ad09159c2ca7623e36c53c140,d19b9362bad81ce264aea08ea7ccfe0e.27927710671f59a6b0cb9e9107e333f4,d19b9362bad81ce264aea08ea7ccfe0e.0e55e137a02bb10fcd61e2ad9262eeee,d19b9362bad81ce264aea08ea7ccfe0e.c4e3a9f99fa6f955de390a93819085ae, ' ||\n' d19b9362bad81ce264aea08ea7ccfe0e.aae449a432058ba773088445191b55b8,d19b9362bad81ce264aea08ea7ccfe0e.f365b04dc92a1e1022e0319f12fb190d5704aa90e6338e2d3416f309dfed02a4,d19b9362bad81ce264aea08ea7ccfe0e.931b2ac4399b8a337f8d0ff67bab0e15,17f1c830e0e4f4473714a895228afe97.d641e89de57ff11c5990f70965a7a09e1351bbde85c0ab91a84853573cd0dae5,17f1c830e0e4f4473714a895228afe97.1c3f9404c7ddd5254f4ab6865d0c9ae75479098e904da91bb293c4391be1730d,d19b9362bad81ce264aea08ea7ccfe0e.3f5f78a3c918316a0e68170dc6b81e0c7ea8b5b6353c726ed7e410e230c7898b, ' ||\n' d19b9362bad81ce264aea08ea7ccfe0e.96c68874ad1f02f292e30bc4034782949b55b8a266a9bb8e1e539a4ced76ec35,d19b9362bad81ce264aea08ea7ccfe0e.42c87cd307c51e63a144309315721b09,d19b9362bad81ce264aea08ea7ccfe0e.b2073366c46944d57f4d0f649386cab31d731bbdc4e3fb69a854112d4982eb99,d19b9362bad81ce264aea08ea7ccfe0e.df0917aa3fd36489aa4d308fa97b06b76398e8624834825f4604477ca9ac3d8a,d19b9362bad81ce264aea08ea7ccfe0e.c137fdd918ede20e07fec7282883fa34e32f6dd38f333cde68119d1f277367cd, d19b9362bad81ce264aea08ea7ccfe0e.519b0b49b712aeada6335135be5ed90c, ';\n\nv_aptxn_sql4 := ' d19b9362bad81ce264aea08ea7ccfe0e.ba123fb99b0591dc3db0219d097aa590,d19b9362bad81ce264aea08ea7ccfe0e.46930193dd6f47d2a8ad6a585e4f0be5,17f1c830e0e4f4473714a895228afe97.69cc3d229f9a1af0e9235eb598b0b176,d19b9362bad81ce264aea08ea7ccfe0e.42dd45423319f918e704ed37d4dbb128,d19b9362bad81ce264aea08ea7ccfe0e.5e937026da90c7e4a4e0bb540e061948eed1259e6b62783c664a0bc2e5e255a4,d19b9362bad81ce264aea08ea7ccfe0e.11da749d2c0d1e21a4c413489daad454, ' ||\n' d19b9362bad81ce264aea08ea7ccfe0e.7321a4c88369e6acc22f8952a98e86b3e7fabc080d1e698e1941d756c183e979,d19b9362bad81ce264aea08ea7ccfe0e.b5019e4009d6240fe25b80db390c07601d731bbdc4e3fb69a854112d4982eb99,d19b9362bad81ce264aea08ea7ccfe0e.eacf342f9cfeb8791c58f614d70fdd7e,d19b9362bad81ce264aea08ea7ccfe0e.b215402101f7a4f20fccac979c4d9b44,d19b9362bad81ce264aea08ea7ccfe0e.2dfeefdbbdd44f6feceb5ad393352003,d19b9362bad81ce264aea08ea7ccfe0e.1f74f0b1b8d3cc48e46d09d810561baafce896ca0fbbf5a5d330f2803036eb44, ' ||\n' d19b9362bad81ce264aea08ea7ccfe0e.08ebf39fae82b72111b91ad0e9d1b680f90adc90d03e80e5248398220ac3e975,d19b9362bad81ce264aea08ea7ccfe0e.bd428d343074503f124765bf6dd4405a,d19b9362bad81ce264aea08ea7ccfe0e.a314fdf09456ce4ec24e4a372aadfac4e32f6dd38f333cde68119d1f277367cd,d19b9362bad81ce264aea08ea7ccfe0e.0a2c5dcda219e7ce0b7d359c1288af1815ebda0b6e5cc8d4c919a8c71a9d07e4,d19b9362bad81ce264aea08ea7ccfe0e.645527f9434dbbc31dc6645c85255afffce896ca0fbbf5a5d330f2803036eb44,17f1c830e0e4f4473714a895228afe97.23e1fb1fa383dd566a7fa990e93f3b53f90adc90d03e80e5248398220ac3e975, ' ||\n' d19b9362bad81ce264aea08ea7ccfe0e.9a862ca7920244817a1ea140c51520d3,17f1c830e0e4f4473714a895228afe97.995423505a0670f0daf31417466a6833,d19b9362bad81ce264aea08ea7ccfe0e.73fc2afbbbce75dfdb12e62a0b628ace,d19b9362bad81ce264aea08ea7ccfe0e.4f53412a65a5d5ad453a0fed47eff7e2,d19b9362bad81ce264aea08ea7ccfe0e.192a0b9848c9b555676e26cadfe60852280a4c8731f60bb762471fb74030c9a2,d19b9362bad81ce264aea08ea7ccfe0e.721a8ad171b31ae60261431ccd51b52d as orig_ldr_tm,d19b9362bad81ce264aea08ea7ccfe0e.114e45b0f4a93a24527076d8af10c847, 17f1c830e0e4f4473714a895228afe97.e0ebc2677f8d7eb0a98246b4cb3db329, ' ||\n' NVL(17f1c830e0e4f4473714a895228afe97.8708a839c00cf7a8852df326dbe38f05382d0f5d3019cd2839eb42d66c71274c,9), NVL(17f1c830e0e4f4473714a895228afe97.8df6e6099ebb67df7a104f33cfbeae411351bbde85c0ab91a84853573cd0dae5,''UNKNOWN''), NVL(17f1c830e0e4f4473714a895228afe97.106cff97a417dbe6c4979d1de5e4bc76382d0f5d3019cd2839eb42d66c71274c,''UNKNOWN''), NVL(17f1c830e0e4f4473714a895228afe97.74b5cefda7cf1a7db3f0a3091333ac05,99999), ' ||\n' NVL(17f1c830e0e4f4473714a895228afe97.c51ab05c6acd87cdbf495339cf5496c0dfb673c032e1fff141ac84551b91849a,''UNKNOWN''), NVL(17f1c830e0e4f4473714a895228afe97.80f3b424d7258a583f0dff0f4d4b159d382d0f5d3019cd2839eb42d66c71274c,99999),  NVL(17f1c830e0e4f4473714a895228afe97.f97b65e019a6572a4dfbc160d1d868ff382d0f5d3019cd2839eb42d66c71274c,''UNKNOWN''), NVL(17f1c830e0e4f4473714a895228afe97.b5e1ce6b2ac430bf504b82957a3e2685,99999), 17f1c830e0e4f4473714a895228afe97.8b8c72c349530db846280000957f636d, ' ||\n' NVL(17f1c830e0e4f4473714a895228afe97.00d89839907d0ecec58003008d2713675479098e904da91bb293c4391be1730d,''UNKNOWN''), NVL(17f1c830e0e4f4473714a895228afe97.21a6675858ce67d43a7b6513100e2930dfb673c032e1fff141ac84551b91849a,99999), d19b9362bad81ce264aea08ea7ccfe0e.d3268eabc4a7d98105fd85f9c9e62cd6e32ad436514bbe822b33de8bead744f3, d19b9362bad81ce264aea08ea7ccfe0e.3fe9d5910e4aa2a286626346047912cd,17f1c830e0e4f4473714a895228afe97.370a5aec6c948b64a7638f194c6ea1a7,NVL(17f1c830e0e4f4473714a895228afe97.4b398d884e397727aeb50b1bf2299e60f6283ea3dfab0ee7d1d005a13bf2d220,''000000''),d19b9362bad81ce264aea08ea7ccfe0e.f5dd4374a3e3af6a775cb6d6b22e8162, ';\n\nv_aptxn_sql5 := ' d19b9362bad81ce264aea08ea7ccfe0e.dc308088c6edc852389e07d62b4e115eb504f2aa575f48bf13473e6822c935b8,d19b9362bad81ce264aea08ea7ccfe0e.d6feb3ce3930e1df4568d8ad2e34234acf410cec8b66c3bf5244f8405aa08384,17f1c830e0e4f4473714a895228afe97.d6feb3ce3930e1df4568d8ad2e34234a601fa525a9ae6adbe4075e99e3bc2cf7,d19b9362bad81ce264aea08ea7ccfe0e.8925f31e39c47f6a499461c43c69c448b504f2aa575f48bf13473e6822c935b8,d19b9362bad81ce264aea08ea7ccfe0e.5614e3e3773aa0cc945f4ce3d7f55482cf410cec8b66c3bf5244f8405aa08384, ' ||\n' 17f1c830e0e4f4473714a895228afe97.5614e3e3773aa0cc945f4ce3d7f55482601fa525a9ae6adbe4075e99e3bc2cf7,17f1c830e0e4f4473714a895228afe97.d4b886ec9db9850e79e0b6d4cf1585d4,d19b9362bad81ce264aea08ea7ccfe0e.8f83b112122ab5ea20567a0986f18a4fce26a64a7ac8d188835efcbfda026222,17f1c830e0e4f4473714a895228afe97.d89005a8280032bffbf811a9534ce895e32ad436514bbe822b33de8bead744f3, ' ||\n' d19b9362bad81ce264aea08ea7ccfe0e.46d7a422a8cbe2cc9df276d91cea9b995d217b74c7c7793f18ddf55b60944bdc,d19b9362bad81ce264aea08ea7ccfe0e.46d7a422a8cbe2cc9df276d91cea9b99c275957d3d4505aa3b3f9275fb57479d,d19b9362bad81ce264aea08ea7ccfe0e.68f9612aa320e6c42f047523bc77265d714ed54de59e7b661fe41c8a4929bcb4,17f1c830e0e4f4473714a895228afe97.9e023e08ce376b6e1b1b18dfa1cd167a11f37ee054443a481b60681df215350c, ' ||\n' 17f1c830e0e4f4473714a895228afe97.9e023e08ce376b6e1b1b18dfa1cd167a71b64e475c626845bd0f48ade254d768,17f1c830e0e4f4473714a895228afe97.ffe40dcb6bc0e52a6e16f71f92936b55,d19b9362bad81ce264aea08ea7ccfe0e.3d500acce5672772d9aaaba93ac5fab58f209e69b46e54a73064904b738a5c3c,17f1c830e0e4f4473714a895228afe97.55758ba3499240fc41103cdeb54dabdcce26a64a7ac8d188835efcbfda026222,17f1c830e0e4f4473714a895228afe97.02c48591889a5fa84ba70163595e3cd4cd0030bf918e8eee8bdc28cab59f8e90, ' ||\n' d19b9362bad81ce264aea08ea7ccfe0e.5937a869f7bd9c820fe4bbf4390bfe15f4147ca167a57859c2f78f7521e7a9a8,17f1c830e0e4f4473714a895228afe97.5937a869f7bd9c820fe4bbf4390bfe1541baa927927c7a4850d6f91f78c62431,17f1c830e0e4f4473714a895228afe97.677b20030e97fe7a072c96e3023ab27b75a332bf028585250008d9183409dc25,17f1c830e0e4f4473714a895228afe97.896062ff14ee1e0e09184e57f315ec807e8fe841f8abc0a126967273be28f1b7,17f1c830e0e4f4473714a895228afe97.896062ff14ee1e0e09184e57f315ec8098df5d6b623334f2e9631188cca4cfd6, ' ||\n' d19b9362bad81ce264aea08ea7ccfe0e.d25c1c21a833610b8c14ba7dc31f401b34f1d2dfe4534ac6536d03c083887f61,d19b9362bad81ce264aea08ea7ccfe0e.d4ba11e2e02b33f9fd0b33ac2804b203,17f1c830e0e4f4473714a895228afe97.559effe9c0b926e97c1a592970005d05e32f6dd38f333cde68119d1f277367cd,17f1c830e0e4f4473714a895228afe97.c75cfeffaba16c33a08fd34fd23f01971d731bbdc4e3fb69a854112d4982eb99,17f1c830e0e4f4473714a895228afe97.085ad920c0177cbda11e444d47a41c95e9a95106e01380a7834d36560e919770, ';\n\nv_aptxn_sql6 := ' 17f1c830e0e4f4473714a895228afe97.36e83390e6cef790558b8ec37de1f4fee472b097974b0d6a9a7d2ed170324906,d19b9362bad81ce264aea08ea7ccfe0e.d6460c7c12f703d232e7f6c2e58d51f80f873df5d484258dcc90a1dbb092a70c,d19b9362bad81ce264aea08ea7ccfe0e.7d7fcbe8ff3b7fb363da4430682a5b201d731bbdc4e3fb69a854112d4982eb99,d19b9362bad81ce264aea08ea7ccfe0e.d8443c8ded2334896b08e5ee2acce1b5,17f1c830e0e4f4473714a895228afe97.210f742c7a4e17979d08976db76abf6f, ' ||\n' d19b9362bad81ce264aea08ea7ccfe0e.d81d4e426128e21b1087dce9be167f7164cec6fed2ad32c265b227fe3b030560,17f1c830e0e4f4473714a895228afe97.72fe1ee604357ed2ad1717cc673f8d1b,d19b9362bad81ce264aea08ea7ccfe0e.f6f5826da24fe9b11010359d8c51baf0f4147ca167a57859c2f78f7521e7a9a8,17f1c830e0e4f4473714a895228afe97.3b18c8d346bdbe03ccf6d8560029ef43,d19b9362bad81ce264aea08ea7ccfe0e.81e531facac782bf0b91d5d1e54849f939597585a983e4f93f6fdead239436bb, ' ||\n' d19b9362bad81ce264aea08ea7ccfe0e.81e531facac782bf0b91d5d1e54849f98157f38ee21f2bc13ee1159420a59832,d19b9362bad81ce264aea08ea7ccfe0e.94380371d788e73dd0067ce3c911e2771d731bbdc4e3fb69a854112d4982eb99,17f1c830e0e4f4473714a895228afe97.4545f9b55765471ccd2e57bda93403c8d24b2fb1eee3864a9486359f68c4e118,17f1c830e0e4f4473714a895228afe97.7e96684bc4ed02b9ccf63d2f52a43b84e6e6300089dae5a98e31814d0406060f,17f1c830e0e4f4473714a895228afe97.6a04130b896c82c2b3b22b337cad2a56, ' ||\n' 17f1c830e0e4f4473714a895228afe97.975e3b626d2e6ca06ed84fbbc5558de3bff56d587bce01d32a3d5e44d29ed4fa,17f1c830e0e4f4473714a895228afe97.ccc371b06f1e0daed88f223211b2e790,17f1c830e0e4f4473714a895228afe97.6a57525895fd55cd1da456566ea80c1d,17f1c830e0e4f4473714a895228afe97.5b166c5fe66db413f1e228635901a0965479098e904da91bb293c4391be1730d,17f1c830e0e4f4473714a895228afe97.9033b904a17dc722bf77fb076a267f1529ba5ee45e1d87a256e3a1b57750a92a,d19b9362bad81ce264aea08ea7ccfe0e.63a91e2fd122990392b8c1467a67b61e, ' ||\n' d19b9362bad81ce264aea08ea7ccfe0e.49dbc899bc8f9659472a5a3b3510790c,d19b9362bad81ce264aea08ea7ccfe0e.deeb4c7020bbcfd9e70cb4a8ed6ea0dc,d19b9362bad81ce264aea08ea7ccfe0e.f4684b698d1e8edd11bf71d8eac02595,d19b9362bad81ce264aea08ea7ccfe0e.ca329b170a83f14795f7d01859b0fe42,d19b9362bad81ce264aea08ea7ccfe0e.a4657a147b058328748c801964a53707,d19b9362bad81ce264aea08ea7ccfe0e.2d45d761eb8d137835bca7a23010fab4,d19b9362bad81ce264aea08ea7ccfe0e.0a85164948783cdf0d4416f41905a154,d19b9362bad81ce264aea08ea7ccfe0e.6332016ddc9cad43c85dec8c86c2f732,17f1c830e0e4f4473714a895228afe97.a00b7aac034b1de6ebfabe4a7097af1b3c072b0281819f75f19257cd7009a1b3, ';\n\nv_aptxn_sql7 := 'd19b9362bad81ce264aea08ea7ccfe0e.af173eb37e528a7cdb955e5b28cc23aa,d19b9362bad81ce264aea08ea7ccfe0e.4b191f0271f76dbc6e6000be34023a3e,d19b9362bad81ce264aea08ea7ccfe0e.e1b1859b558f14ea9916a5dbcd02473a,d19b9362bad81ce264aea08ea7ccfe0e.82be0aaa7de54349da31cee325ab951e,d19b9362bad81ce264aea08ea7ccfe0e.4b413d0bbcae181494a218cf6afc155f,d19b9362bad81ce264aea08ea7ccfe0e.dc15696e1e997bad6131bf936574f406,d19b9362bad81ce264aea08ea7ccfe0e.082ab98f67c47545852bd9eeb87c14a4,d19b9362bad81ce264aea08ea7ccfe0e.eb518a41a6eb20e8bd4d58f85a481519,d19b9362bad81ce264aea08ea7ccfe0e.eb0ee2e145fdfe7c9893d205317a3e0e, ' ||\n' d19b9362bad81ce264aea08ea7ccfe0e.88d58d1ceaa04b12e965be48693946b8,d19b9362bad81ce264aea08ea7ccfe0e.82bb584f288c6982cf738bddb639ec2a,d19b9362bad81ce264aea08ea7ccfe0e.5b092195a30f8906453974d1170a1ea1,d19b9362bad81ce264aea08ea7ccfe0e.2b326fa6a91e72fbd4db5ddd134f321f,d19b9362bad81ce264aea08ea7ccfe0e.56957d29c1b09ea656dacf8a772dfe5f,d19b9362bad81ce264aea08ea7ccfe0e.7a6fef6a5c75091b25ef6dce0e9427dc,d19b9362bad81ce264aea08ea7ccfe0e.7468b15d94d4d5c372807c8570a644f6,17f1c830e0e4f4473714a895228afe97.9b5a3fd0647f1b6d616bd47466949ec2, ' ||\n' d19b9362bad81ce264aea08ea7ccfe0e.5e4ad26cda1ec498500e65e5cc12f845,17f1c830e0e4f4473714a895228afe97.b7a93c415ffd854911e38dbd0033808a,d19b9362bad81ce264aea08ea7ccfe0e.b062726b7cf877dc4379a5ef28a428cb,d19b9362bad81ce264aea08ea7ccfe0e.8a966af6e86bb16d9de33bf936d4fecb,d19b9362bad81ce264aea08ea7ccfe0e.b9a035db66bd8374526f94bc153f4762,d19b9362bad81ce264aea08ea7ccfe0e.67248d79aea7674e680fd38599fdb6f4,d19b9362bad81ce264aea08ea7ccfe0e.94692a617eedc131dbb1300ec6d66b17,17f1c830e0e4f4473714a895228afe97.caa2824077535938efbfeab4179ac71d,d19b9362bad81ce264aea08ea7ccfe0e.26ac88e7ae671a1b22c14c2fce77aa2d,17f1c830e0e4f4473714a895228afe97.b391f718d41b76652cd5f0d0063372b5, ' ||\n' 17f1c830e0e4f4473714a895228afe97.d5506821c4ea14a4d9ee0f0ce4e7652d,17f1c830e0e4f4473714a895228afe97.f2afece23955e23b9d2f09fce0b18c61382d0f5d3019cd2839eb42d66c71274c,17f1c830e0e4f4473714a895228afe97.0c499b9342241191d5d5fc19d9822401382d0f5d3019cd2839eb42d66c71274c,d19b9362bad81ce264aea08ea7ccfe0e.5c045c6ad55bfb143fea1cb9634d34af,NVL(17f1c830e0e4f4473714a895228afe97.abfa8e82cd46bbb827127b6cb2f5d6d5,0),d19b9362bad81ce264aea08ea7ccfe0e.bc85f0acd4f5b2becdd7efc34c3a2003,d19b9362bad81ce264aea08ea7ccfe0e.5867b4a2e2d1a7c0792d8569c0d90b1f, ' ||\n' d19b9362bad81ce264aea08ea7ccfe0e.e2657ceeba5b709bafb65e0820feb4e2b6e1b396dbe14782b1b65b60d5d80e45,d19b9362bad81ce264aea08ea7ccfe0e.d36e400304221073c1c3bb586ed7de9f,d19b9362bad81ce264aea08ea7ccfe0e.92d4d6b1028cc8f6b6a6a50394af943a,d19b9362bad81ce264aea08ea7ccfe0e.b7982b81d447f11a0953881190e528cae32f6dd38f333cde68119d1f277367cd,d19b9362bad81ce264aea08ea7ccfe0e.1db1b1099d6c7239a882ba6364f0e12d,d19b9362bad81ce264aea08ea7ccfe0e.c7a5550e66e03d37be3af7810a1cd82e1d731bbdc4e3fb69a854112d4982eb99, ' ||\n' d19b9362bad81ce264aea08ea7ccfe0e.b929d681ced63c6b203aa9a1d8973da4,d19b9362bad81ce264aea08ea7ccfe0e.aea2b843066cbf7530af94deb507a420,d19b9362bad81ce264aea08ea7ccfe0e.500f21991e85f5b9a78ad5961f1fbbc7,d19b9362bad81ce264aea08ea7ccfe0e.ccf8d88f2d37f3171da2121ab22e9330,d19b9362bad81ce264aea08ea7ccfe0e.60a12efca79b9e843a21f9dd325e6a80e32f6dd38f333cde68119d1f277367cd,d19b9362bad81ce264aea08ea7ccfe0e.424607a0ca73330c3cc1e84dfe4afa64,d19b9362bad81ce264aea08ea7ccfe0e.d3e77785919f0b458a86d736b61dd5a7, ' ||\n' d19b9362bad81ce264aea08ea7ccfe0e.f2e27750b8738746a93b585e377bbeb9,d19b9362bad81ce264aea08ea7ccfe0e.c2e82d4936217cdd8ea6375bc48b58b2,d19b9362bad81ce264aea08ea7ccfe0e.eaa03e417a6b67a32172cc9dca631f77,d19b9362bad81ce264aea08ea7ccfe0e.224811ad2521818a46ceb20442ea1122,d19b9362bad81ce264aea08ea7ccfe0e.467a168a7499c57b1859198a7dac7be0 ';\n\n\nIF v_div_nbr = '9999' THEN\nv_aptxn_sql8 := ' FROM '|| v_src_tbl || ' ap, first_rec slc ' ||\n' WHERE (d19b9362bad81ce264aea08ea7ccfe0e.26ac88e7ae671a1b22c14c2fce77aa2d = ''AP'' OR '||\n' d19b9362bad81ce264aea08ea7ccfe0e.2633936e94c628e8eb6e5631ec0c5768 IS NOT NULL OR d19b9362bad81ce264aea08ea7ccfe0e.5a10715569533ce7e5409867b2262134 IS NOT NULL) AND ' ||\n' 17f1c830e0e4f4473714a895228afe97.839c4ffb4bfaae1bb58eab4dee67d96a = d19b9362bad81ce264aea08ea7ccfe0e.839c4ffb4bfaae1bb58eab4dee67d96a AND ' ||\n' 17f1c830e0e4f4473714a895228afe97.2d45d761eb8d137835bca7a23010fab4 = d19b9362bad81ce264aea08ea7ccfe0e.2d45d761eb8d137835bca7a23010fab4 AND 17f1c830e0e4f4473714a895228afe97.f5dd4374a3e3af6a775cb6d6b22e8162 = d19b9362bad81ce264aea08ea7ccfe0e.f5dd4374a3e3af6a775cb6d6b22e8162 AND 17f1c830e0e4f4473714a895228afe97.1d4c395e47c3a12291a4e6c06178aa0c=1 ' ||\n' AND 17f1c830e0e4f4473714a895228afe97.be8d7c2ea76d3152927ebf8709ea0326 = d19b9362bad81ce264aea08ea7ccfe0e.be8d7c2ea76d3152927ebf8709ea0326 AND 17f1c830e0e4f4473714a895228afe97.852fa1e9f02f1ca2c75837f7146b2381 = d19b9362bad81ce264aea08ea7ccfe0e.852fa1e9f02f1ca2c75837f7146b2381 ' ||\n' AND d19b9362bad81ce264aea08ea7ccfe0e.0effb8574b17d7b64bca94bc97d1d844 = 0 ' ; \nELSE\nv_aptxn_sql8 := ' FROM '|| v_src_tbl || ' ap, first_rec slc ' ||\n' WHERE (d19b9362bad81ce264aea08ea7ccfe0e.26ac88e7ae671a1b22c14c2fce77aa2d = ''AP'' OR '||\n' d19b9362bad81ce264aea08ea7ccfe0e.2633936e94c628e8eb6e5631ec0c5768 IS NOT NULL OR d19b9362bad81ce264aea08ea7ccfe0e.5a10715569533ce7e5409867b2262134 IS NOT NULL) AND ' ||\n' 17f1c830e0e4f4473714a895228afe97.839c4ffb4bfaae1bb58eab4dee67d96a = d19b9362bad81ce264aea08ea7ccfe0e.839c4ffb4bfaae1bb58eab4dee67d96a AND ' ||\n' 17f1c830e0e4f4473714a895228afe97.2d45d761eb8d137835bca7a23010fab4 = d19b9362bad81ce264aea08ea7ccfe0e.2d45d761eb8d137835bca7a23010fab4 AND 17f1c830e0e4f4473714a895228afe97.f5dd4374a3e3af6a775cb6d6b22e8162 = d19b9362bad81ce264aea08ea7ccfe0e.f5dd4374a3e3af6a775cb6d6b22e8162 ' ||\n' AND 17f1c830e0e4f4473714a895228afe97.be8d7c2ea76d3152927ebf8709ea0326 = d19b9362bad81ce264aea08ea7ccfe0e.be8d7c2ea76d3152927ebf8709ea0326 AND 17f1c830e0e4f4473714a895228afe97.852fa1e9f02f1ca2c75837f7146b2381 = d19b9362bad81ce264aea08ea7ccfe0e.852fa1e9f02f1ca2c75837f7146b2381 ' ||\n' AND 17f1c830e0e4f4473714a895228afe97.1d4c395e47c3a12291a4e6c06178aa0c=1 AND 17f1c830e0e4f4473714a895228afe97.839c4ffb4bfaae1bb58eab4dee67d96a = ' || v_div_nbr || ' ' ||\n' AND d19b9362bad81ce264aea08ea7ccfe0e.0effb8574b17d7b64bca94bc97d1d844 = 0 ' ; \nEND IF;\n\nv_ap_addfilter_sql := ' AND d19b9362bad81ce264aea08ea7ccfe0e.f5dd4374a3e3af6a775cb6d6b22e8162 BETWEEN ''' || v_start_dt || ''' AND ''' || v_end_dt || '''';\n\nEXECUTE IMMEDIATE\nv_ins_sql1 || v_ins_sql2 || v_ins_sql3 || v_ins_sql4 || v_ins_sql5 || v_ins_sql6 || v_apwith_sql1 || v_apwith_sql2 ||\nv_apwith_sql3 || v_aptxn_sql1 || v_aptxn_sql2 || v_aptxn_sql3 || v_aptxn_sql4 || v_aptxn_sql5 ||\nv_aptxn_sql6 || v_aptxn_sql7 || v_aptxn_sql8 || v_ap_addfilter_sql ;\n\nCOMMIT;\n\ndbms_output.put_line ('STEP 1: Load complete for AP txn');\n\n\nBEGIN\n\n\nIF v_div_nbr = '9999' THEN \nv_audt_sql1 := ' SELECT COUNT(*), SUM(NVL(GRS_SLS_EXTND,0)), SUM(NVL(QTY_SHIP,0)), SUM(NVL(TTL_DVT,0)), SUM(NVL(PROD_ALW,0)), SUM(NVL(PROD_CHRG,0)), SUM(NVL(TTL_ALWNC,0)) FROM '|| v_src_tbl ||\n              ' ap  WHERE (d19b9362bad81ce264aea08ea7ccfe0e.26ac88e7ae671a1b22c14c2fce77aa2d = ''AP'' OR '||\n              ' (d19b9362bad81ce264aea08ea7ccfe0e.2633936e94c628e8eb6e5631ec0c5768 IS NOT NULL AND d19b9362bad81ce264aea08ea7ccfe0e.5a10715569533ce7e5409867b2262134 IS NULL) OR (d19b9362bad81ce264aea08ea7ccfe0e.2633936e94c628e8eb6e5631ec0c5768 IS NULL AND d19b9362bad81ce264aea08ea7ccfe0e.5a10715569533ce7e5409867b2262134 IS NOT NULL) ) AND (d19b9362bad81ce264aea08ea7ccfe0e.2d45d761eb8d137835bca7a23010fab4<>''NPAC0248'') ' || v_ap_addfilter_sql;\n\nv_audt_sql2 := ' SELECT COUNT(*), SUM(NVL(GRS_SLS_EXTND,0)), SUM(NVL(QTY_SHIP,0)), SUM(NVL(TTL_DVT,0)), SUM(NVL(PROD_ALW,0)), SUM(NVL(PROD_CHRG,0)), SUM(NVL(TTL_ALWNC,0)) FROM '|| v_tgt_tbl ||\n             ' ap WHERE (d19b9362bad81ce264aea08ea7ccfe0e.26ac88e7ae671a1b22c14c2fce77aa2d = ''AP'' OR '||\n             '  (d19b9362bad81ce264aea08ea7ccfe0e.2633936e94c628e8eb6e5631ec0c5768 IS NOT NULL AND d19b9362bad81ce264aea08ea7ccfe0e.5a10715569533ce7e5409867b2262134 IS NULL) OR (d19b9362bad81ce264aea08ea7ccfe0e.2633936e94c628e8eb6e5631ec0c5768 IS NULL AND d19b9362bad81ce264aea08ea7ccfe0e.5a10715569533ce7e5409867b2262134 IS NOT NULL) ) AND (d19b9362bad81ce264aea08ea7ccfe0e.2d45d761eb8d137835bca7a23010fab4<>''NPAC0248'') ' || v_ap_addfilter_sql ;\n\nELSE\nv_audt_sql1 := ' SELECT COUNT(*), SUM(NVL(GRS_SLS_EXTND,0)), SUM(NVL(QTY_SHIP,0)), SUM(NVL(TTL_DVT,0)), SUM(NVL(PROD_ALW,0)), SUM(NVL(PROD_CHRG,0)), SUM(NVL(TTL_ALWNC,0)) FROM '|| v_src_tbl ||\n              ' ap WHERE (d19b9362bad81ce264aea08ea7ccfe0e.26ac88e7ae671a1b22c14c2fce77aa2d = ''AP'' OR '||\n              ' (d19b9362bad81ce264aea08ea7ccfe0e.2633936e94c628e8eb6e5631ec0c5768 IS NOT NULL AND d19b9362bad81ce264aea08ea7ccfe0e.5a10715569533ce7e5409867b2262134 IS NULL) OR (d19b9362bad81ce264aea08ea7ccfe0e.2633936e94c628e8eb6e5631ec0c5768 IS NULL AND d19b9362bad81ce264aea08ea7ccfe0e.5a10715569533ce7e5409867b2262134 IS NOT NULL) ) AND div_nbr = ' || v_div_nbr || ' AND (d19b9362bad81ce264aea08ea7ccfe0e.2d45d761eb8d137835bca7a23010fab4<>''NPAC0248'') ' || v_ap_addfilter_sql;\n\nv_audt_sql2 := ' SELECT COUNT(*), SUM(NVL(GRS_SLS_EXTND,0)), SUM(NVL(QTY_SHIP,0)), SUM(NVL(TTL_DVT,0)), SUM(NVL(PROD_ALW,0)), SUM(NVL(PROD_CHRG,0)), SUM(NVL(TTL_ALWNC,0)) FROM '|| v_tgt_tbl ||\n             ' ap WHERE (d19b9362bad81ce264aea08ea7ccfe0e.26ac88e7ae671a1b22c14c2fce77aa2d = ''AP'' OR '||\n             ' (d19b9362bad81ce264aea08ea7ccfe0e.2633936e94c628e8eb6e5631ec0c5768 IS NOT NULL AND d19b9362bad81ce264aea08ea7ccfe0e.5a10715569533ce7e5409867b2262134 IS NULL) OR (d19b9362bad81ce264aea08ea7ccfe0e.2633936e94c628e8eb6e5631ec0c5768 IS NULL AND d19b9362bad81ce264aea08ea7ccfe0e.5a10715569533ce7e5409867b2262134 IS NOT NULL) ) AND div_nbr = ' || v_div_nbr || '  AND (d19b9362bad81ce264aea08ea7ccfe0e.2d45d761eb8d137835bca7a23010fab4<>''NPAC0248'') ' || v_ap_addfilter_sql ;\nEND IF;\n\n\nEXECUTE IMMEDIATE v_audt_sql1 INTO v_src_cnt, v_src_grs_sls, v_src_qty_ship, v_src_ttl_dvt, v_src_prd_alw, v_src_prd_chrg, v_src_ttl_alwnc;\n\nCOMMIT;\n\ndbms_output.put_line ('Audit 1: complete first audit');\n\nEXECUTE IMMEDIATE v_audt_sql2 INTO v_tgt_cnt, v_tgt_grs_sls, v_tgt_qty_ship, v_tgt_ttl_dvt, v_tgt_prd_alw, v_tgt_prd_chrg, v_tgt_ttl_alwnc;\n\nCOMMIT;\n\ndbms_output.put_line ('Audit 2: complete second audit');\n\nIF v_src_cnt > 0 THEN\n    IF (v_src_cnt = v_tgt_cnt) AND (v_src_grs_sls = v_tgt_grs_sls) AND (v_src_qty_ship = v_tgt_qty_ship) AND (v_src_ttl_dvt = v_tgt_ttl_dvt)\n    AND (v_src_prd_alw = v_tgt_prd_alw) AND (v_src_prd_chrg = v_tgt_prd_chrg) AND (v_src_ttl_alwnc = v_tgt_ttl_alwnc) THEN\n      dbms_output.put_line (' src cnt ' || v_src_cnt || '; tgt cnt ' || v_tgt_cnt || '; ');\n      dbms_output.put_line (' src grs_sls ' || v_src_grs_sls || '; tgt grs_sls ' || v_tgt_grs_sls || '; ');\n      dbms_output.put_line (' src qty_ship ' || v_src_qty_ship || '; tgt qty_ship ' || v_tgt_qty_ship || '; ');\n      dbms_output.put_line (' src ttl_dvt ' || v_src_ttl_dvt || '; tgt ttl_dvt ' || v_tgt_ttl_dvt || '; ');\n      dbms_output.put_line (' v_src_prd_alw ' || v_src_prd_alw || '; v_tgt_prd_alw ' || v_tgt_prd_alw || '; ');\n      dbms_output.put_line (' v_src_prd_chrg ' || v_src_prd_chrg || '; v_tgt_prd_chrg ' || v_tgt_prd_chrg || '; ');\n      dbms_output.put_line (' v_src_ttl_alwnc ' || v_src_ttl_alwnc || '; v_tgt_ttl_alwnc ' || v_tgt_ttl_alwnc || '; ');\n      RETURN 0; \n    ELSE\n      DBMS_OUTPUT.PUT_LINE (' source count ' || v_src_cnt || ' target count ' || v_tgt_cnt || 'source grs sls ' || v_src_grs_sls || 'target grs sls ' ||\n      v_tgt_grs_sls || 'source qty ship ' || v_src_qty_ship || 'target qty ship ' || v_tgt_qty_ship || 'source ttl dvt ' || v_src_ttl_dvt ||\n      'target ttl dvt ' || v_tgt_ttl_dvt);\n      dbms_output.put_line (' v_src_prd_alw ' || v_src_prd_alw || '; v_tgt_prd_alw ' || v_tgt_prd_alw || '; ');\n      dbms_output.put_line (' v_src_prd_chrg ' || v_src_prd_chrg || '; v_tgt_prd_chrg ' || v_tgt_prd_chrg || '; ');\n      dbms_output.put_line (' v_src_ttl_alwnc ' || v_src_ttl_alwnc || '; v_tgt_ttl_alwnc ' || v_tgt_ttl_alwnc || '; ');\n      dbms_output.put_line (v_ins_sql1 || v_ins_sql2 || v_ins_sql3 || v_ins_sql4 || v_ins_sql5 || v_ins_sql6 || v_apwith_sql1 || v_apwith_sql2 ||\n    v_apwith_sql3 || v_aptxn_sql1 || v_aptxn_sql2 || v_aptxn_sql3 || v_aptxn_sql4 || v_aptxn_sql5 ||\n    v_aptxn_sql6 || v_aptxn_sql7 || v_aptxn_sql8 || v_ap_addfilter_sql);\n      RETURN 20;\n    END IF;\nEND IF;\n\nRETURN 0;\n\nEND;\n\n  EXCEPTION\n    WHEN OTHERS THEN\n\n      p_out_message := '*ERROR in AP historical update script ' || SQLCODE || ' ' ||\n                       SQLERRM;\n      dbms_output.put_line(SQLCODE);\n      dbms_output.put_line(SQLERRM);\n      RETURN 20;\n\nEND FN_XDM_SALES_CORP_UPD_AP;\n/",
            "upstream_dependencies": [],
            "downstream_dependencies": [],
            "dag_location": "null",
            "gantt_location": "null",
            "created_at": "null",
            "updated_at": "null"
        },
        {
            "name": "FN_PYR_SLS_AGGR_LOAD_11G",
            "encrypted_name": "ab4278f1500ebdb78989a5fd47ca876bff4a2a68239e25934bce2ab808c4cfdc",
            "type": "function",
            "database": "null",
            "encrypted_database": "null",
            "schema": "XDMADM",
            "encrypted_schema": "0e03d5c46556a742ba46252698396ef2",
            "fully_qualified_name": "XDMADM.FN_PYR_SLS_AGGR_LOAD_11G",
            "encrypted_fqn": "0e03d5c46556a742ba46252698396ef2.ab4278f1500ebdb78989a5fd47ca876bff4a2a68239e25934bce2ab808c4cfdc",
            "synonyms": [],
            "metadata_analysis": "CREATE OR REPLACE FUNCTION \"0e03d5c46556a742ba46252698396ef2\".\"ab4278f1500ebdb78989a5fd47ca876bff4a2a68239e25934bce2ab808c4cfdc\" (odate          IN DATE,\n                                                       p_start_date   IN DATE DEFAULT NULL,\n                                                       p_prev_years   IN NUMBER DEFAULT NULL)\n   RETURN NUMBER AS\n\n   l_start_date              DATE;\n   l_fn_start                DATE;\n   l_load_tbl_cnt            NUMBER := 0;\n   l_insert_cnt              NUMBER;\n   v_parm_dt                 DATE;\n   v_ly_fisc_yr_wk           VARCHAR2 (06);\n   v_ly_day_of_wk            NUMBER(1);\n   v_cy_fisc_yr_wk           VARCHAR2 (06);\n   v_cy_day_of_wk            NUMBER(1);\n\n   c_success                 CONSTANT NUMBER := 0;\n   c_error                   CONSTANT NUMBER := 1;\n   c_schema                  CONSTANT VARCHAR2(30) := 'XDMADM';\n   c_aggr_tbl_syn_nm         CONSTANT VARCHAR2(30) := 'SALES_SUMM_PYR_AGGR';\n   c_aggr_load_syn_nm        CONSTANT VARCHAR2(30) := 'SALES_SUMM_PYR_AGGR_LOAD';\n\n   l_load_tbl_nm             VARCHAR2(30);\n   l_object_nm               VARCHAR2(30);\n   l_return_code             NUMBER;\n   l_out_msg                 VARCHAR2(256);\n\n   v_base_cases_cnt          NUMBER;\n   v_base_sales              NUMBER;\n   v_aggr_cases_cnt          NUMBER;\n   v_aggr_sales              NUMBER;\n   e_truncate_table          exception;\n   e_analyze_table           exception;\n   e_syn                     exception;\n   e_lookup_range            exception;\n\n\nBEGIN\n\n\n\n   v_parm_dt        := TRUNC(odate);\n\n   \n\n   SELECT fisc_yr_wk, clndr_day_of_wk\n      INTO v_cy_fisc_yr_wk, v_cy_day_of_wk\n      FROM de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001\n   WHERE  clndr_dt = v_parm_dt;\n\n   \n\n   SELECT de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.f2de255a7553ba934b1f05ae7699ae4c, de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.7c53ae8ca5b55e75e8a2957615ed09bb\n      INTO v_ly_fisc_yr_wk, v_ly_day_of_wk\n      FROM de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001 tc, de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001 tc2\n   WHERE de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.caa2824077535938efbfeab4179ac71d = de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.c7b3173a993d42e0cd6a06309b55345d\n      AND de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.222ccb1d1746bcdb2365f29b3da0b613 = v_parm_dt;\n\n   DBMS_OUTPUT.put_line ('Current Fiscal year week:' || v_cy_fisc_yr_wk);\n   DBMS_OUTPUT.put_line ('Last Fiscal year week:' || v_ly_fisc_yr_wk);\n   DBMS_OUTPUT.put_line ('Day of current Fiscal year week:' || v_cy_day_of_wk);\n   DBMS_OUTPUT.put_line ('ODate:' || v_parm_dt);\n\n\n \n\n   EXECUTE IMMEDIATE 'SELECT table_name FROM user_synonyms WHERE synonym_name = ''' || c_aggr_load_syn_nm || ''''\n      INTO l_load_tbl_nm;\n\n\n\n   IF (c_aggr_tbl_syn_nm = l_load_tbl_nm) THEN\n      RAISE e_syn;\n   END IF;\n\n      \n   EXECUTE IMMEDIATE 'SELECT count(1) FROM ' || l_load_tbl_nm INTO l_load_tbl_cnt;\n\n   IF (l_load_tbl_cnt > 0) THEN\n      DBMS_OUTPUT.put_line('Load aggregate table has ' || l_load_tbl_nm || ' records in it');\n\n      l_return_code   := 8e64339f96bb08058f5d52f1c04f954a.8ffe4678890c39c7d4ed38c2ed759e24.e4b5db2b3f9b19accbb8cddbfcd05bac(l_out_msg, c_schema, l_load_tbl_nm);\n\n      DBMS_OUTPUT.put_line('Truncate table Return: ' || l_return_code || ' - ' || l_out_msg);\n\n      IF (l_return_code <> 0) THEN\n         l_object_nm   := l_load_tbl_nm;\n         RAISE e_truncate_table;\n      END IF;\n\n      DBMS_OUTPUT.put_line('Load aggregate table ' || l_load_tbl_nm ||' truncated');\n\n   END IF;\n\n   \n\n   \n\n   l_fn_start       := SYSDATE;\n\nINSERT  INTO 0e03d5c46556a742ba46252698396ef2.4f5573ecc240798c6774115df73e2dc857af8c4c407f00bf20d0bd37b2bc3db2\n(\n           div_nbr,\n           div_nm,\n           div_typ_cd,\n           sls_revenue_div_nbr,\n           rgn_nbr,\n           rgn_nm,\n           rgn_cd,\n           grp_nm_or_div_nm_cd_nbr,\n           grp_nm,\n           grp_cd,\n           fisc_yr,\n           fisc_yr_qtr,\n           fisc_yr_mth,\n           fisc_mth_nm,\n           fisc_yr_wk,\n           pim_suprcls_id_crnt,\n           pim_suprcls_id_actl,\n           pim_suprcls_desc,\n           pim_suprcls_desc_id,\n           pim_cls_id,\n           pim_cls_desc,\n           pim_cls_desc_id,\n           pim_brnd_typ,\n           pim_brnd_typ_desc,\n           trd_cls,\n           trd_cls_desc,\n           usf_top_pyr_seg_cd,\n           usf_top_pyr_seg_desc,\n           usf_top_pyr_seg_sort_ord,\n           pyr_seg_cd,\n           pyr_seg_desc,\n           pyr_seg_sort_ord,\n           corp_mlt_unit_nbr,\n           corp_mlt_unit_desc,\n           prnt_mlt_unit_cd,\n           prnt_mlt_unit_desc,\n           cust_cntrct_flg,\n           cust_cntrct_stat_desc,\n           cust_natl_mngd_flg,\n           cust_mgt_typ_desc,\n           cust_acctblty_flg,\n           cust_acctblty_desc,\n           ly_wtd,\n           grs_sls_extnd,\n           unfrm_qty_ship,\n           actl_gp,\n           ttl_alwnc,\n           grs_tgp,\n           net_sls,\n           net_tgp,\n           dwa_cost_extnd,\n           rbt_loc_accrl_amt,\n           rbt_natl_accrl_amt,\n           rbt_loc_exp_amt,\n           rbt_natl_exp_amt,\n           ttl_int_vndr_fnd_dvt,\n           ttl_int_vndr_fnd_dvt_is,\n           comm_bsis_amt_extnd,\n           comm_bsis_amt_extnd_is,\n           dond,\n           dond_is,\n           ttl_vndr_fnd_dvt,\n           fixed_sell,\n           n_prime_sis,\n           prc_apprvl,\n           dwo,\n           invst_cs_prtcpt,\n           net_non_prod_chrg,\n           net_prod_chrg,\n           net_non_prod_alwnc,\n           net_prod_alwnc,\n           ttl_loc_alwnc,\n           ttl_natl_alwnc,\n           loc_int_dvt,\n           loc_vndr_fnd_dvt,\n           natl_int_dvt,\n           natl_vndr_fnd_dvt,\n           sagp,\n           net_tgp_plus_pa,\n           net_allwnc_chrg_plus_rbts,\n           ec_grs_sls_extnd,\n           py_cust_cases,\n           py_cust_cnt,\n           cust_bow_cnt,\n           usf_gl_ind,\n           cust_acqstn_stat_crnt,\n           cust_acqstn_stat_actl,\n           cust_acqstn_div_nbr\n           )\n  SELECT   div_nbr,\n           div_nm,\n           div_typ_cd,\n           sls_revenue_div_nbr,\n           rgn_nbr,\n           rgn_nm,\n           rgn_cd,\n           grp_nm_or_div_nm_cd_nbr,\n           grp_nm,\n           grp_cd,\n           fisc_yr,\n           fisc_yr_qtr,\n           fisc_yr_mth,\n           fisc_mth_nm,\n           fisc_yr_wk,\n           pim_suprcls_id_crnt,\n           pim_suprcls_id_actl,\n           pim_suprcls_desc,\n           pim_suprcls_desc_id,\n           pim_cls_id,\n           pim_cls_desc,\n           pim_cls_desc_id,\n           pim_brnd_typ,\n           pim_brnd_typ_desc,\n           trd_cls,\n           trd_cls_desc,\n           usf_top_pyr_seg_cd,\n           usf_top_pyr_seg_desc,\n           usf_top_pyr_seg_sort_ord,\n           pyr_seg_cd,\n           pyr_seg_desc,\n           pyr_seg_sort_ord,\n           corp_mlt_unit_nbr,\n           corp_mlt_unit_desc,\n           prnt_mlt_unit_cd,\n           prnt_mlt_unit_desc,\n           cust_cntrct_flg,\n           cust_cntrct_stat_desc,\n           cust_natl_mngd_flg,\n           cust_mgt_typ_desc,\n           cust_acctblty_flg,\n           cust_acctblty_desc,\n           ly_wtd,\n           SUM (grs_sls_extnd),\n           SUM (unfrm_qty_ship),\n           SUM (actl_gp),\n           SUM (ttl_alwnc),\n           SUM (grs_tgp),\n           SUM (net_sls),\n           SUM (net_tgp),\n           SUM (dwa_cost_extnd),\n           SUM (rbt_loc_accrl_amt),\n           SUM (rbt_natl_accrl_amt),\n           SUM (rbt_loc_exp_amt),\n           SUM (rbt_natl_exp_amt),\n           SUM (ttl_int_vndr_fnd_dvt),\n           SUM (ttl_int_vndr_fnd_dvt_is),\n           SUM (comm_bsis_amt_extnd),\n           SUM (comm_bsis_amt_extnd_is),\n           SUM (dond),\n           SUM (dond_is),\n           SUM (ttl_vndr_fnd_dvt),\n           SUM (fixed_sell),\n           SUM (n_prime_sis),\n           SUM (prc_apprvl),\n           SUM (dwo),\n           SUM (invst_cs_prtcpt),\n           SUM (net_non_prod_chrg),\n           SUM (net_prod_chrg),\n           SUM (net_non_prod_alwnc),\n           SUM (net_prod_alwnc),\n           SUM (ttl_loc_alwnc),\n           SUM (ttl_natl_alwnc),\n           SUM (loc_int_dvt),\n           SUM (loc_vndr_fnd_dvt),\n           SUM (natl_int_dvt),\n           SUM (natl_vndr_fnd_dvt),\n           SUM (sagp),\n           SUM (net_tgp_plus_pa),\n           SUM (net_allwnc_chrg_plus_rbts),\n           SUM (ec_grs_sls_extnd),\n           SUM (py_cust_cases),\n           SUM (py_cust_cnt),\n           SUM (cust_bow_cnt),\n           usf_gl_ind,\n           cust_acqstn_stat_crnt,\n           cust_acqstn_stat_actl,\n           cust_acqstn_div_nbr\n    FROM   de459e2fe7f96e4d958537b31b946b26.0ad6212deb7aa1fcea6c3846d02d7978cdc81057bcd87469c7825d00b68d1ace\nGROUP BY   div_nbr,\n           div_nm,\n           div_typ_cd,\n           sls_revenue_div_nbr,\n           rgn_nbr,\n           rgn_nm,\n           rgn_cd,\n           grp_nm_or_div_nm_cd_nbr,\n           grp_nm,\n           grp_cd,\n           fisc_yr,\n           fisc_yr_qtr,\n           fisc_yr_mth,\n           fisc_mth_nm,\n           fisc_yr_wk,\n           pim_suprcls_id_crnt,\n           pim_suprcls_id_actl,\n           pim_suprcls_desc,\n           pim_suprcls_desc_id,\n           pim_cls_id,\n           pim_cls_desc,\n           pim_cls_desc_id,\n           pim_brnd_typ,\n           pim_brnd_typ_desc,\n           trd_cls,\n           trd_cls_desc,\n           usf_top_pyr_seg_cd,\n           usf_top_pyr_seg_desc,\n           usf_top_pyr_seg_sort_ord,\n           pyr_seg_cd,\n           pyr_seg_desc,\n           pyr_seg_sort_ord,\n           corp_mlt_unit_nbr,\n           corp_mlt_unit_desc,\n           prnt_mlt_unit_cd,\n           prnt_mlt_unit_desc,\n           cust_cntrct_flg,\n           cust_cntrct_stat_desc,\n           cust_natl_mngd_flg,\n           cust_mgt_typ_desc,\n           cust_acctblty_flg,\n           cust_acctblty_desc,\n           ly_wtd,\n           usf_gl_ind,\n           cust_acqstn_stat_crnt,\n           cust_acqstn_stat_actl,\n           cust_acqstn_div_nbr\n           ;\n\nDBMS_OUTPUT.put_line(   'Inserted Rows in Load Table: '\n                           || sql%ROWCOUNT\n                           || ' in '\n                           || TO_CHAR(ROUND((SYSDATE - l_fn_start) * 86400))\n                           || ' seconds');\n\nCOMMIT;\n\n\n\n\n\n   DBMS_OUTPUT.put_line('Analyze the Load aggregate table ' || l_load_tbl_nm);\n   l_return_code    := de459e2fe7f96e4d958537b31b946b26.9b3711c37bca8fd1d7c76527508615f9(c_schema, l_load_tbl_nm);\n\n   IF (l_return_code <> 0) THEN\n      l_object_nm   := l_load_tbl_nm;\n      RAISE e_analyze_table;\n   END IF;\n\n\n\n   \n SELECT\n         SUM(unfrm_qty_ship),\n         SUM(grs_sls_extnd)   INTO v_base_cases_cnt, v_base_sales\n         from\n         (\nSELECT   div_nbr,\n         fisc_yr_wk,\n         ly_wtd,\n         pim_cls_id,\n         pim_suprcls_id_crnt,\n         pim_suprcls_id_actl,\n         trd_cls,\n         pyr_seg_cd,\n         corp_mlt_unit_nbr,\n         prnt_mlt_unit_cd,\n         pim_brnd_typ,\n         cust_cntrct_flg,\n         cust_natl_mngd_flg,\n         sls_revenue_div_nbr,\n         cust_acctblty_flg,\n         usf_gl_ind,\n         cust_acqstn_stat_crnt,\n         cust_acqstn_stat_actl,\n         cust_acqstn_div_nbr,\n         SUM(unfrm_qty_ship) unfrm_qty_ship,\n         SUM(grs_sls_extnd) grs_sls_extnd\n    FROM de459e2fe7f96e4d958537b31b946b26.0ad6212deb7aa1fcea6c3846d02d7978cdc81057bcd87469c7825d00b68d1ace\nGROUP BY div_nbr,\n         fisc_yr_wk,\n         ly_wtd,\n         pim_cls_id,\n         pim_suprcls_id_crnt,\n         pim_suprcls_id_actl,\n         trd_cls,\n         pyr_seg_cd,\n         corp_mlt_unit_nbr,\n         prnt_mlt_unit_cd,\n         pim_brnd_typ,\n         cust_cntrct_flg,\n         cust_natl_mngd_flg,\n         sls_revenue_div_nbr,\n         cust_acctblty_flg,\n         usf_gl_ind,\n         cust_acqstn_stat_crnt,\n         cust_acqstn_stat_actl,\n         cust_acqstn_div_nbr\n         )\n;\n\n   DBMS_OUTPUT.put_line('Base Cases = ' || v_base_cases_cnt);\n   DBMS_OUTPUT.put_line('Base Sales = ' || v_base_sales);\n\n   \n   SELECT  NVL(SUM(unfrm_qty_ship),0),  NVL(SUM(grs_sls_extnd),0)\n           INTO v_aggr_cases_cnt, v_aggr_sales\n   FROM  de459e2fe7f96e4d958537b31b946b26.4f5573ecc240798c6774115df73e2dc857af8c4c407f00bf20d0bd37b2bc3db2;\n\n   DBMS_OUTPUT.put_line('Aggregate Cases = ' || v_aggr_cases_cnt);\n   DBMS_OUTPUT.put_line('Aggregate Sales = ' || v_aggr_sales);\n\n   \n   IF v_base_cases_cnt = v_aggr_cases_cnt  AND v_base_sales = v_aggr_sales THEN\n      DBMS_OUTPUT.put_line('Successfully created Sales Pyramid aggregate data');\n      RETURN 6726798abbc757d8442516fefb8c40e9.79565b4ea20e0d36bc7365f1c4259002;\n   ELSE\n      DBMS_OUTPUT.put_line('Error: Base and aggregate numbers for cases and sales do not match');\n      RETURN 6726798abbc757d8442516fefb8c40e9.de3afdf274dc4a6f320906a012ba2f12;\n   END IF;\n\n\n\n\nRETURN c_success;\n\n\nEXCEPTION\n    WHEN e_syn THEN\n      DBMS_OUTPUT.put_line(\n         'Synonym currently points to Load table: ' || c_aggr_load_syn_nm || '. Requires manual update.');\n      DBMS_OUTPUT.put_line('Verify the ' ||c_aggr_load_syn_nm|| ' and ' ||c_aggr_load_syn_nm|| ' synonyms');\n      RETURN 6726798abbc757d8442516fefb8c40e9.de3afdf274dc4a6f320906a012ba2f12;\n   WHEN e_truncate_table THEN\n      DBMS_OUTPUT.put_line('Error Truncating Table: ' || l_load_tbl_nm || '. Requires manual update.');\n      DBMS_OUTPUT.put_line('Verify '||l_load_tbl_nm||' table has any records');\n      DBMS_OUTPUT.put_line(l_out_msg);\n      RETURN 6726798abbc757d8442516fefb8c40e9.de3afdf274dc4a6f320906a012ba2f12;\n   WHEN e_analyze_table THEN\n      DBMS_OUTPUT.put_line('Error Analyzing Table: ' || l_load_tbl_nm || '. Requires manual update.');\n      DBMS_OUTPUT.put_line(l_out_msg);\n      RETURN 6726798abbc757d8442516fefb8c40e9.de3afdf274dc4a6f320906a012ba2f12;\n   WHEN OTHERS THEN\n      DBMS_OUTPUT.put_line('Error creating Sales Pyramid aggregate data');\n      DBMS_OUTPUT.put_line(SQLCODE || ': ' || SQLERRM);\n      RETURN 6726798abbc757d8442516fefb8c40e9.de3afdf274dc4a6f320906a012ba2f12;\nEND;\n/",
            "upstream_dependencies": [],
            "downstream_dependencies": [],
            "dag_location": "null",
            "gantt_location": "null",
            "created_at": "null",
            "updated_at": "null"
        },
        {
            "name": "FN_RVNUE_BY_GL_ACCT_LOAD",
            "encrypted_name": "4a746717fb433d92a5a49a34d309c5314843539a446edf629a1efb6180b9ca50",
            "type": "function",
            "database": "null",
            "encrypted_database": "null",
            "schema": "XDMADM",
            "encrypted_schema": "0e03d5c46556a742ba46252698396ef2",
            "fully_qualified_name": "XDMADM.FN_RVNUE_BY_GL_ACCT_LOAD",
            "encrypted_fqn": "0e03d5c46556a742ba46252698396ef2.4a746717fb433d92a5a49a34d309c5314843539a446edf629a1efb6180b9ca50",
            "synonyms": [],
            "metadata_analysis": "CREATE OR REPLACE FUNCTION \"0e03d5c46556a742ba46252698396ef2\".\"4a746717fb433d92a5a49a34d309c5314843539a446edf629a1efb6180b9ca50\" (P_IN_ODATE   IN VARCHAR2)\n   RETURN NUMBER IS\n\n \n\n  \n\n\n\n    v_const         NUMBER := 1 ;\n    v_end_dt        DATE;\n    v_strt_dt       DATE;\n    v_odate         DATE := to_date(p_in_odate,'YYYYMMDD');\n    v_prcs_stp      VARCHAR2(2000);\n    v_ldr_tm        NUMBER(20);\n    v_out_msg       VARCHAR2(256);\n\n   v_dba_func_msg   VARCHAR2(2000) := 'oXo';\n   dml_err_cnt      NUMBER;\n   v_ttl_rows_inserted NUMBER := 0;\n  \n  \n\n\n\n   l_start              NUMBER;\n   l_end                NUMBER;\n   v_table_owner       VARCHAR2(40) := 'XDMADM'; \n   v_table_name        VARCHAR2(40) := 'CASES_AND_RVNUE_BY_GL_ACCT'; \n   v_truncate_tbl      NUMBER(3);\n    v_sls_cd            VARCHAR2(7)  ;\n    v_cost_cd           VARCHAR2(7)  ;\n    v_lpa_cd            VARCHAR2(7)  ;\n    v_npa_cd            VARCHAR2(7)  ;\n    v_rbt_cd            VARCHAR2(7)  ;\n    v_cma_cd            VARCHAR2(7)  ;\n    v_nif_plus_lif_cd  VARCHAR2(7)  ;\n    v_lif_cd           VARCHAR2(7)  ;\n    v_lvf_cd            VARCHAR2(7)  ;\n    v_nif_cd            VARCHAR2(7)  ;\n    v_nvf_cd           VARCHAR2(7)  ;\n\nPROCEDURE insert_1\nIS\nBEGIN\n\n\ninsert into de459e2fe7f96e4d958537b31b946b26.0bc437e6dbeee36674bbae9feb068aa40dd4ce2b7ae4c9cdc3aa8ea0ad37a2da (\n    SELECT brnch_cd,\n            fisc_yr,\n            fisc_mth_of_yr,\n            pyr_seg_cd,\n            gl_acct_cd,\n            cust_acctblty_flg,\n            cust_natl_mngd_flg,\n            SUM(data_value) FROM  (\n          SELECT   brnch_cd,\n                   fisc_yr,\n                   fisc_mth_of_yr,\n                   nvl(pyr_seg_cd, 'UNK') pyr_seg_cd,\n                   v_sls_cd   gl_acct_cd,\n                   cust_acctblty_flg,\n                   cust_natl_mngd_flg,\n                  \n                  \n                   ( SUM(NVL(grs_sls_extnd, 0))\n                   + SUM ( CASE WHEN gl_acct_cd = v_sls_cd THEN (NVL(TTL_AC, 0))  ELSE 0 END )) data_value\n          from de459e2fe7f96e4d958537b31b946b26.ba14007a01f75b8e8b4274a5b262c17d56faed417eee791d565438865e909e90\n          GROUP BY\n             brnch_cd,\n             fisc_yr,\n             fisc_mth_of_yr,\n             nvl(pyr_seg_cd, 'UNK'),\n             v_sls_cd,\n             cust_acctblty_flg,\n             cust_natl_mngd_flg  )\n   GROUP BY\n    brnch_cd,\n    fisc_yr,\n    fisc_mth_of_yr,\n    pyr_seg_cd,\n    gl_acct_cd,\n    cust_acctblty_flg,\n    cust_natl_mngd_flg\n    ) ;\n\n\n         DBMS_OUTPUT.put_line (' NO OF ROWS INSERTED : '||sql%rowcount);\n v_ttl_rows_inserted:=v_ttl_rows_inserted + sql%rowcount;\n COMMIT;\n\nEXCEPTION\n   WHEN OTHERS THEN\n          DBMS_OUTPUT.PUT_LINE ('** ERROR in insert_1. ' || SQLCODE || ' ' || SQLERRM);\n    RAISE;\nEND insert_1;\n\nPROCEDURE insert_2\nIS\nBEGIN\n\ninsert into de459e2fe7f96e4d958537b31b946b26.0bc437e6dbeee36674bbae9feb068aa40dd4ce2b7ae4c9cdc3aa8ea0ad37a2da (\n    SELECT brnch_cd,\n            fisc_yr,\n            fisc_mth_of_yr,\n            pyr_seg_cd,\n            gl_acct_cd,\n            cust_acctblty_flg,\n            cust_natl_mngd_flg,\n            SUM(data_value) FROM  (\n          SELECT   brnch_cd,\n                   fisc_yr,\n                   fisc_mth_of_yr,\n                   nvl(pyr_seg_cd, 'UNK') pyr_seg_cd,\n                   v_cost_cd   gl_acct_cd,\n                   cust_acctblty_flg,\n                   cust_natl_mngd_flg,\n                  \n                  \n                   ( SUM(NVL(dwa_cost_extnd, 0))\n                   + SUM ( CASE WHEN gl_acct_cd = v_cost_cd THEN (NVL(TTL_AC, 0))  ELSE 0 END )) data_value\n          from de459e2fe7f96e4d958537b31b946b26.ba14007a01f75b8e8b4274a5b262c17d56faed417eee791d565438865e909e90\n          GROUP BY\n             brnch_cd,\n             fisc_yr,\n             fisc_mth_of_yr,\n             nvl(pyr_seg_cd, 'UNK'),\n             v_cost_cd,\n             cust_acctblty_flg,\n             cust_natl_mngd_flg  )\n   GROUP BY\n    brnch_cd,\n    fisc_yr,\n    fisc_mth_of_yr,\n    pyr_seg_cd,\n    gl_acct_cd,\n    cust_acctblty_flg,\n    cust_natl_mngd_flg\n    ) ;\n\n\n\n\n         DBMS_OUTPUT.put_line (' NO OF ROWS INSERTED : '||sql%rowcount);\n          v_ttl_rows_inserted:=v_ttl_rows_inserted + sql%rowcount;\n          COMMIT;\n\nEXCEPTION\n   WHEN OTHERS THEN\n          DBMS_OUTPUT.PUT_LINE ('** ERROR in insert_2. ' || SQLCODE || ' ' || SQLERRM);\n    RAISE;\nEND insert_2;\n\nPROCEDURE insert_3\nIS\nBEGIN\n\ninsert into de459e2fe7f96e4d958537b31b946b26.0bc437e6dbeee36674bbae9feb068aa40dd4ce2b7ae4c9cdc3aa8ea0ad37a2da (\n    SELECT brnch_cd,\n            fisc_yr,\n            fisc_mth_of_yr,\n            pyr_seg_cd,\n            gl_acct_cd,\n            cust_acctblty_flg,\n            cust_natl_mngd_flg,\n            SUM(data_value) FROM  (\n          SELECT   brnch_cd,\n                   fisc_yr,\n                   fisc_mth_of_yr,\n                   nvl(pyr_seg_cd, 'UNK') pyr_seg_cd,\n                   v_cma_cd   gl_acct_cd,\n                   cust_acctblty_flg,\n                   cust_natl_mngd_flg,\n                   ( SUM(NVL(natl_mrktng_alwnc_pgms, 0))\n                   + SUM ( CASE WHEN gl_acct_cd = v_cma_cd THEN (NVL(TTL_AC, 0))  ELSE 0 END )) data_value\n          from de459e2fe7f96e4d958537b31b946b26.ba14007a01f75b8e8b4274a5b262c17d56faed417eee791d565438865e909e90\n          GROUP BY\n             brnch_cd,\n             fisc_yr,\n             fisc_mth_of_yr,\n             nvl(pyr_seg_cd, 'UNK'),\n             v_cma_cd,\n             cust_acctblty_flg,\n             cust_natl_mngd_flg  )\n   GROUP BY\n    brnch_cd,\n    fisc_yr,\n    fisc_mth_of_yr,\n    pyr_seg_cd,\n    gl_acct_cd,\n    cust_acctblty_flg,\n    cust_natl_mngd_flg\n    ) ;\n\n          DBMS_OUTPUT.put_line (' NO OF ROWS INSERTED : '||sql%rowcount);\n           v_ttl_rows_inserted:=v_ttl_rows_inserted + sql%rowcount;\n          COMMIT;\n\nEXCEPTION\n   WHEN OTHERS THEN\n          DBMS_OUTPUT.PUT_LINE ('** ERROR in insert_3. ' || SQLCODE || ' ' || SQLERRM);\n    RAISE;\nEND insert_3;\n\nPROCEDURE insert_4\nIS\nBEGIN\n\ninsert into de459e2fe7f96e4d958537b31b946b26.0bc437e6dbeee36674bbae9feb068aa40dd4ce2b7ae4c9cdc3aa8ea0ad37a2da (\n    SELECT brnch_cd,\n            fisc_yr,\n            fisc_mth_of_yr,\n            pyr_seg_cd,\n            gl_acct_cd,\n            cust_acctblty_flg,\n            cust_natl_mngd_flg,\n            SUM(data_value) FROM  (\n          SELECT   brnch_cd,\n                   fisc_yr,\n                   fisc_mth_of_yr,\n                   nvl(pyr_seg_cd, 'UNK') pyr_seg_cd,\n                   v_npa_cd   gl_acct_cd,\n                   cust_acctblty_flg,\n                   cust_natl_mngd_flg,\n                ( SUM(NVL(natl_one_tm, 0))\n                + SUM(NVL(natl_prom_alwnc_pgms, 0))\n                + SUM ( CASE WHEN gl_acct_cd = v_npa_cd THEN (NVL(TTL_AC, 0))  ELSE 0 END )) data_value\n          from de459e2fe7f96e4d958537b31b946b26.ba14007a01f75b8e8b4274a5b262c17d56faed417eee791d565438865e909e90\n          GROUP BY\n             brnch_cd,\n             fisc_yr,\n             fisc_mth_of_yr,\n             nvl(pyr_seg_cd, 'UNK'),\n             v_npa_cd,\n             cust_acctblty_flg,\n             cust_natl_mngd_flg  )\n   GROUP BY\n    brnch_cd,\n    fisc_yr,\n    fisc_mth_of_yr,\n    pyr_seg_cd,\n    gl_acct_cd,\n    cust_acctblty_flg,\n    cust_natl_mngd_flg\n    ) ;\n\n          DBMS_OUTPUT.put_line (' NO OF ROWS INSERTED : '||sql%rowcount);\n           v_ttl_rows_inserted:=v_ttl_rows_inserted + sql%rowcount;\n          COMMIT;\n\nEXCEPTION\n   WHEN OTHERS THEN\n          DBMS_OUTPUT.PUT_LINE ('** ERROR in insert_4. ' || SQLCODE || ' ' || SQLERRM);\n    RAISE;\nEND insert_4;\n\nPROCEDURE insert_5\nIS\nBEGIN\n\ninsert into de459e2fe7f96e4d958537b31b946b26.0bc437e6dbeee36674bbae9feb068aa40dd4ce2b7ae4c9cdc3aa8ea0ad37a2da (\n    SELECT brnch_cd,\n            fisc_yr,\n            fisc_mth_of_yr,\n            pyr_seg_cd,\n            gl_acct_cd,\n            cust_acctblty_flg,\n            cust_natl_mngd_flg,\n            SUM(data_value) FROM  (\n          SELECT   brnch_cd,\n                   fisc_yr,\n                   fisc_mth_of_yr,\n                   nvl(pyr_seg_cd, 'UNK') pyr_seg_cd,\n                   v_lpa_cd   gl_acct_cd,\n                   cust_acctblty_flg,\n                   cust_natl_mngd_flg,\n                ( SUM(NVL(loc_one_tm, 0))\n                + SUM(NVL(loc_prom_alwnc_pgms, 0))\n                + SUM(NVL(loc_mrktng_alwnc_pgms, 0))\n                + SUM ( CASE WHEN gl_acct_cd = v_lpa_cd THEN (NVL(TTL_AC, 0))  ELSE 0 END )) data_value\n         from de459e2fe7f96e4d958537b31b946b26.ba14007a01f75b8e8b4274a5b262c17d56faed417eee791d565438865e909e90\n          GROUP BY\n             brnch_cd,\n             fisc_yr,\n             fisc_mth_of_yr,\n             nvl(pyr_seg_cd, 'UNK'),\n             v_lpa_cd,\n             cust_acctblty_flg,\n             cust_natl_mngd_flg  )\n   GROUP BY\n    brnch_cd,\n    fisc_yr,\n    fisc_mth_of_yr,\n    pyr_seg_cd,\n    gl_acct_cd,\n    cust_acctblty_flg,\n    cust_natl_mngd_flg\n    ) ;\n\n          DBMS_OUTPUT.put_line (' NO OF ROWS INSERTED : '||sql%rowcount);\n           v_ttl_rows_inserted:=v_ttl_rows_inserted + sql%rowcount;\n          COMMIT;\n\nEXCEPTION\n   WHEN OTHERS THEN\n          DBMS_OUTPUT.PUT_LINE ('** ERROR in insert_5. ' || SQLCODE || ' ' || SQLERRM);\n     RAISE;\nEND insert_5;\n\nPROCEDURE insert_6\nIS\nBEGIN\n\ninsert into de459e2fe7f96e4d958537b31b946b26.0bc437e6dbeee36674bbae9feb068aa40dd4ce2b7ae4c9cdc3aa8ea0ad37a2da (\n    SELECT brnch_cd,\n            fisc_yr,\n            fisc_mth_of_yr,\n            pyr_seg_cd,\n            gl_acct_cd,\n            cust_acctblty_flg,\n            cust_natl_mngd_flg,\n            SUM(data_value) FROM  (\n          SELECT   brnch_cd,\n                   fisc_yr,\n                   fisc_mth_of_yr,\n                   nvl(pyr_seg_cd, 'UNK') pyr_seg_cd,\n                   v_nvf_cd   gl_acct_cd,\n                   cust_acctblty_flg,\n                   cust_natl_mngd_flg,\n                 ( SUM(NVL(natl_vndr_fnd_dvt, 0)) ) data_value\n             \n         from de459e2fe7f96e4d958537b31b946b26.ba14007a01f75b8e8b4274a5b262c17d56faed417eee791d565438865e909e90\n          GROUP BY\n             brnch_cd,\n             fisc_yr,\n             fisc_mth_of_yr,\n             nvl(pyr_seg_cd, 'UNK'),\n             v_nvf_cd,\n             cust_acctblty_flg,\n             cust_natl_mngd_flg  )\n   GROUP BY\n    brnch_cd,\n    fisc_yr,\n    fisc_mth_of_yr,\n    pyr_seg_cd,\n    gl_acct_cd,\n    cust_acctblty_flg,\n    cust_natl_mngd_flg\n    ) ;\n\n          DBMS_OUTPUT.put_line (' NO OF ROWS INSERTED : '||sql%rowcount);\n           v_ttl_rows_inserted:=v_ttl_rows_inserted + sql%rowcount;\n          COMMIT;\n\nEXCEPTION\n   WHEN OTHERS THEN\n          DBMS_OUTPUT.PUT_LINE ('** ERROR in insert_6. ' || SQLCODE || ' ' || SQLERRM);\n     RAISE;\nEND insert_6;\n\nPROCEDURE insert_7\nIS\nBEGIN\n\ninsert into de459e2fe7f96e4d958537b31b946b26.0bc437e6dbeee36674bbae9feb068aa40dd4ce2b7ae4c9cdc3aa8ea0ad37a2da (\n    SELECT brnch_cd,\n            fisc_yr,\n            fisc_mth_of_yr,\n            pyr_seg_cd,\n            gl_acct_cd,\n            cust_acctblty_flg,\n            cust_natl_mngd_flg,\n            SUM(data_value) FROM  (\n          SELECT   brnch_cd,\n                   fisc_yr,\n                   fisc_mth_of_yr,\n                   nvl(pyr_seg_cd, 'UNK') pyr_seg_cd,\n                   v_nif_cd   gl_acct_cd,\n                   cust_acctblty_flg,\n                   cust_natl_mngd_flg,\n                 ( SUM(NVL(natl_int_dvt, 0))) data_value\n                \n         from de459e2fe7f96e4d958537b31b946b26.ba14007a01f75b8e8b4274a5b262c17d56faed417eee791d565438865e909e90\n          GROUP BY\n             brnch_cd,\n             fisc_yr,\n             fisc_mth_of_yr,\n             nvl(pyr_seg_cd, 'UNK'),\n             v_nif_cd,\n             cust_acctblty_flg,\n             cust_natl_mngd_flg  )\n   GROUP BY\n    brnch_cd,\n    fisc_yr,\n    fisc_mth_of_yr,\n    pyr_seg_cd,\n    gl_acct_cd,\n    cust_acctblty_flg,\n    cust_natl_mngd_flg\n    ) ;\n\n          DBMS_OUTPUT.put_line (' NO OF ROWS INSERTED : '||sql%rowcount);\n           v_ttl_rows_inserted:=v_ttl_rows_inserted + sql%rowcount;\n          COMMIT;\n\nEXCEPTION\n   WHEN OTHERS THEN\n          DBMS_OUTPUT.PUT_LINE ('** ERROR in insert_7. ' || SQLCODE || ' ' || SQLERRM);\n     RAISE;\nEND insert_7;\n\nPROCEDURE insert_8\nIS\nBEGIN\n\ninsert into de459e2fe7f96e4d958537b31b946b26.0bc437e6dbeee36674bbae9feb068aa40dd4ce2b7ae4c9cdc3aa8ea0ad37a2da (\n    SELECT brnch_cd,\n            fisc_yr,\n            fisc_mth_of_yr,\n            pyr_seg_cd,\n            gl_acct_cd,\n            cust_acctblty_flg,\n            cust_natl_mngd_flg,\n            SUM(data_value) FROM  (\n          SELECT   brnch_cd,\n                   fisc_yr,\n                   fisc_mth_of_yr,\n                   nvl(pyr_seg_cd, 'UNK') pyr_seg_cd,\n                   v_lvf_cd   gl_acct_cd,\n                   cust_acctblty_flg,\n                   cust_natl_mngd_flg,\n                 ( SUM(NVL(loc_vndr_fnd_dvt, 0))\n                 + SUM ( CASE WHEN gl_acct_cd = v_lvf_cd THEN (NVL(TTL_AC, 0))  ELSE 0 END )) data_value\n         from de459e2fe7f96e4d958537b31b946b26.ba14007a01f75b8e8b4274a5b262c17d56faed417eee791d565438865e909e90\n          GROUP BY\n             brnch_cd,\n             fisc_yr,\n             fisc_mth_of_yr,\n             nvl(pyr_seg_cd, 'UNK'),\n             v_lvf_cd,\n             cust_acctblty_flg,\n             cust_natl_mngd_flg  )\n   GROUP BY\n    brnch_cd,\n    fisc_yr,\n    fisc_mth_of_yr,\n    pyr_seg_cd,\n    gl_acct_cd,\n    cust_acctblty_flg,\n    cust_natl_mngd_flg\n    ) ;\n\n          DBMS_OUTPUT.put_line (' NO OF ROWS INSERTED : '||sql%rowcount);\n           v_ttl_rows_inserted:=v_ttl_rows_inserted + sql%rowcount;\n          COMMIT;\n\nEXCEPTION\n   WHEN OTHERS THEN\n          DBMS_OUTPUT.PUT_LINE ('** ERROR in insert_8. ' || SQLCODE || ' ' || SQLERRM);\n     RAISE;\nEND insert_8;\n\nPROCEDURE insert_9\nIS\nBEGIN\n\ninsert into de459e2fe7f96e4d958537b31b946b26.0bc437e6dbeee36674bbae9feb068aa40dd4ce2b7ae4c9cdc3aa8ea0ad37a2da (\n    SELECT brnch_cd,\n            fisc_yr,\n            fisc_mth_of_yr,\n            pyr_seg_cd,\n            gl_acct_cd,\n            cust_acctblty_flg,\n            cust_natl_mngd_flg,\n            SUM(data_value) FROM  (\n          SELECT   brnch_cd,\n                   fisc_yr,\n                   fisc_mth_of_yr,\n                   nvl(pyr_seg_cd, 'UNK') pyr_seg_cd,\n                   v_lif_cd   gl_acct_cd,\n                   cust_acctblty_flg,\n                   cust_natl_mngd_flg,\n                 ( SUM(NVL(loc_int_dvt, 0))) data_value\n                \n         from de459e2fe7f96e4d958537b31b946b26.ba14007a01f75b8e8b4274a5b262c17d56faed417eee791d565438865e909e90\n          GROUP BY\n             brnch_cd,\n             fisc_yr,\n             fisc_mth_of_yr,\n             nvl(pyr_seg_cd, 'UNK'),\n             v_lif_cd,\n             cust_acctblty_flg,\n             cust_natl_mngd_flg  )\n   GROUP BY\n    brnch_cd,\n    fisc_yr,\n    fisc_mth_of_yr,\n    pyr_seg_cd,\n    gl_acct_cd,\n    cust_acctblty_flg,\n    cust_natl_mngd_flg\n    ) ;\n\n          DBMS_OUTPUT.put_line (' NO OF ROWS INSERTED : '||sql%rowcount);\n           v_ttl_rows_inserted:=v_ttl_rows_inserted + sql%rowcount;\n          COMMIT;\n\nEXCEPTION\n   WHEN OTHERS THEN\n          DBMS_OUTPUT.PUT_LINE ('** ERROR in insert_9. ' || SQLCODE || ' ' || SQLERRM);\n     RAISE;\nEND insert_9;\n\n\nPROCEDURE insert_10\nIS\nBEGIN\n\ninsert into de459e2fe7f96e4d958537b31b946b26.0bc437e6dbeee36674bbae9feb068aa40dd4ce2b7ae4c9cdc3aa8ea0ad37a2da (\n    SELECT brnch_cd,\n            fisc_yr,\n            fisc_mth_of_yr,\n            pyr_seg_cd,\n            gl_acct_cd,\n            cust_acctblty_flg,\n            cust_natl_mngd_flg,\n            SUM(data_value) FROM  (\n          SELECT   brnch_cd,\n                   fisc_yr,\n                   fisc_mth_of_yr,\n                   nvl(pyr_seg_cd, 'UNK') pyr_seg_cd,\n                   v_nif_plus_lif_cd   gl_acct_cd,\n                   cust_acctblty_flg,\n                   cust_natl_mngd_flg,\n                  \n                   decode(sign (SUM(NVL(loc_int_dvt, 0)) + SUM(NVL(natl_int_dvt, 0)) ),0, 0, ((-1) * (SUM(NVL(loc_int_dvt, 0)) + SUM(NVL(natl_int_dvt, 0)) ))) data_value\n     from de459e2fe7f96e4d958537b31b946b26.ba14007a01f75b8e8b4274a5b262c17d56faed417eee791d565438865e909e90\n          GROUP BY\n             brnch_cd,\n             fisc_yr,\n             fisc_mth_of_yr,\n             nvl(pyr_seg_cd, 'UNK'),\n             v_nif_plus_lif_cd,\n             cust_acctblty_flg,\n             cust_natl_mngd_flg  )\n   GROUP BY\n    brnch_cd,\n    fisc_yr,\n    fisc_mth_of_yr,\n    pyr_seg_cd,\n    gl_acct_cd,\n    cust_acctblty_flg,\n    cust_natl_mngd_flg\n    ) ;\n\n          DBMS_OUTPUT.put_line (' NO OF ROWS INSERTED : '||sql%rowcount);\n           v_ttl_rows_inserted:=v_ttl_rows_inserted + sql%rowcount;\n          COMMIT;\n\nEXCEPTION\n   WHEN OTHERS THEN\n          DBMS_OUTPUT.PUT_LINE ('** ERROR in insert_10. ' || SQLCODE || ' ' || SQLERRM);\n     RAISE;\nEND insert_10;\n\nPROCEDURE insert_11\nIS\nBEGIN\n\ninsert into de459e2fe7f96e4d958537b31b946b26.0bc437e6dbeee36674bbae9feb068aa40dd4ce2b7ae4c9cdc3aa8ea0ad37a2da (\n    SELECT brnch_cd,\n            fisc_yr,\n            fisc_mth_of_yr,\n            pyr_seg_cd,\n            gl_acct_cd,\n            cust_acctblty_flg,\n            cust_natl_mngd_flg,\n            SUM(data_value) FROM  (\n          SELECT   brnch_cd,\n                   fisc_yr,\n                   fisc_mth_of_yr,\n                   nvl(pyr_seg_cd, 'UNK') pyr_seg_cd,\n                   v_rbt_cd   gl_acct_cd,\n                   cust_acctblty_flg,\n                   cust_natl_mngd_flg,\n                 ( SUM(NVL(rbt_loc_accrl_amt, 0))\n                 + SUM(NVL(rbt_natl_accrl_amt, 0))\n                 + SUM(NVL(rbt_loc_exp_amt, 0))\n                 + SUM(NVL(rbt_natl_exp_amt, 0))\n                 + SUM ( CASE WHEN gl_acct_cd = v_rbt_cd THEN (NVL(TTL_AC, 0))  ELSE 0 END )) data_value\n         from de459e2fe7f96e4d958537b31b946b26.ba14007a01f75b8e8b4274a5b262c17d56faed417eee791d565438865e909e90\n          GROUP BY\n             brnch_cd,\n             fisc_yr,\n             fisc_mth_of_yr,\n             nvl(pyr_seg_cd, 'UNK'),\n             v_rbt_cd,\n             cust_acctblty_flg,\n             cust_natl_mngd_flg  )\n   GROUP BY\n    brnch_cd,\n    fisc_yr,\n    fisc_mth_of_yr,\n    pyr_seg_cd,\n    gl_acct_cd,\n    cust_acctblty_flg,\n    cust_natl_mngd_flg\n    ) ;\n\n          DBMS_OUTPUT.put_line (' NO OF ROWS INSERTED : '||sql%rowcount);\n           v_ttl_rows_inserted:=v_ttl_rows_inserted + sql%rowcount;\n          COMMIT;\n\n\nEXCEPTION\n   WHEN OTHERS THEN\n          DBMS_OUTPUT.PUT_LINE ('** ERROR in insert_11. ' || SQLCODE || ' ' || SQLERRM);\n    RAISE;\nEND insert_11;\nPROCEDURE insert_12\nIS\nBEGIN\n\ninsert into de459e2fe7f96e4d958537b31b946b26.0bc437e6dbeee36674bbae9feb068aa40dd4ce2b7ae4c9cdc3aa8ea0ad37a2da (\n    SELECT brnch_cd,\n            fisc_yr,\n            fisc_mth_of_yr,\n            pyr_seg_cd,\n            gl_acct_cd,\n            cust_acctblty_flg,\n            cust_natl_mngd_flg,\n            SUM(data_value) FROM  (\n          SELECT   brnch_cd,\n                   fisc_yr,\n                   fisc_mth_of_yr,\n                   nvl(pyr_seg_cd, 'UNK') pyr_seg_cd,\n                   gl_acct_cd,\n                   cust_acctblty_flg,\n                   cust_natl_mngd_flg,\n                   SUM  (NVL(TTL_AC, 0))  data_value\n           from de459e2fe7f96e4d958537b31b946b26.ba14007a01f75b8e8b4274a5b262c17d56faed417eee791d565438865e909e90\n          where gl_acct_cd in ( select param_value_chr from de459e2fe7f96e4d958537b31b946b26.de40ae7be8b2eb3858d46af8d107f3db where app_name = 'HYP_PLANNING' and param_type = 'AR_GL_ACCT_CD' )\n          GROUP BY\n             brnch_cd,\n             fisc_yr,\n             fisc_mth_of_yr,\n             nvl(pyr_seg_cd, 'UNK'),\n             gl_acct_cd,\n             cust_acctblty_flg,\n             cust_natl_mngd_flg  )\n   GROUP BY\n    brnch_cd,\n    fisc_yr,\n    fisc_mth_of_yr,\n    pyr_seg_cd,\n    gl_acct_cd,\n    cust_acctblty_flg,\n    cust_natl_mngd_flg\n    ) ;\n\n\n\n         DBMS_OUTPUT.put_line (' NO OF ROWS INSERTED : '||sql%rowcount);\n          v_ttl_rows_inserted:=v_ttl_rows_inserted + sql%rowcount;\n          COMMIT;\n\nEXCEPTION\n   WHEN OTHERS THEN\n          DBMS_OUTPUT.PUT_LINE ('** ERROR in insert_12. ' || SQLCODE || ' ' || SQLERRM);\n     RAISE;\nEND insert_12;\n\n\nBEGIN\n\n\n  BEGIN\n\n   v_prcs_stp := 'Assigning variables ..... ';\n\n    select param_value_chr  INTO v_sls_cd from de459e2fe7f96e4d958537b31b946b26.02e9d63d10f9b42832e13b830a66cb4e\n     where app_name = 'HYP_PLANNING'\n      and param_type = 'GRS_SLS_EXTND_plus_AR_GL_ACCT_CD'\n      and param_code = '4000001';\n\n    select param_value_chr  INTO v_cost_cd from de459e2fe7f96e4d958537b31b946b26.02e9d63d10f9b42832e13b830a66cb4e\n      where app_name = 'HYP_PLANNING'\n        and param_type = 'DWA_COST_EXTND_plus_AR_GL_ACCT_CD'\n        and param_code = '5000001';\n\n    select param_value_chr  INTO v_lpa_cd from de459e2fe7f96e4d958537b31b946b26.02e9d63d10f9b42832e13b830a66cb4e\n     where app_name = 'HYP_PLANNING'\n      and param_type = 'LPA_plus_AR_GL_ACCT_CD'\n      and param_code = '5310501';\n\n    select param_value_chr  INTO v_npa_cd from de459e2fe7f96e4d958537b31b946b26.02e9d63d10f9b42832e13b830a66cb4e\n      where app_name = 'HYP_PLANNING'\n        and param_type = 'NPA_plus_AR_GL_ACCT_CD'\n        and param_code = '5300101';\n\n        select param_value_chr  INTO v_rbt_cd from de459e2fe7f96e4d958537b31b946b26.02e9d63d10f9b42832e13b830a66cb4e\n      where app_name = 'HYP_PLANNING'\n        and param_type = 'RBT_plus_AR_GL_ACCT_CD'\n        and param_code = '4170001';\n\n    select param_value_chr  INTO v_cma_cd from de459e2fe7f96e4d958537b31b946b26.02e9d63d10f9b42832e13b830a66cb4e\n     where app_name = 'HYP_PLANNING'\n      and param_type = 'CMA_plus_AR_GL_ACCT_CD'\n      and param_code = '5320600';\n\n    select param_value_chr  INTO v_nif_plus_lif_cd from de459e2fe7f96e4d958537b31b946b26.02e9d63d10f9b42832e13b830a66cb4e\n      where app_name = 'HYP_PLANNING'\n        and param_type = 'NIF_plus_LIF_GL_ACCT_CD'\n        and param_code = '5005901';\n\n    select param_value_chr  INTO v_lif_cd from de459e2fe7f96e4d958537b31b946b26.02e9d63d10f9b42832e13b830a66cb4e\n     where app_name = 'HYP_PLANNING'\n      and param_type = 'LIF_GL_ACCT_CD'\n      and param_code = '5005601';\n\n    select param_value_chr  INTO v_lvf_cd from de459e2fe7f96e4d958537b31b946b26.02e9d63d10f9b42832e13b830a66cb4e\n      where app_name = 'HYP_PLANNING'\n        and param_type = 'LVF_plus_AR_GL_ACCT_CD'\n        and param_code = '5005501';\n\n    select param_value_chr  INTO v_nvf_cd from de459e2fe7f96e4d958537b31b946b26.02e9d63d10f9b42832e13b830a66cb4e\n     where app_name = 'HYP_PLANNING'\n      and param_type = 'NVF_GL_ACCT_CD'\n      and param_code = '5005001';\n\n    select param_value_chr  INTO v_nif_cd from de459e2fe7f96e4d958537b31b946b26.02e9d63d10f9b42832e13b830a66cb4e\n     where app_name = 'HYP_PLANNING'\n      and param_type = 'NIF_GL_ACCT_CD'\n      and param_code = '5005101';\n\n\n    EXCEPTION\n          WHEN OTHERS\n          THEN\n             DBMS_OUTPUT.put_line('Error in v_prcs_stp : ' || v_prcs_stp );\n\n             RETURN 1000;\n\n\n END;\n\n\n BEGIN\n    v_prcs_stp := 'GET LDR_TM ';\n\n\n       DBMS_OUTPUT.PUT_LINE('Run Date is:' || v_odate ) ;\n\n\n     select to_number(to_char(sysdate, 'YYYYMMDDHH24MISS'))\n      INTO v_ldr_tm\n      FROM DUAL;\n\n\n\n      DBMS_OUTPUT.put_line ('LDR_TM is :'  ||v_ldr_tm);\n\n\n     EXCEPTION\n          WHEN OTHERS\n          THEN\n             DBMS_OUTPUT.put_line('Error in v_prcs_stp : ' || v_prcs_stp );\n\n             RETURN 900;\n        END;\n\n\n\n  \n  \n  BEGIN\n       v_prcs_stp := 'INSERT INTO table starts ';\n       l_start := DBMS_UTILITY.get_time;\n\n        DBMS_OUTPUT.PUT_LINE('TIME ' || to_char(sysdate, 'yyyymmdd hh24:mi:ss'));\n\n  DBMS_OUTPUT.PUT_LINE('Executing insert_1');\n  insert_1;\n  DBMS_OUTPUT.PUT_LINE('Executing insert_2');\n  insert_2;\n  DBMS_OUTPUT.PUT_LINE('Executing insert_3');\n  insert_3;\n  DBMS_OUTPUT.PUT_LINE('Executing insert_4');\n  insert_4;\n  DBMS_OUTPUT.PUT_LINE('Executing insert_5');\n  insert_5;\n\n  DBMS_OUTPUT.PUT_LINE('Executing insert_6');\n  insert_6;\n  DBMS_OUTPUT.PUT_LINE('Executing insert_7');\n  insert_7;\n  DBMS_OUTPUT.PUT_LINE('Executing insert_8');\n  insert_8;\n  DBMS_OUTPUT.PUT_LINE('Executing insert_9');\n  insert_9;\n  DBMS_OUTPUT.PUT_LINE('Executing insert_10');\n  insert_10;\n\n  DBMS_OUTPUT.PUT_LINE('Executing insert_11');\n  insert_11;\n  DBMS_OUTPUT.PUT_LINE('Executing insert_12');\n  insert_12;\n\n\n\n   COMMIT;\n\n\n\n      l_end := DBMS_UTILITY.get_time;\n\n    DBMS_OUTPUT.PUT_LINE('*************************************************************');\n    DBMS_OUTPUT.PUT_LINE('Total no of rows inserted into table de459e2fe7f96e4d958537b31b946b26.0bc437e6dbeee36674bbae9feb068aa40dd4ce2b7ae4c9cdc3aa8ea0ad37a2da :' || v_ttl_rows_inserted ) ;\n    DBMS_OUTPUT.PUT_LINE('*************************************************************');\n    DBMS_OUTPUT.PUT_LINE ( round( (l_end - l_start)/100, 2 ) ||' seconds...' );\n\n    DBMS_OUTPUT.PUT_LINE ('FN_CASES_AND_RVNUE_BY_GL_ACCT_LOAD completed successfully ' ) ;\n\n      RETURN 0;\n\n    END;\n\n\n   \n   \n   \n\n    EXCEPTION\n      WHEN OTHERS\n      THEN\n     ROLLBACK;\n    DBMS_OUTPUT.PUT_LINE(SQLCODE);\n     DBMS_OUTPUT.PUT_LINE(SQLERRM);\n         \n        \n\n         DBMS_OUTPUT.put_line('Error in function FN_RVNUE_BY_GL_ACCT_LOAD');\n    RETURN 600;\n\n\n\nEND FN_RVNUE_BY_GL_ACCT_LOAD;\n/",
            "upstream_dependencies": [],
            "downstream_dependencies": [],
            "dag_location": "null",
            "gantt_location": "null",
            "created_at": "null",
            "updated_at": "null"
        },
        {
            "name": "FN_RVNUE_BY_GL_ACCT_LOAD_WK",
            "encrypted_name": "4a746717fb433d92a5a49a34d309c531c10e2302d31431641848a526ce24a458",
            "type": "function",
            "database": "null",
            "encrypted_database": "null",
            "schema": "XDMADM",
            "encrypted_schema": "0e03d5c46556a742ba46252698396ef2",
            "fully_qualified_name": "XDMADM.FN_RVNUE_BY_GL_ACCT_LOAD_WK",
            "encrypted_fqn": "0e03d5c46556a742ba46252698396ef2.4a746717fb433d92a5a49a34d309c531c10e2302d31431641848a526ce24a458",
            "synonyms": [],
            "metadata_analysis": "CREATE OR REPLACE FUNCTION \"0e03d5c46556a742ba46252698396ef2\".\"4a746717fb433d92a5a49a34d309c531c10e2302d31431641848a526ce24a458\" (p_in_odate IN VARCHAR2)\n   RETURN NUMBER IS\n   \n\n   \n   v_const               NUMBER := 1;\n   v_end_dt              DATE;\n   v_strt_dt             DATE;\n   v_odate               DATE := TO_DATE(p_in_odate, 'YYYYMMDD');\n   v_prcs_stp            VARCHAR2(2000);\n   v_ldr_tm              NUMBER(20);\n   v_out_msg             VARCHAR2(256);\n\n   v_dba_func_msg        VARCHAR2(2000) := 'oXo';\n   dml_err_cnt           NUMBER;\n   v_ttl_rows_inserted   NUMBER := 0;\n\n   l_start               NUMBER;\n   l_end                 NUMBER;\n   v_table_owner         VARCHAR2(40) := 'XDMADM'; \n   v_table_name          VARCHAR2(40) := 'CASES_AND_RVNUE_BY_GL_ACCT_WK'; \n   v_truncate_tbl        NUMBER(3);\n   v_sls_cd              VARCHAR2(7);\n   v_cost_cd             VARCHAR2(7);\n   v_lpa_cd              VARCHAR2(7);\n   v_npa_cd              VARCHAR2(7);\n   v_rbt_cd              VARCHAR2(7);\n   v_cma_cd              VARCHAR2(7);\n   v_nif_plus_lif_cd     VARCHAR2(7);\n   v_lif_cd              VARCHAR2(7);\n   v_lvf_cd              VARCHAR2(7);\n   v_nif_cd              VARCHAR2(7);\n   v_nvf_cd              VARCHAR2(7);\n\n   PROCEDURE insert_1 IS\n   BEGIN\n      INSERT INTO de459e2fe7f96e4d958537b31b946b26.f2712065b4111f67f478dd0b3bf131add5e20efc7ee6c6e059f98dc123224871\n         (  SELECT brnch_cd,\n                   fisc_yr,\n                   fisc_mth_of_yr,\n                   fisc_wk_of_prd,\n                   pyr_seg_cd,\n                   gl_acct_cd,\n                   cust_acctblty_flg,\n                   cust_natl_mngd_flg,\n                   SUM(data_value)\n              FROM (  SELECT brnch_cd,\n                             fisc_yr,\n                             fisc_mth_of_yr,\n                             fisc_wk_of_prd,\n                             NVL(pyr_seg_cd, 'UNK') pyr_seg_cd,\n                             v_sls_cd gl_acct_cd,\n                             cust_acctblty_flg,\n                             cust_natl_mngd_flg,\n                             (SUM(NVL(grs_sls_extnd, 0))\n                              + SUM(CASE WHEN gl_acct_cd = v_sls_cd THEN (NVL(ttl_ac, 0)) ELSE 0 END))\n                                data_value\n                        FROM de459e2fe7f96e4d958537b31b946b26.d458a891beb1ff0770a0f972079229c75fb73c9cf39b9202cce0c34fe9931634\n                    GROUP BY brnch_cd,\n                             fisc_yr,\n                             fisc_mth_of_yr,\n                             fisc_wk_of_prd,\n                             NVL(pyr_seg_cd, 'UNK'),\n                             v_sls_cd,\n                             cust_acctblty_flg,\n                             cust_natl_mngd_flg)\n          GROUP BY brnch_cd,\n                   fisc_yr,\n                   fisc_mth_of_yr,\n                   fisc_wk_of_prd,\n                   pyr_seg_cd,\n                   gl_acct_cd,\n                   cust_acctblty_flg,\n                   cust_natl_mngd_flg);\n\n      DBMS_OUTPUT.put_line(' NO OF ROWS INSERTED : ' || sql%ROWCOUNT);\n      v_ttl_rows_inserted   := v_ttl_rows_inserted + sql%ROWCOUNT;\n      COMMIT;\n   EXCEPTION\n      WHEN OTHERS THEN\n         DBMS_OUTPUT.put_line('** ERROR in insert_1. ' || SQLCODE || ' ' || SQLERRM);\n         RAISE;\n   END insert_1;\n\n   PROCEDURE insert_2 IS\n   BEGIN\n      INSERT INTO de459e2fe7f96e4d958537b31b946b26.f2712065b4111f67f478dd0b3bf131add5e20efc7ee6c6e059f98dc123224871\n         (  SELECT brnch_cd,\n                   fisc_yr,\n                   fisc_mth_of_yr,\n                   fisc_wk_of_prd,\n                   pyr_seg_cd,\n                   gl_acct_cd,\n                   cust_acctblty_flg,\n                   cust_natl_mngd_flg,\n                   SUM(data_value)\n              FROM (  SELECT brnch_cd,\n                             fisc_yr,\n                             fisc_mth_of_yr,\n                             fisc_wk_of_prd,\n                             NVL(pyr_seg_cd, 'UNK') pyr_seg_cd,\n                             v_cost_cd gl_acct_cd,\n                             cust_acctblty_flg,\n                             cust_natl_mngd_flg,\n                             (SUM(NVL(dwa_cost_extnd, 0))\n                              + SUM(CASE WHEN gl_acct_cd = v_cost_cd THEN (NVL(ttl_ac, 0)) ELSE 0 END))\n                                data_value\n                        FROM de459e2fe7f96e4d958537b31b946b26.d458a891beb1ff0770a0f972079229c75fb73c9cf39b9202cce0c34fe9931634\n                    GROUP BY brnch_cd,\n                             fisc_yr,\n                             fisc_mth_of_yr,\n                             fisc_wk_of_prd,\n                             NVL(pyr_seg_cd, 'UNK'),\n                             v_cost_cd,\n                             cust_acctblty_flg,\n                             cust_natl_mngd_flg)\n          GROUP BY brnch_cd,\n                   fisc_yr,\n                   fisc_mth_of_yr,\n                   fisc_wk_of_prd,\n                   pyr_seg_cd,\n                   gl_acct_cd,\n                   cust_acctblty_flg,\n                   cust_natl_mngd_flg);\n\n      DBMS_OUTPUT.put_line(' NO OF ROWS INSERTED : ' || sql%ROWCOUNT);\n      v_ttl_rows_inserted   := v_ttl_rows_inserted + sql%ROWCOUNT;\n      COMMIT;\n   EXCEPTION\n      WHEN OTHERS THEN\n         DBMS_OUTPUT.put_line('** ERROR in insert_2. ' || SQLCODE || ' ' || SQLERRM);\n         RAISE;\n   END insert_2;\n\n   \n   PROCEDURE insert_3 IS\n   BEGIN\n      INSERT INTO de459e2fe7f96e4d958537b31b946b26.f2712065b4111f67f478dd0b3bf131add5e20efc7ee6c6e059f98dc123224871\n         (  SELECT brnch_cd,\n                   fisc_yr,\n                   fisc_mth_of_yr,\n                   fisc_wk_of_prd,\n                   pyr_seg_cd,\n                   gl_acct_cd,\n                   cust_acctblty_flg,\n                   cust_natl_mngd_flg,\n                   SUM(data_value)\n              FROM (  SELECT brnch_cd,\n                             fisc_yr,\n                             fisc_mth_of_yr,\n                             fisc_wk_of_prd,\n                             NVL(pyr_seg_cd, 'UNK') pyr_seg_cd,\n                             v_cma_cd gl_acct_cd,\n                             cust_acctblty_flg,\n                             cust_natl_mngd_flg,\n                             (SUM(NVL(natl_mrktng_alwnc_pgms, 0))\n                              + SUM(CASE WHEN gl_acct_cd = v_cma_cd THEN (NVL(ttl_ac, 0)) ELSE 0 END))\n                                data_value\n                        FROM de459e2fe7f96e4d958537b31b946b26.d458a891beb1ff0770a0f972079229c75fb73c9cf39b9202cce0c34fe9931634\n                    GROUP BY brnch_cd,\n                             fisc_yr,\n                             fisc_mth_of_yr,\n                             fisc_wk_of_prd,\n                             NVL(pyr_seg_cd, 'UNK'),\n                             v_cma_cd,\n                             cust_acctblty_flg,\n                             cust_natl_mngd_flg)\n          GROUP BY brnch_cd,\n                   fisc_yr,\n                   fisc_mth_of_yr,\n                   fisc_wk_of_prd,\n                   pyr_seg_cd,\n                   gl_acct_cd,\n                   cust_acctblty_flg,\n                   cust_natl_mngd_flg);\n\n      DBMS_OUTPUT.put_line(' NO OF ROWS INSERTED : ' || sql%ROWCOUNT);\n      v_ttl_rows_inserted   := v_ttl_rows_inserted + sql%ROWCOUNT;\n      COMMIT;\n   EXCEPTION\n      WHEN OTHERS THEN\n         DBMS_OUTPUT.put_line('** ERROR in insert_3. ' || SQLCODE || ' ' || SQLERRM);\n         RAISE;\n   END insert_3;\n\n   \n   PROCEDURE insert_4 IS\n   BEGIN\n      INSERT INTO de459e2fe7f96e4d958537b31b946b26.f2712065b4111f67f478dd0b3bf131add5e20efc7ee6c6e059f98dc123224871\n         (  SELECT brnch_cd,\n                   fisc_yr,\n                   fisc_mth_of_yr,\n                   fisc_wk_of_prd,\n                   pyr_seg_cd,\n                   gl_acct_cd,\n                   cust_acctblty_flg,\n                   cust_natl_mngd_flg,\n                   SUM(data_value)\n              FROM (  SELECT brnch_cd,\n                             fisc_yr,\n                             fisc_mth_of_yr,\n                             fisc_wk_of_prd,\n                             NVL(pyr_seg_cd, 'UNK') pyr_seg_cd,\n                             v_npa_cd gl_acct_cd,\n                             cust_acctblty_flg,\n                             cust_natl_mngd_flg,\n                             (  SUM(NVL(natl_one_tm, 0))\n                              + SUM(NVL(natl_prom_alwnc_pgms, 0))\n                              + SUM(CASE WHEN gl_acct_cd = v_npa_cd THEN (NVL(ttl_ac, 0)) ELSE 0 END))\n                                data_value\n                        FROM de459e2fe7f96e4d958537b31b946b26.d458a891beb1ff0770a0f972079229c75fb73c9cf39b9202cce0c34fe9931634\n                    GROUP BY brnch_cd,\n                             fisc_yr,\n                             fisc_mth_of_yr,\n                             fisc_wk_of_prd,\n                             NVL(pyr_seg_cd, 'UNK'),\n                             v_npa_cd,\n                             cust_acctblty_flg,\n                             cust_natl_mngd_flg)\n          GROUP BY brnch_cd,\n                   fisc_yr,\n                   fisc_mth_of_yr,\n                   fisc_wk_of_prd,\n                   pyr_seg_cd,\n                   gl_acct_cd,\n                   cust_acctblty_flg,\n                   cust_natl_mngd_flg);\n\n      DBMS_OUTPUT.put_line(' NO OF ROWS INSERTED : ' || sql%ROWCOUNT);\n      v_ttl_rows_inserted   := v_ttl_rows_inserted + sql%ROWCOUNT;\n      COMMIT;\n   EXCEPTION\n      WHEN OTHERS THEN\n         DBMS_OUTPUT.put_line('** ERROR in insert_4. ' || SQLCODE || ' ' || SQLERRM);\n         RAISE;\n   END insert_4;\n\n   \n   PROCEDURE insert_5 IS\n   BEGIN\n      INSERT INTO de459e2fe7f96e4d958537b31b946b26.f2712065b4111f67f478dd0b3bf131add5e20efc7ee6c6e059f98dc123224871\n         (  SELECT brnch_cd,\n                   fisc_yr,\n                   fisc_mth_of_yr,\n                   fisc_wk_of_prd,\n                   pyr_seg_cd,\n                   gl_acct_cd,\n                   cust_acctblty_flg,\n                   cust_natl_mngd_flg,\n                   SUM(data_value)\n              FROM (  SELECT brnch_cd,\n                             fisc_yr,\n                             fisc_mth_of_yr,\n                             fisc_wk_of_prd,\n                             NVL(pyr_seg_cd, 'UNK') pyr_seg_cd,\n                             v_lpa_cd gl_acct_cd,\n                             cust_acctblty_flg,\n                             cust_natl_mngd_flg,\n                             (  SUM(NVL(loc_one_tm, 0))\n                              + SUM(NVL(loc_prom_alwnc_pgms, 0))\n                              + SUM(NVL(loc_mrktng_alwnc_pgms, 0))\n                              + SUM(CASE WHEN gl_acct_cd = v_lpa_cd THEN (NVL(ttl_ac, 0)) ELSE 0 END))\n                                data_value\n                        FROM de459e2fe7f96e4d958537b31b946b26.d458a891beb1ff0770a0f972079229c75fb73c9cf39b9202cce0c34fe9931634\n                    GROUP BY brnch_cd,\n                             fisc_yr,\n                             fisc_mth_of_yr,\n                             fisc_wk_of_prd,\n                             NVL(pyr_seg_cd, 'UNK'),\n                             v_lpa_cd,\n                             cust_acctblty_flg,\n                             cust_natl_mngd_flg)\n          GROUP BY brnch_cd,\n                   fisc_yr,\n                   fisc_mth_of_yr,\n                   fisc_wk_of_prd,\n                   pyr_seg_cd,\n                   gl_acct_cd,\n                   cust_acctblty_flg,\n                   cust_natl_mngd_flg);\n\n      DBMS_OUTPUT.put_line(' NO OF ROWS INSERTED : ' || sql%ROWCOUNT);\n      v_ttl_rows_inserted   := v_ttl_rows_inserted + sql%ROWCOUNT;\n      COMMIT;\n   EXCEPTION\n      WHEN OTHERS THEN\n         DBMS_OUTPUT.put_line('** ERROR in insert_5. ' || SQLCODE || ' ' || SQLERRM);\n         RAISE;\n   END insert_5;\n\n   \n   PROCEDURE insert_6 IS\n   BEGIN\n      INSERT INTO de459e2fe7f96e4d958537b31b946b26.f2712065b4111f67f478dd0b3bf131add5e20efc7ee6c6e059f98dc123224871\n         (  SELECT brnch_cd,\n                   fisc_yr,\n                   fisc_mth_of_yr,\n                   fisc_wk_of_prd,\n                   pyr_seg_cd,\n                   gl_acct_cd,\n                   cust_acctblty_flg,\n                   cust_natl_mngd_flg,\n                   SUM(data_value)\n              FROM (  SELECT brnch_cd,\n                             fisc_yr,\n                             fisc_mth_of_yr,\n                             fisc_wk_of_prd,\n                             NVL(pyr_seg_cd, 'UNK') pyr_seg_cd,\n                             v_nvf_cd gl_acct_cd,\n                             cust_acctblty_flg,\n                             cust_natl_mngd_flg,\n                             (SUM(NVL(natl_vndr_fnd_dvt, 0))) data_value\n                        \n                        FROM de459e2fe7f96e4d958537b31b946b26.d458a891beb1ff0770a0f972079229c75fb73c9cf39b9202cce0c34fe9931634\n                    GROUP BY brnch_cd,\n                             fisc_yr,\n                             fisc_mth_of_yr,\n                             fisc_wk_of_prd,\n                             NVL(pyr_seg_cd, 'UNK'),\n                             v_nvf_cd,\n                             cust_acctblty_flg,\n                             cust_natl_mngd_flg)\n          GROUP BY brnch_cd,\n                   fisc_yr,\n                   fisc_mth_of_yr,\n                   fisc_wk_of_prd,\n                   pyr_seg_cd,\n                   gl_acct_cd,\n                   cust_acctblty_flg,\n                   cust_natl_mngd_flg);\n\n      DBMS_OUTPUT.put_line(' NO OF ROWS INSERTED : ' || sql%ROWCOUNT);\n      v_ttl_rows_inserted   := v_ttl_rows_inserted + sql%ROWCOUNT;\n      COMMIT;\n   EXCEPTION\n      WHEN OTHERS THEN\n         DBMS_OUTPUT.put_line('** ERROR in insert_6. ' || SQLCODE || ' ' || SQLERRM);\n         RAISE;\n   END insert_6;\n\n   \n   PROCEDURE insert_7 IS\n   BEGIN\n      INSERT INTO de459e2fe7f96e4d958537b31b946b26.f2712065b4111f67f478dd0b3bf131add5e20efc7ee6c6e059f98dc123224871\n         (  SELECT brnch_cd,\n                   fisc_yr,\n                   fisc_mth_of_yr,\n                   fisc_wk_of_prd,\n                   pyr_seg_cd,\n                   gl_acct_cd,\n                   cust_acctblty_flg,\n                   cust_natl_mngd_flg,\n                   SUM(data_value)\n              FROM (  SELECT brnch_cd,\n                             fisc_yr,\n                             fisc_mth_of_yr,\n                             fisc_wk_of_prd,\n                             NVL(pyr_seg_cd, 'UNK') pyr_seg_cd,\n                             v_nif_cd gl_acct_cd,\n                             cust_acctblty_flg,\n                             cust_natl_mngd_flg,\n                             (SUM(NVL(natl_int_dvt, 0))) data_value\n                        FROM de459e2fe7f96e4d958537b31b946b26.d458a891beb1ff0770a0f972079229c75fb73c9cf39b9202cce0c34fe9931634\n                    GROUP BY brnch_cd,\n                             fisc_yr,\n                             fisc_mth_of_yr,\n                             fisc_wk_of_prd,\n                             NVL(pyr_seg_cd, 'UNK'),\n                             v_nif_cd,\n                             cust_acctblty_flg,\n                             cust_natl_mngd_flg)\n          GROUP BY brnch_cd,\n                   fisc_yr,\n                   fisc_mth_of_yr,\n                   fisc_wk_of_prd,\n                   pyr_seg_cd,\n                   gl_acct_cd,\n                   cust_acctblty_flg,\n                   cust_natl_mngd_flg);\n\n      DBMS_OUTPUT.put_line(' NO OF ROWS INSERTED : ' || sql%ROWCOUNT);\n      v_ttl_rows_inserted   := v_ttl_rows_inserted + sql%ROWCOUNT;\n      COMMIT;\n   EXCEPTION\n      WHEN OTHERS THEN\n         DBMS_OUTPUT.put_line('** ERROR in insert_7. ' || SQLCODE || ' ' || SQLERRM);\n         RAISE;\n   END insert_7;\n\n   \n   PROCEDURE insert_8 IS\n   BEGIN\n      INSERT INTO de459e2fe7f96e4d958537b31b946b26.f2712065b4111f67f478dd0b3bf131add5e20efc7ee6c6e059f98dc123224871\n         (  SELECT brnch_cd,\n                   fisc_yr,\n                   fisc_mth_of_yr,\n                   fisc_wk_of_prd,\n                   pyr_seg_cd,\n                   gl_acct_cd,\n                   cust_acctblty_flg,\n                   cust_natl_mngd_flg,\n                   SUM(data_value)\n              FROM (  SELECT brnch_cd,\n                             fisc_yr,\n                             fisc_mth_of_yr,\n                             fisc_wk_of_prd,\n                             NVL(pyr_seg_cd, 'UNK') pyr_seg_cd,\n                             v_lvf_cd gl_acct_cd,\n                             cust_acctblty_flg,\n                             cust_natl_mngd_flg,\n                             (SUM(NVL(loc_vndr_fnd_dvt, 0))\n                              + SUM(CASE WHEN gl_acct_cd = v_lvf_cd THEN (NVL(ttl_ac, 0)) ELSE 0 END))\n                                data_value\n                        FROM de459e2fe7f96e4d958537b31b946b26.d458a891beb1ff0770a0f972079229c75fb73c9cf39b9202cce0c34fe9931634\n                    GROUP BY brnch_cd,\n                             fisc_yr,\n                             fisc_mth_of_yr,\n                             fisc_wk_of_prd,\n                             NVL(pyr_seg_cd, 'UNK'),\n                             v_lvf_cd,\n                             cust_acctblty_flg,\n                             cust_natl_mngd_flg)\n          GROUP BY brnch_cd,\n                   fisc_yr,\n                   fisc_mth_of_yr,\n                   fisc_wk_of_prd,\n                   pyr_seg_cd,\n                   gl_acct_cd,\n                   cust_acctblty_flg,\n                   cust_natl_mngd_flg);\n\n      DBMS_OUTPUT.put_line(' NO OF ROWS INSERTED : ' || sql%ROWCOUNT);\n      v_ttl_rows_inserted   := v_ttl_rows_inserted + sql%ROWCOUNT;\n      COMMIT;\n   EXCEPTION\n      WHEN OTHERS THEN\n         DBMS_OUTPUT.put_line('** ERROR in insert_8. ' || SQLCODE || ' ' || SQLERRM);\n         RAISE;\n   END insert_8;\n\n   \n   PROCEDURE insert_9 IS\n   BEGIN\n      INSERT INTO de459e2fe7f96e4d958537b31b946b26.f2712065b4111f67f478dd0b3bf131add5e20efc7ee6c6e059f98dc123224871\n         (  SELECT brnch_cd,\n                   fisc_yr,\n                   fisc_mth_of_yr,\n                   fisc_wk_of_prd,\n                   pyr_seg_cd,\n                   gl_acct_cd,\n                   cust_acctblty_flg,\n                   cust_natl_mngd_flg,\n                   SUM(data_value)\n              FROM (  SELECT brnch_cd,\n                             fisc_yr,\n                             fisc_mth_of_yr,\n                             fisc_wk_of_prd,\n                             NVL(pyr_seg_cd, 'UNK') pyr_seg_cd,\n                             v_lif_cd gl_acct_cd,\n                             cust_acctblty_flg,\n                             cust_natl_mngd_flg,\n                             (SUM(NVL(loc_int_dvt, 0))) data_value\n                        FROM de459e2fe7f96e4d958537b31b946b26.d458a891beb1ff0770a0f972079229c75fb73c9cf39b9202cce0c34fe9931634\n                    GROUP BY brnch_cd,\n                             fisc_yr,\n                             fisc_mth_of_yr,\n                             fisc_wk_of_prd,\n                             NVL(pyr_seg_cd, 'UNK'),\n                             v_lif_cd,\n                             cust_acctblty_flg,\n                             cust_natl_mngd_flg)\n          GROUP BY brnch_cd,\n                   fisc_yr,\n                   fisc_mth_of_yr,\n                   fisc_wk_of_prd,\n                   pyr_seg_cd,\n                   gl_acct_cd,\n                   cust_acctblty_flg,\n                   cust_natl_mngd_flg);\n\n      DBMS_OUTPUT.put_line(' NO OF ROWS INSERTED : ' || sql%ROWCOUNT);\n      v_ttl_rows_inserted   := v_ttl_rows_inserted + sql%ROWCOUNT;\n      COMMIT;\n   EXCEPTION\n      WHEN OTHERS THEN\n         DBMS_OUTPUT.put_line('** ERROR in insert_9. ' || SQLCODE || ' ' || SQLERRM);\n         RAISE;\n   END insert_9;\n\n   \n   \n   PROCEDURE insert_10 IS\n   BEGIN\n      INSERT INTO de459e2fe7f96e4d958537b31b946b26.f2712065b4111f67f478dd0b3bf131add5e20efc7ee6c6e059f98dc123224871\n         (  SELECT brnch_cd,\n                   fisc_yr,\n                   fisc_mth_of_yr,\n                   fisc_wk_of_prd,\n                   pyr_seg_cd,\n                   gl_acct_cd,\n                   cust_acctblty_flg,\n                   cust_natl_mngd_flg,\n                   SUM(data_value)\n              FROM (  SELECT brnch_cd,\n                             fisc_yr,\n                             fisc_mth_of_yr,\n                             fisc_wk_of_prd,\n                             NVL(pyr_seg_cd, 'UNK') pyr_seg_cd,\n                             v_nif_plus_lif_cd gl_acct_cd,\n                             cust_acctblty_flg,\n                             cust_natl_mngd_flg,\n                             DECODE(SIGN(SUM(NVL(loc_int_dvt, 0)) + SUM(NVL(natl_int_dvt, 0))),\n                                    0, 0,\n                                    ((-1) * (SUM(NVL(loc_int_dvt, 0)) + SUM(NVL(natl_int_dvt, 0)))))\n                                data_value\n                        FROM de459e2fe7f96e4d958537b31b946b26.d458a891beb1ff0770a0f972079229c75fb73c9cf39b9202cce0c34fe9931634\n                    GROUP BY brnch_cd,\n                             fisc_yr,\n                             fisc_mth_of_yr,\n                             fisc_wk_of_prd,\n                             NVL(pyr_seg_cd, 'UNK'),\n                             v_nif_plus_lif_cd,\n                             cust_acctblty_flg,\n                             cust_natl_mngd_flg)\n          GROUP BY brnch_cd,\n                   fisc_yr,\n                   fisc_mth_of_yr,\n                   fisc_wk_of_prd,\n                   pyr_seg_cd,\n                   gl_acct_cd,\n                   cust_acctblty_flg,\n                   cust_natl_mngd_flg);\n\n      DBMS_OUTPUT.put_line(' NO OF ROWS INSERTED : ' || sql%ROWCOUNT);\n      v_ttl_rows_inserted   := v_ttl_rows_inserted + sql%ROWCOUNT;\n      COMMIT;\n   EXCEPTION\n      WHEN OTHERS THEN\n         DBMS_OUTPUT.put_line('** ERROR in insert_10. ' || SQLCODE || ' ' || SQLERRM);\n         RAISE;\n   END insert_10;\n\n   \n   PROCEDURE insert_11 IS\n   BEGIN\n      INSERT INTO de459e2fe7f96e4d958537b31b946b26.f2712065b4111f67f478dd0b3bf131add5e20efc7ee6c6e059f98dc123224871\n         (  SELECT brnch_cd,\n                   fisc_yr,\n                   fisc_mth_of_yr,\n                   fisc_wk_of_prd,\n                   pyr_seg_cd,\n                   gl_acct_cd,\n                   cust_acctblty_flg,\n                   cust_natl_mngd_flg,\n                   SUM(data_value)\n              FROM (  SELECT brnch_cd,\n                             fisc_yr,\n                             fisc_mth_of_yr,\n                             fisc_wk_of_prd,\n                             NVL(pyr_seg_cd, 'UNK') pyr_seg_cd,\n                             v_rbt_cd gl_acct_cd,\n                             cust_acctblty_flg,\n                             cust_natl_mngd_flg,\n                             (  SUM(NVL(rbt_loc_accrl_amt, 0))\n                              + SUM(NVL(rbt_natl_accrl_amt, 0))\n                              + SUM(NVL(rbt_loc_exp_amt, 0))\n                              + SUM(NVL(rbt_natl_exp_amt, 0))\n                              + SUM(CASE WHEN gl_acct_cd = v_rbt_cd THEN (NVL(ttl_ac, 0)) ELSE 0 END))\n                                data_value\n                        FROM de459e2fe7f96e4d958537b31b946b26.d458a891beb1ff0770a0f972079229c75fb73c9cf39b9202cce0c34fe9931634\n                    GROUP BY brnch_cd,\n                             fisc_yr,\n                             fisc_mth_of_yr,\n                             fisc_wk_of_prd,\n                             NVL(pyr_seg_cd, 'UNK'),\n                             v_rbt_cd,\n                             cust_acctblty_flg,\n                             cust_natl_mngd_flg)\n          GROUP BY brnch_cd,\n                   fisc_yr,\n                   fisc_mth_of_yr,\n                   fisc_wk_of_prd,\n                   pyr_seg_cd,\n                   gl_acct_cd,\n                   cust_acctblty_flg,\n                   cust_natl_mngd_flg);\n\n      DBMS_OUTPUT.put_line(' NO OF ROWS INSERTED : ' || sql%ROWCOUNT);\n      v_ttl_rows_inserted   := v_ttl_rows_inserted + sql%ROWCOUNT;\n      COMMIT;\n   EXCEPTION\n      WHEN OTHERS THEN\n         DBMS_OUTPUT.put_line('** ERROR in insert_11. ' || SQLCODE || ' ' || SQLERRM);\n         RAISE;\n   END insert_11;\n\n   PROCEDURE insert_12 IS\n   BEGIN\n      INSERT INTO de459e2fe7f96e4d958537b31b946b26.f2712065b4111f67f478dd0b3bf131add5e20efc7ee6c6e059f98dc123224871\n         (  SELECT brnch_cd,\n                   fisc_yr,\n                   fisc_mth_of_yr,\n                   fisc_wk_of_prd,\n                   pyr_seg_cd,\n                   gl_acct_cd,\n                   cust_acctblty_flg,\n                   cust_natl_mngd_flg,\n                   SUM(data_value)\n              FROM (  SELECT brnch_cd,\n                             fisc_yr,\n                             fisc_mth_of_yr,\n                             fisc_wk_of_prd,\n                             NVL(pyr_seg_cd, 'UNK') pyr_seg_cd,\n                             gl_acct_cd,\n                             cust_acctblty_flg,\n                             cust_natl_mngd_flg,\n                             SUM(NVL(ttl_ac, 0)) data_value\n                        FROM de459e2fe7f96e4d958537b31b946b26.d458a891beb1ff0770a0f972079229c75fb73c9cf39b9202cce0c34fe9931634\n                       WHERE gl_acct_cd IN (SELECT param_value_chr\n                                              FROM de459e2fe7f96e4d958537b31b946b26.de40ae7be8b2eb3858d46af8d107f3db\n                                             WHERE app_name = 'HYP_PLANNING'\n                                               AND param_type = 'AR_GL_ACCT_CD')\n                    GROUP BY brnch_cd,\n                             fisc_yr,\n                             fisc_mth_of_yr,\n                             fisc_wk_of_prd,\n                             NVL(pyr_seg_cd, 'UNK'),\n                             gl_acct_cd,\n                             cust_acctblty_flg,\n                             cust_natl_mngd_flg)\n          GROUP BY brnch_cd,\n                   fisc_yr,\n                   fisc_mth_of_yr,\n                   fisc_wk_of_prd,\n                   pyr_seg_cd,\n                   gl_acct_cd,\n                   cust_acctblty_flg,\n                   cust_natl_mngd_flg);\n\n      DBMS_OUTPUT.put_line(' NO OF ROWS INSERTED : ' || sql%ROWCOUNT);\n      v_ttl_rows_inserted   := v_ttl_rows_inserted + sql%ROWCOUNT;\n      COMMIT;\n   EXCEPTION\n      WHEN OTHERS THEN\n         DBMS_OUTPUT.put_line('** ERROR in insert_12. ' || SQLCODE || ' ' || SQLERRM);\n         RAISE;\n   END insert_12;\n\n\nBEGIN\n   BEGIN\n      v_prcs_stp   := 'Assigning variables ..... ';\n\n      SELECT param_value_chr\n        INTO v_sls_cd\n        FROM de459e2fe7f96e4d958537b31b946b26.de40ae7be8b2eb3858d46af8d107f3db\n       WHERE app_name = 'HYP_PLANNING'\n         AND param_type = 'GRS_SLS_EXTND_plus_AR_GL_ACCT_CD'\n         AND param_code = '4000001';\n\n      SELECT param_value_chr\n        INTO v_cost_cd\n        FROM de459e2fe7f96e4d958537b31b946b26.de40ae7be8b2eb3858d46af8d107f3db\n       WHERE app_name = 'HYP_PLANNING'\n         AND param_type = 'DWA_COST_EXTND_plus_AR_GL_ACCT_CD'\n         AND param_code = '5000001';\n\n      SELECT param_value_chr\n        INTO v_lpa_cd\n        FROM de459e2fe7f96e4d958537b31b946b26.de40ae7be8b2eb3858d46af8d107f3db\n       WHERE app_name = 'HYP_PLANNING'\n         AND param_type = 'LPA_plus_AR_GL_ACCT_CD'\n         AND param_code = '5310501';\n\n      SELECT param_value_chr\n        INTO v_npa_cd\n        FROM de459e2fe7f96e4d958537b31b946b26.de40ae7be8b2eb3858d46af8d107f3db\n       WHERE app_name = 'HYP_PLANNING'\n         AND param_type = 'NPA_plus_AR_GL_ACCT_CD'\n         AND param_code = '5300101';\n\n      SELECT param_value_chr\n        INTO v_rbt_cd\n        FROM de459e2fe7f96e4d958537b31b946b26.de40ae7be8b2eb3858d46af8d107f3db\n       WHERE app_name = 'HYP_PLANNING'\n         AND param_type = 'RBT_plus_AR_GL_ACCT_CD'\n         AND param_code = '4170001';\n\n      SELECT param_value_chr\n        INTO v_cma_cd\n        FROM de459e2fe7f96e4d958537b31b946b26.de40ae7be8b2eb3858d46af8d107f3db\n       WHERE app_name = 'HYP_PLANNING'\n         AND param_type = 'CMA_plus_AR_GL_ACCT_CD'\n         AND param_code = '5320600';\n\n      SELECT param_value_chr\n        INTO v_nif_plus_lif_cd\n        FROM de459e2fe7f96e4d958537b31b946b26.de40ae7be8b2eb3858d46af8d107f3db\n       WHERE app_name = 'HYP_PLANNING'\n         AND param_type = 'NIF_plus_LIF_GL_ACCT_CD'\n         AND param_code = '5005901';\n\n      SELECT param_value_chr\n        INTO v_lif_cd\n        FROM de459e2fe7f96e4d958537b31b946b26.de40ae7be8b2eb3858d46af8d107f3db\n       WHERE app_name = 'HYP_PLANNING'\n         AND param_type = 'LIF_GL_ACCT_CD'\n         AND param_code = '5005601';\n\n      SELECT param_value_chr\n        INTO v_lvf_cd\n        FROM de459e2fe7f96e4d958537b31b946b26.de40ae7be8b2eb3858d46af8d107f3db\n       WHERE app_name = 'HYP_PLANNING'\n         AND param_type = 'LVF_plus_AR_GL_ACCT_CD'\n         AND param_code = '5005501';\n\n      SELECT param_value_chr\n        INTO v_nvf_cd\n        FROM de459e2fe7f96e4d958537b31b946b26.de40ae7be8b2eb3858d46af8d107f3db\n       WHERE app_name = 'HYP_PLANNING'\n         AND param_type = 'NVF_GL_ACCT_CD'\n         AND param_code = '5005001';\n\n      SELECT param_value_chr\n        INTO v_nif_cd\n        FROM de459e2fe7f96e4d958537b31b946b26.de40ae7be8b2eb3858d46af8d107f3db\n       WHERE app_name = 'HYP_PLANNING'\n         AND param_type = 'NIF_GL_ACCT_CD'\n         AND param_code = '5005101';\n   EXCEPTION\n      WHEN OTHERS THEN\n         DBMS_OUTPUT.put_line('Error in v_prcs_stp : ' || v_prcs_stp);\n\n         RETURN 1000;\n   END;\n\n   BEGIN\n      v_prcs_stp   := 'GET LDR_TM ';\n\n      DBMS_OUTPUT.put_line('Run Date is:' || v_odate);\n\n      SELECT TO_NUMBER(TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')) INTO v_ldr_tm FROM DUAL;\n\n      DBMS_OUTPUT.put_line('LDR_TM is :' || v_ldr_tm);\n   EXCEPTION\n      WHEN OTHERS THEN\n         DBMS_OUTPUT.put_line('Error in v_prcs_stp : ' || v_prcs_stp);\n\n         RETURN 900;\n   END;\n\n   \n   \n   \n   BEGIN\n      v_prcs_stp   := 'INSERT INTO table starts ';\n      l_start      := DBMS_UTILITY.get_time;\n\n      DBMS_OUTPUT.put_line('TIME ' || TO_CHAR(SYSDATE, 'yyyymmdd hh24:mi:ss'));\n\n      DBMS_OUTPUT.put_line('Executing insert_1');\n      insert_1;\n      DBMS_OUTPUT.put_line('Executing insert_2');\n      insert_2;\n      DBMS_OUTPUT.put_line('Executing insert_3');\n      insert_3;\n      DBMS_OUTPUT.put_line('Executing insert_4');\n      insert_4;\n      DBMS_OUTPUT.put_line('Executing insert_5');\n      insert_5;\n      DBMS_OUTPUT.put_line('Executing insert_6');\n      insert_6;\n      DBMS_OUTPUT.put_line('Executing insert_7');\n      insert_7;\n      DBMS_OUTPUT.put_line('Executing insert_8');\n      insert_8;\n      DBMS_OUTPUT.put_line('Executing insert_9');\n      insert_9;\n      DBMS_OUTPUT.put_line('Executing insert_10');\n      insert_10;\n      DBMS_OUTPUT.put_line('Executing insert_11');\n      insert_11;\n      DBMS_OUTPUT.put_line('Executing insert_12');\n      insert_12;\n\n      COMMIT;\n\n      l_end        := DBMS_UTILITY.get_time;\n\n      DBMS_OUTPUT.put_line('*************************************************************');\n      DBMS_OUTPUT.put_line(\n         'Total no of rows inserted into table de459e2fe7f96e4d958537b31b946b26.0bc437e6dbeee36674bbae9feb068aa47e1ab47422f51502db6bcb83bdbd850c :' || v_ttl_rows_inserted);\n      DBMS_OUTPUT.put_line('*************************************************************');\n      DBMS_OUTPUT.put_line(ROUND((l_end - l_start) / 100, 2) || ' seconds...');\n\n      DBMS_OUTPUT.put_line('FN_RVNUE_BY_GL_ACCT_LOAD_WK completed successfully ');\n\n      RETURN 0;\n   END;\n\n\n\n\nEXCEPTION\n   WHEN OTHERS THEN\n      ROLLBACK;\n      DBMS_OUTPUT.put_line(SQLCODE);\n      DBMS_OUTPUT.put_line(SQLERRM);\n\n      DBMS_OUTPUT.put_line('Error in function FN_RVNUE_BY_GL_ACCT_LOAD_WK');\n      RETURN 600;\nEND fn_rvnue_by_gl_acct_load_wk;\n/",
            "upstream_dependencies": [],
            "downstream_dependencies": [],
            "dag_location": "null",
            "gantt_location": "null",
            "created_at": "null",
            "updated_at": "null"
        },
        {
            "name": "FN_SYN_SALES_MKTPLUS_AGGR_LOAD",
            "encrypted_name": "46f16dafd4b70a10a470bfb47416289adfa3c71a89585da450b005deb0a7b9c7",
            "type": "function",
            "database": "null",
            "encrypted_database": "null",
            "schema": "XDMADM",
            "encrypted_schema": "0e03d5c46556a742ba46252698396ef2",
            "fully_qualified_name": "XDMADM.FN_SYN_SALES_MKTPLUS_AGGR_LOAD",
            "encrypted_fqn": "0e03d5c46556a742ba46252698396ef2.46f16dafd4b70a10a470bfb47416289adfa3c71a89585da450b005deb0a7b9c7",
            "synonyms": [],
            "metadata_analysis": "CREATE OR REPLACE FUNCTION \"0e03d5c46556a742ba46252698396ef2\".\"46f16dafd4b70a10a470bfb47416289adfa3c71a89585da450b005deb0a7b9c7\" (\n   v_in_odate   IN VARCHAR2\n)\n   RETURN NUMBER\nIS\n   \n   \n   \n   CON_PROCESS_NAME CONSTANT VARCHAR2 (40)\n         := 'FN_SYN_SALES_MKTPLUS_AGGR_LOAD' ;\n   \n   v_odate                 DATE;\n   v_cur_fisc_yr_mth       0e03d5c46556a742ba46252698396ef2.1609b28739e207519049a2cf090bfd19.2603c45be643e5cd8f9c6dad3bee6cb3%TYPE;\n   v_last_fisc_yr_mth      0e03d5c46556a742ba46252698396ef2.1609b28739e207519049a2cf090bfd19.2603c45be643e5cd8f9c6dad3bee6cb3%TYPE;\n   v_cur_fisc_mth_of_yr    0e03d5c46556a742ba46252698396ef2.1609b28739e207519049a2cf090bfd19.e1d446673288adb6d5f219d0aa82d37a%TYPE;\n   v_last_fisc_mth_of_yr   0e03d5c46556a742ba46252698396ef2.1609b28739e207519049a2cf090bfd19.e1d446673288adb6d5f219d0aa82d37a%TYPE;\n   v_fisc_yr               0e03d5c46556a742ba46252698396ef2.1609b28739e207519049a2cf090bfd19.ab30d6d679879cfacfe389b97d1d3f0e%TYPE;\n   v_cur_fisc_prd_nm       0e03d5c46556a742ba46252698396ef2.1609b28739e207519049a2cf090bfd19.c6e0ffd13b59a270d18bfba7afeed0e2%TYPE;\n   v_last_fisc_prd_nm      0e03d5c46556a742ba46252698396ef2.1609b28739e207519049a2cf090bfd19.c6e0ffd13b59a270d18bfba7afeed0e2%TYPE;\n   v_prd_strt_dt           DATE;\n   v_prd_end_dt            DATE;\n   v_agg_syn_nm 42183b964ff47e407206508ef9606770.b6b353c534e61967560fe35bfd68bab2.5e4be82fa55134ee91432a9d827d6cfb%TYPE\n         := 'SALES_MKTPLUS_AGGR' ;\n   v_prspct_syn_nm 42183b964ff47e407206508ef9606770.b6b353c534e61967560fe35bfd68bab2.5e4be82fa55134ee91432a9d827d6cfb%TYPE\n         := 'CUST_PLUS_PRSPCT_CORP' ;\n   v_agg_tbl_to_load       42183b964ff47e407206508ef9606770.b6b353c534e61967560fe35bfd68bab2.80f6badb5be48efbfc5290fa64e4e111%TYPE;\n   v_tbl_owner             VARCHAR2 (40 BYTE) := 'XDMADM';\n   v_agg_tbl_inactv        VARCHAR2 (40 BYTE);\n   v_agg_tbl_actv          VARCHAR2 (40 BYTE);\n   v_agg_tbl_nm            VARCHAR2 (40 BYTE);\n   v_prspct_tbl_inactv     VARCHAR2 (40 BYTE);\n   v_prspct_tbl_actv       VARCHAR2 (40 BYTE);\n   v_prspct_tbl_nm         VARCHAR2 (40 BYTE);\n   v_sql_str               VARCHAR2 (5000) := ' ';\n   v_cnt                   NUMBER;\n   v_ret_val               NUMBER;\n   v_trunc_allow           BOOLEAN;\n   v_trunc_ret             NUMBER (3);\n   v_load_ret              NUMBER (3);\n   v_grs_sls_extnd         0e03d5c46556a742ba46252698396ef2.744733b0938dd8b442c799cb31a8176d.2ee1400a0150f0b220dd7bd6268d1e66%TYPE;\n   v_unfrm_qty_ship        0e03d5c46556a742ba46252698396ef2.744733b0938dd8b442c799cb31a8176d.ccf8d88f2d37f3171da2121ab22e9330%TYPE;\n   \n   v_prcs_nm               VARCHAR (100);\n   v_prcs_step             VARCHAR (200);\n   v_prcs_pram             VARCHAR (100);\n   v_out_msg               VARCHAR (200);\n   \n   \n   \n   ALL_EXCEPTIONS EXCEPTION;\n   e_truncate_table EXCEPTION;\nBEGIN\n   DBMS_OUTPUT.put_line ('Start Process ' || CON_PROCESS_NAME);\n   DBMS_OUTPUT.put_line (\n      'Start Time:' || TO_CHAR (SYSDATE, 'YYYY-MM-DD HH24:MI:SS')\n   );\n   v_prcs_nm := CON_PROCESS_NAME;\n   v_prcs_pram := 'PARAM1 : ' || v_odate;\n   v_prcs_step := 'Start Process ' || CON_PROCESS_NAME;\n\n   EXECUTE IMMEDIATE 'alter session set nls_date_format = ''YYYYMMDD''';\n\n   v_odate := TO_DATE (v_in_odate, 'YYYYMMDD');\n   \n   v_prcs_step := 'Getting date parameters';\n\n   SELECT   0e03d5c46556a742ba46252698396ef2.476a877ff313a9e06b3ba262c317b001.2603c45be643e5cd8f9c6dad3bee6cb3\n     INTO   v_cur_fisc_yr_mth\n     FROM   0e03d5c46556a742ba46252698396ef2.476a877ff313a9e06b3ba262c317b001 t\n    WHERE   0e03d5c46556a742ba46252698396ef2.476a877ff313a9e06b3ba262c317b001.222ccb1d1746bcdb2365f29b3da0b613 = v_odate;\n\n   DBMS_OUTPUT.put_line ('Current Period is ' || v_cur_fisc_yr_mth);\n\n   SELECT   MAX (0e03d5c46556a742ba46252698396ef2.476a877ff313a9e06b3ba262c317b001.2603c45be643e5cd8f9c6dad3bee6cb3)\n     INTO   v_last_fisc_yr_mth\n     FROM   0e03d5c46556a742ba46252698396ef2.476a877ff313a9e06b3ba262c317b001 a\n    WHERE   0e03d5c46556a742ba46252698396ef2.476a877ff313a9e06b3ba262c317b001.2603c45be643e5cd8f9c6dad3bee6cb3 < (SELECT   0e03d5c46556a742ba46252698396ef2.476a877ff313a9e06b3ba262c317b001.2603c45be643e5cd8f9c6dad3bee6cb3\n                               FROM   0e03d5c46556a742ba46252698396ef2.476a877ff313a9e06b3ba262c317b001 a\n                              WHERE   0e03d5c46556a742ba46252698396ef2.476a877ff313a9e06b3ba262c317b001.222ccb1d1746bcdb2365f29b3da0b613 = TRUNC (v_odate));\n\n   DBMS_OUTPUT.put_line ('Last Closed Period is ' || v_last_fisc_yr_mth);\n\n   SELECT   MIN (clndr_dt), MAX (clndr_dt)\n     INTO   v_prd_strt_dt, v_prd_end_dt\n     FROM   0e03d5c46556a742ba46252698396ef2.476a877ff313a9e06b3ba262c317b001\n    WHERE   fisc_yr_mth = v_last_fisc_yr_mth;\n\n   DBMS_OUTPUT.put_line ('Start Date of last period is ' || v_prd_strt_dt);\n   DBMS_OUTPUT.put_line ('End Date of last period is ' || v_prd_end_dt);\n\n   SELECT   tbl_nm\n     INTO   v_agg_tbl_inactv\n     FROM   42183b964ff47e407206508ef9606770.56ac3befbcbada23fa9268d8fe6d5242\n    WHERE   synonym_nm = v_agg_syn_nm AND actv_ind = 'N';\n\n   DBMS_OUTPUT.put_line (v_agg_tbl_inactv);\n\n   SELECT   tbl_nm\n     INTO   v_agg_tbl_actv\n     FROM   42183b964ff47e407206508ef9606770.56ac3befbcbada23fa9268d8fe6d5242\n    WHERE   synonym_nm = v_agg_syn_nm AND actv_ind = 'Y';\n\n   DBMS_OUTPUT.put_line (v_agg_tbl_actv);\n\n   SELECT   table_name\n     INTO   v_agg_tbl_nm\n     FROM   ALL_SYNONYMS\n    WHERE       owner = v_tbl_owner\n            AND table_owner = v_tbl_owner\n            AND synonym_name = v_agg_syn_nm;\n\n   DBMS_OUTPUT.put_line (v_agg_tbl_nm);\n\n   IF v_agg_tbl_actv <> v_agg_tbl_nm\n   THEN\n      DBMS_OUTPUT.put_line (\n         'The tables ALL_SYNONYMS and 9751bbbcfea690cc0be4d58830a6fe2e.56ac3befbcbada23fa9268d8fe6d5242 are not in synch'\n      );\n      RETURN 1;\n   END IF;\n\n   DBMS_OUTPUT.put_line (\n      'Table which needs to be loaded is ' || v_agg_tbl_inactv\n   );\n   \n   \n   \n   DBMS_OUTPUT.put_line ('Truncating the table ' || v_agg_tbl_inactv);\n   v_trunc_ret :=\n      7540495dc7d95c8483c39c98db3db89c.72d996f41712e622935d17bc9cb23cfa.bf64c6f363cecdf8179ad64aad199c7e (v_out_msg,\n                                       v_tbl_owner,\n                                       v_agg_tbl_inactv);\n   \n   DBMS_OUTPUT.PUT_LINE (v_out_msg);\n\n   IF v_trunc_ret != 0\n   THEN\n      DBMS_OUTPUT.PUT_LINE (\n         'Error in Truncating ' || v_agg_tbl_inactv || ' table'\n      );\n      RAISE e_truncate_table;\n   END IF;\n\n   v_agg_tbl_to_load := v_agg_tbl_inactv;\n   DBMS_OUTPUT.put_line(   'Loading the table '\n                        || v_agg_tbl_to_load\n                        || ' started...'\n                        || SYSTIMESTAMP);\n   v_load_ret :=\n      0e03d5c46556a742ba46252698396ef2.6171714221d0069ddcdc7b81983cee54dfa3c71a89585da450b005deb0a7b9c7 (v_odate, v_agg_tbl_to_load);\n\n   IF v_load_ret != 0\n   THEN\n      DBMS_OUTPUT.PUT_LINE ('Error loading ' || v_agg_tbl_inactv || ' table');\n      RAISE ALL_EXCEPTIONS;\n   END IF;\n\n   \n   DBMS_OUTPUT.PUT_LINE ('Start table analyze... ' || SYSTIMESTAMP);\n   v_ret_val :=\n      8e64339f96bb08058f5d52f1c04f954a.17fcfcb378ff5051796afa7f02d0a322.9058a38aed65e271486900da66f7adf0 (v_out_msg, 'XDMADM', v_agg_tbl_to_load);\n\n   IF v_ret_val != 0\n   THEN\n      DBMS_OUTPUT.PUT_LINE (\n         'Error in analyzing ' || v_agg_tbl_to_load || ' table'\n      );\n      RAISE ALL_EXCEPTIONS;\n   END IF;\n\n   DBMS_OUTPUT.PUT_LINE (\n      'Table ' || v_agg_tbl_to_load || ' analyzed OK...' || SYSTIMESTAMP\n   );\n\n   DBMS_OUTPUT.PUT_LINE('Calling 0e03d5c46556a742ba46252698396ef2.60ac4f2269d203f666e8df2b3b5485d6 function to recreate the synonym to point to the newly built table '\n                        || v_agg_tbl_to_load);\n   \n   v_ret_val :=\n      0e03d5c46556a742ba46252698396ef2.60ac4f2269d203f666e8df2b3b5485d6 (v_agg_syn_nm, v_tbl_owner, v_agg_tbl_to_load);\n\n   IF v_ret_val <> 0\n   THEN\n      DBMS_OUTPUT.PUT_LINE (\n         'Error in calling 0e03d5c46556a742ba46252698396ef2.60ac4f2269d203f666e8df2b3b5485d6 function'\n      );\n      RETURN 1;\n   END IF;\n\n   \n   DBMS_OUTPUT.PUT_LINE('Updating SYN_TBL_MAP table to mark the newly built table as active and mark the other table as inactive');\n\n   \n   UPDATE   42183b964ff47e407206508ef9606770.56ac3befbcbada23fa9268d8fe6d5242\n      SET   actv_ind = 'N', last_updt = SYSDATE\n    WHERE   synonym_nm = v_agg_syn_nm AND actv_ind = 'Y';\n\n   \n   UPDATE   42183b964ff47e407206508ef9606770.56ac3befbcbada23fa9268d8fe6d5242\n      SET   actv_ind = 'Y', last_updt = SYSDATE\n    WHERE   tbl_nm = v_agg_tbl_to_load;\n\n   COMMIT;\n\n   \n   SELECT   tbl_nm\n     INTO   v_agg_tbl_inactv\n     FROM   42183b964ff47e407206508ef9606770.56ac3befbcbada23fa9268d8fe6d5242\n    WHERE   synonym_nm = v_agg_syn_nm AND actv_ind = 'N';\n\n   \n   \n   \n   \n\n   SELECT   tbl_nm\n     INTO   v_prspct_tbl_inactv\n     FROM   42183b964ff47e407206508ef9606770.56ac3befbcbada23fa9268d8fe6d5242\n    WHERE   synonym_nm = v_prspct_syn_nm AND actv_ind = 'N';\n\n   DBMS_OUTPUT.put_line (v_prspct_tbl_inactv);\n\n   SELECT   tbl_nm\n     INTO   v_prspct_tbl_actv\n     FROM   42183b964ff47e407206508ef9606770.56ac3befbcbada23fa9268d8fe6d5242\n    WHERE   synonym_nm = v_prspct_syn_nm AND actv_ind = 'Y';\n\n   DBMS_OUTPUT.put_line (v_prspct_tbl_actv);\n\n   SELECT   table_name\n     INTO   v_prspct_tbl_nm\n     FROM   ALL_SYNONYMS\n    WHERE       owner = v_tbl_owner\n            AND table_owner = v_tbl_owner\n            AND synonym_name = v_prspct_syn_nm;\n\n   DBMS_OUTPUT.put_line (v_prspct_tbl_nm);\n\n   IF v_prspct_tbl_actv <> v_prspct_tbl_nm\n   THEN\n      DBMS_OUTPUT.put_line (\n         'The tables ALL_SYNONYMS and 9751bbbcfea690cc0be4d58830a6fe2e.56ac3befbcbada23fa9268d8fe6d5242 are not in synch'\n      );\n      RETURN 1;\n   END IF;\n\n   DBMS_OUTPUT.put_line ('Table which got loaded is ' || v_prspct_tbl_inactv);\n   DBMS_OUTPUT.PUT_LINE('Calling 0e03d5c46556a742ba46252698396ef2.60ac4f2269d203f666e8df2b3b5485d6 function to recreate the synonym to point to the newly built table '\n                        || v_prspct_tbl_inactv);\n   \n   v_ret_val :=\n      0e03d5c46556a742ba46252698396ef2.60ac4f2269d203f666e8df2b3b5485d6 (v_prspct_syn_nm,\n                             v_tbl_owner,\n                             v_prspct_tbl_inactv);\n\n   IF v_ret_val <> 0\n   THEN\n      DBMS_OUTPUT.PUT_LINE (\n         'Error in calling 0e03d5c46556a742ba46252698396ef2.60ac4f2269d203f666e8df2b3b5485d6 function'\n      );\n      RETURN 1;\n   END IF;\n\n   \n   DBMS_OUTPUT.PUT_LINE('Updating SYN_TBL_MAP table to mark the newly built table as active and mark the other table as inactive');\n\n   \n   UPDATE   42183b964ff47e407206508ef9606770.56ac3befbcbada23fa9268d8fe6d5242\n      SET   actv_ind = 'N', last_updt = SYSDATE\n    WHERE   synonym_nm = v_prspct_syn_nm AND actv_ind = 'Y';\n\n   COMMIT;\n\n   \n   UPDATE   42183b964ff47e407206508ef9606770.56ac3befbcbada23fa9268d8fe6d5242\n      SET   actv_ind = 'Y', last_updt = SYSDATE\n    WHERE   tbl_nm = v_prspct_tbl_inactv;\n\n   COMMIT;\n\n   \n   SELECT   tbl_nm\n     INTO   v_prspct_tbl_inactv\n     FROM   42183b964ff47e407206508ef9606770.56ac3befbcbada23fa9268d8fe6d5242\n    WHERE   synonym_nm = v_prspct_syn_nm AND actv_ind = 'N';\n\n   \n   \n   \n   \n\n   RETURN 0;\nEXCEPTION\n\n   WHEN OTHERS\n   THEN\n      \n      DBMS_OUTPUT.put_line (SQLCODE || ': ' || SQLERRM);\n      RETURN 1;\nEND FN_SYN_SALES_MKTPLUS_AGGR_LOAD;\n/",
            "upstream_dependencies": [],
            "downstream_dependencies": [],
            "dag_location": "null",
            "gantt_location": "null",
            "created_at": "null",
            "updated_at": "null"
        },
        {
            "name": "FN_HYBRID_PO_EXTRACT",
            "encrypted_name": "50475e04147f4e799b20502d8b4b0e153c57f19e04c7059a1aac383074c20acd",
            "type": "function",
            "database": "null",
            "encrypted_database": "null",
            "schema": "XDMADM",
            "encrypted_schema": "0e03d5c46556a742ba46252698396ef2",
            "fully_qualified_name": "XDMADM.FN_HYBRID_PO_EXTRACT",
            "encrypted_fqn": "0e03d5c46556a742ba46252698396ef2.50475e04147f4e799b20502d8b4b0e153c57f19e04c7059a1aac383074c20acd",
            "synonyms": [],
            "metadata_analysis": "CREATE OR REPLACE FUNCTION \"0e03d5c46556a742ba46252698396ef2\".\"50475e04147f4e799b20502d8b4b0e153c57f19e04c7059a1aac383074c20acd\"\n  ( odate_i     VARCHAR2 ,  \n    vendor_i    VARCHAR2 DEFAULT NULL \n  )\n\n\n\n  RETURN NUMBER\n  IS\n\n\n  \n\n    c_limit                         CONSTANT INTEGER := 1000;\n    \n    c_subtract_days                 INTEGER ;\n    v_message                       VARCHAR2(2054);\n    g_how_many                      INTEGER;\n    v_sqlcode                       NUMBER;\n    g_reads                         NUMBER;\n    g_writes                        NUMBER;\n    g_idx                           NUMBER;\n    g_lookup_idx                    NUMBER;\n    g_lookup_key                    VARCHAR2(100);\n    g_in_idx                        NUMBER;\n    g_out_idx                       NUMBER;\n    c_sql_str                       VARCHAR2(5000);\n    c_cursor                        sys_refcursor;\n    g_div_nbr                       NUMBER;\n    g_brnch_cd                      VARCHAR2(11);\n    g_po_nbr                        VARCHAR2(11);\n    g_ord_dt                        DATE;\n    g_shipment_nbr                  VARCHAR2(100);\n    g_search_strg_cd                VARCHAR2(100);\n    g_winning_idx                   INTEGER;\n    g_temperature_class             VARCHAR2(100);\n    g_product_class                 VARCHAR2(150);\n    g_product_category              VARCHAR2(150);\n    g_freight_desc                  VARCHAR2(100);\n    g_total_cases                   NUMBER;\n    g_brand_weight                  NUMBER;\n    g_eb_pct                        NUMBER;\n    g_ctms                          VARCHAR2(11);\n    g_po_rcvd_dt                    DATE;\n    g_weight_dry                    NUMBER;\n    g_weight_refrigerated           NUMBER;\n    g_weight_frozen                 NUMBER;\n    g_weight_ice_cream              NUMBER;\n    g_weight_hazmat                 NUMBER;\n    g_srvc_cd                       VARCHAR2(100);\n    g_carrier_cd                    VARCHAR2(100);\n    g_carrier_nm                    VARCHAR2(100);\n    g_po_type                       VARCHAR2(100);\n    g_cross_dock                    VARCHAR2(100);\n    g_cross_dock_mit                VARCHAR2(100);\n    g_voucher_date                  DATE;\n    g_po_weight                     NUMBER;\n    g_po_cases                      NUMBER;\n    g_po_cube                       NUMBER;\n    g_po_revenue                    NUMBER;\n    g_po_cost                       NUMBER;\n    g_po_savings                    NUMBER;\n    g_load_at_id                    VARCHAR2(100);\n    g_load_at_name                  VARCHAR2(100);\n    g_load_at_city                  VARCHAR2(100);\n    g_load_at_state                 VARCHAR2(3);\n    g_load_at_zip                   VARCHAR2(10);\n    g_origin_source                 VARCHAR2(100);\n    g_tips_commodity                VARCHAR2(100);\n    g_mot                           VARCHAR2(100);\n    g_eqpmt                         VARCHAR2(100);\n    g_srvc_lvl                      VARCHAR2(100);\n    g_tms_src                       VARCHAR2(20);\n    g_tms_prch_from_vndr_nm         VARCHAR2(100);  \n    g_po_rqstd_dt                   DATE;           \n    g_po_appt_dt                    DATE;           \n    g_po_plnd_dlvry_dt              DATE;           \n    g_po_plnd_pckp_dt               DATE;           \n    g_po_orig_due_dt                DATE;           \n    g_primary_fclty_alias_id        VARCHAR2(16);   \n    g_shp_orgn_fclty_alias_id       VARCHAR2(100);\n    g_po_orgn_fclty_alias_id        VARCHAR2(100);\n    g_alt_hlng_typ                  VARCHAR2(100);\n    g_shp_dest_fclty_alias_id       VARCHAR2(100);\n    g_ldr_tm                        NUMBER;\n    g_storage_winner                VARCHAR2(100);\n    g_class_winner                  VARCHAR2(100);\n    g_category_winner               VARCHAR2(100);\n    g_storage_ctr                   INTEGER;\n    g_class_ctr                     INTEGER;\n    g_category_ctr                  INTEGER;\n    g_display                       VARCHAR2(50);\n    g_truncate_return               INTEGER;\n    g_shipment_exists               BOOLEAN;\n    g_lst_arrvl_chg_reason          VARCHAR2(56);\n    g_lst_arrvl_chg_user_id         VARCHAR2(8);\n    g_lst_arrvl_chg_date            DATE;\n    g_date_arrival_befr             DATE;\n    g_date_arrival_aftr             DATE;\n    \n    g_aptnt_dt\t\t\t        DATE;\n    g_aptnt_tm\t\t\t        VARCHAR2(4 BYTE);\n    g_buyr_loc_typ_cd_actl\t\tVARCHAR2(1 BYTE);\n    g_buyr_sub_typ_actl\t\t\tVARCHAR2(1 BYTE);\n    g_orig_aptnt_dt\t\t\t    DATE;\n    g_orig_aptnt_tm\t\t\t\tVARCHAR2(6 BYTE);\n    g_cmp_po_brnch_nbr\t\t\tVARCHAR2(2 BYTE);\n    g_cmp_po_nbr\t\t\t\tVARCHAR2(9 BYTE);\n    g_arrvl_dt_chg_rsn\t\t\tVARCHAR2(52 BYTE);\n    g_pickup_dt_chg_rsn\t\t\tVARCHAR2(52 BYTE);\n    g_po_dock_in_tm\t\t\t\tNUMBER(6);\n    g_po_dock_out_tm\t\t\tNUMBER(6);\n    g_po_gate_in_tm\t\t\t\tNUMBER(6);\n    g_po_gate_out_tm\t\t\tNUMBER(6);\n    g_arvl_dt\t\t\t\t\tDATE;\n    g_carr_scac_cd\t\t\t\tVARCHAR2(4 BYTE);\n    g_frght_trm_cd_actl\t\t\tVARCHAR2(4 BYTE);\n\n\n\n\n\nCURSOR cur_products\nIS\nWITH dtl AS (\n    SELECT de459e2fe7f96e4d958537b31b946b26.c437d55d53d88d02ce92bdadaefd8483.6bd6b7c188fef616b113c81245338906,  de459e2fe7f96e4d958537b31b946b26.c437d55d53d88d02ce92bdadaefd8483.839c4ffb4bfaae1bb58eab4dee67d96a, de459e2fe7f96e4d958537b31b946b26.c437d55d53d88d02ce92bdadaefd8483.75274b7e794ec4ac03e63646e000c70b,\n    \n     de459e2fe7f96e4d958537b31b946b26.c50b6339218f0dbbd97ce6557f2b051f.718cda5251e1aefe6a111765fe68187f,\n     SUM(de459e2fe7f96e4d958537b31b946b26.c437d55d53d88d02ce92bdadaefd8483.e7cabb8cf7b3db25086b2c8c7fe3a76e)                OVER (PARTITION BY de459e2fe7f96e4d958537b31b946b26.c437d55d53d88d02ce92bdadaefd8483.6bd6b7c188fef616b113c81245338906, de459e2fe7f96e4d958537b31b946b26.c437d55d53d88d02ce92bdadaefd8483.75274b7e794ec4ac03e63646e000c70b, de459e2fe7f96e4d958537b31b946b26.c50b6339218f0dbbd97ce6557f2b051f.718cda5251e1aefe6a111765fe68187f) storage_qty,\n     SUM(de459e2fe7f96e4d958537b31b946b26.c437d55d53d88d02ce92bdadaefd8483.bb2dfd06913e72dbc1733f20ba3699ea2742f685419072427fdf6d978b822ac7) OVER (PARTITION BY de459e2fe7f96e4d958537b31b946b26.c437d55d53d88d02ce92bdadaefd8483.6bd6b7c188fef616b113c81245338906, de459e2fe7f96e4d958537b31b946b26.c437d55d53d88d02ce92bdadaefd8483.75274b7e794ec4ac03e63646e000c70b, de459e2fe7f96e4d958537b31b946b26.c50b6339218f0dbbd97ce6557f2b051f.718cda5251e1aefe6a111765fe68187f) storage_weight,\n     SUM(de459e2fe7f96e4d958537b31b946b26.c437d55d53d88d02ce92bdadaefd8483.0d664c9790a40f8877ce994a41ca662496a8e7c926d4a6d230ee2652a5996563)    OVER (PARTITION BY de459e2fe7f96e4d958537b31b946b26.c437d55d53d88d02ce92bdadaefd8483.6bd6b7c188fef616b113c81245338906, de459e2fe7f96e4d958537b31b946b26.c437d55d53d88d02ce92bdadaefd8483.75274b7e794ec4ac03e63646e000c70b, de459e2fe7f96e4d958537b31b946b26.c50b6339218f0dbbd97ce6557f2b051f.718cda5251e1aefe6a111765fe68187f) storage_cube,\n     row_NUMBER()                    OVER (PARTITION BY de459e2fe7f96e4d958537b31b946b26.c437d55d53d88d02ce92bdadaefd8483.6bd6b7c188fef616b113c81245338906, de459e2fe7f96e4d958537b31b946b26.c437d55d53d88d02ce92bdadaefd8483.75274b7e794ec4ac03e63646e000c70b, de459e2fe7f96e4d958537b31b946b26.c50b6339218f0dbbd97ce6557f2b051f.718cda5251e1aefe6a111765fe68187f ORDER BY  1) storage_row,\n    \n     de459e2fe7f96e4d958537b31b946b26.2c04d82ed0aa1cc9bce2cf2c0548b268.3c724152edee881b7e27511bf9d40985,\n     SUM(de459e2fe7f96e4d958537b31b946b26.c437d55d53d88d02ce92bdadaefd8483.e7cabb8cf7b3db25086b2c8c7fe3a76e)                OVER (PARTITION BY de459e2fe7f96e4d958537b31b946b26.c437d55d53d88d02ce92bdadaefd8483.6bd6b7c188fef616b113c81245338906, de459e2fe7f96e4d958537b31b946b26.c437d55d53d88d02ce92bdadaefd8483.75274b7e794ec4ac03e63646e000c70b, de459e2fe7f96e4d958537b31b946b26.2c04d82ed0aa1cc9bce2cf2c0548b268.bc67869ea458ed1405f649ae7b6277c2) category_qty,\n     SUM(de459e2fe7f96e4d958537b31b946b26.c437d55d53d88d02ce92bdadaefd8483.bb2dfd06913e72dbc1733f20ba3699ea2742f685419072427fdf6d978b822ac7) OVER (PARTITION BY de459e2fe7f96e4d958537b31b946b26.c437d55d53d88d02ce92bdadaefd8483.6bd6b7c188fef616b113c81245338906, de459e2fe7f96e4d958537b31b946b26.c437d55d53d88d02ce92bdadaefd8483.75274b7e794ec4ac03e63646e000c70b, de459e2fe7f96e4d958537b31b946b26.2c04d82ed0aa1cc9bce2cf2c0548b268.bc67869ea458ed1405f649ae7b6277c2) category_weight,\n     SUM(de459e2fe7f96e4d958537b31b946b26.c437d55d53d88d02ce92bdadaefd8483.0d664c9790a40f8877ce994a41ca662496a8e7c926d4a6d230ee2652a5996563)    OVER (PARTITION BY de459e2fe7f96e4d958537b31b946b26.c437d55d53d88d02ce92bdadaefd8483.6bd6b7c188fef616b113c81245338906, de459e2fe7f96e4d958537b31b946b26.c437d55d53d88d02ce92bdadaefd8483.75274b7e794ec4ac03e63646e000c70b, de459e2fe7f96e4d958537b31b946b26.2c04d82ed0aa1cc9bce2cf2c0548b268.bc67869ea458ed1405f649ae7b6277c2) category_cube,\n     row_NUMBER()                    OVER (PARTITION BY de459e2fe7f96e4d958537b31b946b26.c437d55d53d88d02ce92bdadaefd8483.6bd6b7c188fef616b113c81245338906, de459e2fe7f96e4d958537b31b946b26.c437d55d53d88d02ce92bdadaefd8483.75274b7e794ec4ac03e63646e000c70b, de459e2fe7f96e4d958537b31b946b26.2c04d82ed0aa1cc9bce2cf2c0548b268.bc67869ea458ed1405f649ae7b6277c2 ORDER BY  1) category_row,\n    \n     de459e2fe7f96e4d958537b31b946b26.2c04d82ed0aa1cc9bce2cf2c0548b268.64880443cd326d3df9e34fd9d973c3d4,\n     SUM(de459e2fe7f96e4d958537b31b946b26.c437d55d53d88d02ce92bdadaefd8483.e7cabb8cf7b3db25086b2c8c7fe3a76e)                OVER (PARTITION BY de459e2fe7f96e4d958537b31b946b26.c437d55d53d88d02ce92bdadaefd8483.6bd6b7c188fef616b113c81245338906, de459e2fe7f96e4d958537b31b946b26.c437d55d53d88d02ce92bdadaefd8483.75274b7e794ec4ac03e63646e000c70b, de459e2fe7f96e4d958537b31b946b26.2c04d82ed0aa1cc9bce2cf2c0548b268.64880443cd326d3df9e34fd9d973c3d4) class_qty,\n     SUM(de459e2fe7f96e4d958537b31b946b26.c437d55d53d88d02ce92bdadaefd8483.bb2dfd06913e72dbc1733f20ba3699ea2742f685419072427fdf6d978b822ac7) OVER (PARTITION BY de459e2fe7f96e4d958537b31b946b26.c437d55d53d88d02ce92bdadaefd8483.6bd6b7c188fef616b113c81245338906, de459e2fe7f96e4d958537b31b946b26.c437d55d53d88d02ce92bdadaefd8483.75274b7e794ec4ac03e63646e000c70b, de459e2fe7f96e4d958537b31b946b26.2c04d82ed0aa1cc9bce2cf2c0548b268.64880443cd326d3df9e34fd9d973c3d4) class_weight,\n     SUM(de459e2fe7f96e4d958537b31b946b26.c437d55d53d88d02ce92bdadaefd8483.0d664c9790a40f8877ce994a41ca662496a8e7c926d4a6d230ee2652a5996563)    OVER (PARTITION BY de459e2fe7f96e4d958537b31b946b26.c437d55d53d88d02ce92bdadaefd8483.6bd6b7c188fef616b113c81245338906, de459e2fe7f96e4d958537b31b946b26.c437d55d53d88d02ce92bdadaefd8483.75274b7e794ec4ac03e63646e000c70b, de459e2fe7f96e4d958537b31b946b26.2c04d82ed0aa1cc9bce2cf2c0548b268.64880443cd326d3df9e34fd9d973c3d4) class_cube,\n     row_NUMBER()                    OVER (PARTITION BY de459e2fe7f96e4d958537b31b946b26.c437d55d53d88d02ce92bdadaefd8483.6bd6b7c188fef616b113c81245338906, de459e2fe7f96e4d958537b31b946b26.c437d55d53d88d02ce92bdadaefd8483.75274b7e794ec4ac03e63646e000c70b, de459e2fe7f96e4d958537b31b946b26.2c04d82ed0aa1cc9bce2cf2c0548b268.64880443cd326d3df9e34fd9d973c3d4 ORDER BY  1) class_row\n    \n    FROM\n      de459e2fe7f96e4d958537b31b946b26.c437d55d53d88d02ce92bdadaefd8483 po,\n      de459e2fe7f96e4d958537b31b946b26.c50b6339218f0dbbd97ce6557f2b051f prod,\n      de459e2fe7f96e4d958537b31b946b26.2c04d82ed0aa1cc9bce2cf2c0548b268 pim\n    \n     WHERE de459e2fe7f96e4d958537b31b946b26.c437d55d53d88d02ce92bdadaefd8483.75274b7e794ec4ac03e63646e000c70b > sysdate - c_subtract_days\n      AND de459e2fe7f96e4d958537b31b946b26.c437d55d53d88d02ce92bdadaefd8483.6bd6b7c188fef616b113c81245338906 <> '0'\n      AND de459e2fe7f96e4d958537b31b946b26.c437d55d53d88d02ce92bdadaefd8483.26ac88e7ae671a1b22c14c2fce77aa2d NOT IN ('SB', 'SS')\n      AND de459e2fe7f96e4d958537b31b946b26.c50b6339218f0dbbd97ce6557f2b051f.d3268eabc4a7d98105fd85f9c9e62cd6e32ad436514bbe822b33de8bead744f3 = de459e2fe7f96e4d958537b31b946b26.2c04d82ed0aa1cc9bce2cf2c0548b268.d3268eabc4a7d98105fd85f9c9e62cd6e32ad436514bbe822b33de8bead744f3\n      AND de459e2fe7f96e4d958537b31b946b26.c50b6339218f0dbbd97ce6557f2b051f.839c4ffb4bfaae1bb58eab4dee67d96a = de459e2fe7f96e4d958537b31b946b26.c437d55d53d88d02ce92bdadaefd8483.839c4ffb4bfaae1bb58eab4dee67d96a\n      AND de459e2fe7f96e4d958537b31b946b26.c50b6339218f0dbbd97ce6557f2b051f.2d45d761eb8d137835bca7a23010fab4 = de459e2fe7f96e4d958537b31b946b26.c437d55d53d88d02ce92bdadaefd8483.2d45d761eb8d137835bca7a23010fab4\n)\n, winners as (\n    SELECT\n      dtl.*,\n      CASE\n        DENSE_RANK ()\n        OVER (\n          PARTITION BY po_nbr, po_rcvd_dt\n          ORDER BY  storage_qty desc, storage_weight desc, storage_cube desc, storage_row\n        )\n        WHEN 1 THEN ec89ee04802c58112739f47fec743e5b.718cda5251e1aefe6a111765fe68187f\n        ELSE NULL\n      end storage_winner,\n    \n     CASE\n        DENSE_RANK ()\n        OVER (\n          PARTITION BY po_nbr, po_rcvd_dt\n          ORDER BY  category_qty desc, category_weight desc, category_cube desc, category_row\n        )\n        WHEN 1 THEN pim_ctgry_desc\n        ELSE NULL\n      end category_winner,\n    \n     CASE\n        DENSE_RANK ()\n        OVER (\n          PARTITION BY po_nbr, po_rcvd_dt\n          ORDER BY  class_qty desc, class_weight desc, class_cube desc, class_row\n        )\n        WHEN 1 THEN ec89ee04802c58112739f47fec743e5b.64880443cd326d3df9e34fd9d973c3d4\n        ELSE NULL\n      end class_winner\n    \n    FROM dtl d\n    )\n    SELECT e825f6527f035cb5950f64f94428fc6a.6bd6b7c188fef616b113c81245338906 || TO_CHAR(e825f6527f035cb5950f64f94428fc6a.839c4ffb4bfaae1bb58eab4dee67d96a) || TO_CHAR(e825f6527f035cb5950f64f94428fc6a.75274b7e794ec4ac03e63646e000c70b, 'YYYYMMDD') lookup_key,\n         COUNT(DISTINCT  prod_strg_cd) stg_ctr,\n         COUNT(DISTINCT  pim_ctgry_desc) category_ctr,\n         COUNT(DISTINCT  pim_cls_desc) class_ctr,\n         MAX(storage_winner)  storage_winner,\n         MAX(category_winner) category_winner,\n         MAX(class_winner)    class_winner\n    FROM winners w\n    GROUP BY  e825f6527f035cb5950f64f94428fc6a.6bd6b7c188fef616b113c81245338906, e825f6527f035cb5950f64f94428fc6a.839c4ffb4bfaae1bb58eab4dee67d96a, e825f6527f035cb5950f64f94428fc6a.75274b7e794ec4ac03e63646e000c70b\n    ORDER BY  e825f6527f035cb5950f64f94428fc6a.6bd6b7c188fef616b113c81245338906 || TO_CHAR(e825f6527f035cb5950f64f94428fc6a.839c4ffb4bfaae1bb58eab4dee67d96a) || TO_CHAR(e825f6527f035cb5950f64f94428fc6a.75274b7e794ec4ac03e63646e000c70b, 'YYYYMMDD');\n\nCURSOR cur_brand2_weight\nIS\n    SELECT  de459e2fe7f96e4d958537b31b946b26.c437d55d53d88d02ce92bdadaefd8483.6bd6b7c188fef616b113c81245338906 || TO_CHAR(de459e2fe7f96e4d958537b31b946b26.c437d55d53d88d02ce92bdadaefd8483.839c4ffb4bfaae1bb58eab4dee67d96a) || TO_CHAR(de459e2fe7f96e4d958537b31b946b26.c437d55d53d88d02ce92bdadaefd8483.75274b7e794ec4ac03e63646e000c70b, 'YYYYMMDD') lookup_key,\n         NVL(SUM(de459e2fe7f96e4d958537b31b946b26.c437d55d53d88d02ce92bdadaefd8483.bb2dfd06913e72dbc1733f20ba3699ea2742f685419072427fdf6d978b822ac7 ), 0)\n    FROM de459e2fe7f96e4d958537b31b946b26.c50b6339218f0dbbd97ce6557f2b051f prod, de459e2fe7f96e4d958537b31b946b26.2c04d82ed0aa1cc9bce2cf2c0548b268 pim, de459e2fe7f96e4d958537b31b946b26.c437d55d53d88d02ce92bdadaefd8483 po\n    WHERE de459e2fe7f96e4d958537b31b946b26.c437d55d53d88d02ce92bdadaefd8483.75274b7e794ec4ac03e63646e000c70b > sysdate - c_subtract_days\n    AND de459e2fe7f96e4d958537b31b946b26.c437d55d53d88d02ce92bdadaefd8483.6bd6b7c188fef616b113c81245338906 <> '0'\n    AND de459e2fe7f96e4d958537b31b946b26.c437d55d53d88d02ce92bdadaefd8483.26ac88e7ae671a1b22c14c2fce77aa2d NOT IN ('SB', 'SS')\n    AND de459e2fe7f96e4d958537b31b946b26.c50b6339218f0dbbd97ce6557f2b051f.d3268eabc4a7d98105fd85f9c9e62cd6e32ad436514bbe822b33de8bead744f3 = de459e2fe7f96e4d958537b31b946b26.2c04d82ed0aa1cc9bce2cf2c0548b268.d3268eabc4a7d98105fd85f9c9e62cd6e32ad436514bbe822b33de8bead744f3\n    AND de459e2fe7f96e4d958537b31b946b26.c50b6339218f0dbbd97ce6557f2b051f.839c4ffb4bfaae1bb58eab4dee67d96a = de459e2fe7f96e4d958537b31b946b26.c437d55d53d88d02ce92bdadaefd8483.839c4ffb4bfaae1bb58eab4dee67d96a\n    AND de459e2fe7f96e4d958537b31b946b26.c50b6339218f0dbbd97ce6557f2b051f.2d45d761eb8d137835bca7a23010fab4 = de459e2fe7f96e4d958537b31b946b26.c437d55d53d88d02ce92bdadaefd8483.2d45d761eb8d137835bca7a23010fab4\n    AND de459e2fe7f96e4d958537b31b946b26.2c04d82ed0aa1cc9bce2cf2c0548b268.c1a0243994c58a08334e325e29a31260 = '2'\n    GROUP BY  de459e2fe7f96e4d958537b31b946b26.c437d55d53d88d02ce92bdadaefd8483.6bd6b7c188fef616b113c81245338906 || TO_CHAR(de459e2fe7f96e4d958537b31b946b26.c437d55d53d88d02ce92bdadaefd8483.839c4ffb4bfaae1bb58eab4dee67d96a) || TO_CHAR(de459e2fe7f96e4d958537b31b946b26.c437d55d53d88d02ce92bdadaefd8483.75274b7e794ec4ac03e63646e000c70b, 'YYYYMMDD')\n    ORDER BY  de459e2fe7f96e4d958537b31b946b26.c437d55d53d88d02ce92bdadaefd8483.6bd6b7c188fef616b113c81245338906 || TO_CHAR(de459e2fe7f96e4d958537b31b946b26.c437d55d53d88d02ce92bdadaefd8483.839c4ffb4bfaae1bb58eab4dee67d96a) || TO_CHAR(de459e2fe7f96e4d958537b31b946b26.c437d55d53d88d02ce92bdadaefd8483.75274b7e794ec4ac03e63646e000c70b, 'YYYYMMDD');\n\nCURSOR cur_weights\nIS\n    SELECT de459e2fe7f96e4d958537b31b946b26.c437d55d53d88d02ce92bdadaefd8483.6bd6b7c188fef616b113c81245338906 || TO_CHAR(de459e2fe7f96e4d958537b31b946b26.c437d55d53d88d02ce92bdadaefd8483.839c4ffb4bfaae1bb58eab4dee67d96a) || TO_CHAR(de459e2fe7f96e4d958537b31b946b26.c437d55d53d88d02ce92bdadaefd8483.75274b7e794ec4ac03e63646e000c70b, 'YYYYMMDD') lookup_key,\n                36b10b5990f32f3b219ace8965e68113.7912c2de6b9947bd190eb28a3b4992bb, SUM(de459e2fe7f96e4d958537b31b946b26.c437d55d53d88d02ce92bdadaefd8483.bb2dfd06913e72dbc1733f20ba3699ea2742f685419072427fdf6d978b822ac7)\n    FROM de459e2fe7f96e4d958537b31b946b26.c50b6339218f0dbbd97ce6557f2b051f prod, de459e2fe7f96e4d958537b31b946b26.c437d55d53d88d02ce92bdadaefd8483 po,  de459e2fe7f96e4d958537b31b946b26.de40ae7be8b2eb3858d46af8d107f3db param\n    WHERE de459e2fe7f96e4d958537b31b946b26.c437d55d53d88d02ce92bdadaefd8483.75274b7e794ec4ac03e63646e000c70b > sysdate - c_subtract_days\n    AND de459e2fe7f96e4d958537b31b946b26.c437d55d53d88d02ce92bdadaefd8483.6bd6b7c188fef616b113c81245338906 <> '0'\n    AND de459e2fe7f96e4d958537b31b946b26.c437d55d53d88d02ce92bdadaefd8483.26ac88e7ae671a1b22c14c2fce77aa2d NOT IN ('SB', 'SS')\n    AND de459e2fe7f96e4d958537b31b946b26.c50b6339218f0dbbd97ce6557f2b051f.839c4ffb4bfaae1bb58eab4dee67d96a = de459e2fe7f96e4d958537b31b946b26.c437d55d53d88d02ce92bdadaefd8483.839c4ffb4bfaae1bb58eab4dee67d96a\n    AND de459e2fe7f96e4d958537b31b946b26.c50b6339218f0dbbd97ce6557f2b051f.2d45d761eb8d137835bca7a23010fab4 = de459e2fe7f96e4d958537b31b946b26.c437d55d53d88d02ce92bdadaefd8483.2d45d761eb8d137835bca7a23010fab4\n    AND 36b10b5990f32f3b219ace8965e68113.21319c0daf5795b1dd5bdba57ab2f0e1 = 'LOGISTICS'\n    AND 36b10b5990f32f3b219ace8965e68113.7a8fbded31f2f81fc7be922920695486 = 'STORAGE_CD'\n    AND  de459e2fe7f96e4d958537b31b946b26.c50b6339218f0dbbd97ce6557f2b051f.718cda5251e1aefe6a111765fe68187f = TO_NUMBER(SUBSTR(36b10b5990f32f3b219ace8965e68113.bc06f1507de3c8ac835d2af3a4ffa443, 1, 2))\n    AND  SUBSTR(36b10b5990f32f3b219ace8965e68113.bc06f1507de3c8ac835d2af3a4ffa443, 3, 2) =  '-2'\n    GROUP BY 36b10b5990f32f3b219ace8965e68113.7912c2de6b9947bd190eb28a3b4992bb , de459e2fe7f96e4d958537b31b946b26.c437d55d53d88d02ce92bdadaefd8483.6bd6b7c188fef616b113c81245338906 || TO_CHAR(de459e2fe7f96e4d958537b31b946b26.c437d55d53d88d02ce92bdadaefd8483.839c4ffb4bfaae1bb58eab4dee67d96a) || TO_CHAR(de459e2fe7f96e4d958537b31b946b26.c437d55d53d88d02ce92bdadaefd8483.75274b7e794ec4ac03e63646e000c70b, 'YYYYMMDD')\n    ORDER BY de459e2fe7f96e4d958537b31b946b26.c437d55d53d88d02ce92bdadaefd8483.6bd6b7c188fef616b113c81245338906 || TO_CHAR(de459e2fe7f96e4d958537b31b946b26.c437d55d53d88d02ce92bdadaefd8483.839c4ffb4bfaae1bb58eab4dee67d96a) || TO_CHAR(de459e2fe7f96e4d958537b31b946b26.c437d55d53d88d02ce92bdadaefd8483.75274b7e794ec4ac03e63646e000c70b, 'YYYYMMDD'), 36b10b5990f32f3b219ace8965e68113.7912c2de6b9947bd190eb28a3b4992bb;\n\nCURSOR cur_storage_values\n IS\n     SELECT param_code, param_value_chr, param_value_nbr\n     FROM  de459e2fe7f96e4d958537b31b946b26.de40ae7be8b2eb3858d46af8d107f3db\n     WHERE app_name = 'LOGISTICS'\n     AND param_type = 'STORAGE_CD'\n     ORDER BY param_code;\n\nCURSOR cur_freight_ind\nIS\n    SELECT param_code, param_value_chr\n    FROM de459e2fe7f96e4d958537b31b946b26.de40ae7be8b2eb3858d46af8d107f3db\n    WHERE app_name = 'LOGISTICS'\n    AND param_type = 'FREIGHT_IND'\n    ORDER BY param_code;\n\n\n\n\n TYPE rt_po IS RECORD(\n    po_nbr                          VARCHAR2(11),\n    brnch_cd                        VARCHAR2(12),\n    div_nm                          VARCHAR2(90),\n    div_nbr                         NUMBER,\n    po_rcvd_dt                      DATE,\n    cmpny_vndr_nm                   VARCHAR2(30),\n    prch_from_vndr_nm               VARCHAR2(100),\n    prch_from_vndr_nbr              VARCHAR2(10),\n    ship_from_vndr_nbr              VARCHAR2(6),\n    ap_vndr_nbr                     VARCHAR2(11),\n    ofv_cmpny_vndr_nbr_actl         NUMBER,\n    ord_from_vndr_nbr               VARCHAR2(6),\n    fisc_mth_of_yr                  NUMBER,\n    fisc_wk_of_yr                   NUMBER,\n    fisc_yr                         NUMBER,\n    ord_dt                          DATE,\n    aptnt_dt                        DATE,\n    arvl_dt                         DATE,\n    buyr_nm                         VARCHAR2(50),\n    buyr_nbr                        VARCHAR2(3),\n    orig_pickup_dt                  DATE,\n    prod_cube_rcvd_extnd            NUMBER,\n    prod_grs_wght_rcvd_extnd        NUMBER,\n    prod_net_wght_rcvd_extnd        NUMBER,\n    rcvd_qty                        NUMBER,\n    orig_qty_ord                    NUMBER,\n    carr_nm                         VARCHAR2(100),\n    ctms                            VARCHAR2(10),\n    po_total_freight_amount         NUMBER,\n    po_total_delivery_amount        NUMBER,\n    po_total_value_amount           NUMBER,\n    can_zip_cd_ind                  VARCHAR2(2),\n    sfv_city                        VARCHAR2(20),\n    sfv_st                          VARCHAR2(2),\n    sfv_zip_cd                      VARCHAR2(9),\n    pfv_cmpny_vndr_nbr_actl         NUMBER,\n    ship_from_vndr_nm               VARCHAR2(30),\n    drct_ship_ind                   CHAR(1),       \n    kraft_vndr_ind                  CHAR(1),       \n    pickup_dt                       DATE,          \n    miles                           NUMBER(7,2),   \n    crs_dck_flg                     CHAR(1),       \n    rgn_nm                          VARCHAR2 (75), \n    area_nm                         VARCHAR2 (75), \n   crs_dck_div_nbr            NUMBER,\n    scpo_grp_id                     VARCHAR2 (22), \n    bluprnt_id                      VARCHAR2 (10), \n    orig_arvl_dt                    DATE,          \n    po_dock_in_dt                   DATE,          \n    po_dock_out_dt                  DATE,          \n    po_gate_in_dt                   DATE,          \n    po_gate_out_dt                  DATE,          \n    po_total_cost_amount_sum        NUMBER,         \n    cnfrmd_pua_ttl             NUMBER(13, 4),\n    cnfrmd_ppaid_ttl           NUMBER(13, 4),\n    cnfrmd_frght_ttl           NUMBER(13, 4),\n    cnfrmd_mrkt_frght_ttl      NUMBER(13, 4),\n    rcvd_pua_ttl               NUMBER(13, 4),\n    rcvd_ppaid_ttl             NUMBER(13, 4),\n    rcvd_frght_ttl             NUMBER(13, 4),\n    rcvd_mrkt_frght_ttl        NUMBER(13, 4),\n    \n    aptnt_tm\t\t\t            VARCHAR2(4 BYTE),\n    buyr_loc_typ_cd_actl\t\t\tVARCHAR2(1 BYTE),\n    buyr_sub_typ_actl\t\t\t    VARCHAR2(1 BYTE),\n    orig_aptnt_dt\t\t\t        DATE,\n    orig_aptnt_tm\t\t\t\t    VARCHAR2(6 BYTE),\n    cmp_po_brnch_nbr\t\t\t    VARCHAR2(2 BYTE),\n    cmp_po_nbr\t\t\t\t        VARCHAR2(9 BYTE),\n    arrvl_dt_chg_rsn\t\t\t    VARCHAR2(52 BYTE),\n    pickup_dt_chg_rsn\t\t\t    VARCHAR2(52 BYTE),\n    po_dock_in_tm\t\t\t\t    NUMBER(6),\n    po_dock_out_tm\t\t\t        NUMBER(6),\n    po_gate_in_tm\t\t\t\t    NUMBER(6),\n    po_gate_out_tm\t\t\t        NUMBER(6),\n    carr_scac_cd\t\t\t\t    VARCHAR2(4 BYTE),\n    frght_trm_cd_actl\t\t\t    VARCHAR2(4 BYTE)\n     );\n\n TYPE rt_po_collection IS TABLE OF rt_po;\n   nt_po        rt_po_collection;\n\n TYPE rt_output_record IS RECORD\n    (\n    po_nbr                          VARCHAR2(11),\n    shipment_nbr                    VARCHAR2(100),\n    brnch_cd                        VARCHAR2(12),\n    div_nm                          VARCHAR2(90),\n    div_nbr                         NUMBER,\n    cmpny_vndr_nm                   VARCHAR2(30),\n    prch_from_vndr_nm               VARCHAR2(30),\n    prch_from_vndr_nbr              VARCHAR2(10),\n    ship_from_vndr_nbr              VARCHAR2(6),\n    ap_vndr_nbr                     VARCHAR2(11),\n    ofv_cmpny_vndr_nbr_actl         NUMBER,\n    ord_from_vndr_nbr               VARCHAR2(6),\n    fisc_mth_of_yr                  NUMBER,\n    fisc_wk_of_yr                   NUMBER,\n    fisc_yr                         NUMBER,\n    ord_dt                          DATE,\n    arvl_dt                         DATE,\n    rcvd_dt                         DATE,\n    buyr_nm                         VARCHAR2(50),\n    buyr_nbr                        VARCHAR2(3),\n    orig_pickup_dt                  DATE,\n    prod_cube_rcvd_extnd            NUMBER,\n    prod_grs_wght_rcvd_extnd        NUMBER,\n    prod_net_wght_rcvd_extnd        NUMBER,\n    rcvd_qty                        NUMBER,\n    orig_qty_ord                    NUMBER,\n    carr_nm                         VARCHAR2(100),\n    ctms                            VARCHAR2(10),\n    PO_Total_Freight_Amount         NUMBER,\n    PO_Total_Delivery_Amount        NUMBER,\n    PO_Total_Value_Amount           NUMBER,\n    service                         VARCHAR2(10),\n    carrier_cd                      VARCHAR2(100),\n    carrier_nm                      VARCHAR2(100),\n    po_type                         VARCHAR2(100),\n    cross_dock_mit                  VARCHAR2(20),\n    voucher_date                    DATE,\n    po_weight                       NUMBER,\n    po_cases                        NUMBER,\n    po_cube                         NUMBER,\n    po_revenue                      NUMBER,\n    po_cost                         NUMBER,\n    po_savings                      NUMBER,\n    load_at_id                      VARCHAR2(16),\n    load_at_name                    VARCHAR2(50),\n    load_at_city                    VARCHAR2(40),\n    load_at_state                   VARCHAR2(3),\n    load_at_zip                     VARCHAR2(19),\n    origin_source                   VARCHAR2(50),\n    tips_commodity                  VARCHAR2(10),\n    temperature_class               VARCHAR2(100),\n    product_class                   VARCHAR2(100),\n    product_category                VARCHAR2(100),\n    eb_pct                          NUMBER,\n    freight_desc                    VARCHAR2(100),\n    weight_dry                      NUMBER,\n    weight_frozen                   NUMBER,\n    weight_refrigerated             NUMBER,\n    weight_ice_cream                NUMBER,\n    weight_hazmat                   NUMBER,\n    pfv_cmpny_vndr_nbr_actl         NUMBER,\n    drct_ship_ind                   CHAR(1),        \n    kraft_vndr_ind                  CHAR(1),        \n    pickup_dt                       DATE,           \n    miles                           NUMBER(7,2),    \n    crs_dck_flg                     CHAR(1),        \n    rgn_nm                          VARCHAR2 (75),  \n    area_nm                         VARCHAR2 (75),  \n    crs_dck_div_nbr NUMBER(4, 0),\n    scpo_grp_id                     VARCHAR2 (22),  \n    bluprnt_id                      VARCHAR2 (10),  \n    orig_arvl_dt                    DATE,           \n    po_dock_in_dt                   DATE,           \n    po_dock_out_dt                  DATE,           \n    po_gate_in_dt                   DATE,           \n    po_gate_out_dt                  DATE,           \n    po_rqstd_dt                     DATE,           \n    po_appt_dt                      DATE,           \n    po_plnd_dlvry_dt                DATE,           \n    po_total_cost_amount_sum        NUMBER,         \n    po_plnd_pckp_dt                 DATE,           \n    po_orig_due_dt                  DATE,           \n    primary_fclty_alias_id          VARCHAR2 (16),   \n    lst_arrvl_chg_reason            VARCHAR2(56),\n    lst_arrvl_chg_user_id           VARCHAR2(8),\n    lst_arrvl_chg_date              DATE,\n    cnfrmd_pua_ttl                  NUMBER(13, 4),\n    cnfrmd_ppaid_ttl                NUMBER(13, 4),\n    cnfrmd_frght_ttl                NUMBER(13, 4),\n    cnfrmd_mrkt_frght_ttl           NUMBER(13, 4),\n    rcvd_pua_ttl                    NUMBER(13, 4),\n    rcvd_ppaid_ttl                  NUMBER(13, 4),\n    rcvd_frght_ttl                  NUMBER(13, 4),\n    rcvd_mrkt_frght_ttl             NUMBER(13, 4),\n    po_id                           VARCHAR2(100),\n    date_arrival_befr               date,\n    date_arrival_aftr               date,\n    aptnt_dt\t\t\t            DATE,\n    aptnt_tm\t\t\t            VARCHAR2(4 BYTE),\n    buyr_loc_typ_cd_actl\t\t\tVARCHAR2(1 BYTE),\n    buyr_sub_typ_actl\t\t\t    VARCHAR2(1 BYTE),\n    orig_aptnt_dt\t\t\t        DATE,\n    orig_aptnt_tm\t\t\t\t    VARCHAR2(6 BYTE),\n    cmp_po_brnch_nbr\t\t\t    VARCHAR2(2 BYTE),\n    cmp_po_nbr\t\t\t\t        VARCHAR2(9 BYTE),\n    arrvl_dt_chg_rsn\t\t\t    VARCHAR2(52 BYTE),\n    pickup_dt_chg_rsn\t\t\t    VARCHAR2(52 BYTE),\n    po_dock_in_tm\t\t\t\t    NUMBER(6),\n    po_dock_out_tm\t\t\t        NUMBER(6),\n    po_gate_in_tm\t\t\t\t    NUMBER(6),\n    po_gate_out_tm\t\t\t        NUMBER(6),\n    carr_scac_cd\t\t\t\t    VARCHAR2(4 BYTE),\n    frght_trm_cd_actl\t\t\t    VARCHAR2(4 BYTE)\n\n    );\n  TYPE rt_output_record_collection IS TABLE OF rt_output_record;\n   nt_output_record        rt_output_record_collection := rt_output_record_collection();\n\n TYPE rt_products IS RECORD(\n    lookup_key          VARCHAR2(100),\n    storage_ctr      INTEGER,\n    category_ctr     INTEGER,\n    class_ctr        INTEGER,\n    storage_winner      VARCHAR2(100),\n    category_winner     VARCHAR2(100),\n    class_winner        VARCHAR2(100)\n    );\n\n TYPE rt_products_collection IS TABLE OF rt_products;\n   nt_products        rt_products_collection;\n\n TYPE rt_storage IS RECORD(\n    param_code          VARCHAR2(100),\n    param_value_chr     VARCHAR2(100),\n    param_value_nbr     NUMBER\n    );\n\n TYPE rt_storage_collection IS TABLE OF rt_storage;\n   nt_storage_values        rt_storage_collection;\n\n  TYPE rt_weights IS RECORD(\n    lookup_key          VARCHAR2(100),\n    protection     VARCHAR2(100),\n    weight         NUMBER\n    );\n\n TYPE rt_weights_collection IS TABLE OF rt_weights;\n   nt_weights        rt_weights_collection;\n\n\n\n\n  TYPE rt_weights_ptr IS RECORD(\n         lookup_key                  VARCHAR2(100),\n         nt_ptr                      INTEGER\n       );\n TYPE nt_weights_ptr_collection IS TABLE OF rt_weights_ptr;\n  nt_weights_ptr      nt_weights_ptr_collection := nt_weights_ptr_collection();\n\n  TYPE rt_brand2_weight IS RECORD(\n    lookup_key          VARCHAR2(100),\n    weight         NUMBER\n    );\n\n TYPE rt_brand2_weight_collection IS TABLE OF rt_brand2_weight;\n   nt_brand2_weight   rt_brand2_weight_collection;\n\n TYPE rt_freight IS RECORD(\n    param_code          VARCHAR2(100),\n    param_value_chr     VARCHAR2(100)\n    );\n\n TYPE rt_freight_collection IS TABLE OF rt_freight;\n   nt_freight_ind        rt_freight_collection;\n\n  TYPE rt_pim IS RECORD(\n    pim_id      NUMBER,\n    pim_desc    VARCHAR2(150),\n    rcvd_qty    NUMBER,\n    weight      NUMBER,\n    cube        NUMBER\n    );\n\n TYPE rt_pim_collection IS TABLE OF rt_pim;\n   nt_pim        rt_pim_collection;\n\n   TYPE ntt_number is table of NUMBER;\n   TYPE ntt_date is table of DATE;\n   TYPE ntt_varr IS table of VARCHAR2(100);\n\n   nt_tms_src                   ntt_varr;\n \nFUNCTION pf_binary_search_storage\n  \n( array_i                                rt_storage_collection,  \n  first_i                                PLS_INTEGER,\n  last_i                                 PLS_INTEGER,\n  string_i                               VARCHAR2   \n)\nRETURN INTEGER\n\nIS\nv_mid                                    PLS_INTEGER;\nv_ix                                    PLS_INTEGER;\nv_high                                  PLS_INTEGER;\nv_low                                   PLS_INTEGER;\nBEGIN\n       v_low := first_i;\n       v_high := last_i;\n       WHILE (v_low <= v_high) LOOP\n               v_mid := (v_low + v_high) / 2;\n               IF (array_i(v_mid).param_code > string_i) THEN\n                   v_high := v_mid - 1;\n               ELSIF (array_i(v_mid).param_code < string_i) THEN\n                   v_low := v_mid + 1;\n               ELSE\n                   RETURN v_mid;\n              END IF;\n       END LOOP;\n       return -1;\nEND pf_binary_search_storage;\n \nFUNCTION pf_binary_hazmat\n  \n( array_i                                ntt_varr,  \n  first_i                                PLS_INTEGER,\n  last_i                                 PLS_INTEGER,\n  string_i                               VARCHAR2   \n)\nRETURN INTEGER\n\nIS\nv_mid                                    PLS_INTEGER;\nv_ix                                    PLS_INTEGER;\nv_high                                  PLS_INTEGER;\nv_low                                   PLS_INTEGER;\nBEGIN\n       v_low := first_i;\n       v_high := last_i;\n       WHILE (v_low <= v_high) LOOP\n               v_mid := (v_low + v_high) / 2;\n               IF (array_i(v_mid) > string_i) THEN\n                   v_high := v_mid - 1;\n               ELSIF (array_i(v_mid) < string_i) THEN\n                   v_low := v_mid + 1;\n               ELSE\n                   RETURN v_mid;\n              END IF;\n       END LOOP;\n       return -1;\nEND pf_binary_hazmat;\n \nFUNCTION pf_binary_weight_ptr\n  \n( array_i                                 nt_weights_ptr_collection,  \n  first_i                                PLS_INTEGER,\n  last_i                                 PLS_INTEGER,\n  string_i                               VARCHAR2   \n)\nRETURN INTEGER\n\nIS\nv_mid                                    PLS_INTEGER;\nv_ix                                    PLS_INTEGER;\nv_high                                  PLS_INTEGER;\nv_low                                   PLS_INTEGER;\nBEGIN\n       v_low := first_i;\n       v_high := last_i;\n       WHILE (v_low <= v_high) LOOP\n               v_mid := (v_low + v_high) / 2;\n               IF (array_i(v_mid).lookup_key > string_i) THEN\n                   v_high := v_mid - 1;\n               ELSIF (array_i(v_mid).lookup_key < string_i) THEN\n                   v_low := v_mid + 1;\n               ELSE\n                   RETURN v_mid;\n              END IF;\n       END LOOP;\n       return -1;\nEND pf_binary_weight_ptr;\n\n \nFUNCTION pf_binary_brand2_weight\n  \n( array_i                                rt_brand2_weight_collection,  \n  first_i                                PLS_INTEGER,\n  last_i                                 PLS_INTEGER,\n  string_i                               VARCHAR2   \n)\nRETURN INTEGER\n\nIS\nv_mid                                    PLS_INTEGER;\nv_ix                                    PLS_INTEGER;\nv_high                                  PLS_INTEGER;\nv_low                                   PLS_INTEGER;\nBEGIN\n       v_low := first_i;\n       v_high := last_i;\n       WHILE (v_low <= v_high) LOOP\n               v_mid := (v_low + v_high) / 2;\n               IF (array_i(v_mid).lookup_key > string_i) THEN\n                   v_high := v_mid - 1;\n               ELSIF (array_i(v_mid).lookup_key < string_i) THEN\n                   v_low := v_mid + 1;\n               ELSE\n                   RETURN v_mid;\n              END IF;\n       END LOOP;\n       return -1;\nEND pf_binary_brand2_weight;\n\n \nFUNCTION pf_binary_class_cat_stg\n  \n( array_i                                rt_products_collection,  \n  first_i                                PLS_INTEGER,\n  last_i                                 PLS_INTEGER,\n  string_i                               VARCHAR2   \n)\nRETURN INTEGER\n\nIS\nv_mid                                    PLS_INTEGER;\nv_ix                                    PLS_INTEGER;\nv_high                                  PLS_INTEGER;\nv_low                                   PLS_INTEGER;\nBEGIN\n       v_low := first_i;\n       v_high := last_i;\n       WHILE (v_low <= v_high) LOOP\n               v_mid := (v_low + v_high) / 2;\n               IF (array_i(v_mid).lookup_key > string_i) THEN\n                   v_high := v_mid - 1;\n               ELSIF (array_i(v_mid).lookup_key < string_i) THEN\n                   v_low := v_mid + 1;\n               ELSE\n                   RETURN v_mid;\n              END IF;\n       END LOOP;\n       return -1;\nEND pf_binary_class_cat_stg;\n \nFUNCTION pf_binary_freight_ind\n  \n( array_i                                rt_freight_collection,  \n  first_i                                PLS_INTEGER,\n  last_i                                 PLS_INTEGER,\n  string_i                               VARCHAR2   \n)\nRETURN INTEGER\n\nIS\nv_mid                                    PLS_INTEGER;\nv_ix                                    PLS_INTEGER;\nv_high                                  PLS_INTEGER;\nv_low                                   PLS_INTEGER;\nBEGIN\n       v_low := first_i;\n       v_high := last_i;\n       WHILE (v_low <= v_high) LOOP\n               v_mid := (v_low + v_high) / 2;\n               IF (array_i(v_mid).param_code > string_i) THEN\n                   v_high := v_mid - 1;\n               ELSIF (array_i(v_mid).param_code < string_i) THEN\n                   v_low := v_mid + 1;\n               ELSE\n                   RETURN v_mid;\n              END IF;\n       END LOOP;\n       return -1;\nEND pf_binary_freight_ind;\n\n\n PROCEDURE sp_common_routines\n\n\n\n IS\n BEGIN\n    g_display := 'common,reads: ' || g_reads;\n    DBMS_APPLICATION_INFO.SET_MODULE( module_name => 'PO_ROLLING_12', action_name => g_display);\n\n\n\n\n\n     g_temperature_class := NULL;\n\n     g_lookup_idx := pf_binary_class_cat_stg(nt_products , 1, 4a9dd21e86c3516dec24a31ff3f9524c.c838adb0c77d39edf51006214ba6e643,\n              g_lookup_key);\n     IF g_lookup_idx > -1  THEN\n            g_storage_winner    := nt_products(g_lookup_idx).storage_winner;\n            g_class_winner      := nt_products(g_lookup_idx).class_winner;\n            g_category_winner   := nt_products(g_lookup_idx).category_winner;\n            g_storage_ctr       := nt_products(g_lookup_idx).storage_ctr;\n            g_class_ctr         := nt_products(g_lookup_idx).class_ctr;\n            g_category_ctr      := nt_products(g_lookup_idx).category_ctr;\n     ELSE\n            g_storage_winner    := NULL;\n            g_class_winner      := NULL;\n            g_category_winner   := NULL;\n            g_storage_ctr       := 0;\n            g_class_ctr         := 0;\n            g_category_ctr      := 0;\n     END IF;\n\n     IF g_storage_winner IS NOT NULL THEN\n            IF g_storage_ctr = 1 THEN\n               g_search_strg_cd := g_storage_winner || '-2';\n            ELSE\n               g_search_strg_cd := g_storage_winner || '-3';\n            END IF;\n            g_lookup_idx := pf_binary_search_storage(nt_storage_values, 1, 05c614eafa4edc0aa06a7411066d2663e9a95106e01380a7834d36560e919770.c838adb0c77d39edf51006214ba6e643,\n                     g_search_strg_cd);\n            IF g_lookup_idx > -1  THEN\n                 g_temperature_class := nt_storage_values(g_lookup_idx).param_value_chr;\n            END IF;\n     END IF;\n\n\n\n\n    IF g_class_ctr = 0 THEN\n           g_product_class := NULL;\n    ELSIF g_class_ctr = 1 THEN\n           g_product_class := g_class_winner;\n    ELSE\n           g_product_class := 'MIX - ' || g_class_winner;\n    END IF;\n\n\n\n\n    IF g_category_ctr = 0 THEN\n           g_product_category := NULL;\n    ELSIF g_category_ctr = 1 THEN\n           g_product_category := g_category_winner;\n    ELSE\n           g_product_category :=  'MIX - ' || g_category_winner;\n    END IF;\n\n    g_display := 'common weights,reads: ' || g_reads;\n    DBMS_APPLICATION_INFO.SET_MODULE( module_name => 'PO_ROLLING_12', action_name => g_display);\n\n\n\n\n    g_lookup_idx := pf_binary_brand2_weight(nt_brand2_weight , 1, 64f32ce42ea1f915984e6376661e0ccbe32f6dd38f333cde68119d1f277367cd.c838adb0c77d39edf51006214ba6e643,\n            g_lookup_key  );\n    IF g_lookup_idx > -1  THEN\n         g_brand_weight := nt_brand2_weight(g_lookup_idx).weight;\n    ELSE\n         g_brand_weight := 0;\n    END IF;\n\n    IF nt_po(g_in_idx).prod_grs_wght_rcvd_extnd > 0 THEN\n        g_eb_pct := ROUND((g_brand_weight / nt_po(g_in_idx).prod_grs_wght_rcvd_extnd), 4);\n    ELSE\n        g_eb_pct := 0;\n    END IF;\n\n\n\n     g_freight_desc := NULL;\n     g_lookup_idx := pf_binary_freight_ind(nt_freight_ind, 1, 17edc1624bd77f90de9e208693854382.c838adb0c77d39edf51006214ba6e643,\n                g_ctms);\n     IF g_lookup_idx > -1  THEN\n           g_freight_desc   := nt_freight_ind(g_lookup_idx).param_value_chr;\n     END IF;\n\n\n\n\n    g_weight_dry            := 0;\n    g_weight_frozen         := 0;\n    g_weight_refrigerated   := 0;\n    g_weight_ice_cream      := 0;\n    g_weight_hazmat         := 0;\n\n    g_lookup_idx := pf_binary_weight_ptr(nt_weights_ptr , 1, e20ced27bf4f648283ec9bd4e2d633f5.c838adb0c77d39edf51006214ba6e643,\n            g_lookup_key  );\n    IF g_lookup_idx > -1  THEN\n         g_winning_idx := nt_weights_ptr(g_lookup_idx).nt_ptr;\n         WHILE TRUE\n         LOOP\n            IF g_winning_idx < 1 THEN\n                EXIT;\n            END IF;\n\n            IF nt_weights(g_winning_idx).lookup_key <> g_lookup_key THEN\n                EXIT;\n            END IF;\n            IF nt_weights(g_winning_idx).protection = 'Dry' THEN\n                g_weight_dry  := nt_weights(g_winning_idx).weight;\n            ELSIF nt_weights(g_winning_idx).protection = 'REFRIGERATED' THEN\n                g_weight_refrigerated  := nt_weights(g_winning_idx).weight;\n            ELSIF  nt_weights(g_winning_idx).protection = 'FROZEN' THEN\n                g_weight_frozen  := nt_weights(g_winning_idx).weight;\n            ELSIF  nt_weights(g_winning_idx).protection = 'FROZEN ICE CREAM' THEN\n                g_weight_ice_cream  := nt_weights(g_winning_idx).weight;\n            ELSIF  nt_weights(g_winning_idx).protection = 'Hazmat' THEN\n                g_weight_hazmat  := nt_weights(g_winning_idx).weight;\n            END IF;\n            g_winning_idx := g_winning_idx - 1;\n        END LOOP;\n    END IF;\n    EXCEPTION\n\n        WHEN OTHERS THEN\n                v_sqlcode := SQLCODE;\n                v_message := 'sp_common_routines sqlerror ' || v_sqlcode || ' ' ||  SUBSTR(SQLERRM, 1, 75);\n                dbms_output.put_line(v_message);\n                dbms_output.put_line('po/div/ship : ' || g_po_nbr  || ' ' || g_div_nbr\n                                || ' ' || g_shipment_nbr);\n                RAISE;\n END sp_common_routines;\n\n PROCEDURE sp_delivered\n\n\n\n IS\n g_my_string ntt_varr := ntt_varr();\n g_len          INTEGER;\n g_zip_idx      INTEGER;\n g_zip          VARCHAR2(50);\n BEGIN\n    sp_common_routines;\n    g_load_at_city  := nt_po(g_in_idx).sfv_city;\n    g_load_at_state := nt_po(g_in_idx).sfv_st;\n    g_zip           := nt_po(g_in_idx).sfv_zip_cd;\n    g_len           := LENGTH(g_zip);\n\n    IF nt_po(g_in_idx).can_zip_cd_ind IS NOT NULL THEN\n        b52fc1c003c710306e67b696f02f9921.9fe20a27bf3317c8378707edff216663;\n        g_zip_idx := 1;\n        FOR qix in 1 .. g_len LOOP\n            IF SUBSTR(g_zip, qix, 1) <> ' ' THEN\n                b52fc1c003c710306e67b696f02f9921.c9b38a3a2b19e4d68aa30f93c37d723d;\n                g_my_string(g_zip_idx) := SUBSTR(g_zip, qix, 1);\n                g_zip_idx := g_zip_idx + 1;\n            END IF;\n        END LOOP;\n        g_load_at_zip := NULL;\n        g_zip_idx := b52fc1c003c710306e67b696f02f9921.c838adb0c77d39edf51006214ba6e643;\n        FOR qix in 1 .. g_zip_idx LOOP\n            g_load_at_zip  := g_load_at_zip || g_my_string(qix);\n            IF qix = 6 THEN\n                EXIT;\n            END IF;\n        END LOOP;\n\n    ELSE\n        IF g_len > 5 THEN\n            g_load_at_zip   := SUBSTR(g_zip, 1, 5);\n        ELSE\n            g_load_at_zip   := g_zip;\n        END IF;\n    END IF;\n\n    g_origin_source :=  'Verified-SFV table';\n    g_po_type       := 'Delivered';\n\n\n    EXCEPTION\n        WHEN OTHERS THEN\n                v_sqlcode := SQLCODE;\n                v_message := 'sp_delivered sqlerror ' || v_sqlcode || ' ' ||  SUBSTR(SQLERRM, 1, 75);\n                dbms_output.put_line(v_message);\n                dbms_output.put_line('po/div/date/ship/reads : ' || g_po_nbr || ' / ' ||\n                      g_div_nbr   || ' / ' || g_po_rcvd_dt   || ' / ' || g_shipment_nbr\n                        || ' / ' ||  g_reads);\n                RAISE;\n END sp_delivered;\n\n\n PROCEDURE sp_managed\n\n\n\n IS\n BEGIN\n    sp_common_routines;\n    g_origin_source :=  'Verified-TMS';\n    BEGIN\n        SELECT  NVL(SUM(PO_REV), 0), NVL(SUM(TTL_COST), 0),\n                NVL(SUM(PO_REV - TTL_COST), 0)\n        INTO g_po_revenue, g_po_cost, g_po_savings\n        FROM de459e2fe7f96e4d958537b31b946b26.1a663eaf7ebda55b3a5b36843b82b02d\n        WHERE po_nbr = g_po_nbr\n        AND po_brnch_cd = g_brnch_cd\n        AND po_rcvd_dt = g_po_rcvd_dt;\n     EXCEPTION\n        WHEN NO_DATA_FOUND THEN\n           NULL;\n     END;\n\n\n\n\n\n    IF g_po_rcvd_dt IS NULL THEN\n          g_po_type := 'Managed - Pending Complete';\n    ELSIF g_tms_src = 'TIPS' THEN  \n            IF SUBSTR(g_srvc_cd, 1, 1) ='3' THEN\n                g_po_type := '3rd Party Business';\n            ELSIF SUBSTR(g_srvc_cd, 1, 1) in ('4', '5', 'L') THEN\n                g_po_type := '3rd Party Managed';\n            ELSIF  g_srvc_cd = 'BH' THEN\n                g_po_type := 'Backhaul';\n            ELSIF  g_srvc_cd = 'FLBH' THEN\n                g_po_type := 'Fleet Backhaul';\n            ELSIF SUBSTR(g_srvc_cd, 1, 1) in ('F') THEN\n                g_po_type := 'Fleet';\n            ELSIF  g_srvc_cd  in ('RR60', 'BOXR', 'BOXD') THEN\n                g_po_type := 'Rail';\n            ELSIF  g_srvc_cd  = 'RESC'   THEN\n                g_po_type := 'Resc';\n            ELSIF  g_srvc_cd= 'FLBH' THEN\n                g_po_type := 'Resc';\n            ELSIF  g_srvc_cd = 'RTV' THEN\n                g_po_type := 'Return to Vendor';\n            END IF;\n    ELSE \n        IF g_alt_hlng_typ IN ( '3PB', '3PI') THEN\n           g_po_type := '3rd Party Business';\n        ELSIF g_alt_hlng_typ = 'Rail' THEN\n           g_po_type := 'Rail';\n        ELSIF g_alt_hlng_typ = 'RESC' THEN\n           g_po_type := 'Resc';\n        ELSIF g_alt_hlng_typ = 'RTV' THEN\n           g_po_type := 'Return to Vendor';\n        ELSIF SUBSTR(g_carrier_cd, 1, 3) <> 'USF'\n              AND g_srvc_lvl = 'SINGLE' AND g_alt_hlng_typ IS NULL THEN\n                g_po_type := '3rd Party Managed';\n        ELSIF g_mot = 'LTL' AND g_alt_hlng_typ IS NULL THEN\n                g_po_type := '3rd Party Managed';\n        ELSIF SUBSTR(g_carrier_cd, 1, 3) = 'USF'\n              AND g_srvc_lvl = 'BH' AND g_alt_hlng_typ IS NULL THEN\n                g_po_type := 'Backhaul';\n        ELSIF SUBSTR(g_carrier_cd, 1, 3) = 'USF'\n              AND g_srvc_lvl <> 'BH' AND g_alt_hlng_typ IS NULL THEN\n                g_po_type := 'Fleet';\n        ELSIF g_mot = 'TL' AND SUBSTR(g_carrier_cd, 1, 3) = 'USF'\n              AND g_srvc_lvl = 'BH'  AND g_alt_hlng_typ IS NULL\n              AND g_brnch_cd = g_shp_dest_fclty_alias_id   THEN\n                g_po_type := 'Fleet Backhaul';\n\n        END IF;\n    END IF;\n\n    IF g_cross_dock = 'Y' THEN\n            g_cross_dock_mit := g_shp_orgn_fclty_alias_id;\n    ELSE\n            g_cross_dock_mit := NULL;\n    END IF;\n\n\n    EXCEPTION\n        WHEN OTHERS THEN\n                v_sqlcode := SQLCODE;\n                v_message := 'sp_managed sqlerror ' || v_sqlcode || ' ' ||  SUBSTR(SQLERRM, 1, 75);\n                dbms_output.put_line(v_message);\n                dbms_output.put_line('po/div/date/ship/reads : ' || g_po_nbr || ' / ' ||\n                      g_div_nbr   || ' / ' || g_po_rcvd_dt   || ' / ' || g_shipment_nbr\n                        || ' / ' ||  g_reads);\n                RAISE;\n END sp_managed;\n\n\n PROCEDURE sp_clear_work_fields\n\nIS\n BEGIN\n    g_shipment_nbr                     := NULL;\n    g_po_type                          := NULL;\n    g_carrier_cd                       := NULL;\n    g_carrier_nm                       := NULL;\n    g_mot                              := NULL;\n    g_eqpmt                            := NULL;\n    g_srvc_lvl                         := NULL;\n    g_shp_orgn_fclty_alias_id          := NULL;\n    g_voucher_date                     := NULL;\n    g_po_weight                        := 0;\n    g_po_cases                         := 0;\n    g_po_cube                          := 0;\n    g_po_revenue                       := 0;\n    g_po_cost                          := 0;\n    g_po_savings                       := 0;\n    g_load_at_id                       := NULL;\n    g_load_at_name                     := NULL;\n    g_load_at_city                     := NULL;\n    g_load_at_state                    := NULL;\n    g_load_at_zip                      := NULL;\n    g_origin_source                    := NULL;\n    g_tips_commodity                   := NULL;\n    g_tms_src                          := NULL;\n    g_po_rcvd_dt                       := NULL;\n    g_cross_dock                       := NULL;\n    g_cross_dock_mit                   := NULL;\n    g_po_orgn_fclty_alias_id           := NULL;\n    g_srvc_cd                          := NULL;\n    g_alt_hlng_typ                     := NULL;\n    g_shp_dest_fclty_alias_id          := NULL;\n    g_tms_prch_from_vndr_nm            := NULL;\n    g_po_rqstd_dt                      := NULL;\n    g_po_appt_dt                       := NULL;\n    g_po_plnd_dlvry_dt                 := NULL;\n    g_po_plnd_pckp_dt                  := NULL;\n    g_po_orig_due_dt                   := NULL;\n    g_primary_fclty_alias_id           := NULL;\n END sp_clear_work_fields;\n\n PROCEDURE sp_save_record\n\nIS\n BEGIN\n    5c5abea24d58b746f94f4f48a9eb9247e32f6dd38f333cde68119d1f277367cd.c9b38a3a2b19e4d68aa30f93c37d723d;\n    g_out_idx   := g_out_idx + 1;\n \n    nt_output_record(g_out_idx).po_nbr                            := g_po_nbr;\n    nt_output_record(g_out_idx).shipment_nbr                      := g_shipment_nbr;\n    nt_output_record(g_out_idx).brnch_cd                          := nt_po(g_in_idx).brnch_cd;\n    nt_output_record(g_out_idx).div_nm                            := nt_po(g_in_idx).div_nm;\n    nt_output_record(g_out_idx).div_nbr                           := nt_po(g_in_idx).div_nbr;\n    nt_output_record(g_out_idx).cmpny_vndr_nm                     := nt_po(g_in_idx).cmpny_vndr_nm;\n    nt_output_record(g_out_idx).prch_from_vndr_nm                 := nvl(nt_po(g_in_idx).prch_from_vndr_nm,g_tms_prch_from_vndr_nm);\n    nt_output_record(g_out_idx).prch_from_vndr_nbr                := nt_po(g_in_idx).prch_from_vndr_nbr;\n    nt_output_record(g_out_idx).ship_from_vndr_nbr                := nt_po(g_in_idx).ship_from_vndr_nbr;\n    nt_output_record(g_out_idx).ap_vndr_nbr                       := nt_po(g_in_idx).ap_vndr_nbr;\n    nt_output_record(g_out_idx).ofv_cmpny_vndr_nbr_actl           := nt_po(g_in_idx).ofv_cmpny_vndr_nbr_actl;\n    nt_output_record(g_out_idx).ord_from_vndr_nbr                 := nt_po(g_in_idx).ord_from_vndr_nbr;\n    nt_output_record(g_out_idx).fisc_mth_of_yr                    := nt_po(g_in_idx).fisc_mth_of_yr;\n    nt_output_record(g_out_idx).fisc_wk_of_yr                     := nt_po(g_in_idx).fisc_wk_of_yr;\n    nt_output_record(g_out_idx).fisc_yr                           := nt_po(g_in_idx).fisc_yr;\n    nt_output_record(g_out_idx).ord_dt                            := nt_po(g_in_idx).ord_dt;\n    nt_output_record(g_out_idx).arvl_dt                           := nt_po(g_in_idx).arvl_dt;\n    nt_output_record(g_out_idx).rcvd_dt                           := g_po_rcvd_dt;\n    nt_output_record(g_out_idx).buyr_nm                           := nt_po(g_in_idx).buyr_nm;\n    nt_output_record(g_out_idx).buyr_nbr                          := nt_po(g_in_idx).buyr_nbr;\n    nt_output_record(g_out_idx).orig_pickup_dt                    := nt_po(g_in_idx).orig_pickup_dt;\n    nt_output_record(g_out_idx).prod_cube_rcvd_extnd              := nt_po(g_in_idx).prod_cube_rcvd_extnd;\n    nt_output_record(g_out_idx).prod_grs_wght_rcvd_extnd          := nt_po(g_in_idx).prod_grs_wght_rcvd_extnd;\n    nt_output_record(g_out_idx).prod_net_wght_rcvd_extnd          := nt_po(g_in_idx).prod_net_wght_rcvd_extnd;\n    nt_output_record(g_out_idx).rcvd_qty                          := nt_po(g_in_idx).rcvd_qty;\n    nt_output_record(g_out_idx).orig_qty_ord                      := nt_po(g_in_idx).orig_qty_ord;\n    nt_output_record(g_out_idx).carr_nm                           := nt_po(g_in_idx).carr_nm;\n    nt_output_record(g_out_idx).ctms                              := nt_po(g_in_idx).ctms;\n    nt_output_record(g_out_idx).PO_Total_Freight_Amount           := nt_po(g_in_idx).PO_Total_Freight_Amount;\n    nt_output_record(g_out_idx).PO_Total_Delivery_Amount          := nt_po(g_in_idx).PO_Total_Delivery_Amount;\n    nt_output_record(g_out_idx).PO_Total_Value_Amount             := nt_po(g_in_idx).PO_Total_Value_Amount;\n    nt_output_record(g_out_idx).service                           := g_srvc_cd;\n    nt_output_record(g_out_idx).carrier_cd                        := g_carrier_cd;\n    nt_output_record(g_out_idx).carrier_nm                        := g_carrier_nm;\n    nt_output_record(g_out_idx).po_type                           := g_po_type;\n    nt_output_record(g_out_idx).cross_dock_mit                    := g_cross_dock_mit;\n    nt_output_record(g_out_idx).voucher_date                      := g_voucher_date;\n    nt_output_record(g_out_idx).po_weight                         := g_po_weight;\n    nt_output_record(g_out_idx).po_cases                          := g_po_cases;\n    nt_output_record(g_out_idx).po_cube                           := g_po_cube;\n    nt_output_record(g_out_idx).po_revenue                        := g_po_revenue;\n    nt_output_record(g_out_idx).po_cost                           := g_po_cost;\n    nt_output_record(g_out_idx).po_savings                        := g_po_savings;\n    nt_output_record(g_out_idx).load_at_id                        := g_load_at_id;\n    nt_output_record(g_out_idx).load_at_name                      := g_load_at_name;\n    nt_output_record(g_out_idx).load_at_city                      := g_load_at_city;\n    nt_output_record(g_out_idx).load_at_state                     := g_load_at_state;\n    nt_output_record(g_out_idx).load_at_zip                       := g_load_at_zip;\n    nt_output_record(g_out_idx).origin_source                     := g_origin_source;\n    nt_output_record(g_out_idx).tips_commodity                    := g_tips_commodity;\n    nt_output_record(g_out_idx).temperature_class                 := g_temperature_class;\n    nt_output_record(g_out_idx).product_class                     := g_product_class;\n    nt_output_record(g_out_idx).product_category                  := g_product_category;\n    nt_output_record(g_out_idx).eb_pct                            := g_eb_pct;\n    nt_output_record(g_out_idx).freight_desc                      := g_freight_desc;\n    nt_output_record(g_out_idx).weight_dry                        := g_weight_dry;\n    nt_output_record(g_out_idx).weight_frozen                     := g_weight_frozen;\n    nt_output_record(g_out_idx).weight_refrigerated               := g_weight_refrigerated;\n    nt_output_record(g_out_idx).weight_ice_cream                  := g_weight_ice_cream;\n    nt_output_record(g_out_idx).weight_hazmat                     := g_weight_hazmat;\n    nt_output_record(g_out_idx).pfv_cmpny_vndr_nbr_actl           := nt_po(g_in_idx).pfv_cmpny_vndr_nbr_actl;\n    nt_output_record(g_out_idx).drct_ship_ind                     := nt_po(g_in_idx).drct_ship_ind;           \n    nt_output_record(g_out_idx).kraft_vndr_ind                    := nt_po(g_in_idx).kraft_vndr_ind;          \n    nt_output_record(g_out_idx).pickup_dt                         := nt_po(g_in_idx).pickup_dt;               \n    nt_output_record(g_out_idx).miles                             := nt_po(g_in_idx).miles;                   \n    nt_output_record(g_out_idx).crs_dck_flg                       := nt_po(g_in_idx).crs_dck_flg;             \n    nt_output_record(g_out_idx).rgn_nm                            := nt_po(g_in_idx).rgn_nm;                  \n    nt_output_record(g_out_idx).area_nm                           := nt_po(g_in_idx).area_nm;                 \n    nt_output_record(g_out_idx).crs_dck_div_nbr            := nt_po(g_in_idx).crs_dck_div_nbr; \n    nt_output_record(g_out_idx).scpo_grp_id                       := nt_po(g_in_idx).scpo_grp_id;             \n    nt_output_record(g_out_idx).bluprnt_id                        := nt_po(g_in_idx).bluprnt_id;              \n    nt_output_record(g_out_idx).orig_arvl_dt                      := nt_po(g_in_idx).orig_arvl_dt;            \n    nt_output_record(g_out_idx).po_dock_in_dt                     := nt_po(g_in_idx).po_dock_in_dt;           \n    nt_output_record(g_out_idx).po_dock_out_dt                    := nt_po(g_in_idx).po_dock_out_dt;          \n    nt_output_record(g_out_idx).po_gate_in_dt                     := nt_po(g_in_idx).po_gate_in_dt;           \n    nt_output_record(g_out_idx).po_gate_out_dt                    := nt_po(g_in_idx).po_gate_out_dt;          \n    nt_output_record(g_out_idx).po_rqstd_dt                       := g_po_rqstd_dt;                           \n\n      nt_output_record(g_out_idx).po_appt_dt                 := nt_po(g_in_idx).aptnt_dt; \n    nt_output_record(g_out_idx).po_plnd_dlvry_dt                  := g_po_plnd_dlvry_dt;                      \n    nt_output_record(g_out_idx).po_total_cost_amount_sum          := nt_po(g_in_idx).po_total_cost_amount_sum;\n    nt_output_record(g_out_idx).po_plnd_pckp_dt                   := g_po_plnd_pckp_dt;                       \n    nt_output_record(g_out_idx).po_orig_due_dt                    := g_po_orig_due_dt;                        \n    nt_output_record(g_out_idx).primary_fclty_alias_id            := g_primary_fclty_alias_id;                \n      nt_output_record(g_out_idx).cnfrmd_pua_ttl             := nt_po(g_in_idx).cnfrmd_pua_ttl;\n      nt_output_record(g_out_idx).cnfrmd_ppaid_ttl           := nt_po(g_in_idx).cnfrmd_ppaid_ttl;\n      nt_output_record(g_out_idx).cnfrmd_frght_ttl           := nt_po(g_in_idx).cnfrmd_frght_ttl;\n      nt_output_record(g_out_idx).cnfrmd_mrkt_frght_ttl      := nt_po(g_in_idx).cnfrmd_mrkt_frght_ttl;\n      nt_output_record(g_out_idx).rcvd_pua_ttl               := nt_po(g_in_idx).rcvd_pua_ttl;\n      nt_output_record(g_out_idx).rcvd_ppaid_ttl             := nt_po(g_in_idx).rcvd_ppaid_ttl;\n      nt_output_record(g_out_idx).rcvd_frght_ttl             := nt_po(g_in_idx).rcvd_frght_ttl;\n      nt_output_record(g_out_idx).rcvd_mrkt_frght_ttl        := nt_po(g_in_idx).rcvd_mrkt_frght_ttl;\n      nt_output_record(g_out_idx).po_id                      := g_po_nbr || '_' || nt_po(g_in_idx).brnch_cd || '_' || TO_CHAR(g_po_rcvd_dt, 'YYYYMMDD');\n      \n      nt_output_record(g_out_idx).aptnt_dt             \t:= nt_po(g_in_idx).aptnt_dt;\n      nt_output_record(g_out_idx).aptnt_tm\t\t\t    := nt_po(g_in_idx).aptnt_tm;\n      nt_output_record(g_out_idx).buyr_loc_typ_cd_actl\t:= nt_po(g_in_idx).buyr_loc_typ_cd_actl;\n      nt_output_record(g_out_idx).buyr_sub_typ_actl\t\t:= nt_po(g_in_idx).buyr_sub_typ_actl;\n      nt_output_record(g_out_idx).orig_aptnt_dt\t\t\t:= nt_po(g_in_idx).orig_aptnt_dt;\n      nt_output_record(g_out_idx).orig_aptnt_tm\t\t\t:= nt_po(g_in_idx).orig_aptnt_tm;\n      nt_output_record(g_out_idx).cmp_po_brnch_nbr\t\t:= nt_po(g_in_idx).cmp_po_brnch_nbr;\n      nt_output_record(g_out_idx).cmp_po_nbr\t\t\t\t:= nt_po(g_in_idx).cmp_po_nbr;\n      nt_output_record(g_out_idx).arrvl_dt_chg_rsn\t\t:= nt_po(g_in_idx).arrvl_dt_chg_rsn;\n      nt_output_record(g_out_idx).pickup_dt_chg_rsn\t\t:= nt_po(g_in_idx).pickup_dt_chg_rsn;\n      nt_output_record(g_out_idx).po_dock_in_tm\t\t\t:= nt_po(g_in_idx).po_dock_in_tm;\n      nt_output_record(g_out_idx).po_dock_out_tm\t\t\t:= nt_po(g_in_idx).po_dock_out_tm;\n      nt_output_record(g_out_idx).po_gate_in_tm\t\t\t:= nt_po(g_in_idx).po_gate_in_tm;\n      nt_output_record(g_out_idx).po_gate_out_tm\t\t\t:= nt_po(g_in_idx).po_gate_out_tm;\n      nt_output_record(g_out_idx).carr_scac_cd\t\t\t:= nt_po(g_in_idx).carr_scac_cd;\n      nt_output_record(g_out_idx).frght_trm_cd_actl\t\t:= nt_po(g_in_idx).frght_trm_cd_actl;\n\n\n     EXCEPTION\n        WHEN OTHERS THEN\n                v_sqlcode := SQLCODE;\n                v_message := 'sp_save_record sqlerror ' || v_sqlcode || ' ' ||  SUBSTR(SQLERRM, 1, 75);\n                dbms_output.put_line(v_message);\n                dbms_output.put_line('po/div/date/ship/reads : ' || g_po_nbr || ' / ' ||\n                      g_div_nbr   || ' / ' || g_po_rcvd_dt   || ' / ' || g_shipment_nbr\n                        || ' / ' ||  g_reads);\n                RAISE;\nEND sp_save_record;\n\n PROCEDURE sp_po_reason_change\n\n\n\n\n IS\n BEGIN\n\n    FOR vix in 1 .. 5c5abea24d58b746f94f4f48a9eb9247e32f6dd38f333cde68119d1f277367cd.c838adb0c77d39edf51006214ba6e643 LOOP\n        g_div_nbr  :=  nt_output_record(vix).div_nbr;\n        g_po_nbr   := nt_output_record(vix).po_nbr;\n        g_ord_dt   := nt_output_record(vix).ord_dt;\n\n        nt_output_record(vix).lst_arrvl_chg_user_id := NULL;\n        nt_output_record(vix).lst_arrvl_chg_date :=  NULL;\n        nt_output_record(vix).lst_arrvl_chg_reason := NULL;\n        nt_output_record(vix).date_arrival_befr := NULL;\n        nt_output_record(vix).date_arrival_aftr := NULL;\n\n        SELECT  COUNT(1)\n        INTO g_how_many\n        FROM de459e2fe7f96e4d958537b31b946b26.b5d3e1877fb725f97fa73c9e35d75025\n        WHERE div_nbr = g_div_nbr\n        AND po_nbr = g_po_nbr\n        AND ord_dt = g_ord_dt\n        AND NVL(arrvl_dt_chg_rc_befr, 'yyzz') <> NVL(arrvl_dt_chg_rc_aftr, 'yyzz');\n\n        IF g_how_many > 0 THEN\n                SELECT  user_id, max_entry, arrvl_dt_chg_rc_aftr,\n                            date_arrival_befr, date_arrival_aftr\n                INTO  g_lst_arrvl_chg_user_id, g_lst_arrvl_chg_date,\n                        g_lst_arrvl_chg_reason,\n                       g_date_arrival_befr, g_date_arrival_aftr\n\n                FROM\n                (\n                    SELECT  ROW_NUMBER()  OVER (PARTITION BY po_nbr\n                        ORDER BY TO_DATE(TO_CHAR(entry_dt, 'yyyymmdd') ||\n                             TO_CHAR(LPAD(entry_tm, 6, 0)), 'yyyymmddhh24miss') desc) seq,\n                        user_id,  TO_DATE(TO_CHAR(entry_dt, 'yyyymmdd') ||\n                            TO_CHAR(LPAD(entry_tm, 6, 0)), 'yyyymmddhh24miss') max_entry,\n                            arrvl_dt_chg_rc_aftr,\n                            date_arrival_befr, date_arrival_aftr\n                    FROM de459e2fe7f96e4d958537b31b946b26.b5d3e1877fb725f97fa73c9e35d75025\n                    WHERE div_nbr = g_div_nbr\n                    AND po_nbr = g_po_nbr\n                    AND ord_dt = g_ord_dt\n                 )\n                WHERE seq = 1;\n                nt_output_record(vix).lst_arrvl_chg_user_id := g_lst_arrvl_chg_user_id;\n                nt_output_record(vix).lst_arrvl_chg_date :=  g_lst_arrvl_chg_date;\n                nt_output_record(vix).lst_arrvl_chg_reason := g_lst_arrvl_chg_reason;\n                nt_output_record(vix).date_arrival_befr := g_date_arrival_befr;\n                nt_output_record(vix).date_arrival_aftr := g_date_arrival_aftr;\n\n        END IF;\n   END LOOP;\n\n     EXCEPTION\n        WHEN OTHERS THEN\n                v_sqlcode := SQLCODE;\n                v_message := 'sp_po_reason_change sqlerror ' || v_sqlcode || ' ' ||  SUBSTR(SQLERRM, 1, 75);\n                dbms_output.put_line(v_message);\n                dbms_output.put_line('po/div/date/ship/reads : ' || g_po_nbr || ' / ' ||\n                      g_div_nbr   || ' / ' || g_po_rcvd_dt   || ' / ' || g_shipment_nbr\n                        || ' / ' ||  g_reads);\n                RAISE;\nEND sp_po_reason_change;\n\n\n PROCEDURE sp_insert_record\n\n\n\n IS\n BEGIN\n\n    sp_po_reason_change;\n\n    FORALL xix in 1 .. 5c5abea24d58b746f94f4f48a9eb9247e32f6dd38f333cde68119d1f277367cd.c838adb0c77d39edf51006214ba6e643\n      INSERT   INTO de459e2fe7f96e4d958537b31b946b26.004005d16938dad5662a90d6ec4cb169\n         (po_nbr, shipment_nbr, div_code,\n            div_name, division_number, company_vendor_name, supplier_name, purchase_from_vendor_number,\n            ship_from_vendor_number, ap_vendor_number, company_vendor_number, order_from_vendor_number,\n             fiscal_period, fiscal_week, fiscal_year, po_creation_date, po_due_date,\n            po_receive_date, buyer_name, buyer_number, cube, gross_weight, net_weight, cases,\n            ordered_quantity, discoverer_carrier_name, ctms_via, po_total_freight_amount_sum,\n            po_total_delivery_amount_sum, po_total_value_amount_sum,\n            service, carrier_code, carrier_name, po_type, cross_dock_mit,\n            voucher_date, po_weight, po_cases, po_cube, po_revenue, po_cost, po_savings,\n            load_at_id, load_at_name, load_at_city, load_at_state, load_at_zip, origin_source,\n            tips_commodity, temperature_classification, product_classification,\n            product_category, eb_pct, freight_description, dry_weight, frozen_weight, refrigerated_weight,\n            ice_cream_weight, hazmat_weight, pfv_cmpny_vndr_nbr_actl, ldr_tm\n            , drct_ship_ind, kraft_vndr_ind, pickup_dt, miles \n            , crs_dck_flg, primary_fclty_alias_id, rgn_nm, area_nm, scpo_grp_id, bluprnt_id, orig_arvl_dt \n            , po_dock_in_dt, po_dock_out_dt, po_gate_in_dt,  po_gate_out_dt,    \n            po_rqstd_dt, po_appt_dt, po_plnd_dlvry_dt, po_total_cost_amount_sum, po_plnd_pckp_dt, po_orig_due_dt, \n            lst_arrvl_chg_reason, lst_arrvl_chg_user_id, lst_arrvl_chg_date,\n            orig_pickup_dt,\n            crs_dck_div_nbr, cnfrmd_pua_ttl,\n            cnfrmd_ppaid_ttl, cnfrmd_frght_ttl, cnfrmd_mrkt_frght_ttl, rcvd_pua_ttl, rcvd_ppaid_ttl, rcvd_frght_ttl,\n            rcvd_mrkt_frght_ttl, po_id,\n            date_arrival_befr, date_arrival_aftr,\n            aptnt_dt,aptnt_tm,buyr_loc_typ_cd_actl,buyr_sub_typ_actl,orig_aptnt_dt,orig_aptnt_tm,\n            cmp_po_brnch_nbr,cmp_po_nbr,arrvl_dt_chg_rsn,pickup_dt_chg_rsn,\n            po_dock_in_tm,po_dock_out_tm,po_gate_in_tm,po_gate_out_tm,arvl_dt,carr_scac_cd,frght_trm_cd_actl\n          )\n         VALUES ( nt_output_record(xix).po_nbr,\n            nt_output_record(xix).shipment_nbr,\n            nt_output_record(xix).brnch_cd,\n            nt_output_record(xix).div_nm,\n            nt_output_record(xix).div_nbr,\n            nt_output_record(xix).cmpny_vndr_nm,\n            nt_output_record(xix).prch_from_vndr_nm,\n            nt_output_record(xix).prch_from_vndr_nbr,\n            nt_output_record(xix).ship_from_vndr_nbr,\n            nt_output_record(xix).ap_vndr_nbr,\n            nt_output_record(xix).pfv_cmpny_vndr_nbr_actl,\n            nt_output_record(xix).ord_from_vndr_nbr,\n            nt_output_record(xix).fisc_mth_of_yr ,\n            nt_output_record(xix).fisc_wk_of_yr,\n            nt_output_record(xix).fisc_yr,\n            nt_output_record(xix).ord_dt,\n            nt_output_record(xix).arvl_dt,\n            nt_output_record(xix).rcvd_dt,\n            nt_output_record(xix).buyr_nm,\n            nt_output_record(xix).buyr_nbr,\n            nt_output_record(xix).prod_cube_rcvd_extnd,\n            nt_output_record(xix).prod_grs_wght_rcvd_extnd,\n            nt_output_record(xix).prod_net_wght_rcvd_extnd,\n            nt_output_record(xix).rcvd_qty,\n            nt_output_record(xix).orig_qty_ord,\n            nt_output_record(xix).carr_nm,\n            nt_output_record(xix).ctms,\n            nt_output_record(xix).PO_Total_Freight_Amount,\n            nt_output_record(xix).PO_Total_Delivery_Amount,\n            nt_output_record(xix).PO_Total_Value_Amount,\n            nt_output_record(xix).service,\n            nt_output_record(xix).carrier_cd,\n            nt_output_record(xix).carrier_nm,\n            nt_output_record(xix).po_type,\n            nt_output_record(xix).cross_dock_mit,\n            nt_output_record(xix).voucher_date,\n            nt_output_record(xix).po_weight,\n            nt_output_record(xix).po_cases,\n            nt_output_record(xix).po_cube,\n            nt_output_record(xix).po_revenue,\n            nt_output_record(xix).po_cost,\n            nt_output_record(xix).po_savings,\n            nt_output_record(xix).load_at_id,\n            nt_output_record(xix).load_at_name,\n            nt_output_record(xix).load_at_city,\n            nt_output_record(xix).load_at_state,\n            nt_output_record(xix).load_at_zip,\n            nt_output_record(xix).origin_source,\n            nt_output_record(xix).tips_commodity,\n            nt_output_record(xix).temperature_class,\n            nt_output_record(xix).product_class,\n            nt_output_record(xix).product_category,\n            nt_output_record(xix).eb_pct,\n            nt_output_record(xix).freight_desc,\n            nt_output_record(xix).weight_dry,\n            nt_output_record(xix).weight_frozen,\n            nt_output_record(xix).weight_refrigerated,\n            nt_output_record(xix).weight_ice_cream,\n            nt_output_record(xix).weight_hazmat,\n            nt_output_record(xix).pfv_cmpny_vndr_nbr_actl,\n            g_ldr_tm,\n            nt_output_record(xix).drct_ship_ind,            \n            nt_output_record(xix).kraft_vndr_ind,           \n            nt_output_record(xix).pickup_dt,                \n            nt_output_record(xix).miles,                    \n            nt_output_record(xix).crs_dck_flg,              \n            nt_output_record(xix).primary_fclty_alias_id,   \n            nt_output_record(xix).rgn_nm,                   \n            nt_output_record(xix).area_nm,                  \n            nt_output_record(xix).scpo_grp_id,              \n            nt_output_record(xix).bluprnt_id,               \n            nt_output_record(xix).orig_arvl_dt,             \n            nt_output_record(xix).po_dock_in_dt,            \n            nt_output_record(xix).po_dock_out_dt,           \n            nt_output_record(xix).po_gate_in_dt,            \n            nt_output_record(xix).po_gate_out_dt,           \n            nt_output_record(xix).po_rqstd_dt,              \n            nt_output_record(xix).po_appt_dt,               \n            nt_output_record(xix).po_plnd_dlvry_dt,         \n            nt_output_record(xix).po_total_cost_amount_sum, \n            nt_output_record(xix).po_plnd_pckp_dt,          \n            nt_output_record(xix).po_orig_due_dt,           \n            nt_output_record(xix).lst_arrvl_chg_reason,\n            nt_output_record(xix).lst_arrvl_chg_user_id,\n            nt_output_record(xix).lst_arrvl_chg_date,\n            nt_output_record(xix).orig_pickup_dt,\n            nt_output_record(xix).crs_dck_div_nbr,\n            nt_output_record(xix).cnfrmd_pua_ttl,\n            nt_output_record(xix).cnfrmd_ppaid_ttl,\n            nt_output_record(xix).cnfrmd_frght_ttl,\n            nt_output_record(xix).cnfrmd_mrkt_frght_ttl,\n            nt_output_record(xix).rcvd_pua_ttl,\n            nt_output_record(xix).rcvd_ppaid_ttl,\n            nt_output_record(xix).rcvd_frght_ttl,\n            nt_output_record(xix).rcvd_mrkt_frght_ttl,\n            nt_output_record(xix).po_id,\n            nt_output_record(xix).date_arrival_befr,\n            nt_output_record(xix).date_arrival_aftr,\n            nt_output_record(xix).aptnt_dt,\n            nt_output_record(xix).aptnt_tm,\n            nt_output_record(xix).buyr_loc_typ_cd_actl,\n            nt_output_record(xix).buyr_sub_typ_actl,\n            nt_output_record(xix).orig_aptnt_dt,\n            nt_output_record(xix).orig_aptnt_tm,\n            nt_output_record(xix).cmp_po_brnch_nbr,\n            nt_output_record(xix).cmp_po_nbr,\n            nt_output_record(xix).arrvl_dt_chg_rsn,\n            nt_output_record(xix).pickup_dt_chg_rsn,\n            nt_output_record(xix).po_dock_in_tm,\n            nt_output_record(xix).po_dock_out_tm,\n            nt_output_record(xix).po_gate_in_tm,\n            nt_output_record(xix).po_gate_out_tm,\n            nt_output_record(xix).arvl_dt,\n            nt_output_record(xix).carr_scac_cd,\n            nt_output_record(xix).frght_trm_cd_actl\n\n          );\n    g_writes := g_writes + SQL%ROWCOUNT;\n    5c5abea24d58b746f94f4f48a9eb9247e32f6dd38f333cde68119d1f277367cd.9fe20a27bf3317c8378707edff216663;\n    g_out_idx   := 0;\n\n    EXCEPTION\n        WHEN OTHERS THEN\n                v_sqlcode := SQLCODE;\n                v_message := 'sp_insert_record sqlerror ' || v_sqlcode || ' ' ||  SUBSTR(SQLERRM, 1, 75);\n                dbms_output.put_line(v_message);\n                dbms_output.put_line('po/div/date/ship/reads : ' || g_po_nbr || ' / ' ||\n                      g_div_nbr   || ' / ' || g_po_rcvd_dt   || ' / ' || g_shipment_nbr\n                        || ' / ' ||  g_reads);\n                RAISE;\n END sp_insert_record;\n\n \n \n  BEGIN\n\n  SELECT PARAM_VALUE_NBR INTO c_subtract_days FROM 0e03d5c46556a742ba46252698396ef2.02e9d63d10f9b42832e13b830a66cb4e\n  WHERE APP_NAME = 'LOGISTICS' and PARAM_TYPE = 'PO_ROLLING' and PARAM_CODE = 'NBR_OF_DAYS' ;\n\n\n    DBMS_OUTPUT.PUT_LINE('BEGIN at ' || to_char(sysdate, 'yyyymmdd hh24:mi:ss'));\n\n\n\n    IF vendor_i IS NULL  OR vendor_i = '58070'  OR vendor_i = 'ALL' THEN\n         NULL;\n    ELSE\n        DBMS_OUTPUT.PUT_LINE('invalid vendor parm');\n        RETURN 1;\n    END IF;\n    g_reads     := 0;\n    g_writes    := 0;\n    g_out_idx   := 0;\n    DBMS_APPLICATION_INFO.SET_MODULE( module_name => 'PO_ROLLING_12', action_name => 'TRUNCATE');\n      g_truncate_return := 8e64339f96bb08058f5d52f1c04f954a.8ffe4678890c39c7d4ed38c2ed759e24.e4b5db2b3f9b19accbb8cddbfcd05bac(v_message, 'XDMADM',\n                     'PO_ROLLING_12' );\n      IF g_truncate_return <> 0 THEN\n            dbms_output.put_line('bad truncate, return code: ' || g_truncate_return);\n           RETURN 1;\n       END IF;\n\n\n\n\n    DBMS_APPLICATION_INFO.SET_MODULE( module_name => 'PO_ROLLING_12',\n                action_name => 'STORAGE ARRAY');\n     OPEN cur_storage_values;\n     FETCH cur_storage_values BULK COLLECT INTO nt_storage_values;\n     CLOSE cur_storage_values;\n     IF 05c614eafa4edc0aa06a7411066d2663e9a95106e01380a7834d36560e919770.c838adb0c77d39edf51006214ba6e643 = 0 THEN\n        dbms_output.put_line('Missing storage value records in param_value table- aborting');\n        RETURN 1;\n     END IF;\n\n\n\n\n    DBMS_APPLICATION_INFO.SET_MODULE( module_name => 'PO_ROLLING_12',\n               action_name => 'FREIGHT ARRAY');\n    OPEN cur_freight_ind;\n    FETCH cur_freight_ind  BULK COLLECT INTO nt_freight_ind;\n    CLOSE cur_freight_ind;\n     IF 17edc1624bd77f90de9e208693854382.c838adb0c77d39edf51006214ba6e643 = 0 THEN\n        dbms_output.put_line('Missing freight records in param_value table- aborting');\n        RETURN 1;\n     END IF;\n\n\n\n\n    DBMS_APPLICATION_INFO.SET_MODULE( module_name => 'PO_ROLLING_12',\n                action_name => 'CLASS/CAT ARRAY');\n    DBMS_APPLICATION_INFO.SET_MODULE( module_name => 'PO_ROLLING_12', action_name => 'cur_products');\n    OPEN cur_products;\n    FETCH cur_products BULK COLLECT INTO nt_products;\n    CLOSE cur_products;\n    dbms_output.put_line('storage/class/category count: ' || 4a9dd21e86c3516dec24a31ff3f9524c.c838adb0c77d39edf51006214ba6e643);\n\n\n\n\n    DBMS_APPLICATION_INFO.SET_MODULE( module_name => 'PO_ROLLING_12',\n                action_name => 'PROT WEIGHTS ARRAY');\n    OPEN cur_weights;\n    FETCH cur_weights BULK COLLECT INTO nt_weights;\n    CLOSE cur_weights;\n    dbms_output.put_line('weight count: ' || cc5402e1c5c0928d0ebed2d6969a16cb.c838adb0c77d39edf51006214ba6e643);\n    e20ced27bf4f648283ec9bd4e2d633f5.9fe20a27bf3317c8378707edff216663;\n\n  \n  \n  \n  \n\n   IF cc5402e1c5c0928d0ebed2d6969a16cb.c838adb0c77d39edf51006214ba6e643 > 0 THEN\n       FOR vix in 1 .. cc5402e1c5c0928d0ebed2d6969a16cb.c838adb0c77d39edf51006214ba6e643 LOOP\n           IF vix = 1 THEN\n                e20ced27bf4f648283ec9bd4e2d633f5.c9b38a3a2b19e4d68aa30f93c37d723d;\n                nt_weights_ptr(e20ced27bf4f648283ec9bd4e2d633f5.c838adb0c77d39edf51006214ba6e643).lookup_key := nt_weights(vix).lookup_key;\n                nt_weights_ptr(e20ced27bf4f648283ec9bd4e2d633f5.c838adb0c77d39edf51006214ba6e643).nt_ptr     := vix;\n           ELSIF nt_weights_ptr(e20ced27bf4f648283ec9bd4e2d633f5.c838adb0c77d39edf51006214ba6e643).lookup_key <> nt_weights(vix).lookup_key THEN\n                        e20ced27bf4f648283ec9bd4e2d633f5.c9b38a3a2b19e4d68aa30f93c37d723d;\n                        nt_weights_ptr(e20ced27bf4f648283ec9bd4e2d633f5.c838adb0c77d39edf51006214ba6e643).lookup_key := nt_weights(vix).lookup_key;\n                        nt_weights_ptr(e20ced27bf4f648283ec9bd4e2d633f5.c838adb0c77d39edf51006214ba6e643).nt_ptr     := vix;\n           ELSE\n                nt_weights_ptr(e20ced27bf4f648283ec9bd4e2d633f5.c838adb0c77d39edf51006214ba6e643).nt_ptr  := vix;\n           END IF;\n       END LOOP;\n   END IF;\n   dbms_output.put_line('ptr weight count: ' || e20ced27bf4f648283ec9bd4e2d633f5.c838adb0c77d39edf51006214ba6e643);\n\n\n\n\n   DBMS_APPLICATION_INFO.SET_MODULE( module_name => 'PO_ROLLING_12',\n                action_name => 'BRAND 2');\n   OPEN  cur_brand2_weight;\n   FETCH cur_brand2_weight BULK COLLECT INTO nt_brand2_weight;\n   CLOSE cur_brand2_weight;\n   dbms_output.put_line('brand2 weight count: ' || 64f32ce42ea1f915984e6376661e0ccbe32f6dd38f333cde68119d1f277367cd.c838adb0c77d39edf51006214ba6e643);\n   DBMS_APPLICATION_INFO.SET_MODULE( module_name => 'PO_ROLLING_12', action_name => 'starting main cursor');\n\n\n\n\n     c_sql_str := 'SELECT   ';\n     c_sql_str := c_sql_str || ' 9286383e21f04b9584c1bc569a201731.6bd6b7c188fef616b113c81245338906, fce896ca0fbbf5a5d330f2803036eb44.4855453efe73ff0bd0f7583df58260dd, fce896ca0fbbf5a5d330f2803036eb44.245658138d22919d7bd7dff808e5af8e, 9286383e21f04b9584c1bc569a201731.839c4ffb4bfaae1bb58eab4dee67d96a, 9286383e21f04b9584c1bc569a201731.75274b7e794ec4ac03e63646e000c70b, ';\n     c_sql_str := c_sql_str || ' min(aeaad0a1b4f46a0780f8669dcffabbbd.ec5f47a7f9d05b8b244d5898ce36aa8d), 67349a6782c4a19592e96391ff79fcbd.4b398d884e397727aeb50b1bf2299e6098df5d6b623334f2e9631188cca4cfd6, 9286383e21f04b9584c1bc569a201731.4b398d884e397727aeb50b1bf2299e607e8fe841f8abc0a126967273be28f1b7, ';\n     c_sql_str := c_sql_str || ' 9286383e21f04b9584c1bc569a201731.e51993c9a1f7d183e843324c1159ccbe7e8fe841f8abc0a126967273be28f1b7, 9286383e21f04b9584c1bc569a201731.1c74ebbf2dbba3a9b0e35068ec68f92a,  ';\n     c_sql_str := c_sql_str || ' min(9286383e21f04b9584c1bc569a201731.98d7ddf2f6c8df858c326e68806a6cb3f6283ea3dfab0ee7d1d005a13bf2d220), 9286383e21f04b9584c1bc569a201731.c796867d18fa43f881aaad4cdd379e65e6e6300089dae5a98e31814d0406060f, ';\n     c_sql_str := c_sql_str || ' TO_NUMBER(1d731bbdc4e3fb69a854112d4982eb99.e1d446673288adb6d5f219d0aa82d37a),  1d731bbdc4e3fb69a854112d4982eb99.cb5e253886eb30a93e66cbf95203a754, 1d731bbdc4e3fb69a854112d4982eb99.ab30d6d679879cfacfe389b97d1d3f0e, ';\n     c_sql_str := c_sql_str || ' 9286383e21f04b9584c1bc569a201731.d07269fd715528545216b1ab9353756e, max(9286383e21f04b9584c1bc569a201731.5f42f657502ef51f6e7ac3de0e37e066), max(9286383e21f04b9584c1bc569a201731.ce5f82a5e75938dfa35b47989ed3591a), ';\n     c_sql_str := c_sql_str || ' MAX(6d9b37be5a083f8b78d676aba846c823.2baf0479d4bc37749775d982b45dd2b4) buyr_nm, MAX(9286383e21f04b9584c1bc569a201731.28a0a9fcbd547bacb53c3275ede3b77f) buyr_nbr, MAX(9286383e21f04b9584c1bc569a201731.ade446765dd0d123d77ca8d49d75efe6) orig_pickup_dt , ';\n     c_sql_str := c_sql_str || ' NVL(SUM(9286383e21f04b9584c1bc569a201731.0d664c9790a40f8877ce994a41ca662496a8e7c926d4a6d230ee2652a5996563), 0), NVL(SUM(9286383e21f04b9584c1bc569a201731.bb2dfd06913e72dbc1733f20ba3699ea2742f685419072427fdf6d978b822ac7), 0), NVL(SUM(9286383e21f04b9584c1bc569a201731.2bdee5c217acf680bcc3b19980a3a4772742f685419072427fdf6d978b822ac7), 0), ';\n     c_sql_str := c_sql_str || ' NVL(SUM(9286383e21f04b9584c1bc569a201731.e7cabb8cf7b3db25086b2c8c7fe3a76e), 0), NVL(SUM(9286383e21f04b9584c1bc569a201731.d9228ac321fa56c1e52f26d365763970), 0),   ';\n     c_sql_str := c_sql_str || ' max(9286383e21f04b9584c1bc569a201731.5938af20283ebdf83028907a807f67fd),  ';\n     c_sql_str := c_sql_str || ' 9286383e21f04b9584c1bc569a201731.5f8f629038ff1cc5d37bc5204f8431e833cb242de526ddafe282bd57488cedea || 9286383e21f04b9584c1bc569a201731.a2c4963356f688f26c092337d1a82736d56347f526980679f6f608df62fa6e8d || 9286383e21f04b9584c1bc569a201731.838c2cb5ed0685264028e37df817e68ddfb673c032e1fff141ac84551b91849a || 9286383e21f04b9584c1bc569a201731.38afa1ae04437aa85b8322e089bdd91a33cb242de526ddafe282bd57488cedea || 9286383e21f04b9584c1bc569a201731.c003a6084305b8670efd01f1469391ad,  ';\n\n     c_sql_str := c_sql_str || ' NVL(SUM(9286383e21f04b9584c1bc569a201731.bb5d89d8e59b9d36d0b6b8786a5af29811e45c8edc5d50e80a4e7d352c158540 -  9286383e21f04b9584c1bc569a201731.e6d0283b52bb387faf1919b9feeead6c6427aec28745f4361c3038480671c519), 0), ';\n\n     c_sql_str := c_sql_str || ' NVL(SUM(9286383e21f04b9584c1bc569a201731.26578fa8975d84b5751305ea5a1bef002742f685419072427fdf6d978b822ac7), 0), ';\n\n     c_sql_str := c_sql_str || ' NVL (SUM (9286383e21f04b9584c1bc569a201731.26578fa8975d84b5751305ea5a1bef002742f685419072427fdf6d978b822ac7 - (9286383e21f04b9584c1bc569a201731.bb5d89d8e59b9d36d0b6b8786a5af29811e45c8edc5d50e80a4e7d352c158540 - 9286383e21f04b9584c1bc569a201731.e6d0283b52bb387faf1919b9feeead6c6427aec28745f4361c3038480671c519)),0), ';\n\n     c_sql_str := c_sql_str || ' 905ea85a54da8f0612eb6599dff7a9a5.81f16e4c9393148dc991cccd155f5e3f, 905ea85a54da8f0612eb6599dff7a9a5.c67cd1eafed9a912b9b48d7e6c4694d4, 905ea85a54da8f0612eb6599dff7a9a5.d98d3ca2a5822014db94b4455903ab3e, 905ea85a54da8f0612eb6599dff7a9a5.2e59c8c02a6a241d22d0536e2f80b067, min(9286383e21f04b9584c1bc569a201731.6c066d9e7788918ab90239e5915511ecf6283ea3dfab0ee7d1d005a13bf2d220),   ';\n     c_sql_str := c_sql_str || ' 905ea85a54da8f0612eb6599dff7a9a5.e51993c9a1f7d183e843324c1159ccbe98df5d6b623334f2e9631188cca4cfd6 ,9286383e21f04b9584c1bc569a201731.82a9d44f91613e758b9fe764517f8668, 67349a6782c4a19592e96391ff79fcbd.aac6cb839e7817eeb7ca3d9e5eb16353, 9286383e21f04b9584c1bc569a201731.d3ae9cefcafbc2af8c946c2625375283,  '; \n     c_sql_str := c_sql_str || ' (SELECT sum(miles) FROM de459e2fe7f96e4d958537b31b946b26.8b0b61d9d9c7dd18269353d87da93fcf mls  '; \n     c_sql_str := c_sql_str || ' WHERE orig_zip_cd = SUBSTR(905ea85a54da8f0612eb6599dff7a9a5.2e59c8c02a6a241d22d0536e2f80b067,1,5) AND dest_zip_cd = 0e2e1606f57e98f5afa29fd173454972.2e59c8c02a6a241d22d0536e2f80b067 ) as miles,  '; \n     c_sql_str := c_sql_str || ' MAX(9286383e21f04b9584c1bc569a201731.c5a1d4b02ca73d211b11bf19c654d4d2),   '; \n     c_sql_str := c_sql_str || ' fce896ca0fbbf5a5d330f2803036eb44.01730d3774f2352616a3b828e4b785de, fce896ca0fbbf5a5d330f2803036eb44.84e4ec1998c0771a71caf05aebd2e853, MAX(9286383e21f04b9584c1bc569a201731.aa99c76fe83c886352d001856cf1307a) crs_dck_div_nbr, MAX(9286383e21f04b9584c1bc569a201731.5998ca0af27e719792cebf9d87d9ba46),   '; \n     c_sql_str := c_sql_str || ' MAX(9286383e21f04b9584c1bc569a201731.6cd0ac8a1d2b1bccb8f8f25a5a79c22c), MAX(9286383e21f04b9584c1bc569a201731.cbd3b61ede15c185bf575a231e2ac748), MAX(9286383e21f04b9584c1bc569a201731.4820507f2c64ed8e8d8be9cd2dc01e11),  '; \n     c_sql_str := c_sql_str || ' MAX(9286383e21f04b9584c1bc569a201731.79a100995568675056eaeb96be54cce3) , MAX(9286383e21f04b9584c1bc569a201731.e540de2754fdc8b8ec15ca0899b6bf0c) ,    '; \n     c_sql_str := c_sql_str || ' MAX(9286383e21f04b9584c1bc569a201731.2512fbd263a80746ed614f59f7f28478), NVL (SUM (vndr_prod_prc_rcvd_extnd), 0) po_total_cost_amount_sum,   '; \n   c_sql_str           :=\n      c_sql_str || ' SUM(9286383e21f04b9584c1bc569a201731.e6d0283b52bb387faf1919b9feeead6cee48c641610c600e43684184d82f12d1 * 9286383e21f04b9584c1bc569a201731.e08d762984b4958fe98ced8ee3e72aba) cnfrmd_pua_ttl, SUM(9286383e21f04b9584c1bc569a201731.455615df0d347e9fb5cb6bcdd857433d636d30d2d57d9e5d1b2fe1a6be2c8991 * 9286383e21f04b9584c1bc569a201731.e08d762984b4958fe98ced8ee3e72aba) cnfrmd_ppaid_ttl, ';\n   c_sql_str := c_sql_str || ' SUM(9286383e21f04b9584c1bc569a201731.d6372871d1d97f37fc829d36410442f62d670aaf081fe10c509389e50de9059b * 9286383e21f04b9584c1bc569a201731.e08d762984b4958fe98ced8ee3e72aba) cnfrmd_frght_ttl, SUM(9286383e21f04b9584c1bc569a201731.2225373ab9784ecbaa11d8c0aaf61f4cbfc781c3515d9ff3c459d16d6b2102ba * 9286383e21f04b9584c1bc569a201731.e08d762984b4958fe98ced8ee3e72aba) cnfrmd_mrkt_frght_ttl, ';\n   c_sql_str := c_sql_str || ' SUM(9286383e21f04b9584c1bc569a201731.e6d0283b52bb387faf1919b9feeead6cee48c641610c600e43684184d82f12d1 * 9286383e21f04b9584c1bc569a201731.e7cabb8cf7b3db25086b2c8c7fe3a76e) rcvd_pua_ttl, SUM(9286383e21f04b9584c1bc569a201731.455615df0d347e9fb5cb6bcdd857433d636d30d2d57d9e5d1b2fe1a6be2c8991 * 9286383e21f04b9584c1bc569a201731.e7cabb8cf7b3db25086b2c8c7fe3a76e) rcvd_ppaid_ttl, ';\n   c_sql_str := c_sql_str || ' SUM(9286383e21f04b9584c1bc569a201731.d6372871d1d97f37fc829d36410442f62d670aaf081fe10c509389e50de9059b * 9286383e21f04b9584c1bc569a201731.e7cabb8cf7b3db25086b2c8c7fe3a76e) rcvd_frght_ttl, SUM(9286383e21f04b9584c1bc569a201731.2225373ab9784ecbaa11d8c0aaf61f4cbfc781c3515d9ff3c459d16d6b2102ba * 9286383e21f04b9584c1bc569a201731.e7cabb8cf7b3db25086b2c8c7fe3a76e) rcvd_mrkt_frght_ttl, ';\n   c_sql_str := c_sql_str || ' max(09b293b7a02919e49bef87f52ba83107.dd5ea5fed0e97549e153bceb36c005ec),max(9286383e21f04b9584c1bc569a201731.d210bffed96b60379254306c0f8a7a27cd88b470d60244e256018262738a5f62),max(9286383e21f04b9584c1bc569a201731.f5eda031da2d9f40dc165ab1f7b78293e7f1bb4487d12718c0cdcdefab6381f3),';\n   c_sql_str := c_sql_str || ' max(9286383e21f04b9584c1bc569a201731.9ceb20d64441d6fbed79bb63d21539a0),max(9286383e21f04b9584c1bc569a201731.fc40f497494e80070821a3a436f63a4a),max(9286383e21f04b9584c1bc569a201731.66bca687827a543dd6c1e4fe66d010aae32f6dd38f333cde68119d1f277367cd),max(9286383e21f04b9584c1bc569a201731.4a49b917d85aa14a777aa6a9c09203d9),';\n   c_sql_str := c_sql_str || ' max(9286383e21f04b9584c1bc569a201731.b609e6006e7535b4e68d800551381ebfe32f6dd38f333cde68119d1f277367cd),max(9286383e21f04b9584c1bc569a201731.02f5848f0cd542c0590981542206dc1865e8f9c199475981eaa9e37f068bc3c9),';\n   c_sql_str := c_sql_str || ' max(9286383e21f04b9584c1bc569a201731.cc18df9eb5601bac19be10b0fc20be6b),max(9286383e21f04b9584c1bc569a201731.53015867b0de1d59d6ddaa71bd5fbd70),max(9286383e21f04b9584c1bc569a201731.0c60fbe296408b40144a46233264971d),';\n   c_sql_str := c_sql_str || ' max(9286383e21f04b9584c1bc569a201731.cb51213cb1732522b178dbcfa8e65dcf), max(9286383e21f04b9584c1bc569a201731.d68eb8661501a0b8eeba8c776c6c6f8e),max(9286383e21f04b9584c1bc569a201731.3cb4ef1fb07eb1106ba7fadfbe4fc518e7f1bb4487d12718c0cdcdefab6381f3) ';\n     c_sql_str := c_sql_str || ' FROM  de459e2fe7f96e4d958537b31b946b26.c437d55d53d88d02ce92bdadaefd8483 po, de459e2fe7f96e4d958537b31b946b26.dec387908a0954ddc8689c4ad37c8a3c d,  ';\n     c_sql_str := c_sql_str || ' de459e2fe7f96e4d958537b31b946b26.ec7d47303d409ee31ce78effc6bcc2bd pfv, de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001 t, de459e2fe7f96e4d958537b31b946b26.12cc45d44e8802c236ba8d180b76d956 b, ';\n     c_sql_str := c_sql_str || ' de459e2fe7f96e4d958537b31b946b26.f6d0f84ad8a40b0dd7d8e9e21e79e6ea sfv, de459e2fe7f96e4d958537b31b946b26.48897903f4dd9dc6e7add38a894afe49 cov  ';\n     c_sql_str := c_sql_str || ' ,de459e2fe7f96e4d958537b31b946b26.ecb78135a9974a1132614a3689fb901f f    ';\n     c_sql_str := c_sql_str || ' WHERE 9286383e21f04b9584c1bc569a201731.75274b7e794ec4ac03e63646e000c70b > sysdate - ' || c_subtract_days;\n     c_sql_str := c_sql_str || ' AND 9286383e21f04b9584c1bc569a201731.839c4ffb4bfaae1bb58eab4dee67d96a = fce896ca0fbbf5a5d330f2803036eb44.839c4ffb4bfaae1bb58eab4dee67d96a  ';\n     c_sql_str := c_sql_str || ' AND 9286383e21f04b9584c1bc569a201731.6bd6b7c188fef616b113c81245338906 <> ''0''  ';\n     c_sql_str := c_sql_str || ' AND  9286383e21f04b9584c1bc569a201731.26ac88e7ae671a1b22c14c2fce77aa2d NOT IN (''SB'', ''SS'')  ';\n     c_sql_str := c_sql_str || ' AND 9286383e21f04b9584c1bc569a201731.75274b7e794ec4ac03e63646e000c70b = 1d731bbdc4e3fb69a854112d4982eb99.222ccb1d1746bcdb2365f29b3da0b613 ';\n     c_sql_str := c_sql_str || ' AND 67349a6782c4a19592e96391ff79fcbd.4b398d884e397727aeb50b1bf2299e607e8fe841f8abc0a126967273be28f1b7(+) = 9286383e21f04b9584c1bc569a201731.4b398d884e397727aeb50b1bf2299e607e8fe841f8abc0a126967273be28f1b7  ';\n     c_sql_str := c_sql_str || ' AND 67349a6782c4a19592e96391ff79fcbd.839c4ffb4bfaae1bb58eab4dee67d96a(+) = 9286383e21f04b9584c1bc569a201731.839c4ffb4bfaae1bb58eab4dee67d96a  ';\n     c_sql_str := c_sql_str || ' AND 6d9b37be5a083f8b78d676aba846c823.8ad407cb426778f64984851f4a2318d7(+) = 9286383e21f04b9584c1bc569a201731.8ad407cb426778f64984851f4a2318d7   ';\n     c_sql_str := c_sql_str || ' AND 6d9b37be5a083f8b78d676aba846c823.28a0a9fcbd547bacb53c3275ede3b77f(+) = 9286383e21f04b9584c1bc569a201731.28a0a9fcbd547bacb53c3275ede3b77f   ';\n     c_sql_str := c_sql_str || ' AND 6d9b37be5a083f8b78d676aba846c823.43fd01774ba4f11a8378fc9473b7c8fc(+) = 9286383e21f04b9584c1bc569a201731.43fd01774ba4f11a8378fc9473b7c8fc   ';\n     c_sql_str := c_sql_str || ' AND 9286383e21f04b9584c1bc569a201731.e51993c9a1f7d183e843324c1159ccbe7e8fe841f8abc0a126967273be28f1b7 = 905ea85a54da8f0612eb6599dff7a9a5.e51993c9a1f7d183e843324c1159ccbe7e8fe841f8abc0a126967273be28f1b7(+)  ';\n     c_sql_str := c_sql_str || ' AND 9286383e21f04b9584c1bc569a201731.839c4ffb4bfaae1bb58eab4dee67d96a = 905ea85a54da8f0612eb6599dff7a9a5.839c4ffb4bfaae1bb58eab4dee67d96a(+)  ';\n     c_sql_str := c_sql_str || ' AND 9286383e21f04b9584c1bc569a201731.6c066d9e7788918ab90239e5915511ecf6283ea3dfab0ee7d1d005a13bf2d220 = aeaad0a1b4f46a0780f8669dcffabbbd.4d732318d69998c6709a6e5b1b6b8d11(+)  ';\n     c_sql_str := c_sql_str || ' AND fce896ca0fbbf5a5d330f2803036eb44.4855453efe73ff0bd0f7583df58260dd = 0e2e1606f57e98f5afa29fd173454972.70d419a3899ed4379c224981d467662e (+)  '; \n\n    IF  vendor_i IS NULL THEN\n       c_sql_str := c_sql_str || ' AND 9286383e21f04b9584c1bc569a201731.6c066d9e7788918ab90239e5915511ecf6283ea3dfab0ee7d1d005a13bf2d220 <>  58070 ';\n    ELSIF  vendor_i = '59070' THEN\n       c_sql_str := c_sql_str || ' AND 9286383e21f04b9584c1bc569a201731.6c066d9e7788918ab90239e5915511ecf6283ea3dfab0ee7d1d005a13bf2d220 = 58070 ';\n    END IF;\n\n    c_sql_str := c_sql_str || ' GROUP BY  9286383e21f04b9584c1bc569a201731.6bd6b7c188fef616b113c81245338906, fce896ca0fbbf5a5d330f2803036eb44.4855453efe73ff0bd0f7583df58260dd, fce896ca0fbbf5a5d330f2803036eb44.245658138d22919d7bd7dff808e5af8e, 9286383e21f04b9584c1bc569a201731.839c4ffb4bfaae1bb58eab4dee67d96a, 9286383e21f04b9584c1bc569a201731.75274b7e794ec4ac03e63646e000c70b, ';\n    c_sql_str := c_sql_str || ' 67349a6782c4a19592e96391ff79fcbd.4b398d884e397727aeb50b1bf2299e6098df5d6b623334f2e9631188cca4cfd6, 9286383e21f04b9584c1bc569a201731.4b398d884e397727aeb50b1bf2299e607e8fe841f8abc0a126967273be28f1b7, ';\n    c_sql_str := c_sql_str || ' 9286383e21f04b9584c1bc569a201731.e51993c9a1f7d183e843324c1159ccbe7e8fe841f8abc0a126967273be28f1b7, 9286383e21f04b9584c1bc569a201731.1c74ebbf2dbba3a9b0e35068ec68f92a,  ';\n    c_sql_str := c_sql_str || ' 9286383e21f04b9584c1bc569a201731.c796867d18fa43f881aaad4cdd379e65e6e6300089dae5a98e31814d0406060f, ';\n    c_sql_str := c_sql_str || ' 1d731bbdc4e3fb69a854112d4982eb99.e1d446673288adb6d5f219d0aa82d37a, 1d731bbdc4e3fb69a854112d4982eb99.cb5e253886eb30a93e66cbf95203a754, 1d731bbdc4e3fb69a854112d4982eb99.ab30d6d679879cfacfe389b97d1d3f0e, ';\n    c_sql_str := c_sql_str || ' 9286383e21f04b9584c1bc569a201731.d07269fd715528545216b1ab9353756e,  '; \n    \n    c_sql_str := c_sql_str || ' 9286383e21f04b9584c1bc569a201731.5f8f629038ff1cc5d37bc5204f8431e833cb242de526ddafe282bd57488cedea, 9286383e21f04b9584c1bc569a201731.a2c4963356f688f26c092337d1a82736d56347f526980679f6f608df62fa6e8d, 9286383e21f04b9584c1bc569a201731.838c2cb5ed0685264028e37df817e68ddfb673c032e1fff141ac84551b91849a, 9286383e21f04b9584c1bc569a201731.38afa1ae04437aa85b8322e089bdd91a33cb242de526ddafe282bd57488cedea, 9286383e21f04b9584c1bc569a201731.c003a6084305b8670efd01f1469391ad,  ';\n    c_sql_str := c_sql_str || ' 905ea85a54da8f0612eb6599dff7a9a5.81f16e4c9393148dc991cccd155f5e3f, 905ea85a54da8f0612eb6599dff7a9a5.c67cd1eafed9a912b9b48d7e6c4694d4, 905ea85a54da8f0612eb6599dff7a9a5.d98d3ca2a5822014db94b4455903ab3e, 905ea85a54da8f0612eb6599dff7a9a5.2e59c8c02a6a241d22d0536e2f80b067,  ';\n    c_sql_str := c_sql_str || ' 905ea85a54da8f0612eb6599dff7a9a5.e51993c9a1f7d183e843324c1159ccbe98df5d6b623334f2e9631188cca4cfd6 ,9286383e21f04b9584c1bc569a201731.82a9d44f91613e758b9fe764517f8668, 67349a6782c4a19592e96391ff79fcbd.aac6cb839e7817eeb7ca3d9e5eb16353, 9286383e21f04b9584c1bc569a201731.d3ae9cefcafbc2af8c946c2625375283,    '; \n    c_sql_str := c_sql_str || ' 0e2e1606f57e98f5afa29fd173454972.2e59c8c02a6a241d22d0536e2f80b067, 0e2e1606f57e98f5afa29fd173454972.4a6babed112dd39c93bcbfb2a3246723, 0e2e1606f57e98f5afa29fd173454972.70d419a3899ed4379c224981d467662e, fce896ca0fbbf5a5d330f2803036eb44.01730d3774f2352616a3b828e4b785de, fce896ca0fbbf5a5d330f2803036eb44.84e4ec1998c0771a71caf05aebd2e853  '; \n    \n    \n    \n    \n    c_sql_str := c_sql_str || ' ORDER BY 9286383e21f04b9584c1bc569a201731.6bd6b7c188fef616b113c81245338906, 9286383e21f04b9584c1bc569a201731.75274b7e794ec4ac03e63646e000c70b ';\n\n   dbms_output.put_line(c_sql_str);\n\n    g_idx := 0;\n    g_ldr_tm := TO_NUMBER(TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS'));\n    OPEN c_cursor for c_sql_str;\n    LOOP\n        g_display := 'main loop,reads: ' || g_reads;\n        DBMS_APPLICATION_INFO.SET_MODULE( module_name => 'PO_ROLLING_12', action_name => g_display);\n        g_idx  := g_idx + 1;\n        FETCH c_cursor BULK COLLECT INTO nt_po LIMIT c_limit;\n        IF af9cca70994508f0dd5eb3b6f97100b8.26fd1c0cd65cf53eadf725ede4bbd5f1 > 0 THEN\n            FOR vix in 1 .. af9cca70994508f0dd5eb3b6f97100b8.26fd1c0cd65cf53eadf725ede4bbd5f1 LOOP\n                g_reads      := g_reads + 1;\n                g_in_idx  := vix;\n                sp_clear_work_fields;\n                g_po_nbr     := nt_po(vix).po_nbr;\n                g_div_nbr    := nt_po(vix).div_nbr;\n                g_brnch_cd   := nt_po(vix).brnch_cd;\n                g_ctms       := nt_po(vix).ctms;\n                g_po_rcvd_dt := nt_po(vix).po_rcvd_dt;\n                g_total_cases := nt_po(vix).rcvd_qty;\n                g_load_at_name := nt_po(vix).ship_from_vndr_nm;\n                g_lookup_key :=  g_po_nbr || TO_CHAR(g_div_nbr) || TO_CHAR(g_po_rcvd_dt, 'YYYYMMDD');\n    \n    \n    \n                BEGIN\n                    SELECT  de459e2fe7f96e4d958537b31b946b26.1a663eaf7ebda55b3a5b36843b82b02d.018003bed62c011192394ea18ff90ec5, de459e2fe7f96e4d958537b31b946b26.1a663eaf7ebda55b3a5b36843b82b02d.f94a37a592b3fa8a47144dd8dd293b48, de459e2fe7f96e4d958537b31b946b26.1a663eaf7ebda55b3a5b36843b82b02d.eaf808964ace2916e5a27385f6593861, de459e2fe7f96e4d958537b31b946b26.1a663eaf7ebda55b3a5b36843b82b02d.78b7a6f32e8f639b5e8b141275682554, de459e2fe7f96e4d958537b31b946b26.1a663eaf7ebda55b3a5b36843b82b02d.69e6c732b176d4f85098a10e33995abe, de459e2fe7f96e4d958537b31b946b26.1a663eaf7ebda55b3a5b36843b82b02d.c5a1d4b02ca73d211b11bf19c654d4d2,\n                            de459e2fe7f96e4d958537b31b946b26.1a663eaf7ebda55b3a5b36843b82b02d.afff78d34ccba4ab70745f1e81ac36c4, de459e2fe7f96e4d958537b31b946b26.1a663eaf7ebda55b3a5b36843b82b02d.70853fb21ea64fbc6146bb873eadc7e8929c30e5deb6241de50c5e66f8414d0b, de459e2fe7f96e4d958537b31b946b26.1a663eaf7ebda55b3a5b36843b82b02d.77c405ca6379d1a656c03ae7a00ad90c,\n                            de459e2fe7f96e4d958537b31b946b26.1a663eaf7ebda55b3a5b36843b82b02d.6cd02fb9007a1ff00a0fb2a635e7e769,  de459e2fe7f96e4d958537b31b946b26.1a663eaf7ebda55b3a5b36843b82b02d.63b5106460964e317b5d13751b47d4c9, de459e2fe7f96e4d958537b31b946b26.1a663eaf7ebda55b3a5b36843b82b02d.7fa87fa392ae3c8e1465ab29cdd097b4b7b0e0e381f225508ba1183cc085e11d,\n                            de459e2fe7f96e4d958537b31b946b26.1a663eaf7ebda55b3a5b36843b82b02d.0d69ec31a1f90cf75a5af53546daae19, de459e2fe7f96e4d958537b31b946b26.cf1831af559b970e8859c4be229c97e1.5938af20283ebdf83028907a807f67fd, shp_orgn_fclty_alias_id,\n                            de459e2fe7f96e4d958537b31b946b26.1a663eaf7ebda55b3a5b36843b82b02d.70853fb21ea64fbc6146bb873eadc7e8929c30e5deb6241de50c5e66f8414d0b, de459e2fe7f96e4d958537b31b946b26.ecb78135a9974a1132614a3689fb901f.c43508cf582e11dfdeaa088d1a4e3560, de459e2fe7f96e4d958537b31b946b26.ecb78135a9974a1132614a3689fb901f.c67cd1eafed9a912b9b48d7e6c4694d4, de459e2fe7f96e4d958537b31b946b26.ecb78135a9974a1132614a3689fb901f.d98d3ca2a5822014db94b4455903ab3e, de459e2fe7f96e4d958537b31b946b26.ecb78135a9974a1132614a3689fb901f.2e59c8c02a6a241d22d0536e2f80b067,\n                            de459e2fe7f96e4d958537b31b946b26.1a663eaf7ebda55b3a5b36843b82b02d.2bddf3997db171cef22d19b5610d359d8db8868d01e6fdaa39550988407bbb60, de459e2fe7f96e4d958537b31b946b26.1a663eaf7ebda55b3a5b36843b82b02d.382516b2599ba946950e9ecc41a1536b, de459e2fe7f96e4d958537b31b946b26.1a663eaf7ebda55b3a5b36843b82b02d.13b052001e2dd1f77f108dfef913a174, de459e2fe7f96e4d958537b31b946b26.1a663eaf7ebda55b3a5b36843b82b02d.ae48e5b77b11c316587b52aa91cf2450e32f6dd38f333cde68119d1f277367cd, \n                            de459e2fe7f96e4d958537b31b946b26.1a663eaf7ebda55b3a5b36843b82b02d.9d043b54a832b38e82b817108c3a1452, de459e2fe7f96e4d958537b31b946b26.1a663eaf7ebda55b3a5b36843b82b02d.abf1dca5f7111e56a3b93d0bac116e8b,  \n                            (select MAX(de459e2fe7f96e4d958537b31b946b26.ecb78135a9974a1132614a3689fb901f.70d419a3899ed4379c224981d467662e) from de459e2fe7f96e4d958537b31b946b26.ecb78135a9974a1132614a3689fb901f fp where de459e2fe7f96e4d958537b31b946b26.ecb78135a9974a1132614a3689fb901f.fclty_id = de459e2fe7f96e4d958537b31b946b26.ecb78135a9974a1132614a3689fb901f.fclty_id and de459e2fe7f96e4d958537b31b946b26.ecb78135a9974a1132614a3689fb901f.prmry_flg = 'Y')\n                            as primary_fclty_alias_id,  \n                            NVL(de459e2fe7f96e4d958537b31b946b26.1a663eaf7ebda55b3a5b36843b82b02d.0814335c6b9bd523faacabf91539a73a, 0), NVL(de459e2fe7f96e4d958537b31b946b26.1a663eaf7ebda55b3a5b36843b82b02d.e7cabb8cf7b3db25086b2c8c7fe3a76e, 0),NVL(de459e2fe7f96e4d958537b31b946b26.1a663eaf7ebda55b3a5b36843b82b02d.de945cabe50252fdfc02b4903c999126, 0)\n                         INTO g_shipment_nbr, g_tms_src, g_mot, g_eqpmt, g_srvc_lvl, g_cross_dock,\n                         g_voucher_date, g_po_orgn_fclty_alias_id, g_tips_commodity,\n                         g_srvc_cd, g_alt_hlng_typ, g_shp_dest_fclty_alias_id,\n                         g_carrier_cd, g_carrier_nm, g_shp_orgn_fclty_alias_id,\n                         g_load_at_id, g_load_at_name, g_load_at_city,\n                         g_load_at_state,g_load_at_zip,\n                         g_tms_prch_from_vndr_nm, g_po_rqstd_dt, g_po_appt_dt, g_po_plnd_dlvry_dt, \n                         g_po_plnd_pckp_dt, g_po_orig_due_dt, g_primary_fclty_alias_id,  \n                         g_po_weight, g_po_cases, g_po_cube\n                    FROM  de459e2fe7f96e4d958537b31b946b26.1a663eaf7ebda55b3a5b36843b82b02d s, de459e2fe7f96e4d958537b31b946b26.cf1831af559b970e8859c4be229c97e1 c, de459e2fe7f96e4d958537b31b946b26.ecb78135a9974a1132614a3689fb901f f \n                    WHERE de459e2fe7f96e4d958537b31b946b26.1a663eaf7ebda55b3a5b36843b82b02d.6bd6b7c188fef616b113c81245338906 = g_po_nbr\n                    AND de459e2fe7f96e4d958537b31b946b26.1a663eaf7ebda55b3a5b36843b82b02d.0728ad15bc8483fffbbaede7dcc008da = g_brnch_cd\n                    AND de459e2fe7f96e4d958537b31b946b26.1a663eaf7ebda55b3a5b36843b82b02d.75274b7e794ec4ac03e63646e000c70b = g_po_rcvd_dt\n                    AND NVL(de459e2fe7f96e4d958537b31b946b26.1a663eaf7ebda55b3a5b36843b82b02d.9f09c50bab237fe71292be5cdcc8f32e, 'Y') = 'Y'\n                    AND de459e2fe7f96e4d958537b31b946b26.1a663eaf7ebda55b3a5b36843b82b02d.a03548b72f7797fef50d4e50a487a3b8 = de459e2fe7f96e4d958537b31b946b26.cf1831af559b970e8859c4be229c97e1.a03548b72f7797fef50d4e50a487a3b8(+)\n                    AND de459e2fe7f96e4d958537b31b946b26.1a663eaf7ebda55b3a5b36843b82b02d.70853fb21ea64fbc6146bb873eadc7e8929c30e5deb6241de50c5e66f8414d0b = de459e2fe7f96e4d958537b31b946b26.ecb78135a9974a1132614a3689fb901f.70d419a3899ed4379c224981d467662e(+)\n                    AND rownum < 2;\n                    g_shipment_exists := TRUE;\n\n                EXCEPTION\n                    WHEN NO_DATA_FOUND THEN\n                       g_shipment_exists := FALSE;\n                END;\n\n                IF g_shipment_exists = FALSE THEN\n                     g_display := 'delivered,reads: ' || g_reads;\n                     DBMS_APPLICATION_INFO.SET_MODULE( module_name => 'PO_ROLLING_12', action_name => g_display);\n                     sp_delivered;\n                ELSE\n                     g_display := 'managed,reads: ' || g_reads;\n                     DBMS_APPLICATION_INFO.SET_MODULE( module_name => 'PO_ROLLING_12', action_name => g_display);\n                     sp_managed;\n                END IF;\n\n                sp_save_record;\n\n                IF 5c5abea24d58b746f94f4f48a9eb9247e32f6dd38f333cde68119d1f277367cd.c838adb0c77d39edf51006214ba6e643 >= c_limit THEN\n                     g_display := 'inserts,reads: ' || g_reads;\n                     DBMS_APPLICATION_INFO.SET_MODULE( module_name => 'PO_ROLLING_12', action_name => g_display);\n                     sp_insert_record;\n                END IF;\n            END LOOP;\n         END IF;  \n       \n       \n       \n\n         IF af9cca70994508f0dd5eb3b6f97100b8.c838adb0c77d39edf51006214ba6e643 < c_limit THEN\n            EXIT;\n         END IF;\n    END LOOP;\n    CLOSE c_cursor;\n\n    IF 5c5abea24d58b746f94f4f48a9eb9247e32f6dd38f333cde68119d1f277367cd.c838adb0c77d39edf51006214ba6e643 > 0 THEN\n         g_display := 'last inserts,reads: ' || g_reads;\n         DBMS_APPLICATION_INFO.SET_MODULE( module_name => 'PO_ROLLING_12', action_name => g_display);\n         sp_insert_record;\n    END IF;\n    dbms_output.put_line('reads   : ' || g_reads);\n    dbms_output.put_line('inserts : ' || g_writes);\n\n    DBMS_OUTPUT.PUT_LINE('END at ' || to_char(sysdate, 'yyyymmdd hh24:mi:ss'));\n    COMMIT;\n    DBMS_APPLICATION_INFO.SET_MODULE(null,null);\n    RETURN 0;\n EXCEPTION\n           WHEN OTHERS THEN\n                DBMS_APPLICATION_INFO.SET_MODULE(null,null);\n                v_sqlcode := SQLCODE;\n                v_message :=  ' fn_hybrid_po_extract sqlerror ' || v_sqlcode || ' ' || SUBSTR(SQLERRM, 1, 75);\n                dbms_output.put_line(v_message);\n                v_message :=  'Number Reads ' || g_reads;\n                dbms_output.put_line(v_message);\n                RETURN 1;\n  END fn_hybrid_po_extract;\n/",
            "upstream_dependencies": [],
            "downstream_dependencies": [],
            "dag_location": "null",
            "gantt_location": "null",
            "created_at": "null",
            "updated_at": "null"
        },
        {
            "name": "FN_SYN_CUST_PLUS_PRSPCT_LOAD",
            "encrypted_name": "93fe6b19a642a1a2313567b9dd990a4833e40dba523254790a9dbda5a6fe5783",
            "type": "function",
            "database": "null",
            "encrypted_database": "null",
            "schema": "XDMADM",
            "encrypted_schema": "0e03d5c46556a742ba46252698396ef2",
            "fully_qualified_name": "XDMADM.FN_SYN_CUST_PLUS_PRSPCT_LOAD",
            "encrypted_fqn": "0e03d5c46556a742ba46252698396ef2.93fe6b19a642a1a2313567b9dd990a4833e40dba523254790a9dbda5a6fe5783",
            "synonyms": [],
            "metadata_analysis": "CREATE OR REPLACE FUNCTION \"0e03d5c46556a742ba46252698396ef2\".\"93fe6b19a642a1a2313567b9dd990a4833e40dba523254790a9dbda5a6fe5783\" (\n   v_in_odate   IN VARCHAR2\n)\n   RETURN NUMBER\nIS\n   \n   \n   \n   CON_PROCESS_NAME CONSTANT VARCHAR2 (40)\n         := 'FN_SYN_CUST_PLUS_PRSPCT_LOAD' ;\n   \n   v_odate                 DATE;\n   v_cur_fisc_yr_mth       0e03d5c46556a742ba46252698396ef2.1609b28739e207519049a2cf090bfd19.2603c45be643e5cd8f9c6dad3bee6cb3%TYPE;\n   v_last_fisc_yr_mth      0e03d5c46556a742ba46252698396ef2.1609b28739e207519049a2cf090bfd19.2603c45be643e5cd8f9c6dad3bee6cb3%TYPE;\n   v_cur_fisc_mth_of_yr    0e03d5c46556a742ba46252698396ef2.1609b28739e207519049a2cf090bfd19.e1d446673288adb6d5f219d0aa82d37a%TYPE;\n   v_last_fisc_mth_of_yr   0e03d5c46556a742ba46252698396ef2.1609b28739e207519049a2cf090bfd19.e1d446673288adb6d5f219d0aa82d37a%TYPE;\n   v_fisc_yr               0e03d5c46556a742ba46252698396ef2.1609b28739e207519049a2cf090bfd19.ab30d6d679879cfacfe389b97d1d3f0e%TYPE;\n   v_cur_fisc_prd_nm       0e03d5c46556a742ba46252698396ef2.1609b28739e207519049a2cf090bfd19.c6e0ffd13b59a270d18bfba7afeed0e2%TYPE;\n   v_last_fisc_prd_nm      0e03d5c46556a742ba46252698396ef2.1609b28739e207519049a2cf090bfd19.c6e0ffd13b59a270d18bfba7afeed0e2%TYPE;\n   v_prd_strt_dt           DATE;\n   v_prd_end_dt            DATE;\n   v_syn_nm 42183b964ff47e407206508ef9606770.b6b353c534e61967560fe35bfd68bab2.5e4be82fa55134ee91432a9d827d6cfb%TYPE\n         := 'CUST_PLUS_PRSPCT_CORP' ;\n   v_tbl_to_load           42183b964ff47e407206508ef9606770.b6b353c534e61967560fe35bfd68bab2.80f6badb5be48efbfc5290fa64e4e111%TYPE;\n   v_tbl_owner             VARCHAR2 (40 BYTE) := 'XDMADM';\n   v_tbl_inactv            VARCHAR2 (40 BYTE);\n   v_tbl_actv              VARCHAR2 (40 BYTE);\n   v_tbl_nm                VARCHAR2 (40 BYTE);\n   v_sql_str               VARCHAR2 (5000) := ' ';\n   v_cnt                   NUMBER;\n   v_ret_val               NUMBER;\n   v_trunc_allow           BOOLEAN;\n   v_trunc_ret             NUMBER (3);\n   v_load_ret              NUMBER (3);\n   v_grs_sls_extnd         0e03d5c46556a742ba46252698396ef2.744733b0938dd8b442c799cb31a8176d.2ee1400a0150f0b220dd7bd6268d1e66%TYPE;\n   v_unfrm_qty_ship        0e03d5c46556a742ba46252698396ef2.744733b0938dd8b442c799cb31a8176d.ccf8d88f2d37f3171da2121ab22e9330%TYPE;\n   \n   v_prcs_nm               VARCHAR (100);\n   v_prcs_step             VARCHAR (200);\n   v_prcs_pram             VARCHAR (100);\n   v_out_msg               VARCHAR (200);\n   \n   \n   \n   ALL_EXCEPTIONS EXCEPTION;\n   e_truncate_table EXCEPTION;\nBEGIN\n   DBMS_OUTPUT.put_line ('Start Process ' || CON_PROCESS_NAME);\n   DBMS_OUTPUT.put_line (\n      'Start Time:' || TO_CHAR (SYSDATE, 'YYYY-MM-DD HH24:MI:SS')\n   );\n   EXECUTE IMMEDIATE 'alter session set nls_date_format = ''YYYYMMDD''';\n   v_odate := TO_DATE (v_in_odate, 'YYYYMMDD');\n   \n   SELECT   0e03d5c46556a742ba46252698396ef2.476a877ff313a9e06b3ba262c317b001.2603c45be643e5cd8f9c6dad3bee6cb3\n     INTO   v_cur_fisc_yr_mth\n     FROM   0e03d5c46556a742ba46252698396ef2.476a877ff313a9e06b3ba262c317b001 t\n    WHERE   0e03d5c46556a742ba46252698396ef2.476a877ff313a9e06b3ba262c317b001.222ccb1d1746bcdb2365f29b3da0b613 = v_odate;\n\n   DBMS_OUTPUT.put_line ('Current Period is ' || v_cur_fisc_yr_mth);\n\n   SELECT   MAX (0e03d5c46556a742ba46252698396ef2.476a877ff313a9e06b3ba262c317b001.2603c45be643e5cd8f9c6dad3bee6cb3)\n     INTO   v_last_fisc_yr_mth\n     FROM   0e03d5c46556a742ba46252698396ef2.476a877ff313a9e06b3ba262c317b001 a\n    WHERE   0e03d5c46556a742ba46252698396ef2.476a877ff313a9e06b3ba262c317b001.2603c45be643e5cd8f9c6dad3bee6cb3 < (SELECT   0e03d5c46556a742ba46252698396ef2.476a877ff313a9e06b3ba262c317b001.2603c45be643e5cd8f9c6dad3bee6cb3\n                               FROM   0e03d5c46556a742ba46252698396ef2.476a877ff313a9e06b3ba262c317b001 a\n                              WHERE   0e03d5c46556a742ba46252698396ef2.476a877ff313a9e06b3ba262c317b001.222ccb1d1746bcdb2365f29b3da0b613 = TRUNC (v_odate));\n\n   DBMS_OUTPUT.put_line ('Last Closed Period is ' || v_last_fisc_yr_mth);\n\n   SELECT   MIN (clndr_dt), MAX (clndr_dt)\n     INTO   v_prd_strt_dt, v_prd_end_dt\n     FROM   0e03d5c46556a742ba46252698396ef2.476a877ff313a9e06b3ba262c317b001\n    WHERE   fisc_yr_mth = v_last_fisc_yr_mth;\n\n   DBMS_OUTPUT.put_line ('Start Date of last period is ' || v_prd_strt_dt);\n   DBMS_OUTPUT.put_line ('End Date of last period is ' || v_prd_end_dt);\n\n   SELECT   tbl_nm\n     INTO   v_tbl_inactv\n     FROM   42183b964ff47e407206508ef9606770.56ac3befbcbada23fa9268d8fe6d5242\n    WHERE   synonym_nm = v_syn_nm AND actv_ind = 'N';\n\n   \n   SELECT   tbl_nm\n     INTO   v_tbl_actv\n     FROM   42183b964ff47e407206508ef9606770.56ac3befbcbada23fa9268d8fe6d5242\n    WHERE   synonym_nm = v_syn_nm AND actv_ind = 'Y';\n\n   \n   SELECT   table_name\n     INTO   v_tbl_nm\n     FROM   ALL_SYNONYMS\n    WHERE       owner = v_tbl_owner\n            AND table_owner = v_tbl_owner\n            AND synonym_name = v_syn_nm;\n\n   IF v_tbl_actv <> v_tbl_nm\n   THEN\n      DBMS_OUTPUT.put_line (\n         'The tables ALL_SYNONYMS and 9751bbbcfea690cc0be4d58830a6fe2e.56ac3befbcbada23fa9268d8fe6d5242 are not in synch'\n      );\n      RETURN 1;\n   END IF;\n\n   DBMS_OUTPUT.put_line (\n      'Table which needs to be loaded is ' || v_tbl_inactv\n   );\n   \n   \n   \n   DBMS_OUTPUT.put_line ('Truncating the table ' || v_tbl_inactv);\n   v_trunc_ret := 7540495dc7d95c8483c39c98db3db89c.72d996f41712e622935d17bc9cb23cfa.bf64c6f363cecdf8179ad64aad199c7e (v_out_msg, 'XDMADM', v_tbl_inactv);\n   \n   DBMS_OUTPUT.PUT_LINE (v_out_msg);\n\n   IF v_trunc_ret <> 0\n   THEN\n      DBMS_OUTPUT.PUT_LINE (\n         'Error in Truncating ' || v_tbl_inactv || ' table'\n      );\n      RAISE e_truncate_table;\n   END IF;\n\n   v_tbl_to_load := v_tbl_inactv;\n   DBMS_OUTPUT.put_line (\n      'Loading the table ' || v_tbl_to_load || ' started...' || SYSTIMESTAMP\n   );\n   v_load_ret := 0e03d5c46556a742ba46252698396ef2.24eb58bafbe385c02936b04ede7b1696217c80690c883eb1a2d192ffbb747dd4 (v_odate, v_tbl_to_load);\n\n   IF v_load_ret != 0\n   THEN\n      DBMS_OUTPUT.PUT_LINE ('Error loading ' || v_tbl_inactv || ' table');\n      RAISE ALL_EXCEPTIONS;\n   END IF;\n\n   \n   DBMS_OUTPUT.PUT_LINE ('Start table analyze... ' || SYSTIMESTAMP);\n   v_ret_val :=\n      8e64339f96bb08058f5d52f1c04f954a.17fcfcb378ff5051796afa7f02d0a322.9058a38aed65e271486900da66f7adf0 (v_out_msg, 'XDMADM', v_tbl_to_load);\n\n   IF v_ret_val != 0\n   THEN\n      DBMS_OUTPUT.PUT_LINE (\n         'Error in analyzing ' || v_tbl_to_load || ' table'\n      );\n      RAISE ALL_EXCEPTIONS;\n   END IF;\n\n   DBMS_OUTPUT.PUT_LINE (\n      'Table ' || v_tbl_to_load || ' analyzed OK...' || SYSTIMESTAMP\n   );\n   Return 0;\n   EXCEPTION\n   WHEN OTHERS\n   THEN\n      \n      DBMS_OUTPUT.put_line (SQLCODE || ': ' || SQLERRM);\n      RETURN 1;\nEND FN_SYN_CUST_PLUS_PRSPCT_LOAD;\n/",
            "upstream_dependencies": [],
            "downstream_dependencies": [],
            "dag_location": "null",
            "gantt_location": "null",
            "created_at": "null",
            "updated_at": "null"
        },
        {
            "name": "FN_CKBK_RSN_EXCLD_LOAD",
            "encrypted_name": "9927e69aa4804c9688b193a44935e59844579ad22a1d01477a4cd7ddf5ec4148",
            "type": "function",
            "database": "null",
            "encrypted_database": "null",
            "schema": "XDMADM",
            "encrypted_schema": "0e03d5c46556a742ba46252698396ef2",
            "fully_qualified_name": "XDMADM.FN_CKBK_RSN_EXCLD_LOAD",
            "encrypted_fqn": "0e03d5c46556a742ba46252698396ef2.9927e69aa4804c9688b193a44935e59844579ad22a1d01477a4cd7ddf5ec4148",
            "synonyms": [],
            "metadata_analysis": "CREATE OR REPLACE FUNCTION \"0e03d5c46556a742ba46252698396ef2\".\"9927e69aa4804c9688b193a44935e59844579ad22a1d01477a4cd7ddf5ec4148\" (p_odate IN DATE)\n   RETURN NUMBER AS\n   \n   c_success            CONSTANT NUMBER := 0;\n   c_error              CONSTANT NUMBER := 1;\n   c_schema             CONSTANT VARCHAR2(30) := 'XDMADM';\n   c_aggr_tbl_syn_nm    CONSTANT VARCHAR2(30) := 'CKBK_RSN_EXCLD';\n   c_aggr_load_syn_nm   CONSTANT VARCHAR2(30) := 'CKBK_RSN_EXCLD_LOAD';\n   l_return_code        NUMBER;\n   l_out_msg            VARCHAR2(256);\n\n   l_aggr_tbl_nm        VARCHAR2(30);\n   l_load_tbl_nm        VARCHAR2(30);\nBEGIN\n   \n   IF (p_odate IS NULL) THEN\n      DBMS_OUTPUT.put_line('Error: Invalid Parameters: Date is required');\n      RETURN c_error;\n   END IF;\n\n   \n   EXECUTE IMMEDIATE 'SELECT table_name FROM user_synonyms WHERE synonym_name = ''' || c_aggr_tbl_syn_nm || ''''\n      INTO l_aggr_tbl_nm;\n\n   EXECUTE IMMEDIATE 'SELECT table_name FROM user_synonyms WHERE synonym_name = ''' || c_aggr_load_syn_nm || ''''\n      INTO l_load_tbl_nm;\n\n   DBMS_OUTPUT.put_line('Aggr Table: ' || l_aggr_tbl_nm);\n   DBMS_OUTPUT.put_line('Load Table: ' || l_load_tbl_nm);\n\n   \n   l_return_code   := 8e64339f96bb08058f5d52f1c04f954a.8ffe4678890c39c7d4ed38c2ed759e24.e4b5db2b3f9b19accbb8cddbfcd05bac(l_out_msg, c_schema, l_load_tbl_nm);\n   DBMS_OUTPUT.put_line('Truncate Load Table Return: ' || l_return_code || ' - ' || l_out_msg);\n\n   IF (l_return_code <> 0) THEN\n      DBMS_OUTPUT.put_line('Error: Failed to truncate table');\n      RETURN c_error;\n   END IF;\n\n   INSERT \n         INTO de459e2fe7f96e4d958537b31b946b26.969c164d2bcd9fba70276f3ebcd57f1209407c8b2e5a4583e4773894e4cae814\n      (SELECT DISTINCT de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.222ccb1d1746bcdb2365f29b3da0b613 prcs_dt,\n                       aaaa197c8a04b78be299c4e8679a5a84.839c4ffb4bfaae1bb58eab4dee67d96a,\n                       aaaa197c8a04b78be299c4e8679a5a84.852fa1e9f02f1ca2c75837f7146b2381,\n                       aaaa197c8a04b78be299c4e8679a5a84.2d45d761eb8d137835bca7a23010fab4,\n                       'X' excld_flg,\n                       TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS') ldr_tm\n         FROM de459e2fe7f96e4d958537b31b946b26.05819b151f62d52f080282063662102c p, de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001 t1, de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001 t2\n        WHERE de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.222ccb1d1746bcdb2365f29b3da0b613 = aaaa197c8a04b78be299c4e8679a5a84.f0a450bba812502e8b272dbc946f2638\n          AND de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.222ccb1d1746bcdb2365f29b3da0b613 BETWEEN aaaa197c8a04b78be299c4e8679a5a84.f0a450bba812502e8b272dbc946f2638 - de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.7c53ae8ca5b55e75e8a2957615ed09bb - 6 AND aaaa197c8a04b78be299c4e8679a5a84.f0a450bba812502e8b272dbc946f2638 - de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.7c53ae8ca5b55e75e8a2957615ed09bb + 7);\n\n   DBMS_OUTPUT.put_line('Inserted ' || sql%ROWCOUNT || ' rows');\n\n   COMMIT;\n\n   \n\n   l_return_code   := de459e2fe7f96e4d958537b31b946b26.9b3711c37bca8fd1d7c76527508615f9(c_schema, l_load_tbl_nm);\n   DBMS_OUTPUT.put_line('Analyze Return: ' || l_return_code);\n\n   IF (l_return_code <> 0) THEN\n      DBMS_OUTPUT.put_line('Error: Failed to analyze table');\n      RETURN c_error;\n   END IF;\n\n   \n   l_return_code   := de459e2fe7f96e4d958537b31b946b26.f21751d25bb3675b2a3778f4f03c7da6(c_aggr_tbl_syn_nm, c_schema, l_load_tbl_nm);\n   DBMS_OUTPUT.put_line(\n      'Create synonym ' || c_aggr_tbl_syn_nm || ' for ' || c_schema || '.' || l_load_tbl_nm || ': ' || l_return_code);\n\n   IF (l_return_code <> 0) THEN\n      DBMS_OUTPUT.put_line('Error: Failed to create synonym for aggregate table');\n      RETURN c_error;\n   END IF;\n\n   l_return_code   := de459e2fe7f96e4d958537b31b946b26.f21751d25bb3675b2a3778f4f03c7da6(c_aggr_load_syn_nm, c_schema, l_aggr_tbl_nm);\n   DBMS_OUTPUT.put_line(\n      'Create synonym ' || c_aggr_load_syn_nm || ' for ' || c_schema || '.' || l_aggr_tbl_nm || ': ' || l_return_code);\n\n   IF (l_return_code <> 0) THEN\n      DBMS_OUTPUT.put_line('Error: Failed to create synonym for aggregate table');\n      RETURN c_error;\n   END IF;\n\n   \n   l_return_code   := 8e64339f96bb08058f5d52f1c04f954a.8ffe4678890c39c7d4ed38c2ed759e24.e4b5db2b3f9b19accbb8cddbfcd05bac(l_out_msg, c_schema, l_aggr_tbl_nm);\n   DBMS_OUTPUT.put_line('Truncate Prev Aggr Table Return: ' || l_return_code || ' - ' || l_out_msg);\n\n   IF (l_return_code <> 0) THEN\n      DBMS_OUTPUT.put_line('Error: Failed to truncate table');\n      RETURN c_error;\n   END IF;\n\n   COMMIT;\n\n   RETURN c_success;\nEXCEPTION\n   WHEN OTHERS THEN\n      DBMS_OUTPUT.put_line('Unexepected error');\n      DBMS_OUTPUT.put_line(SQLCODE || ': ' || SQLERRM);\n      RETURN c_error;\nEND fn_ckbk_rsn_excld_load;\n/",
            "upstream_dependencies": [],
            "downstream_dependencies": [],
            "dag_location": "null",
            "gantt_location": "null",
            "created_at": "null",
            "updated_at": "null"
        },
        {
            "name": "FN_SLS_ORG_XFER_VPD",
            "encrypted_name": "f13d148c71388a902a7d8c2025fa3f8751f0cb5b5cdaeb5f21683018e0da7459",
            "type": "function",
            "database": "null",
            "encrypted_database": "null",
            "schema": "XDMADM",
            "encrypted_schema": "0e03d5c46556a742ba46252698396ef2",
            "fully_qualified_name": "XDMADM.FN_SLS_ORG_XFER_VPD",
            "encrypted_fqn": "0e03d5c46556a742ba46252698396ef2.f13d148c71388a902a7d8c2025fa3f8751f0cb5b5cdaeb5f21683018e0da7459",
            "synonyms": [],
            "metadata_analysis": "CREATE OR REPLACE FUNCTION \"0e03d5c46556a742ba46252698396ef2\".\"f13d148c71388a902a7d8c2025fa3f8751f0cb5b5cdaeb5f21683018e0da7459\" (p_schema       IN VARCHAR2,\n                                              p_objname      IN VARCHAR2)\n   RETURN VARCHAR2 AS\n   \n   c_start                CONSTANT NUMBER := DBMS_UTILITY.get_time;\n   c_fn_nm                CONSTANT VARCHAR2(30) := 'FN_SLS_ORG_XFER_VPD';\n   l_security_predicate   VARCHAR2(4000) DEFAULT NULL;\n   l_cur_sql              VARCHAR2(4000) := SYS_CONTEXT('USERENV', 'CURRENT_SQL');\n   l_sbjct_area VARCHAR2(100)\n         := SYS_CONTEXT(9751bbbcfea690cc0be4d58830a6fe2e.9bfb5eb7793dc8fa6800d5a61e5e3e4e1e2f6ec194927f064ce6cb31fba71a32.f4a54ebc6f2c591ed4266aafe66971af, 9751bbbcfea690cc0be4d58830a6fe2e.9bfb5eb7793dc8fa6800d5a61e5e3e4e1e2f6ec194927f064ce6cb31fba71a32.3b1288ed835b1b524e9500bb13544956e6e6300089dae5a98e31814d0406060f);\n   l_vpd_exempt VARCHAR2(1)\n         := SYS_CONTEXT(9751bbbcfea690cc0be4d58830a6fe2e.9bfb5eb7793dc8fa6800d5a61e5e3e4e1e2f6ec194927f064ce6cb31fba71a32.f4a54ebc6f2c591ed4266aafe66971af, 9751bbbcfea690cc0be4d58830a6fe2e.9bfb5eb7793dc8fa6800d5a61e5e3e4e1e2f6ec194927f064ce6cb31fba71a32.0eaf613ab52a53601d1496b5650de81e);\nBEGIN\n   \n   IF l_sbjct_area IS NULL THEN\n      l_security_predicate   := '1=2';\n      9751bbbcfea690cc0be4d58830a6fe2e.d4abe88ed2062b430c927bc84d61faf1f9a7aadf5998d448c2e2d1b0b47a3056.7d64937276682b23a0e16e5c61dad7aa('NO SA', c_fn_nm, USER, p_schema, p_objname, l_sbjct_area, l_vpd_exempt, NULL,\n      l_cur_sql, l_security_predicate, (DBMS_UTILITY.get_time - c_start) / 100);\n\n      RETURN l_security_predicate;\n   END IF;\n\n   \n   \n   IF l_vpd_exempt = 'Y' THEN\n      l_security_predicate   := '1=1';\n      9751bbbcfea690cc0be4d58830a6fe2e.d4abe88ed2062b430c927bc84d61faf1f9a7aadf5998d448c2e2d1b0b47a3056.7d64937276682b23a0e16e5c61dad7aa('EXEMPT', c_fn_nm, USER, p_schema, p_objname, l_sbjct_area, l_vpd_exempt,\n      NULL, l_cur_sql, l_security_predicate, (DBMS_UTILITY.get_time - c_start) / 100);\n\n      RETURN l_security_predicate;\n   END IF;\n\n   l_security_predicate   := 'XFER_FROM_DT IS NULL';\n   9751bbbcfea690cc0be4d58830a6fe2e.d4abe88ed2062b430c927bc84d61faf1f9a7aadf5998d448c2e2d1b0b47a3056.7d64937276682b23a0e16e5c61dad7aa('ALL DIVS', c_fn_nm, USER, p_schema, p_objname, l_sbjct_area, l_vpd_exempt, NULL,\n   l_cur_sql, l_security_predicate, (DBMS_UTILITY.get_time - c_start) / 100);\n\n   RETURN l_security_predicate;\nEXCEPTION\n   WHEN OTHERS THEN\n      l_security_predicate   := '1=3';\n      9751bbbcfea690cc0be4d58830a6fe2e.d4abe88ed2062b430c927bc84d61faf1f9a7aadf5998d448c2e2d1b0b47a3056.7d64937276682b23a0e16e5c61dad7aa(SQLCODE || '-' || SQLERRM, c_fn_nm, USER, p_schema, p_objname, l_sbjct_area,\n      l_vpd_exempt, NULL, l_cur_sql, l_security_predicate, (DBMS_UTILITY.get_time - c_start) / 100);\n\n      RETURN l_security_predicate;\nEND fn_sls_org_xfer_vpd;\n/",
            "upstream_dependencies": [],
            "downstream_dependencies": [],
            "dag_location": "null",
            "gantt_location": "null",
            "created_at": "null",
            "updated_at": "null"
        },
        {
            "name": "FN_DIV_COMPRESS",
            "encrypted_name": "cf04c524bd7196254bcc9e105a462b98",
            "type": "function",
            "database": "null",
            "encrypted_database": "null",
            "schema": "XDMADM",
            "encrypted_schema": "0e03d5c46556a742ba46252698396ef2",
            "fully_qualified_name": "XDMADM.FN_DIV_COMPRESS",
            "encrypted_fqn": "0e03d5c46556a742ba46252698396ef2.cf04c524bd7196254bcc9e105a462b98",
            "synonyms": [],
            "metadata_analysis": "CREATE OR REPLACE FUNCTION \"0e03d5c46556a742ba46252698396ef2\".\"cf04c524bd7196254bcc9e105a462b98\"\n(\n    p_in_odate                IN VARCHAR2,\n    p_force_run               IN VARCHAR2,\n    p_compress_end_day_of_wk  IN NUMBER,\n    p_compress_end_tm         IN VARCHAR2,\n    p_compress_job_no         IN NUMBER,\n    p_end_dt                  IN VARCHAR2\n)\n   RETURN NUMBER IS\n\n \n\n  \n\n\n\n    v_const         NUMBER := 2 ;\n    v_count         NUMBER ;\n    v_cur_count     NUMBER ;\n    v_end_dt        DATE := to_date(p_end_dt,'YYYYMMDD');\n\n    v_odate         DATE := to_date(p_in_odate,'YYYYMMDD');\n    v_prcs_stp      VARCHAR2(2000);\n    v_ldr_tm        NUMBER(20);\n\n\n    l_start         NUMBER;\n    l_end           NUMBER;\n    v_schema        VARCHAR2(40) :='XDMADM'  ;\n    v_day_of_wk     NUMBER;\n\n    v_compress_end_day_of_wk NUMBER:=p_compress_end_day_of_wk;\n\n    v_tbl            VARCHAR2(20);\n    v_crnt_tm        VARCHAR2(40);\n\n    v_chk_run_tm         NUMBER;\n    v_chk_end_dt         NUMBER;\n    v_force_run          VARCHAR2(2):=p_force_run;\n    v_skip_compr_intvl   NUMBER;\n    v_skip_compr_end_dt  DATE;\n    max_compress_dt_tm   NUMBER;\n    v_compress_end_tm    VARCHAR2(40) :=p_compress_end_tm;\n    v_compress_job_no    NUMBER :=p_compress_job_no;\n    no_of_div_compressed VARCHAR2(5000);\n\n    cursor c1 is   select div_nbr from de459e2fe7f96e4d958537b31b946b26.3c7f802edb5e7e3ec98c775f20e94d45\n       where nvl(compress_dt_tm, 20120101120000)  <= (select max(compress_dt_tm) from div_compress)\n       and compress_job_no = v_compress_job_no\n       order by compress_dt_tm;\n\nPROCEDURE chk_run_tm\nIS\n BEGIN\n\n    DBMS_OUTPUT.PUT_LINE ('**************************************');\n    select to_char(sysdate,'d') into v_day_of_wk from dual;\n    DBMS_OUTPUT.PUT_LINE('Day of Week = ' || v_day_of_wk);\n\n    select to_char(sysdate,'HH24MISS') into v_crnt_tm from dual;\n    DBMS_OUTPUT.PUT_LINE('Current Time (v_crnt_tm)= ' || v_crnt_tm);\n    DBMS_OUTPUT.PUT_LINE ('**************************************');\n\n   \n   \n\n     if ( (v_crnt_tm >= v_compress_end_tm) and (v_day_of_wk = v_compress_end_day_of_wk ))\n     then\n        v_chk_run_tm:=1;\n         DBMS_OUTPUT.put_line (' ***** v_chk_run_tm ***** : '||v_chk_run_tm);\n         DBMS_OUTPUT.PUT_LINE ('**************************************');\n         DBMS_OUTPUT.put_line ('*** Outside of run hours ***.');\n         DBMS_OUTPUT.PUT_LINE ('**************************************');\n         DBMS_OUTPUT.put_line ('*** Exiting Program ***.');\n\n     else\n         v_chk_run_tm:=0;\n         DBMS_OUTPUT.put_line (' ***** v_chk_run_tm ***** : '||v_chk_run_tm);\n\n\n     end if ;\n\n\n EXCEPTION\n   WHEN OTHERS THEN\n          DBMS_OUTPUT.PUT_LINE ('** ERROR in chk_run_tm. ' || SQLCODE || ' ' || SQLERRM);\n     RAISE;\n END chk_run_tm;\n\n\n\nPROCEDURE chk_end_dt\nIS\n\n     BEGIN\n\n            SELECT param_value_nbr\n              INTO v_skip_compr_intvl\n              FROM de459e2fe7f96e4d958537b31b946b26.de40ae7be8b2eb3858d46af8d107f3db\n             WHERE app_name = 'COMPRESSION'\n               AND param_type = 'COMPR_INTVL'\n               AND param_code = 'SKIP_SLS_COMPR_INTVL';\n\n             dbms_output.put_line('SKIP_SLS_COMPR_INTVL from param value is: ' || v_skip_compr_intvl);\n\n\n          select (sysdate - v_skip_compr_intvl) into v_skip_compr_end_dt from dual;\n\n             if (v_end_dt > v_skip_compr_end_dt ) then\n              v_chk_end_dt := 1;\n                     DBMS_OUTPUT.PUT_LINE ('******************************************************************************************');\n                     DBMS_OUTPUT.PUT_LINE ('SKIP_SLS_COMPR_INTVL from param_value tells how many days back from sysdate to SKIP compression');\n                     DBMS_OUTPUT.PUT_LINE ('v_end_dt should be less than that date determined by SKIP_SLS_COMPR_INTVL');\n                     DBMS_OUTPUT.PUT_LINE ('******************************************************************************************');\n             else\n              v_chk_end_dt := 0;\n             end if;\n\n\n\n             EXCEPTION\n                  WHEN NO_DATA_FOUND THEN\n                      DBMS_OUTPUT.PUT_LINE ('** ERROR in chk_end_dt. No Data in PARAM_VALUE for SKIP_SLS_COMPR_INTVL' );\n                      DBMS_OUTPUT.PUT_LINE ('**'||SQLCODE||' - '|| SQLERRM);\n                      RAISE;\n                  WHEN OTHERS THEN\n                      DBMS_OUTPUT.PUT_LINE('** ERROR in chk_end_dt: '||SQLCODE||' - '|| SQLERRM);\n                      RAISE;\n\n\n\n END chk_end_dt;\n\n \n \n  \n\nPROCEDURE insert_missing_divs\nIS\n\n     BEGIN\n\n      INSERT INTO de459e2fe7f96e4d958537b31b946b26.3c7f802edb5e7e3ec98c775f20e94d45(div_nbr, compress_job_no)\n       SELECT de459e2fe7f96e4d958537b31b946b26.dec387908a0954ddc8689c4ad37c8a3c.839c4ffb4bfaae1bb58eab4dee67d96a, 1\n         FROM de459e2fe7f96e4d958537b31b946b26.dec387908a0954ddc8689c4ad37c8a3c src\n        WHERE   NOT EXISTS\n               (SELECT   1\n                        FROM  de459e2fe7f96e4d958537b31b946b26.3c7f802edb5e7e3ec98c775f20e94d45 tgt\n                       WHERE  de459e2fe7f96e4d958537b31b946b26.3c7f802edb5e7e3ec98c775f20e94d45.839c4ffb4bfaae1bb58eab4dee67d96a = de459e2fe7f96e4d958537b31b946b26.dec387908a0954ddc8689c4ad37c8a3c.839c4ffb4bfaae1bb58eab4dee67d96a)\n          AND  de459e2fe7f96e4d958537b31b946b26.dec387908a0954ddc8689c4ad37c8a3c.2288db9f38dddf3eff8bd5d60e433c05>0;\n\n          dbms_output.put_line( sql%rowcount || ' Rows Inserted in de459e2fe7f96e4d958537b31b946b26.3c7f802edb5e7e3ec98c775f20e94d45...' );\n\n           COMMIT;\n             EXCEPTION\n                  WHEN OTHERS THEN\n                      DBMS_OUTPUT.PUT_LINE('** ERROR in insert_missing_divs: '||SQLCODE||' - '|| SQLERRM);\n                      RAISE;\n\n\n\n END insert_missing_divs;\n\n\n\n  \n  \n  BEGIN\n       v_prcs_stp := 'Process starts ';\n       l_start := DBMS_UTILITY.get_time;\n\n        DBMS_OUTPUT.PUT_LINE('TIME ' || to_char(sysdate, 'yyyymmdd hh24:mi:ss'));\n\n\n\n\n\n\n  \n   v_prcs_stp := 'Validate parameters';\n\n        if ((v_force_run is null) or (v_force_run not in ('Y', 'N'))) then\n\n        DBMS_OUTPUT.PUT_LINE('*** ERROR FORCE_RUN should be Y or N. Manual run should be Y. Scheduled run thru ControlM should be N');\n        return -50;\n        end if;\n\n\n\n        if ((p_compress_end_day_of_wk is null ) or (p_compress_end_tm is null) ) then\n        DBMS_OUTPUT.PUT_LINE('*** ERROR p_compress_end_day_of_wk AND p_compress_end_tm cannot be null..');\n        return -51;\n        end if;\n\n\n\n  \n\n      if (v_compress_job_no = 1) then\n      DBMS_OUTPUT.PUT_LINE ('RUNNING insert_missing_divs');\n         insert_missing_divs;\n\n      end if;\n\n  \n  v_prcs_stp := 'Validate table not empty';\n\n    select count(*) into v_count from de459e2fe7f96e4d958537b31b946b26.3c7f802edb5e7e3ec98c775f20e94d45;\n       if  v_count = 0 then\n         DBMS_OUTPUT.PUT_LINE ('de459e2fe7f96e4d958537b31b946b26.3c7f802edb5e7e3ec98c775f20e94d45 is empty');\n          return -41;\n        end if;\n\n\n\n  \n\n     if ((v_force_run = 'N') and  (v_end_dt is null)) then  \n            SELECT  MIN (clndr_dt)\n            INTO v_end_dt\n            FROM   de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001\n             WHERE   fisc_yr IN\n                   (SELECT   fisc_yr - v_const\n                           FROM   de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001\n                          WHERE   clndr_dt = (SELECT   clndr_dt_wkago\n                                                FROM   de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001\n                                               WHERE   clndr_dt = v_odate));\n\n         DBMS_OUTPUT.PUT_LINE (' No END DATE was passed. v_end_dt : ' || v_end_dt );\n\n     elsif ((v_force_run = 'Y') and  (v_end_dt is null))   \n     then\n          DBMS_OUTPUT.PUT_LINE (' Run Out Of Schedule BUT no END DATE was passed.' );\n          DBMS_OUTPUT.PUT_LINE (' End date will be determined based on value in PARAM_VALUE where app_name = COMPRESSION and param_type = COMPR_INTVL and param_code = SLS_COMPR_INTVL');\n     elsif ((v_force_run = 'Y') and  (v_end_dt is not null))   \n     then\n        chk_end_dt ;\n        if (v_chk_end_dt =0) then\n        DBMS_OUTPUT.PUT_LINE (' v_force_run = Y. END DATE was passed. v_end_dt : ' || v_end_dt);\n        else\n        return -52;\n        end if;\n     else \n        DBMS_OUTPUT.PUT_LINE (' END DATE was passed. v_end_dt : ' || v_end_dt);\n     end if;\n\n \n\n  BEGIN\n\n   no_of_div_compressed:='';\n    select max(compress_dt_tm)  into max_compress_dt_tm from div_compress;\n     DBMS_OUTPUT.PUT_LINE('Max compress_dt_tm in table is ' || max_compress_dt_tm);\n\n\n\n   \n  DBMS_OUTPUT.PUT_LINE ('RUNNING chk_run_tm');\n   chk_run_tm;\n\n\n\n\n\n       if v_chk_run_tm = 0 then\n\n        select max(compress_dt_tm)  into max_compress_dt_tm from div_compress;\n        DBMS_OUTPUT.PUT_LINE('Max compress_dt_tm in table is ' || max_compress_dt_tm);\n\n         FOR i IN c1\n         LOOP\n          DBMS_OUTPUT.PUT_LINE ('**************************************');\n          DBMS_OUTPUT.PUT_LINE ('Compressing for division: ' ||bf9c1b844e7c2b1522e9db567a52233f.839c4ffb4bfaae1bb58eab4dee67d96a);\n          DBMS_OUTPUT.PUT_LINE ('**************************************');\n\n          v_tbl:='SALES_'||bf9c1b844e7c2b1522e9db567a52233f.839c4ffb4bfaae1bb58eab4dee67d96a;\n\n          \n          DBMS_OUTPUT.PUT_LINE('TIME ' || to_char(sysdate, 'yyyymmdd hh24:mi:ss'));\n\n          0e03d5c46556a742ba46252698396ef2.134eb71cb7148ca0182552900242c11fb470933ef16165fc4133b8d9d96ddce9(v_schema,v_tbl,v_end_dt);\n\n          DBMS_OUTPUT.PUT_LINE ('Completed Compressing for: ' ||v_tbl );\n\n          no_of_div_compressed:=no_of_div_compressed||'   '||bf9c1b844e7c2b1522e9db567a52233f.839c4ffb4bfaae1bb58eab4dee67d96a;\n\n          \n          DBMS_OUTPUT.PUT_LINE ('Updating table.....: ');\n\n          update de459e2fe7f96e4d958537b31b946b26.3c7f802edb5e7e3ec98c775f20e94d45 set\n          compress_dt_tm = to_number(to_char(sysdate, 'YYYYMMDDHH24MISS')),\n          compress_dt    = trunc(sysdate)\n          where div_nbr = bf9c1b844e7c2b1522e9db567a52233f.839c4ffb4bfaae1bb58eab4dee67d96a;\n\n           COMMIT;\n          DBMS_OUTPUT.PUT_LINE('TIME ' || to_char(sysdate, 'yyyymmdd hh24:mi:ss'));\n           chk_run_tm;\n           \n           if v_chk_run_tm = 1 then\n\n            DBMS_OUTPUT.PUT_LINE ( round( (l_end - l_start)/100, 2 ) ||' seconds...' );\n            DBMS_OUTPUT.PUT_LINE ('Divisions Compressed :-'||no_of_div_compressed);\n\n             return 0;\n\n           end if;\n\n          END LOOP;\n\n          else     \n            return 0;\n\n         end if;\n\n      l_end := DBMS_UTILITY.get_time;\n\n\n      DBMS_OUTPUT.PUT_LINE ( round( (l_end - l_start)/100, 2 ) ||' seconds...' );\n      DBMS_OUTPUT.PUT_LINE ('Divisions Compressed :-'||no_of_div_compressed);\n\n       RETURN 0;\n\n\n    exception\n      WHEN OTHERS\n      THEN\n        DBMS_OUTPUT.PUT_LINE('Error in v_prcs_stp:'||v_prcs_stp || SQLCODE || SQLERRM );\n\n\n\n         RETURN 701;\n    END ;\n\n    \n   \n   \n EXCEPTION\n      WHEN OTHERS\n      THEN\n     ROLLBACK;\n     DBMS_OUTPUT.PUT_LINE(SQLCODE);\n     DBMS_OUTPUT.PUT_LINE(SQLERRM);\n\n    DBMS_OUTPUT.put_line('Error in function FN_DIV_COMPRESS');\n    RETURN 600;\n\n\n\nEND FN_DIV_COMPRESS;\n/",
            "upstream_dependencies": [],
            "downstream_dependencies": [],
            "dag_location": "null",
            "gantt_location": "null",
            "created_at": "null",
            "updated_at": "null"
        },
        {
            "name": "FN_SALESCB_ACCESS_VPD",
            "encrypted_name": "3a9b3c9f3855596793f6aa3a196038f3dc6b6eb8e8d01ef6bc7325a0d378c188",
            "type": "function",
            "database": "null",
            "encrypted_database": "null",
            "schema": "XDMADM",
            "encrypted_schema": "0e03d5c46556a742ba46252698396ef2",
            "fully_qualified_name": "XDMADM.FN_SALESCB_ACCESS_VPD",
            "encrypted_fqn": "0e03d5c46556a742ba46252698396ef2.3a9b3c9f3855596793f6aa3a196038f3dc6b6eb8e8d01ef6bc7325a0d378c188",
            "synonyms": [],
            "metadata_analysis": "CREATE OR REPLACE FUNCTION \"0e03d5c46556a742ba46252698396ef2\".\"3a9b3c9f3855596793f6aa3a196038f3dc6b6eb8e8d01ef6bc7325a0d378c188\" (p_schema       IN VARCHAR2,\n                                                 p_objname      IN VARCHAR2)\n   RETURN VARCHAR2 AS\n   \n   c_start                CONSTANT NUMBER := DBMS_UTILITY.get_time;\n   c_fn_nm                CONSTANT VARCHAR2(30) := 'FN_SALESCB_ACCESS_VPD';\n   l_security_predicate   VARCHAR2(4000) DEFAULT NULL;\n   l_cur_sql              VARCHAR2(4000) := SYS_CONTEXT('USERENV', 'CURRENT_SQL');\n   l_sbjct_area VARCHAR2(100)\n         := SYS_CONTEXT(9751bbbcfea690cc0be4d58830a6fe2e.9bfb5eb7793dc8fa6800d5a61e5e3e4e1e2f6ec194927f064ce6cb31fba71a32.f4a54ebc6f2c591ed4266aafe66971af, 9751bbbcfea690cc0be4d58830a6fe2e.9bfb5eb7793dc8fa6800d5a61e5e3e4e1e2f6ec194927f064ce6cb31fba71a32.3b1288ed835b1b524e9500bb13544956e6e6300089dae5a98e31814d0406060f);\n   l_sales_cb VARCHAR2(1)\n         := SYS_CONTEXT(9751bbbcfea690cc0be4d58830a6fe2e.9bfb5eb7793dc8fa6800d5a61e5e3e4e1e2f6ec194927f064ce6cb31fba71a32.f4a54ebc6f2c591ed4266aafe66971af, 9751bbbcfea690cc0be4d58830a6fe2e.9bfb5eb7793dc8fa6800d5a61e5e3e4e1e2f6ec194927f064ce6cb31fba71a32.18b8f3c0ab3006a1a45779298981b3f3);\nBEGIN\n   \n   IF l_sbjct_area IS NULL THEN\n      l_security_predicate   := '1=2';\n      9751bbbcfea690cc0be4d58830a6fe2e.d4abe88ed2062b430c927bc84d61faf1f9a7aadf5998d448c2e2d1b0b47a3056.7d64937276682b23a0e16e5c61dad7aa('NO SA', c_fn_nm, USER, p_schema, p_objname, l_sbjct_area, l_sales_cb, NULL,\n      l_cur_sql, l_security_predicate, (DBMS_UTILITY.get_time - c_start) / 100);\n\n      RETURN l_security_predicate;\n   END IF;\n\n   \n\n   IF l_sales_cb = 'Y' THEN\n      l_security_predicate   := '1=1';\n   ELSE\n      l_security_predicate   := '1=2';\n   END IF;\n      9751bbbcfea690cc0be4d58830a6fe2e.d4abe88ed2062b430c927bc84d61faf1f9a7aadf5998d448c2e2d1b0b47a3056.7d64937276682b23a0e16e5c61dad7aa('SALESCB', c_fn_nm, USER, p_schema, p_objname, l_sbjct_area, l_sales_cb,\n      NULL, l_cur_sql, l_security_predicate, (DBMS_UTILITY.get_time - c_start) / 100);\n\n      RETURN l_security_predicate;\n\nEXCEPTION\n   WHEN OTHERS THEN\n      l_security_predicate   := '1=3';\n      9751bbbcfea690cc0be4d58830a6fe2e.d4abe88ed2062b430c927bc84d61faf1f9a7aadf5998d448c2e2d1b0b47a3056.7d64937276682b23a0e16e5c61dad7aa(SQLCODE || '-' || SQLERRM, c_fn_nm, USER, p_schema, p_objname, l_sbjct_area,\n      l_sales_cb, NULL, l_cur_sql, l_security_predicate, (DBMS_UTILITY.get_time - c_start) / 100);\n\n      RETURN l_security_predicate;\nEND fn_salescb_access_vpd;\n/",
            "upstream_dependencies": [],
            "downstream_dependencies": [],
            "dag_location": "null",
            "gantt_location": "null",
            "created_at": "null",
            "updated_at": "null"
        },
        {
            "name": "FN_POWER_SELL_EXTRACT",
            "encrypted_name": "ec93221db65670d7431bc87eff7d5d5006582a4f83ed62b663e72849041a12b6",
            "type": "function",
            "database": "null",
            "encrypted_database": "null",
            "schema": "XDMADM",
            "encrypted_schema": "0e03d5c46556a742ba46252698396ef2",
            "fully_qualified_name": "XDMADM.FN_POWER_SELL_EXTRACT",
            "encrypted_fqn": "0e03d5c46556a742ba46252698396ef2.ec93221db65670d7431bc87eff7d5d5006582a4f83ed62b663e72849041a12b6",
            "synonyms": [],
            "metadata_analysis": "CREATE OR REPLACE FUNCTION \"0e03d5c46556a742ba46252698396ef2\".\"ec93221db65670d7431bc87eff7d5d5006582a4f83ed62b663e72849041a12b6\" (v_in_promo_start_dt IN VARCHAR2,\n                                                                                                        v_in_promo_end_dt IN VARCHAR2,\n                                                                                                        v_in_pwr_sell_nbr IN NUMBER,\n                                                                                                        v_in_part_or_all IN CHAR)\nRETURN NUMBER IS\n\n\n   CON_PROCESS_NAME  CONSTANT varchar2(40) := 'FN_POWER_SELL_EXTRACT';\n\n\n    v_promo_strt_dt DATE:=to_Date(v_in_promo_start_dt,'YYYYMMDD');\n    v_promo_end_dt DATE:=to_Date(v_in_promo_end_dt,'YYYYMMDD');\n    v_6wk_promo_strt_dt  DATE;\n    v_6wk_promo_end_dt  DATE;\n    v_pre_before_promo_strt_dt  DATE;\n    v_pre_before_promo_end_dt  DATE;\n    v_before_promo_strt_dt  DATE;\n    v_before_promo_end_dt  DATE;\n    v_prior_4wk_promo_strt_dt  DATE;\n    v_prior_4wk_promo_end_dt  DATE;\n    v_during_promo_strt_dt  DATE ;\n    v_during_promo_end_dt  DATE;\n    v_after_promo_1_strt_dt  DATE;\n    v_after_promo_1_end_dt  DATE;\n    v_after_promo_2_strt_dt DATE;\n    v_after_promo_2_end_dt DATE;\n    v_after_promo_3_strt_dt  DATE;\n    v_after_promo_3_end_dt  DATE;\n    v_after_promo_4_strt_dt DATE;\n    v_after_promo_4_end_dt DATE;\n    v_after_promo_5_strt_dt DATE;\n    v_after_promo_5_end_dt DATE;\n    v_after_promo_6_strt_dt  DATE;\n    v_after_promo_6_end_dt  DATE;\n\n    v_prcs_start_dt_1   DATE;\n    v_prcs_start_dt_2   DATE;\n\n    v_trunc_allow   boolean;\n    v_trunc_ret      NUMBER(3);\n\n\n   v_prcs_nm           varchar(100);\n   v_prcs_stp           varchar(100);\n   v_prcs_pram        varchar(100);\n   v_out_msg           varchar(200);\n\n\n\n\n   ALL_EXCEPTIONS       EXCEPTION;\n\nBEGIN\n    dbms_output.put_line('Start Process '||CON_PROCESS_NAME);\n    dbms_output.put_line('Start Time:'||TO_CHAR(SYSDATE,'YYYY-MM-DD HH24:MI:SS'));\n    v_prcs_nm  := CON_PROCESS_NAME ;\n    v_prcs_pram:= 'PARAM1 : '||v_in_promo_start_dt||'  PARAM2 : '||v_in_pwr_sell_nbr|| ' PARAM3 : '||v_in_part_or_all;\n    v_prcs_stp := 'Start Process '||CON_PROCESS_NAME;\n\n\n    v_prcs_stp := 'Calculating different 2 week periods before and after the promo period';\n\n    SELECT  (clndr_dt - 14) into v_6wk_promo_strt_dt\n    FROM  de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001\n    where clndr_dt = to_Date(v_in_promo_start_dt,'YYYYMMDD');\n\n    SELECT  (clndr_dt + 27) into v_6wk_promo_end_dt\n    FROM  de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001\n    where clndr_dt =  to_Date(v_in_promo_start_dt,'YYYYMMDD');\n\n    SELECT  (clndr_dt - 28) into v_pre_before_promo_strt_dt\n    FROM  de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001\n    where clndr_dt = to_Date(v_in_promo_start_dt,'YYYYMMDD');\n\n    SELECT  (clndr_dt - 15) into v_pre_before_promo_end_dt\n    FROM  de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001\n    where clndr_dt = to_Date(v_in_promo_start_dt,'YYYYMMDD');\n\n    SELECT  (clndr_dt - 14) into v_before_promo_strt_dt\n    FROM  de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001\n    where clndr_dt = to_Date(v_in_promo_start_dt,'YYYYMMDD');\n\n    SELECT  (clndr_dt - 1) into v_before_promo_end_dt\n    FROM  de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001\n    where clndr_dt = to_Date(v_in_promo_start_dt,'YYYYMMDD');\n\n    SELECT  (clndr_dt - 28) into v_prior_4wk_promo_strt_dt\n    FROM  de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001\n    where clndr_dt =  to_Date(v_in_promo_start_dt,'YYYYMMDD');\n\n    SELECT  (clndr_dt - 1) into v_prior_4wk_promo_end_dt\n    FROM  de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001\n    where clndr_dt =  to_Date(v_in_promo_start_dt,'YYYYMMDD');\n\n    SELECT  (clndr_dt + 14) into v_after_promo_1_strt_dt\n    FROM  de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001\n    where clndr_dt =  to_Date(v_in_promo_start_dt,'YYYYMMDD');\n\n    SELECT  (clndr_dt + 27) into v_after_promo_1_end_dt\n    FROM  de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001\n    where clndr_dt =  to_Date(v_in_promo_start_dt,'YYYYMMDD');\n\n    SELECT  (clndr_dt + 28) into v_after_promo_2_strt_dt\n    FROM  de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001\n    where clndr_dt =  to_Date(v_in_promo_start_dt,'YYYYMMDD');\n\n    SELECT  (clndr_dt + 41) into v_after_promo_2_end_dt\n    FROM  de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001\n    where clndr_dt =  to_Date(v_in_promo_start_dt,'YYYYMMDD');\n\n    SELECT  (clndr_dt + 42) into v_after_promo_3_strt_dt\n    FROM  de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001\n    where clndr_dt =  to_Date(v_in_promo_start_dt,'YYYYMMDD');\n\n    SELECT  (clndr_dt + 55) into v_after_promo_3_end_dt\n    FROM  de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001\n    where clndr_dt =  to_Date(v_in_promo_start_dt,'YYYYMMDD');\n\n    SELECT  (clndr_dt + 56) into v_after_promo_4_strt_dt\n    FROM  de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001\n    where clndr_dt =  to_Date(v_in_promo_start_dt,'YYYYMMDD');\n\n    SELECT  (clndr_dt + 69) into v_after_promo_4_end_dt\n    FROM  de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001\n    where clndr_dt =  to_Date(v_in_promo_start_dt,'YYYYMMDD');\n\n    SELECT  (clndr_dt + 70) into v_after_promo_5_strt_dt\n    FROM  de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001\n    where clndr_dt =  to_Date(v_in_promo_start_dt,'YYYYMMDD');\n\n    SELECT  (clndr_dt + 83) into v_after_promo_5_end_dt\n    FROM  de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001\n    where clndr_dt =  to_Date(v_in_promo_start_dt,'YYYYMMDD');\n\n    SELECT  (clndr_dt + 84) into v_after_promo_6_strt_dt\n    FROM  de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001\n    where clndr_dt =  to_Date(v_in_promo_start_dt,'YYYYMMDD');\n\n    SELECT  (clndr_dt + 97) into v_after_promo_6_end_dt\n    FROM  de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001\n    where clndr_dt =  to_Date(v_in_promo_start_dt,'YYYYMMDD');\n\n    v_during_promo_strt_dt  := to_Date(v_in_promo_start_dt,'YYYYMMDD');\n\n    v_during_promo_end_dt  := v_promo_end_dt;\n\n    v_prcs_start_dt_1 :=to_Date(v_in_promo_start_dt,'YYYYMMDD') - 7;\n\n    dbms_output.put_line('Process Date lower boundary 1 is set to '||v_prcs_start_dt_1);\n\n    v_prcs_start_dt_2 :=to_date(v_prior_4wk_promo_strt_dt) - 7;\n\n    dbms_output.put_line('Process Date lower boundary 2 is set to '||v_prcs_start_dt_2);\n\n\n\n\n   v_prcs_stp := 'Truncating 0e03d5c46556a742ba46252698396ef2.1ab723fdee604fa4d29a899a7475d1fdf7c554af09fd48f3c4c62c7d5043c349 Table';\n   v_trunc_allow := 7540495dc7d95c8483c39c98db3db89c.72d996f41712e622935d17bc9cb23cfa.f2e56c4ac14ad72f47eee2a3f667a4a6d1b3a4e36657532c2ced5912c7edf830 (v_out_msg, 'XDMADM','POWER_SELL_EXTRACT');\n   DBMS_OUTPUT.PUT_LINE(v_out_msg);\n   IF v_trunc_allow = TRUE THEN\n   dbms_output.put_line('Truncating the Extract table 0e03d5c46556a742ba46252698396ef2.1ab723fdee604fa4d29a899a7475d1fdf7c554af09fd48f3c4c62c7d5043c349');\n    v_trunc_ret := 7540495dc7d95c8483c39c98db3db89c.72d996f41712e622935d17bc9cb23cfa.bf64c6f363cecdf8179ad64aad199c7e(v_out_msg, 'XDMADM','POWER_SELL_EXTRACT');\n     DBMS_OUTPUT.PUT_LINE(v_out_msg);\n     IF v_trunc_ret != 0 THEN\n        DBMS_OUTPUT.PUT_LINE('Error in Truncating the 0e03d5c46556a742ba46252698396ef2.1ab723fdee604fa4d29a899a7475d1fdf7c554af09fd48f3c4c62c7d5043c349 table');\n        RAISE ALL_EXCEPTIONS;\n     END IF;\n   ELSE\n     DBMS_OUTPUT.PUT_LINE('USFDBA Security doesn''t allow to truncate 0e03d5c46556a742ba46252698396ef2.1ab723fdee604fa4d29a899a7475d1fdf7c554af09fd48f3c4c62c7d5043c349 table');\n     DBMS_OUTPUT.PUT_LINE('     Check entry in 7540495dc7d95c8483c39c98db3db89c.3c6e9cb9d3836831584b90275ef803f4 table for 0e03d5c46556a742ba46252698396ef2.1ab723fdee604fa4d29a899a7475d1fdf7c554af09fd48f3c4c62c7d5043c349 table');\n     RAISE ALL_EXCEPTIONS;\n   END IF;\n\n\n\n\n\n   dbms_output.put_line('Extracting the data and inserting it into the 0e03d5c46556a742ba46252698396ef2.1ab723fdee604fa4d29a899a7475d1fdf7c554af09fd48f3c4c62c7d5043c349 table');\n\n   IF v_in_part_or_all = 'P' THEN\n\n        INSERT INTO 0e03d5c46556a742ba46252698396ef2.1ab723fdee604fa4d29a899a7475d1fdf7c554af09fd48f3c4c62c7d5043c349 (CUST_NBR,\n                                            DIV_NBR,\n                                            RGN_NM,\n                                            DIV_NM,\n                                            BRNCH_CD,\n                                            CUST_MNR_CD,\n                                            CUST_SEGMENT)\n             SELECT cust_nbr,\n                    div_nbr,\n                    rgn_nm,\n                    div_nm,\n                    brnch_cd,\n                    cust_mnr_cd,\n                    cust_segment\n               FROM (  SELECT de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.852fa1e9f02f1ca2c75837f7146b2381,\n                              de459e2fe7f96e4d958537b31b946b26.dec387908a0954ddc8689c4ad37c8a3c.839c4ffb4bfaae1bb58eab4dee67d96a,\n                              de459e2fe7f96e4d958537b31b946b26.dec387908a0954ddc8689c4ad37c8a3c.01730d3774f2352616a3b828e4b785de,\n                              de459e2fe7f96e4d958537b31b946b26.dec387908a0954ddc8689c4ad37c8a3c.245658138d22919d7bd7dff808e5af8e,\n                              de459e2fe7f96e4d958537b31b946b26.dec387908a0954ddc8689c4ad37c8a3c.4855453efe73ff0bd0f7583df58260dd,\n                              de459e2fe7f96e4d958537b31b946b26.52982d3bbc1ebc2720d9504c7ea2ed3f.17a070f45558c000ef488aabe8b430c2,\n                              NVL(0e03d5c46556a742ba46252698396ef2.f0a765d684f26ce372a47468c689b6f1cab169eac07c924a4e6d0b1d95aea4b1.3d175075010e8d6e7e3ffef9334a7b9b,'UNKNOWN') cust_segment\n                         FROM de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c sls,\n                              de459e2fe7f96e4d958537b31b946b26.52982d3bbc1ebc2720d9504c7ea2ed3f cust,\n                              de459e2fe7f96e4d958537b31b946b26.dec387908a0954ddc8689c4ad37c8a3c div,\n                              0e03d5c46556a742ba46252698396ef2.69ad7df32bb34a5a908a4db4990be143 ps,\n                              0e03d5c46556a742ba46252698396ef2.f0a765d684f26ce372a47468c689b6f1cab169eac07c924a4e6d0b1d95aea4b1 seg\n                        WHERE     1 = 1\n                              AND de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.114e45b0f4a93a24527076d8af10c847 BETWEEN v_promo_strt_dt\n                                                            AND v_promo_end_dt\n                              AND de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.f5dd4374a3e3af6a775cb6d6b22e8162 >= v_prcs_start_dt_1\n                              AND de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.839c4ffb4bfaae1bb58eab4dee67d96a = de459e2fe7f96e4d958537b31b946b26.52982d3bbc1ebc2720d9504c7ea2ed3f.839c4ffb4bfaae1bb58eab4dee67d96a\n                              AND de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.852fa1e9f02f1ca2c75837f7146b2381 = de459e2fe7f96e4d958537b31b946b26.52982d3bbc1ebc2720d9504c7ea2ed3f.852fa1e9f02f1ca2c75837f7146b2381\n                              AND de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.7c11ab787cf6f310ca23c850e9034413e32f6dd38f333cde68119d1f277367cd = 'ST'\n                              AND de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.839c4ffb4bfaae1bb58eab4dee67d96a = de459e2fe7f96e4d958537b31b946b26.dec387908a0954ddc8689c4ad37c8a3c.839c4ffb4bfaae1bb58eab4dee67d96a\n                              AND de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.839c4ffb4bfaae1bb58eab4dee67d96a = 0e03d5c46556a742ba46252698396ef2.69ad7df32bb34a5a908a4db4990be143.839c4ffb4bfaae1bb58eab4dee67d96a\n                              AND de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.2d45d761eb8d137835bca7a23010fab4 = 0e03d5c46556a742ba46252698396ef2.69ad7df32bb34a5a908a4db4990be143.2d45d761eb8d137835bca7a23010fab4\n                              AND de459e2fe7f96e4d958537b31b946b26.52982d3bbc1ebc2720d9504c7ea2ed3f.17a070f45558c000ef488aabe8b430c2 = 0e03d5c46556a742ba46252698396ef2.f0a765d684f26ce372a47468c689b6f1cab169eac07c924a4e6d0b1d95aea4b1.17a070f45558c000ef488aabe8b430c2(+)\n                              AND 0e03d5c46556a742ba46252698396ef2.69ad7df32bb34a5a908a4db4990be143.5d6dea6acdb2993fe46589a82eae232b=v_in_pwr_sell_nbr\n                              AND de459e2fe7f96e4d958537b31b946b26.dec387908a0954ddc8689c4ad37c8a3c.85b4b7d7e348ea1b4b4693689aac3cc6 IS NULL\n                              AND de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.49dbc899bc8f9659472a5a3b3510790c = 475\n                              AND XFER_TO_DT IS NULL)\n           GROUP BY cust_nbr,\n                    div_nbr,\n                    rgn_nm,\n                    div_nm,\n                    brnch_cd,\n                    cust_mnr_cd,\n                    cust_segment;\n\n        COMMIT;\n\n    ELSIF v_in_part_or_all = 'A' THEN\n\n       INSERT INTO 0e03d5c46556a742ba46252698396ef2.1ab723fdee604fa4d29a899a7475d1fdf7c554af09fd48f3c4c62c7d5043c349 (CUST_NBR,\n                                            DIV_NBR,\n                                            RGN_NM,\n                                            DIV_NM,\n                                            BRNCH_CD,\n                                            CUST_MNR_CD,\n                                            CUST_SEGMENT)\n             SELECT cust_nbr,\n                    div_nbr,\n                    rgn_nm,\n                    div_nm,\n                    brnch_cd,\n                    cust_mnr_cd,\n                    cust_segment\n               FROM (  SELECT de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.852fa1e9f02f1ca2c75837f7146b2381,\n                              de459e2fe7f96e4d958537b31b946b26.dec387908a0954ddc8689c4ad37c8a3c.839c4ffb4bfaae1bb58eab4dee67d96a,\n                              de459e2fe7f96e4d958537b31b946b26.dec387908a0954ddc8689c4ad37c8a3c.01730d3774f2352616a3b828e4b785de,\n                              de459e2fe7f96e4d958537b31b946b26.dec387908a0954ddc8689c4ad37c8a3c.245658138d22919d7bd7dff808e5af8e,\n                              de459e2fe7f96e4d958537b31b946b26.dec387908a0954ddc8689c4ad37c8a3c.4855453efe73ff0bd0f7583df58260dd,\n                              de459e2fe7f96e4d958537b31b946b26.52982d3bbc1ebc2720d9504c7ea2ed3f.17a070f45558c000ef488aabe8b430c2,\n                              NVL(0e03d5c46556a742ba46252698396ef2.f0a765d684f26ce372a47468c689b6f1cab169eac07c924a4e6d0b1d95aea4b1.3d175075010e8d6e7e3ffef9334a7b9b,'UNKNOWN') cust_segment\n                         FROM de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c sls,\n                              de459e2fe7f96e4d958537b31b946b26.52982d3bbc1ebc2720d9504c7ea2ed3f cust,\n                              de459e2fe7f96e4d958537b31b946b26.dec387908a0954ddc8689c4ad37c8a3c div,\n                              0e03d5c46556a742ba46252698396ef2.f0a765d684f26ce372a47468c689b6f1cab169eac07c924a4e6d0b1d95aea4b1 seg\n                        WHERE     1 = 1\n                              AND de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.114e45b0f4a93a24527076d8af10c847 BETWEEN v_promo_strt_dt\n                                                            AND v_promo_end_dt\n                              AND de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.f5dd4374a3e3af6a775cb6d6b22e8162 >= v_prcs_start_dt_1\n                              AND de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.839c4ffb4bfaae1bb58eab4dee67d96a = de459e2fe7f96e4d958537b31b946b26.52982d3bbc1ebc2720d9504c7ea2ed3f.839c4ffb4bfaae1bb58eab4dee67d96a\n                              AND de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.852fa1e9f02f1ca2c75837f7146b2381 = de459e2fe7f96e4d958537b31b946b26.52982d3bbc1ebc2720d9504c7ea2ed3f.852fa1e9f02f1ca2c75837f7146b2381\n                              AND de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.839c4ffb4bfaae1bb58eab4dee67d96a = de459e2fe7f96e4d958537b31b946b26.dec387908a0954ddc8689c4ad37c8a3c.839c4ffb4bfaae1bb58eab4dee67d96a\n                              AND de459e2fe7f96e4d958537b31b946b26.52982d3bbc1ebc2720d9504c7ea2ed3f.17a070f45558c000ef488aabe8b430c2 = 0e03d5c46556a742ba46252698396ef2.f0a765d684f26ce372a47468c689b6f1cab169eac07c924a4e6d0b1d95aea4b1.17a070f45558c000ef488aabe8b430c2(+)\n                              AND de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.7c11ab787cf6f310ca23c850e9034413e32f6dd38f333cde68119d1f277367cd = 'ST'\n                              AND de459e2fe7f96e4d958537b31b946b26.dec387908a0954ddc8689c4ad37c8a3c.85b4b7d7e348ea1b4b4693689aac3cc6 IS NULL\n                              AND XFER_TO_DT IS NULL\n                              AND de459e2fe7f96e4d958537b31b946b26.dec387908a0954ddc8689c4ad37c8a3c.b8c6ab19cb6e726c38f24d1885346ea3 not in ('NS','STK'))\n           GROUP BY cust_nbr,\n                    div_nbr,\n                    rgn_nm,\n                    div_nm,\n                    brnch_cd,\n                    cust_mnr_cd,\n                    cust_segment;\n\n        COMMIT;\n\n    ELSE\n\n        dbms_output.put_line('Invalid Parameter Value');\n\n    END IF;\n\n    dbms_output.put_line('Merging data into the Extract table');\n\n    MERGE INTO 0e03d5c46556a742ba46252698396ef2.1ab723fdee604fa4d29a899a7475d1fdf7c554af09fd48f3c4c62c7d5043c349 TRGT\n         USING (  SELECT cust_nbr,\n                         div_nbr,\n                         CASE\n                            WHEN SUM (NVL (WEEKLY_AVG_6WK_PROMO_SALE, 0) / 6) < 1000\n                            THEN\n                               1\n                            WHEN SUM (NVL (WEEKLY_AVG_6WK_PROMO_SALE, 0) / 6) >= 1000\n                                 AND SUM (NVL (WEEKLY_AVG_6WK_PROMO_SALE, 0) / 6) <= 3000\n                            THEN\n                               2\n                            ELSE\n                               3\n                         END\n                            CUST_TIER,\n                         SUM (PRIOR_4_WK_SLS_ALL_PROD)\n                            PRIOR_4_WK_SLS_ALL_PROD,\n                         CASE\n                            WHEN SUM (PRIOR_4_WK_SLS_ALL_PROD) > 0\n                            THEN\n                               'EXISTING CUSTOMER'\n                            ELSE\n                               'NEW CUSTOMER'\n                         END\n                            EXISTING_CUST_FLAG,\n                         SUM (AFTER_PROMO_SLS_1) AFTER_PROMO_SLS_1,\n                         SUM (AFTER_PROMO_CASES_1) AFTER_PROMO_CASES_1,\n                         SUM (AFTER_PROMO_DROPS_1) AFTER_PROMO_DROPS_1,\n                         SUM (AFTER_PROMO_LINES_1) AFTER_PROMO_LINES_1,\n                         SUM (AFTER_PROMO_GP3_1) AFTER_PROMO_GP3_1,\n                         SUM (AFTER_PROMO_SLS_2) AFTER_PROMO_SLS_2,\n                         SUM (AFTER_PROMO_CASES_2) AFTER_PROMO_CASES_2,\n                         SUM (AFTER_PROMO_DROPS_2) AFTER_PROMO_DROPS_2,\n                         SUM (AFTER_PROMO_LINES_2) AFTER_PROMO_LINES_2,\n                         SUM (AFTER_PROMO_GP3_2) AFTER_PROMO_GP3_2,\n                         SUM (AFTER_PROMO_SLS_3) AFTER_PROMO_SLS_3,\n                         SUM (AFTER_PROMO_CASES_3) AFTER_PROMO_CASES_3,\n                         SUM (AFTER_PROMO_DROPS_3) AFTER_PROMO_DROPS_3,\n                         SUM (AFTER_PROMO_LINES_3) AFTER_PROMO_LINES_3,\n                         SUM (AFTER_PROMO_GP3_3) AFTER_PROMO_GP3_3,\n                         SUM (AFTER_PROMO_SLS_4) AFTER_PROMO_SLS_4,\n                         SUM (AFTER_PROMO_CASES_4) AFTER_PROMO_CASES_4,\n                         SUM (AFTER_PROMO_DROPS_4) AFTER_PROMO_DROPS_4,\n                         SUM (AFTER_PROMO_LINES_4) AFTER_PROMO_LINES_4,\n                         SUM (AFTER_PROMO_GP3_4) AFTER_PROMO_GP3_4,\n                         SUM (AFTER_PROMO_SLS_5) AFTER_PROMO_SLS_5,\n                         SUM (AFTER_PROMO_CASES_5) AFTER_PROMO_CASES_5,\n                         SUM (AFTER_PROMO_DROPS_5) AFTER_PROMO_DROPS_5,\n                         SUM (AFTER_PROMO_LINES_5) AFTER_PROMO_LINES_5,\n                         SUM (AFTER_PROMO_GP3_5) AFTER_PROMO_GP3_5,\n                         SUM (AFTER_PROMO_SLS_6) AFTER_PROMO_SLS_6,\n                         SUM (AFTER_PROMO_CASES_6) AFTER_PROMO_CASES_6,\n                         SUM (AFTER_PROMO_DROPS_6) AFTER_PROMO_DROPS_6,\n                         SUM (AFTER_PROMO_LINES_6) AFTER_PROMO_LINES_6,\n                         SUM (AFTER_PROMO_GP3_6) AFTER_PROMO_GP3_6,\n                         SUM (PRE_BEFORE_PROMO_SLS) PRE_BEFORE_PROMO_SLS,\n                         SUM (PRE_BEFORE_PROMO_CASES) PRE_BEFORE_PROMO_CASES,\n                         SUM (PRE_BEFORE_PROMO_DROPS) PRE_BEFORE_PROMO_DROPS,\n                         SUM (PRE_BEFORE_PROMO_LINES) PRE_BEFORE_PROMO_LINES,\n                         SUM (PRE_BEFORE_PROMO_GP3) PRE_BEFORE_PROMO_GP3,\n                         SUM (DURING_PROMO_SLS) DURING_PROMO_SLS,\n                         SUM (BEFORE_PROMO_SLS) BEFORE_PROMO_SLS,\n                         SUM (DURING_PROMO_CASES) DURING_PROMO_CASES,\n                         SUM (BEFORE_PROMO_CASES) BEFORE_PROMO_CASES,\n                         SUM (DURING_PROMO_DROPS) DURING_PROMO_DROPS,\n                         SUM (BEFORE_PROMO_DROPS) BEFORE_PROMO_DROPS,\n                         SUM (DURING_PROMO_LINES) DURING_PROMO_LINES,\n                         SUM (BEFORE_PROMO_LINES) BEFORE_PROMO_LINES,\n                         SUM (DURING_PROMO_GP3) DURING_PROMO_GP3,\n                         SUM (BEFORE_PROMO_GP3) BEFORE_PROMO_GP3,\n                         SUM (WEEKLY_AVG_6WK_PROMO_SALE) WEEKLY_AVG_6WK_PROMO_SALE\n                    FROM (  SELECT fba30c50fca98b497b0ee63200e72c52.852fa1e9f02f1ca2c75837f7146b2381,\n                                   fba30c50fca98b497b0ee63200e72c52.839c4ffb4bfaae1bb58eab4dee67d96a,\n                                   CASE\n                                      WHEN fba30c50fca98b497b0ee63200e72c52.114e45b0f4a93a24527076d8af10c847 BETWEEN v_6wk_promo_strt_dt\n                                                               AND v_6wk_promo_end_dt\n                                      THEN\n                                         SUM (grs_sls_extnd)\n                                   END\n                                      WEEKLY_AVG_6WK_PROMO_SALE,\n                                   CASE\n                                      WHEN fba30c50fca98b497b0ee63200e72c52.114e45b0f4a93a24527076d8af10c847 BETWEEN v_pre_before_promo_strt_dt\n                                                               AND v_pre_before_promo_end_dt\n                                      THEN\n                                         CASE\n                                            WHEN trans_typ = 'RT'\n                                            THEN\n                                               COUNT (\n                                                  DISTINCT (   fba30c50fca98b497b0ee63200e72c52.839c4ffb4bfaae1bb58eab4dee67d96a\n                                                            || fba30c50fca98b497b0ee63200e72c52.852fa1e9f02f1ca2c75837f7146b2381\n                                                            || fba30c50fca98b497b0ee63200e72c52.114e45b0f4a93a24527076d8af10c847\n                                                            || fba30c50fca98b497b0ee63200e72c52.56adda4bea730f475f72a764ae233182\n                                                            || fba30c50fca98b497b0ee63200e72c52.75b48bce4ac7fd755a820b7e28f1c320))\n                                            ELSE\n                                               0\n                                         END\n                                   END\n                                      PRE_BEFORE_PROMO_DROPS,\n                                   CASE\n                                      WHEN fba30c50fca98b497b0ee63200e72c52.114e45b0f4a93a24527076d8af10c847 BETWEEN  v_pre_before_promo_strt_dt\n                                                               AND v_pre_before_promo_end_dt\n                                      THEN\n                                         SUM (grs_sls_extnd)\n                                   END\n                                      PRE_BEFORE_PROMO_SLS,\n                                   CASE\n                                      WHEN fba30c50fca98b497b0ee63200e72c52.114e45b0f4a93a24527076d8af10c847 BETWEEN  v_pre_before_promo_strt_dt\n                                                               AND v_pre_before_promo_end_dt\n                                      THEN\n                                         SUM (qty_ship)\n                                   END\n                                      PRE_BEFORE_PROMO_CASES,\n                                   CASE\n                                      WHEN fba30c50fca98b497b0ee63200e72c52.114e45b0f4a93a24527076d8af10c847 BETWEEN  v_pre_before_promo_strt_dt\n                                                               AND v_pre_before_promo_end_dt\n                                      THEN\n                                         SUM (\n                                            CASE\n                                               WHEN TRANS_TYP IN ('RT', 'WC', 'VS')\n                                                    AND PIM_SUPRCLS_ID_ACTL <> '97'\n                                               THEN\n                                                  1\n                                               ELSE\n                                                  0\n                                            END)\n                                   END\n                                      PRE_BEFORE_PROMO_LINES,\n                                   CASE\n                                      WHEN fba30c50fca98b497b0ee63200e72c52.114e45b0f4a93a24527076d8af10c847 BETWEEN  v_pre_before_promo_strt_dt\n                                                               AND v_pre_before_promo_end_dt\n                                      THEN\n                                         SUM (\n                                              NVL (grs_sls_extnd, 0)\n                                            - NVL (dwa_cost_extnd, 0)\n                                            + NVL (dvt_cost_extnd, 0)\n                                            - NVL (ttl_int_vndr_fnd_dvt, 0)\n                                            + NVL (ttl_alwnc, 0))\n                                   END\n                                      PRE_BEFORE_PROMO_GP3,\n                                   CASE\n                                      WHEN fba30c50fca98b497b0ee63200e72c52.114e45b0f4a93a24527076d8af10c847 BETWEEN v_during_promo_strt_dt\n                                                               AND v_during_promo_end_dt\n                                      THEN\n                                         CASE\n                                            WHEN trans_typ = 'RT'\n                                            THEN\n                                               COUNT (\n                                                  DISTINCT (   fba30c50fca98b497b0ee63200e72c52.839c4ffb4bfaae1bb58eab4dee67d96a\n                                                            || fba30c50fca98b497b0ee63200e72c52.852fa1e9f02f1ca2c75837f7146b2381\n                                                            || fba30c50fca98b497b0ee63200e72c52.114e45b0f4a93a24527076d8af10c847\n                                                            || fba30c50fca98b497b0ee63200e72c52.56adda4bea730f475f72a764ae233182\n                                                            || fba30c50fca98b497b0ee63200e72c52.75b48bce4ac7fd755a820b7e28f1c320))\n                                            ELSE\n                                               0\n                                         END\n                                   END\n                                      DURING_PROMO_DROPS,\n                                   CASE\n                                      WHEN fba30c50fca98b497b0ee63200e72c52.114e45b0f4a93a24527076d8af10c847 BETWEEN v_during_promo_strt_dt\n                                                               AND v_during_promo_end_dt\n                                      THEN\n                                         SUM (grs_sls_extnd)\n                                   END\n                                      DURING_PROMO_SLS,\n                                   CASE\n                                      WHEN fba30c50fca98b497b0ee63200e72c52.114e45b0f4a93a24527076d8af10c847 BETWEEN v_during_promo_strt_dt \n                                                               AND v_during_promo_end_dt \n                                      THEN\n                                         SUM (qty_ship)\n                                   END\n                                      DURING_PROMO_CASES,\n                                   CASE\n                                      WHEN fba30c50fca98b497b0ee63200e72c52.114e45b0f4a93a24527076d8af10c847 BETWEEN v_during_promo_strt_dt\n                                                               AND v_during_promo_end_dt\n                                      THEN\n                                         SUM (\n                                            CASE\n                                               WHEN TRANS_TYP IN ('RT', 'WC', 'VS')\n                                                    AND PIM_SUPRCLS_ID_ACTL <> '97'\n                                               THEN\n                                                  1\n                                               ELSE\n                                                  0\n                                            END)\n                                   END\n                                      DURING_PROMO_LINES,\n                                   CASE\n                                      WHEN fba30c50fca98b497b0ee63200e72c52.114e45b0f4a93a24527076d8af10c847 BETWEEN v_during_promo_strt_dt\n                                                               AND v_during_promo_end_dt\n                                      THEN\n                                         SUM (\n                                              NVL (grs_sls_extnd, 0)\n                                            - NVL (dwa_cost_extnd, 0)\n                                            + NVL (dvt_cost_extnd, 0)\n                                            - NVL (ttl_int_vndr_fnd_dvt, 0)\n                                            + NVL (ttl_alwnc, 0))\n                                   END\n                                      DURING_PROMO_GP3,\n                                   CASE\n                                      WHEN fba30c50fca98b497b0ee63200e72c52.114e45b0f4a93a24527076d8af10c847 BETWEEN v_before_promo_strt_dt\n                                                               AND v_before_promo_end_dt\n                                      THEN\n                                         CASE\n                                            WHEN trans_typ = 'RT'\n                                            THEN\n                                               COUNT (\n                                                  DISTINCT (   fba30c50fca98b497b0ee63200e72c52.839c4ffb4bfaae1bb58eab4dee67d96a\n                                                            || fba30c50fca98b497b0ee63200e72c52.852fa1e9f02f1ca2c75837f7146b2381\n                                                            || fba30c50fca98b497b0ee63200e72c52.114e45b0f4a93a24527076d8af10c847\n                                                            || fba30c50fca98b497b0ee63200e72c52.56adda4bea730f475f72a764ae233182\n                                                            || fba30c50fca98b497b0ee63200e72c52.75b48bce4ac7fd755a820b7e28f1c320))\n                                            ELSE\n                                               0\n                                         END\n                                   END\n                                      BEFORE_PROMO_DROPS,\n                                   CASE\n                                      WHEN fba30c50fca98b497b0ee63200e72c52.114e45b0f4a93a24527076d8af10c847 BETWEEN v_before_promo_strt_dt\n                                                               AND v_before_promo_end_dt\n                                      THEN\n                                         SUM (grs_sls_extnd)\n                                   END\n                                      BEFORE_PROMO_SLS,\n                                   CASE\n                                      WHEN fba30c50fca98b497b0ee63200e72c52.114e45b0f4a93a24527076d8af10c847 BETWEEN v_before_promo_strt_dt\n                                                               AND v_before_promo_end_dt\n                                      THEN\n                                         SUM (qty_ship)\n                                   END\n                                      BEFORE_PROMO_CASES,\n                                   CASE\n                                      WHEN fba30c50fca98b497b0ee63200e72c52.114e45b0f4a93a24527076d8af10c847 BETWEEN v_before_promo_strt_dt\n                                                               AND v_before_promo_end_dt\n                                      THEN\n                                         SUM (\n                                            CASE\n                                               WHEN TRANS_TYP IN ('RT', 'WC', 'VS')\n                                                    AND PIM_SUPRCLS_ID_ACTL <> '97'\n                                               THEN\n                                                  1\n                                               ELSE\n                                                  0\n                                            END)\n                                   END\n                                      BEFORE_PROMO_LINES,\n                                   CASE\n                                      WHEN fba30c50fca98b497b0ee63200e72c52.114e45b0f4a93a24527076d8af10c847 BETWEEN v_before_promo_strt_dt\n                                                               AND v_before_promo_end_dt\n                                      THEN\n                                         SUM (\n                                              NVL (grs_sls_extnd, 0)\n                                            - NVL (dwa_cost_extnd, 0)\n                                            + NVL (dvt_cost_extnd, 0)\n                                            - NVL (ttl_int_vndr_fnd_dvt, 0)\n                                            + NVL (ttl_alwnc, 0))\n                                   END\n                                      BEFORE_PROMO_GP3,\n                                   CASE\n                                      WHEN fba30c50fca98b497b0ee63200e72c52.114e45b0f4a93a24527076d8af10c847 BETWEEN v_prior_4wk_promo_strt_dt\n                                                               AND v_prior_4wk_promo_end_dt\n                                      THEN\n                                         SUM (grs_sls_extnd)\n                                   END\n                                      PRIOR_4_WK_SLS_ALL_PROD,\n                                   CASE\n                                      WHEN fba30c50fca98b497b0ee63200e72c52.114e45b0f4a93a24527076d8af10c847 BETWEEN v_after_promo_1_strt_dt\n                                                               AND v_after_promo_1_end_dt\n                                      THEN\n                                         CASE\n                                            WHEN trans_typ = 'RT'\n                                            THEN\n                                               COUNT (\n                                                  DISTINCT (   fba30c50fca98b497b0ee63200e72c52.839c4ffb4bfaae1bb58eab4dee67d96a\n                                                            || fba30c50fca98b497b0ee63200e72c52.852fa1e9f02f1ca2c75837f7146b2381\n                                                            || fba30c50fca98b497b0ee63200e72c52.114e45b0f4a93a24527076d8af10c847\n                                                            || fba30c50fca98b497b0ee63200e72c52.56adda4bea730f475f72a764ae233182\n                                                            || fba30c50fca98b497b0ee63200e72c52.75b48bce4ac7fd755a820b7e28f1c320))\n                                            ELSE\n                                               0\n                                         END\n                                   END\n                                      AFTER_PROMO_DROPS_1,\n                                   CASE\n                                      WHEN fba30c50fca98b497b0ee63200e72c52.114e45b0f4a93a24527076d8af10c847 BETWEEN v_after_promo_1_strt_dt\n                                                               AND v_after_promo_1_end_dt\n                                      THEN\n                                         SUM (grs_sls_extnd)\n                                   END\n                                      AFTER_PROMO_SLS_1,\n                                   CASE\n                                      WHEN fba30c50fca98b497b0ee63200e72c52.114e45b0f4a93a24527076d8af10c847 BETWEEN v_after_promo_1_strt_dt\n                                                               AND v_after_promo_1_end_dt\n                                      THEN\n                                         SUM (qty_ship)\n                                   END\n                                      AFTER_PROMO_CASES_1,\n                                   CASE\n                                      WHEN fba30c50fca98b497b0ee63200e72c52.114e45b0f4a93a24527076d8af10c847 BETWEEN v_after_promo_1_strt_dt\n                                                               AND v_after_promo_1_end_dt\n                                      THEN\n                                         SUM (\n                                            CASE\n                                               WHEN TRANS_TYP IN ('RT', 'WC', 'VS')\n                                                    AND PIM_SUPRCLS_ID_ACTL <> '97'\n                                               THEN\n                                                  1\n                                               ELSE\n                                                  0\n                                            END)\n                                   END\n                                      AFTER_PROMO_LINES_1,\n                                   CASE\n                                      WHEN fba30c50fca98b497b0ee63200e72c52.114e45b0f4a93a24527076d8af10c847 BETWEEN v_after_promo_1_strt_dt\n                                                               AND v_after_promo_1_end_dt\n                                      THEN\n                                         SUM (\n                                              NVL (grs_sls_extnd, 0)\n                                            - NVL (dwa_cost_extnd, 0)\n                                            + NVL (dvt_cost_extnd, 0)\n                                            - NVL (ttl_int_vndr_fnd_dvt, 0)\n                                            + NVL (ttl_alwnc, 0))\n                                   END\n                                      AFTER_PROMO_GP3_1,\n                                 CASE\n                                      WHEN fba30c50fca98b497b0ee63200e72c52.114e45b0f4a93a24527076d8af10c847 BETWEEN v_after_promo_2_strt_dt\n                                                               AND v_after_promo_2_end_dt\n                                      THEN\n                                         CASE\n                                            WHEN trans_typ = 'RT'\n                                            THEN\n                                               COUNT (\n                                                  DISTINCT (   fba30c50fca98b497b0ee63200e72c52.839c4ffb4bfaae1bb58eab4dee67d96a\n                                                            || fba30c50fca98b497b0ee63200e72c52.852fa1e9f02f1ca2c75837f7146b2381\n                                                            || fba30c50fca98b497b0ee63200e72c52.114e45b0f4a93a24527076d8af10c847\n                                                            || fba30c50fca98b497b0ee63200e72c52.56adda4bea730f475f72a764ae233182\n                                                            || fba30c50fca98b497b0ee63200e72c52.75b48bce4ac7fd755a820b7e28f1c320))\n                                            ELSE\n                                               0\n                                         END\n                                   END\n                                      AFTER_PROMO_DROPS_2,\n                                   CASE\n                                      WHEN fba30c50fca98b497b0ee63200e72c52.114e45b0f4a93a24527076d8af10c847 BETWEEN v_after_promo_2_strt_dt\n                                                               AND v_after_promo_2_end_dt\n                                      THEN\n                                         SUM (grs_sls_extnd)\n                                   END\n                                      AFTER_PROMO_SLS_2,\n                                   CASE\n                                      WHEN fba30c50fca98b497b0ee63200e72c52.114e45b0f4a93a24527076d8af10c847 BETWEEN v_after_promo_2_strt_dt\n                                                               AND v_after_promo_2_end_dt\n                                      THEN\n                                         SUM (qty_ship)\n                                   END\n                                      AFTER_PROMO_CASES_2,\n                                   CASE\n                                      WHEN fba30c50fca98b497b0ee63200e72c52.114e45b0f4a93a24527076d8af10c847 BETWEEN v_after_promo_2_strt_dt\n                                                               AND v_after_promo_2_end_dt\n                                      THEN\n                                         SUM (\n                                            CASE\n                                               WHEN TRANS_TYP IN ('RT', 'WC', 'VS')\n                                                    AND PIM_SUPRCLS_ID_ACTL <> '97'\n                                               THEN\n                                                  1\n                                               ELSE\n                                                  0\n                                            END)\n                                   END\n                                      AFTER_PROMO_LINES_2,\n                                   CASE\n                                      WHEN fba30c50fca98b497b0ee63200e72c52.114e45b0f4a93a24527076d8af10c847 BETWEEN v_after_promo_2_strt_dt\n                                                               AND v_after_promo_2_end_dt\n                                      THEN\n                                         SUM (\n                                              NVL (grs_sls_extnd, 0)\n                                            - NVL (dwa_cost_extnd, 0)\n                                            + NVL (dvt_cost_extnd, 0)\n                                            - NVL (ttl_int_vndr_fnd_dvt, 0)\n                                            + NVL (ttl_alwnc, 0))\n                                   END\n                                      AFTER_PROMO_GP3_2,\n                                 CASE\n                                      WHEN fba30c50fca98b497b0ee63200e72c52.114e45b0f4a93a24527076d8af10c847 BETWEEN v_after_promo_3_strt_dt\n                                                               AND v_after_promo_3_end_dt\n                                      THEN\n                                         CASE\n                                            WHEN trans_typ = 'RT'\n                                            THEN\n                                               COUNT (\n                                                  DISTINCT (   fba30c50fca98b497b0ee63200e72c52.839c4ffb4bfaae1bb58eab4dee67d96a\n                                                            || fba30c50fca98b497b0ee63200e72c52.852fa1e9f02f1ca2c75837f7146b2381\n                                                            || fba30c50fca98b497b0ee63200e72c52.114e45b0f4a93a24527076d8af10c847\n                                                            || fba30c50fca98b497b0ee63200e72c52.56adda4bea730f475f72a764ae233182\n                                                            || fba30c50fca98b497b0ee63200e72c52.75b48bce4ac7fd755a820b7e28f1c320))\n                                            ELSE\n                                               0\n                                         END\n                                   END\n                                      AFTER_PROMO_DROPS_3,\n                                   CASE\n                                      WHEN fba30c50fca98b497b0ee63200e72c52.114e45b0f4a93a24527076d8af10c847 BETWEEN v_after_promo_3_strt_dt\n                                                               AND v_after_promo_3_end_dt\n                                      THEN\n                                         SUM (grs_sls_extnd)\n                                   END\n                                      AFTER_PROMO_SLS_3,\n                                   CASE\n                                      WHEN fba30c50fca98b497b0ee63200e72c52.114e45b0f4a93a24527076d8af10c847 BETWEEN v_after_promo_3_strt_dt\n                                                               AND v_after_promo_3_end_dt\n                                      THEN\n                                         SUM (qty_ship)\n                                   END\n                                      AFTER_PROMO_CASES_3,\n                                   CASE\n                                      WHEN fba30c50fca98b497b0ee63200e72c52.114e45b0f4a93a24527076d8af10c847 BETWEEN v_after_promo_3_strt_dt\n                                                               AND v_after_promo_3_end_dt\n                                      THEN\n                                         SUM (\n                                            CASE\n                                               WHEN TRANS_TYP IN ('RT', 'WC', 'VS')\n                                                    AND PIM_SUPRCLS_ID_ACTL <> '97'\n                                               THEN\n                                                  1\n                                               ELSE\n                                                  0\n                                            END)\n                                   END\n                                      AFTER_PROMO_LINES_3,\n                                   CASE\n                                      WHEN fba30c50fca98b497b0ee63200e72c52.114e45b0f4a93a24527076d8af10c847 BETWEEN v_after_promo_3_strt_dt\n                                                               AND v_after_promo_3_end_dt\n                                      THEN\n                                         SUM (\n                                              NVL (grs_sls_extnd, 0)\n                                            - NVL (dwa_cost_extnd, 0)\n                                            + NVL (dvt_cost_extnd, 0)\n                                            - NVL (ttl_int_vndr_fnd_dvt, 0)\n                                            + NVL (ttl_alwnc, 0))\n                                   END\n                                      AFTER_PROMO_GP3_3,\n                                 CASE\n                                      WHEN fba30c50fca98b497b0ee63200e72c52.114e45b0f4a93a24527076d8af10c847 BETWEEN v_after_promo_4_strt_dt\n                                                               AND v_after_promo_4_end_dt\n                                      THEN\n                                         CASE\n                                            WHEN trans_typ = 'RT'\n                                            THEN\n                                               COUNT (\n                                                  DISTINCT (   fba30c50fca98b497b0ee63200e72c52.839c4ffb4bfaae1bb58eab4dee67d96a\n                                                            || fba30c50fca98b497b0ee63200e72c52.852fa1e9f02f1ca2c75837f7146b2381\n                                                            || fba30c50fca98b497b0ee63200e72c52.114e45b0f4a93a24527076d8af10c847\n                                                            || fba30c50fca98b497b0ee63200e72c52.56adda4bea730f475f72a764ae233182\n                                                            || fba30c50fca98b497b0ee63200e72c52.75b48bce4ac7fd755a820b7e28f1c320))\n                                            ELSE\n                                               0\n                                         END\n                                   END\n                                      AFTER_PROMO_DROPS_4,\n                                   CASE\n                                      WHEN fba30c50fca98b497b0ee63200e72c52.114e45b0f4a93a24527076d8af10c847 BETWEEN v_after_promo_4_strt_dt\n                                                               AND v_after_promo_4_end_dt\n                                      THEN\n                                         SUM (grs_sls_extnd)\n                                   END\n                                      AFTER_PROMO_SLS_4,\n                                   CASE\n                                      WHEN fba30c50fca98b497b0ee63200e72c52.114e45b0f4a93a24527076d8af10c847 BETWEEN v_after_promo_4_strt_dt\n                                                               AND v_after_promo_4_end_dt\n                                      THEN\n                                         SUM (qty_ship)\n                                   END\n                                      AFTER_PROMO_CASES_4,\n                                   CASE\n                                      WHEN fba30c50fca98b497b0ee63200e72c52.114e45b0f4a93a24527076d8af10c847 BETWEEN v_after_promo_4_strt_dt\n                                                               AND v_after_promo_4_end_dt\n                                      THEN\n                                         SUM (\n                                            CASE\n                                               WHEN TRANS_TYP IN ('RT', 'WC', 'VS')\n                                                    AND PIM_SUPRCLS_ID_ACTL <> '97'\n                                               THEN\n                                                  1\n                                               ELSE\n                                                  0\n                                            END)\n                                   END\n                                      AFTER_PROMO_LINES_4,\n                                   CASE\n                                      WHEN fba30c50fca98b497b0ee63200e72c52.114e45b0f4a93a24527076d8af10c847 BETWEEN v_after_promo_4_strt_dt\n                                                               AND v_after_promo_4_end_dt\n                                      THEN\n                                         SUM (\n                                              NVL (grs_sls_extnd, 0)\n                                            - NVL (dwa_cost_extnd, 0)\n                                            + NVL (dvt_cost_extnd, 0)\n                                            - NVL (ttl_int_vndr_fnd_dvt, 0)\n                                            + NVL (ttl_alwnc, 0))\n                                   END\n                                      AFTER_PROMO_GP3_4,\n                                 CASE\n                                      WHEN fba30c50fca98b497b0ee63200e72c52.114e45b0f4a93a24527076d8af10c847 BETWEEN v_after_promo_5_strt_dt\n                                                               AND v_after_promo_5_end_dt\n                                      THEN\n                                         CASE\n                                            WHEN trans_typ = 'RT'\n                                            THEN\n                                               COUNT (\n                                                  DISTINCT (   fba30c50fca98b497b0ee63200e72c52.839c4ffb4bfaae1bb58eab4dee67d96a\n                                                            || fba30c50fca98b497b0ee63200e72c52.852fa1e9f02f1ca2c75837f7146b2381\n                                                            || fba30c50fca98b497b0ee63200e72c52.114e45b0f4a93a24527076d8af10c847\n                                                            || fba30c50fca98b497b0ee63200e72c52.56adda4bea730f475f72a764ae233182\n                                                            || fba30c50fca98b497b0ee63200e72c52.75b48bce4ac7fd755a820b7e28f1c320))\n                                            ELSE\n                                               0\n                                         END\n                                   END\n                                      AFTER_PROMO_DROPS_5,\n                                   CASE\n                                      WHEN fba30c50fca98b497b0ee63200e72c52.114e45b0f4a93a24527076d8af10c847 BETWEEN v_after_promo_5_strt_dt\n                                                               AND v_after_promo_5_end_dt\n                                      THEN\n                                         SUM (grs_sls_extnd)\n                                   END\n                                      AFTER_PROMO_SLS_5,\n                                   CASE\n                                      WHEN fba30c50fca98b497b0ee63200e72c52.114e45b0f4a93a24527076d8af10c847 BETWEEN v_after_promo_5_strt_dt\n                                                               AND v_after_promo_5_end_dt\n                                      THEN\n                                         SUM (qty_ship)\n                                   END\n                                      AFTER_PROMO_CASES_5,\n                                   CASE\n                                      WHEN fba30c50fca98b497b0ee63200e72c52.114e45b0f4a93a24527076d8af10c847 BETWEEN v_after_promo_5_strt_dt\n                                                               AND v_after_promo_5_end_dt\n                                      THEN\n                                         SUM (\n                                            CASE\n                                               WHEN TRANS_TYP IN ('RT', 'WC', 'VS')\n                                                    AND PIM_SUPRCLS_ID_ACTL <> '97'\n                                               THEN\n                                                  1\n                                               ELSE\n                                                  0\n                                            END)\n                                   END\n                                      AFTER_PROMO_LINES_5,\n                                   CASE\n                                      WHEN fba30c50fca98b497b0ee63200e72c52.114e45b0f4a93a24527076d8af10c847 BETWEEN v_after_promo_5_strt_dt\n                                                               AND v_after_promo_5_end_dt\n                                      THEN\n                                         SUM (\n                                              NVL (grs_sls_extnd, 0)\n                                            - NVL (dwa_cost_extnd, 0)\n                                            + NVL (dvt_cost_extnd, 0)\n                                            - NVL (ttl_int_vndr_fnd_dvt, 0)\n                                            + NVL (ttl_alwnc, 0))\n                                   END\n                                      AFTER_PROMO_GP3_5,\n                                 CASE\n                                      WHEN fba30c50fca98b497b0ee63200e72c52.114e45b0f4a93a24527076d8af10c847 BETWEEN v_after_promo_6_strt_dt\n                                                               AND v_after_promo_6_end_dt\n                                      THEN\n                                         CASE\n                                            WHEN trans_typ = 'RT'\n                                            THEN\n                                               COUNT (\n                                                  DISTINCT (   fba30c50fca98b497b0ee63200e72c52.839c4ffb4bfaae1bb58eab4dee67d96a\n                                                            || fba30c50fca98b497b0ee63200e72c52.852fa1e9f02f1ca2c75837f7146b2381\n                                                            || fba30c50fca98b497b0ee63200e72c52.114e45b0f4a93a24527076d8af10c847\n                                                            || fba30c50fca98b497b0ee63200e72c52.56adda4bea730f475f72a764ae233182\n                                                            || fba30c50fca98b497b0ee63200e72c52.75b48bce4ac7fd755a820b7e28f1c320))\n                                            ELSE\n                                               0\n                                         END\n                                   END\n                                      AFTER_PROMO_DROPS_6,\n                                   CASE\n                                      WHEN fba30c50fca98b497b0ee63200e72c52.114e45b0f4a93a24527076d8af10c847 BETWEEN v_after_promo_6_strt_dt\n                                                               AND v_after_promo_6_end_dt\n                                      THEN\n                                         SUM (grs_sls_extnd)\n                                   END\n                                      AFTER_PROMO_SLS_6,\n                                   CASE\n                                      WHEN fba30c50fca98b497b0ee63200e72c52.114e45b0f4a93a24527076d8af10c847 BETWEEN v_after_promo_6_strt_dt\n                                                               AND v_after_promo_6_end_dt\n                                      THEN\n                                         SUM (qty_ship)\n                                   END\n                                      AFTER_PROMO_CASES_6,\n                                   CASE\n                                      WHEN fba30c50fca98b497b0ee63200e72c52.114e45b0f4a93a24527076d8af10c847 BETWEEN v_after_promo_6_strt_dt\n                                                               AND v_after_promo_6_end_dt\n                                      THEN\n                                         SUM (\n                                            CASE\n                                               WHEN TRANS_TYP IN ('RT', 'WC', 'VS')\n                                                    AND PIM_SUPRCLS_ID_ACTL <> '97'\n                                               THEN\n                                                  1\n                                               ELSE\n                                                  0\n                                            END)\n                                   END\n                                      AFTER_PROMO_LINES_6,\n                                   CASE\n                                      WHEN fba30c50fca98b497b0ee63200e72c52.114e45b0f4a93a24527076d8af10c847 BETWEEN v_after_promo_6_strt_dt\n                                                               AND v_after_promo_6_end_dt\n                                      THEN\n                                         SUM (\n                                              NVL (grs_sls_extnd, 0)\n                                            - NVL (dwa_cost_extnd, 0)\n                                            + NVL (dvt_cost_extnd, 0)\n                                            - NVL (ttl_int_vndr_fnd_dvt, 0)\n                                            + NVL (ttl_alwnc, 0))\n                                   END\n                                      AFTER_PROMO_GP3_6\n                              FROM de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c sls, 0e03d5c46556a742ba46252698396ef2.1ab723fdee604fa4d29a899a7475d1fdf7c554af09fd48f3c4c62c7d5043c349 PS\n                             WHERE 1 = 1\n                                   AND fba30c50fca98b497b0ee63200e72c52.114e45b0f4a93a24527076d8af10c847 BETWEEN v_prior_4wk_promo_strt_dt\n                                                           AND  v_after_promo_6_end_dt\n                                   AND fba30c50fca98b497b0ee63200e72c52.f5dd4374a3e3af6a775cb6d6b22e8162 >=v_prcs_start_dt_2\n                                   AND fba30c50fca98b497b0ee63200e72c52.839c4ffb4bfaae1bb58eab4dee67d96a IN (SELECT div_nbr\n                                                         FROM de459e2fe7f96e4d958537b31b946b26.dec387908a0954ddc8689c4ad37c8a3c\n                                                       WHERE CONV_TO_DIV_NBR IS NULL)\n                                   AND XFER_TO_DT IS NULL\n                                   AND c630462a4fd85a10f0302587c8da71ca.4fdc122fb2d10dd764e32cbc98972eca = 2104ad3f9342b8abea3aa0f4e1f40649.4fdc122fb2d10dd764e32cbc98972eca\n                                   AND c630462a4fd85a10f0302587c8da71ca.9f055ebf334db6c50bbcab4ff14bd2ae = 2104ad3f9342b8abea3aa0f4e1f40649.9f055ebf334db6c50bbcab4ff14bd2ae\n                          GROUP BY fba30c50fca98b497b0ee63200e72c52.852fa1e9f02f1ca2c75837f7146b2381,\n                                   fba30c50fca98b497b0ee63200e72c52.839c4ffb4bfaae1bb58eab4dee67d96a,\n                                   \n                                   trans_typ,\n                                   fba30c50fca98b497b0ee63200e72c52.114e45b0f4a93a24527076d8af10c847)\n                GROUP BY cust_nbr, div_nbr) SRC\n            ON (03135e8eab7d8846e24b96fb1204a44a.4fdc122fb2d10dd764e32cbc98972eca = 215e418ad9025f1dbf5cad52e981de39.4fdc122fb2d10dd764e32cbc98972eca AND 03135e8eab7d8846e24b96fb1204a44a.9f055ebf334db6c50bbcab4ff14bd2ae = 215e418ad9025f1dbf5cad52e981de39.9f055ebf334db6c50bbcab4ff14bd2ae)\n    WHEN MATCHED\n    THEN\n       UPDATE SET\n          215e418ad9025f1dbf5cad52e981de39.86e7b772ffa7484c04d8e013f0233a5c9d6cfad1740f19132e45444654041557 = 03135e8eab7d8846e24b96fb1204a44a.86e7b772ffa7484c04d8e013f0233a5c9d6cfad1740f19132e45444654041557,\n          215e418ad9025f1dbf5cad52e981de39.7091ab95bf9c1483036fa07152a16113c48fcd3601442e748d69b17de4d60f82 = 03135e8eab7d8846e24b96fb1204a44a.7091ab95bf9c1483036fa07152a16113c48fcd3601442e748d69b17de4d60f82,\n          215e418ad9025f1dbf5cad52e981de39.0a0cab39a8964332a475ac2fae841782 = 03135e8eab7d8846e24b96fb1204a44a.0a0cab39a8964332a475ac2fae841782,\n          215e418ad9025f1dbf5cad52e981de39.ec14b5734c07d7112e715024d471b69ae32f6dd38f333cde68119d1f277367cd = 03135e8eab7d8846e24b96fb1204a44a.ec14b5734c07d7112e715024d471b69ae32f6dd38f333cde68119d1f277367cd,\n          215e418ad9025f1dbf5cad52e981de39.2d55c93617574b2d70fc8c3370b6401ce32f6dd38f333cde68119d1f277367cd = 03135e8eab7d8846e24b96fb1204a44a.2d55c93617574b2d70fc8c3370b6401ce32f6dd38f333cde68119d1f277367cd,\n          215e418ad9025f1dbf5cad52e981de39.457003bc99b7fa8d719072865df6ee1be5aca4cdef00c073fdeedbbbe9f50221 = 03135e8eab7d8846e24b96fb1204a44a.457003bc99b7fa8d719072865df6ee1be5aca4cdef00c073fdeedbbbe9f50221,\n          215e418ad9025f1dbf5cad52e981de39.e79dc46bf4b8a39b523d0329fae074cce5aca4cdef00c073fdeedbbbe9f50221 = 03135e8eab7d8846e24b96fb1204a44a.e79dc46bf4b8a39b523d0329fae074cce5aca4cdef00c073fdeedbbbe9f50221,\n          215e418ad9025f1dbf5cad52e981de39.48aa19e11f36f80a034209b90e4741122104ad3f9342b8abea3aa0f4e1f40649 = 03135e8eab7d8846e24b96fb1204a44a.48aa19e11f36f80a034209b90e4741122104ad3f9342b8abea3aa0f4e1f40649,\n          215e418ad9025f1dbf5cad52e981de39.ddc7a2ece1e7bb3cb28c71d9e3eaa97e2104ad3f9342b8abea3aa0f4e1f40649 = 03135e8eab7d8846e24b96fb1204a44a.ddc7a2ece1e7bb3cb28c71d9e3eaa97e2104ad3f9342b8abea3aa0f4e1f40649,\n          215e418ad9025f1dbf5cad52e981de39.d6895cc07ea846af44faab6dca66db76e5aca4cdef00c073fdeedbbbe9f50221 = 03135e8eab7d8846e24b96fb1204a44a.d6895cc07ea846af44faab6dca66db76e5aca4cdef00c073fdeedbbbe9f50221,\n          215e418ad9025f1dbf5cad52e981de39.8a3b513aad846861602b21873fee9464e5aca4cdef00c073fdeedbbbe9f50221 = 03135e8eab7d8846e24b96fb1204a44a.8a3b513aad846861602b21873fee9464e5aca4cdef00c073fdeedbbbe9f50221,\n          215e418ad9025f1dbf5cad52e981de39.eef2b06425a25dfe71c1c438edd8974ee32f6dd38f333cde68119d1f277367cd = 03135e8eab7d8846e24b96fb1204a44a.eef2b06425a25dfe71c1c438edd8974ee32f6dd38f333cde68119d1f277367cd,\n          215e418ad9025f1dbf5cad52e981de39.a9a1d250797d5c6073b67d7d42078f20e32f6dd38f333cde68119d1f277367cd = 03135e8eab7d8846e24b96fb1204a44a.a9a1d250797d5c6073b67d7d42078f20e32f6dd38f333cde68119d1f277367cd,\n          215e418ad9025f1dbf5cad52e981de39.0dca57085b19f1f36e5e02361e11283d926a8f708d293c7129123370b920c825 = 03135e8eab7d8846e24b96fb1204a44a.0dca57085b19f1f36e5e02361e11283d926a8f708d293c7129123370b920c825,\n          215e418ad9025f1dbf5cad52e981de39.0dca57085b19f1f36e5e02361e11283d63a3943edaf97f40399c6c32533f4535 = 03135e8eab7d8846e24b96fb1204a44a.0dca57085b19f1f36e5e02361e11283d63a3943edaf97f40399c6c32533f4535,\n          215e418ad9025f1dbf5cad52e981de39.0dca57085b19f1f36e5e02361e11283d5a493e055af6895a19a78292f28badf9 = 03135e8eab7d8846e24b96fb1204a44a.0dca57085b19f1f36e5e02361e11283d5a493e055af6895a19a78292f28badf9,\n          215e418ad9025f1dbf5cad52e981de39.0dca57085b19f1f36e5e02361e11283dc2a067f66dbe7a1249d18174e4445ee4 = 03135e8eab7d8846e24b96fb1204a44a.0dca57085b19f1f36e5e02361e11283dc2a067f66dbe7a1249d18174e4445ee4,\n          215e418ad9025f1dbf5cad52e981de39.0dca57085b19f1f36e5e02361e11283d6f738b29a20848199c7193eea951b7c0 = 03135e8eab7d8846e24b96fb1204a44a.0dca57085b19f1f36e5e02361e11283d6f738b29a20848199c7193eea951b7c0,\n          215e418ad9025f1dbf5cad52e981de39.f314a5645e1e5c2d1859f9917f20974a928ed809d5eb9696876a473ab90c53e0 = 03135e8eab7d8846e24b96fb1204a44a.f314a5645e1e5c2d1859f9917f20974a928ed809d5eb9696876a473ab90c53e0,\n          215e418ad9025f1dbf5cad52e981de39.a91ffee57d29e6739badc72c6777bac9db02b11ec3972484647aab3c75ddba4c = 03135e8eab7d8846e24b96fb1204a44a.a91ffee57d29e6739badc72c6777bac9db02b11ec3972484647aab3c75ddba4c,\n          215e418ad9025f1dbf5cad52e981de39.8473a93f2585ea1a9ac6cb552f6feee8db02b11ec3972484647aab3c75ddba4c = 03135e8eab7d8846e24b96fb1204a44a.8473a93f2585ea1a9ac6cb552f6feee8db02b11ec3972484647aab3c75ddba4c,\n          215e418ad9025f1dbf5cad52e981de39.84362b531e7044a5cfde14d9e2eb216bdb02b11ec3972484647aab3c75ddba4c = 03135e8eab7d8846e24b96fb1204a44a.84362b531e7044a5cfde14d9e2eb216bdb02b11ec3972484647aab3c75ddba4c,\n          215e418ad9025f1dbf5cad52e981de39.af72181ccf5260c09cb9232c47c55b1b928ed809d5eb9696876a473ab90c53e0 = 03135e8eab7d8846e24b96fb1204a44a.af72181ccf5260c09cb9232c47c55b1b928ed809d5eb9696876a473ab90c53e0,\n          215e418ad9025f1dbf5cad52e981de39.f314a5645e1e5c2d1859f9917f20974aace6a70281f910ed21575549ada48d32 = 03135e8eab7d8846e24b96fb1204a44a.f314a5645e1e5c2d1859f9917f20974aace6a70281f910ed21575549ada48d32,\n          215e418ad9025f1dbf5cad52e981de39.a91ffee57d29e6739badc72c6777bac9857f13d377f45d940c27642d1b2fdf8e = 03135e8eab7d8846e24b96fb1204a44a.a91ffee57d29e6739badc72c6777bac9857f13d377f45d940c27642d1b2fdf8e,\n          215e418ad9025f1dbf5cad52e981de39.8473a93f2585ea1a9ac6cb552f6feee8857f13d377f45d940c27642d1b2fdf8e = 03135e8eab7d8846e24b96fb1204a44a.8473a93f2585ea1a9ac6cb552f6feee8857f13d377f45d940c27642d1b2fdf8e,\n          215e418ad9025f1dbf5cad52e981de39.84362b531e7044a5cfde14d9e2eb216b857f13d377f45d940c27642d1b2fdf8e = 03135e8eab7d8846e24b96fb1204a44a.84362b531e7044a5cfde14d9e2eb216b857f13d377f45d940c27642d1b2fdf8e,\n          215e418ad9025f1dbf5cad52e981de39.af72181ccf5260c09cb9232c47c55b1bace6a70281f910ed21575549ada48d32 = 03135e8eab7d8846e24b96fb1204a44a.af72181ccf5260c09cb9232c47c55b1bace6a70281f910ed21575549ada48d32,\n          215e418ad9025f1dbf5cad52e981de39.f314a5645e1e5c2d1859f9917f20974a189461cb89458fed8fa9cc7c9c407279 = 03135e8eab7d8846e24b96fb1204a44a.f314a5645e1e5c2d1859f9917f20974a189461cb89458fed8fa9cc7c9c407279,\n          215e418ad9025f1dbf5cad52e981de39.a91ffee57d29e6739badc72c6777bac93c7d954a37605e245060a8e7e90bfe6e = 03135e8eab7d8846e24b96fb1204a44a.a91ffee57d29e6739badc72c6777bac93c7d954a37605e245060a8e7e90bfe6e,\n          215e418ad9025f1dbf5cad52e981de39.8473a93f2585ea1a9ac6cb552f6feee83c7d954a37605e245060a8e7e90bfe6e = 03135e8eab7d8846e24b96fb1204a44a.8473a93f2585ea1a9ac6cb552f6feee83c7d954a37605e245060a8e7e90bfe6e,\n          215e418ad9025f1dbf5cad52e981de39.84362b531e7044a5cfde14d9e2eb216b3c7d954a37605e245060a8e7e90bfe6e = 03135e8eab7d8846e24b96fb1204a44a.84362b531e7044a5cfde14d9e2eb216b3c7d954a37605e245060a8e7e90bfe6e,\n          215e418ad9025f1dbf5cad52e981de39.af72181ccf5260c09cb9232c47c55b1b189461cb89458fed8fa9cc7c9c407279 = 03135e8eab7d8846e24b96fb1204a44a.af72181ccf5260c09cb9232c47c55b1b189461cb89458fed8fa9cc7c9c407279,\n          215e418ad9025f1dbf5cad52e981de39.f314a5645e1e5c2d1859f9917f20974aeb5b31d02bd817f0c1a5a2905f7a3053 = 03135e8eab7d8846e24b96fb1204a44a.f314a5645e1e5c2d1859f9917f20974aeb5b31d02bd817f0c1a5a2905f7a3053,\n          215e418ad9025f1dbf5cad52e981de39.a91ffee57d29e6739badc72c6777bac9a8b53a19de50e63a4d4df2edc161287c = 03135e8eab7d8846e24b96fb1204a44a.a91ffee57d29e6739badc72c6777bac9a8b53a19de50e63a4d4df2edc161287c,\n          215e418ad9025f1dbf5cad52e981de39.8473a93f2585ea1a9ac6cb552f6feee8a8b53a19de50e63a4d4df2edc161287c = 03135e8eab7d8846e24b96fb1204a44a.8473a93f2585ea1a9ac6cb552f6feee8a8b53a19de50e63a4d4df2edc161287c,\n          215e418ad9025f1dbf5cad52e981de39.84362b531e7044a5cfde14d9e2eb216ba8b53a19de50e63a4d4df2edc161287c = 03135e8eab7d8846e24b96fb1204a44a.84362b531e7044a5cfde14d9e2eb216ba8b53a19de50e63a4d4df2edc161287c,\n          215e418ad9025f1dbf5cad52e981de39.af72181ccf5260c09cb9232c47c55b1beb5b31d02bd817f0c1a5a2905f7a3053 = 03135e8eab7d8846e24b96fb1204a44a.af72181ccf5260c09cb9232c47c55b1beb5b31d02bd817f0c1a5a2905f7a3053,\n          215e418ad9025f1dbf5cad52e981de39.f314a5645e1e5c2d1859f9917f20974a894f9467974006e770f6860bd69857ad = 03135e8eab7d8846e24b96fb1204a44a.f314a5645e1e5c2d1859f9917f20974a894f9467974006e770f6860bd69857ad,\n          215e418ad9025f1dbf5cad52e981de39.a91ffee57d29e6739badc72c6777bac9989466d08eb13a35a48ce8b4e046aeee = 03135e8eab7d8846e24b96fb1204a44a.a91ffee57d29e6739badc72c6777bac9989466d08eb13a35a48ce8b4e046aeee,\n          215e418ad9025f1dbf5cad52e981de39.8473a93f2585ea1a9ac6cb552f6feee8989466d08eb13a35a48ce8b4e046aeee = 03135e8eab7d8846e24b96fb1204a44a.8473a93f2585ea1a9ac6cb552f6feee8989466d08eb13a35a48ce8b4e046aeee,\n          215e418ad9025f1dbf5cad52e981de39.84362b531e7044a5cfde14d9e2eb216b989466d08eb13a35a48ce8b4e046aeee = 03135e8eab7d8846e24b96fb1204a44a.84362b531e7044a5cfde14d9e2eb216b989466d08eb13a35a48ce8b4e046aeee,\n          215e418ad9025f1dbf5cad52e981de39.af72181ccf5260c09cb9232c47c55b1b894f9467974006e770f6860bd69857ad = 03135e8eab7d8846e24b96fb1204a44a.af72181ccf5260c09cb9232c47c55b1b894f9467974006e770f6860bd69857ad,\n          215e418ad9025f1dbf5cad52e981de39.f314a5645e1e5c2d1859f9917f20974a8eeda3d0fc35c307265b5042ffca11ea = 03135e8eab7d8846e24b96fb1204a44a.f314a5645e1e5c2d1859f9917f20974a8eeda3d0fc35c307265b5042ffca11ea,\n          215e418ad9025f1dbf5cad52e981de39.a91ffee57d29e6739badc72c6777bac913c9e761de2c90b5f4824eca39a426b5 = 03135e8eab7d8846e24b96fb1204a44a.a91ffee57d29e6739badc72c6777bac913c9e761de2c90b5f4824eca39a426b5,\n          215e418ad9025f1dbf5cad52e981de39.8473a93f2585ea1a9ac6cb552f6feee813c9e761de2c90b5f4824eca39a426b5 = 03135e8eab7d8846e24b96fb1204a44a.8473a93f2585ea1a9ac6cb552f6feee813c9e761de2c90b5f4824eca39a426b5,\n          215e418ad9025f1dbf5cad52e981de39.84362b531e7044a5cfde14d9e2eb216b13c9e761de2c90b5f4824eca39a426b5 = 03135e8eab7d8846e24b96fb1204a44a.84362b531e7044a5cfde14d9e2eb216b13c9e761de2c90b5f4824eca39a426b5,\n          215e418ad9025f1dbf5cad52e981de39.af72181ccf5260c09cb9232c47c55b1b8eeda3d0fc35c307265b5042ffca11ea = 03135e8eab7d8846e24b96fb1204a44a.af72181ccf5260c09cb9232c47c55b1b8eeda3d0fc35c307265b5042ffca11ea;\n\n\n\n\n  <<Wrap_Program>>\n\n      v_prcs_stp := 'Final Commit';\n\n      COMMIT;\n\n      dbms_output.put_line('End Process '||CON_PROCESS_NAME);\n      dbms_output.put_line('End Time:'||TO_CHAR(SYSDATE,'YYYY-MM-DD HH24:MI:SS'));\n      RETURN 0;\n\n\n\n    EXCEPTION\n      WHEN ALL_EXCEPTIONS\n      THEN\n         ROLLBACK;\n         DBMS_OUTPUT.put_line ('error raised at step:');\n         DBMS_OUTPUT.put_line ('******'||v_prcs_stp);\n         RETURN 1;\n      WHEN OTHERS\n      THEN\n          ROLLBACK;\n         DBMS_OUTPUT.put_line ('ERROR:' || SQLCODE || ',' || SQLERRM);\n         DBMS_OUTPUT.PUT_LINE(       v_prcs_nm\n                            ||' - '||v_prcs_stp\n                            ||' - '||v_prcs_pram);\n         RETURN 2;\nEND;\n/",
            "upstream_dependencies": [],
            "downstream_dependencies": [],
            "dag_location": "null",
            "gantt_location": "null",
            "created_at": "null",
            "updated_at": "null"
        },
        {
            "name": "FN_GET_PAST_FUT_MTH",
            "encrypted_name": "1dde8113836b4c140d518174269b76a17964e12a8ce0be6e33ad286b22c5be85",
            "type": "function",
            "database": "null",
            "encrypted_database": "null",
            "schema": "XDMADM",
            "encrypted_schema": "0e03d5c46556a742ba46252698396ef2",
            "fully_qualified_name": "XDMADM.FN_GET_PAST_FUT_MTH",
            "encrypted_fqn": "0e03d5c46556a742ba46252698396ef2.1dde8113836b4c140d518174269b76a17964e12a8ce0be6e33ad286b22c5be85",
            "synonyms": [],
            "metadata_analysis": "CREATE OR REPLACE FUNCTION \"0e03d5c46556a742ba46252698396ef2\".\"1dde8113836b4c140d518174269b76a17964e12a8ce0be6e33ad286b22c5be85\" (p_fisc_yr_mth  IN VARCHAR2,\n                             p_num_mth      IN NUMBER)\n   RETURN VARCHAR2\n   DETERMINISTIC IS\n   l_fut_fisc_yr_mth    VARCHAR2(6);\n   l_past_fisc_yr_mth   VARCHAR2(6);\nBEGIN\n   SELECT fut_fisc_yr_mth, past_fisc_yr_mth\n     INTO l_fut_fisc_yr_mth, l_past_fisc_yr_mth\n     FROM (SELECT fisc_yr_mth,\n                  LEAD(fisc_yr_mth, ABS(p_num_mth), 0) OVER (ORDER BY fisc_yr_mth) fut_fisc_yr_mth,\n                  LAG(fisc_yr_mth, ABS(p_num_mth), 0) OVER (ORDER BY fisc_yr_mth) past_fisc_yr_mth\n             FROM (SELECT DISTINCT fisc_yr_mth FROM de459e2fe7f96e4d958537b31b946b26.c063519e87e23d735cdb53a35832f0ff))\n    WHERE fisc_yr_mth = p_fisc_yr_mth;\n\n   IF (p_num_mth > 0) THEN\n      RETURN l_fut_fisc_yr_mth;\n   ELSIF (p_num_mth < 0) THEN\n      RETURN l_past_fisc_yr_mth;\n   ELSE\n      RETURN p_fisc_yr_mth;\n   END IF;\nEND fn_get_past_fut_mth;\n/",
            "upstream_dependencies": [],
            "downstream_dependencies": [],
            "dag_location": "null",
            "gantt_location": "null",
            "created_at": "null",
            "updated_at": "null"
        },
        {
            "name": "FN_CHK_ACCRLS_LOADED",
            "encrypted_name": "39d5f42370644380b9c93da820f6235ad7f5fe5bee2d713e3e6f3e431ca8bf42",
            "type": "function",
            "database": "null",
            "encrypted_database": "null",
            "schema": "XDMADM",
            "encrypted_schema": "0e03d5c46556a742ba46252698396ef2",
            "fully_qualified_name": "XDMADM.FN_CHK_ACCRLS_LOADED",
            "encrypted_fqn": "0e03d5c46556a742ba46252698396ef2.39d5f42370644380b9c93da820f6235ad7f5fe5bee2d713e3e6f3e431ca8bf42",
            "synonyms": [],
            "metadata_analysis": "CREATE OR REPLACE FUNCTION \"0e03d5c46556a742ba46252698396ef2\".\"39d5f42370644380b9c93da820f6235ad7f5fe5bee2d713e3e6f3e431ca8bf42\"\nRETURN VARCHAR2 IS\n   \n\n\tl_return_val\tVARCHAR2(100);\n\tl_rbt_dt_p1\t\tDATE;\n\tl_accruals_dt\tDATE;\nBEGIN\n\n\tl_return_val := 'N';\n\n\tSELECT latest_prcs_dt+7\n\tINTO l_rbt_dt_p1\n\tFROM de459e2fe7f96e4d958537b31b946b26.0b3320d3f985cd20d1ec65d9dfeed2de\n\tWHERE fact_table='SALES_CORP'\n\tAND fact_typ_cd='RB'\n\tAND div_nbr=0;\n\n\tselect max(clndr_dt)\n\tinto l_accruals_dt\n\tfrom\n\t(\n\t  select max(de459e2fe7f96e4d958537b31b946b26.04dc4bcfc7c844c2f270ab37a87185d896db30e848b49b2cdadf713eac57e08a.f2de255a7553ba934b1f05ae7699ae4c) as max_fyw\n\t  from de459e2fe7f96e4d958537b31b946b26.04dc4bcfc7c844c2f270ab37a87185d896db30e848b49b2cdadf713eac57e08a ssma\n\t  where (de459e2fe7f96e4d958537b31b946b26.04dc4bcfc7c844c2f270ab37a87185d896db30e848b49b2cdadf713eac57e08a.5a946c48d4cb9b1b6880bf6386e276781d731bbdc4e3fb69a854112d4982eb99 <> 0 or de459e2fe7f96e4d958537b31b946b26.04dc4bcfc7c844c2f270ab37a87185d896db30e848b49b2cdadf713eac57e08a.6ec51d00c0df5a2c35ea4dc79b992a0ef4147ca167a57859c2f78f7521e7a9a8 <> 0)\n\n\t) a\n\tinner join de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001 tc on 24934fba42408e39f74a76ffdec4e8fa.8493610dc5a1410789d9d27235a22a6c=de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.fisc_yr_wk\n\twhere de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.222ccb1d1746bcdb2365f29b3da0b613 >= l_rbt_dt_p1;\n\n\tif(l_accruals_dt >= l_rbt_dt_p1) then\n\t\tl_return_val := 'Y';\n\tend if;\n\n\tRETURN l_return_val;\nEND fn_chk_accrls_loaded;\n/",
            "upstream_dependencies": [],
            "downstream_dependencies": [],
            "dag_location": "null",
            "gantt_location": "null",
            "created_at": "null",
            "updated_at": "null"
        },
        {
            "name": "FN_XDM_SALES_CORP_UPD_REG",
            "encrypted_name": "8a7dc331f2181d5e6ec25c055901932f7a31f0b52a1aadaf47b07f268906acad",
            "type": "function",
            "database": "null",
            "encrypted_database": "null",
            "schema": "XDMADM",
            "encrypted_schema": "0e03d5c46556a742ba46252698396ef2",
            "fully_qualified_name": "XDMADM.FN_XDM_SALES_CORP_UPD_REG",
            "encrypted_fqn": "0e03d5c46556a742ba46252698396ef2.8a7dc331f2181d5e6ec25c055901932f7a31f0b52a1aadaf47b07f268906acad",
            "synonyms": [],
            "metadata_analysis": "CREATE OR REPLACE FUNCTION \"0e03d5c46556a742ba46252698396ef2\".\"8a7dc331f2181d5e6ec25c055901932f7a31f0b52a1aadaf47b07f268906acad\" (\n                                P_IN_DIV_NBR    IN NUMBER,\n                                P_IN_SRC_TBL    IN VARCHAR2,\n                                P_IN_TGT_TBL    IN VARCHAR2,\n                                P_IN_START_DT   IN VARCHAR2,\n                                P_IN_END_DT     IN VARCHAR2,\n                                p_out_message   IN OUT VARCHAR2) RETURN NUMBER  IS\n\n\n   v_return_nbr              NUMBER         := 0;\n   v_err_msg                 VARCHAR2(32767) := NULL;\n   n_return_code             NUMBER         := 0;\n   v_return_message          VARCHAR2(32767) := NULL;\n\n   v_src_cnt                 NUMBER;\n   v_src_grs_sls             NUMBER;\n   v_src_qty_ship            NUMBER;\n   v_src_ttl_dvt             NUMBER;\n   v_src_np_alw              NUMBER;\n   v_src_np_chrg             NUMBER;\n   v_src_prd_alw             NUMBER;\n   v_src_prd_chrg            NUMBER;\n\n   v_tgt_cnt                 NUMBER;\n   v_tgt_grs_sls             NUMBER;\n   v_tgt_qty_ship            NUMBER;\n   v_tgt_ttl_dvt             NUMBER;\n   v_tgt_np_alw              NUMBER;\n   v_tgt_np_chrg             NUMBER;\n   v_tgt_prd_alw             NUMBER;\n   v_tgt_prd_chrg            NUMBER;\n\n   v_ins_sql1         VARCHAR2(32767);\n   v_ins_sql2         VARCHAR2(32767);\n   v_ins_sql3          VARCHAR2(32767);\n   v_ins_sql4          VARCHAR2(32767);\n   v_ins_sql5         VARCHAR2(32767);\n   v_ins_sql6         VARCHAR2(32767);\n\n   v_regtxn_sql1          VARCHAR2(32767);\n   v_regtxn_sql2         VARCHAR2(32767);\n   v_regtxn_sql3         VARCHAR2(32767);\n   v_regtxn_sql4         VARCHAR2(32767);\n   v_regtxn_sql5         VARCHAR2(32767);\n   v_regtxn_sql6    VARCHAR2(32767);\n\n   v_reg_addfilter_sql     VARCHAR2(32767);\n\n   v_div_nbr           NUMBER;\n   v_src_tbl           VARCHAR2(50);\n   v_tgt_tbl           VARCHAR2(50);\n   v_start_dt           VARCHAR2(12) := p_in_start_dt;\n   v_end_dt             VARCHAR2(12) := p_in_end_dt;\n   v_audt_sql1     VARCHAR2(2000);\n   v_audt_sql2     VARCHAR2(2000);\n\nBEGIN\n\n   v_div_nbr  := p_in_div_nbr;\n   v_src_tbl  := p_in_src_tbl;\n   v_tgt_tbl  := p_in_tgt_tbl;\n\nv_ins_sql1 := 'INSERT  INTO ' || v_tgt_tbl || ' (acct_typ_cd_actl, acct_typ_cd_desc_actl, actl_cst, actl_extnd, actl_gp, adj_markout, alw_chrg_cd, ' ||\n ' ap_cost, ap_gain, ap_vndr_nbr_actl, brk_srchrg, bsis_alw_amt, bsis_alw_applied, bsis_alw_ind, bsis_amt, carr_addr_txt, carr_alt_id, carr_alt_id_typ_cd, ' ||\n ' carr_city_nm, carr_cmnt, carr_cntct, carr_ctry_txt, carr_data_src_cd, carr_dot_nbr, carr_email_txt, carr_eqmt_mark_typ_cd, ' ||\n ' carr_fax_nbr, carr_inv_user_id, carr_motor_carr_nbr, carr_nm, carr_phn_nbr, carr_scac_cd, ';\n\nv_ins_sql2 := ' carr_st_cd, carr_stat_cd, carr_updt_dt, carr_updt_tm, carr_updt_user_id, carr_usf_nbr, carr_zip_cd, cde, cmpny_vndr_nbr_actl, cmsn_sls_extnd, ' ||\n ' cntrct_cpr_amt, cntrct_cpr_amt_ind, cntrct_cpr_bsis, cntrct_cpr_bsis_dt, cntrct_cpr_calc, cntrct_cpr_grp_typ, cntrct_cpr_nbr, cntrct_cpr_prod_grp, ' ||\n ' COMM_BSIS_AMT, corp_dvt_sls_base_rbt, corp_mlt_unit_desc_actl, corp_mlt_unit_nbr_actl, corp_non_dvt_sls_base_rbt, corp_prch_base_rbt, cr_dbt_rsn_cd, ' ||\n ' cr_dbt_rsn_desc, cr_memo_dlr, cr_memo_dt, cr_memo_dwa, cr_memo_nbr, cust_bus_seg_actl, cust_bus_seg_desc_actl, cust_nbr, cust_po_nbr, cust_prod_nbr, ' ||\n ' cust_sk, div_nbr, div_sk, dlvr_rte, dlvr_seq_nbr, drvr, dry_each, dry_unit, dry_wt, dstrct_cd_actl, dstrct_nm_actl, dstrct_sls_mgr_id_actl, ' ||\n ' dstrct_sls_mgr_nm_actl, ';\n\nv_ins_sql3 := ' dvt_cost_extnd, dwa_cost_extnd, each_conv_fctr, END_DAY_CD, each_ord, each_orig, each_prc, each_rsrv, each_ship, extnd_fctr, frght_cost, ' ||\n ' frz_each, frz_unit, frz_wt, gl_sbsys_cd, grs_sls_extnd, inside_pad, inv_actl_gp, inv_dt, inv_gp, inv_nbr, lagp_per_case, ldr, ldr_seq_nbr, ' ||\n ' ldr_tm, lic_prod_extnd, lic_tot_extnd, line_nbr, lnd_actl_gp, lnd_gp, loc_dvt_sls_base_rbt, loc_int_dvt, loc_mlt_unit_desc_actl, loc_mlt_unit_nbr_actl, '||\n ' loc_mrktng_alwnc_pgms, loc_non_dvt_sls_base_rbt, loc_one_tm, loc_prch_base_rbt, loc_prom_alwnc_pgms, loc_vndr_fnd_dvt, lpp, mkt_prod_extnd, ' ||\n ' mkt_tot_extnd, mrgn_bsis, natl_int_dvt, natl_mrktng_alwnc_pgms, natl_one_tm, natl_prom_alwnc_pgms, natl_vndr_fnd_dvt, net_sls_extnd, net_wt_ship, ' ||\n ' non_prod_alwnc, non_prod_alwnc_cd, non_prod_alwnc_desc, non_prod_chrg, non_prod_chrg_cd, non_prod_chrg_desc, ';\n\nv_ins_sql4 := ' ntv_cr_dbt_rsn_cd, ntv_cr_dbt_rsn_desc, ntv_ord_cls, ntv_ord_typ, ord_src, ord_tkr, orig_dwa_cost_extnd, orig_ldr_tm, orig_ord_dt, ' ||\n ' pick_slot_actl, pim_brnd_typ_actl, pim_brnd_typ_desc_actl, pim_cls_desc_actl, pim_cls_id_actl, pim_ctgry_desc_actl, ' ||\n ' pim_ctgry_id_actl, pim_grp_desc_actl, pim_grp_id_actl, pim_sk, pim_suprcls_desc_actl, pim_suprcls_id_actl, pim_usf_std_prod_cd, prc_mrgn, ' ||\n ' prc_src, prch_from_vndr_nbr_actl, prcs_dt, prime_aft_adj_dlr_amt, prime_aft_bsis_adj_amt, prime_aft_bsis_adj_ind, ' ||\n ' prime_bfr_adj_dlr_amt, prime_bfr_bsis_adj_amt, prime_bfr_bsis_adj_ind, prime_calc_ind, prime_cnh_cntrct_nbr, prime_cnh_prc_br_cd, ' ||\n ' prime_cns_cost_pt_mrk, prime_cns_cost_pt_rng, prime_cntrct_calc_bsis_amt, prime_cntrct_each_mrk_amt, prime_cntrct_each_mrk_typ, prime_cntrct_nm, ' ||\n ' prime_cntrct_prod_excpt_ind, prime_cost_by_po_nbr, prime_cust_prc_on_ind, prime_dvt_cost_amt, prime_dvt_cost_aply, prime_dvt_cost_typ, ';\n\nv_ins_sql5 := ' prime_dvtn_grp_nbr, prime_dvtn_grp_nm, prime_extnd_rbl_sis_amt, prime_frght_amt, prime_frght_bsis, prime_hcp_pim_cat, prime_hcp_pim_cls, ' ||\n' prime_hcp_pim_grp, prime_hcp_usf_std_prod_cd, prime_min_mrk_amt, prime_mrk_amt, prime_mrk_ind, prime_ord_orig_unit_prc, prime_prc_bsis, ' ||\n' prime_prc_bsis_amt, prime_prc_by, prime_prc_cost_tbl_eff_dt, prime_prc_cost_tbl_eff_tm, prime_rbl_sis_amt, prime_rbl_sis_mrgn, prime_rbl_sis_per, ' ||\n' prime_rnd_cd, prime_sbtyp_prc_by, prime_sis_flg, prime_updt_cyc, prnt_mlt_unit_cd_actl, prnt_mlt_unit_desc_actl, prod_alw, prod_alwnc_cd, ' ||\n' prod_alwnc_desc, prod_chrg, prod_chrg_cd, prod_chrg_desc, prod_nbr, prod_sk, prod_sls_tax, prod_stat_ind_actl, qty_dvt, qty_markout, qty_ord, ' ||\n' qty_orig, qty_rsrv, qty_ship, qty_subbed, rcrd_stat, rcvng_po_nbr, ';\n\nv_ins_sql6 := ' rep_cost_extnd, rfrgrt_each, rfrgrt_unit, rfrgrt_wt, rtd_ind, sample_ord_ind, ship_from, ship_to_id, sls_mrgn, sls_uom, srchrg, ' ||\n' sub_for, sub_prod_ind, tagp_per_case, tax_typ, tm_sk, trans_typ, trd_cls_actl, trtry_cd_actl, trtry_mgr_id_actl, trtry_mgr_nm_actl, ' ||\n' true_gp, true_mfr, ttl_alwnc, ttl_dvt, ttl_int_vndr_fnd_dvt, ttl_loc_alwnc, ttl_natl_alwnc, ttl_vndr_fnd_dvt, unfrm_qty_dvt, ' ||\n' unfrm_qty_markout, unfrm_qty_ord, unfrm_qty_orig, unfrm_qty_rsrv, unfrm_qty_ship, unfrm_qty_subbed, unit_ord, unit_orig, unit_prc, ' ||\n' unit_rsrv, unit_ship, xfer_from_dt, xfer_to_dt) ';\n\nv_regtxn_sql1 := ' SELECT acct_typ_cd_actl, acct_typ_cd_desc_actl, actl_cst, actl_extnd, actl_gp, adj_markout, alw_chrg_cd, ap_cost, ap_gain, ' ||\n' NVL(ap_vndr_nbr_actl,''0000000''), brk_srchrg, bsis_alw_amt, bsis_alw_applied, bsis_alw_ind, bsis_amt, carr_addr_txt, carr_alt_id, carr_alt_id_typ_cd, carr_city_nm, ' ||\n' carr_cmnt, carr_cntct, carr_ctry_txt, carr_data_src_cd, carr_dot_nbr, carr_email_txt, carr_eqmt_mark_typ_cd, carr_fax_nbr, carr_inv_user_id, ' ||\n' carr_motor_carr_nbr, carr_nm, carr_phn_nbr, carr_scac_cd, carr_st_cd, carr_stat_cd, carr_updt_dt, carr_updt_tm, carr_updt_user_id, ' ||\n' carr_usf_nbr, carr_zip_cd, cde, TO_NUMBER(NVL(cmpny_vndr_nbr_actl,0)), cmsn_sls_extnd, ';\n\nv_regtxn_sql2 := ' cntrct_cpr_amt, cntrct_cpr_amt_ind, cntrct_cpr_bsis, cntrct_cpr_bsis_dt, cntrct_cpr_calc, cntrct_cpr_grp_typ, ' ||\n' cntrct_cpr_nbr, cntrct_cpr_prod_grp, 0, corp_dvt_sls_base_rbt, corp_mlt_unit_desc_actl, corp_mlt_unit_nbr_actl, corp_non_dvt_sls_base_rbt, ' ||\n' corp_prch_base_rbt, cr_dbt_rsn_cd, cr_dbt_rsn_desc, cr_memo_dlr, cr_memo_dt, cr_memo_dwa, cr_memo_nbr, cust_bus_seg_actl, ' ||\n' cust_bus_seg_desc_actl, cust_nbr, cust_po_nbr, cust_prod_nbr, cust_sk, div_nbr, div_sk, dlvr_rte, dlvr_seq_nbr, drvr, dry_each, ' ||\n' dry_unit, dry_wt, dstrct_cd_actl, dstrct_nm_actl, dstrct_sls_mgr_id_actl, dstrct_sls_mgr_nm_actl, dvt_cost_extnd, dwa_cost_extnd, ' ||\n' each_conv_fctr, NULL, each_ord, each_orig, each_prc, each_rsrv, each_ship, extnd_fctr, frght_cost, ';\n\nv_regtxn_sql3 := ' frz_each, frz_unit, frz_wt, gl_sbsys_cd, grs_sls_extnd, inside_pad, inv_actl_gp, inv_dt, inv_gp, inv_nbr, lagp_per_case, ' ||\n' ldr, ldr_seq_nbr, ldr_tm, lic_prod_extnd, lic_tot_extnd, line_nbr, lnd_actl_gp, lnd_gp, loc_dvt_sls_base_rbt, loc_int_dvt, loc_mlt_unit_desc_actl, ' ||\n' loc_mlt_unit_nbr_actl, loc_mrktng_alwnc_pgms, loc_non_dvt_sls_base_rbt, loc_one_tm, loc_prch_base_rbt, loc_prom_alwnc_pgms, loc_vndr_fnd_dvt, ' ||\n' lpp, mkt_prod_extnd, mkt_tot_extnd, mrgn_bsis, natl_int_dvt, natl_mrktng_alwnc_pgms, natl_one_tm, natl_prom_alwnc_pgms, natl_vndr_fnd_dvt, ' ||\n' net_sls_extnd, net_wt_ship, non_prod_alwnc, non_prod_alwnc_cd, non_prod_alwnc_desc, non_prod_chrg, non_prod_chrg_cd, non_prod_chrg_desc, ' ||\n' ntv_cr_dbt_rsn_cd, ntv_cr_dbt_rsn_desc,  ntv_ord_cls, ntv_ord_typ, ';\n\nv_regtxn_sql4 := ' ord_src, ord_tkr, orig_dwa_cost_extnd, ldr_tm, orig_ord_dt, pick_slot_actl, NVL(pim_brnd_typ_actl,9), ' ||\n' NVL(pim_brnd_typ_desc_actl,''UNKNOWN''), NVL(pim_cls_desc_actl,''UNKNOWN''), NVL(pim_cls_id_actl,99999), NVL(pim_ctgry_desc_actl,''UNKNOWN''), ' ||\n' NVL(pim_ctgry_id_actl,99999),  NVL(pim_grp_desc_actl,''UNKNOWN''), NVL(pim_grp_id_actl,99999), pim_sk, NVL(pim_suprcls_desc_actl,''UNKNOWN''), ' ||\n' NVL(pim_suprcls_id_actl,99999), pim_usf_std_prod_cd, prc_mrgn, prc_src, NVL(prch_from_vndr_nbr_actl,''000000''), prcs_dt, prime_aft_adj_dlr_amt, ' ||\n' prime_aft_bsis_adj_amt, prime_aft_bsis_adj_ind, prime_bfr_adj_dlr_amt, prime_bfr_bsis_adj_amt, prime_bfr_bsis_adj_ind, ';\n\nv_regtxn_sql5 := ' prime_calc_ind, prime_cnh_cntrct_nbr, prime_cnh_prc_br_cd, prime_cns_cost_pt_mrk, prime_cns_cost_pt_rng, ' ||\n' prime_cntrct_calc_bsis_amt, prime_cntrct_each_mrk_amt, prime_cntrct_each_mrk_typ, prime_cntrct_nm, prime_cntrct_prod_excpt_ind, ' ||\n' prime_cost_by_po_nbr, prime_cust_prc_on_ind, prime_dvt_cost_amt, prime_dvt_cost_aply, prime_dvt_cost_typ, prime_dvtn_grp_nbr, prime_dvtn_grp_nm, ' ||\n' prime_extnd_rbl_sis_amt, prime_frght_amt, prime_frght_bsis, prime_hcp_pim_cat, prime_hcp_pim_cls, prime_hcp_pim_grp, ' ||\n' prime_hcp_usf_std_prod_cd, prime_min_mrk_amt, prime_mrk_amt, prime_mrk_ind, prime_ord_orig_unit_prc, prime_prc_bsis, prime_prc_bsis_amt, ' ||\n' prime_prc_by, prime_prc_cost_tbl_eff_dt, prime_prc_cost_tbl_eff_tm, prime_rbl_sis_amt, prime_rbl_sis_mrgn, prime_rbl_sis_per, ' ||\n' prime_rnd_cd, prime_sbtyp_prc_by, prime_sis_flg, prime_updt_cyc, prnt_mlt_unit_cd_actl, prnt_mlt_unit_desc_actl, ';\n\nIF v_div_nbr = '9999' THEN\nv_regtxn_sql6 := ' prod_alw, prod_alwnc_cd, prod_alwnc_desc, prod_chrg, prod_chrg_cd, prod_chrg_desc, prod_nbr, prod_sk, prod_sls_tax, ' ||\n' prod_stat_ind_actl, qty_dvt, qty_markout, qty_ord, qty_orig, qty_rsrv, qty_ship, qty_subbed, rcrd_stat, rcvng_po_nbr, ' ||\n' rep_cost_extnd, rfrgrt_each, rfrgrt_unit, rfrgrt_wt, rtd_ind, sample_ord_ind, ship_from, ship_to_id, sls_mrgn, sls_uom, srchrg, ' ||\n' sub_for, sub_prod_ind, tagp_per_case, tax_typ, tm_sk, trans_typ, trd_cls_actl, trtry_cd_actl, trtry_mgr_id_actl, trtry_mgr_nm_actl, ' ||\n' true_gp, NVL(true_mfr,0), ttl_alwnc, ttl_dvt, ttl_int_vndr_fnd_dvt, ttl_loc_alwnc, ttl_natl_alwnc, ttl_vndr_fnd_dvt, unfrm_qty_dvt, ' ||\n' unfrm_qty_markout, unfrm_qty_ord, unfrm_qty_orig, unfrm_qty_rsrv, unfrm_qty_ship, unfrm_qty_subbed, unit_ord, unit_orig, unit_prc, ' ||\n' unit_rsrv, unit_ship, xfer_from_dt, xfer_to_dt FROM ' || v_src_tbl || ' WHERE prcs_dt between ''' || v_start_dt || ''' AND ''' || v_end_dt || '''' ||\n' AND (trans_typ IN (''WC'',''VS'',''RT'',''CD'',''KS'',''TX'') ' ||\n' AND ((PROD_ALWNC_CD IS NULL AND PROD_CHRG_CD IS NULL OR PROD_ALWNC_CD=0 AND PROD_CHRG_CD=0) ' ||\n' OR (prod_nbr = ''NPAC0248'') ' ||\n' OR ( grs_sls_extnd>0 AND (prod_alw>0 OR prod_chrg >0))) ' ||\n' OR (prcs_dt between ''' || v_start_dt || ''' AND ''' || v_end_dt || ''' AND TRANS_TYP=''AN'' AND NVL(GRS_SLS_EXTND,0)<>0 )) ';\nELSE\nv_regtxn_sql6 := ' prod_alw, prod_alwnc_cd, prod_alwnc_desc, prod_chrg, prod_chrg_cd, prod_chrg_desc, prod_nbr, prod_sk, prod_sls_tax, ' ||\n' prod_stat_ind_actl, qty_dvt, qty_markout, qty_ord, qty_orig, qty_rsrv, qty_ship, qty_subbed, rcrd_stat, rcvng_po_nbr, ' ||\n' rep_cost_extnd, rfrgrt_each, rfrgrt_unit, rfrgrt_wt, rtd_ind, sample_ord_ind, ship_from, ship_to_id, sls_mrgn, sls_uom, srchrg, ' ||\n' sub_for, sub_prod_ind, tagp_per_case, tax_typ, tm_sk, trans_typ, trd_cls_actl, trtry_cd_actl, trtry_mgr_id_actl, trtry_mgr_nm_actl, ' ||\n' true_gp, NVL(true_mfr,0), ttl_alwnc, ttl_dvt, ttl_int_vndr_fnd_dvt, ttl_loc_alwnc, ttl_natl_alwnc, ttl_vndr_fnd_dvt, unfrm_qty_dvt, ' ||\n' unfrm_qty_markout, unfrm_qty_ord, unfrm_qty_orig, unfrm_qty_rsrv, unfrm_qty_ship, unfrm_qty_subbed, unit_ord, unit_orig, unit_prc, ' ||\n' unit_rsrv, unit_ship, xfer_from_dt, xfer_to_dt FROM ' || v_src_tbl || ' ' ||\n' WHERE div_nbr= ' || v_div_nbr ||\n' AND prcs_dt between ''' || v_start_dt || ''' AND ''' || v_end_dt || '''' ||\n' AND (trans_typ IN (''WC'',''VS'',''RT'',''CD'',''KS'',''TX'') ' ||\n' AND ((PROD_ALWNC_CD IS NULL AND PROD_CHRG_CD IS NULL OR PROD_ALWNC_CD=0 AND PROD_CHRG_CD=0) ' ||\n' OR (prod_nbr = ''NPAC0248'') ' ||\n' OR ( grs_sls_extnd>0 AND (prod_alw>0 OR prod_chrg >0))) ' ||\n' OR (prcs_dt between ''' || v_start_dt || ''' AND ''' || v_end_dt || ''' AND TRANS_TYP=''AN'' AND NVL(GRS_SLS_EXTND,0)<>0 )) ';\nEND IF;\n\nEXECUTE IMMEDIATE v_ins_sql1 || v_ins_sql2 || v_ins_sql3 || v_ins_sql4 || v_ins_sql5 || v_ins_sql6 || v_regtxn_sql1 || v_regtxn_sql2 || v_regtxn_sql3 ||\nv_regtxn_sql4 || v_regtxn_sql5 || v_regtxn_sql6 ; \n\nCOMMIT;\n\ndbms_output.put_line ('STEP 1: Load complete for reg txn');\n\n\n\nBEGIN\n\nIF v_div_nbr = '9999' THEN \nv_audt_sql1 := ' SELECT COUNT(*), SUM(NVL(GRS_SLS_EXTND,0)), SUM(NVL(QTY_SHIP,0)), SUM(NVL(TTL_DVT,0)), SUM(NVL(NON_PROD_ALWNC,0)), SUM(NVL(NON_PROD_CHRG,0)), SUM(NVL(PROD_ALW,0)), SUM(NVL(PROD_CHRG,0)) FROM '|| v_src_tbl ||\n              ' where prcs_dt between ''' || v_start_dt || ''' AND ''' || v_end_dt || '''' ||\n              ' AND (trans_typ IN (''WC'',''VS'',''RT'',''CD'',''KS'',''TX'') ' ||\n              ' AND ((PROD_ALWNC_CD IS NULL AND PROD_CHRG_CD IS NULL OR PROD_ALWNC_CD=0 AND PROD_CHRG_CD=0) ' ||\n              ' OR (prod_nbr = ''NPAC0248'') ' ||\n              ' OR ( grs_sls_extnd>0 AND (prod_alw>0 OR prod_chrg >0))) ' ||\n              ' OR (prcs_dt between ''' || v_start_dt || ''' AND ''' || v_end_dt || ''' AND TRANS_TYP=''AN'' AND NVL(GRS_SLS_EXTND,0)<>0 )) ';\n\nv_audt_sql2 := ' SELECT COUNT(*), SUM(NVL(GRS_SLS_EXTND,0)), SUM(NVL(QTY_SHIP,0)), SUM(NVL(TTL_DVT,0)), SUM(NVL(NON_PROD_ALWNC,0)), SUM(NVL(NON_PROD_CHRG,0)), SUM(NVL(PROD_ALW,0)), SUM(NVL(PROD_CHRG,0)) FROM '|| v_tgt_tbl ||\n              ' where prcs_dt between ''' || v_start_dt || ''' AND ''' || v_end_dt || '''' ||\n              ' AND (trans_typ IN (''WC'',''VS'',''RT'',''CD'',''KS'',''TX'') ' ||\n              ' AND ((PROD_ALWNC_CD IS NULL AND PROD_CHRG_CD IS NULL OR PROD_ALWNC_CD=0 AND PROD_CHRG_CD=0) ' ||\n              ' OR (prod_nbr = ''NPAC0248'') ' ||\n              ' OR ( grs_sls_extnd>0 AND (prod_alw>0 OR prod_chrg >0))) ' ||\n              ' OR (prcs_dt between ''' || v_start_dt || ''' AND ''' || v_end_dt || ''' AND TRANS_TYP=''AN'' AND NVL(GRS_SLS_EXTND,0)<>0 )) ';\nELSE\nv_audt_sql1 := ' SELECT COUNT(*), SUM(NVL(GRS_SLS_EXTND,0)), SUM(NVL(QTY_SHIP,0)), SUM(NVL(TTL_DVT,0)), SUM(NVL(NON_PROD_ALWNC,0)), SUM(NVL(NON_PROD_CHRG,0)), SUM(NVL(PROD_ALW,0)), SUM(NVL(PROD_CHRG,0)) FROM '|| v_src_tbl ||\n              ' WHERE div_nbr = ' || v_div_nbr ||\n              ' AND prcs_dt between ''' || v_start_dt || ''' AND ''' || v_end_dt || '''' ||\n              ' AND (trans_typ IN (''WC'',''VS'',''RT'',''CD'',''KS'',''TX'') ' ||\n              ' AND ((PROD_ALWNC_CD IS NULL AND PROD_CHRG_CD IS NULL OR PROD_ALWNC_CD=0 AND PROD_CHRG_CD=0) ' ||\n              ' OR (prod_nbr = ''NPAC0248'') ' ||\n              ' OR ( grs_sls_extnd>0 AND (prod_alw>0 OR prod_chrg >0))) ' ||\n              ' OR (prcs_dt between ''' || v_start_dt || ''' AND ''' || v_end_dt || ''' AND TRANS_TYP=''AN'' AND NVL(GRS_SLS_EXTND,0)<>0 )) ';\n\nv_audt_sql2 := ' SELECT COUNT(*), SUM(NVL(GRS_SLS_EXTND,0)), SUM(NVL(QTY_SHIP,0)), SUM(NVL(TTL_DVT,0)), SUM(NVL(NON_PROD_ALWNC,0)), SUM(NVL(NON_PROD_CHRG,0)), SUM(NVL(PROD_ALW,0)), SUM(NVL(PROD_CHRG,0)) FROM '|| v_tgt_tbl ||\n             ' WHERE div_nbr = ' || v_div_nbr ||\n            ' AND prcs_dt between ''' || v_start_dt || ''' AND ''' || v_end_dt || '''' ||\n            ' AND (trans_typ IN (''WC'',''VS'',''RT'',''CD'',''KS'',''TX'') ' ||\n            ' AND ((PROD_ALWNC_CD IS NULL AND PROD_CHRG_CD IS NULL OR PROD_ALWNC_CD=0 AND PROD_CHRG_CD=0) ' ||\n            ' OR (prod_nbr = ''NPAC0248'') ' ||\n            ' OR ( grs_sls_extnd>0 AND (prod_alw>0 OR prod_chrg >0))) ' ||\n            ' OR (prcs_dt between ''' || v_start_dt || ''' AND ''' || v_end_dt || ''' AND TRANS_TYP=''AN'' AND NVL(GRS_SLS_EXTND,0)<>0 )) ';\nEND IF;\n\n\nEXECUTE IMMEDIATE v_audt_sql1 INTO v_src_cnt, v_src_grs_sls, v_src_qty_ship, v_src_ttl_dvt, v_src_np_alw, v_src_np_chrg, v_src_prd_alw, v_src_prd_chrg;\n\nCOMMIT;\n\ndbms_output.put_line ('AUDIT STEP 1: complete first audit');\n\nEXECUTE IMMEDIATE v_audt_sql2 INTO v_tgt_cnt, v_tgt_grs_sls, v_tgt_qty_ship, v_tgt_ttl_dvt, v_tgt_np_alw, v_tgt_np_chrg, v_tgt_prd_alw, v_tgt_prd_chrg;\n\nCOMMIT;\n\ndbms_output.put_line ('AUDIT STEP 2: complete second audit');\n\nIF v_src_cnt > 0 THEN\n  IF (v_src_cnt = v_tgt_cnt) AND (v_src_grs_sls = v_tgt_grs_sls) AND (v_src_qty_ship = v_tgt_qty_ship) AND (v_src_ttl_dvt = v_tgt_ttl_dvt)\n  AND (v_src_np_alw = v_tgt_np_alw) AND (v_src_np_chrg = v_tgt_np_chrg) AND (v_src_prd_alw = v_tgt_prd_alw) AND (v_src_prd_chrg = v_tgt_prd_chrg) THEN\n    dbms_output.put_line ('src cnt ' || v_src_cnt || '; tgt cnt ' || v_tgt_cnt || '; ');\n    dbms_output.put_line ('src grs_sls ' || v_src_grs_sls || '; tgt grs_sls ' || v_tgt_grs_sls || '; ');\n    dbms_output.put_line ('src qty_ship ' || v_src_qty_ship || '; tgt qty_ship ' || v_tgt_qty_ship || '; ');\n    dbms_output.put_line ('src ttl_dvt ' || v_src_ttl_dvt || '; tgt ttl_dvt ' || v_tgt_ttl_dvt || '; ');\n    dbms_output.put_line ('v_src_np_alw ' || v_src_np_alw || '; v_tgt_np_alw ' || v_tgt_np_alw || '; ');\n    dbms_output.put_line ('v_src_np_chrg ' || v_src_np_chrg || '; v_tgt_np_chrg ' || v_tgt_np_chrg || '; ');\n    dbms_output.put_line ('v_src_prd_alw ' || v_src_prd_alw || '; v_tgt_prd_alw ' || v_tgt_prd_alw || '; ');\n    dbms_output.put_line ('v_src_prd_chrg ' || v_src_prd_chrg || '; v_tgt_prd_chrg ' || v_tgt_prd_chrg || '; ');\n\n    RETURN 0; \n  ELSE\n    DBMS_OUTPUT.PUT_LINE ('source count ' || v_src_cnt || ' target count ' || v_tgt_cnt || 'source grs sls ' || v_src_grs_sls || 'target grs sls ' ||\n    v_tgt_grs_sls || 'source qty ship ' || v_src_qty_ship || 'target qty ship ' || v_tgt_qty_ship || 'source ttl dvt ' || v_src_ttl_dvt ||\n    'target ttl dvt ' || v_tgt_ttl_dvt);\n    dbms_output.put_line ('v_src_np_alw ' || v_src_np_alw || '; v_tgt_np_alw ' || v_tgt_np_alw || '; ');\n    dbms_output.put_line ('v_src_np_chrg ' || v_src_np_chrg || '; v_tgt_np_chrg ' || v_tgt_np_chrg || '; ');\n    dbms_output.put_line ('v_src_prd_alw ' || v_src_prd_alw || '; v_tgt_prd_alw ' || v_tgt_prd_alw || '; ');\n    dbms_output.put_line ('v_src_prd_chrg ' || v_src_prd_chrg || '; v_tgt_prd_chrg ' || v_tgt_prd_chrg || '; ');\n    dbms_output.put_line (v_ins_sql1 || v_ins_sql2 || v_ins_sql3 || v_ins_sql4 || v_ins_sql5 || v_ins_sql6 || v_regtxn_sql1 || v_regtxn_sql2 || v_regtxn_sql3 ||\n  v_regtxn_sql4 || v_regtxn_sql5 || v_regtxn_sql6 || v_reg_addfilter_sql);\n    RETURN 20;\n  END IF;\nEND IF;\nRETURN 0; \n\nEND;\n\n\n  EXCEPTION\n    WHEN OTHERS THEN\n\n      p_out_message := '*ERROR in REG historical update script ' || SQLCODE || ' ' ||\n                       SQLERRM;\n      dbms_output.put_line(SQLCODE);\n      dbms_output.put_line(SQLERRM);\n      RETURN 20;\n\n\n\nEND FN_XDM_SALES_CORP_UPD_REG;\n/",
            "upstream_dependencies": [],
            "downstream_dependencies": [],
            "dag_location": "null",
            "gantt_location": "null",
            "created_at": "null",
            "updated_at": "null"
        },
        {
            "name": "FN_USR_DIV_ACTIVE_VPD",
            "encrypted_name": "67faf5712aecba41e5747be5cc71e72d582c2cac885aecb64ece08d1c6a748c5",
            "type": "function",
            "database": "null",
            "encrypted_database": "null",
            "schema": "XDMADM",
            "encrypted_schema": "0e03d5c46556a742ba46252698396ef2",
            "fully_qualified_name": "XDMADM.FN_USR_DIV_ACTIVE_VPD",
            "encrypted_fqn": "0e03d5c46556a742ba46252698396ef2.67faf5712aecba41e5747be5cc71e72d582c2cac885aecb64ece08d1c6a748c5",
            "synonyms": [],
            "metadata_analysis": "CREATE OR REPLACE FUNCTION \"0e03d5c46556a742ba46252698396ef2\".\"67faf5712aecba41e5747be5cc71e72d582c2cac885aecb64ece08d1c6a748c5\" (p_schema       IN VARCHAR2,\n                                                 p_objname      IN VARCHAR2)\n   RETURN VARCHAR2 AS\n   \n   c_start                CONSTANT NUMBER := DBMS_UTILITY.get_time;\n   c_fn_nm                CONSTANT VARCHAR2(30) := 'FN_USR_DIV_ACTIVE_VPD';\n   l_security_predicate   VARCHAR2(4000) DEFAULT NULL;\n   l_cur_sql              VARCHAR2(4000) := SYS_CONTEXT('USERENV', 'CURRENT_SQL');\n   l_sbjct_area VARCHAR2(100)\n         := SYS_CONTEXT(9751bbbcfea690cc0be4d58830a6fe2e.9bfb5eb7793dc8fa6800d5a61e5e3e4e1e2f6ec194927f064ce6cb31fba71a32.f4a54ebc6f2c591ed4266aafe66971af, 9751bbbcfea690cc0be4d58830a6fe2e.9bfb5eb7793dc8fa6800d5a61e5e3e4e1e2f6ec194927f064ce6cb31fba71a32.3b1288ed835b1b524e9500bb13544956e6e6300089dae5a98e31814d0406060f);\n   l_vpd_exempt VARCHAR2(1)\n         := SYS_CONTEXT(9751bbbcfea690cc0be4d58830a6fe2e.9bfb5eb7793dc8fa6800d5a61e5e3e4e1e2f6ec194927f064ce6cb31fba71a32.f4a54ebc6f2c591ed4266aafe66971af, 9751bbbcfea690cc0be4d58830a6fe2e.9bfb5eb7793dc8fa6800d5a61e5e3e4e1e2f6ec194927f064ce6cb31fba71a32.0eaf613ab52a53601d1496b5650de81e);\n   l_all_divs VARCHAR2(1)\n         := SYS_CONTEXT(9751bbbcfea690cc0be4d58830a6fe2e.9bfb5eb7793dc8fa6800d5a61e5e3e4e1e2f6ec194927f064ce6cb31fba71a32.f4a54ebc6f2c591ed4266aafe66971af, 9751bbbcfea690cc0be4d58830a6fe2e.9bfb5eb7793dc8fa6800d5a61e5e3e4e1e2f6ec194927f064ce6cb31fba71a32.0f460756ee76d4a2460733464cda5f95);\n   l_usr_div_all          VARCHAR2(5);\n   l_div_count            NUMBER := 0;\n   l_usr_div_date         VARCHAR2(11);\n   l_spcl_hndling         VARCHAR2(20) DEFAULT NULL;\n   l_div_nbr              NUMBER := 0;\n   l_first                BOOLEAN := TRUE;\n\n   CURSOR divs_c(p_user          VARCHAR2,\n                 p_sbjct_area    VARCHAR2) IS\n      SELECT 9751bbbcfea690cc0be4d58830a6fe2e.77f574c4275330a2ed961a49e2cb2df5.839c4ffb4bfaae1bb58eab4dee67d96a\n        FROM 9751bbbcfea690cc0be4d58830a6fe2e.77f574c4275330a2ed961a49e2cb2df5 ud, de459e2fe7f96e4d958537b31b946b26.dec387908a0954ddc8689c4ad37c8a3c dc\n       WHERE 9751bbbcfea690cc0be4d58830a6fe2e.77f574c4275330a2ed961a49e2cb2df5.839c4ffb4bfaae1bb58eab4dee67d96a = de459e2fe7f96e4d958537b31b946b26.dec387908a0954ddc8689c4ad37c8a3c.839c4ffb4bfaae1bb58eab4dee67d96a\n         AND usr_nm = p_user\n         AND sbjct_area IN (p_sbjct_area, 'ALL')\n         AND (de459e2fe7f96e4d958537b31b946b26.dec387908a0954ddc8689c4ad37c8a3c.2edfd837e0441242d7eed4e0cdf56652 IS NULL\n           OR de459e2fe7f96e4d958537b31b946b26.dec387908a0954ddc8689c4ad37c8a3c.6d74bb3e26f02dd707dc6b3b68070169 > SYSDATE);\n\n   divs_rec               divs_c%ROWTYPE;\n\n   CURSOR all_divs_c IS\n      SELECT \n             de459e2fe7f96e4d958537b31b946b26.dec387908a0954ddc8689c4ad37c8a3c.839c4ffb4bfaae1bb58eab4dee67d96a\n        FROM de459e2fe7f96e4d958537b31b946b26.dec387908a0954ddc8689c4ad37c8a3c dc\n       WHERE de459e2fe7f96e4d958537b31b946b26.dec387908a0954ddc8689c4ad37c8a3c.2edfd837e0441242d7eed4e0cdf56652 IS NULL\n          OR de459e2fe7f96e4d958537b31b946b26.dec387908a0954ddc8689c4ad37c8a3c.6d74bb3e26f02dd707dc6b3b68070169 > SYSDATE;\n\n   all_divs_rec           all_divs_c%ROWTYPE;\nBEGIN\n   \n\n   IF l_sbjct_area IS NULL THEN\n      l_security_predicate   := '1=2';\n      9751bbbcfea690cc0be4d58830a6fe2e.d4abe88ed2062b430c927bc84d61faf1f9a7aadf5998d448c2e2d1b0b47a3056.7d64937276682b23a0e16e5c61dad7aa('NO SA', c_fn_nm, USER, p_schema, p_objname, l_sbjct_area, l_vpd_exempt,\n      l_all_divs, l_cur_sql, l_security_predicate, (DBMS_UTILITY.get_time - c_start) / 100);\n\n      RETURN l_security_predicate;\n   END IF;\n\n   \n   \n\n   IF l_vpd_exempt = 'Y' THEN\n      l_security_predicate   := '1=1';\n      9751bbbcfea690cc0be4d58830a6fe2e.d4abe88ed2062b430c927bc84d61faf1f9a7aadf5998d448c2e2d1b0b47a3056.7d64937276682b23a0e16e5c61dad7aa('EXEMPT', c_fn_nm, USER, p_schema, p_objname, l_sbjct_area, l_vpd_exempt,\n      l_all_divs, l_cur_sql, l_security_predicate, (DBMS_UTILITY.get_time - c_start) / 100);\n\n      RETURN l_security_predicate;\n   END IF;\n\n   \n   \n\n   IF l_all_divs = 'Y' THEN\n      SELECT COUNT( * )\n        INTO l_div_count\n        FROM de459e2fe7f96e4d958537b31b946b26.dec387908a0954ddc8689c4ad37c8a3c dc\n       WHERE de459e2fe7f96e4d958537b31b946b26.dec387908a0954ddc8689c4ad37c8a3c.2edfd837e0441242d7eed4e0cdf56652 IS NULL\n          OR de459e2fe7f96e4d958537b31b946b26.dec387908a0954ddc8689c4ad37c8a3c.6d74bb3e26f02dd707dc6b3b68070169 > SYSDATE;\n\n      IF l_div_count > 0 THEN\n         l_first                := TRUE;\n\n         OPEN all_divs_c;\n\n         LOOP\n            FETCH all_divs_c INTO all_divs_rec;\n\n            EXIT WHEN all_divs_c%NOTFOUND;\n\n            IF l_first THEN\n               l_security_predicate   := 'DIV_NBR IN (' || 05809d328a80b20ac6b3d7abdb3f24ec.839c4ffb4bfaae1bb58eab4dee67d96a;\n               l_first                := FALSE;\n            ELSE\n               l_security_predicate   := l_security_predicate || ',' || 05809d328a80b20ac6b3d7abdb3f24ec.839c4ffb4bfaae1bb58eab4dee67d96a;\n            END IF;\n         END LOOP;\n\n         CLOSE all_divs_c;\n\n         l_security_predicate   := l_security_predicate || ')';\n      ELSE\n         l_security_predicate   := '1=2';\n      END IF;\n\n      9751bbbcfea690cc0be4d58830a6fe2e.d4abe88ed2062b430c927bc84d61faf1f9a7aadf5998d448c2e2d1b0b47a3056.7d64937276682b23a0e16e5c61dad7aa('ALL DIVS', c_fn_nm, USER, p_schema, p_objname, l_sbjct_area, l_vpd_exempt,\n      l_all_divs, l_cur_sql, l_security_predicate, (DBMS_UTILITY.get_time - c_start) / 100);\n\n      RETURN l_security_predicate;\n   END IF;\n\n   SELECT COUNT( * )\n     INTO l_div_count\n     FROM 9751bbbcfea690cc0be4d58830a6fe2e.77f574c4275330a2ed961a49e2cb2df5 ud, de459e2fe7f96e4d958537b31b946b26.dec387908a0954ddc8689c4ad37c8a3c dc\n    WHERE 9751bbbcfea690cc0be4d58830a6fe2e.77f574c4275330a2ed961a49e2cb2df5.839c4ffb4bfaae1bb58eab4dee67d96a = de459e2fe7f96e4d958537b31b946b26.dec387908a0954ddc8689c4ad37c8a3c.839c4ffb4bfaae1bb58eab4dee67d96a\n      AND UPPER(9751bbbcfea690cc0be4d58830a6fe2e.77f574c4275330a2ed961a49e2cb2df5.2487b33bfe363b72c30841fcf6b4451b) = USER\n      AND 9751bbbcfea690cc0be4d58830a6fe2e.77f574c4275330a2ed961a49e2cb2df5.39ebeb219ed1244dec0e84ff7af83631 IN (l_sbjct_area, 'ALL')\n      AND 9751bbbcfea690cc0be4d58830a6fe2e.77f574c4275330a2ed961a49e2cb2df5.839c4ffb4bfaae1bb58eab4dee67d96a IS NOT NULL\n      AND (de459e2fe7f96e4d958537b31b946b26.dec387908a0954ddc8689c4ad37c8a3c.2edfd837e0441242d7eed4e0cdf56652 IS NULL\n        OR de459e2fe7f96e4d958537b31b946b26.dec387908a0954ddc8689c4ad37c8a3c.6d74bb3e26f02dd707dc6b3b68070169 > SYSDATE);\n\n   IF l_div_count > 0 THEN\n      l_first                := TRUE;\n\n      OPEN divs_c(USER, l_sbjct_area);\n\n      LOOP\n         FETCH divs_c INTO divs_rec;\n\n         EXIT WHEN divs_c%NOTFOUND;\n\n         IF l_first THEN\n            l_security_predicate   := 'DIV_NBR IN (' || 5a219141042999aad7af812b50802575.839c4ffb4bfaae1bb58eab4dee67d96a;\n            l_first                := FALSE;\n         ELSE\n            l_security_predicate   := l_security_predicate || ',' || 5a219141042999aad7af812b50802575.839c4ffb4bfaae1bb58eab4dee67d96a;\n         END IF;\n      END LOOP;\n\n      CLOSE divs_c;\n\n      l_security_predicate   := l_security_predicate || ')';\n   ELSE\n      l_security_predicate   := '1=2';\n   END IF;\n\n   9751bbbcfea690cc0be4d58830a6fe2e.d4abe88ed2062b430c927bc84d61faf1f9a7aadf5998d448c2e2d1b0b47a3056.7d64937276682b23a0e16e5c61dad7aa('USR DIV', c_fn_nm, USER, p_schema, p_objname, l_sbjct_area, l_vpd_exempt,\n   l_all_divs, l_cur_sql, l_security_predicate, (DBMS_UTILITY.get_time - c_start) / 100);\n\n   RETURN l_security_predicate;\nEXCEPTION\n   WHEN OTHERS THEN\n      l_security_predicate   := '1=2';\n      9751bbbcfea690cc0be4d58830a6fe2e.d4abe88ed2062b430c927bc84d61faf1f9a7aadf5998d448c2e2d1b0b47a3056.7d64937276682b23a0e16e5c61dad7aa(SQLCODE || '-' || SQLERRM, c_fn_nm, USER, p_schema, p_objname, l_sbjct_area,\n      l_vpd_exempt, NULL, l_cur_sql, l_security_predicate, (DBMS_UTILITY.get_time - c_start) / 100);\n\n      RETURN l_security_predicate;\nEND fn_usr_div_active_vpd;\n/",
            "upstream_dependencies": [],
            "downstream_dependencies": [],
            "dag_location": "null",
            "gantt_location": "null",
            "created_at": "null",
            "updated_at": "null"
        },
        {
            "name": "FN_PYR_SLS_STAT_UPD",
            "encrypted_name": "fa8a486fd546ccab5d60f10a50cd63055008558fdc75dc9de9ea5a7b736a0d84",
            "type": "function",
            "database": "null",
            "encrypted_database": "null",
            "schema": "XDMADM",
            "encrypted_schema": "0e03d5c46556a742ba46252698396ef2",
            "fully_qualified_name": "XDMADM.FN_PYR_SLS_STAT_UPD",
            "encrypted_fqn": "0e03d5c46556a742ba46252698396ef2.fa8a486fd546ccab5d60f10a50cd63055008558fdc75dc9de9ea5a7b736a0d84",
            "synonyms": [],
            "metadata_analysis": "CREATE OR REPLACE FUNCTION \"0e03d5c46556a742ba46252698396ef2\".\"fa8a486fd546ccab5d60f10a50cd63055008558fdc75dc9de9ea5a7b736a0d84\" (odate IN DATE)\n   RETURN NUMBER AS\n   \n   v_sun_dt                   DATE;\n   v_sql                        VARCHAR2(2000);\n   e_no_rec_updated     EXCEPTION;\n\n  BEGIN\n\n            \n            SELECT TRUNC(NEXT_DAY(to_date(to_char(odate,'yyyymmdd'),'yyyymmdd'),'SUN'))-7 INTO v_sun_dt FROM dual;\n\n            UPDATE de459e2fe7f96e4d958537b31b946b26.0b3320d3f985cd20d1ec65d9dfeed2de\n            SET div_load_ts = TRUNC(v_sun_dt) \n            WHERE fact_table = 6726798abbc757d8442516fefb8c40e9.716900750ba6b5d499e5b9bc59348974;\n\n            IF (sql%ROWCOUNT = 0) THEN\n                     RAISE e_no_rec_updated;\n            END if;\n\n           COMMIT;\n           RETURN 0;\n\n  EXCEPTION\n      WHEN E_NO_REC_UPDATED THEN\n     DBMS_OUTPUT.put_line('ERROR in the fn_pyr_sls_upd_dt function. No record found in FACT_LOAD_STAT table to update.');\n      RETURN 1;\n     WHEN OTHERS THEN\n     DBMS_OUTPUT.put_line('ERROR in the fn_pyr_sls_upd_dt function. FACT_LOAD_STAT table was not updated with Sunday date.');\n      RETURN 1;\nEND;\n/",
            "upstream_dependencies": [],
            "downstream_dependencies": [],
            "dag_location": "null",
            "gantt_location": "null",
            "created_at": "null",
            "updated_at": "null"
        },
        {
            "name": "FN_DOLLARS_BY_PYR_SEG_LOAD",
            "encrypted_name": "9e8ebfa5ad793019faa2c6d2cf5206de52dc5054daf0cd3164b795b2e61c4560",
            "type": "function",
            "database": "null",
            "encrypted_database": "null",
            "schema": "XDMADM",
            "encrypted_schema": "0e03d5c46556a742ba46252698396ef2",
            "fully_qualified_name": "XDMADM.FN_DOLLARS_BY_PYR_SEG_LOAD",
            "encrypted_fqn": "0e03d5c46556a742ba46252698396ef2.9e8ebfa5ad793019faa2c6d2cf5206de52dc5054daf0cd3164b795b2e61c4560",
            "synonyms": [],
            "metadata_analysis": "CREATE OR REPLACE FUNCTION \"0e03d5c46556a742ba46252698396ef2\".\"9e8ebfa5ad793019faa2c6d2cf5206de52dc5054daf0cd3164b795b2e61c4560\" (P_IN_ODATE   IN VARCHAR2)\n   RETURN NUMBER IS\n\n \n\n  \n\n\n\n    v_const         NUMBER := 2 ;\n    v_end_dt        DATE;\n    v_strt_dt       DATE;\n    v_odate         DATE := to_date(p_in_odate,'YYYYMMDD');\n    v_prcs_stp      VARCHAR2(2000);\n    v_ldr_tm        NUMBER(20);\n    v_out_msg       VARCHAR2(256);\n\n   v_dba_func_msg   VARCHAR2(2000) := 'oXo';\n   dml_err_cnt      NUMBER;\n\n\n\n   l_start              NUMBER;\n   l_end                NUMBER;\n   v_table_owner       VARCHAR2(40) := 'XDMADM'; \n   v_table_name1        VARCHAR2(40) := 'DOLLARS_BY_PYR_SEG'; \n\n\n BEGIN\n\n\n\n\n  \n  \n  BEGIN\n       v_prcs_stp := 'INSERT INTO table starts ';\n       l_start := DBMS_UTILITY.get_time;\n\n        DBMS_OUTPUT.PUT_LINE('TIME ' || to_char(sysdate, 'yyyymmdd hh24:mi:ss'));\n\n    INSERT    INTO de459e2fe7f96e4d958537b31b946b26.ba14007a01f75b8e8b4274a5b262c17d56faed417eee791d565438865e909e90\n                                      (\n                                        SLS_DIV_NBR               ,\n                                        BRNCH_CD                ,\n                                        DIV_NBR                 ,\n                                        FISC_YR                 ,\n                                        FISC_MTH_OF_YR          ,\n                                        PYR_SEG_CD              ,\n                                        GL_ACCT_CD              ,\n                                        CUST_ACCTBLTY_FLG       ,\n                                        CUST_NATL_MNGD_FLG      ,\n                                        GRS_SLS_EXTND           ,\n                                        DWA_COST_EXTND          ,\n                                        NATL_ONE_TM             ,\n                                        NATL_PROM_ALWNC_PGMS    ,\n                                        LOC_MRKTNG_ALWNC_PGMS   ,\n                                        LOC_ONE_TM              ,\n                                        LOC_PROM_ALWNC_PGMS     ,\n                                        NATL_MRKTNG_ALWNC_PGMS  ,\n                                        RBT_LOC_ACCRL_AMT       ,\n                                        RBT_NATL_ACCRL_AMT      ,\n                                        RBT_LOC_EXP_AMT         ,\n                                        RBT_NATL_EXP_AMT        ,\n                                        LOC_INT_DVT             ,\n                                        LOC_VNDR_FND_DVT        ,\n                                        NATL_INT_DVT            ,\n                                        NATL_VNDR_FND_DVT       ,\n                                        TTL_AC                  ,\n                                        LDR_TM\n                                        )\n\n    SELECT * FROM (\n     WITH x1 AS ( SELECT\n            sls_div_nbr,\n            div_nbr,\n            fisc_yr,\n            fisc_mth_of_yr,\n            pyr_seg_cd,\n            gl_acct_cd,\n            cust_acctblty_flg,\n            cust_natl_mngd_flg,\n            SUM(NVL(grs_sls_extnd, 0))          grs_sls_extnd,\n            SUM(NVL(dwa_cost_extnd, 0))         dwa_cost_extnd,\n            SUM(NVL(natl_one_tm, 0))            natl_one_tm,\n            SUM(NVL(natl_prom_alwnc_pgms, 0))   natl_prom_alwnc_pgms,\n            SUM(NVL(loc_mrktng_alwnc_pgms, 0))  loc_mrktng_alwnc_pgms,\n            SUM(NVL(loc_one_tm, 0))             loc_one_tm,\n            SUM(NVL(loc_prom_alwnc_pgms, 0))    loc_prom_alwnc_pgms,\n            SUM(NVL( natl_mrktng_alwnc_pgms, 0)) natl_mrktng_alwnc_pgms,\n            SUM(NVL(rbt_loc_accrl_amt, 0))       rbt_loc_accrl_amt,\n            SUM(NVL(rbt_natl_accrl_amt, 0))      rbt_natl_accrl_amt,\n            SUM(NVL(rbt_loc_exp_amt, 0))         rbt_loc_exp_amt,\n            SUM(NVL(rbt_natl_exp_amt, 0))        rbt_natl_exp_amt,\n            SUM(loc_int_dvt )       loc_int_dvt,\n            SUM(loc_vndr_fnd_dvt )  loc_vndr_fnd_dvt,\n            SUM(natl_int_dvt)       natl_int_dvt,\n            SUM(natl_vndr_fnd_dvt ) natl_vndr_fnd_dvt,\n            SUM ( ttl_ac) TTL_AC ,\n            LDR_TM\n       FROM cases_and_dollars_temp\n       group by sls_div_nbr,\n            div_nbr,\n            fisc_yr,\n            fisc_mth_of_yr,\n            pyr_seg_cd,\n            gl_acct_cd,\n            cust_acctblty_flg,\n            cust_natl_mngd_flg,\n            LDR_TM)  ,\n     d1 AS (SELECT div_nbr, brnch_cd\n                   FROM de459e2fe7f96e4d958537b31b946b26.dec387908a0954ddc8689c4ad37c8a3c )\n       SELECT\n                    4d17aefd8ee04921f0f8678925c7372f.e3837b6b258b429fa00c148694e11e48      ,\n                    6b596d9776e346450614d112280d0dc0.4855453efe73ff0bd0f7583df58260dd         ,\n                    4d17aefd8ee04921f0f8678925c7372f.839c4ffb4bfaae1bb58eab4dee67d96a          ,\n                    4d17aefd8ee04921f0f8678925c7372f.ab30d6d679879cfacfe389b97d1d3f0e          ,\n                    4d17aefd8ee04921f0f8678925c7372f.e1d446673288adb6d5f219d0aa82d37a   ,\n                    4d17aefd8ee04921f0f8678925c7372f.156f54b388a4986aa3d3d8e74d0fc0cd       ,\n                    4d17aefd8ee04921f0f8678925c7372f.ca8a7733395de053698a2360e88439fa       ,\n                    4d17aefd8ee04921f0f8678925c7372f.318678c82ff4517124bc3a6b8506d59463f2fe9cc6b573bb859641780443a51b  ,\n                    4d17aefd8ee04921f0f8678925c7372f.e33988f12139bfc93f1e7557137feb5a29e110ac67769beb8c9647cf15a66d38 ,\n                    4d17aefd8ee04921f0f8678925c7372f.2ee1400a0150f0b220dd7bd6268d1e66,\n                    4d17aefd8ee04921f0f8678925c7372f.c6c7cc45578c678907522e08bb04a4ca,\n                    4d17aefd8ee04921f0f8678925c7372f.11da749d2c0d1e21a4c413489daad454,\n                    4d17aefd8ee04921f0f8678925c7372f.7321a4c88369e6acc22f8952a98e86b3e7fabc080d1e698e1941d756c183e979,\n                    4d17aefd8ee04921f0f8678925c7372f.3f5f78a3c918316a0e68170dc6b81e0c7ea8b5b6353c726ed7e410e230c7898b,\n                    4d17aefd8ee04921f0f8678925c7372f.42c87cd307c51e63a144309315721b09,\n                    4d17aefd8ee04921f0f8678925c7372f.df0917aa3fd36489aa4d308fa97b06b76398e8624834825f4604477ca9ac3d8a,\n                    4d17aefd8ee04921f0f8678925c7372f.5e937026da90c7e4a4e0bb540e061948eed1259e6b62783c664a0bc2e5e255a4,\n                    4d17aefd8ee04921f0f8678925c7372f.5a946c48d4cb9b1b6880bf6386e276781d731bbdc4e3fb69a854112d4982eb99,\n                    4d17aefd8ee04921f0f8678925c7372f.6ec51d00c0df5a2c35ea4dc79b992a0ef4147ca167a57859c2f78f7521e7a9a8,\n                    4d17aefd8ee04921f0f8678925c7372f.bb26587da7cde1ca1883d4ac6949a349,\n                    4d17aefd8ee04921f0f8678925c7372f.d2a9879c73e438cd42a66e4ee567caf5e32f6dd38f333cde68119d1f277367cd,\n                    4d17aefd8ee04921f0f8678925c7372f.931b2ac4399b8a337f8d0ff67bab0e15,\n                    4d17aefd8ee04921f0f8678925c7372f.c137fdd918ede20e07fec7282883fa34e32f6dd38f333cde68119d1f277367cd,\n                    4d17aefd8ee04921f0f8678925c7372f.42dd45423319f918e704ed37d4dbb128,\n                    4d17aefd8ee04921f0f8678925c7372f.b5019e4009d6240fe25b80db390c07601d731bbdc4e3fb69a854112d4982eb99,\n                    4d17aefd8ee04921f0f8678925c7372f.a87435385247bee13eab05ca4ab0c093 ,\n                    4d17aefd8ee04921f0f8678925c7372f.721a8ad171b31ae60261431ccd51b52d\n                FROM x1, d1\n               WHERE 4d17aefd8ee04921f0f8678925c7372f.e3837b6b258b429fa00c148694e11e48 = 6b596d9776e346450614d112280d0dc0.839c4ffb4bfaae1bb58eab4dee67d96a );\n\n\n      l_end := DBMS_UTILITY.get_time;\n\n\n      DBMS_OUTPUT.PUT_LINE('NO OF ROWS INSERTED:' || sql%rowcount ) ;\n\n      DBMS_OUTPUT.PUT_LINE ( round( (l_end - l_start)/100, 2 ) ||' seconds...' );\n      COMMIT;\n       RETURN 0;\n    exception\n      WHEN OTHERS\n      THEN\n        DBMS_OUTPUT.PUT_LINE('Error in v_prcs_stp:'||v_prcs_stp || SQLCODE || SQLERRM );\n\n\n\n         RETURN 701;\n    END;\n\n\n   \n   \n   \n\n    EXCEPTION\n      WHEN OTHERS\n      THEN\n     ROLLBACK;\n     DBMS_OUTPUT.PUT_LINE(SQLCODE);\n     DBMS_OUTPUT.PUT_LINE(SQLERRM);\n\n    DBMS_OUTPUT.put_line('Error in function FN_DOLLARS_BY_PYR_SEG_LOAD');\n    RETURN 600;\n\n\n\nEND FN_DOLLARS_BY_PYR_SEG_LOAD;\n/",
            "upstream_dependencies": [],
            "downstream_dependencies": [],
            "dag_location": "null",
            "gantt_location": "null",
            "created_at": "null",
            "updated_at": "null"
        },
        {
            "name": "FN_SALES_UNITS_BY_PYRAMID",
            "encrypted_name": "bc4b8ccf623a6b72fc92a248fc75707e73e172255a2c6a0709be80f80681fa64",
            "type": "function",
            "database": "null",
            "encrypted_database": "null",
            "schema": "XDMADM",
            "encrypted_schema": "0e03d5c46556a742ba46252698396ef2",
            "fully_qualified_name": "XDMADM.FN_SALES_UNITS_BY_PYRAMID",
            "encrypted_fqn": "0e03d5c46556a742ba46252698396ef2.bc4b8ccf623a6b72fc92a248fc75707e73e172255a2c6a0709be80f80681fa64",
            "synonyms": [],
            "metadata_analysis": "CREATE OR REPLACE FUNCTION \"0e03d5c46556a742ba46252698396ef2\".\"bc4b8ccf623a6b72fc92a248fc75707e73e172255a2c6a0709be80f80681fa64\" (odate IN VARCHAR2)\n   RETURN NUMBER AS\n   v_liner                CHAR(1) := 'L';\n   v_gl_acct              VARCHAR2(7);\n   v_dept                 VARCHAR2(10);\n   v_amt                  NUMBER(16, 2);\n   v_amount               VARCHAR2(30);\n   v_desc                 VARCHAR2(100);\n   v_branch_cd            VARCHAR2(10);\n   v_filler               CHAR(1) := '|';\n   v_header_rec           VARCHAR2(40);\n   v_liner_rec            VARCHAR2(75);\n   v_control_rec          VARCHAR2(60);\n   v_trunc_ret            NUMBER(3);\n   v_out_msg              VARCHAR(200);\n   v_select_cnt           NUMBER;\n   all_exceptions exception;\n   e_truncate_table exception;\n\n   CURSOR c_branch_cd IS\n        SELECT DISTINCT brnch_cd\n          FROM de459e2fe7f96e4d958537b31b946b26.91f821cfdbb6a39ab01ef55b1215fadc8272dc7ebbea1dd40b6f8487d4f4b5ed\n      ORDER BY brnch_cd; \n\n   TYPE r_cursor \n                IS REF CURSOR;\n\n   c_rec                  r_cursor;\n   v_jrnl_dt              DATE;\n   v_hdr_rec_type         CHAR(1) := 'H';\n   v_hdr_jrnl_dt          VARCHAR2(8);\n   v_hdr_rev_cd           CHAR(1) := 'N';\n   v_hdr_rev_dt           VARCHAR2(8) := '|';\n   v_src                  CHAR(3) := 'ST3';\n   v_trans_ref_num        VARCHAR2(8) := '|';\n   v_ctl_rec_type         CHAR(1) := 'C';\n   v_ctl_units            NUMBER(26, 2);\n   v_tot_dbt              NUMBER(16, 2) := 0;\n   v_ctl_units_chr        VARCHAR2(30);\n   v_ctl_lines            VARCHAR2(30);\n   v_tbl_owner            VARCHAR2(30) := 'xdmadm';\n   v_tbl_nm               VARCHAR2(30) := 'SALES_UNITS_PYR_SEG';\n   v_sql                  VARCHAR2(6000);\n   v_last_fisc_wk_of_yr   NUMBER;\n   v_min_fisc_wk_dt       DATE;\n   v_max_fisc_wk_dt       DATE;\nBEGIN\n   EXECUTE IMMEDIATE 'alter session set nls_date_format = ''YYYYMMDD''';\n\n   SELECT MIN(clndr_dt), MAX(clndr_dt) \n     INTO v_min_fisc_wk_dt, v_max_fisc_wk_dt\n     FROM de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001\n    WHERE fisc_yr_wk = (SELECT fisc_yr_wk\n                          FROM de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001\n                         WHERE clndr_dt = (SELECT clndr_dt_wkago\n                                             FROM de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001\n                                            WHERE clndr_dt = TO_DATE(odate, 'YYYYMMDD')));\n\n   DBMS_OUTPUT.Put_Line( 'Min Date: ' || v_min_fisc_wk_dt );\n   DBMS_OUTPUT.Put_Line( 'Max Date: ' || v_max_fisc_wk_dt );\n\n   v_hdr_jrnl_dt   := TO_CHAR(v_max_fisc_wk_dt, 'MMDDYYYY');\n   v_jrnl_dt       := v_max_fisc_wk_dt;\n   DBMS_OUTPUT.put_line('Truncating the table ' || v_tbl_nm);\n   v_trunc_ret     := 8e64339f96bb08058f5d52f1c04f954a.8ffe4678890c39c7d4ed38c2ed759e24.e4b5db2b3f9b19accbb8cddbfcd05bac(v_out_msg, v_tbl_owner, v_tbl_nm);\n   \n   DBMS_OUTPUT.put_line(v_out_msg);\n\n   IF v_trunc_ret != 0 THEN\n      DBMS_OUTPUT.put_line('Error in Truncating ' || v_tbl_nm || ' table');\n      RAISE e_truncate_table;\n   END IF;\n\n   INSERT INTO de459e2fe7f96e4d958537b31b946b26.91f821cfdbb6a39ab01ef55b1215fadc8272dc7ebbea1dd40b6f8487d4f4b5ed \n                                         (brnch_cd, pyr_seg_cd_actl, gl_account, dept, statistic_amount, descr,\n                                          div_typ_cd, journal_dt)\n        SELECT brnch_cd,\n               pyr_seg_cd_actl,\n               gl_account,\n               dept,\n               ROUND(SUM(statistic_amount), 2) statistic_amount,\n               descr,\n               div_typ_cd,\n               TO_DATE(v_jrnl_dt, 'YYYYMMDD') \n          FROM (SELECT 503e5bca9f89192fda7def0b8f40adce.4855453efe73ff0bd0f7583df58260dd, \n                       503e5bca9f89192fda7def0b8f40adce.839c4ffb4bfaae1bb58eab4dee67d96a,\n                       503e5bca9f89192fda7def0b8f40adce.b8c6ab19cb6e726c38f24d1885346ea3,\n                       NVL(de459e2fe7f96e4d958537b31b946b26.711f5f4c350254b40ce960d47ae1ab08fc3a5c81683f41af2951fae7621d4729.c2b9ebe664db8cfc1f7a702af0630a5b, 'UNK') pyr_seg_cd_actl,\n                       503e5bca9f89192fda7def0b8f40adce.e3837b6b258b429fa00c148694e11e48,\n                       503e5bca9f89192fda7def0b8f40adce.b83cf9a3eda24a1c45531d79b7aa292e,\n                       CASE\n                          WHEN 503e5bca9f89192fda7def0b8f40adce.839c4ffb4bfaae1bb58eab4dee67d96a = 503e5bca9f89192fda7def0b8f40adce.e3837b6b258b429fa00c148694e11e48\n                           AND 503e5bca9f89192fda7def0b8f40adce.b8c6ab19cb6e726c38f24d1885346ea3 = 'CC'\n                           AND de459e2fe7f96e4d958537b31b946b26.711f5f4c350254b40ce960d47ae1ab08fc3a5c81683f41af2951fae7621d4729.b8ee9f6c896415acdd760daefea08893 = 'N' THEN\n                             '9010220'\n                          ELSE\n                             de459e2fe7f96e4d958537b31b946b26.711f5f4c350254b40ce960d47ae1ab08fc3a5c81683f41af2951fae7621d4729.f91fd5eae8d27d72b6ab5179e897097f\n                       END\n                          gl_account,\n                       503e5bca9f89192fda7def0b8f40adce.f8db600f9bfb9a0f23f9406f188499fbe32f6dd38f333cde68119d1f277367cd,\n                       de459e2fe7f96e4d958537b31b946b26.711f5f4c350254b40ce960d47ae1ab08fc3a5c81683f41af2951fae7621d4729.6ef3e4abc0d5bd2c29714f3162369e44,\n                       de459e2fe7f96e4d958537b31b946b26.711f5f4c350254b40ce960d47ae1ab08fc3a5c81683f41af2951fae7621d4729.b8ee9f6c896415acdd760daefea08893\n                  FROM       (  SELECT NVL(de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.a2b201123c685e8cc48b5468cb4a449361bbd7bc0d2d67c7d7b11cb0a8d18d03, de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.839c4ffb4bfaae1bb58eab4dee67d96a) sls_div_nbr,\n                                       de459e2fe7f96e4d958537b31b946b26.dec387908a0954ddc8689c4ad37c8a3c.4855453efe73ff0bd0f7583df58260dd,\n                                       de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.839c4ffb4bfaae1bb58eab4dee67d96a,\n                                       de459e2fe7f96e4d958537b31b946b26.dec387908a0954ddc8689c4ad37c8a3c.b8c6ab19cb6e726c38f24d1885346ea3,\n                                       de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.c2b9ebe664db8cfc1f7a702af0630a5b,\n                                       CASE\n                                          WHEN de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.3f2fdebe4ba3a24bdf16fdac5827ebfb = 1 THEN '901'\n                                          WHEN de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.3f2fdebe4ba3a24bdf16fdac5827ebfb = 2 THEN '902'\n                                          WHEN de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.3f2fdebe4ba3a24bdf16fdac5827ebfb = 3 THEN '903'\n                                          WHEN de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.3f2fdebe4ba3a24bdf16fdac5827ebfb = 4 THEN '904'\n                                          WHEN de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.3f2fdebe4ba3a24bdf16fdac5827ebfb = 5 THEN '905'\n                                          WHEN de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.3f2fdebe4ba3a24bdf16fdac5827ebfb = 6 THEN '906' \n                                       END\n                                          dept,\n                                       SUM(de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.ccf8d88f2d37f3171da2121ab22e9330) statistic_amount,\n                                       CASE WHEN NVL(de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.a2b201123c685e8cc48b5468cb4a449361bbd7bc0d2d67c7d7b11cb0a8d18d03, de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.839c4ffb4bfaae1bb58eab4dee67d96a) = de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.839c4ffb4bfaae1bb58eab4dee67d96a THEN 'Y' ELSE 'N' END\n                                          delivered_type\n                                  FROM de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c s, de459e2fe7f96e4d958537b31b946b26.dec387908a0954ddc8689c4ad37c8a3c d, de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001 t\n                                 WHERE NVL(de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.a2b201123c685e8cc48b5468cb4a449361bbd7bc0d2d67c7d7b11cb0a8d18d03, de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.839c4ffb4bfaae1bb58eab4dee67d96a) = de459e2fe7f96e4d958537b31b946b26.dec387908a0954ddc8689c4ad37c8a3c.839c4ffb4bfaae1bb58eab4dee67d96a\n                                   AND de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.f5dd4374a3e3af6a775cb6d6b22e8162 = de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.222ccb1d1746bcdb2365f29b3da0b613\n                                   AND de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.f5dd4374a3e3af6a775cb6d6b22e8162 >= v_min_fisc_wk_dt \n                                   AND de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.f5dd4374a3e3af6a775cb6d6b22e8162 <= v_max_fisc_wk_dt\n                                   AND de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.224811ad2521818a46ceb20442ea1122 IS NULL\n                                   AND de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.b391f718d41b76652cd5f0d0063372b5 = '1'\n                                   AND (de459e2fe7f96e4d958537b31b946b26.dec387908a0954ddc8689c4ad37c8a3c.b8c6ab19cb6e726c38f24d1885346ea3 IN ('CC', 'USF') \n                                                                      \n                                       )\n                              GROUP BY NVL(de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.a2b201123c685e8cc48b5468cb4a449361bbd7bc0d2d67c7d7b11cb0a8d18d03, de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.839c4ffb4bfaae1bb58eab4dee67d96a),\n                                       de459e2fe7f96e4d958537b31b946b26.dec387908a0954ddc8689c4ad37c8a3c.b8c6ab19cb6e726c38f24d1885346ea3,\n                                       de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.839c4ffb4bfaae1bb58eab4dee67d96a,\n                                       de459e2fe7f96e4d958537b31b946b26.dec387908a0954ddc8689c4ad37c8a3c.4855453efe73ff0bd0f7583df58260dd,\n                                       de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.c2b9ebe664db8cfc1f7a702af0630a5b,\n                                       de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.3f2fdebe4ba3a24bdf16fdac5827ebfb,\n                                       CASE WHEN NVL(de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.a2b201123c685e8cc48b5468cb4a449361bbd7bc0d2d67c7d7b11cb0a8d18d03, de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.839c4ffb4bfaae1bb58eab4dee67d96a) = de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c.839c4ffb4bfaae1bb58eab4dee67d96a THEN 'Y' ELSE 'N' END)\n                             x1\n                          LEFT OUTER JOIN\n                             de459e2fe7f96e4d958537b31b946b26.711f5f4c350254b40ce960d47ae1ab08fc3a5c81683f41af2951fae7621d4729 x2\n                          ON 503e5bca9f89192fda7def0b8f40adce.c2b9ebe664db8cfc1f7a702af0630a5b = de459e2fe7f96e4d958537b31b946b26.711f5f4c350254b40ce960d47ae1ab08fc3a5c81683f41af2951fae7621d4729.c2b9ebe664db8cfc1f7a702af0630a5b\n                         AND 503e5bca9f89192fda7def0b8f40adce.b8ee9f6c896415acdd760daefea08893 = de459e2fe7f96e4d958537b31b946b26.711f5f4c350254b40ce960d47ae1ab08fc3a5c81683f41af2951fae7621d4729.b8ee9f6c896415acdd760daefea08893 \n                       INNER JOIN\n                          de459e2fe7f96e4d958537b31b946b26.dec387908a0954ddc8689c4ad37c8a3c x3\n                       ON de459e2fe7f96e4d958537b31b946b26.711f5f4c350254b40ce960d47ae1ab08fc3a5c81683f41af2951fae7621d4729.b8c6ab19cb6e726c38f24d1885346ea3 = de459e2fe7f96e4d958537b31b946b26.dec387908a0954ddc8689c4ad37c8a3c.b8c6ab19cb6e726c38f24d1885346ea3\n                      AND NVL(503e5bca9f89192fda7def0b8f40adce.e3837b6b258b429fa00c148694e11e48, 503e5bca9f89192fda7def0b8f40adce.839c4ffb4bfaae1bb58eab4dee67d96a) = de459e2fe7f96e4d958537b31b946b26.dec387908a0954ddc8689c4ad37c8a3c.839c4ffb4bfaae1bb58eab4dee67d96a)\n      GROUP BY brnch_cd,\n               pyr_seg_cd_actl,\n               gl_account,\n               dept,\n               descr,\n               div_typ_cd\n      ORDER BY brnch_cd,\n               pyr_seg_cd_actl,\n               gl_account,\n               dept,\n               descr,\n               div_typ_cd;\n\n   COMMIT;\n\n   SELECT COUNT( * ) INTO v_select_cnt FROM de459e2fe7f96e4d958537b31b946b26.91f821cfdbb6a39ab01ef55b1215fadc8272dc7ebbea1dd40b6f8487d4f4b5ed;\n\n   IF (v_select_cnt = 0) THEN\n      DBMS_OUTPUT.put_line('SELECT COUNT FROM SALES IS ZERO. CANNOT CONTINUE.');\n      RETURN 1;\n   ELSE\n      DBMS_OUTPUT.put_line('SELECT COUNT FROM SALES IS ' || v_select_cnt);\n   END IF;\n\n   DBMS_OUTPUT.put_line('\\n');\n\n   OPEN c_branch_cd;\n\n   LOOP\n      FETCH c_branch_cd INTO v_branch_cd;\n\n      EXIT WHEN c_branch_cd%NOTFOUND;\n      DBMS_OUTPUT.put_line(   '&'\n                           || v_hdr_rec_type\n                           || RPAD(v_branch_cd, 5, '|')\n                           || v_hdr_jrnl_dt\n                           || v_hdr_rev_cd\n                           || RPAD(v_hdr_rev_dt, 8, '|')\n                           || v_src\n                           || RPAD(v_trans_ref_num, 8, '|'));\n      DBMS_OUTPUT.put_line('\\n');\n\n      OPEN c_rec FOR\n           SELECT gl_account,\n                  dept,\n                  statistic_amount,\n                  descr\n             FROM de459e2fe7f96e4d958537b31b946b26.91f821cfdbb6a39ab01ef55b1215fadc8272dc7ebbea1dd40b6f8487d4f4b5ed\n            WHERE brnch_cd = v_branch_cd\n         ORDER BY brnch_cd, pyr_seg_cd_actl, dept;\n\n      SELECT COUNT( * )\n        INTO v_ctl_lines\n        FROM de459e2fe7f96e4d958537b31b946b26.91f821cfdbb6a39ab01ef55b1215fadc8272dc7ebbea1dd40b6f8487d4f4b5ed\n       WHERE brnch_cd = v_branch_cd;\n\n      SELECT SUM(statistic_amount)\n        INTO v_ctl_units\n        FROM de459e2fe7f96e4d958537b31b946b26.91f821cfdbb6a39ab01ef55b1215fadc8272dc7ebbea1dd40b6f8487d4f4b5ed\n       WHERE brnch_cd = v_branch_cd;\n\n      LOOP\n         FETCH c_rec\n         INTO v_gl_acct,\n              v_dept,\n              v_amt,\n              v_desc;\n\n         EXIT WHEN c_rec%NOTFOUND;\n\n         IF v_amt < 0 THEN\n            v_amount   := TO_CHAR(v_amt, '0974bd77c72a65187abc8bc25789f749.0fd9b1b09e98d1ff2c64f2eb4d831712');\n         ELSE\n            v_amount   := TO_CHAR(v_amt, '02dcf8480dfff8fd09b3b7ba70916b69.0fd9b1b09e98d1ff2c64f2eb4d831712');\n         END IF;\n\n         DBMS_OUTPUT.put_line(   '&'\n                              || v_liner\n                              || RPAD(v_branch_cd, 5, '|')\n                              || RPAD(v_gl_acct, 10, '|')\n                              || RPAD(v_dept, 10, '|')\n                              || v_filler\n                              || v_amount\n                              || RPAD(v_desc, 30, '|'));\n         DBMS_OUTPUT.put_line('\\n');\n      END LOOP;\n\n      IF v_ctl_units < 0 THEN\n         v_ctl_units_chr   := TO_CHAR(v_ctl_units, '2950f257fd616435a20a67e0787632cc6023a7656c91f403f471af63618eeefd.0fd9b1b09e98d1ff2c64f2eb4d831712');\n      ELSE\n         v_ctl_units_chr   := TO_CHAR(v_ctl_units, '2950f257fd616435a20a67e0787632cc7c8dce5087e41ca6e605ae61d35bc678.0fd9b1b09e98d1ff2c64f2eb4d831712');\n      END IF;\n\n      DBMS_OUTPUT.put_line(   '&'\n                           || v_ctl_rec_type\n                           || RPAD(v_branch_cd, 5, '|')\n                           || v_filler\n                           || TO_CHAR(v_tot_dbt, '02dcf8480dfff8fd09b3b7ba70916b69.0fd9b1b09e98d1ff2c64f2eb4d831712')\n                           || v_filler\n                           || v_ctl_units_chr\n                           || TO_CHAR(v_ctl_lines, 'FM000000000'));\n      DBMS_OUTPUT.put_line('\\n');\n\n      CLOSE c_rec;\n   END LOOP;\n\n   CLOSE c_branch_cd;\n\n   RETURN 0;\nEXCEPTION\n   WHEN OTHERS THEN\n      DBMS_OUTPUT.put_line(SQLERRM);\n      RETURN SQLCODE;\nEND fn_sales_units_by_pyramid;\n/",
            "upstream_dependencies": [],
            "downstream_dependencies": [],
            "dag_location": "null",
            "gantt_location": "null",
            "created_at": "null",
            "updated_at": "null"
        },
        {
            "name": "FN_PO_AUDIT_PURGE",
            "encrypted_name": "38e2e6b465cdcfbd4267a8dc910289d81431321105d18065ee9acc870d010d5b",
            "type": "function",
            "database": "null",
            "encrypted_database": "null",
            "schema": "XDMADM",
            "encrypted_schema": "0e03d5c46556a742ba46252698396ef2",
            "fully_qualified_name": "XDMADM.FN_PO_AUDIT_PURGE",
            "encrypted_fqn": "0e03d5c46556a742ba46252698396ef2.38e2e6b465cdcfbd4267a8dc910289d81431321105d18065ee9acc870d010d5b",
            "synonyms": [],
            "metadata_analysis": "CREATE OR REPLACE FUNCTION \"0e03d5c46556a742ba46252698396ef2\".\"38e2e6b465cdcfbd4267a8dc910289d81431321105d18065ee9acc870d010d5b\"\n  ( months_to_keep_i   NUMBER    \n  )\n\n\n\n  RETURN NUMBER\n  IS\n\n\n  \n\n    v_message                       VARCHAR2(2054);\n    g_how_many                      INTEGER;\n    v_sqlcode                       NUMBER;\n    g_purge_date                    DATE;\n    g_hdr_deletes                   NUMBER;\n    g_dtl_deletes                   NUMBER;\n\n \n \n  BEGIN\n\n    DBMS_OUTPUT.PUT_LINE('BEGIN at ' || to_char(sysdate, 'yyyymmdd hh24:mi:ss'));\n    DBMS_OUTPUT.PUT_LINE('Months to retain: ' || months_to_keep_i);\n    g_hdr_deletes  := 0;\n    g_dtl_deletes  := 0;\n\n\n\n    BEGIN\n        select add_months(TRUNC(sysdate), -months_to_keep_i)\n        INTO g_purge_date\n        from dual;\n    EXCEPTION\n        WHEN OTHERS THEN\n           dbms_output.put_line('INVALID INPUT PARM, JOB ABORTING');\n           RETURN 1;\n    END;\n\n    DBMS_OUTPUT.PUT_LINE('Purging records prior to: ' || g_purge_date);\n    DELETE FROM de459e2fe7f96e4d958537b31b946b26.b5d3e1877fb725f97fa73c9e35d75025\n    WHERE entry_dt < g_purge_date;\n    g_hdr_deletes := SQL%ROWCOUNT;\n\n    DELETE FROM de459e2fe7f96e4d958537b31b946b26.55eb0ceb38de6c239d23588281f8196b\n    WHERE entry_dt < g_purge_date;\n    g_dtl_deletes := SQL%ROWCOUNT;\n\n    DBMS_OUTPUT.PUT_LINE('Hdr Deletes: ' || g_hdr_deletes);\n    DBMS_OUTPUT.PUT_LINE('Dtl Deletes: ' || g_dtl_deletes);\n    DBMS_OUTPUT.PUT_LINE('END at ' || to_char(sysdate, 'yyyymmdd hh24:mi:ss'));\n    COMMIT;\n    RETURN 0;\n EXCEPTION\n           WHEN OTHERS THEN\n                v_sqlcode := SQLCODE;\n                v_message :=  ' fn_po_audit_purge sqlerror ' || v_sqlcode || ' ' || SUBSTR(SQLERRM, 1, 75);\n                dbms_output.put_line(v_message);\n                RETURN 1;\n  END fn_po_audit_purge;\n/",
            "upstream_dependencies": [],
            "downstream_dependencies": [],
            "dag_location": "null",
            "gantt_location": "null",
            "created_at": "null",
            "updated_at": "null"
        },
        {
            "name": "FN_CUST_CLS_WKLY",
            "encrypted_name": "04b60e9fcf522f8ae0ac9ad879895e77e32f6dd38f333cde68119d1f277367cd",
            "type": "function",
            "database": "null",
            "encrypted_database": "null",
            "schema": "XDMADM",
            "encrypted_schema": "0e03d5c46556a742ba46252698396ef2",
            "fully_qualified_name": "XDMADM.FN_CUST_CLS_WKLY",
            "encrypted_fqn": "0e03d5c46556a742ba46252698396ef2.04b60e9fcf522f8ae0ac9ad879895e77e32f6dd38f333cde68119d1f277367cd",
            "synonyms": [],
            "metadata_analysis": "CREATE OR REPLACE FUNCTION \"0e03d5c46556a742ba46252698396ef2\".\"04b60e9fcf522f8ae0ac9ad879895e77e32f6dd38f333cde68119d1f277367cd\" (v_in_odate IN VARCHAR2)\n   RETURN NUMBER IS\n   \n\n   \n   v_odate                        DATE := TO_DATE(v_in_odate, 'YYYYMMDD');\n   v_end_dt                       DATE;\n   v_fisc_mth_strt_dt             DATE;\n   v_fisc_mth_end_dt              DATE;\n   v_fisc_mth_strt_dt_yrago       DATE;\n   v_fisc_mth_end_dt_yrago        DATE;\n   v_fisc_yr                      NUMBER(4);\n   v_fisc_mth_of_yr               VARCHAR2(2);\n   v_fisc_wk_of_yr                NUMBER(2);\n   v_py_max_wk                    NUMBER(2);\n   v_last_fisc_mth_of_yr          NUMBER;\n   v_fisc_yr_last_mth             NUMBER;\n   v_last_fisc_mth_strt_dt        DATE;\n   v_fisc_yr_mth                  NUMBER;\n   v_prd_strt_dt                  DATE;\n   v_prd_end_dt                   DATE;\n   v_fisc_yr_mth_six_mth_ago      VARCHAR2(18);\n   v_fisc_yr_mth_three_mth_ago    VARCHAR2(18);\n   v_fisc_mth_strt_dt_6_mth_ago   DATE;\n   v_fisc_mth_strt_dt_3_mth_ago   DATE;\n   v_fisc_wk_strt_dt              DATE;\n   v_fisc_wk_end_dt               DATE;\n   v_net_acct_pim_suprcls_id      NUMBER;\n\n   \n   CURSOR next_clsfctn(c_last_fisc_mth_strt_dt IN DATE,\n                       c_fisc_mth_strt_dt IN DATE) IS\n      SELECT de459e2fe7f96e4d958537b31b946b26.1127751f1872aa967342f1fcf6b2ff72e472b097974b0d6a9a7d2ed170324906.7f599f836c449bebb92bb9757e86c603 cust_sk,\n             de459e2fe7f96e4d958537b31b946b26.1127751f1872aa967342f1fcf6b2ff72e472b097974b0d6a9a7d2ed170324906.839c4ffb4bfaae1bb58eab4dee67d96a div_nbr,\n             de459e2fe7f96e4d958537b31b946b26.1127751f1872aa967342f1fcf6b2ff72e472b097974b0d6a9a7d2ed170324906.852fa1e9f02f1ca2c75837f7146b2381 cust_nbr,\n             de459e2fe7f96e4d958537b31b946b26.1127751f1872aa967342f1fcf6b2ff72e472b097974b0d6a9a7d2ed170324906.ab30d6d679879cfacfe389b97d1d3f0e fisc_yr,\n             de459e2fe7f96e4d958537b31b946b26.1127751f1872aa967342f1fcf6b2ff72e472b097974b0d6a9a7d2ed170324906.e1d446673288adb6d5f219d0aa82d37a fisc_mth_of_yr,\n             de459e2fe7f96e4d958537b31b946b26.1127751f1872aa967342f1fcf6b2ff72e472b097974b0d6a9a7d2ed170324906.d3ec1a21507970329af1c66ef244cdefe32f6dd38f333cde68119d1f277367cd fisc_mth_strt_dt,\n             de459e2fe7f96e4d958537b31b946b26.1127751f1872aa967342f1fcf6b2ff72e472b097974b0d6a9a7d2ed170324906.8a5c1eda3416fa5daae04a2980452d8a,\n             de459e2fe7f96e4d958537b31b946b26.1127751f1872aa967342f1fcf6b2ff72e472b097974b0d6a9a7d2ed170324906.e1d446673288adb6d5f219d0aa82d37a next_fisc_mth_of_yr,\n             NVL(de459e2fe7f96e4d958537b31b946b26.1127751f1872aa967342f1fcf6b2ff72e472b097974b0d6a9a7d2ed170324906.8a5c1eda3416fa5daae04a2980452d8a, 'OTHER') next_fisc_mth_cust_clsfctn,\n             de459e2fe7f96e4d958537b31b946b26.1127751f1872aa967342f1fcf6b2ff72e472b097974b0d6a9a7d2ed170324906.60c87cc02b8c8cefb8bba2a977223d5f38ee6547beafb256a1079a3b44ded48f nbr_of_wk_ordr_this_yr_mth,\n             NVL(de459e2fe7f96e4d958537b31b946b26.1127751f1872aa967342f1fcf6b2ff72e472b097974b0d6a9a7d2ed170324906.60c87cc02b8c8cefb8bba2a977223d5f38ee6547beafb256a1079a3b44ded48f, 0) nbr_of_wk_ordr_next_fisc_mth,\n             NVL(de459e2fe7f96e4d958537b31b946b26.1127751f1872aa967342f1fcf6b2ff72e472b097974b0d6a9a7d2ed170324906.afcae1f8310cd038c0633aeaa179c10c280a4c8731f60bb762471fb74030c9a2, 0) next_fmth_unfrm_grs_sls_extnd,\n             NVL(de459e2fe7f96e4d958537b31b946b26.1127751f1872aa967342f1fcf6b2ff72e472b097974b0d6a9a7d2ed170324906.56d34efa4c0a22d07b3f8a07122ca048, 0) next_fmth_unfrm_tagp,\n             NVL(de459e2fe7f96e4d958537b31b946b26.1127751f1872aa967342f1fcf6b2ff72e472b097974b0d6a9a7d2ed170324906.37175a70b8190fbf717de5f6ebc49b0a, 0) next_fmth_unfrm_grs_tgp, \n             NVL(de459e2fe7f96e4d958537b31b946b26.1127751f1872aa967342f1fcf6b2ff72e472b097974b0d6a9a7d2ed170324906.ccf8d88f2d37f3171da2121ab22e9330, 0) next_fmth_unfrm_qty_ship\n        FROM de459e2fe7f96e4d958537b31b946b26.1127751f1872aa967342f1fcf6b2ff72e472b097974b0d6a9a7d2ed170324906 c1, de459e2fe7f96e4d958537b31b946b26.1127751f1872aa967342f1fcf6b2ff72e472b097974b0d6a9a7d2ed170324906 c2\n       WHERE de459e2fe7f96e4d958537b31b946b26.1127751f1872aa967342f1fcf6b2ff72e472b097974b0d6a9a7d2ed170324906.839c4ffb4bfaae1bb58eab4dee67d96a = de459e2fe7f96e4d958537b31b946b26.1127751f1872aa967342f1fcf6b2ff72e472b097974b0d6a9a7d2ed170324906.839c4ffb4bfaae1bb58eab4dee67d96a(+)\n         AND de459e2fe7f96e4d958537b31b946b26.1127751f1872aa967342f1fcf6b2ff72e472b097974b0d6a9a7d2ed170324906.852fa1e9f02f1ca2c75837f7146b2381 = de459e2fe7f96e4d958537b31b946b26.1127751f1872aa967342f1fcf6b2ff72e472b097974b0d6a9a7d2ed170324906.852fa1e9f02f1ca2c75837f7146b2381(+)\n         AND de459e2fe7f96e4d958537b31b946b26.1127751f1872aa967342f1fcf6b2ff72e472b097974b0d6a9a7d2ed170324906.d3ec1a21507970329af1c66ef244cdefe32f6dd38f333cde68119d1f277367cd = v_last_fisc_mth_strt_dt\n         AND de459e2fe7f96e4d958537b31b946b26.1127751f1872aa967342f1fcf6b2ff72e472b097974b0d6a9a7d2ed170324906.cb5e253886eb30a93e66cbf95203a754 = 0\n         AND de459e2fe7f96e4d958537b31b946b26.1127751f1872aa967342f1fcf6b2ff72e472b097974b0d6a9a7d2ed170324906.d3ec1a21507970329af1c66ef244cdefe32f6dd38f333cde68119d1f277367cd(+) = v_fisc_mth_strt_dt;\n\n   \n\n   CURSOR third_clsfctn(c_fisc_mth_strt_dt_3_mth_ago IN DATE,\n                        c_fisc_mth_strt_dt IN DATE) IS\n      SELECT de459e2fe7f96e4d958537b31b946b26.1127751f1872aa967342f1fcf6b2ff72e472b097974b0d6a9a7d2ed170324906.7f599f836c449bebb92bb9757e86c603 cust_sk,\n             de459e2fe7f96e4d958537b31b946b26.1127751f1872aa967342f1fcf6b2ff72e472b097974b0d6a9a7d2ed170324906.839c4ffb4bfaae1bb58eab4dee67d96a div_nbr,\n             de459e2fe7f96e4d958537b31b946b26.1127751f1872aa967342f1fcf6b2ff72e472b097974b0d6a9a7d2ed170324906.852fa1e9f02f1ca2c75837f7146b2381 cust_nbr,\n             de459e2fe7f96e4d958537b31b946b26.1127751f1872aa967342f1fcf6b2ff72e472b097974b0d6a9a7d2ed170324906.ab30d6d679879cfacfe389b97d1d3f0e fisc_yr,\n             de459e2fe7f96e4d958537b31b946b26.1127751f1872aa967342f1fcf6b2ff72e472b097974b0d6a9a7d2ed170324906.e1d446673288adb6d5f219d0aa82d37a fisc_mth_of_yr,\n             de459e2fe7f96e4d958537b31b946b26.1127751f1872aa967342f1fcf6b2ff72e472b097974b0d6a9a7d2ed170324906.d3ec1a21507970329af1c66ef244cdefe32f6dd38f333cde68119d1f277367cd fisc_mth_strt_dt,\n             de459e2fe7f96e4d958537b31b946b26.1127751f1872aa967342f1fcf6b2ff72e472b097974b0d6a9a7d2ed170324906.8a5c1eda3416fa5daae04a2980452d8a,\n             de459e2fe7f96e4d958537b31b946b26.1127751f1872aa967342f1fcf6b2ff72e472b097974b0d6a9a7d2ed170324906.e1d446673288adb6d5f219d0aa82d37a next_fisc_mth_of_yr,\n             NVL(de459e2fe7f96e4d958537b31b946b26.1127751f1872aa967342f1fcf6b2ff72e472b097974b0d6a9a7d2ed170324906.8a5c1eda3416fa5daae04a2980452d8a, 'OTHER') third_fisc_mth_cust_clsfctn\n        FROM de459e2fe7f96e4d958537b31b946b26.1127751f1872aa967342f1fcf6b2ff72e472b097974b0d6a9a7d2ed170324906 c1, de459e2fe7f96e4d958537b31b946b26.1127751f1872aa967342f1fcf6b2ff72e472b097974b0d6a9a7d2ed170324906 c2\n       WHERE de459e2fe7f96e4d958537b31b946b26.1127751f1872aa967342f1fcf6b2ff72e472b097974b0d6a9a7d2ed170324906.839c4ffb4bfaae1bb58eab4dee67d96a = de459e2fe7f96e4d958537b31b946b26.1127751f1872aa967342f1fcf6b2ff72e472b097974b0d6a9a7d2ed170324906.839c4ffb4bfaae1bb58eab4dee67d96a(+)\n         AND de459e2fe7f96e4d958537b31b946b26.1127751f1872aa967342f1fcf6b2ff72e472b097974b0d6a9a7d2ed170324906.852fa1e9f02f1ca2c75837f7146b2381 = de459e2fe7f96e4d958537b31b946b26.1127751f1872aa967342f1fcf6b2ff72e472b097974b0d6a9a7d2ed170324906.852fa1e9f02f1ca2c75837f7146b2381(+)\n         AND de459e2fe7f96e4d958537b31b946b26.1127751f1872aa967342f1fcf6b2ff72e472b097974b0d6a9a7d2ed170324906.d3ec1a21507970329af1c66ef244cdefe32f6dd38f333cde68119d1f277367cd = v_fisc_mth_strt_dt_3_mth_ago\n         AND de459e2fe7f96e4d958537b31b946b26.1127751f1872aa967342f1fcf6b2ff72e472b097974b0d6a9a7d2ed170324906.cb5e253886eb30a93e66cbf95203a754 = 0\n         AND de459e2fe7f96e4d958537b31b946b26.1127751f1872aa967342f1fcf6b2ff72e472b097974b0d6a9a7d2ed170324906.d3ec1a21507970329af1c66ef244cdefe32f6dd38f333cde68119d1f277367cd(+) = v_fisc_mth_strt_dt;\n\n   \n   CURSOR sixth_clsfctn(c_fisc_mth_strt_dt_6_mth_ago IN DATE,\n                        c_fisc_mth_strt_dt IN DATE) IS\n      SELECT de459e2fe7f96e4d958537b31b946b26.1127751f1872aa967342f1fcf6b2ff72e472b097974b0d6a9a7d2ed170324906.7f599f836c449bebb92bb9757e86c603 cust_sk,\n             de459e2fe7f96e4d958537b31b946b26.1127751f1872aa967342f1fcf6b2ff72e472b097974b0d6a9a7d2ed170324906.839c4ffb4bfaae1bb58eab4dee67d96a div_nbr,\n             de459e2fe7f96e4d958537b31b946b26.1127751f1872aa967342f1fcf6b2ff72e472b097974b0d6a9a7d2ed170324906.852fa1e9f02f1ca2c75837f7146b2381 cust_nbr,\n             de459e2fe7f96e4d958537b31b946b26.1127751f1872aa967342f1fcf6b2ff72e472b097974b0d6a9a7d2ed170324906.ab30d6d679879cfacfe389b97d1d3f0e fisc_yr,\n             de459e2fe7f96e4d958537b31b946b26.1127751f1872aa967342f1fcf6b2ff72e472b097974b0d6a9a7d2ed170324906.e1d446673288adb6d5f219d0aa82d37a fisc_mth_of_yr,\n             de459e2fe7f96e4d958537b31b946b26.1127751f1872aa967342f1fcf6b2ff72e472b097974b0d6a9a7d2ed170324906.d3ec1a21507970329af1c66ef244cdefe32f6dd38f333cde68119d1f277367cd fisc_mth_strt_dt,\n             de459e2fe7f96e4d958537b31b946b26.1127751f1872aa967342f1fcf6b2ff72e472b097974b0d6a9a7d2ed170324906.8a5c1eda3416fa5daae04a2980452d8a,\n             de459e2fe7f96e4d958537b31b946b26.1127751f1872aa967342f1fcf6b2ff72e472b097974b0d6a9a7d2ed170324906.e1d446673288adb6d5f219d0aa82d37a next_fisc_mth_of_yr,\n             NVL(de459e2fe7f96e4d958537b31b946b26.1127751f1872aa967342f1fcf6b2ff72e472b097974b0d6a9a7d2ed170324906.8a5c1eda3416fa5daae04a2980452d8a, 'OTHER') sixth_fisc_mth_cust_clsfctn\n        FROM de459e2fe7f96e4d958537b31b946b26.1127751f1872aa967342f1fcf6b2ff72e472b097974b0d6a9a7d2ed170324906 c1, de459e2fe7f96e4d958537b31b946b26.1127751f1872aa967342f1fcf6b2ff72e472b097974b0d6a9a7d2ed170324906 c2\n       WHERE de459e2fe7f96e4d958537b31b946b26.1127751f1872aa967342f1fcf6b2ff72e472b097974b0d6a9a7d2ed170324906.839c4ffb4bfaae1bb58eab4dee67d96a = de459e2fe7f96e4d958537b31b946b26.1127751f1872aa967342f1fcf6b2ff72e472b097974b0d6a9a7d2ed170324906.839c4ffb4bfaae1bb58eab4dee67d96a(+)\n         AND de459e2fe7f96e4d958537b31b946b26.1127751f1872aa967342f1fcf6b2ff72e472b097974b0d6a9a7d2ed170324906.852fa1e9f02f1ca2c75837f7146b2381 = de459e2fe7f96e4d958537b31b946b26.1127751f1872aa967342f1fcf6b2ff72e472b097974b0d6a9a7d2ed170324906.852fa1e9f02f1ca2c75837f7146b2381(+)\n         AND de459e2fe7f96e4d958537b31b946b26.1127751f1872aa967342f1fcf6b2ff72e472b097974b0d6a9a7d2ed170324906.d3ec1a21507970329af1c66ef244cdefe32f6dd38f333cde68119d1f277367cd = v_fisc_mth_strt_dt_6_mth_ago\n         AND de459e2fe7f96e4d958537b31b946b26.1127751f1872aa967342f1fcf6b2ff72e472b097974b0d6a9a7d2ed170324906.cb5e253886eb30a93e66cbf95203a754 = 0\n         AND de459e2fe7f96e4d958537b31b946b26.1127751f1872aa967342f1fcf6b2ff72e472b097974b0d6a9a7d2ed170324906.d3ec1a21507970329af1c66ef244cdefe32f6dd38f333cde68119d1f277367cd(+) = v_fisc_mth_strt_dt;\n\n   \n   CURSOR sos_cnt IS\n        SELECT div_nbr,\n               cust_nbr,\n               fisc_yr_mth,\n               COUNT( * ) AS fisc_mth_sos_cnt\n          FROM de459e2fe7f96e4d958537b31b946b26.cceb59010ea14489122210934cea0e44 s\n         WHERE EXISTS (SELECT 1\n                         FROM de459e2fe7f96e4d958537b31b946b26.cceb59010ea14489122210934cea0e44 sd\n                        WHERE inact_dt BETWEEN v_fisc_wk_strt_dt AND v_fisc_wk_end_dt\n                          AND de459e2fe7f96e4d958537b31b946b26.cceb59010ea14489122210934cea0e44.852fa1e9f02f1ca2c75837f7146b2381 = de459e2fe7f96e4d958537b31b946b26.cceb59010ea14489122210934cea0e44.852fa1e9f02f1ca2c75837f7146b2381\n                          AND de459e2fe7f96e4d958537b31b946b26.cceb59010ea14489122210934cea0e44.839c4ffb4bfaae1bb58eab4dee67d96a = de459e2fe7f96e4d958537b31b946b26.cceb59010ea14489122210934cea0e44.839c4ffb4bfaae1bb58eab4dee67d96a\n                          AND de459e2fe7f96e4d958537b31b946b26.cceb59010ea14489122210934cea0e44.2603c45be643e5cd8f9c6dad3bee6cb3 = de459e2fe7f96e4d958537b31b946b26.cceb59010ea14489122210934cea0e44.2603c45be643e5cd8f9c6dad3bee6cb3)\n      GROUP BY div_nbr, cust_nbr, fisc_yr_mth;\n\n   TYPE t_next_clsfctn IS TABLE OF next_clsfctn%ROWTYPE;\n\n   r_next_clsfctn                 t_next_clsfctn;\n\n   TYPE t_third_clsfctn IS TABLE OF third_clsfctn%ROWTYPE;\n\n   r_third_clsfctn                t_third_clsfctn;\n\n   TYPE t_sixth_clsfctn IS TABLE OF sixth_clsfctn%ROWTYPE;\n\n   r_sixth_clsfctn                t_sixth_clsfctn;\n\n   TYPE t_sos_cnt IS TABLE OF sos_cnt%ROWTYPE;\n\n   r_sos_cnt                      t_sos_cnt;\nBEGIN\n   \n   \n   \n   \n   \n   CASE TRIM(TO_CHAR(v_odate, 'DAY'))\n      WHEN 'SATURDAY' THEN\n         v_end_dt   := v_odate;\n      ELSE\n         v_end_dt   := TRUNC(v_odate, 'DAY') - 1; \n   END CASE;\n\n   SELECT de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.ab30d6d679879cfacfe389b97d1d3f0e, de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.e1d446673288adb6d5f219d0aa82d37a, de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.2603c45be643e5cd8f9c6dad3bee6cb3\n     INTO v_fisc_yr, v_fisc_mth_of_yr, v_fisc_yr_mth\n     FROM de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001 t\n    WHERE de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.222ccb1d1746bcdb2365f29b3da0b613 = v_end_dt;\n\n   SELECT MIN(clndr_dt), MAX(clndr_dt)\n     INTO v_prd_strt_dt, v_prd_end_dt\n     FROM de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001\n    WHERE fisc_yr_mth = v_fisc_yr_mth;\n\n   SELECT MIN(de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.222ccb1d1746bcdb2365f29b3da0b613), MAX(de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.222ccb1d1746bcdb2365f29b3da0b613)\n     INTO v_fisc_wk_strt_dt, v_fisc_wk_end_dt\n     FROM de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001 t\n    WHERE de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.f2de255a7553ba934b1f05ae7699ae4c IN (SELECT fisc_yr_wk\n                             FROM de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001\n                            WHERE clndr_dt = v_end_dt);\n\n   SELECT de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.cb5e253886eb30a93e66cbf95203a754\n     INTO v_fisc_wk_of_yr\n     FROM de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001 t\n    WHERE de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.222ccb1d1746bcdb2365f29b3da0b613 = v_odate;\n\n   SELECT MIN(clndr_dt),\n          MAX(clndr_dt),\n          MIN(clndr_dt_yrago),\n          MAX(clndr_dt_yrago)\n     INTO v_fisc_mth_strt_dt,\n          v_fisc_mth_end_dt,\n          v_fisc_mth_strt_dt_yrago,\n          v_fisc_mth_end_dt_yrago\n     FROM de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001 t\n    WHERE de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.ab30d6d679879cfacfe389b97d1d3f0e = v_fisc_yr\n      AND de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.e1d446673288adb6d5f219d0aa82d37a = v_fisc_mth_of_yr;\n\n   SELECT MAX(de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.cb5e253886eb30a93e66cbf95203a754)\n     INTO v_py_max_wk \n     FROM de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001 t\n    WHERE de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.ab30d6d679879cfacfe389b97d1d3f0e = v_fisc_yr - 1;\n\n   SELECT MAX(fisc_mth_of_yr), MAX(fisc_yr), MIN(clndr_dt)\n     INTO v_last_fisc_mth_of_yr, v_fisc_yr_last_mth, v_last_fisc_mth_strt_dt\n     FROM de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001 a\n    WHERE fisc_yr_mth = (SELECT MAX(de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.2603c45be643e5cd8f9c6dad3bee6cb3) \n                           FROM de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001 a\n                          WHERE de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.2603c45be643e5cd8f9c6dad3bee6cb3 < (SELECT de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.2603c45be643e5cd8f9c6dad3bee6cb3\n                                                   FROM de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001 a\n                                                  WHERE de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.222ccb1d1746bcdb2365f29b3da0b613 = v_end_dt));\n\n   \n\n   SELECT CASE WHEN fisc_mth_of_yr > 6 THEN fisc_yr_mth - 6 ELSE fisc_yr_mth - 94 END\n     INTO v_fisc_yr_mth_six_mth_ago\n     FROM time_corp\n    WHERE clndr_dt = v_end_dt;\n\n   \n\n   SELECT MIN(clndr_dt)\n     INTO v_fisc_mth_strt_dt_6_mth_ago\n     FROM de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001\n    WHERE fisc_yr_mth = v_fisc_yr_mth_six_mth_ago;\n\n   \n\n   SELECT CASE WHEN fisc_mth_of_yr > 3 THEN fisc_yr_mth - 3 ELSE fisc_yr_mth - 91 END\n     INTO v_fisc_yr_mth_three_mth_ago\n     FROM time_corp\n    WHERE clndr_dt = v_end_dt;\n\n   \n\n   SELECT MIN(clndr_dt)\n     INTO v_fisc_mth_strt_dt_3_mth_ago\n     FROM de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001\n    WHERE fisc_yr_mth = v_fisc_yr_mth_three_mth_ago;\n\n   \n   SELECT param_value_nbr\n     INTO v_net_acct_pim_suprcls_id\n     FROM de459e2fe7f96e4d958537b31b946b26.de40ae7be8b2eb3858d46af8d107f3db\n    WHERE app_name = 'MERLIN'\n      AND param_type = 'NON_ADMIN_PIM_SUPRCLS_ID'\n      AND param_code = 'UPPER_LIMIT';\n\n   \n   EXECUTE IMMEDIATE 'TRUNCATE TABLE cust_clsfctn';\n\n   DBMS_OUTPUT.put_line('Table de459e2fe7f96e4d958537b31b946b26.8a5c1eda3416fa5daae04a2980452d8a truncated ' || SYSTIMESTAMP);\n\n   \n   INSERT INTO de459e2fe7f96e4d958537b31b946b26.8a5c1eda3416fa5daae04a2980452d8a(cust_nbr, div_nbr, fisc_yr, fisc_mth_of_yr, fisc_wk_of_yr, cust_clsfctn,\n                                   fisc_mth_strt_dt, fisc_mth_end_dt, fisc_mth_strt_dt_yrago, fisc_mth_end_dt_yrago, crt_dt, nbr_of_wk_ordr_last_yr_mth,\n                                   nbr_of_wk_ordr_this_yr_mth, cust_sk, fisc_yr_mth, tagp, drops, tagp_per_drop,\n                                   grs_sls_extnd, qty_ship, unfrm_grs_sls_extnd, unfrm_tagp, unfrm_qty_ship, fisc_mth_sos_cnt,\n                                   cat_sold, unfrm_grs_tgp, unfrm_grs_tgp_per_drop, cust_tenure_mth_actl, net_acct_cust_sk)\n      SELECT d2450100e2dda59c2b7828b4daff7f8c.852fa1e9f02f1ca2c75837f7146b2381,\n             d2450100e2dda59c2b7828b4daff7f8c.839c4ffb4bfaae1bb58eab4dee67d96a,\n             d2450100e2dda59c2b7828b4daff7f8c.ab30d6d679879cfacfe389b97d1d3f0e,\n             d2450100e2dda59c2b7828b4daff7f8c.e1d446673288adb6d5f219d0aa82d37a,\n             0 AS fisc_wk_of_yr,\n             CASE \n                WHEN no_cd_unfrm_sales_ty > 0\n                 AND no_cd_unfrm_sales_ly > 0 THEN\n                   'PRIOR YEAR'\n                WHEN no_cd_unfrm_sales_ty > 0\n                 AND no_cd_unfrm_sales_ly <= 0 THEN\n                   'NEW'\n                WHEN no_cd_unfrm_sales_ty <= 0\n                 AND no_cd_unfrm_sales_ly > 0 THEN\n                   'LOST'\n                ELSE\n                   'OTHER'\n             END\n                AS cust_clsfctn,\n             v_fisc_mth_strt_dt,\n             v_fisc_mth_end_dt,\n             v_fisc_mth_strt_dt_yrago,\n             v_fisc_mth_end_dt_yrago,\n             SYSDATE AS crt_dt,\n             nbr_wk_ly,\n             nbr_wk_ty,\n             d2450100e2dda59c2b7828b4daff7f8c.7f599f836c449bebb92bb9757e86c603,\n             d2450100e2dda59c2b7828b4daff7f8c.2603c45be643e5cd8f9c6dad3bee6cb3,\n             d2450100e2dda59c2b7828b4daff7f8c.eb6a312932db943ec140f42c7c8998cf,\n             d2450100e2dda59c2b7828b4daff7f8c.630c48bbfe25ea68a239339f24d37c79,\n             d2450100e2dda59c2b7828b4daff7f8c.8f04118f95170a63ad8f7d89fff56418,\n             d2450100e2dda59c2b7828b4daff7f8c.2ee1400a0150f0b220dd7bd6268d1e66,\n             d2450100e2dda59c2b7828b4daff7f8c.dc15696e1e997bad6131bf936574f406,\n             d2450100e2dda59c2b7828b4daff7f8c.afcae1f8310cd038c0633aeaa179c10c280a4c8731f60bb762471fb74030c9a2,\n             d2450100e2dda59c2b7828b4daff7f8c.56d34efa4c0a22d07b3f8a07122ca048,\n             d2450100e2dda59c2b7828b4daff7f8c.ccf8d88f2d37f3171da2121ab22e9330,\n             d2450100e2dda59c2b7828b4daff7f8c.8ce27e49d994e1c605cb69746b9cfcb2,\n             d2450100e2dda59c2b7828b4daff7f8c.c3a904d6986fe2e41d14bc8e27a86788, \n             d2450100e2dda59c2b7828b4daff7f8c.37175a70b8190fbf717de5f6ebc49b0a, \n             CASE\n                WHEN d2450100e2dda59c2b7828b4daff7f8c.37175a70b8190fbf717de5f6ebc49b0a <> 0 THEN CASE WHEN drops <> 0 THEN d2450100e2dda59c2b7828b4daff7f8c.37175a70b8190fbf717de5f6ebc49b0a / d2450100e2dda59c2b7828b4daff7f8c.630c48bbfe25ea68a239339f24d37c79 ELSE 0 END\n                ELSE NULL\n             END\n                unfrm_grs_tgp_per_drop, \n             d2450100e2dda59c2b7828b4daff7f8c.e8a9f207120b23947059cce42696d8f133cb242de526ddafe282bd57488cedea, \n             CASE WHEN NVL(net_acct_flg, 'N') = 'Y' THEN d2450100e2dda59c2b7828b4daff7f8c.7f599f836c449bebb92bb9757e86c603 ELSE NULL END net_acct_cust_sk \n        FROM (  SELECT cust_nbr,\n                       div_nbr,\n                       fisc_yr,\n                       fisc_mth_of_yr,\n                       SUM(NVL(sales_ty, 0)) AS sales_ty,\n                       SUM(NVL(sales_ly, 0)) AS sales_ly,\n                       SUM(NVL(no_cd_unfrm_sales_ty, 0)) AS no_cd_unfrm_sales_ty, \n                       SUM(NVL(no_cd_unfrm_sales_ly, 0)) AS no_cd_unfrm_sales_ly, \n                       SUM(NVL(nbr_wk_ly, 0)) nbr_wk_ly,\n                       SUM(NVL(nbr_wk_ty, 0)) nbr_wk_ty,\n                       cust_sk,\n                       fisc_yr_mth,\n                       SUM(NVL(tagp, 0)) tagp,\n                       SUM(NVL(drops, 0)) drops,\n                       SUM(NVL(tagp_per_drop, 0)) tagp_per_drop,\n                       SUM(NVL(grs_sls_extnd, 0)) grs_sls_extnd,\n                       SUM(NVL(qty_ship, 0)) qty_ship,\n                       SUM(NVL(unfrm_grs_sls_extnd, 0)) unfrm_grs_sls_extnd,\n                       SUM(NVL(unfrm_tagp, 0)) unfrm_tagp,\n                       SUM(NVL(unfrm_qty_ship, 0)) unfrm_qty_ship,\n                       SUM(NVL(sos_cnt, 0)) sos_cnt,\n                       MAX(NVL(cat_sold, 0)) cat_sold, \n                       SUM(NVL(unfrm_grs_tgp, 0)) unfrm_grs_tgp, \n                       cust_tenure_mth_actl, \n                       MAX(NVL(net_acct_flg, 0)) net_acct_flg \n                  FROM (SELECT 6f037dd8c55b34c0a958bc6e5d1c45f6.852fa1e9f02f1ca2c75837f7146b2381,\n                               6f037dd8c55b34c0a958bc6e5d1c45f6.839c4ffb4bfaae1bb58eab4dee67d96a,\n                               6f037dd8c55b34c0a958bc6e5d1c45f6.ab30d6d679879cfacfe389b97d1d3f0e,\n                               6f037dd8c55b34c0a958bc6e5d1c45f6.e1d446673288adb6d5f219d0aa82d37a,\n                               CASE\n                                  WHEN 15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.ab30d6d679879cfacfe389b97d1d3f0e = v_fisc_yr THEN NVL(15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.2ee1400a0150f0b220dd7bd6268d1e66, 0)\n                                  ELSE 0\n                               END\n                                  sales_ty,\n                               CASE\n                                  WHEN 15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.ab30d6d679879cfacfe389b97d1d3f0e = v_fisc_yr - 1 THEN\n                                     NVL(15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.2ee1400a0150f0b220dd7bd6268d1e66, 0)\n                                  ELSE\n                                     0\n                               END\n                                  sales_ly,\n                               CASE\n                                  WHEN 15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.ab30d6d679879cfacfe389b97d1d3f0e = v_fisc_yr THEN\n                                     NVL(15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.ab081c412fc18694a8297c8dfdea984cd9542f5039f4af6f9fa4a3007112f536, 0)\n                                  ELSE\n                                     0\n                               END\n                                  no_cd_unfrm_sales_ty, \n                               CASE\n                                  WHEN 15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.ab30d6d679879cfacfe389b97d1d3f0e = v_fisc_yr - 1 THEN\n                                     NVL(15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.ab081c412fc18694a8297c8dfdea984cd9542f5039f4af6f9fa4a3007112f536, 0)\n                                  ELSE\n                                     0\n                               END\n                                  no_cd_unfrm_sales_ly, \n                               CASE WHEN 15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.ab30d6d679879cfacfe389b97d1d3f0e = v_fisc_yr - 1 THEN 15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.b8329c7377e022434715b0dbbad8440e END\n                                  nbr_wk_ly,\n                               CASE WHEN 15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.ab30d6d679879cfacfe389b97d1d3f0e = v_fisc_yr THEN 15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.b8329c7377e022434715b0dbbad8440e END nbr_wk_ty,\n                               6f037dd8c55b34c0a958bc6e5d1c45f6.7f599f836c449bebb92bb9757e86c603,\n                               6f037dd8c55b34c0a958bc6e5d1c45f6.2603c45be643e5cd8f9c6dad3bee6cb3,\n                               6f037dd8c55b34c0a958bc6e5d1c45f6.e8a9f207120b23947059cce42696d8f133cb242de526ddafe282bd57488cedea, \n                               CASE WHEN 15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.ab30d6d679879cfacfe389b97d1d3f0e = v_fisc_yr THEN 15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.eb6a312932db943ec140f42c7c8998cf END tagp, \n                               CASE WHEN 15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.ab30d6d679879cfacfe389b97d1d3f0e = v_fisc_yr THEN 15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.630c48bbfe25ea68a239339f24d37c79 END drops, \n                               CASE WHEN 15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.ab30d6d679879cfacfe389b97d1d3f0e = v_fisc_yr THEN 15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.8f04118f95170a63ad8f7d89fff56418 END\n                                  tagp_per_drop, \n                               CASE WHEN 15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.ab30d6d679879cfacfe389b97d1d3f0e = v_fisc_yr THEN 15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.2ee1400a0150f0b220dd7bd6268d1e66 END\n                                  grs_sls_extnd, \n                               CASE WHEN 15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.ab30d6d679879cfacfe389b97d1d3f0e = v_fisc_yr THEN 15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.dc15696e1e997bad6131bf936574f406 END qty_ship, \n                               CASE\n                                  WHEN 15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.ab30d6d679879cfacfe389b97d1d3f0e = v_fisc_yr THEN 15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.afcae1f8310cd038c0633aeaa179c10c280a4c8731f60bb762471fb74030c9a2\n                               END\n                                  unfrm_grs_sls_extnd, \n                               CASE WHEN 15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.ab30d6d679879cfacfe389b97d1d3f0e = v_fisc_yr THEN 15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.56d34efa4c0a22d07b3f8a07122ca048 END\n                                  unfrm_tagp, \n                               CASE WHEN 15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.ab30d6d679879cfacfe389b97d1d3f0e = v_fisc_yr THEN 15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.ccf8d88f2d37f3171da2121ab22e9330 END\n                                  unfrm_qty_ship, \n                               CASE WHEN 15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.ab30d6d679879cfacfe389b97d1d3f0e = v_fisc_yr THEN 8ce27e49d994e1c605cb69746b9cfcb2.8ce27e49d994e1c605cb69746b9cfcb2 END sos_cnt, \n                               CASE WHEN 15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.ab30d6d679879cfacfe389b97d1d3f0e = v_fisc_yr THEN 15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.37175a70b8190fbf717de5f6ebc49b0a END\n                                  unfrm_grs_tgp, \n                               CASE WHEN 15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.ab30d6d679879cfacfe389b97d1d3f0e = v_fisc_yr THEN 15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.c3a904d6986fe2e41d14bc8e27a86788 END cat_sold, \n                               CASE WHEN 15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.ab30d6d679879cfacfe389b97d1d3f0e = v_fisc_yr THEN 15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.5525c623c7224d514a55baf79c2ef08f END net_acct_flg \n                          FROM (SELECT DISTINCT bf1d44a3c1904dcde6eb406a11d21bbe.7f599f836c449bebb92bb9757e86c603,\n                                                e9a95106e01380a7834d36560e919770.839c4ffb4bfaae1bb58eab4dee67d96a,\n                                                e9a95106e01380a7834d36560e919770.852fa1e9f02f1ca2c75837f7146b2381,\n                                                \n                                                v_fisc_yr AS fisc_yr,\n                                                v_fisc_mth_of_yr AS fisc_mth_of_yr,\n                                                v_fisc_yr_mth AS fisc_yr_mth,\n                                                (SELECT COUNT(fisc_yr_mth) - 2\n                                                   FROM de459e2fe7f96e4d958537b31b946b26.ca1faaabe4743a8a00a4d208ab58b2b3\n                                                  WHERE fisc_yr_mth BETWEEN bf1d44a3c1904dcde6eb406a11d21bbe.55739765f192316a366e35ac5cc043c2561b89cb9074f747f5165d6920afabf2 AND v_fisc_yr_mth)\n                                                   cust_tenure_mth_actl \n                                  FROM de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001 t,\n                                       de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c s,\n                                       de459e2fe7f96e4d958537b31b946b26.dec387908a0954ddc8689c4ad37c8a3c d,\n                                       de459e2fe7f96e4d958537b31b946b26.52982d3bbc1ebc2720d9504c7ea2ed3f cc\n                                 WHERE 1d731bbdc4e3fb69a854112d4982eb99.ab30d6d679879cfacfe389b97d1d3f0e IN (v_fisc_yr - 1, v_fisc_yr)\n                                   \n                                   AND e9a95106e01380a7834d36560e919770.f5dd4374a3e3af6a775cb6d6b22e8162 = 1d731bbdc4e3fb69a854112d4982eb99.222ccb1d1746bcdb2365f29b3da0b613\n                                   AND e9a95106e01380a7834d36560e919770.839c4ffb4bfaae1bb58eab4dee67d96a = fce896ca0fbbf5a5d330f2803036eb44.839c4ffb4bfaae1bb58eab4dee67d96a\n                                   AND e9a95106e01380a7834d36560e919770.852fa1e9f02f1ca2c75837f7146b2381 = bf1d44a3c1904dcde6eb406a11d21bbe.852fa1e9f02f1ca2c75837f7146b2381\n                                   AND e9a95106e01380a7834d36560e919770.839c4ffb4bfaae1bb58eab4dee67d96a = bf1d44a3c1904dcde6eb406a11d21bbe.839c4ffb4bfaae1bb58eab4dee67d96a\n                                   AND e9a95106e01380a7834d36560e919770.467a168a7499c57b1859198a7dac7be0 IS NULL\n                                   AND (fce896ca0fbbf5a5d330f2803036eb44.2edfd837e0441242d7eed4e0cdf56652 IS NULL\n                                     OR fce896ca0fbbf5a5d330f2803036eb44.6d74bb3e26f02dd707dc6b3b68070169 > SYSDATE)) cust_list,\n                               (  SELECT cust_nbr,\n                                         div_nbr,\n                                         fisc_yr_mth,\n                                         COUNT(sos_id) sos_cnt \n                                    FROM de459e2fe7f96e4d958537b31b946b26.cceb59010ea14489122210934cea0e44\n                                   WHERE fisc_yr_mth = v_fisc_yr_mth\n                                     AND inact_dt IS NULL\n                                GROUP BY cust_nbr, div_nbr, fisc_yr_mth) sos_cnt,\n                               (  SELECT e9a95106e01380a7834d36560e919770.839c4ffb4bfaae1bb58eab4dee67d96a,\n                                         e9a95106e01380a7834d36560e919770.852fa1e9f02f1ca2c75837f7146b2381,\n                                         1d731bbdc4e3fb69a854112d4982eb99.ab30d6d679879cfacfe389b97d1d3f0e,\n                                         1d731bbdc4e3fb69a854112d4982eb99.e1d446673288adb6d5f219d0aa82d37a AS fisc_mth_of_yr,\n                                         1d731bbdc4e3fb69a854112d4982eb99.2603c45be643e5cd8f9c6dad3bee6cb3 AS fisc_yr_mth,\n                                         COUNT(DISTINCT 1d731bbdc4e3fb69a854112d4982eb99.3f2fdebe4ba3a24bdf16fdac5827ebfb) nbr_wk,\n                                         SUM(NVL(e9a95106e01380a7834d36560e919770.1afca342ab89e5b8c65c6c4c634b2186, 0)) tagp,\n                                         COUNT(\n                                            DISTINCT CASE\n                                                        WHEN e9a95106e01380a7834d36560e919770.26ac88e7ae671a1b22c14c2fce77aa2d = 'RT'\n                                                         AND e472b097974b0d6a9a7d2ed170324906.89f3df82917b692fe64dca942d924e7c <> 97\n                                                         AND e472b097974b0d6a9a7d2ed170324906.89f3df82917b692fe64dca942d924e7c IS NOT NULL THEN\n                                                           e9a95106e01380a7834d36560e919770.839c4ffb4bfaae1bb58eab4dee67d96a || cust_nbr || inv_dt || NVL(dlvr_rte, '') || prcs_dt\n                                                        ELSE\n                                                           NULL\n                                                     END)\n                                            drops, \n                                         CASE\n                                            WHEN COUNT(\n                                                    DISTINCT CASE\n                                                                WHEN e9a95106e01380a7834d36560e919770.26ac88e7ae671a1b22c14c2fce77aa2d = 'RT'\n                                                                 AND e472b097974b0d6a9a7d2ed170324906.89f3df82917b692fe64dca942d924e7c <> 97\n                                                                 AND e472b097974b0d6a9a7d2ed170324906.89f3df82917b692fe64dca942d924e7c IS NOT NULL THEN\n                                                                      e9a95106e01380a7834d36560e919770.839c4ffb4bfaae1bb58eab4dee67d96a\n                                                                   || cust_nbr\n                                                                   || inv_dt\n                                                                   || NVL(dlvr_rte, '')\n                                                                   || prcs_dt\n                                                                ELSE\n                                                                   NULL\n                                                             END) > 0 THEN\n                                               SUM(NVL(e9a95106e01380a7834d36560e919770.1afca342ab89e5b8c65c6c4c634b2186, 0))\n                                               / COUNT(\n                                                    DISTINCT CASE\n                                                                WHEN e9a95106e01380a7834d36560e919770.26ac88e7ae671a1b22c14c2fce77aa2d = 'RT'\n                                                                 AND e472b097974b0d6a9a7d2ed170324906.89f3df82917b692fe64dca942d924e7c <> 97\n                                                                 AND e472b097974b0d6a9a7d2ed170324906.89f3df82917b692fe64dca942d924e7c IS NOT NULL THEN\n                                                                      e9a95106e01380a7834d36560e919770.839c4ffb4bfaae1bb58eab4dee67d96a\n                                                                   || cust_nbr\n                                                                   || inv_dt\n                                                                   || NVL(dlvr_rte, '')\n                                                                   || prcs_dt\n                                                                ELSE\n                                                                   NULL\n                                                             END)\n                                            ELSE\n                                               0\n                                         END\n                                            tagp_per_drop,\n                                         SUM(grs_sls_extnd) AS grs_sls_extnd,\n                                         SUM(CASE\n                                                WHEN e9a95106e01380a7834d36560e919770.26ac88e7ae671a1b22c14c2fce77aa2d IN ('RT', 'VS', 'WC')\n                                                 AND e472b097974b0d6a9a7d2ed170324906.89f3df82917b692fe64dca942d924e7c <> 97\n                                                 AND e472b097974b0d6a9a7d2ed170324906.89f3df82917b692fe64dca942d924e7c IS NOT NULL THEN\n                                                   e9a95106e01380a7834d36560e919770.2ee1400a0150f0b220dd7bd6268d1e66\n                                                ELSE\n                                                   NULL\n                                             END)\n                                            no_cd_unfrm_grs_sls_extnd, \n                                         SUM(qty_ship) AS qty_ship, \n                                         SUM(unfrm_qty_ship) unfrm_qty_ship, \n                                         SUM(CASE\n                                                WHEN e472b097974b0d6a9a7d2ed170324906.89f3df82917b692fe64dca942d924e7c <> 97\n                                                 AND e472b097974b0d6a9a7d2ed170324906.89f3df82917b692fe64dca942d924e7c IS NOT NULL THEN\n                                                   grs_sls_extnd\n                                                ELSE\n                                                   0\n                                             END)\n                                            unfrm_grs_sls_extnd, \n                                         SUM(CASE\n                                                WHEN e472b097974b0d6a9a7d2ed170324906.89f3df82917b692fe64dca942d924e7c <> 97\n                                                 AND e472b097974b0d6a9a7d2ed170324906.89f3df82917b692fe64dca942d924e7c IS NOT NULL THEN\n                                                   actl_gp\n                                                ELSE\n                                                   0\n                                             END)\n                                            unfrm_tagp, \n                                         SUM(CASE\n                                                WHEN e472b097974b0d6a9a7d2ed170324906.89f3df82917b692fe64dca942d924e7c <> 97\n                                                 AND e472b097974b0d6a9a7d2ed170324906.89f3df82917b692fe64dca942d924e7c IS NOT NULL THEN\n                                                   NVL(e9a95106e01380a7834d36560e919770.2ee1400a0150f0b220dd7bd6268d1e66 - e9a95106e01380a7834d36560e919770.c6c7cc45578c678907522e08bb04a4ca - (CASE WHEN e9a95106e01380a7834d36560e919770.487c194c34aee6c67551aa2cdd2358ace32f6dd38f333cde68119d1f277367cd = 'P' THEN NVL(e9a95106e01380a7834d36560e919770.d206d123f59f85e26ec113e33b465295,0) ELSE 0 END) + e9a95106e01380a7834d36560e919770.b7982b81d447f11a0953881190e528cae32f6dd38f333cde68119d1f277367cd, 0)\n                                                ELSE\n                                                   0\n                                             END)\n                                            unfrm_grs_tgp, \n                                         COUNT(DISTINCT (CASE\n                                                            WHEN e9a95106e01380a7834d36560e919770.26ac88e7ae671a1b22c14c2fce77aa2d IN ('RT', 'VS', 'WC')\n                                                             AND e472b097974b0d6a9a7d2ed170324906.89f3df82917b692fe64dca942d924e7c <= v_net_acct_pim_suprcls_id THEN\n                                                               e472b097974b0d6a9a7d2ed170324906.89f3df82917b692fe64dca942d924e7c\n                                                            ELSE\n                                                               NULL\n                                                         END))\n                                            cat_sold, \n                                         MAX(CASE\n                                                WHEN e9a95106e01380a7834d36560e919770.26ac88e7ae671a1b22c14c2fce77aa2d IN ('RT', 'VS', 'WC')\n                                                 AND e472b097974b0d6a9a7d2ed170324906.89f3df82917b692fe64dca942d924e7c <> 97\n                                                 AND e472b097974b0d6a9a7d2ed170324906.89f3df82917b692fe64dca942d924e7c IS NOT NULL THEN\n                                                   'Y'\n                                                ELSE\n                                                   'N'\n                                             END)\n                                            net_acct_flg \n                                    FROM de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001 t,\n                                         de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c s,\n                                         de459e2fe7f96e4d958537b31b946b26.dec387908a0954ddc8689c4ad37c8a3c d,\n                                         de459e2fe7f96e4d958537b31b946b26.dec387908a0954ddc8689c4ad37c8a3c d2,\n                                         de459e2fe7f96e4d958537b31b946b26.2c04d82ed0aa1cc9bce2cf2c0548b268 p\n                                   WHERE 1d731bbdc4e3fb69a854112d4982eb99.ab30d6d679879cfacfe389b97d1d3f0e IN (v_fisc_yr, v_fisc_yr - 1)\n                                     AND 1d731bbdc4e3fb69a854112d4982eb99.e1d446673288adb6d5f219d0aa82d37a = v_fisc_mth_of_yr\n                                     AND e9a95106e01380a7834d36560e919770.d3268eabc4a7d98105fd85f9c9e62cd6e32ad436514bbe822b33de8bead744f3 = e472b097974b0d6a9a7d2ed170324906.d3268eabc4a7d98105fd85f9c9e62cd6e32ad436514bbe822b33de8bead744f3\n                                     AND 1d731bbdc4e3fb69a854112d4982eb99.cb5e253886eb30a93e66cbf95203a754 <> CASE\n                                                               WHEN 1d731bbdc4e3fb69a854112d4982eb99.ab30d6d679879cfacfe389b97d1d3f0e = v_fisc_yr - 1\n                                                                AND v_fisc_mth_of_yr = '12'\n                                                                AND v_py_max_wk = 53 THEN\n                                                                  53 \n                                                               ELSE\n                                                                  99 \n                                                            END\n                                     AND 1d731bbdc4e3fb69a854112d4982eb99.222ccb1d1746bcdb2365f29b3da0b613 <= v_end_dt \n                                     AND e9a95106e01380a7834d36560e919770.f5dd4374a3e3af6a775cb6d6b22e8162 = 1d731bbdc4e3fb69a854112d4982eb99.222ccb1d1746bcdb2365f29b3da0b613\n                                     AND e9a95106e01380a7834d36560e919770.839c4ffb4bfaae1bb58eab4dee67d96a = fce896ca0fbbf5a5d330f2803036eb44.839c4ffb4bfaae1bb58eab4dee67d96a\n                                     AND (fce896ca0fbbf5a5d330f2803036eb44.2edfd837e0441242d7eed4e0cdf56652 IS NULL\n                                       OR fce896ca0fbbf5a5d330f2803036eb44.6d74bb3e26f02dd707dc6b3b68070169 > SYSDATE)\n                                     AND e9a95106e01380a7834d36560e919770.467a168a7499c57b1859198a7dac7be0 IS NULL\n                                     AND NVL(e9a95106e01380a7834d36560e919770.a2b201123c685e8cc48b5468cb4a449361bbd7bc0d2d67c7d7b11cb0a8d18d03, e9a95106e01380a7834d36560e919770.839c4ffb4bfaae1bb58eab4dee67d96a) = 6996a10ec899228cb1cc42a59f8c6bde.839c4ffb4bfaae1bb58eab4dee67d96a\n                                     AND 6996a10ec899228cb1cc42a59f8c6bde.b8c6ab19cb6e726c38f24d1885346ea3 <> 'CC'\n\t\t\t\t\t\t\t\t\t AND  (case when NVL (6996a10ec899228cb1cc42a59f8c6bde.c712a9ab5ef100c5807fa96123dac48b,'USF') <> 'USF'  \n\t\t\t\t\t\t\t\t     and NVL(e9a95106e01380a7834d36560e919770.a2b201123c685e8cc48b5468cb4a449361bbd7bc0d2d67c7d7b11cb0a8d18d03, e9a95106e01380a7834d36560e919770.839c4ffb4bfaae1bb58eab4dee67d96a) = 6996a10ec899228cb1cc42a59f8c6bde.839c4ffb4bfaae1bb58eab4dee67d96a\n\t\t\t\t\t\t\t\t\t and e9a95106e01380a7834d36560e919770.f5dd4374a3e3af6a775cb6d6b22e8162 < NVL(6996a10ec899228cb1cc42a59f8c6bde.3db9275d5f5cb2e9d918e77dbabdd97b,e9a95106e01380a7834d36560e919770.f5dd4374a3e3af6a775cb6d6b22e8162)\n\t\t\t\t\t\t\t\t\t then 'NON_USFGL' else 'USFGL' END) ='USFGL'\n\t\t\t\t\t\t\t\t\t\n                                GROUP BY e9a95106e01380a7834d36560e919770.839c4ffb4bfaae1bb58eab4dee67d96a,\n                                         e9a95106e01380a7834d36560e919770.852fa1e9f02f1ca2c75837f7146b2381,\n                                         1d731bbdc4e3fb69a854112d4982eb99.ab30d6d679879cfacfe389b97d1d3f0e,\n                                         1d731bbdc4e3fb69a854112d4982eb99.e1d446673288adb6d5f219d0aa82d37a,\n                                         1d731bbdc4e3fb69a854112d4982eb99.2603c45be643e5cd8f9c6dad3bee6cb3) cust_sales_ty_ly \n                         WHERE 6f037dd8c55b34c0a958bc6e5d1c45f6.852fa1e9f02f1ca2c75837f7146b2381 = 15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.852fa1e9f02f1ca2c75837f7146b2381(+) \n                           AND 6f037dd8c55b34c0a958bc6e5d1c45f6.839c4ffb4bfaae1bb58eab4dee67d96a = 15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.839c4ffb4bfaae1bb58eab4dee67d96a(+) \n                           AND 6f037dd8c55b34c0a958bc6e5d1c45f6.e1d446673288adb6d5f219d0aa82d37a = 15965c968c2182bd0abeb4c43692df4be32f6dd38f333cde68119d1f277367cd.e1d446673288adb6d5f219d0aa82d37a(+)\n                           AND 6f037dd8c55b34c0a958bc6e5d1c45f6.2603c45be643e5cd8f9c6dad3bee6cb3 = 8ce27e49d994e1c605cb69746b9cfcb2.2603c45be643e5cd8f9c6dad3bee6cb3(+)\n                           AND 6f037dd8c55b34c0a958bc6e5d1c45f6.852fa1e9f02f1ca2c75837f7146b2381 = 8ce27e49d994e1c605cb69746b9cfcb2.852fa1e9f02f1ca2c75837f7146b2381(+)\n                           AND 6f037dd8c55b34c0a958bc6e5d1c45f6.839c4ffb4bfaae1bb58eab4dee67d96a = 8ce27e49d994e1c605cb69746b9cfcb2.839c4ffb4bfaae1bb58eab4dee67d96a(+))\n              GROUP BY cust_sk,\n                       cust_nbr,\n                       div_nbr,\n                       fisc_yr,\n                       fisc_mth_of_yr,\n                       fisc_yr_mth,\n                       cust_tenure_mth_actl) c;\n\n   COMMIT;\n\n   DBMS_OUTPUT.put_line('Table de459e2fe7f96e4d958537b31b946b26.8a5c1eda3416fa5daae04a2980452d8a loaded ' || SYSTIMESTAMP);\n\n   \n   MERGE INTO de459e2fe7f96e4d958537b31b946b26.1127751f1872aa967342f1fcf6b2ff72e472b097974b0d6a9a7d2ed170324906 tgt\n        USING (SELECT cust_nbr,\n                      div_nbr,\n                      fisc_yr,\n                      fisc_mth_of_yr,\n                      fisc_wk_of_yr,\n                      cust_clsfctn,\n                      fisc_mth_strt_dt,\n                      fisc_mth_end_dt,\n                      fisc_mth_strt_dt_yrago,\n                      fisc_mth_end_dt_yrago,\n                      crt_dt,\n                      nbr_of_wk_ordr_last_yr_mth,\n                      nbr_of_wk_ordr_this_yr_mth,\n                      cust_sk,\n                      fisc_yr_mth,\n                      tagp,\n                      drops,\n                      tagp_per_drop,\n                      grs_sls_extnd,\n                      qty_ship,\n                      unfrm_grs_sls_extnd,\n                      unfrm_tagp,\n                      unfrm_qty_ship,\n                      fisc_mth_sos_cnt, \n                      cat_sold,\n                      unfrm_grs_tgp,\n                      unfrm_grs_tgp_per_drop,\n                      cust_tenure_mth_actl,\n                      net_acct_cust_sk\n                 FROM de459e2fe7f96e4d958537b31b946b26.8a5c1eda3416fa5daae04a2980452d8a) src\n           ON (c87bbaf85002563e56e2c571e0e1c5a2.852fa1e9f02f1ca2c75837f7146b2381 = a1fa0f79e78ad884522822d320ab5272.852fa1e9f02f1ca2c75837f7146b2381\n           AND c87bbaf85002563e56e2c571e0e1c5a2.839c4ffb4bfaae1bb58eab4dee67d96a = a1fa0f79e78ad884522822d320ab5272.839c4ffb4bfaae1bb58eab4dee67d96a\n           AND c87bbaf85002563e56e2c571e0e1c5a2.ab30d6d679879cfacfe389b97d1d3f0e = a1fa0f79e78ad884522822d320ab5272.ab30d6d679879cfacfe389b97d1d3f0e\n           AND c87bbaf85002563e56e2c571e0e1c5a2.e1d446673288adb6d5f219d0aa82d37a = a1fa0f79e78ad884522822d320ab5272.e1d446673288adb6d5f219d0aa82d37a\n           AND c87bbaf85002563e56e2c571e0e1c5a2.cb5e253886eb30a93e66cbf95203a754 = a1fa0f79e78ad884522822d320ab5272.cb5e253886eb30a93e66cbf95203a754)\n   WHEN MATCHED THEN\n      UPDATE SET c87bbaf85002563e56e2c571e0e1c5a2.8a5c1eda3416fa5daae04a2980452d8a                 = a1fa0f79e78ad884522822d320ab5272.8a5c1eda3416fa5daae04a2980452d8a,\n                 c87bbaf85002563e56e2c571e0e1c5a2.d3ec1a21507970329af1c66ef244cdefe32f6dd38f333cde68119d1f277367cd             = a1fa0f79e78ad884522822d320ab5272.d3ec1a21507970329af1c66ef244cdefe32f6dd38f333cde68119d1f277367cd,\n                 c87bbaf85002563e56e2c571e0e1c5a2.e17b4db24503ad4d9365a15bec98eef6              = a1fa0f79e78ad884522822d320ab5272.e17b4db24503ad4d9365a15bec98eef6,\n                 c87bbaf85002563e56e2c571e0e1c5a2.d3ec1a21507970329af1c66ef244cdefb274599470f4daf85f36de136c376169       = a1fa0f79e78ad884522822d320ab5272.d3ec1a21507970329af1c66ef244cdefb274599470f4daf85f36de136c376169,\n                 c87bbaf85002563e56e2c571e0e1c5a2.21c571650d05fd041faddc812b8444acf43d3e611ef8d78ea0e7840aa66f8834        = a1fa0f79e78ad884522822d320ab5272.21c571650d05fd041faddc812b8444acf43d3e611ef8d78ea0e7840aa66f8834,\n                 c87bbaf85002563e56e2c571e0e1c5a2.7a133759cd0bf9f99c4a5301a550aed5                       = (    SELECT SYSDATE FROM DUAL),\n                 c87bbaf85002563e56e2c571e0e1c5a2.eb6a312932db943ec140f42c7c8998cf                         = a1fa0f79e78ad884522822d320ab5272.eb6a312932db943ec140f42c7c8998cf,\n                 c87bbaf85002563e56e2c571e0e1c5a2.630c48bbfe25ea68a239339f24d37c79                        = a1fa0f79e78ad884522822d320ab5272.630c48bbfe25ea68a239339f24d37c79,\n                 c87bbaf85002563e56e2c571e0e1c5a2.8f04118f95170a63ad8f7d89fff56418                = a1fa0f79e78ad884522822d320ab5272.8f04118f95170a63ad8f7d89fff56418,\n                 c87bbaf85002563e56e2c571e0e1c5a2.b510300e3201ebdc74ca77e145879977a60007b116184ea39d15d05e56cd3bd4   = a1fa0f79e78ad884522822d320ab5272.b510300e3201ebdc74ca77e145879977a60007b116184ea39d15d05e56cd3bd4,\n                 c87bbaf85002563e56e2c571e0e1c5a2.60c87cc02b8c8cefb8bba2a977223d5f38ee6547beafb256a1079a3b44ded48f   = a1fa0f79e78ad884522822d320ab5272.60c87cc02b8c8cefb8bba2a977223d5f38ee6547beafb256a1079a3b44ded48f,\n                 c87bbaf85002563e56e2c571e0e1c5a2.2ee1400a0150f0b220dd7bd6268d1e66                = a1fa0f79e78ad884522822d320ab5272.2ee1400a0150f0b220dd7bd6268d1e66,\n                 c87bbaf85002563e56e2c571e0e1c5a2.dc15696e1e997bad6131bf936574f406                     = a1fa0f79e78ad884522822d320ab5272.dc15696e1e997bad6131bf936574f406,\n                 c87bbaf85002563e56e2c571e0e1c5a2.afcae1f8310cd038c0633aeaa179c10c280a4c8731f60bb762471fb74030c9a2          = a1fa0f79e78ad884522822d320ab5272.afcae1f8310cd038c0633aeaa179c10c280a4c8731f60bb762471fb74030c9a2,\n                 c87bbaf85002563e56e2c571e0e1c5a2.56d34efa4c0a22d07b3f8a07122ca048                   = a1fa0f79e78ad884522822d320ab5272.56d34efa4c0a22d07b3f8a07122ca048,\n                 c87bbaf85002563e56e2c571e0e1c5a2.ccf8d88f2d37f3171da2121ab22e9330               = a1fa0f79e78ad884522822d320ab5272.ccf8d88f2d37f3171da2121ab22e9330,\n                 c87bbaf85002563e56e2c571e0e1c5a2.bf06ba7d684771516450326e880739f3e32f6dd38f333cde68119d1f277367cd             = a1fa0f79e78ad884522822d320ab5272.bf06ba7d684771516450326e880739f3e32f6dd38f333cde68119d1f277367cd,\n                 c87bbaf85002563e56e2c571e0e1c5a2.c3a904d6986fe2e41d14bc8e27a86788                     = a1fa0f79e78ad884522822d320ab5272.c3a904d6986fe2e41d14bc8e27a86788, \n                 c87bbaf85002563e56e2c571e0e1c5a2.37175a70b8190fbf717de5f6ebc49b0a                = a1fa0f79e78ad884522822d320ab5272.37175a70b8190fbf717de5f6ebc49b0a, \n                 c87bbaf85002563e56e2c571e0e1c5a2.e6160a512e148d90c7df38ae2e16368dcd30f368447f67a772f6e122173aa0f4       = a1fa0f79e78ad884522822d320ab5272.e6160a512e148d90c7df38ae2e16368dcd30f368447f67a772f6e122173aa0f4, \n                 c87bbaf85002563e56e2c571e0e1c5a2.e8a9f207120b23947059cce42696d8f133cb242de526ddafe282bd57488cedea         = a1fa0f79e78ad884522822d320ab5272.e8a9f207120b23947059cce42696d8f133cb242de526ddafe282bd57488cedea, \n                 c87bbaf85002563e56e2c571e0e1c5a2.427b165a60053aea6330e695e94a70a7e32f6dd38f333cde68119d1f277367cd             = a1fa0f79e78ad884522822d320ab5272.427b165a60053aea6330e695e94a70a7e32f6dd38f333cde68119d1f277367cd \n   WHEN NOT MATCHED THEN\n      INSERT            (cust_sk, cust_nbr, div_nbr, fisc_yr, fisc_mth_of_yr, fisc_yr_mth,\n                         fisc_wk_of_yr, cust_clsfctn, fisc_mth_strt_dt, fisc_mth_end_dt, fisc_mth_strt_dt_yrago, fisc_mth_end_dt_yrago,\n                         crt_dt, tagp, drops, tagp_per_drop, nbr_of_wk_ordr_last_yr_mth, nbr_of_wk_ordr_this_yr_mth,\n                         grs_sls_extnd, qty_ship, unfrm_grs_sls_extnd, unfrm_tagp, unfrm_qty_ship, fisc_mth_sos_cnt,\n                         cat_sold, unfrm_grs_tgp, unfrm_grs_tgp_per_drop, cust_tenure_mth_actl, net_acct_cust_sk)\n          VALUES (a1fa0f79e78ad884522822d320ab5272.7f599f836c449bebb92bb9757e86c603,\n                  a1fa0f79e78ad884522822d320ab5272.852fa1e9f02f1ca2c75837f7146b2381,\n                  a1fa0f79e78ad884522822d320ab5272.839c4ffb4bfaae1bb58eab4dee67d96a,\n                  a1fa0f79e78ad884522822d320ab5272.ab30d6d679879cfacfe389b97d1d3f0e,\n                  a1fa0f79e78ad884522822d320ab5272.e1d446673288adb6d5f219d0aa82d37a,\n                  a1fa0f79e78ad884522822d320ab5272.2603c45be643e5cd8f9c6dad3bee6cb3,\n                  a1fa0f79e78ad884522822d320ab5272.cb5e253886eb30a93e66cbf95203a754,\n                  a1fa0f79e78ad884522822d320ab5272.8a5c1eda3416fa5daae04a2980452d8a,\n                  a1fa0f79e78ad884522822d320ab5272.d3ec1a21507970329af1c66ef244cdefe32f6dd38f333cde68119d1f277367cd,\n                  a1fa0f79e78ad884522822d320ab5272.e17b4db24503ad4d9365a15bec98eef6,\n                  a1fa0f79e78ad884522822d320ab5272.d3ec1a21507970329af1c66ef244cdefb274599470f4daf85f36de136c376169,\n                  a1fa0f79e78ad884522822d320ab5272.21c571650d05fd041faddc812b8444acf43d3e611ef8d78ea0e7840aa66f8834,\n                  a1fa0f79e78ad884522822d320ab5272.44db07dca7893985ce87192c7f358f75,\n                  a1fa0f79e78ad884522822d320ab5272.eb6a312932db943ec140f42c7c8998cf,\n                  a1fa0f79e78ad884522822d320ab5272.630c48bbfe25ea68a239339f24d37c79,\n                  a1fa0f79e78ad884522822d320ab5272.8f04118f95170a63ad8f7d89fff56418,\n                  a1fa0f79e78ad884522822d320ab5272.b510300e3201ebdc74ca77e145879977a60007b116184ea39d15d05e56cd3bd4,\n                  a1fa0f79e78ad884522822d320ab5272.60c87cc02b8c8cefb8bba2a977223d5f38ee6547beafb256a1079a3b44ded48f,\n                  a1fa0f79e78ad884522822d320ab5272.2ee1400a0150f0b220dd7bd6268d1e66,\n                  a1fa0f79e78ad884522822d320ab5272.dc15696e1e997bad6131bf936574f406,\n                  a1fa0f79e78ad884522822d320ab5272.afcae1f8310cd038c0633aeaa179c10c280a4c8731f60bb762471fb74030c9a2,\n                  a1fa0f79e78ad884522822d320ab5272.56d34efa4c0a22d07b3f8a07122ca048,\n                  a1fa0f79e78ad884522822d320ab5272.ccf8d88f2d37f3171da2121ab22e9330,\n                  a1fa0f79e78ad884522822d320ab5272.bf06ba7d684771516450326e880739f3e32f6dd38f333cde68119d1f277367cd,\n                  a1fa0f79e78ad884522822d320ab5272.c3a904d6986fe2e41d14bc8e27a86788, \n                  a1fa0f79e78ad884522822d320ab5272.37175a70b8190fbf717de5f6ebc49b0a, \n                  a1fa0f79e78ad884522822d320ab5272.e6160a512e148d90c7df38ae2e16368dcd30f368447f67a772f6e122173aa0f4, \n                  a1fa0f79e78ad884522822d320ab5272.e8a9f207120b23947059cce42696d8f133cb242de526ddafe282bd57488cedea, \n                  a1fa0f79e78ad884522822d320ab5272.427b165a60053aea6330e695e94a70a7e32f6dd38f333cde68119d1f277367cd); \n\n   COMMIT;\n\n   \n   DELETE FROM de459e2fe7f96e4d958537b31b946b26.1127751f1872aa967342f1fcf6b2ff72e472b097974b0d6a9a7d2ed170324906\n         WHERE fisc_mth_strt_dt = v_fisc_mth_strt_dt\n           \n           \n           AND fisc_wk_of_yr = v_fisc_wk_of_yr\n           AND cust_clsfctn IS NULL;\n\n   \n   OPEN sos_cnt;\n\n   LOOP\n      EXIT WHEN sos_cnt%NOTFOUND;\n\n      FETCH sos_cnt\n      BULK COLLECT INTO r_sos_cnt\n      LIMIT 10000;\n\n      FORALL i IN 1 .. ab209638126277a3fe30004128eb102e.c838adb0c77d39edf51006214ba6e643()\n         UPDATE \n               de459e2fe7f96e4d958537b31b946b26.1127751f1872aa967342f1fcf6b2ff72e472b097974b0d6a9a7d2ed170324906 b\n            SET fisc_mth_sos_cnt   = r_sos_cnt(i).fisc_mth_sos_cnt\n          WHERE 6d9b37be5a083f8b78d676aba846c823.839c4ffb4bfaae1bb58eab4dee67d96a = r_sos_cnt(i).div_nbr\n            AND 6d9b37be5a083f8b78d676aba846c823.852fa1e9f02f1ca2c75837f7146b2381 = r_sos_cnt(i).cust_nbr\n            AND 6d9b37be5a083f8b78d676aba846c823.2603c45be643e5cd8f9c6dad3bee6cb3 = r_sos_cnt(i).fisc_yr_mth;\n   END LOOP;\n\n   CLOSE sos_cnt;\n\n   DBMS_OUTPUT.put_line('Fisc_mth_cnt Rows are updated' || ' ' || sql%ROWCOUNT);\n   COMMIT;\n\n   \n\n   IF v_odate = v_prd_end_dt THEN\n      DBMS_OUTPUT.put_line('Processing End of Month Next_fisc_mth_cust_Clsfctn Update' || SYSTIMESTAMP);\n      DBMS_OUTPUT.put_line(   'Processing Fisc_Mth_Strt_dt_Last_Month: '\n                           || v_last_fisc_mth_strt_dt\n                           || ' Fisc_Mth_Strt_dt: '\n                           || v_fisc_mth_strt_dt\n                           || SYSTIMESTAMP);\n\n      OPEN next_clsfctn(v_last_fisc_mth_strt_dt, v_fisc_mth_strt_dt);\n\n      LOOP\n         EXIT WHEN next_clsfctn%NOTFOUND;\n\n         FETCH next_clsfctn\n         BULK COLLECT INTO r_next_clsfctn\n         LIMIT 10000;\n\n         FORALL i IN 1 .. a40379090e2d5c70f7c7cb891cea0864.c838adb0c77d39edf51006214ba6e643()\n            UPDATE \n                  de459e2fe7f96e4d958537b31b946b26.1127751f1872aa967342f1fcf6b2ff72e472b097974b0d6a9a7d2ed170324906 b\n               SET next_fisc_mth_cust_clsfctn      = r_next_clsfctn(i).next_fisc_mth_cust_clsfctn,\n                   nbr_of_wk_ordr_next_fisc_mth    = r_next_clsfctn(i).nbr_of_wk_ordr_next_fisc_mth,\n                   next_fmth_unfrm_grs_sls_extnd   = r_next_clsfctn(i).next_fmth_unfrm_grs_sls_extnd,\n                   next_fmth_unfrm_tagp            = r_next_clsfctn(i).next_fmth_unfrm_tagp,\n                   next_fmth_unfrm_qty_ship        = r_next_clsfctn(i).next_fmth_unfrm_qty_ship,\n                   next_fmth_unfrm_grs_tgp         = r_next_clsfctn(i).next_fmth_unfrm_grs_tgp \n             WHERE 6d9b37be5a083f8b78d676aba846c823.839c4ffb4bfaae1bb58eab4dee67d96a = r_next_clsfctn(i).div_nbr\n               AND 6d9b37be5a083f8b78d676aba846c823.852fa1e9f02f1ca2c75837f7146b2381 = r_next_clsfctn(i).cust_nbr\n               AND 6d9b37be5a083f8b78d676aba846c823.d3ec1a21507970329af1c66ef244cdefe32f6dd38f333cde68119d1f277367cd = r_next_clsfctn(i).fisc_mth_strt_dt\n               AND 6d9b37be5a083f8b78d676aba846c823.7f599f836c449bebb92bb9757e86c603 = r_next_clsfctn(i).cust_sk;\n      END LOOP;\n\n      CLOSE next_clsfctn;\n\n      DBMS_OUTPUT.put_line('Next Fisc Mth Cust Clsfctn Rows Updated' || ' ' || sql%ROWCOUNT);\n      COMMIT;\n\n      DBMS_OUTPUT.put_line('Processing End of Month Third_fisc_mth_cust_Clsfctn Update' || SYSTIMESTAMP);\n      DBMS_OUTPUT.put_line(   'Processing Fisc_Mth_Strt_dt_Third_Month_Ago: '\n                           || v_fisc_mth_strt_dt_3_mth_ago\n                           || ' Fisc_Mth_Strt_dt: '\n                           || v_fisc_mth_strt_dt\n                           || SYSTIMESTAMP);\n\n      OPEN third_clsfctn(v_fisc_mth_strt_dt_6_mth_ago, v_fisc_mth_strt_dt);\n\n      LOOP\n         EXIT WHEN third_clsfctn%NOTFOUND;\n\n         FETCH third_clsfctn\n         BULK COLLECT INTO r_third_clsfctn\n         LIMIT 10000;\n\n         FORALL i IN 1 .. 8b4d614e7ca6564327a5bbb88d173d91.c838adb0c77d39edf51006214ba6e643()\n            UPDATE \n                  de459e2fe7f96e4d958537b31b946b26.1127751f1872aa967342f1fcf6b2ff72e472b097974b0d6a9a7d2ed170324906 b\n               SET third_fisc_mth_cust_clsfctn   = r_third_clsfctn(i).third_fisc_mth_cust_clsfctn\n             WHERE 6d9b37be5a083f8b78d676aba846c823.839c4ffb4bfaae1bb58eab4dee67d96a = r_third_clsfctn(i).div_nbr\n               AND 6d9b37be5a083f8b78d676aba846c823.852fa1e9f02f1ca2c75837f7146b2381 = r_third_clsfctn(i).cust_nbr\n               AND 6d9b37be5a083f8b78d676aba846c823.d3ec1a21507970329af1c66ef244cdefe32f6dd38f333cde68119d1f277367cd = r_third_clsfctn(i).fisc_mth_strt_dt\n               AND 6d9b37be5a083f8b78d676aba846c823.7f599f836c449bebb92bb9757e86c603 = r_third_clsfctn(i).cust_sk;\n      END LOOP;\n\n      CLOSE third_clsfctn;\n\n      DBMS_OUTPUT.put_line('Third Fisc Mth Cust Clsfctn Rows Updated' || ' ' || sql%ROWCOUNT);\n      COMMIT;\n\n      DBMS_OUTPUT.put_line('Processing End of Month Sixth_fisc_mth_cust_Clsfctn Update' || SYSTIMESTAMP);\n      DBMS_OUTPUT.put_line(   'Processing Fisc_Mth_Strt_dt_Sixth_Month_Ago: '\n                           || v_fisc_mth_strt_dt_6_mth_ago\n                           || ' Fisc_Mth_Strt_dt: '\n                           || v_fisc_mth_strt_dt\n                           || SYSTIMESTAMP);\n\n      OPEN sixth_clsfctn(v_fisc_mth_strt_dt_6_mth_ago, v_fisc_mth_strt_dt);\n\n      LOOP\n         EXIT WHEN sixth_clsfctn%NOTFOUND;\n\n         FETCH sixth_clsfctn\n         BULK COLLECT INTO r_sixth_clsfctn\n         LIMIT 10000;\n\n         FORALL i IN 1 .. 6dfe6e7962b8fba9aebaf557f08fc85e.c838adb0c77d39edf51006214ba6e643()\n            UPDATE \n                  de459e2fe7f96e4d958537b31b946b26.1127751f1872aa967342f1fcf6b2ff72e472b097974b0d6a9a7d2ed170324906 b\n               SET sixth_fisc_mth_cust_clsfctn   = r_sixth_clsfctn(i).sixth_fisc_mth_cust_clsfctn\n             WHERE 6d9b37be5a083f8b78d676aba846c823.839c4ffb4bfaae1bb58eab4dee67d96a = r_sixth_clsfctn(i).div_nbr\n               AND 6d9b37be5a083f8b78d676aba846c823.852fa1e9f02f1ca2c75837f7146b2381 = r_sixth_clsfctn(i).cust_nbr\n               AND 6d9b37be5a083f8b78d676aba846c823.d3ec1a21507970329af1c66ef244cdefe32f6dd38f333cde68119d1f277367cd = r_sixth_clsfctn(i).fisc_mth_strt_dt\n               AND 6d9b37be5a083f8b78d676aba846c823.7f599f836c449bebb92bb9757e86c603 = r_sixth_clsfctn(i).cust_sk;\n      END LOOP;\n\n      CLOSE sixth_clsfctn;\n\n      DBMS_OUTPUT.put_line('Sixth Fisc Mth Cust Clsfctn Rows Updated' || '  ' || sql%ROWCOUNT);\n      COMMIT;\n   END IF;\n\n   RETURN 0;\nEXCEPTION\n   WHEN OTHERS THEN\n      DBMS_OUTPUT.put_line('Error in 0e03d5c46556a742ba46252698396ef2.04b60e9fcf522f8ae0ac9ad879895e77e32f6dd38f333cde68119d1f277367cd:' || SQLCODE || ' ' || SQLERRM);\n      RETURN 1;\nEND fn_cust_cls_wkly;\n/",
            "upstream_dependencies": [],
            "downstream_dependencies": [],
            "dag_location": "null",
            "gantt_location": "null",
            "created_at": "null",
            "updated_at": "null"
        },
        {
            "name": "FN_RGN_SLS_PRJ_LOAD",
            "encrypted_name": "cbe16cab5746d7cb0053faf5c37cc5eca7d2c123ab08f9acde20fb7e42f4f726",
            "type": "function",
            "database": "null",
            "encrypted_database": "null",
            "schema": "XDMADM",
            "encrypted_schema": "0e03d5c46556a742ba46252698396ef2",
            "fully_qualified_name": "XDMADM.FN_RGN_SLS_PRJ_LOAD",
            "encrypted_fqn": "0e03d5c46556a742ba46252698396ef2.cbe16cab5746d7cb0053faf5c37cc5eca7d2c123ab08f9acde20fb7e42f4f726",
            "synonyms": [],
            "metadata_analysis": "CREATE OR REPLACE FUNCTION \"0e03d5c46556a742ba46252698396ef2\".\"cbe16cab5746d7cb0053faf5c37cc5eca7d2c123ab08f9acde20fb7e42f4f726\" (odate IN DATE)\n   RETURN NUMBER AS\n   \n\n   c_num_past_wks           CONSTANT NUMBER := 6; \n   c_num_prj_wks            CONSTANT NUMBER := 5; \n\n   l_first_source_wk        VARCHAR2(6);\n   l_last_source_wk         VARCHAR2(6);\n   l_first_source_wk_ly     VARCHAR2(6);\n   l_last_source_wk_ly      VARCHAR2(6);\n   l_first_prj_wk           VARCHAR2(6);\n   l_last_prj_wk            VARCHAR2(6);\n   l_use_default_mode       BOOLEAN;\n   l_aggr_inactive_tbl      VARCHAR2(30);\n   l_prj_inactive_tbl       VARCHAR2(30);\n   l_prj_inactive_tbl_cnt   NUMBER := 0;\n   l_aggr_dim_query         VARCHAR2(2000);\n   l_insert_query           VARCHAR2(2000);\n   l_cur_syn_tbl            VARCHAR2(30);\n\n   l_return_code            NUMBER := 0;\n   l_object_nm              VARCHAR2(30);\n   l_out_msg                VARCHAR2(256);\n\n   e_truncate_table exception;\n   e_analyze_table exception;\n   e_syn exception;\n\n   l_fn_start               DATE;\n\n   TYPE ref_get_aggr_dim IS REF CURSOR;\n\n   c_get_aggr_dim           ref_get_aggr_dim;\n\n   r_aggr_msr_null          76ded3481abebe7e101f31e7e9fb1d50.4a6565b7a628094e130b34a934dc7510;\n   r_aggr_msr_cy            76ded3481abebe7e101f31e7e9fb1d50.4a6565b7a628094e130b34a934dc7510;\n   r_aggr_msr_ly            76ded3481abebe7e101f31e7e9fb1d50.4a6565b7a628094e130b34a934dc7510;\n   r_aggr_msr_prj_ly        76ded3481abebe7e101f31e7e9fb1d50.4a6565b7a628094e130b34a934dc7510;\n   r_aggr_msr_first_wk_cy   76ded3481abebe7e101f31e7e9fb1d50.4a6565b7a628094e130b34a934dc7510;\n   r_aggr_msr_last_wk_cy    76ded3481abebe7e101f31e7e9fb1d50.4a6565b7a628094e130b34a934dc7510;\n   r_aggr_msr_prj           76ded3481abebe7e101f31e7e9fb1d50.4a6565b7a628094e130b34a934dc7510;\n   r_aggr_msr_wow_avg       76ded3481abebe7e101f31e7e9fb1d50.4a6565b7a628094e130b34a934dc7510;\n   r_aggr_msr_growth        76ded3481abebe7e101f31e7e9fb1d50.bea9a3788bccaa9f62f1a2ca85b07b6d;\n\n   r_aggr_dim               76ded3481abebe7e101f31e7e9fb1d50.5a903111006269f0e5a65274a85510f4;\n\n   CURSOR c_prj_wks(x_first_prj_wk IN VARCHAR2, x_last_prj_wk IN VARCHAR2) IS\n        SELECT fisc_yr_wk\n          FROM wkly_time_corp\n         WHERE fisc_yr_wk BETWEEN x_first_prj_wk AND x_last_prj_wk\n      ORDER BY fisc_yr_wk;\n\n   TYPE t_prj_wks IS TABLE OF de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.f2de255a7553ba934b1f05ae7699ae4c%TYPE\n                        INDEX BY BINARY_INTEGER;\n\n   r_prj_wks                t_prj_wks;\nBEGIN\n   l_fn_start             := SYSDATE;\n   l_first_source_wk      := 76ded3481abebe7e101f31e7e9fb1d50.9967022ee7745fd7bc5fb6560eb665be(odate - ((c_num_past_wks) * 7));\n   l_last_source_wk       := 76ded3481abebe7e101f31e7e9fb1d50.9967022ee7745fd7bc5fb6560eb665be(odate - 7);\n   l_first_source_wk_ly   := 76ded3481abebe7e101f31e7e9fb1d50.3361dc7cce0d132271ad15acd7bcf6bdcab8fe15377261bb333ef70c1086c9a3(l_first_source_wk, 1);\n   l_last_source_wk_ly    := 76ded3481abebe7e101f31e7e9fb1d50.3361dc7cce0d132271ad15acd7bcf6bdcab8fe15377261bb333ef70c1086c9a3(l_last_source_wk, 1);\n   l_first_prj_wk         := 76ded3481abebe7e101f31e7e9fb1d50.9967022ee7745fd7bc5fb6560eb665be(odate);\n   l_last_prj_wk          := 76ded3481abebe7e101f31e7e9fb1d50.9967022ee7745fd7bc5fb6560eb665be(odate + ((c_num_prj_wks - 1) * 7));\n   DBMS_OUTPUT.put_line('ODATE: ' || odate);\n   DBMS_OUTPUT.put_line('First Source Week: ' || l_first_source_wk);\n   DBMS_OUTPUT.put_line('Last Source Week: ' || l_last_source_wk);\n   DBMS_OUTPUT.put_line('First Source Week LY: ' || l_first_source_wk_ly);\n   DBMS_OUTPUT.put_line('Last Source Week LY: ' || l_last_source_wk_ly);\n   DBMS_OUTPUT.put_line('First Project Week: ' || l_first_prj_wk);\n   DBMS_OUTPUT.put_line('Last Project Week: ' || l_last_prj_wk);\n\n   \n   OPEN c_prj_wks(l_first_prj_wk, l_last_prj_wk);\n\n   FETCH c_prj_wks\n   BULK COLLECT INTO r_prj_wks;\n\n   CLOSE c_prj_wks;\n\n   \n   l_prj_inactive_tbl     := 76ded3481abebe7e101f31e7e9fb1d50.764db46f8b9234b5e07a7d1d4ce8fcd8(76ded3481abebe7e101f31e7e9fb1d50.682fb8bee72728857645bccb5103cb23, 'N');\n   l_aggr_inactive_tbl    := 76ded3481abebe7e101f31e7e9fb1d50.764db46f8b9234b5e07a7d1d4ce8fcd8(76ded3481abebe7e101f31e7e9fb1d50.716900750ba6b5d499e5b9bc59348974, 'N');\n\n   DBMS_OUTPUT.put_line('Inactive projection table: ' || l_prj_inactive_tbl);\n   DBMS_OUTPUT.put_line('Inactive aggr: ' || l_aggr_inactive_tbl);\n\n   \n   EXECUTE IMMEDIATE 'SELECT table_name FROM user_synonyms WHERE synonym_name = ''' || 76ded3481abebe7e101f31e7e9fb1d50.682fb8bee72728857645bccb5103cb23 || ''''\n      INTO l_cur_syn_tbl;\n\n      dbms_output.put_line('l_cur_syn_tbl ' || l_cur_syn_tbl);\n\n   IF (l_cur_syn_tbl = l_prj_inactive_tbl) THEN\n      RAISE e_syn;\n   END IF;\n\n   \n   EXECUTE IMMEDIATE 'SELECT count(1) FROM ' || l_prj_inactive_tbl INTO l_prj_inactive_tbl_cnt;\n\n   IF (l_prj_inactive_tbl_cnt > 0) THEN\n      DBMS_OUTPUT.put_line('Error: Inactive projection table has ' || l_prj_inactive_tbl_cnt || ' records in it');\n\n  l_return_code   := 8e64339f96bb08058f5d52f1c04f954a.8ffe4678890c39c7d4ed38c2ed759e24.e4b5db2b3f9b19accbb8cddbfcd05bac(l_out_msg, 76ded3481abebe7e101f31e7e9fb1d50.01ad20b6c8a2d0aaccf3dde9aaedb75e, l_prj_inactive_tbl);\n\n      IF (l_return_code <> 0) THEN\n         l_object_nm   := l_prj_inactive_tbl;\n         RAISE e_truncate_table;\n      END IF;\n\n      DBMS_OUTPUT.put_line('Inactive projection table truncated');\n   END IF;\n\n   \n   l_aggr_dim_query       :=\n         'SELECT DISTINCT 15017e6048ca426059d5ce62c0afead2.839c4ffb4bfaae1bb58eab4dee67d96a, 15017e6048ca426059d5ce62c0afead2.b122651d7c06503443c0d820e5e7bda7, 15017e6048ca426059d5ce62c0afead2.6e4a5754dec237b2d215aa9585f8a4068de1a66bac405de233c8de1af7988b02, 15017e6048ca426059d5ce62c0afead2.21a6675858ce67d43a7b6513100e2930dfb673c032e1fff141ac84551b91849a, 15017e6048ca426059d5ce62c0afead2.dd6238100904f569270d672fe0643a5a, '\n      || ' 15017e6048ca426059d5ce62c0afead2.909573c485e39cfe1c127c1a279986fd, 15017e6048ca426059d5ce62c0afead2.5112ab47fb19df73f8ed2678ddc0ecdbe6e6300089dae5a98e31814d0406060f, 15017e6048ca426059d5ce62c0afead2.5b166c5fe66db413f1e228635901a096e32f6dd38f333cde68119d1f277367cd, 15017e6048ca426059d5ce62c0afead2.c1a0243994c58a08334e325e29a31260'\n      || ' FROM '\n      || l_aggr_inactive_tbl || ' a, '\n      || ' DIV_CORP d '\n      || ' WHERE  fisc_yr_wk BETWEEN '''\n      || l_first_source_wk\n      || ''' AND '''\n      || l_last_source_wk\n      || ''''\n      || ' AND 8d75a8f2ab4850b84709184da29f9cdb.4fdc122fb2d10dd764e32cbc98972eca = 15017e6048ca426059d5ce62c0afead2.dd95a4741b2ab36b2428b3c42ef8b0448cd47113485ed05c776655af504ed664'\n      || ' AND 8d75a8f2ab4850b84709184da29f9cdb.9390381abcb131475214e65c6374a79c <> ''CC''';\n\n   DBMS_OUTPUT.put_line(l_aggr_dim_query);\n\n   \n   OPEN c_get_aggr_dim FOR l_aggr_dim_query;\n\n   LOOP\n      FETCH c_get_aggr_dim INTO r_aggr_dim;\n\n      EXIT WHEN c_get_aggr_dim%NOTFOUND;\n      \n      r_aggr_msr_wow_avg   := r_aggr_msr_null;\n\n      \n      r_aggr_msr_cy        := 76ded3481abebe7e101f31e7e9fb1d50.fe22ea3cbfc14cb9f2dc33453214c59f(l_first_source_wk, l_last_source_wk, r_aggr_dim);\n      r_aggr_msr_ly        := 76ded3481abebe7e101f31e7e9fb1d50.fe22ea3cbfc14cb9f2dc33453214c59f(l_first_source_wk_ly, l_last_source_wk_ly, r_aggr_dim);\n\n      \n      IF (\n         (3e1e75ff948176615e249ecb3130504f.80bed7bf10aa6c209fe2db0848bd6119 <> 0)\n       OR (bae08ff1d598cec947fcf6a766cf7ab5.80bed7bf10aa6c209fe2db0848bd6119 <> 0)\n       OR (3e1e75ff948176615e249ecb3130504f.31b355c93a24143ca3e1ae5b2fe5491b <> 0)\n       OR (bae08ff1d598cec947fcf6a766cf7ab5.31b355c93a24143ca3e1ae5b2fe5491b <> 0)\n       OR (3e1e75ff948176615e249ecb3130504f.eb6a312932db943ec140f42c7c8998cf <> 0)\n       OR (bae08ff1d598cec947fcf6a766cf7ab5.eb6a312932db943ec140f42c7c8998cf <> 0)\n       OR (3e1e75ff948176615e249ecb3130504f.4f1272f7dffc94b9e882fd01e6907270 <> 0)                       \n       OR (bae08ff1d598cec947fcf6a766cf7ab5.4f1272f7dffc94b9e882fd01e6907270 <> 0)                       \n       OR (3e1e75ff948176615e249ecb3130504f.0eb04e3d5b6a06d91d9f4c76179a4931 <> 0)                       \n       OR (bae08ff1d598cec947fcf6a766cf7ab5.0eb04e3d5b6a06d91d9f4c76179a4931 <> 0)                       \n       OR (3e1e75ff948176615e249ecb3130504f.749e34914a6f5722a4481aae0afcb0bc <> 0)                       \n       OR (bae08ff1d598cec947fcf6a766cf7ab5.749e34914a6f5722a4481aae0afcb0bc <> 0)                       \n       )\n       THEN\n         \n         IF ((bae08ff1d598cec947fcf6a766cf7ab5.80bed7bf10aa6c209fe2db0848bd6119 > 0)\n          OR (bae08ff1d598cec947fcf6a766cf7ab5.31b355c93a24143ca3e1ae5b2fe5491b <> 0)\n          OR (bae08ff1d598cec947fcf6a766cf7ab5.eb6a312932db943ec140f42c7c8998cf <> 0)\n          OR (bae08ff1d598cec947fcf6a766cf7ab5.4f1272f7dffc94b9e882fd01e6907270 <> 0)                     \n          OR (bae08ff1d598cec947fcf6a766cf7ab5.0eb04e3d5b6a06d91d9f4c76179a4931 <> 0)                     \n          OR (bae08ff1d598cec947fcf6a766cf7ab5.749e34914a6f5722a4481aae0afcb0bc <> 0)                     \n        ) THEN\n            l_use_default_mode        := TRUE;\n\n            \n            6134292ce3dadee8576505733d6619de21f63f8e9547c6cfd5c00f97c721e9a0.80bed7bf10aa6c209fe2db0848bd6119   := 76ded3481abebe7e101f31e7e9fb1d50.322bb3805ce9f934b5f622f78f11e7d9(3e1e75ff948176615e249ecb3130504f.80bed7bf10aa6c209fe2db0848bd6119, bae08ff1d598cec947fcf6a766cf7ab5.80bed7bf10aa6c209fe2db0848bd6119);\n            6134292ce3dadee8576505733d6619de21f63f8e9547c6cfd5c00f97c721e9a0.31b355c93a24143ca3e1ae5b2fe5491b   := 76ded3481abebe7e101f31e7e9fb1d50.322bb3805ce9f934b5f622f78f11e7d9(3e1e75ff948176615e249ecb3130504f.31b355c93a24143ca3e1ae5b2fe5491b, bae08ff1d598cec947fcf6a766cf7ab5.31b355c93a24143ca3e1ae5b2fe5491b);\n            6134292ce3dadee8576505733d6619de21f63f8e9547c6cfd5c00f97c721e9a0.eb6a312932db943ec140f42c7c8998cf    := 76ded3481abebe7e101f31e7e9fb1d50.322bb3805ce9f934b5f622f78f11e7d9(3e1e75ff948176615e249ecb3130504f.eb6a312932db943ec140f42c7c8998cf, bae08ff1d598cec947fcf6a766cf7ab5.eb6a312932db943ec140f42c7c8998cf);\n            6134292ce3dadee8576505733d6619de21f63f8e9547c6cfd5c00f97c721e9a0.4f1272f7dffc94b9e882fd01e6907270 := 76ded3481abebe7e101f31e7e9fb1d50.322bb3805ce9f934b5f622f78f11e7d9(3e1e75ff948176615e249ecb3130504f.4f1272f7dffc94b9e882fd01e6907270, bae08ff1d598cec947fcf6a766cf7ab5.4f1272f7dffc94b9e882fd01e6907270);    \n            6134292ce3dadee8576505733d6619de21f63f8e9547c6cfd5c00f97c721e9a0.0eb04e3d5b6a06d91d9f4c76179a4931 := 76ded3481abebe7e101f31e7e9fb1d50.322bb3805ce9f934b5f622f78f11e7d9(3e1e75ff948176615e249ecb3130504f.0eb04e3d5b6a06d91d9f4c76179a4931, bae08ff1d598cec947fcf6a766cf7ab5.0eb04e3d5b6a06d91d9f4c76179a4931);    \n            6134292ce3dadee8576505733d6619de21f63f8e9547c6cfd5c00f97c721e9a0.749e34914a6f5722a4481aae0afcb0bc := 76ded3481abebe7e101f31e7e9fb1d50.322bb3805ce9f934b5f622f78f11e7d9(3e1e75ff948176615e249ecb3130504f.749e34914a6f5722a4481aae0afcb0bc, bae08ff1d598cec947fcf6a766cf7ab5.749e34914a6f5722a4481aae0afcb0bc);    \n\n         ELSE\n            l_use_default_mode         := FALSE;\n\n            \n            r_aggr_msr_growth          := 76ded3481abebe7e101f31e7e9fb1d50.27733fbe940827a8e644cffc47451ba3(l_first_source_wk, l_last_source_wk, r_aggr_dim);\n\n            \n            r_aggr_msr_wow_avg         := 76ded3481abebe7e101f31e7e9fb1d50.fe22ea3cbfc14cb9f2dc33453214c59f(l_first_source_wk, l_last_source_wk, r_aggr_dim);\n            91dc87bc0390a3c32812f7869e9c4be68a6113fa4ae05987b4b3e71f38de84c1.80bed7bf10aa6c209fe2db0848bd6119   := 91dc87bc0390a3c32812f7869e9c4be68a6113fa4ae05987b4b3e71f38de84c1.80bed7bf10aa6c209fe2db0848bd6119 / c_num_past_wks;\n            91dc87bc0390a3c32812f7869e9c4be68a6113fa4ae05987b4b3e71f38de84c1.31b355c93a24143ca3e1ae5b2fe5491b   := 91dc87bc0390a3c32812f7869e9c4be68a6113fa4ae05987b4b3e71f38de84c1.31b355c93a24143ca3e1ae5b2fe5491b / c_num_past_wks;\n            91dc87bc0390a3c32812f7869e9c4be68a6113fa4ae05987b4b3e71f38de84c1.eb6a312932db943ec140f42c7c8998cf    := 91dc87bc0390a3c32812f7869e9c4be68a6113fa4ae05987b4b3e71f38de84c1.eb6a312932db943ec140f42c7c8998cf / c_num_past_wks;\n            91dc87bc0390a3c32812f7869e9c4be68a6113fa4ae05987b4b3e71f38de84c1.4f1272f7dffc94b9e882fd01e6907270 := 91dc87bc0390a3c32812f7869e9c4be68a6113fa4ae05987b4b3e71f38de84c1.4f1272f7dffc94b9e882fd01e6907270 / c_num_past_wks;                                   \n            91dc87bc0390a3c32812f7869e9c4be68a6113fa4ae05987b4b3e71f38de84c1.0eb04e3d5b6a06d91d9f4c76179a4931 := 91dc87bc0390a3c32812f7869e9c4be68a6113fa4ae05987b4b3e71f38de84c1.0eb04e3d5b6a06d91d9f4c76179a4931 / c_num_past_wks;                                \n            91dc87bc0390a3c32812f7869e9c4be68a6113fa4ae05987b4b3e71f38de84c1.749e34914a6f5722a4481aae0afcb0bc := 91dc87bc0390a3c32812f7869e9c4be68a6113fa4ae05987b4b3e71f38de84c1.749e34914a6f5722a4481aae0afcb0bc / c_num_past_wks;                                \n\n            \n            r_aggr_msr_prj             := 76ded3481abebe7e101f31e7e9fb1d50.7bd87563f5300735654fc2799e33802c(r_aggr_msr_wow_avg, r_aggr_msr_growth);\n         END IF;\n\n         \n         FOR i IN 2748413e95f0c823a330ce4546aa7a9e.07f4dd260fecf0c31bad06cf354b1e62 .. 2748413e95f0c823a330ce4546aa7a9e.3ee46e182f9f30ed8605205ccd9a9d70 LOOP\n            \n            IF l_use_default_mode THEN\n               r_aggr_msr_prj_ly   :=\n                  76ded3481abebe7e101f31e7e9fb1d50.fe22ea3cbfc14cb9f2dc33453214c59f(76ded3481abebe7e101f31e7e9fb1d50.3361dc7cce0d132271ad15acd7bcf6bdcab8fe15377261bb333ef70c1086c9a3(r_prj_wks(i), 1),\n                  76ded3481abebe7e101f31e7e9fb1d50.3361dc7cce0d132271ad15acd7bcf6bdcab8fe15377261bb333ef70c1086c9a3(r_prj_wks(i), 1), r_aggr_dim);\n\n               r_aggr_msr_prj   := 76ded3481abebe7e101f31e7e9fb1d50.7bd87563f5300735654fc2799e33802c(r_aggr_msr_prj_ly, r_aggr_msr_growth);\n            END IF;\n\n            \n            \n            SELECT    'INSERT  INTO '\n                   || l_prj_inactive_tbl\n                   || ' VALUES ('\n                   || cb11c0d3fcaac2f719950de858a007eb.839c4ffb4bfaae1bb58eab4dee67d96a\n                   || ', '''\n                   || r_prj_wks(i)\n                   || ''', ''N'','\n                   || NVL(TO_CHAR(cb11c0d3fcaac2f719950de858a007eb.b122651d7c06503443c0d820e5e7bda7), 'NULL')\n                   || ', '\n                   || NVL(TO_CHAR(cb11c0d3fcaac2f719950de858a007eb.6e4a5754dec237b2d215aa9585f8a4068de1a66bac405de233c8de1af7988b02), 'NULL')\n                   || ', '\n                   || NVL(TO_CHAR(cb11c0d3fcaac2f719950de858a007eb.21a6675858ce67d43a7b6513100e2930dfb673c032e1fff141ac84551b91849a), 'NULL')\n                   || ', '\n                   || DECODE(cb11c0d3fcaac2f719950de858a007eb.dd6238100904f569270d672fe0643a5a, NULL, 'NULL,', '''' || cb11c0d3fcaac2f719950de858a007eb.dd6238100904f569270d672fe0643a5a || ''', ')\n                   || DECODE(cb11c0d3fcaac2f719950de858a007eb.909573c485e39cfe1c127c1a279986fd, NULL, 'NULL,', '''' || cb11c0d3fcaac2f719950de858a007eb.909573c485e39cfe1c127c1a279986fd || ''', ')\n                   || DECODE(cb11c0d3fcaac2f719950de858a007eb.5112ab47fb19df73f8ed2678ddc0ecdbe6e6300089dae5a98e31814d0406060f,\n                             NULL, 'NULL,',\n                             '''' || cb11c0d3fcaac2f719950de858a007eb.5112ab47fb19df73f8ed2678ddc0ecdbe6e6300089dae5a98e31814d0406060f || ''', ')\n                   || DECODE(cb11c0d3fcaac2f719950de858a007eb.5b166c5fe66db413f1e228635901a096e32f6dd38f333cde68119d1f277367cd, NULL, 'NULL,', '''' || cb11c0d3fcaac2f719950de858a007eb.5b166c5fe66db413f1e228635901a096e32f6dd38f333cde68119d1f277367cd || ''', ')\n                   || DECODE(cb11c0d3fcaac2f719950de858a007eb.c1a0243994c58a08334e325e29a31260, NULL, 'NULL,', '''' || cb11c0d3fcaac2f719950de858a007eb.c1a0243994c58a08334e325e29a31260 || ''', ')\n                   || NVL(b89d1e3496fdb6809547c88ff0732553.80bed7bf10aa6c209fe2db0848bd6119, 0)\n                   || ', '\n                   || NVL(b89d1e3496fdb6809547c88ff0732553.31b355c93a24143ca3e1ae5b2fe5491b, 0)\n                   || ', '\n                   || NVL(b89d1e3496fdb6809547c88ff0732553.eb6a312932db943ec140f42c7c8998cf, 0)\n                   || ', 0, 1'\n                   || ', '\n                   || NVL(b89d1e3496fdb6809547c88ff0732553.4f1272f7dffc94b9e882fd01e6907270, 0)\n                   || ', '\n                   || NVL(b89d1e3496fdb6809547c88ff0732553.0eb04e3d5b6a06d91d9f4c76179a4931, 0)\n                   || ', '\n                   || NVL(b89d1e3496fdb6809547c88ff0732553.749e34914a6f5722a4481aae0afcb0bc, 0)\n                   || ')'\n\n            INTO l_insert_query\n             FROM DUAL;\n\n            EXECUTE IMMEDIATE l_insert_query;\n         END LOOP;\n      END IF;\n   END LOOP;\n\n   CLOSE c_get_aggr_dim;\n\n   COMMIT;\n\n   EXECUTE IMMEDIATE 'SELECT count(1) FROM ' || l_prj_inactive_tbl INTO l_prj_inactive_tbl_cnt;\n\n   DBMS_OUTPUT.put_line(   'Inserted '\n                        || l_prj_inactive_tbl_cnt\n                        || ' rows in '\n                        || TO_CHAR(ROUND((SYSDATE - l_fn_start) * 86400))\n                        || ' seconds');\n\n   \n  l_return_code          := 8e64339f96bb08058f5d52f1c04f954a.17fcfcb378ff5051796afa7f02d0a322.9058a38aed65e271486900da66f7adf0(l_out_msg, 76ded3481abebe7e101f31e7e9fb1d50.01ad20b6c8a2d0aaccf3dde9aaedb75e, l_prj_inactive_tbl);\n\n   IF (l_return_code <> 0) THEN\n      l_object_nm   := l_prj_inactive_tbl;\n      RAISE e_analyze_table;\n   END IF;\n\n   DBMS_OUTPUT.put_line('Successfully created Sales Region Weekly Projection data');\n   RETURN 76ded3481abebe7e101f31e7e9fb1d50.79565b4ea20e0d36bc7365f1c4259002;\nEXCEPTION\n   WHEN e_syn THEN\n      DBMS_OUTPUT.put_line(\n         'Synonym currently points to inactive table: ' || l_cur_syn_tbl || '. Requires manual update.');\n      RETURN 76ded3481abebe7e101f31e7e9fb1d50.de3afdf274dc4a6f320906a012ba2f12;\n   WHEN e_truncate_table THEN\n      DBMS_OUTPUT.put_line('Error Truncating Table: ' || l_object_nm || '. Requires manual update.');\n      DBMS_OUTPUT.put_line(l_out_msg);\n      RETURN 76ded3481abebe7e101f31e7e9fb1d50.de3afdf274dc4a6f320906a012ba2f12;\n   WHEN e_analyze_table THEN\n      DBMS_OUTPUT.put_line('Error Analyzing Table: ' || l_object_nm || '. Requires manual update.');\n      DBMS_OUTPUT.put_line('Verify SYN_TBL_MAP active records match existing synonyms');\n      DBMS_OUTPUT.put_line(l_out_msg);\n      RETURN 76ded3481abebe7e101f31e7e9fb1d50.de3afdf274dc4a6f320906a012ba2f12;\n   WHEN OTHERS THEN\n      DBMS_OUTPUT.put_line('Error creating Sales Region Weekly Projection data');\n      DBMS_OUTPUT.put_line(SUBSTR(SQLERRM, 1, 2000));\n      RETURN 76ded3481abebe7e101f31e7e9fb1d50.de3afdf274dc4a6f320906a012ba2f12;\nEND;\n/",
            "upstream_dependencies": [],
            "downstream_dependencies": [],
            "dag_location": "null",
            "gantt_location": "null",
            "created_at": "null",
            "updated_at": "null"
        },
        {
            "name": "FN_SFTY_SECURITY_VPD",
            "encrypted_name": "4e5c031faa9723604893a36d85d853e36f3bf1564d2f7da4e41552c0a7d78051",
            "type": "function",
            "database": "null",
            "encrypted_database": "null",
            "schema": "XDMADM",
            "encrypted_schema": "0e03d5c46556a742ba46252698396ef2",
            "fully_qualified_name": "XDMADM.FN_SFTY_SECURITY_VPD",
            "encrypted_fqn": "0e03d5c46556a742ba46252698396ef2.4e5c031faa9723604893a36d85d853e36f3bf1564d2f7da4e41552c0a7d78051",
            "synonyms": [],
            "metadata_analysis": "CREATE OR REPLACE FUNCTION \"0e03d5c46556a742ba46252698396ef2\".\"4e5c031faa9723604893a36d85d853e36f3bf1564d2f7da4e41552c0a7d78051\" (p_schema       IN VARCHAR2,\n                                                p_objname      IN VARCHAR2)\n   RETURN VARCHAR2 AS\n   \n   c_start                CONSTANT NUMBER := DBMS_UTILITY.get_time;\n   c_fn_nm                CONSTANT VARCHAR2(30) := 'FN_SFTY_SECURITY_VPD';\n   l_security_predicate   VARCHAR2(4000) DEFAULT NULL;\n   l_cur_sql              VARCHAR2(4000) := SYS_CONTEXT('USERENV', 'CURRENT_SQL');\n   l_sbjct_area VARCHAR2(100)\n         := SYS_CONTEXT(9751bbbcfea690cc0be4d58830a6fe2e.9bfb5eb7793dc8fa6800d5a61e5e3e4e1e2f6ec194927f064ce6cb31fba71a32.f4a54ebc6f2c591ed4266aafe66971af, 9751bbbcfea690cc0be4d58830a6fe2e.9bfb5eb7793dc8fa6800d5a61e5e3e4e1e2f6ec194927f064ce6cb31fba71a32.3b1288ed835b1b524e9500bb13544956e6e6300089dae5a98e31814d0406060f);\n   l_vpd_exempt VARCHAR2(1)\n         := SYS_CONTEXT(9751bbbcfea690cc0be4d58830a6fe2e.9bfb5eb7793dc8fa6800d5a61e5e3e4e1e2f6ec194927f064ce6cb31fba71a32.f4a54ebc6f2c591ed4266aafe66971af, 9751bbbcfea690cc0be4d58830a6fe2e.9bfb5eb7793dc8fa6800d5a61e5e3e4e1e2f6ec194927f064ce6cb31fba71a32.0eaf613ab52a53601d1496b5650de81e);\n   l_all_divs VARCHAR2(1)\n         := SYS_CONTEXT(9751bbbcfea690cc0be4d58830a6fe2e.9bfb5eb7793dc8fa6800d5a61e5e3e4e1e2f6ec194927f064ce6cb31fba71a32.f4a54ebc6f2c591ed4266aafe66971af, 9751bbbcfea690cc0be4d58830a6fe2e.9bfb5eb7793dc8fa6800d5a61e5e3e4e1e2f6ec194927f064ce6cb31fba71a32.0f460756ee76d4a2460733464cda5f95);\n   l_prcs_end_date        VARCHAR2(8) DEFAULT NULL;\nBEGIN\n   \n   IF l_sbjct_area IS NULL THEN\n      l_security_predicate   := '1=2';\n      9751bbbcfea690cc0be4d58830a6fe2e.d4abe88ed2062b430c927bc84d61faf1f9a7aadf5998d448c2e2d1b0b47a3056.7d64937276682b23a0e16e5c61dad7aa('NO SA', c_fn_nm, USER, p_schema, p_objname, l_sbjct_area, l_vpd_exempt,\n      l_all_divs, l_cur_sql, l_security_predicate, (DBMS_UTILITY.get_time - c_start) / 100);\n\n      RETURN l_security_predicate;\n   END IF;\n\n   \n   \n   IF l_vpd_exempt = 'Y' THEN\n      l_security_predicate   := '1=1';\n      9751bbbcfea690cc0be4d58830a6fe2e.d4abe88ed2062b430c927bc84d61faf1f9a7aadf5998d448c2e2d1b0b47a3056.7d64937276682b23a0e16e5c61dad7aa('EXEMPT', c_fn_nm, USER, p_schema, p_objname, l_sbjct_area, l_vpd_exempt,\n      l_all_divs, l_cur_sql, l_security_predicate, (DBMS_UTILITY.get_time - c_start) / 100);\n\n      RETURN l_security_predicate;\n   END IF;\n\n   SELECT TO_CHAR(MIN(prcs_end_dt), 'YYYYMMDD')\n     INTO l_prcs_end_date\n     FROM wkly_dw_ctl\n    WHERE sbjct_area = 'SAFETY';\n\n   IF l_prcs_end_date IS NULL THEN\n      l_security_predicate   := '1=2'; \n      9751bbbcfea690cc0be4d58830a6fe2e.d4abe88ed2062b430c927bc84d61faf1f9a7aadf5998d448c2e2d1b0b47a3056.7d64937276682b23a0e16e5c61dad7aa('END DATE NOT FOUND', c_fn_nm, USER, p_schema, p_objname, l_sbjct_area,\n      l_vpd_exempt, l_all_divs, l_cur_sql, l_security_predicate);\n      RETURN l_security_predicate;\n   ELSE\n      l_security_predicate   := 'PRCS_END_DT <= TO_DATE (''' || l_prcs_end_date || ''',''YYYYMMDD'')';\n      9751bbbcfea690cc0be4d58830a6fe2e.d4abe88ed2062b430c927bc84d61faf1f9a7aadf5998d448c2e2d1b0b47a3056.7d64937276682b23a0e16e5c61dad7aa('END DATE FOUND', c_fn_nm, USER, p_schema, p_objname, l_sbjct_area,\n      l_vpd_exempt, l_all_divs, l_cur_sql, l_security_predicate, (DBMS_UTILITY.get_time - c_start) / 100);\n      RETURN l_security_predicate;\n   END IF;\nEXCEPTION\n   WHEN OTHERS THEN\n      l_security_predicate   := '1=2';\n      9751bbbcfea690cc0be4d58830a6fe2e.d4abe88ed2062b430c927bc84d61faf1f9a7aadf5998d448c2e2d1b0b47a3056.7d64937276682b23a0e16e5c61dad7aa(SQLCODE || '-' || SQLERRM, c_fn_nm, USER, p_schema, p_objname, l_sbjct_area,\n      l_vpd_exempt, l_all_divs, l_cur_sql, l_security_predicate, (DBMS_UTILITY.get_time - c_start) / 100);\n      RETURN l_security_predicate;\nEND fn_sfty_security_vpd;\n/",
            "upstream_dependencies": [],
            "downstream_dependencies": [],
            "dag_location": "null",
            "gantt_location": "null",
            "created_at": "null",
            "updated_at": "null"
        },
        {
            "name": "FN_GET_FISC_TIME_DT",
            "encrypted_name": "f4e695c1cd078a60bfb5f5d30ce0d27196d80a2abcaa623c1089db3130c3d181",
            "type": "function",
            "database": "null",
            "encrypted_database": "null",
            "schema": "XDMADM",
            "encrypted_schema": "0e03d5c46556a742ba46252698396ef2",
            "fully_qualified_name": "XDMADM.FN_GET_FISC_TIME_DT",
            "encrypted_fqn": "0e03d5c46556a742ba46252698396ef2.f4e695c1cd078a60bfb5f5d30ce0d27196d80a2abcaa623c1089db3130c3d181",
            "synonyms": [],
            "metadata_analysis": "CREATE OR REPLACE FUNCTION \"0e03d5c46556a742ba46252698396ef2\".\"f4e695c1cd078a60bfb5f5d30ce0d27196d80a2abcaa623c1089db3130c3d181\" (p_clndr_dt     IN DATE,\n                             p_timeframe    IN VARCHAR2)\n   RETURN DATE\n   DETERMINISTIC IS\n   l_st_dt    DATE;\n   l_end_dt   DATE;\nBEGIN\n   SELECT MIN(clndr_dt), MAX(clndr_dt)\n     INTO l_st_dt, l_end_dt\n     FROM de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001\n    WHERE ((p_timeframe LIKE 'WK%')\n       AND (fisc_yr_wk = fn_get_fisc_time(p_clndr_dt, 'WK')))\n       OR ((p_timeframe LIKE 'MTH%')\n       AND (fisc_yr_mth = fn_get_fisc_time(p_clndr_dt, 'MTH')))\n       OR ((p_timeframe LIKE 'YR%')\n       AND (fisc_yr = fn_get_fisc_time(p_clndr_dt, 'YR')));\n\n   IF p_timeframe LIKE '%ST_DT' THEN\n      RETURN l_st_dt;\n   ELSIF p_timeframe LIKE '%END_DT' THEN\n      RETURN l_end_dt;\n   END IF;\nEND fn_get_fisc_time_dt;\n/",
            "upstream_dependencies": [],
            "downstream_dependencies": [],
            "dag_location": "null",
            "gantt_location": "null",
            "created_at": "null",
            "updated_at": "null"
        },
        {
            "name": "FN_PYR_SLS_PRJ_LOAD",
            "encrypted_name": "e79ab285d163adbcdab32ba49789de45a7d2c123ab08f9acde20fb7e42f4f726",
            "type": "function",
            "database": "null",
            "encrypted_database": "null",
            "schema": "XDMADM",
            "encrypted_schema": "0e03d5c46556a742ba46252698396ef2",
            "fully_qualified_name": "XDMADM.FN_PYR_SLS_PRJ_LOAD",
            "encrypted_fqn": "0e03d5c46556a742ba46252698396ef2.e79ab285d163adbcdab32ba49789de45a7d2c123ab08f9acde20fb7e42f4f726",
            "synonyms": [],
            "metadata_analysis": "CREATE OR REPLACE FUNCTION \"0e03d5c46556a742ba46252698396ef2\".\"e79ab285d163adbcdab32ba49789de45a7d2c123ab08f9acde20fb7e42f4f726\" (odate IN DATE)\n   RETURN NUMBER AS\n   \n\n   c_num_past_wks           CONSTANT NUMBER := 6; \n   c_num_prj_wks            CONSTANT NUMBER := 5; \n\n   l_start_dt               DATE;\n\n   l_first_source_wk        VARCHAR2(6);\n   l_last_source_wk         VARCHAR2(6);\n   l_first_source_wk_ly     VARCHAR2(6);\n   l_last_source_wk_ly      VARCHAR2(6);\n   l_first_prj_wk           VARCHAR2(6);\n   l_last_prj_wk            VARCHAR2(6);\n   l_use_default_mode       BOOLEAN;\n   l_prj_inactive_tbl       VARCHAR2(30);\n   l_prj_inactive_tbl_cnt   NUMBER := 0;\n\n   l_return_code            NUMBER := 0;\n   l_object_nm              VARCHAR2(30);\n   l_out_msg                VARCHAR2(256);\n\n   e_truncate_table exception;\n   e_analyze_table exception;\n\n   l_fn_start               DATE;\n   l_analyze_start          DATE;\n   l_analyze_flag           VARCHAR2(10);\n\n   TYPE ref_get_aggr_dim IS REF CURSOR;\n\n   c_get_aggr_dim           ref_get_aggr_dim;\n\n   r_aggr_msr_null          6726798abbc757d8442516fefb8c40e9.4a6565b7a628094e130b34a934dc7510;\n   r_aggr_msr_cy            6726798abbc757d8442516fefb8c40e9.4a6565b7a628094e130b34a934dc7510;\n   r_aggr_msr_ly            6726798abbc757d8442516fefb8c40e9.4a6565b7a628094e130b34a934dc7510;\n   r_aggr_msr_prj_ly        6726798abbc757d8442516fefb8c40e9.4a6565b7a628094e130b34a934dc7510;\n   r_aggr_msr_prj           6726798abbc757d8442516fefb8c40e9.4a6565b7a628094e130b34a934dc7510;\n   r_aggr_msr_wow_avg       6726798abbc757d8442516fefb8c40e9.4a6565b7a628094e130b34a934dc7510;\n   r_aggr_msr_growth        6726798abbc757d8442516fefb8c40e9.bea9a3788bccaa9f62f1a2ca85b07b6d;\n\n   r_aggr_dim               6726798abbc757d8442516fefb8c40e9.5a903111006269f0e5a65274a85510f4;\n\n   CURSOR c_prj_wks(x_first_prj_wk IN VARCHAR2,\n                    x_last_prj_wk  IN VARCHAR2) IS\n        SELECT fisc_yr_wk\n        FROM wkly_time_corp\n        WHERE fisc_yr_wk BETWEEN x_first_prj_wk AND x_last_prj_wk\n        ORDER BY fisc_yr_wk;\n\n   TYPE t_prj_wks IS TABLE OF de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001.f2de255a7553ba934b1f05ae7699ae4c%TYPE\n                        INDEX BY BINARY_INTEGER;\n\n   r_prj_wks                t_prj_wks;\nBEGIN\n   l_fn_start             := SYSDATE;\n\n   IF (TO_CHAR(odate, 'D') = 7) THEN\n      l_start_dt   := odate + 1;\n   ELSE\n      l_start_dt   := odate;\n   END IF;\n\n   l_first_source_wk      := 6726798abbc757d8442516fefb8c40e9.9967022ee7745fd7bc5fb6560eb665be(l_start_dt - ((c_num_past_wks) * 7));\n   l_last_source_wk       := 6726798abbc757d8442516fefb8c40e9.9967022ee7745fd7bc5fb6560eb665be(l_start_dt - 7);\n   l_first_source_wk_ly   := 6726798abbc757d8442516fefb8c40e9.3361dc7cce0d132271ad15acd7bcf6bdcab8fe15377261bb333ef70c1086c9a3(l_first_source_wk, 1);\n   l_last_source_wk_ly    := 6726798abbc757d8442516fefb8c40e9.3361dc7cce0d132271ad15acd7bcf6bdcab8fe15377261bb333ef70c1086c9a3(l_last_source_wk, 1);\n   l_first_prj_wk         := 6726798abbc757d8442516fefb8c40e9.9967022ee7745fd7bc5fb6560eb665be(l_start_dt);\n   l_last_prj_wk          := 6726798abbc757d8442516fefb8c40e9.9967022ee7745fd7bc5fb6560eb665be(l_start_dt + ((c_num_prj_wks - 1) * 7));\n   DBMS_OUTPUT.put_line('ODATE: ' || odate);\n   DBMS_OUTPUT.put_line('Start Date: ' || l_start_dt);\n   DBMS_OUTPUT.put_line('First Source Week: ' || l_first_source_wk);\n   DBMS_OUTPUT.put_line('Last Source Week: ' || l_last_source_wk);\n   DBMS_OUTPUT.put_line('First Source Week LY: ' || l_first_source_wk_ly);\n   DBMS_OUTPUT.put_line('Last Source Week LY: ' || l_last_source_wk_ly);\n   DBMS_OUTPUT.put_line('First Project Week: ' || l_first_prj_wk);\n   DBMS_OUTPUT.put_line('Last Project Week: ' || l_last_prj_wk);\n\n   \n   OPEN c_prj_wks(l_first_prj_wk, l_last_prj_wk);\n\n   FETCH c_prj_wks\n   BULK COLLECT INTO r_prj_wks;\n\n   CLOSE c_prj_wks;\n\n   \n   l_prj_inactive_tbl     := 6726798abbc757d8442516fefb8c40e9.9ec0a2094ac13a62308e24fb7f2b1b19bda1840de9cdc6741dbf2a0e2cf40ade(6726798abbc757d8442516fefb8c40e9.bb4df339d3902dbcb7731c4222a97eb698df5d6b623334f2e9631188cca4cfd6);\n\n   \n   DBMS_OUTPUT.put_line('Inactive projection table: ' || l_prj_inactive_tbl);\n\n   \n   SELECT COUNT(*)\n   INTO l_prj_inactive_tbl_cnt\n   FROM SALES_SUMM_PYR_PRJ_LOAD;\n\n   IF (l_prj_inactive_tbl_cnt > 0) THEN\n      DBMS_OUTPUT.put_line('Error: Inactive projection table has ' || l_prj_inactive_tbl_cnt || ' records in it');\n\n      l_return_code   := 8e64339f96bb08058f5d52f1c04f954a.8ffe4678890c39c7d4ed38c2ed759e24.e4b5db2b3f9b19accbb8cddbfcd05bac(l_out_msg, 6726798abbc757d8442516fefb8c40e9.01ad20b6c8a2d0aaccf3dde9aaedb75e, l_prj_inactive_tbl);\n\n      IF (l_return_code <> 0) THEN\n         l_object_nm   := l_prj_inactive_tbl;\n         RAISE e_truncate_table;\n      END IF;\n\n      DBMS_OUTPUT.put_line('Inactive projection table truncated');\n   END IF;\n\n   \n\n   OPEN c_get_aggr_dim FOR\n   SELECT DISTINCT de459e2fe7f96e4d958537b31b946b26.4f5573ecc240798c6774115df73e2dc8dbb6d205235c82dab2c4ce1ac8425980.839c4ffb4bfaae1bb58eab4dee67d96a, de459e2fe7f96e4d958537b31b946b26.4f5573ecc240798c6774115df73e2dc8dbb6d205235c82dab2c4ce1ac8425980.b122651d7c06503443c0d820e5e7bda7, de459e2fe7f96e4d958537b31b946b26.4f5573ecc240798c6774115df73e2dc8dbb6d205235c82dab2c4ce1ac8425980.6e4a5754dec237b2d215aa9585f8a4068de1a66bac405de233c8de1af7988b02, de459e2fe7f96e4d958537b31b946b26.4f5573ecc240798c6774115df73e2dc8dbb6d205235c82dab2c4ce1ac8425980.21a6675858ce67d43a7b6513100e2930dfb673c032e1fff141ac84551b91849a, de459e2fe7f96e4d958537b31b946b26.4f5573ecc240798c6774115df73e2dc8dbb6d205235c82dab2c4ce1ac8425980.dd6238100904f569270d672fe0643a5a,\n   de459e2fe7f96e4d958537b31b946b26.4f5573ecc240798c6774115df73e2dc8dbb6d205235c82dab2c4ce1ac8425980.156f54b388a4986aa3d3d8e74d0fc0cd, de459e2fe7f96e4d958537b31b946b26.4f5573ecc240798c6774115df73e2dc8dbb6d205235c82dab2c4ce1ac8425980.5112ab47fb19df73f8ed2678ddc0ecdbe6e6300089dae5a98e31814d0406060f, de459e2fe7f96e4d958537b31b946b26.4f5573ecc240798c6774115df73e2dc8dbb6d205235c82dab2c4ce1ac8425980.5b166c5fe66db413f1e228635901a096e32f6dd38f333cde68119d1f277367cd, de459e2fe7f96e4d958537b31b946b26.4f5573ecc240798c6774115df73e2dc8dbb6d205235c82dab2c4ce1ac8425980.c1a0243994c58a08334e325e29a31260,\n   de459e2fe7f96e4d958537b31b946b26.4f5573ecc240798c6774115df73e2dc8dbb6d205235c82dab2c4ce1ac8425980.8a1e8ceb5e989a85c72d56e36fc3d742, de459e2fe7f96e4d958537b31b946b26.4f5573ecc240798c6774115df73e2dc8dbb6d205235c82dab2c4ce1ac8425980.e33988f12139bfc93f1e7557137feb5a29e110ac67769beb8c9647cf15a66d38, de459e2fe7f96e4d958537b31b946b26.4f5573ecc240798c6774115df73e2dc8dbb6d205235c82dab2c4ce1ac8425980.318678c82ff4517124bc3a6b8506d59463f2fe9cc6b573bb859641780443a51b, de459e2fe7f96e4d958537b31b946b26.4f5573ecc240798c6774115df73e2dc8dbb6d205235c82dab2c4ce1ac8425980.a2b201123c685e8cc48b5468cb4a449361bbd7bc0d2d67c7d7b11cb0a8d18d03\n   FROM de459e2fe7f96e4d958537b31b946b26.4f5573ecc240798c6774115df73e2dc8dbb6d205235c82dab2c4ce1ac8425980 a\n   WHERE fisc_yr_wk BETWEEN l_first_source_wk AND l_last_source_wk\n   ;\n   LOOP\n      FETCH c_get_aggr_dim INTO r_aggr_dim;\n      EXIT WHEN c_get_aggr_dim%NOTFOUND;\n\n\t  \n      r_aggr_msr_wow_avg   := r_aggr_msr_null;\n\n      \n      r_aggr_msr_cy        := 6726798abbc757d8442516fefb8c40e9.fe22ea3cbfc14cb9f2dc33453214c59f(l_first_source_wk, l_last_source_wk, r_aggr_dim);\n      r_aggr_msr_ly        := 6726798abbc757d8442516fefb8c40e9.fe22ea3cbfc14cb9f2dc33453214c59f(l_first_source_wk_ly, l_last_source_wk_ly, r_aggr_dim);\n\n\t  \n\n\t  IF ((3e1e75ff948176615e249ecb3130504f.80bed7bf10aa6c209fe2db0848bd6119 <> 0) OR (bae08ff1d598cec947fcf6a766cf7ab5.80bed7bf10aa6c209fe2db0848bd6119 <> 0) OR (3e1e75ff948176615e249ecb3130504f.31b355c93a24143ca3e1ae5b2fe5491b <> 0) OR (bae08ff1d598cec947fcf6a766cf7ab5.31b355c93a24143ca3e1ae5b2fe5491b <> 0)\n\t\tOR (3e1e75ff948176615e249ecb3130504f.eb6a312932db943ec140f42c7c8998cf <> 0) OR (bae08ff1d598cec947fcf6a766cf7ab5.eb6a312932db943ec140f42c7c8998cf <> 0) OR (3e1e75ff948176615e249ecb3130504f.62daf049a64bc975c00144a277a06f8f <> 0) OR (bae08ff1d598cec947fcf6a766cf7ab5.62daf049a64bc975c00144a277a06f8f <> 0)\n\t\tOR (3e1e75ff948176615e249ecb3130504f.4f1272f7dffc94b9e882fd01e6907270 <> 0) OR (bae08ff1d598cec947fcf6a766cf7ab5.4f1272f7dffc94b9e882fd01e6907270 <> 0) OR (3e1e75ff948176615e249ecb3130504f.0eb04e3d5b6a06d91d9f4c76179a4931 <> 0) OR (bae08ff1d598cec947fcf6a766cf7ab5.0eb04e3d5b6a06d91d9f4c76179a4931 <> 0)\n\t\tOR (3e1e75ff948176615e249ecb3130504f.749e34914a6f5722a4481aae0afcb0bc <> 0) OR (bae08ff1d598cec947fcf6a766cf7ab5.749e34914a6f5722a4481aae0afcb0bc <> 0)\n\t\tOR (3e1e75ff948176615e249ecb3130504f.9124f44d32ff81f2f0620eb53c13ad9cab532c4a01b63f0ae3437f0a75e66999 <> 0) OR (bae08ff1d598cec947fcf6a766cf7ab5.9124f44d32ff81f2f0620eb53c13ad9cab532c4a01b63f0ae3437f0a75e66999 <> 0)\n\t\tOR (3e1e75ff948176615e249ecb3130504f.7cdb91afa2a4d687a44abd3f36010e94 <> 0) OR (bae08ff1d598cec947fcf6a766cf7ab5.7cdb91afa2a4d687a44abd3f36010e94 <> 0)\n\t\tOR (3e1e75ff948176615e249ecb3130504f.5a946c48d4cb9b1b6880bf6386e276781d731bbdc4e3fb69a854112d4982eb99 <> 0) OR (bae08ff1d598cec947fcf6a766cf7ab5.5a946c48d4cb9b1b6880bf6386e276781d731bbdc4e3fb69a854112d4982eb99 <> 0)\n\t\tOR (3e1e75ff948176615e249ecb3130504f.6ec51d00c0df5a2c35ea4dc79b992a0ef4147ca167a57859c2f78f7521e7a9a8 <> 0) OR (bae08ff1d598cec947fcf6a766cf7ab5.6ec51d00c0df5a2c35ea4dc79b992a0ef4147ca167a57859c2f78f7521e7a9a8 <> 0)\n\t\tOR (3e1e75ff948176615e249ecb3130504f.bb26587da7cde1ca1883d4ac6949a349 <> 0) OR (bae08ff1d598cec947fcf6a766cf7ab5.bb26587da7cde1ca1883d4ac6949a349 <> 0)\n\t\tOR (3e1e75ff948176615e249ecb3130504f.d2a9879c73e438cd42a66e4ee567caf5e32f6dd38f333cde68119d1f277367cd <> 0) OR (bae08ff1d598cec947fcf6a766cf7ab5.d2a9879c73e438cd42a66e4ee567caf5e32f6dd38f333cde68119d1f277367cd <> 0)\n\t\tOR (3e1e75ff948176615e249ecb3130504f.6b3260c556af6890cf3ab676f017f510 <> 0) OR (bae08ff1d598cec947fcf6a766cf7ab5.6b3260c556af6890cf3ab676f017f510 <> 0)\n\t\tOR (3e1e75ff948176615e249ecb3130504f.bbba88aa390c897e4916ee82fb5a943a63f2fe9cc6b573bb859641780443a51b <> 0) OR (bae08ff1d598cec947fcf6a766cf7ab5.bbba88aa390c897e4916ee82fb5a943a63f2fe9cc6b573bb859641780443a51b <> 0)\n\t\tOR (3e1e75ff948176615e249ecb3130504f.d1987c8a23e55f6e34443ab156666710e32f6dd38f333cde68119d1f277367cd <> 0) OR (bae08ff1d598cec947fcf6a766cf7ab5.d1987c8a23e55f6e34443ab156666710e32f6dd38f333cde68119d1f277367cd <> 0)\n\t\tOR (3e1e75ff948176615e249ecb3130504f.6e542ef02858f01563263bab69643233 <> 0) OR (bae08ff1d598cec947fcf6a766cf7ab5.6e542ef02858f01563263bab69643233 <> 0)\n\t\tOR (3e1e75ff948176615e249ecb3130504f.15d48e2d392bdd1134fbff8c56790255 <> 0) OR (bae08ff1d598cec947fcf6a766cf7ab5.15d48e2d392bdd1134fbff8c56790255 <> 0)\n\t\tOR (3e1e75ff948176615e249ecb3130504f.aa1bb7fb31c2746d9127d17b4281cff1 <> 0) OR (bae08ff1d598cec947fcf6a766cf7ab5.aa1bb7fb31c2746d9127d17b4281cff1 <> 0)) THEN\n\n\t\t\n\t\tIF ((bae08ff1d598cec947fcf6a766cf7ab5.80bed7bf10aa6c209fe2db0848bd6119 <> 0) OR (bae08ff1d598cec947fcf6a766cf7ab5.31b355c93a24143ca3e1ae5b2fe5491b <> 0) OR (bae08ff1d598cec947fcf6a766cf7ab5.eb6a312932db943ec140f42c7c8998cf <> 0) OR (bae08ff1d598cec947fcf6a766cf7ab5.62daf049a64bc975c00144a277a06f8f <> 0)\n\t\t\tOR (bae08ff1d598cec947fcf6a766cf7ab5.4f1272f7dffc94b9e882fd01e6907270 <> 0) OR (bae08ff1d598cec947fcf6a766cf7ab5.0eb04e3d5b6a06d91d9f4c76179a4931 <> 0) OR (bae08ff1d598cec947fcf6a766cf7ab5.749e34914a6f5722a4481aae0afcb0bc <> 0)\n\t\t\tOR (bae08ff1d598cec947fcf6a766cf7ab5.9124f44d32ff81f2f0620eb53c13ad9cab532c4a01b63f0ae3437f0a75e66999 <> 0) OR (bae08ff1d598cec947fcf6a766cf7ab5.7cdb91afa2a4d687a44abd3f36010e94 <> 0)\n\t\t\tOR (bae08ff1d598cec947fcf6a766cf7ab5.5a946c48d4cb9b1b6880bf6386e276781d731bbdc4e3fb69a854112d4982eb99 <> 0) OR (bae08ff1d598cec947fcf6a766cf7ab5.6ec51d00c0df5a2c35ea4dc79b992a0ef4147ca167a57859c2f78f7521e7a9a8 <> 0)\n\t\t\tOR (bae08ff1d598cec947fcf6a766cf7ab5.bb26587da7cde1ca1883d4ac6949a349 <> 0) OR (bae08ff1d598cec947fcf6a766cf7ab5.d2a9879c73e438cd42a66e4ee567caf5e32f6dd38f333cde68119d1f277367cd <> 0)\n\t\t\tOR (bae08ff1d598cec947fcf6a766cf7ab5.6b3260c556af6890cf3ab676f017f510 <> 0) OR (bae08ff1d598cec947fcf6a766cf7ab5.bbba88aa390c897e4916ee82fb5a943a63f2fe9cc6b573bb859641780443a51b <> 0)\n\t\t\tOR (bae08ff1d598cec947fcf6a766cf7ab5.d1987c8a23e55f6e34443ab156666710e32f6dd38f333cde68119d1f277367cd <> 0) OR (bae08ff1d598cec947fcf6a766cf7ab5.6e542ef02858f01563263bab69643233 <> 0)\n\t\t\tOR (bae08ff1d598cec947fcf6a766cf7ab5.15d48e2d392bdd1134fbff8c56790255 <> 0) OR (bae08ff1d598cec947fcf6a766cf7ab5.aa1bb7fb31c2746d9127d17b4281cff1 <> 0)) THEN\n\n\t\t\tl_use_default_mode          := TRUE;\n\n\t\t\t\n            6134292ce3dadee8576505733d6619de21f63f8e9547c6cfd5c00f97c721e9a0.80bed7bf10aa6c209fe2db0848bd6119\t\t\t\t\t\t:= 6726798abbc757d8442516fefb8c40e9.322bb3805ce9f934b5f622f78f11e7d9(3e1e75ff948176615e249ecb3130504f.80bed7bf10aa6c209fe2db0848bd6119, bae08ff1d598cec947fcf6a766cf7ab5.80bed7bf10aa6c209fe2db0848bd6119);\n            6134292ce3dadee8576505733d6619de21f63f8e9547c6cfd5c00f97c721e9a0.31b355c93a24143ca3e1ae5b2fe5491b\t\t\t\t\t\t:= 6726798abbc757d8442516fefb8c40e9.322bb3805ce9f934b5f622f78f11e7d9(3e1e75ff948176615e249ecb3130504f.31b355c93a24143ca3e1ae5b2fe5491b, bae08ff1d598cec947fcf6a766cf7ab5.31b355c93a24143ca3e1ae5b2fe5491b);\n            6134292ce3dadee8576505733d6619de21f63f8e9547c6cfd5c00f97c721e9a0.eb6a312932db943ec140f42c7c8998cf\t\t\t\t\t\t:= 6726798abbc757d8442516fefb8c40e9.322bb3805ce9f934b5f622f78f11e7d9(3e1e75ff948176615e249ecb3130504f.eb6a312932db943ec140f42c7c8998cf, bae08ff1d598cec947fcf6a766cf7ab5.eb6a312932db943ec140f42c7c8998cf);\n            6134292ce3dadee8576505733d6619de21f63f8e9547c6cfd5c00f97c721e9a0.62daf049a64bc975c00144a277a06f8f\t\t\t\t\t\t:= 6726798abbc757d8442516fefb8c40e9.322bb3805ce9f934b5f622f78f11e7d9(3e1e75ff948176615e249ecb3130504f.62daf049a64bc975c00144a277a06f8f, bae08ff1d598cec947fcf6a766cf7ab5.62daf049a64bc975c00144a277a06f8f);\n            6134292ce3dadee8576505733d6619de21f63f8e9547c6cfd5c00f97c721e9a0.4f1272f7dffc94b9e882fd01e6907270\t\t\t\t\t:= 6726798abbc757d8442516fefb8c40e9.322bb3805ce9f934b5f622f78f11e7d9(3e1e75ff948176615e249ecb3130504f.4f1272f7dffc94b9e882fd01e6907270, bae08ff1d598cec947fcf6a766cf7ab5.4f1272f7dffc94b9e882fd01e6907270);\n            6134292ce3dadee8576505733d6619de21f63f8e9547c6cfd5c00f97c721e9a0.0eb04e3d5b6a06d91d9f4c76179a4931\t\t\t\t\t:= 6726798abbc757d8442516fefb8c40e9.322bb3805ce9f934b5f622f78f11e7d9(3e1e75ff948176615e249ecb3130504f.0eb04e3d5b6a06d91d9f4c76179a4931, bae08ff1d598cec947fcf6a766cf7ab5.0eb04e3d5b6a06d91d9f4c76179a4931);\n            6134292ce3dadee8576505733d6619de21f63f8e9547c6cfd5c00f97c721e9a0.749e34914a6f5722a4481aae0afcb0bc\t\t\t\t\t:= 6726798abbc757d8442516fefb8c40e9.322bb3805ce9f934b5f622f78f11e7d9(3e1e75ff948176615e249ecb3130504f.749e34914a6f5722a4481aae0afcb0bc, bae08ff1d598cec947fcf6a766cf7ab5.749e34914a6f5722a4481aae0afcb0bc);\n\t\t\t6134292ce3dadee8576505733d6619de21f63f8e9547c6cfd5c00f97c721e9a0.9124f44d32ff81f2f0620eb53c13ad9cab532c4a01b63f0ae3437f0a75e66999\t\t:= 6726798abbc757d8442516fefb8c40e9.322bb3805ce9f934b5f622f78f11e7d9(3e1e75ff948176615e249ecb3130504f.9124f44d32ff81f2f0620eb53c13ad9cab532c4a01b63f0ae3437f0a75e66999, bae08ff1d598cec947fcf6a766cf7ab5.9124f44d32ff81f2f0620eb53c13ad9cab532c4a01b63f0ae3437f0a75e66999);\n\t\t\t6134292ce3dadee8576505733d6619de21f63f8e9547c6cfd5c00f97c721e9a0.7cdb91afa2a4d687a44abd3f36010e94\t\t\t:= 6726798abbc757d8442516fefb8c40e9.322bb3805ce9f934b5f622f78f11e7d9(3e1e75ff948176615e249ecb3130504f.7cdb91afa2a4d687a44abd3f36010e94, bae08ff1d598cec947fcf6a766cf7ab5.7cdb91afa2a4d687a44abd3f36010e94);\n\t\t\t6134292ce3dadee8576505733d6619de21f63f8e9547c6cfd5c00f97c721e9a0.5a946c48d4cb9b1b6880bf6386e276781d731bbdc4e3fb69a854112d4982eb99\t\t\t:= 6726798abbc757d8442516fefb8c40e9.322bb3805ce9f934b5f622f78f11e7d9(3e1e75ff948176615e249ecb3130504f.5a946c48d4cb9b1b6880bf6386e276781d731bbdc4e3fb69a854112d4982eb99, bae08ff1d598cec947fcf6a766cf7ab5.5a946c48d4cb9b1b6880bf6386e276781d731bbdc4e3fb69a854112d4982eb99);\n\t\t\t6134292ce3dadee8576505733d6619de21f63f8e9547c6cfd5c00f97c721e9a0.6ec51d00c0df5a2c35ea4dc79b992a0ef4147ca167a57859c2f78f7521e7a9a8\t\t:= 6726798abbc757d8442516fefb8c40e9.322bb3805ce9f934b5f622f78f11e7d9(3e1e75ff948176615e249ecb3130504f.6ec51d00c0df5a2c35ea4dc79b992a0ef4147ca167a57859c2f78f7521e7a9a8, bae08ff1d598cec947fcf6a766cf7ab5.6ec51d00c0df5a2c35ea4dc79b992a0ef4147ca167a57859c2f78f7521e7a9a8);\n\t\t\t6134292ce3dadee8576505733d6619de21f63f8e9547c6cfd5c00f97c721e9a0.bb26587da7cde1ca1883d4ac6949a349\t\t\t:= 6726798abbc757d8442516fefb8c40e9.322bb3805ce9f934b5f622f78f11e7d9(3e1e75ff948176615e249ecb3130504f.bb26587da7cde1ca1883d4ac6949a349, bae08ff1d598cec947fcf6a766cf7ab5.bb26587da7cde1ca1883d4ac6949a349);\n\t\t\t6134292ce3dadee8576505733d6619de21f63f8e9547c6cfd5c00f97c721e9a0.d2a9879c73e438cd42a66e4ee567caf5e32f6dd38f333cde68119d1f277367cd\t\t\t:= 6726798abbc757d8442516fefb8c40e9.322bb3805ce9f934b5f622f78f11e7d9(3e1e75ff948176615e249ecb3130504f.d2a9879c73e438cd42a66e4ee567caf5e32f6dd38f333cde68119d1f277367cd, bae08ff1d598cec947fcf6a766cf7ab5.d2a9879c73e438cd42a66e4ee567caf5e32f6dd38f333cde68119d1f277367cd);\n\t\t\t6134292ce3dadee8576505733d6619de21f63f8e9547c6cfd5c00f97c721e9a0.6b3260c556af6890cf3ab676f017f510\t\t\t\t:= 6726798abbc757d8442516fefb8c40e9.322bb3805ce9f934b5f622f78f11e7d9(3e1e75ff948176615e249ecb3130504f.6b3260c556af6890cf3ab676f017f510, bae08ff1d598cec947fcf6a766cf7ab5.6b3260c556af6890cf3ab676f017f510);\n\t\t\t6134292ce3dadee8576505733d6619de21f63f8e9547c6cfd5c00f97c721e9a0.bbba88aa390c897e4916ee82fb5a943a63f2fe9cc6b573bb859641780443a51b\t\t\t:= 6726798abbc757d8442516fefb8c40e9.322bb3805ce9f934b5f622f78f11e7d9(3e1e75ff948176615e249ecb3130504f.bbba88aa390c897e4916ee82fb5a943a63f2fe9cc6b573bb859641780443a51b, bae08ff1d598cec947fcf6a766cf7ab5.bbba88aa390c897e4916ee82fb5a943a63f2fe9cc6b573bb859641780443a51b);\n\t\t\t6134292ce3dadee8576505733d6619de21f63f8e9547c6cfd5c00f97c721e9a0.d1987c8a23e55f6e34443ab156666710e32f6dd38f333cde68119d1f277367cd\t\t\t:= 6726798abbc757d8442516fefb8c40e9.322bb3805ce9f934b5f622f78f11e7d9(3e1e75ff948176615e249ecb3130504f.d1987c8a23e55f6e34443ab156666710e32f6dd38f333cde68119d1f277367cd, bae08ff1d598cec947fcf6a766cf7ab5.d1987c8a23e55f6e34443ab156666710e32f6dd38f333cde68119d1f277367cd);\n\t\t\t6134292ce3dadee8576505733d6619de21f63f8e9547c6cfd5c00f97c721e9a0.6e542ef02858f01563263bab69643233\t\t\t\t:= 6726798abbc757d8442516fefb8c40e9.322bb3805ce9f934b5f622f78f11e7d9(3e1e75ff948176615e249ecb3130504f.6e542ef02858f01563263bab69643233, bae08ff1d598cec947fcf6a766cf7ab5.6e542ef02858f01563263bab69643233);\n\t\t\t6134292ce3dadee8576505733d6619de21f63f8e9547c6cfd5c00f97c721e9a0.15d48e2d392bdd1134fbff8c56790255\t\t\t\t:= 6726798abbc757d8442516fefb8c40e9.322bb3805ce9f934b5f622f78f11e7d9(3e1e75ff948176615e249ecb3130504f.15d48e2d392bdd1134fbff8c56790255, bae08ff1d598cec947fcf6a766cf7ab5.15d48e2d392bdd1134fbff8c56790255);\n\t\t\t6134292ce3dadee8576505733d6619de21f63f8e9547c6cfd5c00f97c721e9a0.aa1bb7fb31c2746d9127d17b4281cff1\t\t\t\t:= 6726798abbc757d8442516fefb8c40e9.322bb3805ce9f934b5f622f78f11e7d9(3e1e75ff948176615e249ecb3130504f.aa1bb7fb31c2746d9127d17b4281cff1, bae08ff1d598cec947fcf6a766cf7ab5.aa1bb7fb31c2746d9127d17b4281cff1);\n\t\tELSE\n\n            l_use_default_mode           := FALSE;\n\n            \n            r_aggr_msr_growth            := 6726798abbc757d8442516fefb8c40e9.27733fbe940827a8e644cffc47451ba3(l_first_source_wk, l_last_source_wk, r_aggr_dim);\n\n            \n            r_aggr_msr_wow_avg           := 6726798abbc757d8442516fefb8c40e9.fe22ea3cbfc14cb9f2dc33453214c59f(l_first_source_wk, l_last_source_wk, r_aggr_dim);\n\n            91dc87bc0390a3c32812f7869e9c4be68a6113fa4ae05987b4b3e71f38de84c1.80bed7bf10aa6c209fe2db0848bd6119\t\t\t\t:= 91dc87bc0390a3c32812f7869e9c4be68a6113fa4ae05987b4b3e71f38de84c1.80bed7bf10aa6c209fe2db0848bd6119 / c_num_past_wks;\n            91dc87bc0390a3c32812f7869e9c4be68a6113fa4ae05987b4b3e71f38de84c1.31b355c93a24143ca3e1ae5b2fe5491b\t\t\t\t:= 91dc87bc0390a3c32812f7869e9c4be68a6113fa4ae05987b4b3e71f38de84c1.31b355c93a24143ca3e1ae5b2fe5491b / c_num_past_wks;\n            91dc87bc0390a3c32812f7869e9c4be68a6113fa4ae05987b4b3e71f38de84c1.eb6a312932db943ec140f42c7c8998cf\t\t\t\t\t:= 91dc87bc0390a3c32812f7869e9c4be68a6113fa4ae05987b4b3e71f38de84c1.eb6a312932db943ec140f42c7c8998cf / c_num_past_wks;\n            91dc87bc0390a3c32812f7869e9c4be68a6113fa4ae05987b4b3e71f38de84c1.62daf049a64bc975c00144a277a06f8f\t\t\t\t\t:= 91dc87bc0390a3c32812f7869e9c4be68a6113fa4ae05987b4b3e71f38de84c1.62daf049a64bc975c00144a277a06f8f / c_num_past_wks;\n            91dc87bc0390a3c32812f7869e9c4be68a6113fa4ae05987b4b3e71f38de84c1.4f1272f7dffc94b9e882fd01e6907270\t\t\t\t:= 91dc87bc0390a3c32812f7869e9c4be68a6113fa4ae05987b4b3e71f38de84c1.4f1272f7dffc94b9e882fd01e6907270 / c_num_past_wks;\n            91dc87bc0390a3c32812f7869e9c4be68a6113fa4ae05987b4b3e71f38de84c1.0eb04e3d5b6a06d91d9f4c76179a4931\t\t\t\t:= 91dc87bc0390a3c32812f7869e9c4be68a6113fa4ae05987b4b3e71f38de84c1.0eb04e3d5b6a06d91d9f4c76179a4931 / c_num_past_wks;\n            91dc87bc0390a3c32812f7869e9c4be68a6113fa4ae05987b4b3e71f38de84c1.749e34914a6f5722a4481aae0afcb0bc\t\t\t\t:= 91dc87bc0390a3c32812f7869e9c4be68a6113fa4ae05987b4b3e71f38de84c1.749e34914a6f5722a4481aae0afcb0bc / c_num_past_wks;\n\t\t\t91dc87bc0390a3c32812f7869e9c4be68a6113fa4ae05987b4b3e71f38de84c1.9124f44d32ff81f2f0620eb53c13ad9cab532c4a01b63f0ae3437f0a75e66999\t:= 91dc87bc0390a3c32812f7869e9c4be68a6113fa4ae05987b4b3e71f38de84c1.9124f44d32ff81f2f0620eb53c13ad9cab532c4a01b63f0ae3437f0a75e66999 / c_num_past_wks;\n\t\t\t91dc87bc0390a3c32812f7869e9c4be68a6113fa4ae05987b4b3e71f38de84c1.7cdb91afa2a4d687a44abd3f36010e94\t\t:= 91dc87bc0390a3c32812f7869e9c4be68a6113fa4ae05987b4b3e71f38de84c1.7cdb91afa2a4d687a44abd3f36010e94 / c_num_past_wks;\n\t\t\t91dc87bc0390a3c32812f7869e9c4be68a6113fa4ae05987b4b3e71f38de84c1.5a946c48d4cb9b1b6880bf6386e276781d731bbdc4e3fb69a854112d4982eb99\t:= 91dc87bc0390a3c32812f7869e9c4be68a6113fa4ae05987b4b3e71f38de84c1.5a946c48d4cb9b1b6880bf6386e276781d731bbdc4e3fb69a854112d4982eb99 / c_num_past_wks;\n\t\t\t91dc87bc0390a3c32812f7869e9c4be68a6113fa4ae05987b4b3e71f38de84c1.6ec51d00c0df5a2c35ea4dc79b992a0ef4147ca167a57859c2f78f7521e7a9a8\t:= 91dc87bc0390a3c32812f7869e9c4be68a6113fa4ae05987b4b3e71f38de84c1.6ec51d00c0df5a2c35ea4dc79b992a0ef4147ca167a57859c2f78f7521e7a9a8 / c_num_past_wks;\n\t\t\t91dc87bc0390a3c32812f7869e9c4be68a6113fa4ae05987b4b3e71f38de84c1.bb26587da7cde1ca1883d4ac6949a349\t\t:= 91dc87bc0390a3c32812f7869e9c4be68a6113fa4ae05987b4b3e71f38de84c1.bb26587da7cde1ca1883d4ac6949a349 / c_num_past_wks;\n\t\t\t91dc87bc0390a3c32812f7869e9c4be68a6113fa4ae05987b4b3e71f38de84c1.d2a9879c73e438cd42a66e4ee567caf5e32f6dd38f333cde68119d1f277367cd\t\t:= 91dc87bc0390a3c32812f7869e9c4be68a6113fa4ae05987b4b3e71f38de84c1.d2a9879c73e438cd42a66e4ee567caf5e32f6dd38f333cde68119d1f277367cd / c_num_past_wks;\n\t\t\t91dc87bc0390a3c32812f7869e9c4be68a6113fa4ae05987b4b3e71f38de84c1.6b3260c556af6890cf3ab676f017f510\t\t:= 91dc87bc0390a3c32812f7869e9c4be68a6113fa4ae05987b4b3e71f38de84c1.6b3260c556af6890cf3ab676f017f510 / c_num_past_wks;\n\t\t\t91dc87bc0390a3c32812f7869e9c4be68a6113fa4ae05987b4b3e71f38de84c1.bbba88aa390c897e4916ee82fb5a943a63f2fe9cc6b573bb859641780443a51b\t:= 91dc87bc0390a3c32812f7869e9c4be68a6113fa4ae05987b4b3e71f38de84c1.bbba88aa390c897e4916ee82fb5a943a63f2fe9cc6b573bb859641780443a51b / c_num_past_wks;\n\t\t\t91dc87bc0390a3c32812f7869e9c4be68a6113fa4ae05987b4b3e71f38de84c1.d1987c8a23e55f6e34443ab156666710e32f6dd38f333cde68119d1f277367cd\t\t:= 91dc87bc0390a3c32812f7869e9c4be68a6113fa4ae05987b4b3e71f38de84c1.d1987c8a23e55f6e34443ab156666710e32f6dd38f333cde68119d1f277367cd / c_num_past_wks;\n\t\t\t91dc87bc0390a3c32812f7869e9c4be68a6113fa4ae05987b4b3e71f38de84c1.6e542ef02858f01563263bab69643233\t\t:= 91dc87bc0390a3c32812f7869e9c4be68a6113fa4ae05987b4b3e71f38de84c1.6e542ef02858f01563263bab69643233 / c_num_past_wks;\n\t\t\t91dc87bc0390a3c32812f7869e9c4be68a6113fa4ae05987b4b3e71f38de84c1.15d48e2d392bdd1134fbff8c56790255\t\t\t:= 91dc87bc0390a3c32812f7869e9c4be68a6113fa4ae05987b4b3e71f38de84c1.15d48e2d392bdd1134fbff8c56790255 / c_num_past_wks;\n\t\t\t91dc87bc0390a3c32812f7869e9c4be68a6113fa4ae05987b4b3e71f38de84c1.aa1bb7fb31c2746d9127d17b4281cff1\t\t\t:= 91dc87bc0390a3c32812f7869e9c4be68a6113fa4ae05987b4b3e71f38de84c1.aa1bb7fb31c2746d9127d17b4281cff1 / c_num_past_wks;\n\n            \n            r_aggr_msr_prj               := 6726798abbc757d8442516fefb8c40e9.7bd87563f5300735654fc2799e33802c(r_aggr_msr_wow_avg, r_aggr_msr_growth);\n\t\tEND IF;\n\n\t\t\n\t\tFOR i IN 2748413e95f0c823a330ce4546aa7a9e.07f4dd260fecf0c31bad06cf354b1e62 .. 2748413e95f0c823a330ce4546aa7a9e.3ee46e182f9f30ed8605205ccd9a9d70 LOOP\n\n\t\t\t\n\t\t\tIF l_use_default_mode THEN\n               r_aggr_msr_prj_ly   := 6726798abbc757d8442516fefb8c40e9.fe22ea3cbfc14cb9f2dc33453214c59f(6726798abbc757d8442516fefb8c40e9.3361dc7cce0d132271ad15acd7bcf6bdcab8fe15377261bb333ef70c1086c9a3(r_prj_wks(i), 1), 6726798abbc757d8442516fefb8c40e9.3361dc7cce0d132271ad15acd7bcf6bdcab8fe15377261bb333ef70c1086c9a3(r_prj_wks(i), 1), r_aggr_dim);\n               r_aggr_msr_prj      := 6726798abbc757d8442516fefb8c40e9.7bd87563f5300735654fc2799e33802c(r_aggr_msr_prj_ly, r_aggr_msr_growth);\n            END IF;\n\n            \n            INSERT  INTO SALES_SUMM_PYR_PRJ_LOAD\n\t\t\tVALUES (cb11c0d3fcaac2f719950de858a007eb.839c4ffb4bfaae1bb58eab4dee67d96a, r_prj_wks(i), 'N', NVL(TO_CHAR(cb11c0d3fcaac2f719950de858a007eb.b122651d7c06503443c0d820e5e7bda7), 'NULL'), NVL(TO_CHAR(cb11c0d3fcaac2f719950de858a007eb.6e4a5754dec237b2d215aa9585f8a4068de1a66bac405de233c8de1af7988b02), 'NULL'),\n\t\t\t\tNVL(TO_CHAR(cb11c0d3fcaac2f719950de858a007eb.21a6675858ce67d43a7b6513100e2930dfb673c032e1fff141ac84551b91849a), 'NULL'), cb11c0d3fcaac2f719950de858a007eb.dd6238100904f569270d672fe0643a5a, cb11c0d3fcaac2f719950de858a007eb.156f54b388a4986aa3d3d8e74d0fc0cd, cb11c0d3fcaac2f719950de858a007eb.5112ab47fb19df73f8ed2678ddc0ecdbe6e6300089dae5a98e31814d0406060f,\n\t\t\t\tcb11c0d3fcaac2f719950de858a007eb.5b166c5fe66db413f1e228635901a096e32f6dd38f333cde68119d1f277367cd, cb11c0d3fcaac2f719950de858a007eb.c1a0243994c58a08334e325e29a31260, NVL(b89d1e3496fdb6809547c88ff0732553.80bed7bf10aa6c209fe2db0848bd6119, 0), NVL(b89d1e3496fdb6809547c88ff0732553.31b355c93a24143ca3e1ae5b2fe5491b, 0), NVL(b89d1e3496fdb6809547c88ff0732553.eb6a312932db943ec140f42c7c8998cf, 0),\n\t\t\t\tNVL(b89d1e3496fdb6809547c88ff0732553.62daf049a64bc975c00144a277a06f8f, 0),  cb11c0d3fcaac2f719950de858a007eb.8a1e8ceb5e989a85c72d56e36fc3d742, cb11c0d3fcaac2f719950de858a007eb.e33988f12139bfc93f1e7557137feb5a29e110ac67769beb8c9647cf15a66d38, NVL(b89d1e3496fdb6809547c88ff0732553.4f1272f7dffc94b9e882fd01e6907270, 0),\n\t\t\t\tNVL(b89d1e3496fdb6809547c88ff0732553.0eb04e3d5b6a06d91d9f4c76179a4931, 0), NVL(b89d1e3496fdb6809547c88ff0732553.749e34914a6f5722a4481aae0afcb0bc, 0), cb11c0d3fcaac2f719950de858a007eb.318678c82ff4517124bc3a6b8506d59463f2fe9cc6b573bb859641780443a51b, NVL(b89d1e3496fdb6809547c88ff0732553.9124f44d32ff81f2f0620eb53c13ad9cab532c4a01b63f0ae3437f0a75e66999, 0),\n\t\t\t\tNVL(b89d1e3496fdb6809547c88ff0732553.7cdb91afa2a4d687a44abd3f36010e94, 0), NVL(b89d1e3496fdb6809547c88ff0732553.5a946c48d4cb9b1b6880bf6386e276781d731bbdc4e3fb69a854112d4982eb99, 0), NVL(b89d1e3496fdb6809547c88ff0732553.6ec51d00c0df5a2c35ea4dc79b992a0ef4147ca167a57859c2f78f7521e7a9a8, 0),\n\t\t\t\tNVL(b89d1e3496fdb6809547c88ff0732553.bb26587da7cde1ca1883d4ac6949a349, 0), NVL(b89d1e3496fdb6809547c88ff0732553.d2a9879c73e438cd42a66e4ee567caf5e32f6dd38f333cde68119d1f277367cd, 0), NVL(b89d1e3496fdb6809547c88ff0732553.6b3260c556af6890cf3ab676f017f510, 0),\n\t\t\t\tNVL(b89d1e3496fdb6809547c88ff0732553.bbba88aa390c897e4916ee82fb5a943a63f2fe9cc6b573bb859641780443a51b, 0), NVL(TO_CHAR(cb11c0d3fcaac2f719950de858a007eb.a2b201123c685e8cc48b5468cb4a449361bbd7bc0d2d67c7d7b11cb0a8d18d03), 'NULL'),\n\t\t\t\tNVL(b89d1e3496fdb6809547c88ff0732553.d1987c8a23e55f6e34443ab156666710e32f6dd38f333cde68119d1f277367cd, 0), NVL(b89d1e3496fdb6809547c88ff0732553.6e542ef02858f01563263bab69643233, 0), NVL(b89d1e3496fdb6809547c88ff0732553.15d48e2d392bdd1134fbff8c56790255, 0),\n\t\t\t\tNVL(b89d1e3496fdb6809547c88ff0732553.aa1bb7fb31c2746d9127d17b4281cff1, 0));\n\t\tEND LOOP;\n\t  END IF;\n   END LOOP;\n\n   CLOSE c_get_aggr_dim;\n   COMMIT;\n\n   SELECT count(1)\n   INTO l_prj_inactive_tbl_cnt\n   FROM SALES_SUMM_PYR_PRJ_LOAD;\n\n   DBMS_OUTPUT.put_line('Inserted ' || l_prj_inactive_tbl_cnt || ' rows in ' || TO_CHAR(ROUND((SYSDATE - l_fn_start) * 86400)) || ' seconds');\n\n\n   l_analyze_start := SYSDATE;\n\n   \n   l_return_code := 8e64339f96bb08058f5d52f1c04f954a.17fcfcb378ff5051796afa7f02d0a322.9058a38aed65e271486900da66f7adf0(l_out_msg, 6726798abbc757d8442516fefb8c40e9.01ad20b6c8a2d0aaccf3dde9aaedb75e, l_prj_inactive_tbl);\n\n   IF (l_return_code <> 0) THEN\n      l_object_nm   := l_prj_inactive_tbl;\n      RAISE e_analyze_table;\n   END IF;\n\n   DBMS_OUTPUT.put_line('Analyzed ' || l_prj_inactive_tbl || ' in ' || TO_CHAR(ROUND((SYSDATE - l_analyze_start) * 86400)) || ' seconds');\n\n   DBMS_OUTPUT.put_line('Successfully created Sales Pyramid Weekly Projection data');\n   RETURN 6726798abbc757d8442516fefb8c40e9.79565b4ea20e0d36bc7365f1c4259002;\nEXCEPTION\n   WHEN e_truncate_table THEN\n      DBMS_OUTPUT.put_line('Error Truncating Table: ' || l_object_nm || '. Requires manual update.');\n      DBMS_OUTPUT.put_line(l_out_msg);\n      RETURN 6726798abbc757d8442516fefb8c40e9.de3afdf274dc4a6f320906a012ba2f12;\n   WHEN e_analyze_table THEN\n      DBMS_OUTPUT.put_line('Error Analyzing Table: ' || l_object_nm || '. Requires manual update.');\n      DBMS_OUTPUT.put_line('Verify SYN_TBL_MAP active records match existing synonyms');\n      DBMS_OUTPUT.put_line(l_out_msg);\n      RETURN 6726798abbc757d8442516fefb8c40e9.de3afdf274dc4a6f320906a012ba2f12;\n   WHEN OTHERS THEN\n      DBMS_OUTPUT.put_line('Error creating Sales Pyramid Weekly Projection data');\n      DBMS_OUTPUT.put_line(SUBSTR(SQLERRM, 1, 2000));\n      RETURN 6726798abbc757d8442516fefb8c40e9.de3afdf274dc4a6f320906a012ba2f12;\nEND;\n/",
            "upstream_dependencies": [],
            "downstream_dependencies": [],
            "dag_location": "null",
            "gantt_location": "null",
            "created_at": "null",
            "updated_at": "null"
        },
        {
            "name": "FN_AUGEO_SALES_EXTRCT",
            "encrypted_name": "03579739f6afaf29f47d72133ec89a605dd3a0cd5aacf18a29d4dcb73bc7945c",
            "type": "function",
            "database": "null",
            "encrypted_database": "null",
            "schema": "XDMADM",
            "encrypted_schema": "0e03d5c46556a742ba46252698396ef2",
            "fully_qualified_name": "XDMADM.FN_AUGEO_SALES_EXTRCT",
            "encrypted_fqn": "0e03d5c46556a742ba46252698396ef2.03579739f6afaf29f47d72133ec89a605dd3a0cd5aacf18a29d4dcb73bc7945c",
            "synonyms": [],
            "metadata_analysis": "CREATE OR REPLACE FUNCTION \"0e03d5c46556a742ba46252698396ef2\".\"03579739f6afaf29f47d72133ec89a605dd3a0cd5aacf18a29d4dcb73bc7945c\" (\n   p_partner_id   IN   VARCHAR2,\n   p_odate          IN   VARCHAR2,\n   p_yr               IN   NUMBER,\n   p_wk              IN   NUMBER\n)\n   RETURN NUMBER\nIS\n\n\n   \n   c_quote                 VARCHAR2 (1)     := '\"';\n   c_comma                 VARCHAR2 (1)     := ',';\n   v_prd_tbl_name          VARCHAR2 (25)   := 'AUGEO_SALES_EXTRCT';\n   v_fn_name               VARCHAR2 (25)   := 'FN_DDM_AUGEO_SALES_EXTRCT';\n   v_owner                 VARCHAR2 (9)    := 'xdmadm';\n   v_return_message        VARCHAR2 (2000) := NULL;\n   n_return_code           NUMBER          := 0;\n   wkstartdate             VARCHAR2 (14);\n   wkenddate               VARCHAR2 (14);\n   v_days                  number ;\n   v_ret_cd                number:= 0 ;\n   v_odate                 DATE := TO_DATE (p_odate, 'YYYYMMDD');\n   out_msg                 VARCHAR2(500)   := null;\n   twowkstrtdt             VARCHAR2 (14);\n   twowkenddt            VARCHAR2 (14);\n   v_days_acq\t\t\t\tnumber;\n\nBEGIN\n   DBMS_OUTPUT.PUT_LINE('START of function ' || v_owner || '.' || v_fn_name);\n   DBMS_OUTPUT.PUT_LINE('...');\n\n  \nbegin\n  select param_value_nbr into v_days\n  from de459e2fe7f96e4d958537b31b946b26.de40ae7be8b2eb3858d46af8d107f3db\n  where app_name = 'AUGEO_EXTRCT'\n      and PARAM_type = 'DAYS_BACK'\n      and param_code = 'Num_Days_back';\n\n\n  select param_value_nbr into v_days_acq\n  from de459e2fe7f96e4d958537b31b946b26.de40ae7be8b2eb3858d46af8d107f3db\n  where app_name = 'AUGEO_EXTRCT'\n      and PARAM_type = 'ACQ_DAYS_BACK'\n      and param_code = 'Acq_Num_Days_back';\n\n exception when others then\n    \n     dbms_output.put_line('...ERROR No data found in de459e2fe7f96e4d958537b31b946b26.de40ae7be8b2eb3858d46af8d107f3db table. ' );\n      dbms_output.put_line('...SQLERRM: ' || sqlerrm);\n      dbms_output.put_line('...SQLCODE: ' || sqlcode);\n      dbms_output.put_line('end of function ' || v_owner || '.' || v_fn_name);\n     return 2;\nend;\n\n   IF p_yr = 0 AND p_wk = 0 THEN\n      SELECT MIN(TO_CHAR(2bf1df9f95a63cca26ff198e426f4130.222ccb1d1746bcdb2365f29b3da0b613,'YYYYMMDDHH24MISS')),\n             MAX(TO_CHAR(2bf1df9f95a63cca26ff198e426f4130.222ccb1d1746bcdb2365f29b3da0b613,'YYYYMMDDHH24MISS'))\n      INTO wkstartdate, wkenddate\n      FROM de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001 tc\n      WHERE 2bf1df9f95a63cca26ff198e426f4130.ab30d6d679879cfacfe389b97d1d3f0e = (SELECT 9b2b4e9e9134cf535a4d37e3392176b7.ab30d6d679879cfacfe389b97d1d3f0e\n                         FROM de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001 tc2\n                         WHERE 9b2b4e9e9134cf535a4d37e3392176b7.222ccb1d1746bcdb2365f29b3da0b613 = TRUNC(v_odate - v_days))\n      AND   2bf1df9f95a63cca26ff198e426f4130.cb5e253886eb30a93e66cbf95203a754 = (SELECT 6e9d27d2b0190cd3e5b8d4eabe444f94.cb5e253886eb30a93e66cbf95203a754\n                               FROM de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001 tc3\n                               WHERE 6e9d27d2b0190cd3e5b8d4eabe444f94.222ccb1d1746bcdb2365f29b3da0b613 = TRUNC(v_odate - v_days));\n   ELSE\n      SELECT MIN(TO_CHAR(505bc7ea1eac5374f2d4fa1031cce750.222ccb1d1746bcdb2365f29b3da0b613,'YYYYMMDDHH24MISS')),\n             MAX(TO_CHAR(505bc7ea1eac5374f2d4fa1031cce750.222ccb1d1746bcdb2365f29b3da0b613,'YYYYMMDDHH24MISS'))\n      INTO wkstartdate, wkenddate\n      FROM de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001 tc4\n      WHERE 505bc7ea1eac5374f2d4fa1031cce750.ab30d6d679879cfacfe389b97d1d3f0e = p_yr\n      AND   505bc7ea1eac5374f2d4fa1031cce750.cb5e253886eb30a93e66cbf95203a754 = p_wk;\n   END IF;\n\n\n      SELECT MIN(TO_CHAR(2bf1df9f95a63cca26ff198e426f4130.222ccb1d1746bcdb2365f29b3da0b613,'YYYYMMDDHH24MISS')),\n             MAX(TO_CHAR(2bf1df9f95a63cca26ff198e426f4130.222ccb1d1746bcdb2365f29b3da0b613,'YYYYMMDDHH24MISS'))\n      INTO twowkstrtdt, twowkenddt\n      FROM de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001 tc\n      WHERE 2bf1df9f95a63cca26ff198e426f4130.ab30d6d679879cfacfe389b97d1d3f0e = (SELECT 9b2b4e9e9134cf535a4d37e3392176b7.ab30d6d679879cfacfe389b97d1d3f0e\n                         FROM de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001 tc2\n                         WHERE 9b2b4e9e9134cf535a4d37e3392176b7.222ccb1d1746bcdb2365f29b3da0b613 = TRUNC(v_odate - v_days_acq))\n      AND   2bf1df9f95a63cca26ff198e426f4130.cb5e253886eb30a93e66cbf95203a754 = (SELECT 6e9d27d2b0190cd3e5b8d4eabe444f94.cb5e253886eb30a93e66cbf95203a754\n                               FROM de459e2fe7f96e4d958537b31b946b26.476a877ff313a9e06b3ba262c317b001 tc3\n                               WHERE 6e9d27d2b0190cd3e5b8d4eabe444f94.222ccb1d1746bcdb2365f29b3da0b613 = TRUNC(v_odate - v_days_acq));\n\n\n   \n   BEGIN\n      DBMS_OUTPUT.PUT_LINE('...Truncating  ' || UPPER(RTRIM(SUBSTR(p_partner_id, 1, 30))));\n      DBMS_OUTPUT.PUT_LINE('...        table : ' || v_owner || '.' || v_prd_tbl_name);\n\n       \n      v_ret_cd := 8e64339f96bb08058f5d52f1c04f954a.8ffe4678890c39c7d4ed38c2ed759e24.e4b5db2b3f9b19accbb8cddbfcd05bac(out_msg, v_owner,  v_prd_tbl_name );\n      IF v_ret_cd <> 0 THEN\n        \n        dbms_output.put_line('end of function ' || v_owner || '.' || v_fn_name);\n        dbms_output.put_line('...Error '|| out_msg);\n        return 2;\n      END IF;\n\n   END;\n\n\n   BEGIN\n      DBMS_OUTPUT.PUT_LINE('...Inserting  into table : ' || v_owner || '.' || v_prd_tbl_name);\n      DBMS_OUTPUT.PUT_LINE('...Input Parameters Used: PARTNER_ID = ' || UPPER(RTRIM(SUBSTR(p_partner_id, 1, 30))));\n      DBMS_OUTPUT.PUT_LINE('...                      YEAR       = ' || p_yr);\n      DBMS_OUTPUT.PUT_LINE('...                      WEEK       = ' || p_wk);\n      DBMS_OUTPUT.PUT_LINE('...Date Parameters Used : Begin= ' || SUBSTR(wkstartdate, 1, 8));\n      DBMS_OUTPUT.PUT_LINE('...                        End= ' || SUBSTR(wkenddate, 1, 8));\n\n      INSERT  INTO de459e2fe7f96e4d958537b31b946b26.7044495387fa7a3d95c55968d4d6e7ccf7c554af09fd48f3c4c62c7d5043c349\n          NOLOGGING (KEY_augeo_SALES, DATA_augeo_SALES)\nWITH\n   user_emp AS (SELECT   user_id, empl_id from 5570e533d6550c773817895bd3b4a8a1.9be248913a43f1927ba37b04a74f806857a3138978a711d200b2c78dfa82e0b5),\n    ec_user AS (SELECT to_char(EC_USERID) EC_USERID, user_typ FROM de459e2fe7f96e4d958537b31b946b26.e431deb03d3e0b9b8035c0e250a401c6)\n                SELECT\n                  DISTINCT\n                  UPPER(RTRIM (SUBSTR ('AUGEO_SALES', 1, 30))),\n                  '\"' ||\n                  TRIM(NVL(TRANSLATE(c1f84e8860c9acbd312fc2d82a40cc08.1cb2540b20bdff2cba42229b96ddf301,'*^|><@\"~`&',' '),' '))\n                  ||'\",\"' ||\n                  TRIM(NVL(TRANSLATE(c1f84e8860c9acbd312fc2d82a40cc08.f163c0eb7a9bbba5c90dbb9e4f32ab9f,'*^|><@\"~`&',' '),' '))\n                  ||'\",\"' ||\n                  TRIM(NVL(TRANSLATE(42d2f22fd842b0cd27dffbea21620904.8708a839c00cf7a8852df326dbe38f05382d0f5d3019cd2839eb42d66c71274c,'*^|><@\"~`&',' '),' '))\n                  ||'\",\"' ||\n                  TRIM(NVL(TRANSLATE(c1f84e8860c9acbd312fc2d82a40cc08.a8578017628b84f4dd067faec4d9464f,'*^|><@\"~`&',' '),' '))\n                  ||'\",\"' ||\n                  TRIM(NVL(TRANSLATE(c1f84e8860c9acbd312fc2d82a40cc08.d3268eabc4a7d98105fd85f9c9e62cd6e32ad436514bbe822b33de8bead744f3,'*^|><@\"~`&','        '),' '))\n                  ||'\",\"' ||\n                  TRIM(NVL(TRANSLATE(42f98af8b44bfddfe984d4995da7a9c4.2d45d761eb8d137835bca7a23010fab4,'*^|><@\"~`&','        '),' '))\n                  ||'\",\"' ||\n                  TRIM(NVL(TRANSLATE(c1f84e8860c9acbd312fc2d82a40cc08.1be023bf16131ae1db14f4851cffcb11,'*^|><@\"~`&','     '),' '))\n                  ||'\",\"' ||\n                  TRIM(NVL(TRANSLATE(c1f84e8860c9acbd312fc2d82a40cc08.f5893bf557f879cfbf83e63ac2051e8815ebda0b6e5cc8d4c919a8c71a9d07e4,'*^|><@\"~`&','      '),' '))\n                  ||'\",\"' ||\n                  TRIM(NVL(TRANSLATE(c1f84e8860c9acbd312fc2d82a40cc08.63b05a90087d2241b8b6790c7253a055f90adc90d03e80e5248398220ac3e975,'*^|><@\"~`&','         '),' '))\n                  ||'\",\"' ||\n                  TRIM(NVL(TRANSLATE(42d2f22fd842b0cd27dffbea21620904.74b5cefda7cf1a7db3f0a3091333ac05,'*^|><@\"~`&','         '),' '))\n                  ||'\",\"' ||\n                  TRIM(NVL(TRANSLATE(42d2f22fd842b0cd27dffbea21620904.106cff97a417dbe6c4979d1de5e4bc76382d0f5d3019cd2839eb42d66c71274c,'*^|><@\"~`&','         '),' '))\n                  ||'\",\"' ||\n                  TRIM(NVL(TRANSLATE(42d2f22fd842b0cd27dffbea21620904.80f3b424d7258a583f0dff0f4d4b159d382d0f5d3019cd2839eb42d66c71274c,'*^|><@\"~`&','         '),' '))\n                  ||'\",\"' ||\n                  TRIM(TRANSLATE(42d2f22fd842b0cd27dffbea21620904.c51ab05c6acd87cdbf495339cf5496c0dfb673c032e1fff141ac84551b91849a,'*^|><@\"~`&','         '))\n                  ||'\",\"' ||\n                  TRIM(NVL(TRANSLATE(42d2f22fd842b0cd27dffbea21620904.b5e1ce6b2ac430bf504b82957a3e2685,'*^|><@\"~`&','         '),' '))\n                  ||'\",\"' ||\n                  TRIM(NVL(TRANSLATE(42d2f22fd842b0cd27dffbea21620904.f97b65e019a6572a4dfbc160d1d868ff382d0f5d3019cd2839eb42d66c71274c,'*^|><@\"~`&','         '),' '))\n                  ||'\",\"' ||\n                  TRIM(NVL(LTRIM(TRANSLATE(42f98af8b44bfddfe984d4995da7a9c4.781ac23919080fc8eb55bcb343c13931,'*^|><@\"~`&','         ')),' '))\n                  ||'\",\"' ||\n                  TRIM(NVL(LTRIM(TRANSLATE(sum(42d2f22fd842b0cd27dffbea21620904.eaa03e417a6b67a32172cc9dca631f77),'*^|><@\"~`&','         ')),' '))\n                  ||'\",\"' ||\n                  TRIM(NVL(LTRIM(TRANSLATE(sum(42d2f22fd842b0cd27dffbea21620904.baa23b8932072303310f88d528c93b04),'*^|><@\"~`&','         ')),' '))\n                  ||'\",\"' ||\n                  TRIM(NVL(LTRIM(TRANSLATE(sum(42d2f22fd842b0cd27dffbea21620904.dc15696e1e997bad6131bf936574f406),'*^|><@\"~`&','         ')),' '))\n                  ||'\",\"' ||\n                  TRIM(NVL(LTRIM(TRANSLATE(TO_CHAR(42d2f22fd842b0cd27dffbea21620904.f5dd4374a3e3af6a775cb6d6b22e8162,'DD/MM/YYYY'),'*^|><@\"~`&','         ')),' '))\n                  ||'\",\"' ||\n                  TRIM(NVL(LTRIM(TRANSLATE(42d2f22fd842b0cd27dffbea21620904.be8d7c2ea76d3152927ebf8709ea0326,'*^|><@\"~`&','         ')),' '))\n                  ||'\",\"' ||\n                  TRIM(NVL(LTRIM(TRANSLATE(TO_CHAR(42d2f22fd842b0cd27dffbea21620904.faaaf9cbe8897987592d529a771bbc17,'DD/MM/YYYY'),'*^|><@\"~`&','         ')),' '))\n                  ||'\",\"' ||\n                  TRIM(NVL(LTRIM(TRANSLATE(42d2f22fd842b0cd27dffbea21620904.d5506821c4ea14a4d9ee0f0ce4e7652d,'*^|><@\"~`&','         ')),' '))\n                  ||'\",\"' ||\n                  TRIM(NVL(LTRIM(TRANSLATE(42d2f22fd842b0cd27dffbea21620904.f2afece23955e23b9d2f09fce0b18c61382d0f5d3019cd2839eb42d66c71274c,'*^|><@\"~`&','         ')),' '))\n                  ||'\",\"' ||\n                  TRIM(NVL(LTRIM(TRANSLATE(42d2f22fd842b0cd27dffbea21620904.0c499b9342241191d5d5fc19d9822401382d0f5d3019cd2839eb42d66c71274c,'*^|><@\"~`&','         ')),' '))\n                  ||'\",\"' ||\n                  TRIM(NVL(LTRIM(TRANSLATE(42d2f22fd842b0cd27dffbea21620904.d55fbc4a3259962a8ab4fbedc0065134,'*^|><@\"~`&','         ')),' '))\n                  ||'\",\"' ||\n                  TRIM(NVL(LTRIM(TRANSLATE(42d2f22fd842b0cd27dffbea21620904.e8a1b74c58655c6b8ffcb348b45f0a27,'*^|><@\"~`&','         ')),' '))\n                  ||'\",\"' ||\n                  TRIM(NVL(LTRIM(TRANSLATE(42d2f22fd842b0cd27dffbea21620904.f3c7ed306cc6a6b3d6cfb40db08ba919e18a0efa177931495b66865407b6da30,'*^|><@\"~`&','         ')),' '))\n                  ||'\",\"' ||\n                  TRIM(NVL(LTRIM(TRANSLATE(42d2f22fd842b0cd27dffbea21620904.58b87fef0b56bd2bd029967f2dfe55798b31ebbdd4a917cc13e004a9efd1e6bd,'*^|><@\"~`&','         ')),' '))\n                  ||'\",\"' ||\n                  TRIM(NVL(LTRIM(TRANSLATE(42d2f22fd842b0cd27dffbea21620904.7c11ab787cf6f310ca23c850e9034413e32f6dd38f333cde68119d1f277367cd,'*^|><@\"~`&','         ')),' '))\n                  ||'\",\"' ||\n                  TRIM(NVL(LTRIM(TRANSLATE(d2450100e2dda59c2b7828b4daff7f8c.852fa1e9f02f1ca2c75837f7146b2381,'*^|><@\"~`&','         ')),' '))\n                  ||'\",\"' ||\n                  TRIM(NVL(LTRIM(TRANSLATE(6d9b37be5a083f8b78d676aba846c823.4855453efe73ff0bd0f7583df58260dd,'*^|><@\"~`&','         ')),' '))\n                  ||'\",\"' ||\n                  TRIM(NVL(LTRIM(TRANSLATE(6d9b37be5a083f8b78d676aba846c823.839c4ffb4bfaae1bb58eab4dee67d96a,'*^|><@\"~`&','         ')),' '))\n                  ||'\",\"' ||\n                  TRIM(NVL(LTRIM(TRANSLATE(6d9b37be5a083f8b78d676aba846c823.8b78bca74c200ef55dc944fae0f72a56,'*^|><@\"~`&','         ')),' '))\n                  ||'\",\"' ||\n                  TRIM(NVL(LTRIM(TRANSLATE(42d2f22fd842b0cd27dffbea21620904.abfa8e82cd46bbb827127b6cb2f5d6d5,'*^|><@\"~`&','         ')),' '))\n                  ||'\",\"' ||\n                  TRIM(NVL(LTRIM(TRANSLATE(aeaad0a1b4f46a0780f8669dcffabbbd.ec5f47a7f9d05b8b244d5898ce36aa8d,'*^|><@\"~`&','         ')),' '))\n                  ||'\",\"' ||\n                  TRIM(NVL(LTRIM(TRANSLATE(42f98af8b44bfddfe984d4995da7a9c4.ea5b512300324c431c7620e2dcfa897f,'*^|><@\"~`&','         ')),' '))\n                  ||'\",\"' ||\n                  TRIM(NVL(LTRIM(TRANSLATE(42f98af8b44bfddfe984d4995da7a9c4.2e775f14abc8392c69b08165a3aa95c4,'*^|><@\"~`&','         ')),' '))\n                  ||'\",\"' ||\n                  TRIM(NVL(LTRIM(TRANSLATE(sum(42d2f22fd842b0cd27dffbea21620904.b215402101f7a4f20fccac979c4d9b44),'*^|><@\"~`&','         ')),' '))\n                  ||'\",\"' ||\n                  TRIM(NVL(LTRIM(TRANSLATE(sum(42d2f22fd842b0cd27dffbea21620904.2ee1400a0150f0b220dd7bd6268d1e66),'*^|><@\"~`&','         ')),' '))\n                  ||'\",\"' ||\n                  TRIM(NVL(LTRIM(TRANSLATE(42d2f22fd842b0cd27dffbea21620904.f2e27750b8738746a93b585e377bbeb9,'*^|><@\"~`&','         ')),' '))\n                  ||'\",\"' ||\n                  TRIM(NVL(LTRIM(TRANSLATE(d2450100e2dda59c2b7828b4daff7f8c.116f2cd181d527334694326f442fe0b4,'*^|><@\"~`&','         ')),' '))\n                  ||'\",\"' ||\n                  TRIM(NVL(LTRIM(TRANSLATE(d2450100e2dda59c2b7828b4daff7f8c.60425c3a30e707860f8c49e4d570e105,'*^|><@\"~`&','         ')),' '))\n                  ||'\",\"' ||\n                  TRIM(NVL(LTRIM(TRANSLATE(d2450100e2dda59c2b7828b4daff7f8c.72dc428b3abefe008be0a8e1a56cc26e,'*^|><@\"~`&','         ')),' '))\n                  ||'\",\"' ||\n                  TRIM(NVL(LTRIM(TRANSLATE(d2450100e2dda59c2b7828b4daff7f8c.aa7b5e6986ce32ac25fa082282dfc40a,'*^|><@\"~`&','         ')),' '))\n                  ||'\",\"' ||\n                  TRIM(NVL(LTRIM(TRANSLATE(045e8935e1c2fd0adc47d5be3e82b5c8.d3bf6a02136dbf2e2bb717980d5bb171,'*^|><@\"~`&','         ')),' '))\n                  ||'\",\"' ||\n                  TRIM(NVL(LTRIM(TRANSLATE(1e956b5722c4a8bb6192646e15f402d4.d3bf6a02136dbf2e2bb717980d5bb171,'*^|><@\"~`&','         ')),' '))\n                  ||'\",\"' ||\n                  TRIM(NVL(LTRIM(TRANSLATE(e348cd959cea5b29b6ed565cef7e9b0e.d3bf6a02136dbf2e2bb717980d5bb171,'*^|><@\"~`&','         ')),' '))\n                  ||'\",\"' ||\n                  TRIM (NVL (LTRIM (TRANSLATE (42d2f22fd842b0cd27dffbea21620904.a00b7aac034b1de6ebfabe4a7097af1b3c072b0281819f75f19257cd7009a1b3,'*^|><@\"~`&','         ')),' '))\n                  ||'\",\"' ||\n                  TRIM(NVL(LTRIM(TRANSLATE(42f98af8b44bfddfe984d4995da7a9c4.b5f7a669e88f8b603dbacd55092d5d25,'*^|><@\"~`&','         ')),' '))\n                  ||'\",\"' ||\n                  TRIM(NVL(LTRIM(TRANSLATE(42f98af8b44bfddfe984d4995da7a9c4.670546dc34550a5e54ce483709fe795e,'*^|><@\"~`&','         ')),' '))\n                  ||'\",\"' ||\n                  TRIM(NVL(LTRIM(TRANSLATE(d2450100e2dda59c2b7828b4daff7f8c.ea2a6fac3818a6a2522f130f8418653f,'*^|><@\"~`&','         ')),' '))\n                  ||'\",\"' ||\n                  TRIM(NVL(LTRIM(TRANSLATE(d2450100e2dda59c2b7828b4daff7f8c.17a070f45558c000ef488aabe8b430c2,'*^|><@\"~`&','         ')),' '))\n                  ||'\",\"' ||\n                  TRIM(NVL(LTRIM(TRANSLATE(DECODE(42d2f22fd842b0cd27dffbea21620904.5112ab47fb19df73f8ed2678ddc0ecdb34ceb39ae2f66f21170198c2e55391b5,'000','   ','UNK','   ',42d2f22fd842b0cd27dffbea21620904.5112ab47fb19df73f8ed2678ddc0ecdb34ceb39ae2f66f21170198c2e55391b5),'*^|><@\"~`&','         ')),' '))\n                  ||'\",\"' ||\n                  TRIM(NVL(LTRIM(TRANSLATE(DECODE(42d2f22fd842b0cd27dffbea21620904.5b166c5fe66db413f1e228635901a0965479098e904da91bb293c4391be1730d,'000','   ','UNK','   ',42d2f22fd842b0cd27dffbea21620904.5b166c5fe66db413f1e228635901a0965479098e904da91bb293c4391be1730d),'*^|><@\"~`&','         ')),' '))\n                  ||'\",\"' ||\n                  TRIM(NVL(LTRIM(TRANSLATE(c1f84e8860c9acbd312fc2d82a40cc08.9417ab04bd2e9c1e93b563a48bcf145f,'*^|><@\"~`&','         ')),' '))\n                  ||'\",\"' ||\n                  TRIM(NVL(LTRIM(TRANSLATE(42f98af8b44bfddfe984d4995da7a9c4.4b398d884e397727aeb50b1bf2299e607e8fe841f8abc0a126967273be28f1b7,'*^|><@\"~`&','         ')),' '))\n                  ||'\",\"' ||\n                  TRIM(NVL(LTRIM(TRANSLATE(42f98af8b44bfddfe984d4995da7a9c4.4b398d884e397727aeb50b1bf2299e6098df5d6b623334f2e9631188cca4cfd6,'*^|><@\"~`&','         ')),' '))\n                  ||'\",\"' ||\n                  TRIM(NVL(LTRIM(TRANSLATE(42d2f22fd842b0cd27dffbea21620904.1065b8b1389467c159d06cefb2115e1ee32f6dd38f333cde68119d1f277367cd,'*^|><@\"~`&','         ')),' '))\n                  ||'\",\"' ||\n                  TRIM(NVL(LTRIM(TRANSLATE(42d2f22fd842b0cd27dffbea21620904.00cdbed4bd71948125ed2b15120f69168530a6af9816b2bc4970d57e532d4b4b,'*^|><@\"~`&','         ')),' '))\n                  ||'\",\"' ||\n                  TRIM(NVL(LTRIM(TRANSLATE(d2450100e2dda59c2b7828b4daff7f8c.4c519ea2261e05bc61c96b41c134952f0a12b52193ec2e9d203d998bbff069f9,'*^|><@\"~`&','         ')),' '))\n                  ||'\",\"' ||\n                  TRIM(NVL(LTRIM(TRANSLATE(42d2f22fd842b0cd27dffbea21620904.e33988f12139bfc93f1e7557137feb5a1ee195c0a70d0165e55ff54074aadc17,'*^|><@\"~`&','         ')),' '))\n                  ||'\",\"' ||\n                  TRIM(NVL(LTRIM(TRANSLATE(42d2f22fd842b0cd27dffbea21620904.95d310dcb2cf99cf2d1b5ab1f71190b6,'*^|><@\"~`&','         ')),' '))\n                  ||'\",\"' ||\n                  TRIM(NVL(LTRIM(TRANSLATE(42d2f22fd842b0cd27dffbea21620904.c2b9ebe664db8cfc1f7a702af0630a5b,'*^|><@\"~`&','         ')),' '))\n                  ||'\",\"' ||\n                  TRIM(NVL(LTRIM(TRANSLATE(d2450100e2dda59c2b7828b4daff7f8c.b0244019950c3493f027ab46f08f4a24,'*^|><@\"~`&','         ')),' '))\n                  ||'\",\"' ||\n                  TRIM(NVL(LTRIM(TRANSLATE(\n                  case when 42d2f22fd842b0cd27dffbea21620904.73fc2afbbbce75dfdb12e62a0b628ace in ('EC','MO','NV','VP') then 'EC'\n                       when 42d2f22fd842b0cd27dffbea21620904.73fc2afbbbce75dfdb12e62a0b628ace in ('ED','OS','EP') then 'ED'\n                       when 42d2f22fd842b0cd27dffbea21620904.73fc2afbbbce75dfdb12e62a0b628ace in ('CS','SO') then 'CS'\n                   else 'N' END,'*^|><@\"~`&','         ')),' '))\n                  ||'\",\"' ||\n                  TRIM(NVL(LTRIM(TRANSLATE(42d2f22fd842b0cd27dffbea21620904.4f53412a65a5d5ad453a0fed47eff7e2,'*^|><@\"~`&','         ')),' '))\n                  ||'\",\"' ||\n                  TRIM(NVL(LTRIM(TRANSLATE(d2450100e2dda59c2b7828b4daff7f8c.7190e92bd222014102cfd9666cf8958b,'*^|><@\"~`&','         ')),' '))\n                  ||'\",\"' ||\n                  TRIM(NVL(LTRIM(TRANSLATE(42d2f22fd842b0cd27dffbea21620904.26ac88e7ae671a1b22c14c2fce77aa2d,'*^|><@\"~`&','         ')),' '))\n                  ||'\",\"' ||\n                  TRIM(NVL(LTRIM(TRANSLATE(case when 09edb2cf1063d4b8a08f1e26f3b588f6.8e41b46a4a3a31065ad39d43bdc0718f in ( 1,2,3)  then 'Y' else 'N' END,'*^|><@\"~`&','         ')),' '))\n                  ||'\"'\n  FROM   de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c sd,\n         de459e2fe7f96e4d958537b31b946b26.52982d3bbc1ebc2720d9504c7ea2ed3f c,\n         de459e2fe7f96e4d958537b31b946b26.dec387908a0954ddc8689c4ad37c8a3c b,\n         de459e2fe7f96e4d958537b31b946b26.48897903f4dd9dc6e7add38a894afe49 cov,\n         de459e2fe7f96e4d958537b31b946b26.c50b6339218f0dbbd97ce6557f2b051f pc,\n         de459e2fe7f96e4d958537b31b946b26.2c04d82ed0aa1cc9bce2cf2c0548b268 pim,\n         user_emp tm_id,\n         user_emp dsm_id,\n         user_emp rsm_id,\n         ec_user\n WHERE  \n         42d2f22fd842b0cd27dffbea21620904.f5dd4374a3e3af6a775cb6d6b22e8162 BETWEEN TO_DATE ('' || wkstartdate || '','YYYYMMDDHH24MISS')  AND  TO_DATE ('' || wkenddate || '','YYYYMMDDHH24MISS')\n         AND 6d9b37be5a083f8b78d676aba846c823.fa741a84bd7a01a1c4b5dc91364baac5 = 42d2f22fd842b0cd27dffbea21620904.fa741a84bd7a01a1c4b5dc91364baac5\n         AND d2450100e2dda59c2b7828b4daff7f8c.7f599f836c449bebb92bb9757e86c603 = 42d2f22fd842b0cd27dffbea21620904.7f599f836c449bebb92bb9757e86c603\n         AND d2450100e2dda59c2b7828b4daff7f8c.dd6238100904f569270d672fe0643a5a = '1'\n         AND 42d2f22fd842b0cd27dffbea21620904.224811ad2521818a46ceb20442ea1122 IS NULL\n         AND 42d2f22fd842b0cd27dffbea21620904.26ac88e7ae671a1b22c14c2fce77aa2d NOT IN ('AP', 'AN')\n         AND 42d2f22fd842b0cd27dffbea21620904.49dbc899bc8f9659472a5a3b3510790c IS NULL\n         AND 42d2f22fd842b0cd27dffbea21620904.ca329b170a83f14795f7d01859b0fe42 IS NULL\n         AND c1f84e8860c9acbd312fc2d82a40cc08.8b8c72c349530db846280000957f636d = 42d2f22fd842b0cd27dffbea21620904.8b8c72c349530db846280000957f636d\n         AND 42f98af8b44bfddfe984d4995da7a9c4.0a85164948783cdf0d4416f41905a154 = 42d2f22fd842b0cd27dffbea21620904.0a85164948783cdf0d4416f41905a154\n         AND aeaad0a1b4f46a0780f8669dcffabbbd.4d732318d69998c6709a6e5b1b6b8d11(+) = TO_CHAR (42d2f22fd842b0cd27dffbea21620904.abfa8e82cd46bbb827127b6cb2f5d6d5)\n         AND UPPER (42d2f22fd842b0cd27dffbea21620904.f2afece23955e23b9d2f09fce0b18c61382d0f5d3019cd2839eb42d66c71274c) = e348cd959cea5b29b6ed565cef7e9b0e.d9b20f4b35d5639078e9ce32cf0724c5(+)\n         AND UPPER (42d2f22fd842b0cd27dffbea21620904.f3c7ed306cc6a6b3d6cfb40db08ba919e18a0efa177931495b66865407b6da30) = 1e956b5722c4a8bb6192646e15f402d4.d9b20f4b35d5639078e9ce32cf0724c5(+)\n         AND 045e8935e1c2fd0adc47d5be3e82b5c8.d9b20f4b35d5639078e9ce32cf0724c5(+) = d2450100e2dda59c2b7828b4daff7f8c.72dc428b3abefe008be0a8e1a56cc26e\n         AND 09edb2cf1063d4b8a08f1e26f3b588f6.777c30c4dc8f94cdbbd30df0ca1c6266 (+) = 42d2f22fd842b0cd27dffbea21620904.4f53412a65a5d5ad453a0fed47eff7e2\n          group by\n            c1f84e8860c9acbd312fc2d82a40cc08.1cb2540b20bdff2cba42229b96ddf301,\n            c1f84e8860c9acbd312fc2d82a40cc08.f163c0eb7a9bbba5c90dbb9e4f32ab9f,\n            42d2f22fd842b0cd27dffbea21620904.8708a839c00cf7a8852df326dbe38f05382d0f5d3019cd2839eb42d66c71274c,\n            c1f84e8860c9acbd312fc2d82a40cc08.a8578017628b84f4dd067faec4d9464f,\n            c1f84e8860c9acbd312fc2d82a40cc08.d3268eabc4a7d98105fd85f9c9e62cd6e32ad436514bbe822b33de8bead744f3,\n            42f98af8b44bfddfe984d4995da7a9c4.2d45d761eb8d137835bca7a23010fab4,\n            c1f84e8860c9acbd312fc2d82a40cc08.1be023bf16131ae1db14f4851cffcb11,\n            c1f84e8860c9acbd312fc2d82a40cc08.f5893bf557f879cfbf83e63ac2051e8815ebda0b6e5cc8d4c919a8c71a9d07e4,\n            c1f84e8860c9acbd312fc2d82a40cc08.63b05a90087d2241b8b6790c7253a055f90adc90d03e80e5248398220ac3e975,\n            42d2f22fd842b0cd27dffbea21620904.74b5cefda7cf1a7db3f0a3091333ac05,\n            42d2f22fd842b0cd27dffbea21620904.106cff97a417dbe6c4979d1de5e4bc76382d0f5d3019cd2839eb42d66c71274c,\n            42d2f22fd842b0cd27dffbea21620904.80f3b424d7258a583f0dff0f4d4b159d382d0f5d3019cd2839eb42d66c71274c,\n            42d2f22fd842b0cd27dffbea21620904.c51ab05c6acd87cdbf495339cf5496c0dfb673c032e1fff141ac84551b91849a,\n            42d2f22fd842b0cd27dffbea21620904.b5e1ce6b2ac430bf504b82957a3e2685,\n            42d2f22fd842b0cd27dffbea21620904.f97b65e019a6572a4dfbc160d1d868ff382d0f5d3019cd2839eb42d66c71274c,\n            42f98af8b44bfddfe984d4995da7a9c4.781ac23919080fc8eb55bcb343c13931,\n            42d2f22fd842b0cd27dffbea21620904.f5dd4374a3e3af6a775cb6d6b22e8162,\n            42d2f22fd842b0cd27dffbea21620904.be8d7c2ea76d3152927ebf8709ea0326,\n            42d2f22fd842b0cd27dffbea21620904.faaaf9cbe8897987592d529a771bbc17,\n            42d2f22fd842b0cd27dffbea21620904.d5506821c4ea14a4d9ee0f0ce4e7652d,\n            42d2f22fd842b0cd27dffbea21620904.f2afece23955e23b9d2f09fce0b18c61382d0f5d3019cd2839eb42d66c71274c,\n            42d2f22fd842b0cd27dffbea21620904.0c499b9342241191d5d5fc19d9822401382d0f5d3019cd2839eb42d66c71274c,\n            42d2f22fd842b0cd27dffbea21620904.d55fbc4a3259962a8ab4fbedc0065134,\n            42d2f22fd842b0cd27dffbea21620904.e8a1b74c58655c6b8ffcb348b45f0a27,\n            42d2f22fd842b0cd27dffbea21620904.f3c7ed306cc6a6b3d6cfb40db08ba919e18a0efa177931495b66865407b6da30,\n            42d2f22fd842b0cd27dffbea21620904.58b87fef0b56bd2bd029967f2dfe55798b31ebbdd4a917cc13e004a9efd1e6bd,\n            42d2f22fd842b0cd27dffbea21620904.7c11ab787cf6f310ca23c850e9034413e32f6dd38f333cde68119d1f277367cd,\n            d2450100e2dda59c2b7828b4daff7f8c.852fa1e9f02f1ca2c75837f7146b2381,\n            6d9b37be5a083f8b78d676aba846c823.4855453efe73ff0bd0f7583df58260dd,\n            6d9b37be5a083f8b78d676aba846c823.839c4ffb4bfaae1bb58eab4dee67d96a,\n            6d9b37be5a083f8b78d676aba846c823.8b78bca74c200ef55dc944fae0f72a56,\n            42d2f22fd842b0cd27dffbea21620904.abfa8e82cd46bbb827127b6cb2f5d6d5,\n            aeaad0a1b4f46a0780f8669dcffabbbd.ec5f47a7f9d05b8b244d5898ce36aa8d,\n            42f98af8b44bfddfe984d4995da7a9c4.ea5b512300324c431c7620e2dcfa897f,\n            42f98af8b44bfddfe984d4995da7a9c4.2e775f14abc8392c69b08165a3aa95c4,\n            42d2f22fd842b0cd27dffbea21620904.f2e27750b8738746a93b585e377bbeb9,\n            d2450100e2dda59c2b7828b4daff7f8c.116f2cd181d527334694326f442fe0b4,\n            d2450100e2dda59c2b7828b4daff7f8c.60425c3a30e707860f8c49e4d570e105,\n            d2450100e2dda59c2b7828b4daff7f8c.72dc428b3abefe008be0a8e1a56cc26e,\n            d2450100e2dda59c2b7828b4daff7f8c.aa7b5e6986ce32ac25fa082282dfc40a,\n            045e8935e1c2fd0adc47d5be3e82b5c8.d3bf6a02136dbf2e2bb717980d5bb171,\n            1e956b5722c4a8bb6192646e15f402d4.d3bf6a02136dbf2e2bb717980d5bb171,\n            e348cd959cea5b29b6ed565cef7e9b0e.d3bf6a02136dbf2e2bb717980d5bb171,\n            42d2f22fd842b0cd27dffbea21620904.a00b7aac034b1de6ebfabe4a7097af1b3c072b0281819f75f19257cd7009a1b3,\n            42f98af8b44bfddfe984d4995da7a9c4.b5f7a669e88f8b603dbacd55092d5d25,\n            42f98af8b44bfddfe984d4995da7a9c4.670546dc34550a5e54ce483709fe795e,\n            d2450100e2dda59c2b7828b4daff7f8c.ea2a6fac3818a6a2522f130f8418653f,\n            d2450100e2dda59c2b7828b4daff7f8c.17a070f45558c000ef488aabe8b430c2,\n            42d2f22fd842b0cd27dffbea21620904.5112ab47fb19df73f8ed2678ddc0ecdb34ceb39ae2f66f21170198c2e55391b5,\n            42d2f22fd842b0cd27dffbea21620904.5b166c5fe66db413f1e228635901a0965479098e904da91bb293c4391be1730d,\n            c1f84e8860c9acbd312fc2d82a40cc08.9417ab04bd2e9c1e93b563a48bcf145f,\n            42f98af8b44bfddfe984d4995da7a9c4.4b398d884e397727aeb50b1bf2299e607e8fe841f8abc0a126967273be28f1b7,\n            42f98af8b44bfddfe984d4995da7a9c4.4b398d884e397727aeb50b1bf2299e6098df5d6b623334f2e9631188cca4cfd6,\n            42d2f22fd842b0cd27dffbea21620904.1065b8b1389467c159d06cefb2115e1ee32f6dd38f333cde68119d1f277367cd,\n            42d2f22fd842b0cd27dffbea21620904.00cdbed4bd71948125ed2b15120f69168530a6af9816b2bc4970d57e532d4b4b,\n            d2450100e2dda59c2b7828b4daff7f8c.4c519ea2261e05bc61c96b41c134952f0a12b52193ec2e9d203d998bbff069f9,\n            42d2f22fd842b0cd27dffbea21620904.e33988f12139bfc93f1e7557137feb5a1ee195c0a70d0165e55ff54074aadc17,\n            42d2f22fd842b0cd27dffbea21620904.95d310dcb2cf99cf2d1b5ab1f71190b6,\n            42d2f22fd842b0cd27dffbea21620904.c2b9ebe664db8cfc1f7a702af0630a5b,\n            d2450100e2dda59c2b7828b4daff7f8c.b0244019950c3493f027ab46f08f4a24,\n            42d2f22fd842b0cd27dffbea21620904.73fc2afbbbce75dfdb12e62a0b628ace,\n            42d2f22fd842b0cd27dffbea21620904.4f53412a65a5d5ad453a0fed47eff7e2,\n            d2450100e2dda59c2b7828b4daff7f8c.7190e92bd222014102cfd9666cf8958b,\n            42d2f22fd842b0cd27dffbea21620904.26ac88e7ae671a1b22c14c2fce77aa2d,\n            case when user_typ in ( 1,2,3)  then 'Y' else 'N' END\n    UNION ALL\n                SELECT\n                  DISTINCT\n                  UPPER(RTRIM (SUBSTR ('AUGEO_SALES', 1, 30))),\n                  '\"' ||\n                  TRIM(NVL(TRANSLATE(c1f84e8860c9acbd312fc2d82a40cc08.1cb2540b20bdff2cba42229b96ddf301,'*^|><@\"~`&',' '),' '))\n                  ||'\",\"' ||\n                  TRIM(NVL(TRANSLATE(c1f84e8860c9acbd312fc2d82a40cc08.f163c0eb7a9bbba5c90dbb9e4f32ab9f,'*^|><@\"~`&',' '),' '))\n                  ||'\",\"' ||\n                  TRIM(NVL(TRANSLATE(42d2f22fd842b0cd27dffbea21620904.8708a839c00cf7a8852df326dbe38f05382d0f5d3019cd2839eb42d66c71274c,'*^|><@\"~`&',' '),' '))\n                  ||'\",\"' ||\n                  TRIM(NVL(TRANSLATE(c1f84e8860c9acbd312fc2d82a40cc08.a8578017628b84f4dd067faec4d9464f,'*^|><@\"~`&',' '),' '))\n                  ||'\",\"' ||\n                  TRIM(NVL(TRANSLATE(c1f84e8860c9acbd312fc2d82a40cc08.d3268eabc4a7d98105fd85f9c9e62cd6e32ad436514bbe822b33de8bead744f3,'*^|><@\"~`&','        '),' '))\n                  ||'\",\"' ||\n                  TRIM(NVL(TRANSLATE(42f98af8b44bfddfe984d4995da7a9c4.2d45d761eb8d137835bca7a23010fab4,'*^|><@\"~`&','        '),' '))\n                  ||'\",\"' ||\n                  TRIM(NVL(TRANSLATE(c1f84e8860c9acbd312fc2d82a40cc08.1be023bf16131ae1db14f4851cffcb11,'*^|><@\"~`&','     '),' '))\n                  ||'\",\"' ||\n                  TRIM(NVL(TRANSLATE(c1f84e8860c9acbd312fc2d82a40cc08.f5893bf557f879cfbf83e63ac2051e8815ebda0b6e5cc8d4c919a8c71a9d07e4,'*^|><@\"~`&','      '),' '))\n                  ||'\",\"' ||\n                  TRIM(NVL(TRANSLATE(c1f84e8860c9acbd312fc2d82a40cc08.63b05a90087d2241b8b6790c7253a055f90adc90d03e80e5248398220ac3e975,'*^|><@\"~`&','         '),' '))\n                  ||'\",\"' ||\n                  TRIM(NVL(TRANSLATE(42d2f22fd842b0cd27dffbea21620904.74b5cefda7cf1a7db3f0a3091333ac05,'*^|><@\"~`&','         '),' '))\n                  ||'\",\"' ||\n                  TRIM(NVL(TRANSLATE(42d2f22fd842b0cd27dffbea21620904.106cff97a417dbe6c4979d1de5e4bc76382d0f5d3019cd2839eb42d66c71274c,'*^|><@\"~`&','         '),' '))\n                  ||'\",\"' ||\n                  TRIM(NVL(TRANSLATE(42d2f22fd842b0cd27dffbea21620904.80f3b424d7258a583f0dff0f4d4b159d382d0f5d3019cd2839eb42d66c71274c,'*^|><@\"~`&','         '),' '))\n                  ||'\",\"' ||\n                  TRIM(TRANSLATE(42d2f22fd842b0cd27dffbea21620904.c51ab05c6acd87cdbf495339cf5496c0dfb673c032e1fff141ac84551b91849a,'*^|><@\"~`&','         '))\n                  ||'\",\"' ||\n                  TRIM(NVL(TRANSLATE(42d2f22fd842b0cd27dffbea21620904.b5e1ce6b2ac430bf504b82957a3e2685,'*^|><@\"~`&','         '),' '))\n                  ||'\",\"' ||\n                  TRIM(NVL(TRANSLATE(42d2f22fd842b0cd27dffbea21620904.f97b65e019a6572a4dfbc160d1d868ff382d0f5d3019cd2839eb42d66c71274c,'*^|><@\"~`&','         '),' '))\n                  ||'\",\"' ||\n                  TRIM(NVL(LTRIM(TRANSLATE(42f98af8b44bfddfe984d4995da7a9c4.781ac23919080fc8eb55bcb343c13931,'*^|><@\"~`&','         ')),' '))\n                  ||'\",\"' ||\n                  TRIM(NVL(LTRIM(TRANSLATE(sum(42d2f22fd842b0cd27dffbea21620904.eaa03e417a6b67a32172cc9dca631f77),'*^|><@\"~`&','         ')),' '))\n                  ||'\",\"' ||\n                  TRIM(NVL(LTRIM(TRANSLATE(sum(42d2f22fd842b0cd27dffbea21620904.baa23b8932072303310f88d528c93b04),'*^|><@\"~`&','         ')),' '))\n                  ||'\",\"' ||\n                  TRIM(NVL(LTRIM(TRANSLATE(sum(42d2f22fd842b0cd27dffbea21620904.dc15696e1e997bad6131bf936574f406),'*^|><@\"~`&','         ')),' '))\n                  ||'\",\"' ||\n                  TRIM(NVL(LTRIM(TRANSLATE(TO_CHAR(42d2f22fd842b0cd27dffbea21620904.f5dd4374a3e3af6a775cb6d6b22e8162,'DD/MM/YYYY'),'*^|><@\"~`&','         ')),' '))\n                  ||'\",\"' ||\n                  TRIM(NVL(LTRIM(TRANSLATE(42d2f22fd842b0cd27dffbea21620904.be8d7c2ea76d3152927ebf8709ea0326,'*^|><@\"~`&','         ')),' '))\n                  ||'\",\"' ||\n                  TRIM(NVL(LTRIM(TRANSLATE(TO_CHAR(42d2f22fd842b0cd27dffbea21620904.faaaf9cbe8897987592d529a771bbc17,'DD/MM/YYYY'),'*^|><@\"~`&','         ')),' '))\n                  ||'\",\"' ||\n                  TRIM(NVL(LTRIM(TRANSLATE(42d2f22fd842b0cd27dffbea21620904.d5506821c4ea14a4d9ee0f0ce4e7652d,'*^|><@\"~`&','         ')),' '))\n                  ||'\",\"' ||\n                  TRIM(NVL(LTRIM(TRANSLATE(42d2f22fd842b0cd27dffbea21620904.f2afece23955e23b9d2f09fce0b18c61382d0f5d3019cd2839eb42d66c71274c,'*^|><@\"~`&','         ')),' '))\n                  ||'\",\"' ||\n                  TRIM(NVL(LTRIM(TRANSLATE(42d2f22fd842b0cd27dffbea21620904.0c499b9342241191d5d5fc19d9822401382d0f5d3019cd2839eb42d66c71274c,'*^|><@\"~`&','         ')),' '))\n                  ||'\",\"' ||\n                  TRIM(NVL(LTRIM(TRANSLATE(42d2f22fd842b0cd27dffbea21620904.d55fbc4a3259962a8ab4fbedc0065134,'*^|><@\"~`&','         ')),' '))\n                  ||'\",\"' ||\n                  TRIM(NVL(LTRIM(TRANSLATE(42d2f22fd842b0cd27dffbea21620904.e8a1b74c58655c6b8ffcb348b45f0a27,'*^|><@\"~`&','         ')),' '))\n                  ||'\",\"' ||\n                  TRIM(NVL(LTRIM(TRANSLATE(42d2f22fd842b0cd27dffbea21620904.f3c7ed306cc6a6b3d6cfb40db08ba919e18a0efa177931495b66865407b6da30,'*^|><@\"~`&','         ')),' '))\n                  ||'\",\"' ||\n                  TRIM(NVL(LTRIM(TRANSLATE(42d2f22fd842b0cd27dffbea21620904.58b87fef0b56bd2bd029967f2dfe55798b31ebbdd4a917cc13e004a9efd1e6bd,'*^|><@\"~`&','         ')),' '))\n                  ||'\",\"' ||\n                  TRIM(NVL(LTRIM(TRANSLATE(42d2f22fd842b0cd27dffbea21620904.7c11ab787cf6f310ca23c850e9034413e32f6dd38f333cde68119d1f277367cd,'*^|><@\"~`&','         ')),' '))\n                  ||'\",\"' ||\n                  TRIM(NVL(LTRIM(TRANSLATE(d2450100e2dda59c2b7828b4daff7f8c.852fa1e9f02f1ca2c75837f7146b2381,'*^|><@\"~`&','         ')),' '))\n                  ||'\",\"' ||\n                  TRIM(NVL(LTRIM(TRANSLATE(6d9b37be5a083f8b78d676aba846c823.4855453efe73ff0bd0f7583df58260dd,'*^|><@\"~`&','         ')),' '))\n                  ||'\",\"' ||\n                  TRIM(NVL(LTRIM(TRANSLATE(6d9b37be5a083f8b78d676aba846c823.839c4ffb4bfaae1bb58eab4dee67d96a,'*^|><@\"~`&','         ')),' '))\n                  ||'\",\"' ||\n                  TRIM(NVL(LTRIM(TRANSLATE(6d9b37be5a083f8b78d676aba846c823.8b78bca74c200ef55dc944fae0f72a56,'*^|><@\"~`&','         ')),' '))\n                  ||'\",\"' ||\n                  TRIM(NVL(LTRIM(TRANSLATE(42d2f22fd842b0cd27dffbea21620904.abfa8e82cd46bbb827127b6cb2f5d6d5,'*^|><@\"~`&','         ')),' '))\n                  ||'\",\"' ||\n                  TRIM(NVL(LTRIM(TRANSLATE(aeaad0a1b4f46a0780f8669dcffabbbd.ec5f47a7f9d05b8b244d5898ce36aa8d,'*^|><@\"~`&','         ')),' '))\n                  ||'\",\"' ||\n                  TRIM(NVL(LTRIM(TRANSLATE(42f98af8b44bfddfe984d4995da7a9c4.ea5b512300324c431c7620e2dcfa897f,'*^|><@\"~`&','         ')),' '))\n                  ||'\",\"' ||\n                  TRIM(NVL(LTRIM(TRANSLATE(42f98af8b44bfddfe984d4995da7a9c4.2e775f14abc8392c69b08165a3aa95c4,'*^|><@\"~`&','         ')),' '))\n                  ||'\",\"' ||\n                  TRIM(NVL(LTRIM(TRANSLATE(sum(42d2f22fd842b0cd27dffbea21620904.b215402101f7a4f20fccac979c4d9b44),'*^|><@\"~`&','         ')),' '))\n                  ||'\",\"' ||\n                  TRIM(NVL(LTRIM(TRANSLATE(sum(42d2f22fd842b0cd27dffbea21620904.2ee1400a0150f0b220dd7bd6268d1e66),'*^|><@\"~`&','         ')),' '))\n                  ||'\",\"' ||\n                  TRIM(NVL(LTRIM(TRANSLATE(42d2f22fd842b0cd27dffbea21620904.f2e27750b8738746a93b585e377bbeb9,'*^|><@\"~`&','         ')),' '))\n                  ||'\",\"' ||\n                  TRIM(NVL(LTRIM(TRANSLATE(d2450100e2dda59c2b7828b4daff7f8c.116f2cd181d527334694326f442fe0b4,'*^|><@\"~`&','         ')),' '))\n                  ||'\",\"' ||\n                  TRIM(NVL(LTRIM(TRANSLATE(d2450100e2dda59c2b7828b4daff7f8c.60425c3a30e707860f8c49e4d570e105,'*^|><@\"~`&','         ')),' '))\n                  ||'\",\"' ||\n                  TRIM(NVL(LTRIM(TRANSLATE(d2450100e2dda59c2b7828b4daff7f8c.72dc428b3abefe008be0a8e1a56cc26e,'*^|><@\"~`&','         ')),' '))\n                  ||'\",\"' ||\n                  TRIM(NVL(LTRIM(TRANSLATE(d2450100e2dda59c2b7828b4daff7f8c.aa7b5e6986ce32ac25fa082282dfc40a,'*^|><@\"~`&','         ')),' '))\n                  ||'\",\"' ||\n                  TRIM(NVL(LTRIM(TRANSLATE(045e8935e1c2fd0adc47d5be3e82b5c8.d3bf6a02136dbf2e2bb717980d5bb171,'*^|><@\"~`&','         ')),' '))\n                  ||'\",\"' ||\n                  TRIM(NVL(LTRIM(TRANSLATE(1e956b5722c4a8bb6192646e15f402d4.d3bf6a02136dbf2e2bb717980d5bb171,'*^|><@\"~`&','         ')),' '))\n                  ||'\",\"' ||\n                  TRIM(NVL(LTRIM(TRANSLATE(e348cd959cea5b29b6ed565cef7e9b0e.d3bf6a02136dbf2e2bb717980d5bb171,'*^|><@\"~`&','         ')),' '))\n                  ||'\",\"' ||\n                  TRIM (NVL (LTRIM (TRANSLATE (42d2f22fd842b0cd27dffbea21620904.a00b7aac034b1de6ebfabe4a7097af1b3c072b0281819f75f19257cd7009a1b3,'*^|><@\"~`&','         ')),' '))\n                  ||'\",\"' ||\n                  TRIM(NVL(LTRIM(TRANSLATE(42f98af8b44bfddfe984d4995da7a9c4.b5f7a669e88f8b603dbacd55092d5d25,'*^|><@\"~`&','         ')),' '))\n                  ||'\",\"' ||\n                  TRIM(NVL(LTRIM(TRANSLATE(42f98af8b44bfddfe984d4995da7a9c4.670546dc34550a5e54ce483709fe795e,'*^|><@\"~`&','         ')),' '))\n                  ||'\",\"' ||\n                  TRIM(NVL(LTRIM(TRANSLATE(d2450100e2dda59c2b7828b4daff7f8c.ea2a6fac3818a6a2522f130f8418653f,'*^|><@\"~`&','         ')),' '))\n                  ||'\",\"' ||\n                  TRIM(NVL(LTRIM(TRANSLATE(d2450100e2dda59c2b7828b4daff7f8c.17a070f45558c000ef488aabe8b430c2,'*^|><@\"~`&','         ')),' '))\n                  ||'\",\"' ||\n                  TRIM(NVL(LTRIM(TRANSLATE(DECODE(42d2f22fd842b0cd27dffbea21620904.5112ab47fb19df73f8ed2678ddc0ecdb34ceb39ae2f66f21170198c2e55391b5,'000','   ','UNK','   ',42d2f22fd842b0cd27dffbea21620904.5112ab47fb19df73f8ed2678ddc0ecdb34ceb39ae2f66f21170198c2e55391b5),'*^|><@\"~`&','         ')),' '))\n                  ||'\",\"' ||\n                  TRIM(NVL(LTRIM(TRANSLATE(DECODE(42d2f22fd842b0cd27dffbea21620904.5b166c5fe66db413f1e228635901a0965479098e904da91bb293c4391be1730d,'000','   ','UNK','   ',42d2f22fd842b0cd27dffbea21620904.5b166c5fe66db413f1e228635901a0965479098e904da91bb293c4391be1730d),'*^|><@\"~`&','         ')),' '))\n                  ||'\",\"' ||\n                  TRIM(NVL(LTRIM(TRANSLATE(c1f84e8860c9acbd312fc2d82a40cc08.9417ab04bd2e9c1e93b563a48bcf145f,'*^|><@\"~`&','         ')),' '))\n                  ||'\",\"' ||\n                  TRIM(NVL(LTRIM(TRANSLATE(42f98af8b44bfddfe984d4995da7a9c4.4b398d884e397727aeb50b1bf2299e607e8fe841f8abc0a126967273be28f1b7,'*^|><@\"~`&','         ')),' '))\n                  ||'\",\"' ||\n                  TRIM(NVL(LTRIM(TRANSLATE(42f98af8b44bfddfe984d4995da7a9c4.4b398d884e397727aeb50b1bf2299e6098df5d6b623334f2e9631188cca4cfd6,'*^|><@\"~`&','         ')),' '))\n                  ||'\",\"' ||\n                  TRIM(NVL(LTRIM(TRANSLATE(42d2f22fd842b0cd27dffbea21620904.1065b8b1389467c159d06cefb2115e1ee32f6dd38f333cde68119d1f277367cd,'*^|><@\"~`&','         ')),' '))\n                  ||'\",\"' ||\n                  TRIM(NVL(LTRIM(TRANSLATE(42d2f22fd842b0cd27dffbea21620904.00cdbed4bd71948125ed2b15120f69168530a6af9816b2bc4970d57e532d4b4b,'*^|><@\"~`&','         ')),' '))\n                  ||'\",\"' ||\n                  TRIM(NVL(LTRIM(TRANSLATE(d2450100e2dda59c2b7828b4daff7f8c.4c519ea2261e05bc61c96b41c134952f0a12b52193ec2e9d203d998bbff069f9,'*^|><@\"~`&','         ')),' '))\n                  ||'\",\"' ||\n                  TRIM(NVL(LTRIM(TRANSLATE(42d2f22fd842b0cd27dffbea21620904.e33988f12139bfc93f1e7557137feb5a1ee195c0a70d0165e55ff54074aadc17,'*^|><@\"~`&','         ')),' '))\n                  ||'\",\"' ||\n                  TRIM(NVL(LTRIM(TRANSLATE(42d2f22fd842b0cd27dffbea21620904.95d310dcb2cf99cf2d1b5ab1f71190b6,'*^|><@\"~`&','         ')),' '))\n                  ||'\",\"' ||\n                  TRIM(NVL(LTRIM(TRANSLATE(42d2f22fd842b0cd27dffbea21620904.c2b9ebe664db8cfc1f7a702af0630a5b,'*^|><@\"~`&','         ')),' '))\n                  ||'\",\"' ||\n                  TRIM(NVL(LTRIM(TRANSLATE(d2450100e2dda59c2b7828b4daff7f8c.b0244019950c3493f027ab46f08f4a24,'*^|><@\"~`&','         ')),' '))\n                  ||'\",\"' ||\n                  TRIM(NVL(LTRIM(TRANSLATE(\n                  case when 42d2f22fd842b0cd27dffbea21620904.73fc2afbbbce75dfdb12e62a0b628ace in ('EC','MO','NV','VP') then 'EC'\n                       when 42d2f22fd842b0cd27dffbea21620904.73fc2afbbbce75dfdb12e62a0b628ace in ('ED','OS','EP') then 'ED'\n                       when 42d2f22fd842b0cd27dffbea21620904.73fc2afbbbce75dfdb12e62a0b628ace in ('CS','SO') then 'CS'\n                   else 'N' END,'*^|><@\"~`&','         ')),' '))\n                  ||'\",\"' ||\n                  TRIM(NVL(LTRIM(TRANSLATE(42d2f22fd842b0cd27dffbea21620904.4f53412a65a5d5ad453a0fed47eff7e2,'*^|><@\"~`&','         ')),' '))\n                  ||'\",\"' ||\n                  TRIM(NVL(LTRIM(TRANSLATE(d2450100e2dda59c2b7828b4daff7f8c.7190e92bd222014102cfd9666cf8958b,'*^|><@\"~`&','         ')),' '))\n                  ||'\",\"' ||\n                  TRIM(NVL(LTRIM(TRANSLATE(42d2f22fd842b0cd27dffbea21620904.26ac88e7ae671a1b22c14c2fce77aa2d,'*^|><@\"~`&','         ')),' '))\n                  ||'\",\"' ||\n                  TRIM(NVL(LTRIM(TRANSLATE(case when 09edb2cf1063d4b8a08f1e26f3b588f6.8e41b46a4a3a31065ad39d43bdc0718f in ( 1,2,3)  then 'Y' else 'N' END,'*^|><@\"~`&','         ')),' '))\n                  ||'\"'\n  FROM   de459e2fe7f96e4d958537b31b946b26.732b43949b41dca660ea11de3ca9757c sd,\n         de459e2fe7f96e4d958537b31b946b26.52982d3bbc1ebc2720d9504c7ea2ed3f c,\n         de459e2fe7f96e4d958537b31b946b26.dec387908a0954ddc8689c4ad37c8a3c b,\n         de459e2fe7f96e4d958537b31b946b26.48897903f4dd9dc6e7add38a894afe49 cov,\n         de459e2fe7f96e4d958537b31b946b26.c50b6339218f0dbbd97ce6557f2b051f pc,\n         de459e2fe7f96e4d958537b31b946b26.2c04d82ed0aa1cc9bce2cf2c0548b268 pim,\n         user_emp tm_id,\n         user_emp dsm_id,\n         user_emp rsm_id,\n         ec_user,\n         de459e2fe7f96e4d958537b31b946b26.dec387908a0954ddc8689c4ad37c8a3c rd,\n         (select distinct acqstn_div_nbr,usf_div_nbr,usf_cust_nbr from de459e2fe7f96e4d958537b31b946b26.8eae11f045abcaeef748e06941c671c9e32f6dd38f333cde68119d1f277367cd) ac\n WHERE   42d2f22fd842b0cd27dffbea21620904.f5dd4374a3e3af6a775cb6d6b22e8162 BETWEEN TO_DATE ('' || twowkstrtdt || '','YYYYMMDDHH24MISS')  AND  TO_DATE ('' || twowkenddt || '','YYYYMMDDHH24MISS')\n         \n         AND 6d9b37be5a083f8b78d676aba846c823.fa741a84bd7a01a1c4b5dc91364baac5 = 42d2f22fd842b0cd27dffbea21620904.fa741a84bd7a01a1c4b5dc91364baac5\n         AND d2450100e2dda59c2b7828b4daff7f8c.7f599f836c449bebb92bb9757e86c603 = 42d2f22fd842b0cd27dffbea21620904.7f599f836c449bebb92bb9757e86c603\n         AND d2450100e2dda59c2b7828b4daff7f8c.dd6238100904f569270d672fe0643a5a = '1'\n         AND NVL(a2b583bded519902122af5dbdafdf5a6.dd95a4741b2ab36b2428b3c42ef8b0448cd47113485ed05c776655af504ed664,a2b583bded519902122af5dbdafdf5a6.4fdc122fb2d10dd764e32cbc98972eca) = be54619bc5dd196d4e6d67ae1af2ac13.839c4ffb4bfaae1bb58eab4dee67d96a\n         AND NVL(be54619bc5dd196d4e6d67ae1af2ac13.c712a9ab5ef100c5807fa96123dac48b,'USF') <> 'USF'\n         AND 42d2f22fd842b0cd27dffbea21620904.26ac88e7ae671a1b22c14c2fce77aa2d NOT IN ('AP', 'AN')\n         AND 42d2f22fd842b0cd27dffbea21620904.49dbc899bc8f9659472a5a3b3510790c IS NULL\n         AND 42d2f22fd842b0cd27dffbea21620904.ca329b170a83f14795f7d01859b0fe42 IS NULL\n         AND c1f84e8860c9acbd312fc2d82a40cc08.8b8c72c349530db846280000957f636d = 42d2f22fd842b0cd27dffbea21620904.8b8c72c349530db846280000957f636d\n         AND 42f98af8b44bfddfe984d4995da7a9c4.0a85164948783cdf0d4416f41905a154 = 42d2f22fd842b0cd27dffbea21620904.0a85164948783cdf0d4416f41905a154\n         AND aeaad0a1b4f46a0780f8669dcffabbbd.4d732318d69998c6709a6e5b1b6b8d11(+) = TO_CHAR (42d2f22fd842b0cd27dffbea21620904.abfa8e82cd46bbb827127b6cb2f5d6d5)\n         AND UPPER (42d2f22fd842b0cd27dffbea21620904.f2afece23955e23b9d2f09fce0b18c61382d0f5d3019cd2839eb42d66c71274c) = e348cd959cea5b29b6ed565cef7e9b0e.d9b20f4b35d5639078e9ce32cf0724c5(+)\n         AND UPPER (42d2f22fd842b0cd27dffbea21620904.f3c7ed306cc6a6b3d6cfb40db08ba919e18a0efa177931495b66865407b6da30) = 1e956b5722c4a8bb6192646e15f402d4.d9b20f4b35d5639078e9ce32cf0724c5(+)\n         AND 045e8935e1c2fd0adc47d5be3e82b5c8.d9b20f4b35d5639078e9ce32cf0724c5(+) = d2450100e2dda59c2b7828b4daff7f8c.72dc428b3abefe008be0a8e1a56cc26e\n         AND 09edb2cf1063d4b8a08f1e26f3b588f6.777c30c4dc8f94cdbbd30df0ca1c6266 (+) = 42d2f22fd842b0cd27dffbea21620904.4f53412a65a5d5ad453a0fed47eff7e2\n         AND NVL(a2b583bded519902122af5dbdafdf5a6.dd95a4741b2ab36b2428b3c42ef8b0448cd47113485ed05c776655af504ed664,a2b583bded519902122af5dbdafdf5a6.4fdc122fb2d10dd764e32cbc98972eca) = c22ef4f68a5ce77cac2721b5c4355dc2.7119edd3603ebb20b91958f0a115fc7d\n         AND a2b583bded519902122af5dbdafdf5a6.852fa1e9f02f1ca2c75837f7146b2381 = c22ef4f68a5ce77cac2721b5c4355dc2.c572a183401f813e58e3b20fc631ab82\n         AND a2b583bded519902122af5dbdafdf5a6.839c4ffb4bfaae1bb58eab4dee67d96a = c22ef4f68a5ce77cac2721b5c4355dc2.ca157151dbcbc8ad1bcb2e107c0a7d67\n          group by\n            c1f84e8860c9acbd312fc2d82a40cc08.1cb2540b20bdff2cba42229b96ddf301,\n            c1f84e8860c9acbd312fc2d82a40cc08.f163c0eb7a9bbba5c90dbb9e4f32ab9f,\n            42d2f22fd842b0cd27dffbea21620904.8708a839c00cf7a8852df326dbe38f05382d0f5d3019cd2839eb42d66c71274c,\n            c1f84e8860c9acbd312fc2d82a40cc08.a8578017628b84f4dd067faec4d9464f,\n            c1f84e8860c9acbd312fc2d82a40cc08.d3268eabc4a7d98105fd85f9c9e62cd6e32ad436514bbe822b33de8bead744f3,\n            42f98af8b44bfddfe984d4995da7a9c4.2d45d761eb8d137835bca7a23010fab4,\n            c1f84e8860c9acbd312fc2d82a40cc08.1be023bf16131ae1db14f4851cffcb11,\n            c1f84e8860c9acbd312fc2d82a40cc08.f5893bf557f879cfbf83e63ac2051e8815ebda0b6e5cc8d4c919a8c71a9d07e4,\n            c1f84e8860c9acbd312fc2d82a40cc08.63b05a90087d2241b8b6790c7253a055f90adc90d03e80e5248398220ac3e975,\n            42d2f22fd842b0cd27dffbea21620904.74b5cefda7cf1a7db3f0a3091333ac05,\n            42d2f22fd842b0cd27dffbea21620904.106cff97a417dbe6c4979d1de5e4bc76382d0f5d3019cd2839eb42d66c71274c,\n            42d2f22fd842b0cd27dffbea21620904.80f3b424d7258a583f0dff0f4d4b159d382d0f5d3019cd2839eb42d66c71274c,\n            42d2f22fd842b0cd27dffbea21620904.c51ab05c6acd87cdbf495339cf5496c0dfb673c032e1fff141ac84551b91849a,\n            42d2f22fd842b0cd27dffbea21620904.b5e1ce6b2ac430bf504b82957a3e2685,\n            42d2f22fd842b0cd27dffbea21620904.f97b65e019a6572a4dfbc160d1d868ff382d0f5d3019cd2839eb42d66c71274c,\n            42f98af8b44bfddfe984d4995da7a9c4.781ac23919080fc8eb55bcb343c13931,\n            42d2f22fd842b0cd27dffbea21620904.f5dd4374a3e3af6a775cb6d6b22e8162,\n            42d2f22fd842b0cd27dffbea21620904.be8d7c2ea76d3152927ebf8709ea0326,\n            42d2f22fd842b0cd27dffbea21620904.faaaf9cbe8897987592d529a771bbc17,\n            42d2f22fd842b0cd27dffbea21620904.d5506821c4ea14a4d9ee0f0ce4e7652d,\n            42d2f22fd842b0cd27dffbea21620904.f2afece23955e23b9d2f09fce0b18c61382d0f5d3019cd2839eb42d66c71274c,\n            42d2f22fd842b0cd27dffbea21620904.0c499b9342241191d5d5fc19d9822401382d0f5d3019cd2839eb42d66c71274c,\n            42d2f22fd842b0cd27dffbea21620904.d55fbc4a3259962a8ab4fbedc0065134,\n            42d2f22fd842b0cd27dffbea21620904.e8a1b74c58655c6b8ffcb348b45f0a27,\n            42d2f22fd842b0cd27dffbea21620904.f3c7ed306cc6a6b3d6cfb40db08ba919e18a0efa177931495b66865407b6da30,\n            42d2f22fd842b0cd27dffbea21620904.58b87fef0b56bd2bd029967f2dfe55798b31ebbdd4a917cc13e004a9efd1e6bd,\n            42d2f22fd842b0cd27dffbea21620904.7c11ab787cf6f310ca23c850e9034413e32f6dd38f333cde68119d1f277367cd,\n            d2450100e2dda59c2b7828b4daff7f8c.852fa1e9f02f1ca2c75837f7146b2381,\n            6d9b37be5a083f8b78d676aba846c823.4855453efe73ff0bd0f7583df58260dd,\n            6d9b37be5a083f8b78d676aba846c823.839c4ffb4bfaae1bb58eab4dee67d96a,\n            6d9b37be5a083f8b78d676aba846c823.8b78bca74c200ef55dc944fae0f72a56,\n            42d2f22fd842b0cd27dffbea21620904.abfa8e82cd46bbb827127b6cb2f5d6d5,\n            aeaad0a1b4f46a0780f8669dcffabbbd.ec5f47a7f9d05b8b244d5898ce36aa8d,\n            42f98af8b44bfddfe984d4995da7a9c4.ea5b512300324c431c7620e2dcfa897f,\n            42f98af8b44bfddfe984d4995da7a9c4.2e775f14abc8392c69b08165a3aa95c4,\n            42d2f22fd842b0cd27dffbea21620904.f2e27750b8738746a93b585e377bbeb9,\n            d2450100e2dda59c2b7828b4daff7f8c.116f2cd181d527334694326f442fe0b4,\n            d2450100e2dda59c2b7828b4daff7f8c.60425c3a30e707860f8c49e4d570e105,\n            d2450100e2dda59c2b7828b4daff7f8c.72dc428b3abefe008be0a8e1a56cc26e,\n            d2450100e2dda59c2b7828b4daff7f8c.aa7b5e6986ce32ac25fa082282dfc40a,\n            045e8935e1c2fd0adc47d5be3e82b5c8.d3bf6a02136dbf2e2bb717980d5bb171,\n            1e956b5722c4a8bb6192646e15f402d4.d3bf6a02136dbf2e2bb717980d5bb171,\n            e348cd959cea5b29b6ed565cef7e9b0e.d3bf6a02136dbf2e2bb717980d5bb171,\n            42d2f22fd842b0cd27dffbea21620904.a00b7aac034b1de6ebfabe4a7097af1b3c072b0281819f75f19257cd7009a1b3,\n            42f98af8b44bfddfe984d4995da7a9c4.b5f7a669e88f8b603dbacd55092d5d25,\n            42f98af8b44bfddfe984d4995da7a9c4.670546dc34550a5e54ce483709fe795e,\n            d2450100e2dda59c2b7828b4daff7f8c.ea2a6fac3818a6a2522f130f8418653f,\n            d2450100e2dda59c2b7828b4daff7f8c.17a070f45558c000ef488aabe8b430c2,\n            42d2f22fd842b0cd27dffbea21620904.5112ab47fb19df73f8ed2678ddc0ecdb34ceb39ae2f66f21170198c2e55391b5,\n            42d2f22fd842b0cd27dffbea21620904.5b166c5fe66db413f1e228635901a0965479098e904da91bb293c4391be1730d,\n            c1f84e8860c9acbd312fc2d82a40cc08.9417ab04bd2e9c1e93b563a48bcf145f,\n            42f98af8b44bfddfe984d4995da7a9c4.4b398d884e397727aeb50b1bf2299e607e8fe841f8abc0a126967273be28f1b7,\n            42f98af8b44bfddfe984d4995da7a9c4.4b398d884e397727aeb50b1bf2299e6098df5d6b623334f2e9631188cca4cfd6,\n            42d2f22fd842b0cd27dffbea21620904.1065b8b1389467c159d06cefb2115e1ee32f6dd38f333cde68119d1f277367cd,\n            42d2f22fd842b0cd27dffbea21620904.00cdbed4bd71948125ed2b15120f69168530a6af9816b2bc4970d57e532d4b4b,\n            d2450100e2dda59c2b7828b4daff7f8c.4c519ea2261e05bc61c96b41c134952f0a12b52193ec2e9d203d998bbff069f9,\n            42d2f22fd842b0cd27dffbea21620904.e33988f12139bfc93f1e7557137feb5a1ee195c0a70d0165e55ff54074aadc17,\n            42d2f22fd842b0cd27dffbea21620904.95d310dcb2cf99cf2d1b5ab1f71190b6,\n            42d2f22fd842b0cd27dffbea21620904.c2b9ebe664db8cfc1f7a702af0630a5b,\n            d2450100e2dda59c2b7828b4daff7f8c.b0244019950c3493f027ab46f08f4a24,\n            42d2f22fd842b0cd27dffbea21620904.73fc2afbbbce75dfdb12e62a0b628ace,\n            42d2f22fd842b0cd27dffbea21620904.4f53412a65a5d5ad453a0fed47eff7e2,\n            d2450100e2dda59c2b7828b4daff7f8c.7190e92bd222014102cfd9666cf8958b,\n            42d2f22fd842b0cd27dffbea21620904.26ac88e7ae671a1b22c14c2fce77aa2d,\n            case when user_typ in ( 1,2,3)  then 'Y' else 'N' END;\n\n\n      COMMIT;\n      DBMS_OUTPUT.PUT_LINE('...End of  Insert ' || UPPER(RTRIM(SUBSTR(p_partner_id, 1, 30))));\n      DBMS_OUTPUT.PUT_LINE('...Count  Insert ' || UPPER(RTRIM(SUBSTR(p_partner_id, 1, 30))));\n\n      EXECUTE IMMEDIATE 'INSERT  INTO ' || v_owner || '.' || v_prd_tbl_name ||\n                        ' NOLOGGING (KEY_augeo_SALES, DATA_augeo_SALES)\n                          SELECT DISTINCT\n                                 UPPER(RTRIM (SUBSTR (''' || p_partner_id || ''', 1, 30))),\n                                 ''\"Sales Transactions\",''\n                                 ||\n                                 COUNT(*)\n                                 ||'',''||\n                                 sysdate\n                          FROM '  || v_owner || '.' || v_prd_tbl_name ||\n                         ' WHERE key_augeo_sales = UPPER(RTRIM(SUBSTR(''' || p_partner_id || ''', 1, 30)))';\n\n      COMMIT;\n      DBMS_OUTPUT.PUT_LINE('...End of Count Insert ' || UPPER(RTRIM(SUBSTR(p_partner_id, 1, 30))));\n\n   END;\n\n   DBMS_OUTPUT.PUT_LINE('...');\n   DBMS_OUTPUT.PUT_LINE('END of function ' || v_owner || '.' || v_fn_name);\n   RETURN 0;\nEXCEPTION\n   WHEN NO_DATA_FOUND THEN\n      DBMS_OUTPUT.PUT_LINE('...ERROR NO DATA inserting into table ' || v_owner || '.' || v_prd_tbl_name);\n      DBMS_OUTPUT.PUT_LINE('...SQLERRM: ' || SQLERRM);\n      DBMS_OUTPUT.PUT_LINE('...SQLCODE: ' || SQLCODE);\n      DBMS_OUTPUT.PUT_LINE('END of function ' || v_owner || '.' || v_fn_name);\n      RETURN 2;\n   WHEN OTHERS THEN\n      ROLLBACK;\n      DBMS_OUTPUT.PUT_LINE('...ERROR OTHERS inserting into table ' || v_owner || '.' || v_prd_tbl_name);\n      DBMS_OUTPUT.PUT_LINE('...SQLERRM: ' || SQLERRM);\n      DBMS_OUTPUT.PUT_LINE('...SQLCODE: ' || SQLCODE);\n      DBMS_OUTPUT.PUT_LINE('END of function ' || v_owner || '.' || v_fn_name);\n      RETURN 3;\nEND fn_augeo_sales_extrct;\n/",
            "upstream_dependencies": [],
            "downstream_dependencies": [],
            "dag_location": "null",
            "gantt_location": "null",
            "created_at": "null",
            "updated_at": "null"
        }
    ]
}