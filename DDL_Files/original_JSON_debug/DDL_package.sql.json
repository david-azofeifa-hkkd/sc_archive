{
    "filename": "ddl_package.sql",
    "numb_objects": 13,
    "type": "package",
    "type_hex": "00e308bf670f4e8deeb698f78dff87e6",
    "encryption_key_type": "package.key",
    "inventory": [
        {
            "name": "PKG_CPAT_MARKUP_DEV_BASIS",
            "encrypted_name": "1b876f1061cd9941af8d7fd80a6be04734a1757f4bad54138c2efb5761614607",
            "type": "package",
            "database": "null",
            "encrypted_database": "null",
            "schema": "XDMADM",
            "encrypted_schema": "da238e96cf2cb791a097ca6946c096b4",
            "fully_qualified_name": "XDMADM.PKG_CPAT_MARKUP_DEV_BASIS",
            "encrypted_fqn": "da238e96cf2cb791a097ca6946c096b4.1b876f1061cd9941af8d7fd80a6be04734a1757f4bad54138c2efb5761614607",
            "synonyms": [],
            "metadata_analysis": "CREATE OR REPLACE PACKAGE \"da238e96cf2cb791a097ca6946c096b4\".\"1b876f1061cd9941af8d7fd80a6be04734a1757f4bad54138c2efb5761614607\" AS\n\n  \n FUNCTION fn_get_dev_cost_calc_markup1(\n      prime_deviated_cost_type IN VARCHAR2,\n      prime_markup_indicator   IN VARCHAR2,\n      price_uom                IN VARCHAR2,\n      dev_cost_margin          IN NUMBER,\n      NET_WT_SHIPPED           IN NUMBER,\n      UNFM_QTY_SHPD            IN NUMBER,\n      DEV_COST                 IN NUMBER,\n      inv_freight              IN NUMBER,\n      dev_cost_allowance       IN NUMBER,\n      vendor_inv_cost          IN NUMBER)\n   RETURN NUMBER DETERMINISTIC PARALLEL_ENABLE;\n\n   FUNCTION fn_get_dev_cost_calc_sellprice(\n      prime_deviated_cost_type IN VARCHAR2,\n      prime_cont_ea_mkup_type   IN VARCHAR2,\n      price_uom                IN VARCHAR2,\n      sales_uom                IN VARCHAR2,\n      each_conv_fctr           IN NUMBER,\n      DEV_COST                 IN NUMBER,\n      inv_freight              IN NUMBER,\n      dev_cost_allowance       IN NUMBER,\n      vendor_inv_cost          IN NUMBER,\n      dev_cost_calc_markup     IN NUMBER,\n      prime_min_markup_amount  IN NUMBER,\n      each_shpd                IN NUMBER)\n   RETURN NUMBER DETERMINISTIC PARALLEL_ENABLE;\n\nEND PKG_CPAT_MARKUP_DEV_BASIS;\n/\nCREATE OR REPLACE PACKAGE BODY \"da238e96cf2cb791a097ca6946c096b4\".\"1b876f1061cd9941af8d7fd80a6be04734a1757f4bad54138c2efb5761614607\"\nAS\n\nFUNCTION fn_get_dev_cost_calc_markup1(\n    prime_deviated_cost_type IN VARCHAR2,\n    prime_markup_indicator   IN VARCHAR2,\n    price_uom                IN VARCHAR2,\n    dev_cost_margin          IN NUMBER,\n    NET_WT_SHIPPED           IN NUMBER,\n    UNFM_QTY_SHPD            IN NUMBER,\n    DEV_COST                 IN NUMBER,\n    inv_freight              IN NUMBER,\n    dev_cost_allowance       IN NUMBER,\n    vendor_inv_cost          IN NUMBER)\n  RETURN NUMBER DETERMINISTIC PARALLEL_ENABLE\nIS\n  \n  dev_cost_calc_markup1 NUMBER;\nBEGIN\n  dev_cost_calc_markup1 :=\n  CASE\n  WHEN prime_deviated_cost_type IN ('FX', 'G') THEN\n    0\n  WHEN prime_deviated_cost_type <> 'FX' OR prime_deviated_cost_type IS NULL THEN\n    CASE\n    WHEN prime_markup_indicator IN ('D', 'N') OR prime_markup_indicator IS NULL THEN\n      CASE\n      WHEN price_uom = 'LB' THEN\n        CASE WHEN UNFM_QTY_SHPD = 0 THEN 0 ELSE\n          dev_cost_margin / ( NET_WT_SHIPPED / UNFM_QTY_SHPD )\n        END\n      WHEN price_uom   IN ('CS', 'EA') THEN\n        dev_cost_margin\n      END\n    WHEN prime_markup_indicator = '#' THEN\n      CASE\n      WHEN price_uom    IN ('CS', 'EA') THEN\n        CASE WHEN UNFM_QTY_SHPD = 0 THEN 0 ELSE\n          ( NET_WT_SHIPPED / UNFM_QTY_SHPD ) * dev_cost_margin\n        END\n      WHEN price_uom = 'LB' THEN\n        dev_cost_margin\n      END\n    WHEN prime_markup_indicator = 'P' THEN\n      CASE\n      WHEN prime_deviated_cost_type = 'AL' THEN\n        (vendor_inv_cost + dev_cost_allowance ) * dev_cost_margin\n      WHEN prime_deviated_cost_type = 'D' THEN\n        DEV_COST * dev_cost_margin\n      WHEN prime_deviated_cost_type = 'F' THEN\n        (DEV_COST + inv_freight ) * dev_cost_margin\n      WHEN prime_deviated_cost_type IS NULL THEN\n        vendor_inv_cost * dev_cost_margin\n      END\n    END\n  END;\n  RETURN(NVL(dev_cost_calc_markup1,0));\nEND;\n\nFUNCTION fn_get_dev_cost_calc_sellprice(\n    prime_deviated_cost_type IN VARCHAR2,\n    prime_cont_ea_mkup_type  IN VARCHAR2,\n    price_uom                IN VARCHAR2,\n    sales_uom                IN VARCHAR2,\n    each_conv_fctr           IN NUMBER,\n    DEV_COST                 IN NUMBER,\n    inv_freight              IN NUMBER,\n    dev_cost_allowance       IN NUMBER,\n    vendor_inv_cost          IN NUMBER,\n    dev_cost_calc_markup     IN NUMBER,\n    prime_min_markup_amount  IN NUMBER,\n    each_shpd                IN NUMBER)\n  RETURN NUMBER DETERMINISTIC PARALLEL_ENABLE\nIS\n  \n  dev_cost_calc_sellprice NUMBER;\nBEGIN\n  dev_cost_calc_sellprice :=\n  CASE\n  WHEN each_shpd = 0 THEN\n    CASE\n    WHEN prime_deviated_cost_type = 'AL' THEN\n      vendor_inv_cost              + dev_cost_allowance + dev_cost_calc_markup\n    WHEN prime_deviated_cost_type IN ('D', 'FX', 'G') THEN\n      dev_cost                     + dev_cost_calc_markup\n    WHEN prime_deviated_cost_type = 'F' THEN\n      dev_cost+ inv_freight + dev_cost_calc_markup\n    WHEN prime_deviated_cost_type IS NULL THEN\n      vendor_inv_cost+ dev_cost_calc_markup\n    END\n  ELSE\n    CASE\n    WHEN prime_cont_ea_mkup_type = 'P' THEN\n      CASE\n      WHEN prime_deviated_cost_type = 'AL' THEN\n        CASE\n        WHEN sales_uom = 'CS' AND price_uom = 'CS' OR sales_uom = 'EA' AND price_uom = 'EA' THEN\n          CASE\n          WHEN each_conv_fctr = 0 THEN\n            0\n          ELSE\n            (((vendor_inv_cost+ dev_cost_allowance + dev_cost_calc_markup) / each_conv_fctr) * (1 + (prime_min_markup_amount / 100)))\n          END\n        WHEN sales_uom = 'CS' AND price_uom = 'LB' OR sales_uom = 'CS' AND price_uom = 'EA' OR sales_uom = 'EA' AND price_uom = 'CS' OR sales_uom = 'EA' AND price_uom = 'LB' THEN\n          ((vendor_inv_cost+ dev_cost_allowance + dev_cost_calc_markup) * (1 + (prime_min_markup_amount / 100)))\n        END\n      WHEN prime_deviated_cost_type IN ('D', 'FX') THEN\n        CASE\n        WHEN sales_uom = 'CS' AND price_uom = 'CS' OR sales_uom = 'EA' AND price_uom = 'EA' THEN\n          CASE WHEN each_conv_fctr = 0 THEN 0 ELSE\n            (((dev_cost+ dev_cost_calc_markup) / each_conv_fctr) * (1 + (prime_min_markup_amount / 100)))\n          END\n        WHEN sales_uom = 'CS' AND price_uom = 'LB' OR sales_uom = 'CS' AND price_uom = 'EA' OR sales_uom = 'EA' AND price_uom = 'CS' OR sales_uom = 'EA' AND price_uom = 'LB' THEN\n          ((dev_cost+ dev_cost_calc_markup) * (1 + (prime_min_markup_amount / 100)))\n        END\n      WHEN prime_deviated_cost_type = 'F' THEN\n        CASE\n        WHEN sales_uom = 'CS' AND price_uom = 'CS' OR sales_uom = 'EA' AND price_uom = 'EA' THEN\n          CASE\n          WHEN each_conv_fctr = 0 THEN\n            0\n          ELSE\n            (((dev_cost+ inv_freight + dev_cost_calc_markup) / each_conv_fctr) * (1 + prime_min_markup_amount / 100))\n          END\n        WHEN sales_uom = 'CS' AND price_uom = 'LB' OR sales_uom = 'CS' AND price_uom = 'EA' OR sales_uom = 'EA' AND price_uom = 'CS' OR sales_uom = 'EA' AND price_uom = 'LB' THEN\n          (dev_cost+ dev_cost_calc_markup) * (1 + prime_min_markup_amount / 100)\n        END\n      WHEN prime_deviated_cost_type IS NULL THEN\n        CASE\n        WHEN sales_uom = 'CS' AND price_uom = 'CS' OR sales_uom = 'EA' AND price_uom = 'EA' THEN\n          CASE\n          WHEN each_conv_fctr = 0 THEN\n            0\n          ELSE\n            (((vendor_inv_cost+ dev_cost_calc_markup) / each_conv_fctr) * (1 +( prime_min_markup_amount / 100)))\n          END\n        WHEN sales_uom = 'CS' AND price_uom = 'LB' OR sales_uom = 'CS' AND price_uom = 'EA' OR sales_uom = 'EA' AND price_uom = 'CS' OR sales_uom = 'EA' AND price_uom = 'LB' THEN\n          ((vendor_inv_cost+ dev_cost_calc_markup) * (1 + (prime_min_markup_amount / 100)))\n        END\n      END\n    WHEN prime_cont_ea_mkup_type <> 'P' OR prime_cont_ea_mkup_type IS NULL THEN\n      CASE\n      WHEN prime_deviated_cost_type = 'AL' THEN\n        CASE\n        WHEN sales_uom = 'CS' AND price_uom = 'CS' OR sales_uom = 'EA' AND price_uom = 'EA' THEN\n          CASE\n          WHEN each_conv_fctr = 0 THEN\n            prime_min_markup_amount\n          ELSE\n            (((vendor_inv_cost+ dev_cost_allowance + dev_cost_calc_markup) / each_conv_fctr) + prime_min_markup_amount)\n          END\n        WHEN sales_uom = 'CS' AND price_uom = 'LB' OR sales_uom = 'CS' AND price_uom = 'EA' OR sales_uom = 'EA' AND price_uom = 'CS' OR sales_uom = 'EA' AND price_uom = 'LB' THEN\n          ((vendor_inv_cost+ dev_cost_allowance + dev_cost_calc_markup) + prime_min_markup_amount)\n        END\n      WHEN prime_deviated_cost_type IN ('D', 'FX') THEN\n        CASE\n        WHEN sales_uom = 'CS' AND price_uom = 'CS' OR sales_uom = 'EA' AND price_uom = 'EA' THEN\n          CASE\n          WHEN each_conv_fctr = 0 THEN\n            prime_min_markup_amount\n          ELSE\n            ((dev_cost+ dev_cost_calc_markup) / each_conv_fctr) + prime_min_markup_amount\n          END\n        WHEN sales_uom = 'CS' AND price_uom = 'LB' OR sales_uom = 'CS' AND price_uom = 'EA' OR sales_uom = 'EA' AND price_uom = 'CS' OR sales_uom = 'EA' AND price_uom = 'LB' THEN\n          dev_cost+ dev_cost_calc_markup + prime_min_markup_amount\n        END\n      WHEN prime_deviated_cost_type = 'F' THEN\n        CASE\n        WHEN sales_uom = 'CS' AND price_uom = 'CS' OR sales_uom = 'EA' AND price_uom = 'EA' THEN\n          CASE\n          WHEN each_conv_fctr = 0 THEN\n            prime_min_markup_amount\n          ELSE\n            ( ((dev_cost+ inv_freight + dev_cost_calc_markup) / each_conv_fctr) + prime_min_markup_amount)\n          END\n        WHEN sales_uom = 'CS' AND price_uom = 'LB' OR sales_uom = 'CS' AND price_uom = 'EA' OR sales_uom = 'EA' AND price_uom = 'CS' OR sales_uom = 'EA' AND price_uom = 'LB' THEN\n          dev_cost+ inv_freight + dev_cost_calc_markup + prime_min_markup_amount\n        END\n      WHEN prime_deviated_cost_type IS NULL THEN\n        CASE\n        WHEN sales_uom = 'CS' AND price_uom = 'CS' OR sales_uom = 'EA' AND price_uom = 'EA' THEN\n          CASE\n          WHEN each_conv_fctr = 0 THEN\n            prime_min_markup_amount\n          ELSE\n            (( (vendor_inv_cost+ dev_cost_calc_markup) / each_conv_fctr) + prime_min_markup_amount)\n          END\n        WHEN sales_uom = 'CS' AND price_uom = 'LB' OR sales_uom = 'CS' AND price_uom = 'EA' OR sales_uom = 'EA' AND price_uom = 'CS' OR sales_uom = 'EA' AND price_uom = 'LB' THEN\n          vendor_inv_cost+ dev_cost_calc_markup + prime_min_markup_amount\n        END\n      END\n    END\n  END ;\n  RETURN(NVL(dev_cost_calc_sellprice,0));\nEND;\n\nEND PKG_CPAT_MARKUP_DEV_BASIS;\n/",
            "upstream_dependencies": [],
            "downstream_dependencies": [],
            "dag_location": "null",
            "gantt_location": "null",
            "created_at": "null",
            "updated_at": "null"
        },
        {
            "name": "PKG_ICM_AUDIT_YRLY",
            "encrypted_name": "d4f8f6d68b3396b7668667be00b478d13cacc2b8843d282f4cbbeb45fa96287c",
            "type": "package",
            "database": "null",
            "encrypted_database": "null",
            "schema": "XDMADM",
            "encrypted_schema": "da238e96cf2cb791a097ca6946c096b4",
            "fully_qualified_name": "XDMADM.PKG_ICM_AUDIT_YRLY",
            "encrypted_fqn": "da238e96cf2cb791a097ca6946c096b4.d4f8f6d68b3396b7668667be00b478d13cacc2b8843d282f4cbbeb45fa96287c",
            "synonyms": [],
            "metadata_analysis": "CREATE OR REPLACE PACKAGE \"da238e96cf2cb791a097ca6946c096b4\".\"d4f8f6d68b3396b7668667be00b478d13cacc2b8843d282f4cbbeb45fa96287c\"\nIS\n  FUNCTION get_audit_yrl_by_rng (   pi_start_dt             DATE,\n                                    pi_end_dt               DATE,\n                                    pi_fisc_yr_wk_fltr      NUMBER,\n                                    po_cnt            OUT   INTEGER,\n                                    po_main_header    OUT   VARCHAR2,\n                                    po_audit_data     OUT   SYS_REFCURSOR,\n                                    po_err_msg        OUT   VARCHAR2\n                                  )\n  RETURN INTEGER;\n\n  FUNCTION get_audit_yrly  ( pi_odate                  DATE,\n                             po_start_dt         OUT   DATE,\n                             po_end_dt           OUT   DATE,\n                             po_cnt              OUT   INTEGER,\n                             po_main_header      OUT   VARCHAR2,\n                             po_audit_data       OUT   SYS_REFCURSOR,\n                             po_err_msg          OUT   VARCHAR2\n                           )\n  RETURN INTEGER;\n\nEND pkg_icm_audit_yrly;\n/\nCREATE OR REPLACE PACKAGE BODY \"da238e96cf2cb791a097ca6946c096b4\".\"d4f8f6d68b3396b7668667be00b478d13cacc2b8843d282f4cbbeb45fa96287c\"\nIS\n  FUNCTION get_audit_yrl_by_rng (   pi_start_dt             DATE,\n                                    pi_end_dt               DATE,\n                                    pi_fisc_yr_wk_fltr      NUMBER,\n                                    po_cnt            OUT   INTEGER,\n                                    po_main_header    OUT   VARCHAR2,\n                                    po_audit_data     OUT   SYS_REFCURSOR,\n                                    po_err_msg        OUT   VARCHAR2\n                                  )\n  RETURN INTEGER\n  IS\n\n    v_xiw_obj     ICM_REC_LST := ICM_REC_LST();\n  BEGIN\n\n\n   \n    BEGIN\n     SELECT icm_rec(\n           57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.5a8103ceb3eda727eed8d3dbc244a027,\n           57eef8c3d4a13d22f0b40f9742e7b281.a2349118cac55136943abdf2d397e141.ac8fc124015ba701703b74146aa53041,\n           \n           SUM(\n                CASE WHEN (57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.55527281f395dfb3da5179b6fd9fdd1c <> 0 or 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.13fcd0cc51f00e81b2ee89760eaea8fb <> 0 or 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.3a72ec6e15d9a9d5ad4b4e2189864568 <> 0 or 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.29ee98bf40dcf1c19fbccd668319a72c <> 0 or 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.9f2ec167f84f17ee6dfe57b8ec714693 <> 0 or 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.41d5e4898cd71dc736ae731c3f62d5fe <> 0)\n                     THEN 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.17e64617600c2354ae60406fd4d2a5e5\n                     ELSE 0\n                END\n            ) ,\n            SUM(\n                CASE WHEN (57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.55527281f395dfb3da5179b6fd9fdd1c <> 0 or 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.13fcd0cc51f00e81b2ee89760eaea8fb <> 0 or 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.3a72ec6e15d9a9d5ad4b4e2189864568<> 0 or 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.29ee98bf40dcf1c19fbccd668319a72c <> 0 or 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.9f2ec167f84f17ee6dfe57b8ec714693 <> 0 or 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.41d5e4898cd71dc736ae731c3f62d5fe <> 0)\n                      THEN 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.014a6a4a3ce2db63a65bd08cfb80baad6aa1c935b1d8edec16a1952ae6198b81\n                      ELSE 0\n                END\n            ) ,\n            SUM(\n                CASE WHEN  (57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.55527281f395dfb3da5179b6fd9fdd1c <> 0 or 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.13fcd0cc51f00e81b2ee89760eaea8fb <> 0 or 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.3a72ec6e15d9a9d5ad4b4e2189864568<> 0 or 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.29ee98bf40dcf1c19fbccd668319a72c <> 0 or 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.9f2ec167f84f17ee6dfe57b8ec714693 <> 0 or 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.41d5e4898cd71dc736ae731c3f62d5fe <> 0)\n                      THEN 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.7709512d3dd1748f15cd09ade0395178\n                      ELSE 0\n                END\n            ),\n            \n            SUM(\n                CASE WHEN (57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.55527281f395dfb3da5179b6fd9fdd1c <> 0 or 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.13fcd0cc51f00e81b2ee89760eaea8fb <> 0 or 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.3a72ec6e15d9a9d5ad4b4e2189864568<> 0 or 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.29ee98bf40dcf1c19fbccd668319a72c <> 0 or 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.9f2ec167f84f17ee6dfe57b8ec714693 <> 0 or 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.41d5e4898cd71dc736ae731c3f62d5fe <> 0)\n                      THEN 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.e2440f827db7580d6751d79df6eb33ab\n                      ELSE 0\n                END\n            ),\n            SUM(\n                CASE WHEN  (57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.55527281f395dfb3da5179b6fd9fdd1c <> 0 or 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.13fcd0cc51f00e81b2ee89760eaea8fb <> 0 or 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.3a72ec6e15d9a9d5ad4b4e2189864568<> 0 or 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.29ee98bf40dcf1c19fbccd668319a72c <> 0 or 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.9f2ec167f84f17ee6dfe57b8ec714693 <> 0 or 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.41d5e4898cd71dc736ae731c3f62d5fe <> 0)\n                      THEN 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.930b285ce315e28977675aa154aa6fb0\n                      ELSE 0\n                END\n            ),\n            SUM(\n                CASE WHEN (57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.55527281f395dfb3da5179b6fd9fdd1c <> 0 or 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.13fcd0cc51f00e81b2ee89760eaea8fb <> 0 or 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.3a72ec6e15d9a9d5ad4b4e2189864568<> 0 or 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.29ee98bf40dcf1c19fbccd668319a72c <> 0 or 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.9f2ec167f84f17ee6dfe57b8ec714693 <> 0 or 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.41d5e4898cd71dc736ae731c3f62d5fe <> 0)\n                      THEN Case when 57eef8c3d4a13d22f0b40f9742e7b281.a2349118cac55136943abdf2d397e141.ac8fc124015ba701703b74146aa53041 <= pi_fisc_yr_wk_fltr then 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.13fcd0cc51f00e81b2ee89760eaea8fb\n                                when 57eef8c3d4a13d22f0b40f9742e7b281.a2349118cac55136943abdf2d397e141.ac8fc124015ba701703b74146aa53041 > pi_fisc_yr_wk_fltr\n                                        and 57eef8c3d4a13d22f0b40f9742e7b281.7cad4bed0267ab37956f1fcccb769b24.d5888bb74952b9abf72c4e89988d3f67 in ( Select PARAM_VALUE_CHR from 57eef8c3d4a13d22f0b40f9742e7b281.1f9c921b05aafc28bf91547d5ec08a09 where app_name = 'ICM' and param_type = 'SLS_XTRCT_ASC_EXCLU' )\n                                    then 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.9e7e4013fd15c78725b0ef91cd1cd802\n                                when 57eef8c3d4a13d22f0b40f9742e7b281.a2349118cac55136943abdf2d397e141.ac8fc124015ba701703b74146aa53041 > pi_fisc_yr_wk_fltr\n                                        and nvl(57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.54df2c61b8dead2cd9983e6e7afd941e53a0c0fe76045acdb204ca36f43c8ecf, 'N') = 'P'\n                                    then 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.82ff1fbd196a541b2a6c518de23c8b880387c5968ab078795c6767989b7f4f6f\n                                else\n                                    nvl(57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.13fcd0cc51f00e81b2ee89760eaea8fb,0)\n                                end\n\n                      ELSE 0\n                END\n            ),\n            SUM(\n                CASE WHEN (57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.55527281f395dfb3da5179b6fd9fdd1c <> 0 or 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.13fcd0cc51f00e81b2ee89760eaea8fb <> 0 or 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.3a72ec6e15d9a9d5ad4b4e2189864568<> 0 or 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.29ee98bf40dcf1c19fbccd668319a72c <> 0 or 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.9f2ec167f84f17ee6dfe57b8ec714693 <> 0 or 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.41d5e4898cd71dc736ae731c3f62d5fe <> 0)\n                      THEN 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.6b62f388154d9d74f99187e0846154ae\n                      ELSE 0\n                END\n            ) ,\n            SUM(\n                CASE WHEN (57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.55527281f395dfb3da5179b6fd9fdd1c <> 0 or 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.13fcd0cc51f00e81b2ee89760eaea8fb <> 0 or 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.3a72ec6e15d9a9d5ad4b4e2189864568<> 0 or 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.29ee98bf40dcf1c19fbccd668319a72c <> 0 or 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.9f2ec167f84f17ee6dfe57b8ec714693 <> 0 or 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.41d5e4898cd71dc736ae731c3f62d5fe <> 0)\n                      THEN 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.7f60e7efcd4f1767251f3b6244c94cdd\n                      ELSE 0\n                END\n            ),\n            SUM(\n                CASE WHEN  (57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.55527281f395dfb3da5179b6fd9fdd1c <> 0 or 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.13fcd0cc51f00e81b2ee89760eaea8fb <> 0 or 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.3a72ec6e15d9a9d5ad4b4e2189864568<> 0 or 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.29ee98bf40dcf1c19fbccd668319a72c <> 0 or 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.9f2ec167f84f17ee6dfe57b8ec714693 <> 0 or 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.41d5e4898cd71dc736ae731c3f62d5fe <> 0)\n                      THEN 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.c5abdb5aaa1ae5ed7b59e7fede580c41\n                      ELSE 0\n                END\n            ),\n            SUM(\n                CASE WHEN  (57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.55527281f395dfb3da5179b6fd9fdd1c <> 0 or 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.13fcd0cc51f00e81b2ee89760eaea8fb <> 0 or 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.3a72ec6e15d9a9d5ad4b4e2189864568<> 0 or 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.29ee98bf40dcf1c19fbccd668319a72c <> 0 or 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.9f2ec167f84f17ee6dfe57b8ec714693 <> 0 or 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.41d5e4898cd71dc736ae731c3f62d5fe <> 0)\n                      THEN 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.8b184558137a598a274f90f061090872\n                      ELSE 0\n                END\n            ),\n            SUM(\n                CASE WHEN  (57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.55527281f395dfb3da5179b6fd9fdd1c <> 0 or 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.13fcd0cc51f00e81b2ee89760eaea8fb <> 0 or 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.3a72ec6e15d9a9d5ad4b4e2189864568<> 0 or 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.29ee98bf40dcf1c19fbccd668319a72c <> 0 or 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.9f2ec167f84f17ee6dfe57b8ec714693 <> 0 or 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.41d5e4898cd71dc736ae731c3f62d5fe <> 0)\n                      THEN 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.32e5e52f026130411e72586946369227e4a912e4ffab006ea4a0ab05e9f9c8a2\n                      ELSE 0\n                END\n            ),\n            SUM(\n                CASE WHEN  (57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.55527281f395dfb3da5179b6fd9fdd1c <> 0 or 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.13fcd0cc51f00e81b2ee89760eaea8fb <> 0 or 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.3a72ec6e15d9a9d5ad4b4e2189864568<> 0 or 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.29ee98bf40dcf1c19fbccd668319a72c <> 0 or 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.9f2ec167f84f17ee6dfe57b8ec714693 <> 0 or 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.41d5e4898cd71dc736ae731c3f62d5fe <> 0)\n                      THEN 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.55527281f395dfb3da5179b6fd9fdd1c\n                      ELSE 0\n                END\n            ),\n            SUM(\n                CASE WHEN (57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.55527281f395dfb3da5179b6fd9fdd1c <> 0 or 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.13fcd0cc51f00e81b2ee89760eaea8fb <> 0 or 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.3a72ec6e15d9a9d5ad4b4e2189864568<> 0 or 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.29ee98bf40dcf1c19fbccd668319a72c <> 0 or 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.9f2ec167f84f17ee6dfe57b8ec714693 <> 0 or 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.41d5e4898cd71dc736ae731c3f62d5fe <> 0)\n                      THEN 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.aade881ccc74be2b879c0be852a11d4b\n                      ELSE 0\n                END\n            ),\n            \n            SUM(\n                  CASE WHEN 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.8e296af0709009f4cb601a563ab2e022 = 'AP'\n                        THEN 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.a93269d2d91405b98207972fb3a1ae80\n                        ELSE 0\n                  END\n                ),\n            SUM(\n                  CASE WHEN 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.8e296af0709009f4cb601a563ab2e022 = 'AP'\n                        THEN 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.4c70c5d02da0d302a804df6269b1a296\n                        ELSE 0\n                  END\n                ),\n             \n             SUM(\n                  CASE WHEN 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.8e296af0709009f4cb601a563ab2e022 not in ('AN', 'AP')\n                        THEN 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.21e5fb5dc75c37995ffa0730c0ef316c\n                        ELSE 0\n                  END\n                ),\n             SUM(\n                  CASE WHEN 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.8e296af0709009f4cb601a563ab2e022 not in ('AN', 'AP')\n                       THEN 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.24f1f1728298ca5a992695a6ebebac42\n                       ELSE 0\n                  END\n                ),\n              \n            SUM(\n                  CASE  WHEN 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.8e296af0709009f4cb601a563ab2e022 = 'AN'\n                        THEN 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.dcb19bfbdec003cbb10d58e030a45453\n                        ELSE 0\n                  END\n                ),\n             SUM(\n                  CASE WHEN 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.8e296af0709009f4cb601a563ab2e022 = 'AN'\n                       THEN 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.83b62aa88625bb2b2eccd7436cb53f1b\n                       ELSE 0\n                  END\n                ), \n            \n             SUM(rbt_loc_accrl_amt)  ,\n             SUM(rbt_natl_accrl_amt) ,\n             SUM(rbt_loc_exp_amt)    ,\n             SUM(rbt_natl_exp_amt))\n      BULK COLLECT INTO v_xiw_obj\n      FROM 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e s INNER JOIN 57eef8c3d4a13d22f0b40f9742e7b281.7cad4bed0267ab37956f1fcccb769b24 d ON (57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.div_nbr = 57eef8c3d4a13d22f0b40f9742e7b281.7cad4bed0267ab37956f1fcccb769b24.div_nbr)\n     INNER JOIN 57eef8c3d4a13d22f0b40f9742e7b281.a2349118cac55136943abdf2d397e141 t ON(57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.b37e525777403fb0c0cfa2cab3876994 = 57eef8c3d4a13d22f0b40f9742e7b281.a2349118cac55136943abdf2d397e141.clndr_dt)\n     WHERE 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.b37e525777403fb0c0cfa2cab3876994 between pi_start_dt and pi_end_dt\n       AND 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.ff5eff8369918e81f835c2f6b23835df IS NULL\n       AND 57eef8c3d4a13d22f0b40f9742e7b281.7cad4bed0267ab37956f1fcccb769b24.fcd5fdac42a84c4fcc9e9a0c60fc5200 IS NULL\n       AND 57eef8c3d4a13d22f0b40f9742e7b281.7cad4bed0267ab37956f1fcccb769b24.f5693af07d3871d038bd2de03737d345 <> 'PSYS'\n       AND (57eef8c3d4a13d22f0b40f9742e7b281.7cad4bed0267ab37956f1fcccb769b24.94fb9fd699a09c530327d0966161b6f1 IS NULL OR 57eef8c3d4a13d22f0b40f9742e7b281.7cad4bed0267ab37956f1fcccb769b24.94fb9fd699a09c530327d0966161b6f1 >=  TO_DATE('20110101','yyyymmdd'))\n     GROUP BY 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.5a8103ceb3eda727eed8d3dbc244a027,\n              57eef8c3d4a13d22f0b40f9742e7b281.a2349118cac55136943abdf2d397e141.ac8fc124015ba701703b74146aa53041;\n    EXCEPTION\n      WHEN OTHERS THEN\n        po_err_msg := 'Data fetch from tables failed '||SUBSTR(SQLERRM,1,1950);\n        ROLLBACK;\n        RETURN -1;\n    END;\n\n    po_main_header := 'DIV_NBR'||CHR(9)||\n                      'FISC_YR_WK'||CHR(9)||\n                      'EACH_SHIP'||CHR(9)||\n                      'PRIME_MIN_MRK_AMT'||CHR(9)||\n                      'REP_COST_EXTND'||CHR(9)||\n                      'DVT_COST_EXTND'||CHR(9)||\n                      'DWA_COST_EXTND'||CHR(9)||\n                      'GRS_SLS_EXTND'||CHR(9)||\n                      'NET_WT_SHIP'||CHR(9)||\n                      'PRIME_MRK_AMT'||CHR(9)||\n                      'SRCHRG'||CHR(9)||\n                      'QTY_SHIP'||CHR(9)||\n                      'ORIG_MRGN_BSIS_AMT_EXTND'||CHR(9)||\n                      'UNFRM_QTY_SHIP'||CHR(9)||\n                      'UNIT_SHIP'||CHR(9)||\n                      'TTL_ALWNC'||CHR(9)||\n                      'TTL_DVT'||CHR(9)||\n                      'PROD_ALW'||CHR(9)||\n                      'PROD_CHRG'||CHR(9)||\n                      'NON_PROD_ALWNC'||CHR(9)||\n                      'NON_PROD_CHRG'||CHR(9)||\n                      'RBT_LOC_ACCRL_AMT'||CHR(9)||\n                      'RBT_NATL_ACCRL_AMT'||CHR(9)||\n                      'RBT_LOC_EXP_AMT'||CHR(9)||\n                      'RBT_NATL_EXP_AMT';\n\n    OPEN po_audit_data FOR SELECT DIV_NBR||CHR(9)||\n                                  FISC_YR_WK||CHR(9)||\n                                  EACH_SHIP||CHR(9)||\n                                  PRIME_MIN_MRK_AMT||CHR(9)||\n                                  REP_COST_EXTND||CHR(9)||\n                                  DVT_COST_EXTND||CHR(9)||\n                                  DWA_COST_EXTND||CHR(9)||\n                                  GRS_SLS_EXTND||CHR(9)||\n                                  NET_WT_SHIP||CHR(9)||\n                                  PRIME_MRK_AMT||CHR(9)||\n                                  SRCHRG||CHR(9)||\n                                  QTY_SHIP||CHR(9)||\n                                  ORIG_MRGN_BSIS_AMT_EXTND||CHR(9)||\n                                  UNFRM_QTY_SHIP||CHR(9)||\n                                  UNIT_SHIP||CHR(9)||\n                                  TTL_ALWNC||CHR(9)||\n                                  TTL_DVT||CHR(9)||\n                                  PROD_ALW||CHR(9)||\n                                  PROD_CHRG||CHR(9)||\n                                  NON_PROD_ALWNC||CHR(9)||\n                                  NON_PROD_CHRG||CHR(9)||\n                                  RBT_LOC_ACCRL_AMT||CHR(9)||\n                                  RBT_NATL_ACCRL_AMT||CHR(9)||\n                                  RBT_LOC_EXP_AMT||CHR(9)||\n                                  RBT_NATL_EXP_AMT\n                             FROM TABLE(CAST(v_xiw_obj AS ICM_REC_LST));\n\n    po_cnt := dad2d7a861ad9b6565c9599f0696bbbb.1e21de3bb543a206edf22b18c23a0c49();\n    po_err_msg := NULL;\n\n    RETURN 0;\n  EXCEPTION\n    WHEN OTHERS THEN\n      po_err_msg := 'Main Exception '||SUBSTR(SQLERRM,1,1950);\n      ROLLBACK;\n      RETURN -1;\n  END get_audit_yrl_by_rng;\n\n  FUNCTION get_audit_yrly  ( pi_odate                  DATE,\n                             po_start_dt         OUT   DATE,\n                             po_end_dt           OUT   DATE,\n                             po_cnt              OUT   INTEGER,\n                             po_main_header      OUT   VARCHAR2,\n                             po_audit_data       OUT   SYS_REFCURSOR,\n                             po_err_msg          OUT   VARCHAR2\n                           )\n  RETURN INTEGER\n  IS\n\n    v_start_dt          DATE;\n    v_end_dt            DATE;\n    v_ret               INTEGER;\n    l_fisc_wk_of_yr     NUMBER;\n    l_fisc_yr           NUMBER;\n    l_fisc_wk_of_yr_pr  NUMBER;\n    v_fisc_yr_wk_fltr   NUMBER;\n\n  BEGIN\n\n\n    BEGIN\n     SELECT fisc_wk_of_yr, fisc_yr\n       INTO l_fisc_wk_of_yr, l_fisc_yr\n       FROM 57eef8c3d4a13d22f0b40f9742e7b281.a2349118cac55136943abdf2d397e141 WHERE clndr_dt = pi_odate;\n    EXCEPTION\n      WHEN OTHERS THEN\n        po_err_msg := 'Failed with selecting from time_corp '||SUBSTR(SQLERRM,1,1950);\n        ROLLBACK;\n        RETURN -1;\n    END;\n\n    BEGIN\n     SELECT PARAM_VALUE_NBR\n        INTO v_fisc_yr_wk_fltr\n        from 57eef8c3d4a13d22f0b40f9742e7b281.1f9c921b05aafc28bf91547d5ec08a09\n        WHERE APP_NAME = 'ICM' AND PARAM_TYPE = 'YRL_AUDIT_ASC_TM_FLTR' AND PARAM_CODE = 'FISC_YR_WK1'\n;\n    EXCEPTION\n      WHEN OTHERS THEN\n        po_err_msg := 'Missing FISC_YR_WK Fileter in Param table  '||SUBSTR(SQLERRM,1,1950);\n        ROLLBACK;\n        RETURN -1;\n    END;\n\n    l_fisc_wk_of_yr_pr := l_fisc_wk_of_yr - 1;\n\n    IF l_fisc_wk_of_yr_pr = 0 THEN\n      BEGIN\n        SELECT MAX(clndr_dt)\n          INTO v_end_dt\n          FROM 57eef8c3d4a13d22f0b40f9742e7b281.a2349118cac55136943abdf2d397e141\n         WHERE fisc_yr = l_fisc_yr - 1;\n      EXCEPTION\n        WHEN OTHERS THEN\n          po_err_msg := 'Failed with selecting from time_corp '||SUBSTR(SQLERRM,1,1950);\n          ROLLBACK;\n          RETURN -1;\n      END;\n\n    ELSE\n\n      BEGIN\n        SELECT MAX(clndr_dt)\n          INTO v_end_dt\n          FROM 57eef8c3d4a13d22f0b40f9742e7b281.a2349118cac55136943abdf2d397e141\n         WHERE fisc_yr = l_fisc_yr\n           AND fisc_wk_of_yr = l_fisc_wk_of_yr_pr;\n      EXCEPTION\n          WHEN OTHERS THEN\n            po_err_msg := 'Failed with selecting from time_corp '||SUBSTR(SQLERRM,1,1950);\n            ROLLBACK;\n            RETURN -1;\n      END;\n\n    END IF;\n\n    v_start_dt := TO_DATE(TO_CHAR(EXTRACT(YEAR FROM pi_odate)-2,'0000')||TO_CHAR(EXTRACT(MONTH FROM pi_odate),'00')||TO_CHAR(EXTRACT(DAY FROM pi_odate),'00'),'YYYYMMDD');\n\n    v_ret := 8f247f7ad6ac0cdcef89446d436d1c8c665303dbbc240a5eaa44af13b9d8147d.850348a2468fcfeb1ae50f96174d0809ddccd1fc4b9bdd62e7d22f9332c8a121(\n                                                      pi_start_dt             =>      v_start_dt,\n                                                      pi_end_dt               =>      v_end_dt,\n                                                      pi_fisc_yr_wk_fltr      =>      v_fisc_yr_wk_fltr,\n                                                      po_cnt                  =>      po_cnt,\n                                                      po_main_header          =>      po_main_header,\n                                                      po_audit_data           =>      po_audit_data,\n                                                      po_err_msg              =>      po_err_msg\n                                                   );\n\n     IF v_ret <> 0 THEN\n\n        RETURN -1;\n\n     END IF;\n\n     po_start_dt := v_start_dt;\n     po_end_dt   := v_end_dt;\n\n     RETURN 0;\n\n  EXCEPTION\n    WHEN OTHERS THEN\n      po_err_msg := 'Main Exception '||SUBSTR(SQLERRM,1,1950);\n      ROLLBACK;\n      RETURN -1;\n  END get_audit_yrly;\nEND pkg_icm_audit_yrly;\n/",
            "upstream_dependencies": [],
            "downstream_dependencies": [],
            "dag_location": "null",
            "gantt_location": "null",
            "created_at": "null",
            "updated_at": "null"
        },
        {
            "name": "PKG_CPAT_MARGIN_PRICE_BASIS",
            "encrypted_name": "13cc009a6f63064b046af6d41a3c6429de092c5a4c267643cf4f0e56dfb61562",
            "type": "package",
            "database": "null",
            "encrypted_database": "null",
            "schema": "XDMADM",
            "encrypted_schema": "da238e96cf2cb791a097ca6946c096b4",
            "fully_qualified_name": "XDMADM.PKG_CPAT_MARGIN_PRICE_BASIS",
            "encrypted_fqn": "da238e96cf2cb791a097ca6946c096b4.13cc009a6f63064b046af6d41a3c6429de092c5a4c267643cf4f0e56dfb61562",
            "synonyms": [],
            "metadata_analysis": "CREATE OR REPLACE PACKAGE \"da238e96cf2cb791a097ca6946c096b4\".\"13cc009a6f63064b046af6d41a3c6429de092c5a4c267643cf4f0e56dfb61562\" AS\n\n  \n  FUNCTION          get_full_cs_margin1(prime_deviated_cost_type IN VARCHAR2,\n                                      prime_markup_indicator IN VARCHAR2,\n                                      price_uom IN VARCHAR2,\n                                      sales_uom IN VARCHAR2,\n                                      vendr_inv_cost IN NUMBER,\n                                      margin IN NUMBER,\n                                      NET_WT_SHIPPED In NUMBER,\n                                      UNFM_QTY_SHPD IN NUMBER\n                                                                                          )\n   RETURN NUMBER DETERMINISTIC PARALLEL_ENABLE;\n\n   FUNCTION          get_full_cs_sellprice(prime_deviated_cost_type IN VARCHAR2,\n                                        vendor_inv_cost IN NUMBER,\n                                        allowance IN NUMBER,\n                                        calc_full_cs_margin IN NUMBER,\n                                        inv_freight IN NUMBER,\n                                        DEV_COST IN NUMBER\n                                        )\n   RETURN NUMBER DETERMINISTIC PARALLEL_ENABLE;\n\n  FUNCTION          get_calculated_each_csmargin(prime_deviated_cost_type IN VARCHAR2,\n                                              prime_each_markup_type IN VARCHAR2,\n                                              each_shipped IN NUMBER,\n                                              price_uom IN VARCHAR2,\n                                              sales_uom IN VARCHAR2,\n                                              calculated_full_cs_sell_price IN NUMBER,\n                                              prime_contract_ea_markupamount IN NUMBER,\n                                              each_conv_factor IN NUMBER\n                                             )\n   RETURN NUMBER DETERMINISTIC PARALLEL_ENABLE;\n\nEND PKG_CPAT_MARGIN_PRICE_BASIS;\n/\nCREATE OR REPLACE PACKAGE BODY \"da238e96cf2cb791a097ca6946c096b4\".\"13cc009a6f63064b046af6d41a3c6429de092c5a4c267643cf4f0e56dfb61562\"\nAS\nFUNCTION get_full_cs_margin1(\n    prime_deviated_cost_type IN VARCHAR2,\n    prime_markup_indicator   IN VARCHAR2,\n    price_uom                IN VARCHAR2,\n    sales_uom                IN VARCHAR2,\n    vendr_inv_cost           IN NUMBER,\n    margin                   IN NUMBER,\n    NET_WT_SHIPPED           IN NUMBER,\n    UNFM_QTY_SHPD            IN NUMBER )\n  RETURN NUMBER DETERMINISTIC PARALLEL_ENABLE\nIS\n  \n  calculated_full_cs_margin1 NUMBER;\nBEGIN\n  calculated_full_cs_margin1 :=\n  CASE\n  WHEN prime_deviated_cost_type = 'FX' THEN\n    0\n  ELSE\n    CASE\n    WHEN prime_markup_indicator = 'P' THEN\n      CASE\n      WHEN sales_uom = 'EA' AND price_uom = 'EA' THEN\n        ((vendr_inv_cost / (1 - (margin / 100))) - vendr_inv_cost)\n      WHEN sales_uom = 'CS' AND price_uom = 'CS' THEN\n        ((vendr_inv_cost / (1 - (margin / 100))) - vendr_inv_cost)\n      WHEN price_uom = 'LB' THEN\n        ((vendr_inv_cost / (1 - (margin / 100))) - vendr_inv_cost)\n      WHEN sales_uom = 'EA' AND price_uom = 'CS' THEN\n        ((vendr_inv_cost / (1 - (margin / 100))) - vendr_inv_cost)\n      END\n    ELSE\n      CASE\n      WHEN price_uom = 'LB' THEN\n        margin\n      ELSE\n        CASE WHEN UNFM_QTY_SHPD = 0 THEN 0\n        ELSE\n        ((NET_WT_SHIPPED / UNFM_QTY_SHPD) * margin)\n        END\n      END\n    END\n  END ;\n  RETURN(NVL(calculated_full_cs_margin1,0));\nEND;\n\nFUNCTION get_full_cs_sellprice(\n    prime_deviated_cost_type IN VARCHAR2,\n    vendor_inv_cost          IN NUMBER,\n    allowance                IN NUMBER,\n    calc_full_cs_margin      IN NUMBER,\n    inv_freight              IN NUMBER,\n    DEV_COST                 IN NUMBER )\n  RETURN NUMBER DETERMINISTIC PARALLEL_ENABLE\nIS\n  \n  calc_full_cs_sell_price NUMBER;\nBEGIN\n  calc_full_cs_sell_price :=\n  CASE\n  WHEN prime_deviated_cost_type = 'AL' THEN\n    vendor_inv_cost + allowance + calc_full_cs_margin\n  WHEN prime_deviated_cost_type = 'D' THEN\n    calc_full_cs_margin + DEV_COST\n  WHEN prime_deviated_cost_type = 'F' THEN\n    DEV_COST + inv_freight + calc_full_cs_margin\n  WHEN prime_deviated_cost_type = 'FX' THEN\n    DEV_COST\n  WHEN prime_deviated_cost_type IS NULL THEN\n    vendor_inv_cost + calc_full_cs_margin\n  END;\n  RETURN(NVL(calc_full_cs_sell_price,0));\nEND;\n\nFUNCTION get_calculated_each_csmargin(\n    prime_deviated_cost_type       IN VARCHAR2,\n    prime_each_markup_type         IN VARCHAR2,\n    each_shipped                   IN NUMBER,\n    price_uom                      IN VARCHAR2,\n    sales_uom                      IN VARCHAR2,\n    calculated_full_cs_sell_price  IN NUMBER,\n    prime_contract_ea_markupamount IN NUMBER,\n    each_conv_factor               IN NUMBER )\n  RETURN NUMBER DETERMINISTIC PARALLEL_ENABLE\nIS\n  \n  calculated_each_csmargin NUMBER;\nBEGIN\n  calculated_each_csmargin :=\n  CASE\n  WHEN each_shipped <> 0 THEN\n    CASE\n    WHEN prime_deviated_cost_type <> 'FX' OR prime_deviated_cost_type IS NULL THEN\n      CASE\n      WHEN prime_each_markup_type = 'P' THEN\n        CASE\n        WHEN sales_uom = 'CS' AND price_uom = 'CS' THEN\n          CASE WHEN each_conv_factor = 0 THEN 0 ELSE\n            (calculated_full_cs_sell_price / each_conv_factor) * (prime_contract_ea_markupamount / 100)\n          END\n        WHEN sales_uom = 'EA' AND price_uom = 'EA' THEN\n          CASE WHEN each_conv_factor = 0 THEN 0 ELSE\n            (calculated_full_cs_sell_price / each_conv_factor) * (prime_contract_ea_markupamount / 100)\n          END\n        WHEN sales_uom = 'EA' AND price_uom = 'CS' THEN\n          CASE WHEN each_conv_factor = 0 THEN 0 ELSE\n            (calculated_full_cs_sell_price / each_conv_factor) * (prime_contract_ea_markupamount / 100)\n          END\n        WHEN price_uom = 'LB' THEN\n          (calculated_full_cs_sell_price) * (prime_contract_ea_markupamount / 100)\n        END\n      ELSE\n        prime_contract_ea_markupamount\n      END\n    END\n  ELSE\n    0\n  END;\n  RETURN(NVL(calculated_each_csmargin,0));\nEND;\n\nEND PKG_CPAT_MARGIN_PRICE_BASIS;\n/",
            "upstream_dependencies": [],
            "downstream_dependencies": [],
            "dag_location": "null",
            "gantt_location": "null",
            "created_at": "null",
            "updated_at": "null"
        },
        {
            "name": "PKG_816_867",
            "encrypted_name": "ef5fdf018209be7d8cb936d5087654b5",
            "type": "package",
            "database": "null",
            "encrypted_database": "null",
            "schema": "XDMADM",
            "encrypted_schema": "da238e96cf2cb791a097ca6946c096b4",
            "fully_qualified_name": "XDMADM.PKG_816_867",
            "encrypted_fqn": "da238e96cf2cb791a097ca6946c096b4.ef5fdf018209be7d8cb936d5087654b5",
            "synonyms": [],
            "metadata_analysis": "CREATE OR REPLACE PACKAGE \"da238e96cf2cb791a097ca6946c096b4\".\"ef5fdf018209be7d8cb936d5087654b5\" as\n\nFUNCTION fn_extract_816_pepsi\n(\n   p_partner_id   IN   VARCHAR2,\n   p_mfr_num      IN   NUMBER,\n   p_odate        IN   VARCHAR2\n )\n      RETURN NUMBER;\n\nFUNCTION fn_extract_816_ecolab\n(\n   p_partner_id   IN   VARCHAR2,\n   p_mfr_num      IN   NUMBER,\n   p_odate        IN   VARCHAR2\n )\n      RETURN NUMBER;\nFUNCTION fn_extract_867_pepsi\n(\n   p_partner_id   IN   VARCHAR2,\n   p_mfr_num      IN   NUMBER,\n   p_odate        IN   VARCHAR2\n )\n      RETURN NUMBER;\n\nFUNCTION fn_extract_867_ecolab\n(\n   p_partner_id   IN   VARCHAR2,\n   p_mfr_num      IN   NUMBER,\n   p_odate        IN   VARCHAR2\n )\n      RETURN NUMBER;\n\nEND pkg_816_867;\n/\nCREATE OR REPLACE PACKAGE BODY \"da238e96cf2cb791a097ca6946c096b4\".\"ef5fdf018209be7d8cb936d5087654b5\" AS\n\n\n\n\n    g_total_timer_begin         PLS_INTEGER;\n    g_timer_end                 PLS_INTEGER;\n    g_run_time                  PLS_INTEGER;\n    g_message                   VARCHAR2(256);\n    g_how_many                  INTEGER;\n    g_sqlcode                   NUMBER;\n    g_total_lines               INTEGER;\n    g_this_week                 INTEGER;\n    g_this_year                 INTEGER;\n    g_begin_week                DATE;\n    g_end_week                  DATE;\n    g_records_inserted          INTEGER;\n    g_cases                     NUMBER;\n\n   \nPROCEDURE sp_calc_run_time\n\n\n\n\n    (\n        run_time_i  PLS_INTEGER,\n        desc_i      VARCHAR2\n    )\n    IS\n        v_secs NUMBER;\n        v_mins NUMBER;\n        v_hrs  NUMBER;\nBEGIN\n        v_secs    := ROUND((run_time_i) / 100, 2);\n        v_hrs     := TRUNC(v_secs / 3600);\n        v_secs    := v_secs - (v_hrs * 3600);\n        v_mins    := TRUNC(v_secs / 60);\n        v_secs    := ROUND(v_secs - (v_mins * 60));\n        g_message := desc_i  || v_hrs || ' hours; ' || v_mins || ' minutes; ' || v_secs || ' seconds';\n        dbms_output.put_line(g_message);\n\nEND sp_calc_run_time;\n \nPROCEDURE sp_last_week_dates\n\n\n\n\n    (\n        odate_i      VARCHAR2\n    )\n    IS\n        v_secs NUMBER;\n        v_mins NUMBER;\n        v_hrs  NUMBER;\nBEGIN\n    SELECT  fisc_yr, fisc_wk_of_yr - 1 this_week\n    INTO  g_this_year , g_this_week\n    FROM 57eef8c3d4a13d22f0b40f9742e7b281.a2349118cac55136943abdf2d397e141\n    WHERE clndr_dt = odate_i;\n\n    IF g_this_week = 0 THEN\n        g_this_year := g_this_year - 1;\n        SELECT MAX(fisc_wk_of_yr)\n        INTO g_this_week\n        FROM 57eef8c3d4a13d22f0b40f9742e7b281.a2349118cac55136943abdf2d397e141\n        WHERE fisc_yr = g_this_year;\n    END IF;\n\n    SELECT  MIN(clndr_dt),MAX(clndr_dt)\n    INTO g_begin_week, g_end_week\n    FROM 57eef8c3d4a13d22f0b40f9742e7b281.a2349118cac55136943abdf2d397e141\n    WHERE fisc_yr = g_this_year\n    AND fisc_wk_of_yr = g_this_week;\n\n DBMS_OUTPUT.put_line ('DATE RANGE: ' ||  g_begin_week || ' / ' ||  g_end_week);\n\n    EXCEPTION\n        WHEN OTHERS THEN\n            g_sqlcode := SQLCODE;\n            g_message := 'sp_last_week_dates sqlerror ' || g_sqlcode || ' ' || SUBSTR(SQLERRM, 1, 75);\n            DBMS_OUTPUT.put_line(g_message);\n            RAISE;\nEND sp_last_week_dates;\n  \nFUNCTION fn_extract_816_pepsi    \n(\n   p_partner_id   IN   VARCHAR2,\n   p_mfr_num      IN   NUMBER,\n   p_odate        IN   VARCHAR2\n )\n  \n RETURN NUMBER\n   IS\n  BEGIN\n    DBMS_OUTPUT.put_line('BEGIN fn_extract_816_pepsi at ' || to_char(sysdate, 'yyyymmdd hh24:mi:ss'));\n    g_total_timer_begin := dbms_utility.get_time;\n    DBMS_APPLICATION_INFO.SET_MODULE( module_name => 'PEPSI816', action_name => 'DELETES');\n\n    DELETE FROM 57eef8c3d4a13d22f0b40f9742e7b281.f915b1cff5db1d904343875a03b0c140\n    WHERE data_who = 'PEPSI816' ;\n\n    sp_last_week_dates(p_odate);\n\n    DBMS_APPLICATION_INFO.SET_MODULE( module_name => 'PEPSI816', action_name => 'INSERTS');\n\n    INSERT  INTO 57eef8c3d4a13d22f0b40f9742e7b281.f915b1cff5db1d904343875a03b0c140\n            (data_who, data_key, data_data)\n        SELECT DISTINCT  'PEPSI816'  ,\n            UPPER(RTRIM (p_partner_id)) || p_mfr_num || 57eef8c3d4a13d22f0b40f9742e7b281.7cad4bed0267ab37956f1fcccb769b24.cd8c19b82a9bb45539c5ddd5262d5ee8 data_key,\n            'DT1' ||\n            RPAD (NVL (LTRIM (TRANSLATE (57eef8c3d4a13d22f0b40f9742e7b281.d73db8611de2680d7b0b5feaa04810c2.111341020e63cc60873e4d05e285d6de,  '*^|><@~`&','    ')),\n                'Name blank in db') ,25,' ') ||\n            LPAD (NVL (LTRIM (TRANSLATE (57eef8c3d4a13d22f0b40f9742e7b281.d73db8611de2680d7b0b5feaa04810c2.6e427bacb381704d6a3dbca94a0d4f03,  '*^|><@~`&','    ')),\n                ' ') ,15, 0) ||\n            RPAD (NVL (LTRIM (TRANSLATE (57eef8c3d4a13d22f0b40f9742e7b281.d73db8611de2680d7b0b5feaa04810c2.5365b933bbc11da76734c5fea5465226,  '*^|><@~`&','        ')),\n                'Address blank in db') ,25,' ') ||\n            RPAD (NVL (LTRIM (TRANSLATE (57eef8c3d4a13d22f0b40f9742e7b281.d73db8611de2680d7b0b5feaa04810c2.e1d646da9043723e193e05335bd5ca88,  '*^|><@~`&','     ')),\n                'CIty blank in db') ,18,' ') ||\n            RPAD (NVL (LTRIM (TRANSLATE (57eef8c3d4a13d22f0b40f9742e7b281.d73db8611de2680d7b0b5feaa04810c2.0221da4fb16f9602b1445ff5a28f449d,  '*^|><@~`&','      ')),\n                'XX') ,2,' ') ||\n            LPAD (NVL (LTRIM (TRANSLATE (57eef8c3d4a13d22f0b40f9742e7b281.d73db8611de2680d7b0b5feaa04810c2.5cb1ed84165efa1276ea973f17a56426,  '*^|><@~`&','         ')),\n                ' ') ,9, 0)\n        FROM 57eef8c3d4a13d22f0b40f9742e7b281.7cad4bed0267ab37956f1fcccb769b24 d, 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e s, 57eef8c3d4a13d22f0b40f9742e7b281.fadb8b76a21d0037200f1f2222239841 p,\n             57eef8c3d4a13d22f0b40f9742e7b281.d73db8611de2680d7b0b5feaa04810c2 c, 57eef8c3d4a13d22f0b40f9742e7b281.6071e9636f96f191337758a751a38d40 pim\n        WHERE 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.b37e525777403fb0c0cfa2cab3876994 BETWEEN g_begin_week AND g_end_week\n        AND 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.6e427bacb381704d6a3dbca94a0d4f03 = 57eef8c3d4a13d22f0b40f9742e7b281.d73db8611de2680d7b0b5feaa04810c2.6e427bacb381704d6a3dbca94a0d4f03\n        AND 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.5a8103ceb3eda727eed8d3dbc244a027 = 57eef8c3d4a13d22f0b40f9742e7b281.d73db8611de2680d7b0b5feaa04810c2.5a8103ceb3eda727eed8d3dbc244a027\n        AND 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.9d0604c46c7fc3d284e860c5703e30e5 = 57eef8c3d4a13d22f0b40f9742e7b281.fadb8b76a21d0037200f1f2222239841.9d0604c46c7fc3d284e860c5703e30e5\n        AND 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.5a8103ceb3eda727eed8d3dbc244a027 = 57eef8c3d4a13d22f0b40f9742e7b281.fadb8b76a21d0037200f1f2222239841.5a8103ceb3eda727eed8d3dbc244a027\n        AND 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.5a8103ceb3eda727eed8d3dbc244a027 = 57eef8c3d4a13d22f0b40f9742e7b281.7cad4bed0267ab37956f1fcccb769b24.5a8103ceb3eda727eed8d3dbc244a027\n        AND 57eef8c3d4a13d22f0b40f9742e7b281.fadb8b76a21d0037200f1f2222239841.a0cb4fc179140ff174fbd1682dc451a253bf80c2794394a9e4fc91b08ae828cc = 57eef8c3d4a13d22f0b40f9742e7b281.6071e9636f96f191337758a751a38d40.a0cb4fc179140ff174fbd1682dc451a253bf80c2794394a9e4fc91b08ae828cc\n        AND 57eef8c3d4a13d22f0b40f9742e7b281.6071e9636f96f191337758a751a38d40.1066994b3c9cb973df9654728af380e0 = p_mfr_num\n        AND 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.ff5eff8369918e81f835c2f6b23835df IS NULL\n      UNION ALL\n         SELECT DISTINCT 'PEPSI816' ,\n            UPPER(RTRIM (p_partner_id)) || p_mfr_num || 57eef8c3d4a13d22f0b40f9742e7b281.7cad4bed0267ab37956f1fcccb769b24.cd8c19b82a9bb45539c5ddd5262d5ee8 data_key,\n            'HDR' ||\n            RPAD(UPPER(p_partner_id), 15, ' ') ||\n            'GEN' ||\n            '816' ||\n            TO_CHAR (SYSDATE, 'YYYYMMDD') ||\n            RPAD(57eef8c3d4a13d22f0b40f9742e7b281.7cad4bed0267ab37956f1fcccb769b24.36894f5f47f531f17812c932d1e217a2, 25, ' ') ||\n            RPAD(57eef8c3d4a13d22f0b40f9742e7b281.7cad4bed0267ab37956f1fcccb769b24.cd8c19b82a9bb45539c5ddd5262d5ee8, 2, ' ')\n        FROM 57eef8c3d4a13d22f0b40f9742e7b281.7cad4bed0267ab37956f1fcccb769b24 d, 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e s, 57eef8c3d4a13d22f0b40f9742e7b281.fadb8b76a21d0037200f1f2222239841 p,\n               57eef8c3d4a13d22f0b40f9742e7b281.6071e9636f96f191337758a751a38d40 pim\n        WHERE 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.b37e525777403fb0c0cfa2cab3876994 BETWEEN g_begin_week AND g_end_week\n        AND 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.9d0604c46c7fc3d284e860c5703e30e5 = 57eef8c3d4a13d22f0b40f9742e7b281.fadb8b76a21d0037200f1f2222239841.9d0604c46c7fc3d284e860c5703e30e5\n        AND 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.5a8103ceb3eda727eed8d3dbc244a027 = 57eef8c3d4a13d22f0b40f9742e7b281.fadb8b76a21d0037200f1f2222239841.5a8103ceb3eda727eed8d3dbc244a027\n        AND 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.5a8103ceb3eda727eed8d3dbc244a027 = 57eef8c3d4a13d22f0b40f9742e7b281.7cad4bed0267ab37956f1fcccb769b24.5a8103ceb3eda727eed8d3dbc244a027\n        AND 57eef8c3d4a13d22f0b40f9742e7b281.fadb8b76a21d0037200f1f2222239841.a0cb4fc179140ff174fbd1682dc451a253bf80c2794394a9e4fc91b08ae828cc = 57eef8c3d4a13d22f0b40f9742e7b281.6071e9636f96f191337758a751a38d40.a0cb4fc179140ff174fbd1682dc451a253bf80c2794394a9e4fc91b08ae828cc\n        AND 57eef8c3d4a13d22f0b40f9742e7b281.6071e9636f96f191337758a751a38d40.1066994b3c9cb973df9654728af380e0 = p_mfr_num\n        AND 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.ff5eff8369918e81f835c2f6b23835df IS NULL;\n\n    COMMIT;\n\n    SELECT COUNT(1)\n    INTO g_how_many\n    FROM 57eef8c3d4a13d22f0b40f9742e7b281.f915b1cff5db1d904343875a03b0c140\n    WHERE data_who =  'PEPSI816';\n\n    DBMS_OUTPUT.put_line('***************  Number Records created: ' || g_how_many);\n\n    DBMS_OUTPUT.put_line('END fn_extract_816_pepsi at ' || to_char(sysdate, 'yyyymmdd hh24:mi:ss'));\n    g_timer_end := dbms_utility.get_time;\n    g_run_time  := g_timer_end - g_total_timer_begin; \n    sp_calc_run_time(g_run_time, 'TOTAL RUN TIME : ');\n    DBMS_APPLICATION_INFO.SET_MODULE(null,null);\n\n    RETURN 0;\n    EXCEPTION\n        WHEN OTHERS THEN\n           DBMS_APPLICATION_INFO.SET_MODULE(null,null);\n            g_sqlcode := SQLCODE;\n            g_message := 'fn_extract_816_pepsi sqlerror ' || g_sqlcode || ' ' || SUBSTR(SQLERRM, 1, 75);\n            DBMS_OUTPUT.put_line(g_message);\n            RETURN -2;\n    END fn_extract_816_pepsi;\n\n  \nFUNCTION fn_extract_816_ecolab\n(\n   p_partner_id   IN   VARCHAR2,\n   p_mfr_num      IN   NUMBER,\n   p_odate        IN   VARCHAR2\n )\n  \n RETURN NUMBER\n   IS\n  BEGIN\n    DBMS_OUTPUT.put_line('BEGIN fn_extract_816_ecolab at ' || to_char(sysdate, 'yyyymmdd hh24:mi:ss'));\n    g_total_timer_begin := dbms_utility.get_time;\n    DBMS_APPLICATION_INFO.SET_MODULE( module_name => 'ECOLAB816', action_name => 'DELETES');\n\n    DELETE FROM 57eef8c3d4a13d22f0b40f9742e7b281.f915b1cff5db1d904343875a03b0c140\n    WHERE data_who = 'ECOLAB816' || p_mfr_num;\n\n    sp_last_week_dates(p_odate);\n\n    DBMS_APPLICATION_INFO.SET_MODULE( module_name => 'ECOLAB816', action_name => 'INSERTS');\n\n    INSERT  INTO 57eef8c3d4a13d22f0b40f9742e7b281.f915b1cff5db1d904343875a03b0c140\n            (data_who, data_key, data_data)\n        SELECT DISTINCT  'ECOLAB816' || p_mfr_num ,\n            UPPER(RTRIM (p_partner_id)) || p_mfr_num || 57eef8c3d4a13d22f0b40f9742e7b281.7cad4bed0267ab37956f1fcccb769b24.cd8c19b82a9bb45539c5ddd5262d5ee8 data_key,\n            'DT1' ||\n            RPAD (NVL (LTRIM (TRANSLATE (57eef8c3d4a13d22f0b40f9742e7b281.d73db8611de2680d7b0b5feaa04810c2.111341020e63cc60873e4d05e285d6de,  '*^|><@~`&','    ')),\n                'Name blank in db') ,25,' ') ||\n            LPAD (NVL (LTRIM (TRANSLATE (57eef8c3d4a13d22f0b40f9742e7b281.d73db8611de2680d7b0b5feaa04810c2.6e427bacb381704d6a3dbca94a0d4f03,  '*^|><@~`&','    ')),\n                ' ') ,15, 0) ||\n            RPAD (NVL (LTRIM (TRANSLATE (57eef8c3d4a13d22f0b40f9742e7b281.d73db8611de2680d7b0b5feaa04810c2.5365b933bbc11da76734c5fea5465226,  '*^|><@~`&','        ')),\n                'Address blank in db') ,25,' ') ||\n            RPAD (NVL (LTRIM (TRANSLATE (57eef8c3d4a13d22f0b40f9742e7b281.d73db8611de2680d7b0b5feaa04810c2.e1d646da9043723e193e05335bd5ca88,  '*^|><@~`&','     ')),\n                'City blank in db') ,18,' ') ||\n            RPAD (NVL (LTRIM (TRANSLATE (57eef8c3d4a13d22f0b40f9742e7b281.d73db8611de2680d7b0b5feaa04810c2.0221da4fb16f9602b1445ff5a28f449d,  '*^|><@~`&','      ')),\n                'XX') ,2,' ') ||\n            LPAD (NVL (LTRIM (TRANSLATE (57eef8c3d4a13d22f0b40f9742e7b281.d73db8611de2680d7b0b5feaa04810c2.5cb1ed84165efa1276ea973f17a56426,  '*^|><@~`&','         ')),\n                ' ') ,9, 0)\n        FROM 57eef8c3d4a13d22f0b40f9742e7b281.7cad4bed0267ab37956f1fcccb769b24 d, 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e s, 57eef8c3d4a13d22f0b40f9742e7b281.fadb8b76a21d0037200f1f2222239841 p,\n             57eef8c3d4a13d22f0b40f9742e7b281.d73db8611de2680d7b0b5feaa04810c2 c, 57eef8c3d4a13d22f0b40f9742e7b281.6071e9636f96f191337758a751a38d40 pim\n        WHERE 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.b37e525777403fb0c0cfa2cab3876994 BETWEEN g_begin_week AND g_end_week\n        AND 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.6e427bacb381704d6a3dbca94a0d4f03 = 57eef8c3d4a13d22f0b40f9742e7b281.d73db8611de2680d7b0b5feaa04810c2.6e427bacb381704d6a3dbca94a0d4f03\n        AND 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.5a8103ceb3eda727eed8d3dbc244a027 = 57eef8c3d4a13d22f0b40f9742e7b281.d73db8611de2680d7b0b5feaa04810c2.5a8103ceb3eda727eed8d3dbc244a027\n        AND 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.9d0604c46c7fc3d284e860c5703e30e5 = 57eef8c3d4a13d22f0b40f9742e7b281.fadb8b76a21d0037200f1f2222239841.9d0604c46c7fc3d284e860c5703e30e5\n        AND 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.5a8103ceb3eda727eed8d3dbc244a027 = 57eef8c3d4a13d22f0b40f9742e7b281.fadb8b76a21d0037200f1f2222239841.5a8103ceb3eda727eed8d3dbc244a027\n        AND 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.5a8103ceb3eda727eed8d3dbc244a027 = 57eef8c3d4a13d22f0b40f9742e7b281.7cad4bed0267ab37956f1fcccb769b24.5a8103ceb3eda727eed8d3dbc244a027\n        AND 57eef8c3d4a13d22f0b40f9742e7b281.fadb8b76a21d0037200f1f2222239841.a0cb4fc179140ff174fbd1682dc451a253bf80c2794394a9e4fc91b08ae828cc = 57eef8c3d4a13d22f0b40f9742e7b281.6071e9636f96f191337758a751a38d40.a0cb4fc179140ff174fbd1682dc451a253bf80c2794394a9e4fc91b08ae828cc\n        AND 57eef8c3d4a13d22f0b40f9742e7b281.6071e9636f96f191337758a751a38d40.1066994b3c9cb973df9654728af380e0 = p_mfr_num\n        AND 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.ff5eff8369918e81f835c2f6b23835df IS NULL\n      UNION ALL\n         SELECT DISTINCT 'ECOLAB816' || p_mfr_num,\n            UPPER(RTRIM (p_partner_id)) || p_mfr_num || 57eef8c3d4a13d22f0b40f9742e7b281.7cad4bed0267ab37956f1fcccb769b24.cd8c19b82a9bb45539c5ddd5262d5ee8 data_key,\n            'HDR' ||\n            RPAD(UPPER(p_partner_id), 15, ' ') ||\n            'GEN' ||\n            '816' ||\n            TO_CHAR (SYSDATE, 'YYYYMMDD') ||\n            RPAD(57eef8c3d4a13d22f0b40f9742e7b281.7cad4bed0267ab37956f1fcccb769b24.36894f5f47f531f17812c932d1e217a2, 25, ' ') ||\n            RPAD(57eef8c3d4a13d22f0b40f9742e7b281.7cad4bed0267ab37956f1fcccb769b24.cd8c19b82a9bb45539c5ddd5262d5ee8, 2, ' ')\n        FROM 57eef8c3d4a13d22f0b40f9742e7b281.7cad4bed0267ab37956f1fcccb769b24 d, 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e s, 57eef8c3d4a13d22f0b40f9742e7b281.fadb8b76a21d0037200f1f2222239841 p,\n               57eef8c3d4a13d22f0b40f9742e7b281.6071e9636f96f191337758a751a38d40 pim\n        WHERE 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.b37e525777403fb0c0cfa2cab3876994 BETWEEN g_begin_week AND g_end_week\n        AND 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.9d0604c46c7fc3d284e860c5703e30e5 = 57eef8c3d4a13d22f0b40f9742e7b281.fadb8b76a21d0037200f1f2222239841.9d0604c46c7fc3d284e860c5703e30e5\n        AND 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.5a8103ceb3eda727eed8d3dbc244a027 = 57eef8c3d4a13d22f0b40f9742e7b281.fadb8b76a21d0037200f1f2222239841.5a8103ceb3eda727eed8d3dbc244a027\n        AND 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.5a8103ceb3eda727eed8d3dbc244a027 = 57eef8c3d4a13d22f0b40f9742e7b281.7cad4bed0267ab37956f1fcccb769b24.5a8103ceb3eda727eed8d3dbc244a027\n        AND 57eef8c3d4a13d22f0b40f9742e7b281.fadb8b76a21d0037200f1f2222239841.a0cb4fc179140ff174fbd1682dc451a253bf80c2794394a9e4fc91b08ae828cc = 57eef8c3d4a13d22f0b40f9742e7b281.6071e9636f96f191337758a751a38d40.a0cb4fc179140ff174fbd1682dc451a253bf80c2794394a9e4fc91b08ae828cc\n        AND 57eef8c3d4a13d22f0b40f9742e7b281.6071e9636f96f191337758a751a38d40.1066994b3c9cb973df9654728af380e0 = p_mfr_num\n        AND 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.ff5eff8369918e81f835c2f6b23835df IS NULL;\n\n    COMMIT;\n\n    SELECT COUNT(1)\n    INTO g_how_many\n    FROM 57eef8c3d4a13d22f0b40f9742e7b281.f915b1cff5db1d904343875a03b0c140\n    WHERE data_who =  'ECOLAB816' || p_mfr_num;\n\n    DBMS_OUTPUT.put_line('***************  Number Records created: ' || g_how_many);\n\n    DBMS_OUTPUT.put_line('END fn_extract_816_ecolab at ' || to_char(sysdate, 'yyyymmdd hh24:mi:ss'));\n    g_timer_end := dbms_utility.get_time;\n    g_run_time  := g_timer_end - g_total_timer_begin; \n    sp_calc_run_time(g_run_time, 'TOTAL RUN TIME : ');\n    DBMS_APPLICATION_INFO.SET_MODULE(null,null);\n\n    RETURN 0;\n    EXCEPTION\n        WHEN OTHERS THEN\n           DBMS_APPLICATION_INFO.SET_MODULE(null,null);\n            g_sqlcode := SQLCODE;\n            g_message := 'fn_extract_816_ecolab sqlerror ' || g_sqlcode || ' ' || SUBSTR(SQLERRM, 1, 75);\n            DBMS_OUTPUT.put_line(g_message);\n            RETURN -2;\n    END fn_extract_816_ecolab;\n\n\n  \nFUNCTION fn_extract_867_pepsi\n(\n   p_partner_id   IN   VARCHAR2,\n   p_mfr_num      IN   NUMBER,\n   p_odate        IN   VARCHAR2\n )\n  \n RETURN NUMBER\n   IS\n  BEGIN\n    DBMS_OUTPUT.put_line('BEGIN fn_extract_867_pepsi at ' || to_char(sysdate, 'yyyymmdd hh24:mi:ss'));\n    g_total_timer_begin := dbms_utility.get_time;\n    DBMS_APPLICATION_INFO.SET_MODULE( module_name => 'PEPSI867', action_name => 'DELETES');\n\n    DELETE FROM 57eef8c3d4a13d22f0b40f9742e7b281.f915b1cff5db1d904343875a03b0c140\n    WHERE data_who = 'PEPSI867';\n\n    sp_last_week_dates(p_odate);\n\n    DBMS_APPLICATION_INFO.SET_MODULE( module_name => 'PEPSI867', action_name => 'INSERTS');\n\n    INSERT  INTO 57eef8c3d4a13d22f0b40f9742e7b281.f915b1cff5db1d904343875a03b0c140\n            (data_who, data_key, data_data)\n        SELECT   'PEPSI867' ,\n            UPPER(RTRIM (p_partner_id)) || p_mfr_num || 57eef8c3d4a13d22f0b40f9742e7b281.7cad4bed0267ab37956f1fcccb769b24.cd8c19b82a9bb45539c5ddd5262d5ee8 || '2' data_key,\n            'DT1' ||\n            RPAD(' ', 25, ' ') ||\n            RPAD (NVL (LTRIM (TRANSLATE (57eef8c3d4a13d22f0b40f9742e7b281.d73db8611de2680d7b0b5feaa04810c2.111341020e63cc60873e4d05e285d6de,  '*^|><@~`&','    ')),\n                'Name blank in db') ,25, ' ') ||\n            LPAD (NVL (LTRIM (TRANSLATE(SUBSTR(LPAD(57eef8c3d4a13d22f0b40f9742e7b281.d73db8611de2680d7b0b5feaa04810c2.6e427bacb381704d6a3dbca94a0d4f03, 8, 0),1, 8),  '*^|><@~`&','    ')),\n                ' ') ,8, 0) ||\n            CASE WHEN 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.8e296af0709009f4cb601a563ab2e022 = 'CD' AND 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.65830b50d8b762bd9c6e5b0c2f5a7ede < 0 THEN\n                    '76'\n                 ELSE\n                    '32'\n            END ||\n            TO_CHAR (ABS(NVL(57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.9f2ec167f84f17ee6dfe57b8ec714693, 0)), '41780b10af855587716b5d6b7c7e2817.9be3c526dbb75dd03ad1acf00703c4f6') ||\n            RPAD(NVL(SUBSTR (57eef8c3d4a13d22f0b40f9742e7b281.6071e9636f96f191337758a751a38d40.20c87a39b180f014bfeaf7a7f7cfd6df, 1, 14), '00000000000000'), 14, ' ') ||\n            TO_CHAR (NVL (57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.84769f239ac5cb8ebf2ca556f7e701c9, 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.b37e525777403fb0c0cfa2cab3876994), 'YYYYMMDD') ||\n            TRANSLATE (RPAD (57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.fb56add4ada29326fed0b165911ff6fd, 15, ' ' ), '*^|><@~`&', '    ') ||\n            RPAD (NVL (LTRIM (TRANSLATE(SUBSTR( 57eef8c3d4a13d22f0b40f9742e7b281.fadb8b76a21d0037200f1f2222239841.8b0d3a6388c202399af51a907f23a188 ,1, 30),  '*^|><@~`&','         ')), 'Blank ProdDesc'), 30, ' ') ||\n            RPAD (LTRIM (TRANSLATE(57eef8c3d4a13d22f0b40f9742e7b281.fadb8b76a21d0037200f1f2222239841.a3e3513906f7e7b71f0323a8b72fe72b,  '*^|><@~`&','         ')), 15, ' ') ||\n            RPAD (LTRIM (TRANSLATE(57eef8c3d4a13d22f0b40f9742e7b281.fadb8b76a21d0037200f1f2222239841.e87981ec68e77de99eea207aa6ba077a,  '*^|><@~`&','         ')), 12, ' ') ||\n            TO_CHAR (57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.8960aac52cadf7195a0577aa30cfccfb, '39710d6a09cb78c77c5f2a22c1d74ebb.9be3c526dbb75dd03ad1acf00703c4f6') ||\n            RPAD(57eef8c3d4a13d22f0b40f9742e7b281.fadb8b76a21d0037200f1f2222239841.a0cb4fc179140ff174fbd1682dc451a253bf80c2794394a9e4fc91b08ae828cc, 10, ' ')\n        FROM 57eef8c3d4a13d22f0b40f9742e7b281.7cad4bed0267ab37956f1fcccb769b24 d, 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e s, 57eef8c3d4a13d22f0b40f9742e7b281.fadb8b76a21d0037200f1f2222239841 p,\n             57eef8c3d4a13d22f0b40f9742e7b281.d73db8611de2680d7b0b5feaa04810c2 c, 57eef8c3d4a13d22f0b40f9742e7b281.6071e9636f96f191337758a751a38d40 pim\n        WHERE 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.b37e525777403fb0c0cfa2cab3876994 BETWEEN g_begin_week AND g_end_week\n        AND 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.6e427bacb381704d6a3dbca94a0d4f03 = 57eef8c3d4a13d22f0b40f9742e7b281.d73db8611de2680d7b0b5feaa04810c2.6e427bacb381704d6a3dbca94a0d4f03\n        AND 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.5a8103ceb3eda727eed8d3dbc244a027 = 57eef8c3d4a13d22f0b40f9742e7b281.d73db8611de2680d7b0b5feaa04810c2.5a8103ceb3eda727eed8d3dbc244a027\n        AND 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.9d0604c46c7fc3d284e860c5703e30e5 = 57eef8c3d4a13d22f0b40f9742e7b281.fadb8b76a21d0037200f1f2222239841.9d0604c46c7fc3d284e860c5703e30e5\n        AND 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.5a8103ceb3eda727eed8d3dbc244a027 = 57eef8c3d4a13d22f0b40f9742e7b281.fadb8b76a21d0037200f1f2222239841.5a8103ceb3eda727eed8d3dbc244a027\n        AND 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.5a8103ceb3eda727eed8d3dbc244a027 = 57eef8c3d4a13d22f0b40f9742e7b281.7cad4bed0267ab37956f1fcccb769b24.5a8103ceb3eda727eed8d3dbc244a027\n        AND 57eef8c3d4a13d22f0b40f9742e7b281.fadb8b76a21d0037200f1f2222239841.a0cb4fc179140ff174fbd1682dc451a253bf80c2794394a9e4fc91b08ae828cc = 57eef8c3d4a13d22f0b40f9742e7b281.6071e9636f96f191337758a751a38d40.a0cb4fc179140ff174fbd1682dc451a253bf80c2794394a9e4fc91b08ae828cc\n        AND 57eef8c3d4a13d22f0b40f9742e7b281.6071e9636f96f191337758a751a38d40.1066994b3c9cb973df9654728af380e0 = p_mfr_num\n        AND 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.ff5eff8369918e81f835c2f6b23835df IS NULL\n      UNION ALL\n         SELECT  DISTINCT 'PEPSI867' ,\n            UPPER(RTRIM (p_partner_id)) || p_mfr_num || 57eef8c3d4a13d22f0b40f9742e7b281.7cad4bed0267ab37956f1fcccb769b24.cd8c19b82a9bb45539c5ddd5262d5ee8 || '1' data_key,\n            'HDR' ||\n            RPAD(UPPER(p_partner_id), 15, ' ') ||\n            'GEN' ||\n            '867' ||\n            TO_CHAR (SYSDATE, 'YYYYMMDD') ||\n            TO_CHAR (g_begin_week, 'YYYYMMDD') ||\n            TO_CHAR (g_end_week, 'YYYYMMDD') ||\n            RPAD (NVL (LTRIM (TRANSLATE(SUBSTR(57eef8c3d4a13d22f0b40f9742e7b281.6071e9636f96f191337758a751a38d40.ad218d7095b01c8295d3a0af913aad35 ,1, 25),  '*^|><@~`&','         ')), 'mfrName blank IN db'), 25, ' ') ||\n            RPAD (57eef8c3d4a13d22f0b40f9742e7b281.7cad4bed0267ab37956f1fcccb769b24.cd8c19b82a9bb45539c5ddd5262d5ee8, 4, ' ') ||\n            RPAD (NVL (LTRIM (TRANSLATE(SUBSTR(57eef8c3d4a13d22f0b40f9742e7b281.7cad4bed0267ab37956f1fcccb769b24.36894f5f47f531f17812c932d1e217a2 ,1, 25),  '*^|><@~`&','         ')), ' '), 25, ' ')\n        FROM 57eef8c3d4a13d22f0b40f9742e7b281.7cad4bed0267ab37956f1fcccb769b24 d, 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e s, 57eef8c3d4a13d22f0b40f9742e7b281.fadb8b76a21d0037200f1f2222239841 p,\n               57eef8c3d4a13d22f0b40f9742e7b281.6071e9636f96f191337758a751a38d40 pim\n        WHERE 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.b37e525777403fb0c0cfa2cab3876994 BETWEEN g_begin_week AND g_end_week\n        AND 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.9d0604c46c7fc3d284e860c5703e30e5 = 57eef8c3d4a13d22f0b40f9742e7b281.fadb8b76a21d0037200f1f2222239841.9d0604c46c7fc3d284e860c5703e30e5\n        AND 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.5a8103ceb3eda727eed8d3dbc244a027 = 57eef8c3d4a13d22f0b40f9742e7b281.fadb8b76a21d0037200f1f2222239841.5a8103ceb3eda727eed8d3dbc244a027\n        AND 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.5a8103ceb3eda727eed8d3dbc244a027 = 57eef8c3d4a13d22f0b40f9742e7b281.7cad4bed0267ab37956f1fcccb769b24.5a8103ceb3eda727eed8d3dbc244a027\n        AND 57eef8c3d4a13d22f0b40f9742e7b281.fadb8b76a21d0037200f1f2222239841.a0cb4fc179140ff174fbd1682dc451a253bf80c2794394a9e4fc91b08ae828cc = 57eef8c3d4a13d22f0b40f9742e7b281.6071e9636f96f191337758a751a38d40.a0cb4fc179140ff174fbd1682dc451a253bf80c2794394a9e4fc91b08ae828cc\n        AND 57eef8c3d4a13d22f0b40f9742e7b281.6071e9636f96f191337758a751a38d40.1066994b3c9cb973df9654728af380e0 = p_mfr_num\n        AND 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.ff5eff8369918e81f835c2f6b23835df IS NULL\n      UNION ALL\n         SELECT  'PEPSI867' ,\n            UPPER(RTRIM (p_partner_id)) || p_mfr_num || brnch_cd || '3' data_key,\n            'SUM' ||\n               TO_CHAR (SUM(ctr), 'S09999') ||\n                TO_CHAR (SUM(total_volume), '8f09f1547a4eb8c7a6d6f248ecc6f483.9be3c526dbb75dd03ad1acf00703c4f6') ||\n                 'UN'\n          FROM (\n              SELECT DISTINCT 57eef8c3d4a13d22f0b40f9742e7b281.7cad4bed0267ab37956f1fcccb769b24.cd8c19b82a9bb45539c5ddd5262d5ee8,  count(1) as ctr,\n                    SUM(ABS(NVL(57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.9f2ec167f84f17ee6dfe57b8ec714693, 0))) total_volume\n                FROM 57eef8c3d4a13d22f0b40f9742e7b281.7cad4bed0267ab37956f1fcccb769b24 d, 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e s, 57eef8c3d4a13d22f0b40f9742e7b281.fadb8b76a21d0037200f1f2222239841 p,\n                     57eef8c3d4a13d22f0b40f9742e7b281.d73db8611de2680d7b0b5feaa04810c2 c, 57eef8c3d4a13d22f0b40f9742e7b281.6071e9636f96f191337758a751a38d40 pim\n                WHERE 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.b37e525777403fb0c0cfa2cab3876994 BETWEEN g_begin_week AND g_end_week\n                AND 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.6e427bacb381704d6a3dbca94a0d4f03 = 57eef8c3d4a13d22f0b40f9742e7b281.d73db8611de2680d7b0b5feaa04810c2.6e427bacb381704d6a3dbca94a0d4f03\n                AND 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.5a8103ceb3eda727eed8d3dbc244a027 = 57eef8c3d4a13d22f0b40f9742e7b281.d73db8611de2680d7b0b5feaa04810c2.5a8103ceb3eda727eed8d3dbc244a027\n                AND 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.9d0604c46c7fc3d284e860c5703e30e5 = 57eef8c3d4a13d22f0b40f9742e7b281.fadb8b76a21d0037200f1f2222239841.9d0604c46c7fc3d284e860c5703e30e5\n                AND 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.5a8103ceb3eda727eed8d3dbc244a027 = 57eef8c3d4a13d22f0b40f9742e7b281.fadb8b76a21d0037200f1f2222239841.5a8103ceb3eda727eed8d3dbc244a027\n                AND 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.5a8103ceb3eda727eed8d3dbc244a027 = 57eef8c3d4a13d22f0b40f9742e7b281.7cad4bed0267ab37956f1fcccb769b24.5a8103ceb3eda727eed8d3dbc244a027\n                AND 57eef8c3d4a13d22f0b40f9742e7b281.fadb8b76a21d0037200f1f2222239841.a0cb4fc179140ff174fbd1682dc451a253bf80c2794394a9e4fc91b08ae828cc = 57eef8c3d4a13d22f0b40f9742e7b281.6071e9636f96f191337758a751a38d40.a0cb4fc179140ff174fbd1682dc451a253bf80c2794394a9e4fc91b08ae828cc\n                AND 57eef8c3d4a13d22f0b40f9742e7b281.6071e9636f96f191337758a751a38d40.1066994b3c9cb973df9654728af380e0 = p_mfr_num\n                AND 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.ff5eff8369918e81f835c2f6b23835df IS NULL\n                GROUP BY 57eef8c3d4a13d22f0b40f9742e7b281.7cad4bed0267ab37956f1fcccb769b24.cd8c19b82a9bb45539c5ddd5262d5ee8\n           )\n            GROUP BY brnch_cd ;\n    COMMIT;\n\n    DBMS_OUTPUT.put_line('END fn_extract_867_pepsi at ' || to_char(sysdate, 'yyyymmdd hh24:mi:ss'));\n    g_timer_end := dbms_utility.get_time;\n    g_run_time  := g_timer_end - g_total_timer_begin; \n    sp_calc_run_time(g_run_time, 'TOTAL RUN TIME : ');\n    DBMS_APPLICATION_INFO.SET_MODULE(null,null);\n\n    RETURN 0;\n    EXCEPTION\n        WHEN OTHERS THEN\n           DBMS_APPLICATION_INFO.SET_MODULE(null,null);\n            g_sqlcode := SQLCODE;\n            g_message := 'fn_extract_867_pepsi sqlerror ' || g_sqlcode || ' ' || SUBSTR(SQLERRM, 1, 75);\n            DBMS_OUTPUT.put_line(g_message);\n            RETURN -2;\n    END fn_extract_867_pepsi;\n\n \nFUNCTION fn_extract_867_ecolab     \n(\n   p_partner_id   IN   VARCHAR2,\n   p_mfr_num      IN   NUMBER,\n   p_odate        IN   VARCHAR2\n )\n  \n RETURN NUMBER\n   IS\n  BEGIN\n    DBMS_OUTPUT.put_line('BEGIN fn_extract_867_ecolab at ' || to_char(sysdate, 'yyyymmdd hh24:mi:ss'));\n    g_total_timer_begin := dbms_utility.get_time;\n    DBMS_APPLICATION_INFO.SET_MODULE( module_name => 'ECOLAB867', action_name => 'DELETES');\n\n    DELETE FROM 57eef8c3d4a13d22f0b40f9742e7b281.f915b1cff5db1d904343875a03b0c140\n    WHERE data_who = 'ECOLAB867' || p_mfr_num ;\n\n    sp_last_week_dates(p_odate);\n\n    DBMS_APPLICATION_INFO.SET_MODULE( module_name => 'ECOLAB867', action_name => 'INSERTS');\n\n    INSERT  INTO 57eef8c3d4a13d22f0b40f9742e7b281.f915b1cff5db1d904343875a03b0c140\n            (data_who, data_key, data_data)\n        SELECT 'ECOLAB867' || p_mfr_num data_who,\n            UPPER(RTRIM (p_partner_id)) || p_mfr_num || 0ca5fb119e004e3dd9cc2be01757c595.cd8c19b82a9bb45539c5ddd5262d5ee8 || '2' data_key,\n            'DT1' ||\n            RPAD(' ', 25, ' ') ||\n            RPAD (NVL (LTRIM (TRANSLATE (fe683adb636834b2b59804069ad2bdfb.111341020e63cc60873e4d05e285d6de,  '*^|><@~`&','    ')),\n                'Name blank in db') ,25, ' ') ||\n            LPAD (NVL (LTRIM (TRANSLATE(SUBSTR(LPAD(fe683adb636834b2b59804069ad2bdfb.6e427bacb381704d6a3dbca94a0d4f03, 8, 0),1, 8),  '*^|><@~`&','    ')),\n                ' ') ,8, 0) ||\n            CASE WHEN c1e1ab753a3b305911e8a15073f6c8e7.8e296af0709009f4cb601a563ab2e022 = 'CD' AND c1e1ab753a3b305911e8a15073f6c8e7.65830b50d8b762bd9c6e5b0c2f5a7ede < 0 THEN\n                    '76'\n                 ELSE\n                    '32'\n            END ||\n            TO_CHAR (ABS(NVL(c1e1ab753a3b305911e8a15073f6c8e7.9f2ec167f84f17ee6dfe57b8ec714693, 0)), '41780b10af855587716b5d6b7c7e2817.9be3c526dbb75dd03ad1acf00703c4f6') ||\n            RPAD(NVL(SUBSTR (8d49ecffd1b9607efa036327a572695b.20c87a39b180f014bfeaf7a7f7cfd6df, 1, 14), '00000000000000'), 14, ' ') ||\n            TO_CHAR (NVL (c1e1ab753a3b305911e8a15073f6c8e7.84769f239ac5cb8ebf2ca556f7e701c9, c1e1ab753a3b305911e8a15073f6c8e7.b37e525777403fb0c0cfa2cab3876994), 'YYYYMMDD') ||\n            TRANSLATE (RPAD (c1e1ab753a3b305911e8a15073f6c8e7.fb56add4ada29326fed0b165911ff6fd, 15, ' ' ), '*^|><@~`&', '    ') ||\n            RPAD (NVL (LTRIM (TRANSLATE(SUBSTR( 0353b2a83648372cb2d3370b12c1d504.8b0d3a6388c202399af51a907f23a188 ,1, 30),  '*^|><@~`&','         ')), 'Blank ProdDesc'), 30, ' ') ||\n            RPAD (LTRIM (TRANSLATE(0353b2a83648372cb2d3370b12c1d504.a3e3513906f7e7b71f0323a8b72fe72b,  '*^|><@~`&','         ')), 15, ' ') ||\n            RPAD (LTRIM (TRANSLATE(0353b2a83648372cb2d3370b12c1d504.e87981ec68e77de99eea207aa6ba077a,  '*^|><@~`&','         ')), 12, ' ') ||\n            TO_CHAR (c1e1ab753a3b305911e8a15073f6c8e7.8960aac52cadf7195a0577aa30cfccfb, '39710d6a09cb78c77c5f2a22c1d74ebb.9be3c526dbb75dd03ad1acf00703c4f6') ||\n            RPAD(0353b2a83648372cb2d3370b12c1d504.a0cb4fc179140ff174fbd1682dc451a253bf80c2794394a9e4fc91b08ae828cc, 10, ' ')\n        FROM 57eef8c3d4a13d22f0b40f9742e7b281.7cad4bed0267ab37956f1fcccb769b24 d, 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e s, 57eef8c3d4a13d22f0b40f9742e7b281.fadb8b76a21d0037200f1f2222239841 p,\n             57eef8c3d4a13d22f0b40f9742e7b281.d73db8611de2680d7b0b5feaa04810c2 c, 57eef8c3d4a13d22f0b40f9742e7b281.6071e9636f96f191337758a751a38d40 pim\n        WHERE c1e1ab753a3b305911e8a15073f6c8e7.b37e525777403fb0c0cfa2cab3876994 BETWEEN g_begin_week AND g_end_week\n        AND c1e1ab753a3b305911e8a15073f6c8e7.6e427bacb381704d6a3dbca94a0d4f03 = fe683adb636834b2b59804069ad2bdfb.6e427bacb381704d6a3dbca94a0d4f03\n        AND c1e1ab753a3b305911e8a15073f6c8e7.5a8103ceb3eda727eed8d3dbc244a027 = fe683adb636834b2b59804069ad2bdfb.5a8103ceb3eda727eed8d3dbc244a027\n        AND c1e1ab753a3b305911e8a15073f6c8e7.9d0604c46c7fc3d284e860c5703e30e5 = 0353b2a83648372cb2d3370b12c1d504.9d0604c46c7fc3d284e860c5703e30e5\n        AND c1e1ab753a3b305911e8a15073f6c8e7.5a8103ceb3eda727eed8d3dbc244a027 = 0353b2a83648372cb2d3370b12c1d504.5a8103ceb3eda727eed8d3dbc244a027\n        AND c1e1ab753a3b305911e8a15073f6c8e7.5a8103ceb3eda727eed8d3dbc244a027 = 0ca5fb119e004e3dd9cc2be01757c595.5a8103ceb3eda727eed8d3dbc244a027\n        AND 0353b2a83648372cb2d3370b12c1d504.a0cb4fc179140ff174fbd1682dc451a253bf80c2794394a9e4fc91b08ae828cc = 8d49ecffd1b9607efa036327a572695b.a0cb4fc179140ff174fbd1682dc451a253bf80c2794394a9e4fc91b08ae828cc\n        AND 8d49ecffd1b9607efa036327a572695b.1066994b3c9cb973df9654728af380e0 = p_mfr_num\n        AND c1e1ab753a3b305911e8a15073f6c8e7.ff5eff8369918e81f835c2f6b23835df IS NULL\n      UNION ALL\n         SELECT DISTINCT  'ECOLAB867' || p_mfr_num data_who,\n            UPPER(RTRIM (p_partner_id)) || p_mfr_num || 0ca5fb119e004e3dd9cc2be01757c595.cd8c19b82a9bb45539c5ddd5262d5ee8 || '1' data_key,\n            'HDR' ||\n            RPAD(UPPER(p_partner_id), 15, ' ') ||\n            'GEN' ||\n            '867' ||\n            TO_CHAR (SYSDATE, 'YYYYMMDD') ||\n            TO_CHAR (g_begin_week, 'YYYYMMDD') ||\n            TO_CHAR (g_end_week, 'YYYYMMDD') ||\n            RPAD (NVL (LTRIM (TRANSLATE(SUBSTR(8d49ecffd1b9607efa036327a572695b.ad218d7095b01c8295d3a0af913aad35 ,1, 25),  '*^|><@~`&','         ')), 'mfrName blank IN db'), 25, ' ') ||\n            RPAD (0ca5fb119e004e3dd9cc2be01757c595.5a8103ceb3eda727eed8d3dbc244a027, 4, ' ') ||\n            RPAD (NVL (LTRIM (TRANSLATE(SUBSTR(0ca5fb119e004e3dd9cc2be01757c595.36894f5f47f531f17812c932d1e217a2 ,1, 25),  '*^|><@~`&','         ')), ' '), 25, ' ')\n        FROM 57eef8c3d4a13d22f0b40f9742e7b281.7cad4bed0267ab37956f1fcccb769b24 d, 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e s, 57eef8c3d4a13d22f0b40f9742e7b281.fadb8b76a21d0037200f1f2222239841 p,\n               57eef8c3d4a13d22f0b40f9742e7b281.6071e9636f96f191337758a751a38d40 pim\n        WHERE c1e1ab753a3b305911e8a15073f6c8e7.b37e525777403fb0c0cfa2cab3876994 BETWEEN g_begin_week AND g_end_week\n        AND c1e1ab753a3b305911e8a15073f6c8e7.9d0604c46c7fc3d284e860c5703e30e5 = 0353b2a83648372cb2d3370b12c1d504.9d0604c46c7fc3d284e860c5703e30e5\n        AND c1e1ab753a3b305911e8a15073f6c8e7.5a8103ceb3eda727eed8d3dbc244a027 = 0353b2a83648372cb2d3370b12c1d504.5a8103ceb3eda727eed8d3dbc244a027\n        AND c1e1ab753a3b305911e8a15073f6c8e7.5a8103ceb3eda727eed8d3dbc244a027 = 0ca5fb119e004e3dd9cc2be01757c595.5a8103ceb3eda727eed8d3dbc244a027\n        AND 0353b2a83648372cb2d3370b12c1d504.a0cb4fc179140ff174fbd1682dc451a253bf80c2794394a9e4fc91b08ae828cc = 8d49ecffd1b9607efa036327a572695b.a0cb4fc179140ff174fbd1682dc451a253bf80c2794394a9e4fc91b08ae828cc\n        AND 8d49ecffd1b9607efa036327a572695b.1066994b3c9cb973df9654728af380e0 = p_mfr_num\n        AND c1e1ab753a3b305911e8a15073f6c8e7.ff5eff8369918e81f835c2f6b23835df IS NULL\n      UNION ALL\n         SELECT 'ECOLAB867' || p_mfr_num data_who,\n            UPPER(RTRIM (p_partner_id)) || p_mfr_num || brnch_cd || '3' data_key,\n            'SUM' ||\n               TO_CHAR (SUM(ctr), 'S09999') ||\n                TO_CHAR (SUM(total_volume), '8f09f1547a4eb8c7a6d6f248ecc6f483.9be3c526dbb75dd03ad1acf00703c4f6') ||\n                 'UN'\n          FROM (\n              SELECT DISTINCT 57eef8c3d4a13d22f0b40f9742e7b281.7cad4bed0267ab37956f1fcccb769b24.cd8c19b82a9bb45539c5ddd5262d5ee8,  count(1) as ctr,\n                    SUM(ABS(NVL(57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.9f2ec167f84f17ee6dfe57b8ec714693, 0))) total_volume\n                FROM 57eef8c3d4a13d22f0b40f9742e7b281.7cad4bed0267ab37956f1fcccb769b24 d, 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e s, 57eef8c3d4a13d22f0b40f9742e7b281.fadb8b76a21d0037200f1f2222239841 p,\n                     57eef8c3d4a13d22f0b40f9742e7b281.d73db8611de2680d7b0b5feaa04810c2 c, 57eef8c3d4a13d22f0b40f9742e7b281.6071e9636f96f191337758a751a38d40 pim\n                WHERE 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.b37e525777403fb0c0cfa2cab3876994 BETWEEN g_begin_week AND g_end_week\n                AND 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.6e427bacb381704d6a3dbca94a0d4f03 = 57eef8c3d4a13d22f0b40f9742e7b281.d73db8611de2680d7b0b5feaa04810c2.6e427bacb381704d6a3dbca94a0d4f03\n                AND 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.5a8103ceb3eda727eed8d3dbc244a027 = 57eef8c3d4a13d22f0b40f9742e7b281.d73db8611de2680d7b0b5feaa04810c2.5a8103ceb3eda727eed8d3dbc244a027\n                AND 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.9d0604c46c7fc3d284e860c5703e30e5 = 57eef8c3d4a13d22f0b40f9742e7b281.fadb8b76a21d0037200f1f2222239841.9d0604c46c7fc3d284e860c5703e30e5\n                AND 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.5a8103ceb3eda727eed8d3dbc244a027 = 57eef8c3d4a13d22f0b40f9742e7b281.fadb8b76a21d0037200f1f2222239841.5a8103ceb3eda727eed8d3dbc244a027\n                AND 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.5a8103ceb3eda727eed8d3dbc244a027 = 57eef8c3d4a13d22f0b40f9742e7b281.7cad4bed0267ab37956f1fcccb769b24.5a8103ceb3eda727eed8d3dbc244a027\n                AND 57eef8c3d4a13d22f0b40f9742e7b281.fadb8b76a21d0037200f1f2222239841.a0cb4fc179140ff174fbd1682dc451a253bf80c2794394a9e4fc91b08ae828cc = 57eef8c3d4a13d22f0b40f9742e7b281.6071e9636f96f191337758a751a38d40.a0cb4fc179140ff174fbd1682dc451a253bf80c2794394a9e4fc91b08ae828cc\n                AND 57eef8c3d4a13d22f0b40f9742e7b281.6071e9636f96f191337758a751a38d40.1066994b3c9cb973df9654728af380e0 = p_mfr_num\n                AND 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.ff5eff8369918e81f835c2f6b23835df IS NULL\n                GROUP BY 57eef8c3d4a13d22f0b40f9742e7b281.7cad4bed0267ab37956f1fcccb769b24.cd8c19b82a9bb45539c5ddd5262d5ee8\n           )\n            GROUP BY brnch_cd ;\n    COMMIT;\n\n    DBMS_OUTPUT.put_line('END fn_extract_867_ecolab at ' || to_char(sysdate, 'yyyymmdd hh24:mi:ss'));\n    g_timer_end := dbms_utility.get_time;\n    g_run_time  := g_timer_end - g_total_timer_begin; \n    sp_calc_run_time(g_run_time, 'TOTAL RUN TIME : ');\n    DBMS_APPLICATION_INFO.SET_MODULE(null,null);\n\n    RETURN 0;\n    EXCEPTION\n        WHEN OTHERS THEN\n           DBMS_APPLICATION_INFO.SET_MODULE(null,null);\n            g_sqlcode := SQLCODE;\n            g_message := 'fn_extract_867_ecolab sqlerror ' || g_sqlcode || ' ' || SUBSTR(SQLERRM, 1, 75);\n            DBMS_OUTPUT.put_line(g_message);\n            RETURN -2;\n    END fn_extract_867_ecolab;\n\n  END pkg_816_867;\n/",
            "upstream_dependencies": [],
            "downstream_dependencies": [],
            "dag_location": "null",
            "gantt_location": "null",
            "created_at": "null",
            "updated_at": "null"
        },
        {
            "name": "PKG_DISCO10G_USF",
            "encrypted_name": "025fa8ccf93890fb4e2ddbf36ce60b8e53a0c0fe76045acdb204ca36f43c8ecf",
            "type": "package",
            "database": "null",
            "encrypted_database": "null",
            "schema": "XDMADM",
            "encrypted_schema": "da238e96cf2cb791a097ca6946c096b4",
            "fully_qualified_name": "XDMADM.PKG_DISCO10G_USF",
            "encrypted_fqn": "da238e96cf2cb791a097ca6946c096b4.025fa8ccf93890fb4e2ddbf36ce60b8e53a0c0fe76045acdb204ca36f43c8ecf",
            "synonyms": [],
            "metadata_analysis": "CREATE OR REPLACE PACKAGE \"da238e96cf2cb791a097ca6946c096b4\".\"025fa8ccf93890fb4e2ddbf36ce60b8e53a0c0fe76045acdb204ca36f43c8ecf\" AS\n\n\n\n\nFUNCTION USF_GET_PARAM ( p_param_code IN VARCHAR2 )\n  RETURN NUMBER;\n\nFUNCTION USF_GET_VENDOR_NAME (p_cmpny_vndr_nbr IN NUMBER )\n  RETURN VARCHAR2;\n\nFUNCTION USF_GET_DODAAC_CONTRACT (I_BRANCH_CODE IN VARCHAR2,I_CUSTOMER_NUMBER IN VARCHAR2)\n   RETURN VARCHAR2;\n\nEND PKG_DISCO10G_USF;\n/\nCREATE OR REPLACE PACKAGE BODY \"da238e96cf2cb791a097ca6946c096b4\".\"025fa8ccf93890fb4e2ddbf36ce60b8e53a0c0fe76045acdb204ca36f43c8ecf\" AS\n\n\n\n\n\n  FUNCTION USF_GET_PARAM ( p_param_code IN VARCHAR2 )\n  RETURN NUMBER AS\n  n_param_value_nbr 57eef8c3d4a13d22f0b40f9742e7b281.1f9c921b05aafc28bf91547d5ec08a09.8a6a133b7ab25f312c48a0fa788f07d4%TYPE;\n  BEGIN\n\n    SELECT PARAM_VALUE_NBR\n    INTO   n_param_value_nbr\n    FROM   da238e96cf2cb791a097ca6946c096b4.4f5536cc47645edba0ee701f6b3007a7\n    WHERE  PARAM_TYPE LIKE 'AR_GL_ACCT%'\n           AND PARAM_CODE = p_param_code;\n\n\n\n    RETURN n_param_value_nbr;\n    EXCEPTION\n        WHEN OTHERS THEN\n             RETURN -1;\n  END USF_GET_PARAM;\n\n\n\n\n\n  FUNCTION USF_GET_VENDOR_NAME (P_CMPNY_VNDR_NBR IN NUMBER )\n  RETURN VARCHAR2 AS\n    v_company_vendor_name VARCHAR2(30);\n  BEGIN\n    SELECT CMPNY_VNDR_NM\n    INTO v_company_vendor_name\n    FROM da238e96cf2cb791a097ca6946c096b4.2af4b241beca88c7edcd168d681f284b\n    WHERE CMPNY_VNDR_NBR = p_cmpny_vndr_nbr;\n    RETURN v_company_vendor_name;\n  EXCEPTION\n  WHEN OTHERS THEN\n    RETURN 'VENDOR NOT VALID';\n  END USF_GET_VENDOR_NAME;\n\n\n  \n\n  FUNCTION USF_GET_DODAAC_CONTRACT (I_BRANCH_CODE IN VARCHAR2,I_CUSTOMER_NUMBER IN VARCHAR2)\n   RETURN VARCHAR2 AS\n   V_DODAAC_CONTRACT   VARCHAR2 (100);\nBEGIN\n   SELECT   da238e96cf2cb791a097ca6946c096b4.f31a00d5dae9b68862126e7010c9a245.39afd9d6715bfb1cd10e4be5c974705f || '~' || da238e96cf2cb791a097ca6946c096b4.f31a00d5dae9b68862126e7010c9a245.15e81d8a8e051fd880f377c10f4a5c1d\n     INTO   V_DODAAC_CONTRACT\n     FROM   da238e96cf2cb791a097ca6946c096b4.f31a00d5dae9b68862126e7010c9a245 D\n    WHERE   da238e96cf2cb791a097ca6946c096b4.f31a00d5dae9b68862126e7010c9a245.2f4144a10b49ca27be26ac7abf4d8c72 = I_BRANCH_CODE\n        AND da238e96cf2cb791a097ca6946c096b4.f31a00d5dae9b68862126e7010c9a245.8e841025cf05f3ab5f9a1b4d99798c5f = I_CUSTOMER_NUMBER;\n\n   RETURN V_DODAAC_CONTRACT;\nEXCEPTION\n   WHEN NO_DATA_FOUND\n   THEN\n      RETURN ' ~ ';\n   WHEN OTHERS\n   THEN\n      RETURN 'SQL ERROR-da238e96cf2cb791a097ca6946c096b4.76cbbf707c2642876571101d7a673c69da1d8ba963032d60b83ebc08700e8a7c~SQL ERROR-da238e96cf2cb791a097ca6946c096b4.76cbbf707c2642876571101d7a673c69da1d8ba963032d60b83ebc08700e8a7c';\nEND USF_GET_DODAAC_CONTRACT;\n\nEND PKG_DISCO10G_USF;\n/",
            "upstream_dependencies": [],
            "downstream_dependencies": [],
            "dag_location": "null",
            "gantt_location": "null",
            "created_at": "null",
            "updated_at": "null"
        },
        {
            "name": "PKG_SLS_RGN",
            "encrypted_name": "b9580f20dce751a68259e8bcecebddc2",
            "type": "package",
            "database": "null",
            "encrypted_database": "null",
            "schema": "XDMADM",
            "encrypted_schema": "da238e96cf2cb791a097ca6946c096b4",
            "fully_qualified_name": "XDMADM.PKG_SLS_RGN",
            "encrypted_fqn": "da238e96cf2cb791a097ca6946c096b4.b9580f20dce751a68259e8bcecebddc2",
            "synonyms": [],
            "metadata_analysis": "CREATE OR REPLACE PACKAGE \"da238e96cf2cb791a097ca6946c096b4\".\"b9580f20dce751a68259e8bcecebddc2\" AS\n   \n   c_aggr_syn_nm   CONSTANT VARCHAR2(30) := 'SALES_RGN_WK_AGGR';\n   c_prj_syn_nm    CONSTANT VARCHAR2(30) := 'SALES_RGN_WK_PRJ';\n   c_vw_syn_nm     CONSTANT VARCHAR2(30) := 'SALES_RGN_WK_AGGR_PRJ';\n   c_schema_nm     CONSTANT VARCHAR2(8) := 'XDMADM';\n   c_success       CONSTANT NUMBER := 0;\n   c_error         CONSTANT NUMBER := 1;\n\n   TYPE t_aggr_dim IS RECORD(div_nbr ad301f90330480e29eb84161773b9fafdd2cd6a4536c13186ac9e4e5f4c05c79.5a8103ceb3eda727eed8d3dbc244a027%TYPE,\n                             pim_cls_id ad301f90330480e29eb84161773b9fafdd2cd6a4536c13186ac9e4e5f4c05c79.efdf828ab5807ba11926106c83446edf%TYPE,\n                             pim_suprcls_id_crnt ad301f90330480e29eb84161773b9fafdd2cd6a4536c13186ac9e4e5f4c05c79.c9cb6c3aebf1feef31b4ae62eb481a549d7cf68eee057f0c1cd5afcea8bdbeb8%TYPE,\n                             pim_suprcls_id_actl ad301f90330480e29eb84161773b9fafdd2cd6a4536c13186ac9e4e5f4c05c79.a0f6961bdc835dca2e5e3774ec64db253c0fecea47df5fa5ea18b34d89b824b0%TYPE,\n                             trd_cls ad301f90330480e29eb84161773b9fafdd2cd6a4536c13186ac9e4e5f4c05c79.7080f549428abf39b1057724fa59d813%TYPE,\n                             acct_typ_cd ad301f90330480e29eb84161773b9fafdd2cd6a4536c13186ac9e4e5f4c05c79.19e3c0386096134b289ffad420a16e46%TYPE,\n                             corp_mlt_unit_nbr ad301f90330480e29eb84161773b9fafdd2cd6a4536c13186ac9e4e5f4c05c79.e55fceed8f2eab1e37d2d927e339c92a3829969834280a39721b32c836afdff1%TYPE,\n                             prnt_mlt_unit_cd ad301f90330480e29eb84161773b9fafdd2cd6a4536c13186ac9e4e5f4c05c79.8df1cdd196bd3b27791c8c601cfcb2c453a0c0fe76045acdb204ca36f43c8ecf%TYPE,\n                             pim_brnd_typ ad301f90330480e29eb84161773b9fafdd2cd6a4536c13186ac9e4e5f4c05c79.bf06136cf49bda7953950bcb3c3c3cb7%TYPE);\n\n   TYPE t_aggr_msr IS RECORD(sales ad301f90330480e29eb84161773b9fafdd2cd6a4536c13186ac9e4e5f4c05c79.9e7e4013fd15c78725b0ef91cd1cd802%TYPE,\n                             cases ad301f90330480e29eb84161773b9fafdd2cd6a4536c13186ac9e4e5f4c05c79.35b5bbe882cdc6cc77aeda236583bcf0%TYPE,\n                             tagp ad301f90330480e29eb84161773b9fafdd2cd6a4536c13186ac9e4e5f4c05c79.4c4cd385a85195b3e0992884d97581eb%TYPE,\n                             pa ad301f90330480e29eb84161773b9fafdd2cd6a4536c13186ac9e4e5f4c05c79.a93269d2d91405b98207972fb3a1ae80%TYPE,\n                             grs_tgp ad301f90330480e29eb84161773b9fafdd2cd6a4536c13186ac9e4e5f4c05c79.de359d0148528b5cfe3c4b36b71fd9cd%TYPE,\n                             net_sls ad301f90330480e29eb84161773b9fafdd2cd6a4536c13186ac9e4e5f4c05c79.ab99700499f70b7018dfa7cc45b968c5%TYPE,\n                             net_tgp ad301f90330480e29eb84161773b9fafdd2cd6a4536c13186ac9e4e5f4c05c79.8778832fa9be240347e4d5b742fa7d56%TYPE);\n\n   TYPE t_aggr_growth IS RECORD(sales   NUMBER(13,4),\n                                cases   NUMBER(13,4),\n                                tagp    NUMBER(13,4),\n                                pa      NUMBER(13,4),\n                                grs_tgp NUMBER(13,4),\n                                net_sls NUMBER(13,4),\n                                net_tgp NUMBER(13,4));\n\n   FUNCTION get_fisc_wk(p_clndr_dt IN DATE)\n      RETURN VARCHAR2;\n\n   FUNCTION get_measures(p_wk_from IN VARCHAR2, p_wk_to IN VARCHAR2, p_aggr_dim IN t_aggr_dim)\n      RETURN t_aggr_msr;\n\n   FUNCTION get_wow_growth(p_wk_from IN VARCHAR2, p_wk_to IN VARCHAR2, p_aggr_dim IN t_aggr_dim)\n      RETURN t_aggr_growth;\n\n   FUNCTION get_msr_growth(p_msr_cy IN NUMBER, p_msr_ly IN NUMBER)\n      RETURN NUMBER;\n\n   FUNCTION get_msr_prj(p_msr IN t_aggr_msr, p_msr_growth IN t_aggr_growth)\n      RETURN t_aggr_msr;\n\n   FUNCTION fn_get_prev_yr_wk(p_fisc_yr_wk VARCHAR, p_prev_yr NUMBER)\n      RETURN VARCHAR2\n      DETERMINISTIC;\n\n   FUNCTION fn_get_tbl_nm(p_syn_nm VARCHAR2, p_tbl_actv VARCHAR2)\n      RETURN VARCHAR2;\n\n   PROCEDURE set_syn_tbl(p_tbl_nm VARCHAR2, p_tbl_actv VARCHAR2);\nEND pkg_sls_rgn;\n/\nCREATE OR REPLACE PACKAGE BODY \"da238e96cf2cb791a097ca6946c096b4\".\"b9580f20dce751a68259e8bcecebddc2\" AS\n   \n   TYPE t_wow_wks IS TABLE OF 57eef8c3d4a13d22f0b40f9742e7b281.a2349118cac55136943abdf2d397e141.78b147c8e239062228170605a601c274%TYPE\n                        INDEX BY BINARY_INTEGER;\n\n   r_wow_wks       t_wow_wks;\n\n   l_wow_prev_wk   VARCHAR2(6);\n\n   \n   FUNCTION get_fisc_wk(p_clndr_dt IN DATE)\n      RETURN VARCHAR2 IS\n      l_fisc_yr_wk   VARCHAR2(6);\n   BEGIN\n      SELECT fisc_yr_wk\n        INTO l_fisc_yr_wk\n        FROM time_corp\n       WHERE TRUNC(clndr_dt) = TRUNC(p_clndr_dt);\n\n      RETURN l_fisc_yr_wk;\n   EXCEPTION\n      WHEN OTHERS THEN\n         DBMS_OUTPUT.put_line('Error in GET_FISC_WK');\n         DBMS_OUTPUT.put_line(SUBSTR(SQLERRM, 1, 2000));\n   END get_fisc_wk;\n\n   \n   FUNCTION get_msr_prj(p_msr IN t_aggr_msr, p_msr_growth IN t_aggr_growth)\n      RETURN t_aggr_msr IS\n      r_aggr_msr   t_aggr_msr;\n   BEGIN\n      ce2fbe56e9feed0535a415484ab4ce31.91b09e1025eaa89037f7453e981008ed   := ROUND(fd86dc660e80cab7a51c34e817ff88e4.91b09e1025eaa89037f7453e981008ed * (1 + 12b4c0fbdb9f3401cac06d758f31e378.91b09e1025eaa89037f7453e981008ed), 2);\n      ce2fbe56e9feed0535a415484ab4ce31.42f8abbdcc7713ab91c09d3c9ec244a0   := ROUND(fd86dc660e80cab7a51c34e817ff88e4.42f8abbdcc7713ab91c09d3c9ec244a0 * (1 + 12b4c0fbdb9f3401cac06d758f31e378.42f8abbdcc7713ab91c09d3c9ec244a0), 2);\n      ce2fbe56e9feed0535a415484ab4ce31.36fbdf4b259cc86808a96ba5706e588d    := ROUND(fd86dc660e80cab7a51c34e817ff88e4.36fbdf4b259cc86808a96ba5706e588d * (1 + 12b4c0fbdb9f3401cac06d758f31e378.36fbdf4b259cc86808a96ba5706e588d), 2);\n      ce2fbe56e9feed0535a415484ab4ce31.de359d0148528b5cfe3c4b36b71fd9cd := ROUND(fd86dc660e80cab7a51c34e817ff88e4.de359d0148528b5cfe3c4b36b71fd9cd * (1 + 12b4c0fbdb9f3401cac06d758f31e378.de359d0148528b5cfe3c4b36b71fd9cd), 2);        \n      ce2fbe56e9feed0535a415484ab4ce31.ab99700499f70b7018dfa7cc45b968c5 := ROUND(fd86dc660e80cab7a51c34e817ff88e4.ab99700499f70b7018dfa7cc45b968c5 * (1 + 12b4c0fbdb9f3401cac06d758f31e378.ab99700499f70b7018dfa7cc45b968c5), 2);        \n      ce2fbe56e9feed0535a415484ab4ce31.8778832fa9be240347e4d5b742fa7d56 := ROUND(fd86dc660e80cab7a51c34e817ff88e4.8778832fa9be240347e4d5b742fa7d56 * (1 + 12b4c0fbdb9f3401cac06d758f31e378.8778832fa9be240347e4d5b742fa7d56), 2);        \n\n      RETURN r_aggr_msr;\n   EXCEPTION\n      WHEN OTHERS THEN\n         DBMS_OUTPUT.put_line('Error in GET_MSR_PRJ');\n         DBMS_OUTPUT.put_line(SUBSTR(SQLERRM, 1, 2000));\n   END get_msr_prj;\n\n   \n   FUNCTION get_measures(p_wk_from IN VARCHAR2, p_wk_to IN VARCHAR2, p_aggr_dim IN t_aggr_dim)\n      RETURN t_aggr_msr IS\n      r_aggr_msr       t_aggr_msr;\n      l_inactive_tbl   VARCHAR2(30);\n      l_query          VARCHAR2(1000);\n   BEGIN\n      l_inactive_tbl   := f58902597f499e6c17ebd1b947f7736e.f58b7b2b0185761061c0a1a919236040(f58902597f499e6c17ebd1b947f7736e.4aa9ff7c17b06445172070148eb54516, 'N');\n\n\n      \n      SELECT    'SELECT NVL (SUM (grs_sls_extnd), 0) sales, NVL (SUM (unfrm_qty_ship), 0) cases, '\n             || 'NVL (SUM (actl_gp), 0) tagp, NVL (SUM (ttl_alwnc), 0) pa, '\n             || 'NVL (SUM (grs_tgp), 0) grs_tgp, NVL (SUM (net_sls), 0) net_sls, '\n             || 'NVL (SUM (net_tgp), 0) net_tgp '\n             || ' FROM '\n             || l_inactive_tbl\n             || ' WHERE ly_wtd = ''N''\n                AND fisc_yr_wk BETWEEN '''\n             || p_wk_from\n             || '''AND'''\n             || p_wk_to\n             || ''' AND    div_nbr = '\n             || 10173302d8c963e316d4e4b880f1e837.5a8103ceb3eda727eed8d3dbc244a027\n             || ' AND    pim_cls_id'\n             || DECODE(10173302d8c963e316d4e4b880f1e837.efdf828ab5807ba11926106c83446edf, NULL, ' IS NULL', ' = ' || TO_CHAR(10173302d8c963e316d4e4b880f1e837.efdf828ab5807ba11926106c83446edf))\n             || ' AND    pim_suprcls_id_crnt'\n             || DECODE(10173302d8c963e316d4e4b880f1e837.c9cb6c3aebf1feef31b4ae62eb481a549d7cf68eee057f0c1cd5afcea8bdbeb8,\n                       NULL, ' IS NULL',\n                       ' = ' || TO_CHAR(10173302d8c963e316d4e4b880f1e837.c9cb6c3aebf1feef31b4ae62eb481a549d7cf68eee057f0c1cd5afcea8bdbeb8))\n             || ' AND    pim_suprcls_id_actl'\n             || DECODE(10173302d8c963e316d4e4b880f1e837.a0f6961bdc835dca2e5e3774ec64db253c0fecea47df5fa5ea18b34d89b824b0,\n                       NULL, ' IS NULL',\n                       ' = ' || TO_CHAR(10173302d8c963e316d4e4b880f1e837.a0f6961bdc835dca2e5e3774ec64db253c0fecea47df5fa5ea18b34d89b824b0))\n             || ' AND    trd_cls'\n             || DECODE(10173302d8c963e316d4e4b880f1e837.7080f549428abf39b1057724fa59d813, NULL, ' IS NULL', '=''' || 10173302d8c963e316d4e4b880f1e837.7080f549428abf39b1057724fa59d813 || '''')\n             || ' AND    acct_typ_cd'\n             || DECODE(10173302d8c963e316d4e4b880f1e837.19e3c0386096134b289ffad420a16e46, NULL, ' IS NULL', '=''' || 10173302d8c963e316d4e4b880f1e837.19e3c0386096134b289ffad420a16e46 || '''')\n             || ' AND    corp_mlt_unit_nbr'\n             || DECODE(10173302d8c963e316d4e4b880f1e837.e55fceed8f2eab1e37d2d927e339c92a3829969834280a39721b32c836afdff1, NULL, ' IS NULL', '=''' || 10173302d8c963e316d4e4b880f1e837.e55fceed8f2eab1e37d2d927e339c92a3829969834280a39721b32c836afdff1 || '''')\n             || ' AND    prnt_mlt_unit_cd'\n             || DECODE(10173302d8c963e316d4e4b880f1e837.8df1cdd196bd3b27791c8c601cfcb2c453a0c0fe76045acdb204ca36f43c8ecf, NULL, ' IS NULL', '=''' || 10173302d8c963e316d4e4b880f1e837.8df1cdd196bd3b27791c8c601cfcb2c453a0c0fe76045acdb204ca36f43c8ecf || '''')\n             || ' AND    pim_brnd_typ'\n             || DECODE(10173302d8c963e316d4e4b880f1e837.bf06136cf49bda7953950bcb3c3c3cb7, NULL, ' IS NULL', '=''' || 10173302d8c963e316d4e4b880f1e837.bf06136cf49bda7953950bcb3c3c3cb7 || '''')\n        INTO l_query\n        FROM DUAL;\n\n      EXECUTE IMMEDIATE l_query INTO ce2fbe56e9feed0535a415484ab4ce31.91b09e1025eaa89037f7453e981008ed,\n                                     ce2fbe56e9feed0535a415484ab4ce31.42f8abbdcc7713ab91c09d3c9ec244a0,\n                                     ce2fbe56e9feed0535a415484ab4ce31.36fbdf4b259cc86808a96ba5706e588d,\n                                     ce2fbe56e9feed0535a415484ab4ce31.cd58358e81e2bce2bd4b2086934f28d3,\n                                     ce2fbe56e9feed0535a415484ab4ce31.de359d0148528b5cfe3c4b36b71fd9cd,       \n                                     ce2fbe56e9feed0535a415484ab4ce31.ab99700499f70b7018dfa7cc45b968c5,       \n                                     ce2fbe56e9feed0535a415484ab4ce31.8778832fa9be240347e4d5b742fa7d56;       \n\n      RETURN r_aggr_msr;\n   EXCEPTION\n      WHEN OTHERS THEN\n         DBMS_OUTPUT.put_line('Error in GET_MEASURES');\n         DBMS_OUTPUT.put_line(SUBSTR(SQLERRM, 1, 2000));\n   END get_measures;\n\n   \n   FUNCTION get_wow_growth(p_wk_from IN VARCHAR2, p_wk_to IN VARCHAR2, p_aggr_dim IN t_aggr_dim)\n      RETURN t_aggr_growth IS\n      l_prev_wk        VARCHAR2(6);\n      r_total_growth   t_aggr_growth;\n      r_avg_growth     t_aggr_growth;\n      l_wk_cnt         NUMBER := 0;\n\n      CURSOR c_wow_wks(x_first_wk IN VARCHAR2, x_last_wk IN VARCHAR2) IS\n           SELECT fisc_yr_wk\n             FROM wkly_time_corp\n            WHERE fisc_yr_wk BETWEEN x_first_wk AND x_last_wk\n         ORDER BY fisc_yr_wk;\n\n      r_cur_wk_msr     t_aggr_msr;\n      r_prev_wk_msr    t_aggr_msr;\n   BEGIN\n      IF (l_wow_prev_wk IS NULL) THEN\n         SELECT fisc_yr_wkago\n           INTO l_wow_prev_wk\n           FROM wkly_time_corp\n          WHERE fisc_yr_wk = p_wk_from;\n\n         \n         OPEN c_wow_wks(p_wk_from, p_wk_to);\n\n         FETCH c_wow_wks\n         BULK COLLECT INTO r_wow_wks;\n\n         CLOSE c_wow_wks;\n      END IF;\n\n      r_prev_wk_msr          := get_measures(l_wow_prev_wk, l_wow_prev_wk, p_aggr_dim);\n      e2c774f3a8441d302a4800ff80cd6925.91b09e1025eaa89037f7453e981008ed   := 0;\n      e2c774f3a8441d302a4800ff80cd6925.42f8abbdcc7713ab91c09d3c9ec244a0   := 0;\n      e2c774f3a8441d302a4800ff80cd6925.36fbdf4b259cc86808a96ba5706e588d    := 0;\n      e2c774f3a8441d302a4800ff80cd6925.de359d0148528b5cfe3c4b36b71fd9cd := 0;       \n      e2c774f3a8441d302a4800ff80cd6925.ab99700499f70b7018dfa7cc45b968c5 := 0;       \n      e2c774f3a8441d302a4800ff80cd6925.8778832fa9be240347e4d5b742fa7d56 := 0;       \n\n      FOR i IN 3e09810caa07e587ad01b2ff45c2c0ba.ffeb71434c07e00ba8389efd8bc4154e .. 3e09810caa07e587ad01b2ff45c2c0ba.4635f2af279e7eaaaa1901820acd0bac LOOP\n         r_cur_wk_msr           := get_measures(r_wow_wks(i), r_wow_wks(i), p_aggr_dim);\n\n         e2c774f3a8441d302a4800ff80cd6925.91b09e1025eaa89037f7453e981008ed   := e2c774f3a8441d302a4800ff80cd6925.91b09e1025eaa89037f7453e981008ed + get_msr_growth(602f2cb568dd8ee798940dd9c674a31c.91b09e1025eaa89037f7453e981008ed, 3730db2cfdc8c8ffe0504ecf6df945bd.91b09e1025eaa89037f7453e981008ed);\n         e2c774f3a8441d302a4800ff80cd6925.42f8abbdcc7713ab91c09d3c9ec244a0   := e2c774f3a8441d302a4800ff80cd6925.42f8abbdcc7713ab91c09d3c9ec244a0 + get_msr_growth(602f2cb568dd8ee798940dd9c674a31c.42f8abbdcc7713ab91c09d3c9ec244a0, 3730db2cfdc8c8ffe0504ecf6df945bd.42f8abbdcc7713ab91c09d3c9ec244a0);\n         e2c774f3a8441d302a4800ff80cd6925.36fbdf4b259cc86808a96ba5706e588d    := e2c774f3a8441d302a4800ff80cd6925.36fbdf4b259cc86808a96ba5706e588d + get_msr_growth(602f2cb568dd8ee798940dd9c674a31c.36fbdf4b259cc86808a96ba5706e588d, 3730db2cfdc8c8ffe0504ecf6df945bd.36fbdf4b259cc86808a96ba5706e588d);\n         e2c774f3a8441d302a4800ff80cd6925.de359d0148528b5cfe3c4b36b71fd9cd := e2c774f3a8441d302a4800ff80cd6925.de359d0148528b5cfe3c4b36b71fd9cd + get_msr_growth(602f2cb568dd8ee798940dd9c674a31c.de359d0148528b5cfe3c4b36b71fd9cd, 3730db2cfdc8c8ffe0504ecf6df945bd.de359d0148528b5cfe3c4b36b71fd9cd);    \n         e2c774f3a8441d302a4800ff80cd6925.ab99700499f70b7018dfa7cc45b968c5 := e2c774f3a8441d302a4800ff80cd6925.ab99700499f70b7018dfa7cc45b968c5 + get_msr_growth(602f2cb568dd8ee798940dd9c674a31c.ab99700499f70b7018dfa7cc45b968c5, 3730db2cfdc8c8ffe0504ecf6df945bd.ab99700499f70b7018dfa7cc45b968c5);    \n         e2c774f3a8441d302a4800ff80cd6925.8778832fa9be240347e4d5b742fa7d56 := e2c774f3a8441d302a4800ff80cd6925.8778832fa9be240347e4d5b742fa7d56 + get_msr_growth(602f2cb568dd8ee798940dd9c674a31c.8778832fa9be240347e4d5b742fa7d56, 3730db2cfdc8c8ffe0504ecf6df945bd.8778832fa9be240347e4d5b742fa7d56);    \n\n         r_prev_wk_msr          := r_cur_wk_msr;\n         l_wk_cnt               := l_wk_cnt + 1;\n      END LOOP;\n\n      bab763466990aead02f661a7c778dca8.91b09e1025eaa89037f7453e981008ed     := e2c774f3a8441d302a4800ff80cd6925.91b09e1025eaa89037f7453e981008ed / l_wk_cnt;\n\n      bab763466990aead02f661a7c778dca8.42f8abbdcc7713ab91c09d3c9ec244a0     := e2c774f3a8441d302a4800ff80cd6925.42f8abbdcc7713ab91c09d3c9ec244a0 / l_wk_cnt;\n      bab763466990aead02f661a7c778dca8.36fbdf4b259cc86808a96ba5706e588d      := e2c774f3a8441d302a4800ff80cd6925.36fbdf4b259cc86808a96ba5706e588d / l_wk_cnt;\n      bab763466990aead02f661a7c778dca8.de359d0148528b5cfe3c4b36b71fd9cd   := e2c774f3a8441d302a4800ff80cd6925.de359d0148528b5cfe3c4b36b71fd9cd / l_wk_cnt;               \n      bab763466990aead02f661a7c778dca8.ab99700499f70b7018dfa7cc45b968c5   := e2c774f3a8441d302a4800ff80cd6925.ab99700499f70b7018dfa7cc45b968c5 / l_wk_cnt;               \n      bab763466990aead02f661a7c778dca8.8778832fa9be240347e4d5b742fa7d56   := e2c774f3a8441d302a4800ff80cd6925.8778832fa9be240347e4d5b742fa7d56 / l_wk_cnt;               \n\n      RETURN r_avg_growth;\n   EXCEPTION\n      WHEN OTHERS THEN\n         DBMS_OUTPUT.put_line('Error in GET_WOW_GROWTH');\n         DBMS_OUTPUT.put_line(SUBSTR(SQLERRM, 1, 2000));\n   END get_wow_growth;\n\n   \n   FUNCTION get_msr_growth(p_msr_cy IN NUMBER, p_msr_ly IN NUMBER)\n      RETURN NUMBER IS\n      l_growth   NUMBER;\n   BEGIN\n      IF (p_msr_ly <> 0) THEN\n         l_growth   := ROUND((p_msr_cy - p_msr_ly) / p_msr_ly, 4);\n\n         IF (l_growth > 2) THEN\n            l_growth   := 2;\n         END IF;\n\n         IF (l_growth < -2) THEN\n            l_growth   := -2;\n         END IF;\n      ELSE\n         l_growth   := 0;\n      END IF;\n\n      RETURN l_growth;\n   EXCEPTION\n      WHEN OTHERS THEN\n         DBMS_OUTPUT.put_line('Error in GET_MSR_GROWTH');\n         DBMS_OUTPUT.put_line(SUBSTR(SQLERRM, 1, 2000));\n   END get_msr_growth;\n\n   \n   FUNCTION fn_get_prev_yr_wk(p_fisc_yr_wk VARCHAR, p_prev_yr NUMBER)\n      RETURN VARCHAR2\n      DETERMINISTIC IS\n      l_prev_fisc_yr_wk   VARCHAR2(6);\n      l_prev_yr           VARCHAR2(4);\n      l_fisc_wk_of_yr     VARCHAR2(2);\n      l_fisc_yr           NUMBER;\n      l_wks_in_prev_yr    NUMBER;\n   BEGIN\n      l_fisc_yr         := SUBSTR(p_fisc_yr_wk, 1, 4);\n      l_prev_yr         := l_fisc_yr - p_prev_yr;\n      l_fisc_wk_of_yr   := SUBSTR(p_fisc_yr_wk, 5, 2);\n\n      SELECT fisc_wk_of_yr\n        INTO l_wks_in_prev_yr\n        FROM 57eef8c3d4a13d22f0b40f9742e7b281.a2349118cac55136943abdf2d397e141\n       WHERE clndr_dt = l_prev_yr || '1231';\n\n      IF (l_fisc_wk_of_yr = 53) THEN\n         l_prev_fisc_yr_wk   := l_prev_yr || '52';\n      ELSIF (l_fisc_wk_of_yr BETWEEN 49 AND 52) THEN\n         IF (l_wks_in_prev_yr = 53) THEN\n            l_prev_fisc_yr_wk   := l_prev_yr || TO_CHAR(l_fisc_wk_of_yr + 1);\n         ELSE\n            l_prev_fisc_yr_wk   := l_prev_yr || l_fisc_wk_of_yr;\n         END IF;\n      ELSE\n         l_prev_fisc_yr_wk   := l_prev_yr || l_fisc_wk_of_yr;\n      END IF;\n\n      RETURN l_prev_fisc_yr_wk;\n   EXCEPTION\n      WHEN OTHERS THEN\n         DBMS_OUTPUT.put_line('Error in FN_GET_PREV_YR_WK');\n         DBMS_OUTPUT.put_line(SUBSTR(SQLERRM, 1, 2000));\n   END fn_get_prev_yr_wk;\n\n   \n   FUNCTION fn_get_tbl_nm(p_syn_nm VARCHAR2, p_tbl_actv VARCHAR2)\n      RETURN VARCHAR2 IS\n      l_full_tbl_nm   VARCHAR2(30);\n   BEGIN\n      SELECT tbl_nm\n        INTO l_full_tbl_nm\n        FROM 0995ae2071582f271cc89b5935c8c98b.e82518bc41eafdc4a4d474a4439ba693\n       WHERE synonym_nm = p_syn_nm\n         AND actv_ind = p_tbl_actv;\n\n      RETURN l_full_tbl_nm;\n   EXCEPTION\n      WHEN OTHERS THEN\n         DBMS_OUTPUT.put_line('Error in FN_GET_TBL_NM');\n         DBMS_OUTPUT.put_line(SUBSTR(SQLERRM, 1, 2000));\n   END fn_get_tbl_nm;\n\n   \n   PROCEDURE set_syn_tbl(p_tbl_nm VARCHAR2, p_tbl_actv VARCHAR2) IS\n   BEGIN\n      UPDATE 0995ae2071582f271cc89b5935c8c98b.e82518bc41eafdc4a4d474a4439ba693\n         SET actv_ind = p_tbl_actv, last_updt = SYSDATE\n       WHERE tbl_nm = p_tbl_nm;\n\n      IF (sql%ROWCOUNT = 0) THEN\n         DBMS_OUTPUT.put_line('No rows to update in syn tbl map');\n      END IF;\n   EXCEPTION\n      WHEN OTHERS THEN\n         DBMS_OUTPUT.put_line('Error in SET_SYN_TBL');\n         DBMS_OUTPUT.put_line(SUBSTR(SQLERRM, 1, 2000));\n         RAISE;\n   END set_syn_tbl;\nEND pkg_sls_rgn;\n/",
            "upstream_dependencies": [],
            "downstream_dependencies": [],
            "dag_location": "null",
            "gantt_location": "null",
            "created_at": "null",
            "updated_at": "null"
        },
        {
            "name": "PKG_NON_SHIP_DIV",
            "encrypted_name": "e3b737fbc9b936d18a8535bea489792e53a0c0fe76045acdb204ca36f43c8ecf",
            "type": "package",
            "database": "null",
            "encrypted_database": "null",
            "schema": "XDMADM",
            "encrypted_schema": "da238e96cf2cb791a097ca6946c096b4",
            "fully_qualified_name": "XDMADM.PKG_NON_SHIP_DIV",
            "encrypted_fqn": "da238e96cf2cb791a097ca6946c096b4.e3b737fbc9b936d18a8535bea489792e53a0c0fe76045acdb204ca36f43c8ecf",
            "synonyms": [],
            "metadata_analysis": "CREATE OR REPLACE PACKAGE \"da238e96cf2cb791a097ca6946c096b4\".\"e3b737fbc9b936d18a8535bea489792e53a0c0fe76045acdb204ca36f43c8ecf\"\nAS\n   \n\n   FUNCTION FN_GET_NON_SHIP_DIV_LIST_REF\n      RETURN SYS_REFCURSOR;\n\n   FUNCTION FN_GET_NON_SHIP_DIV_LIST_REF (P_IN_ODATE VARCHAR2)\n      RETURN SYS_REFCURSOR;\n\n   FUNCTION FN_GET_NON_SHIP_DIV_LIST\n      RETURN VARCHAR2;\n\n   FUNCTION FN_GET_NON_SHIP_DIV_LIST (P_IN_ODATE VARCHAR2)\n      RETURN VARCHAR2;\n\n   FUNCTION FN_CHK_NON_SHIP_DIV (P_IN_DIV_NBR VARCHAR2)\n      RETURN VARCHAR2;\n\n   FUNCTION FN_CHK_NON_SHIP_DIV (P_IN_ODATE VARCHAR2, P_IN_DIV_NBR VARCHAR2)\n      RETURN VARCHAR2;\nEND PKG_NON_SHIP_DIV;\n/\nCREATE OR REPLACE PACKAGE BODY \"da238e96cf2cb791a097ca6946c096b4\".\"e3b737fbc9b936d18a8535bea489792e53a0c0fe76045acdb204ca36f43c8ecf\"\nAS\n   \n   FUNCTION FN_GET_NON_SHIP_DIV_LIST_REF\n      RETURN SYS_REFCURSOR\n   IS\n      \n\n      v_div_list   SYS_REFCURSOR;\n   BEGIN\n      OPEN v_div_list FOR\n           SELECT   DISTINCT param_code\n             FROM   da238e96cf2cb791a097ca6946c096b4.4f5536cc47645edba0ee701f6b3007a7\n            WHERE   app_name = 'NON_SHIP_DIV'\n                    AND CASE\n                          WHEN param_value_chr = 'DLY'\n                          THEN\n                             1\n                          WHEN param_value_chr = 'WK_DAY'\n                               AND TO_CHAR (SYSDATE, 'D') = param_type\n                          THEN\n                             1\n                       END = 1\n         ORDER BY   PARAM_CODE;\n\n      RETURN v_div_list;\n   END FN_GET_NON_SHIP_DIV_LIST_REF;\n\n   FUNCTION FN_GET_NON_SHIP_DIV_LIST_REF (P_IN_ODATE VARCHAR2)\n      RETURN SYS_REFCURSOR\n   IS\n      \n\n      v_div_list   SYS_REFCURSOR;\n   BEGIN\n      OPEN v_div_list FOR\n           SELECT   DISTINCT param_code\n             FROM   da238e96cf2cb791a097ca6946c096b4.4f5536cc47645edba0ee701f6b3007a7\n            WHERE   app_name = 'NON_SHIP_DIV'\n                    AND CASE\n                          WHEN param_value_chr = 'DLY'\n                          THEN\n                             1\n                          WHEN param_value_chr = 'WK_DAY'\n                               AND TO_CHAR (TO_DATE (P_IN_ODATE, 'YYYYMMDD'),\n                                            'D') = param_type\n                          THEN\n                             1\n                       END = 1\n         ORDER BY   param_code;\n\n      RETURN v_div_list;\n   END FN_GET_NON_SHIP_DIV_LIST_REF;\n\n   FUNCTION FN_GET_NON_SHIP_DIV_LIST\n      RETURN VARCHAR2\n   IS\n      \n\n      v_div_list   VARCHAR2 (1000) := NULL;\n   BEGIN\n      FOR C1 IN (  SELECT   DISTINCT param_code\n                     FROM   da238e96cf2cb791a097ca6946c096b4.4f5536cc47645edba0ee701f6b3007a7\n                    WHERE   app_name = 'NON_SHIP_DIV'\n                            AND CASE\n                                  WHEN param_value_chr = 'DLY'\n                                  THEN\n                                     1\n                                  WHEN param_value_chr = 'WK_DAY'\n                                       AND TO_CHAR (SYSDATE, 'D') = param_type\n                                  THEN\n                                     1\n                               END = 1\n                 ORDER BY   PARAM_CODE)\n      LOOP\n         v_div_list := v_div_list ||''''|| 41352d788be2282c39e2cfd8d2a37ea0.4037c51e8a924adecf20c1b5c685241e||'''' || ', ';\n      END LOOP;\n\n      v_div_list := RTRIM (v_div_list, ', ');\n\n      RETURN v_div_list;\n   END FN_GET_NON_SHIP_DIV_LIST;\n\n   FUNCTION FN_GET_NON_SHIP_DIV_LIST (P_IN_ODATE VARCHAR2)\n      RETURN VARCHAR2\n   IS\n      \n\n      v_div_list   VARCHAR2 (1000) := NULL;\n   BEGIN\n      FOR C1 IN (  SELECT   DISTINCT param_code\n                     FROM   da238e96cf2cb791a097ca6946c096b4.4f5536cc47645edba0ee701f6b3007a7\n                    WHERE   app_name = 'NON_SHIP_DIV'\n                            AND CASE\n                                  WHEN param_value_chr = 'DLY'\n                                  THEN\n                                     1\n                                  WHEN param_value_chr = 'WK_DAY'\n                                       AND TO_CHAR (\n                                             TO_DATE (P_IN_ODATE, 'YYYYMMDD'),\n                                             'D'\n                                          ) = param_type\n                                  THEN\n                                     1\n                               END = 1\n                 ORDER BY   param_code)\n      LOOP\n         v_div_list := v_div_list ||''''|| 41352d788be2282c39e2cfd8d2a37ea0.4037c51e8a924adecf20c1b5c685241e||'''' || ', ';\n      END LOOP;\n\n      v_div_list := RTRIM (v_div_list, ', ');\n\n      RETURN v_div_list;\n   END FN_GET_NON_SHIP_DIV_LIST;\n\n   FUNCTION FN_CHK_NON_SHIP_DIV (P_IN_DIV_NBR VARCHAR2)\n      RETURN VARCHAR2\n   IS\n      \n      V_CNT   NUMBER := 0;\n   BEGIN\n        SELECT   COUNT (1)\n          INTO   V_CNT\n          FROM   da238e96cf2cb791a097ca6946c096b4.1f9c921b05aafc28bf91547d5ec08a09 pri\n         WHERE       app_name = 'NON_SHIP_DIV'\n                 AND param_code = p_in_div_nbr\n                 AND CASE\n                       WHEN param_value_chr = 'DLY'\n                       THEN\n                          1\n                       WHEN param_value_chr = 'WK_DAY'\n                            AND TO_CHAR (SYSDATE, 'D') = param_type\n                       THEN\n                          1\n                    END = 1\n      ORDER BY   param_code;\n\n      IF V_CNT > 0\n      THEN\n         RETURN ('Y');\n      ELSE\n         RETURN ('N');\n      END IF;\n   EXCEPTION\n      WHEN OTHERS\n      THEN\n         DBMS_OUTPUT.PUT_LINE ('ERROR MESSAGE:' || SQLERRM);\n   END FN_CHK_NON_SHIP_DIV;\n\n   FUNCTION FN_CHK_NON_SHIP_DIV (P_IN_ODATE VARCHAR2, P_IN_DIV_NBR VARCHAR2)\n      RETURN VARCHAR2\n   IS\n      \n\n\n      V_CNT   NUMBER := 0;\n   BEGIN\n        SELECT   COUNT (1)\n          INTO   V_CNT\n          FROM   da238e96cf2cb791a097ca6946c096b4.1f9c921b05aafc28bf91547d5ec08a09 pri\n         WHERE       app_name = 'NON_SHIP_DIV'\n                 AND param_code = p_in_div_nbr\n                 AND CASE\n                       WHEN param_value_chr = 'DLY'\n                       THEN\n                          1\n                       WHEN param_value_chr = 'WK_DAY'\n                            AND TO_CHAR (TO_DATE (P_IN_ODATE, 'YYYYMMDD'), 'D') =\n                                  param_type\n                       THEN\n                          1\n                    END = 1\n      ORDER BY   param_code;\n\n      IF V_CNT > 0\n      THEN\n         RETURN ('Y');\n      ELSE\n         RETURN ('N');\n      END IF;\n   EXCEPTION\n      WHEN OTHERS\n      THEN\n         DBMS_OUTPUT.PUT_LINE ('ERROR MESSAGE:' || SQLERRM);\n   END FN_CHK_NON_SHIP_DIV;\nEND PKG_NON_SHIP_DIV;\n/",
            "upstream_dependencies": [],
            "downstream_dependencies": [],
            "dag_location": "null",
            "gantt_location": "null",
            "created_at": "null",
            "updated_at": "null"
        },
        {
            "name": "PKG_CPAT_MARKUP_PRICE_BASIS",
            "encrypted_name": "1b876f1061cd9941af8d7fd80a6be047de092c5a4c267643cf4f0e56dfb61562",
            "type": "package",
            "database": "null",
            "encrypted_database": "null",
            "schema": "XDMADM",
            "encrypted_schema": "da238e96cf2cb791a097ca6946c096b4",
            "fully_qualified_name": "XDMADM.PKG_CPAT_MARKUP_PRICE_BASIS",
            "encrypted_fqn": "da238e96cf2cb791a097ca6946c096b4.1b876f1061cd9941af8d7fd80a6be047de092c5a4c267643cf4f0e56dfb61562",
            "synonyms": [],
            "metadata_analysis": "CREATE OR REPLACE PACKAGE \"da238e96cf2cb791a097ca6946c096b4\".\"1b876f1061cd9941af8d7fd80a6be047de092c5a4c267643cf4f0e56dfb61562\" AS\n\n  \n FUNCTION fn_get_calculated_markup1(\n    prime_deviated_cost_type     IN VARCHAR2,\n    prime_markup_indicator       IN VARCHAR2,\n    each_shipped                 IN NUMBER,\n    vendor_inv_cost              IN NUMBER,\n    price_uom                    IN VARCHAR2,\n    sales_uom                    IN VARCHAR2,\n    margin                       IN NUMBER,\n    prime_contract_ea_markup_amt IN NUMBER,\n    UNFM_QTY_SHPD                IN NUMBER,\n    NET_WT_SHIPPED               IN NUMBER,\n    each_conv_fctr               IN NUMBER )\n   RETURN NUMBER DETERMINISTIC PARALLEL_ENABLE;\n\n   FUNCTION fn_get_calculated_sell_price(\n    prime_deviated_cost_type IN VARCHAR2,\n    each_shpd                IN NUMBER,\n    vendor_inv_cost          IN NUMBER,\n    allowance                IN NUMBER,\n    calculated_markup        IN NUMBER,\n    DEV_COST                 IN NUMBER,\n    inv_freight              IN NUMBER,\n    each_conv_fctr           IN NUMBER,\n    price_uom                IN VARCHAR2 )\n   RETURN NUMBER DETERMINISTIC PARALLEL_ENABLE;\n\nEND PKG_CPAT_MARKUP_PRICE_BASIS;\n/\nCREATE OR REPLACE PACKAGE BODY \"da238e96cf2cb791a097ca6946c096b4\".\"1b876f1061cd9941af8d7fd80a6be047de092c5a4c267643cf4f0e56dfb61562\"\nAS\n\nFUNCTION fn_get_calculated_markup1(\n    prime_deviated_cost_type     IN VARCHAR2,\n    prime_markup_indicator       IN VARCHAR2,\n    each_shipped                 IN NUMBER,\n    vendor_inv_cost              IN NUMBER,\n    price_uom                    IN VARCHAR2,\n    sales_uom                    IN VARCHAR2,\n    margin                       IN NUMBER,\n    prime_contract_ea_markup_amt IN NUMBER,\n    UNFM_QTY_SHPD                IN NUMBER,\n    NET_WT_SHIPPED               IN NUMBER,\n    each_conv_fctr               IN NUMBER )\n  RETURN NUMBER DETERMINISTIC PARALLEL_ENABLE\nIS\n  \n  calculated_markup1 NUMBER;\nBEGIN\n  calculated_markup1 :=\n  CASE\n  WHEN prime_deviated_cost_type <> 'FX' OR prime_deviated_cost_type IS NULL THEN\n    CASE\n    WHEN prime_markup_indicator = 'P' OR prime_markup_indicator IS NULL THEN\n      CASE\n      WHEN each_shipped = 0 THEN\n        ((vendor_inv_cost * (margin / 100)))\n      WHEN each_shipped <> 0 THEN\n        CASE\n        WHEN sales_uom = 'EA' AND price_uom = 'EA' THEN\n          (vendor_inv_cost * (margin / 100)) + prime_contract_ea_markup_amt\n        WHEN sales_uom = 'CS' AND price_uom = 'LB' THEN\n          (vendor_inv_cost * (margin / 100)) + prime_contract_ea_markup_amt\n        WHEN sales_uom = 'CS' AND price_uom = 'CS' THEN\n          CASE WHEN each_conv_fctr = 0 THEN prime_contract_ea_markup_amt ELSE\n            (vendor_inv_cost * (margin / 100)) / each_conv_fctr + prime_contract_ea_markup_amt\n          END\n        WHEN sales_uom = 'EA' AND price_uom = 'CS' THEN\n          CASE WHEN each_conv_fctr = 0 THEN prime_contract_ea_markup_amt ELSE\n            (vendor_inv_cost * (margin / 100)) / each_conv_fctr + prime_contract_ea_markup_amt\n          END\n        END\n      END\n    ELSE\n      CASE\n      WHEN prime_markup_indicator = '#' THEN\n        CASE\n        WHEN price_uom = 'LB' THEN\n          margin\n        ELSE\n          CASE WHEN UNFM_QTY_SHPD = 0 THEN 0 ELSE\n          (NET_WT_SHIPPED / UNFM_QTY_SHPD) * margin\n          END\n        END\n      WHEN prime_markup_indicator = 'D' THEN\n        margin\n      END\n    END\n  ELSE\n    0\n  END;\n  RETURN(NVL(calculated_markup1,0));\nEND;\n\nFUNCTION fn_get_calculated_sell_price(\n    prime_deviated_cost_type IN VARCHAR2,\n    each_shpd                IN NUMBER,\n    vendor_inv_cost          IN NUMBER,\n    allowance                IN NUMBER,\n    calculated_markup        IN NUMBER,\n    DEV_COST                 IN NUMBER,\n    inv_freight              IN NUMBER,\n    each_conv_fctr           IN NUMBER,\n    price_uom                IN VARCHAR2 )\n  RETURN NUMBER DETERMINISTIC PARALLEL_ENABLE\nIS\n  \n  calculated_sell_price NUMBER;\nBEGIN\n  calculated_sell_price :=\n  CASE\n  WHEN each_shpd = 0 THEN\n    CASE\n    WHEN prime_deviated_cost_type = 'AL' THEN\n      vendor_inv_cost + allowance + calculated_markup\n    WHEN prime_deviated_cost_type = 'D' THEN\n      DEV_COST + calculated_markup\n    WHEN prime_deviated_cost_type = 'F' THEN\n      DEV_COST + inv_freight + calculated_markup\n    WHEN prime_deviated_cost_type = 'FX' THEN\n      DEV_COST\n    WHEN prime_deviated_cost_type IS NULL THEN\n      vendor_inv_cost + calculated_markup\n    END\n  ELSE\n    CASE\n    WHEN prime_deviated_cost_type = 'AL' THEN\n      CASE\n      WHEN price_uom      IN ('EA', 'CS') THEN\n        CASE WHEN each_conv_fctr = 0 THEN calculated_markup ELSE\n          (((vendor_inv_cost + allowance) / each_conv_fctr) + calculated_markup)\n        END\n      WHEN price_uom = 'LB' THEN\n        vendor_inv_cost + allowance + calculated_markup\n      END\n    WHEN prime_deviated_cost_type = 'D' THEN\n      CASE WHEN each_conv_fctr = 0 THEN calculated_markup ELSE\n        (DEV_COST / each_conv_fctr) + calculated_markup\n      END\n    WHEN prime_deviated_cost_type = 'F' THEN\n      CASE WHEN each_conv_fctr = 0 THEN calculated_markup ELSE\n       ( ( DEV_COST + inv_freight) / each_conv_fctr) + calculated_markup\n      END\n    WHEN prime_deviated_cost_type = 'FX' THEN\n      CASE WHEN each_conv_fctr = 0 THEN 0 ELSE\n        DEV_COST / each_conv_fctr\n      END\n    WHEN prime_deviated_cost_type IS NULL THEN\n      CASE WHEN each_conv_fctr = 0 THEN calculated_markup ELSE\n        (vendor_inv_cost / each_conv_fctr) + calculated_markup\n      END\n    END\n  END ;\n  RETURN(NVL(calculated_sell_price,0));\nEND;\n\nEND PKG_CPAT_MARKUP_PRICE_BASIS;\n/",
            "upstream_dependencies": [],
            "downstream_dependencies": [],
            "dag_location": "null",
            "gantt_location": "null",
            "created_at": "null",
            "updated_at": "null"
        },
        {
            "name": "PKG_FWB_CMDTY",
            "encrypted_name": "944be2d86896c962a6664ca50d173cc0",
            "type": "package",
            "database": "null",
            "encrypted_database": "null",
            "schema": "XDMADM",
            "encrypted_schema": "da238e96cf2cb791a097ca6946c096b4",
            "fully_qualified_name": "XDMADM.PKG_FWB_CMDTY",
            "encrypted_fqn": "da238e96cf2cb791a097ca6946c096b4.944be2d86896c962a6664ca50d173cc0",
            "synonyms": [],
            "metadata_analysis": "CREATE OR REPLACE PACKAGE \"da238e96cf2cb791a097ca6946c096b4\".\"944be2d86896c962a6664ca50d173cc0\" IS\n   c_success   CONSTANT NUMBER := 0;\n   c_error     CONSTANT NUMBER := 1;\n\n   FUNCTION fn_fwb_mdl_bridge_cmdty_load(p_odate IN VARCHAR2)\n      RETURN NUMBER;\n\n   FUNCTION fn_fwb_mdl_cmdty_updt(p_odate IN VARCHAR2)\n      RETURN NUMBER;\n\n   FUNCTION get_opn_po_lic(p_prod_nbr     IN VARCHAR2,\n                           p_div_nbr      IN NUMBER,\n                           p_arvl_dt      IN DATE)\n      RETURN NUMBER;\nEND pkg_fwb_cmdty;\n/\nCREATE OR REPLACE PACKAGE BODY \"da238e96cf2cb791a097ca6946c096b4\".\"944be2d86896c962a6664ca50d173cc0\" IS\n   FUNCTION fn_fwb_mdl_bridge_cmdty_load(p_odate IN VARCHAR2)\n      RETURN NUMBER IS\n      \n\n      l_eff_dt        DATE;\n      l_odate         DATE := TO_DATE(p_odate, 'YYYYMMDD');\n      l_wk_strt_day   NUMBER;\n\n      \n      CURSOR c_rcvd_pos IS\n         SELECT 57eef8c3d4a13d22f0b40f9742e7b281.eaa994fe322caac69f400ab06d8ecace.0d87b59f7e55e64a6aa535e163a294d0,\n                57eef8c3d4a13d22f0b40f9742e7b281.eaa994fe322caac69f400ab06d8ecace.5a8103ceb3eda727eed8d3dbc244a027,\n                57eef8c3d4a13d22f0b40f9742e7b281.eaa994fe322caac69f400ab06d8ecace.9d0604c46c7fc3d284e860c5703e30e5,\n                57eef8c3d4a13d22f0b40f9742e7b281.eaa994fe322caac69f400ab06d8ecace.4cb02d50e00c65fc5d70b5e7e2795357,\n\n               ((57eef8c3d4a13d22f0b40f9742e7b281.c0fb76e4cf5f001346b40cb85ab28000dc6f5ca1708e344e69efddbfaa5cf464.2c57d1f0db5e6b1fcdee819eed969f1c * decode(5a65488ae2879caea5de6f87724a1922.c677121a99c5d342ae692d86efc6bc94 ,'Y',2896773d943697f2aca0ac52cc665e1d.44efb77cae84aa2abbd29c787a6b1e3c,1)) * (57eef8c3d4a13d22f0b40f9742e7b281.eaa994fe322caac69f400ab06d8ecace.ee6d33bbed4b71298a519f4d61c0ff3a0b926620744a8f42b00b6b1074a3564f - 57eef8c3d4a13d22f0b40f9742e7b281.c0fb76e4cf5f001346b40cb85ab28000dc6f5ca1708e344e69efddbfaa5cf464.2307e44a5b12c7ca59ade961452e2122)) invnty_gain_loss\n           FROM 57eef8c3d4a13d22f0b40f9742e7b281.eaa994fe322caac69f400ab06d8ecace po, 57eef8c3d4a13d22f0b40f9742e7b281.c0fb76e4cf5f001346b40cb85ab28000dc6f5ca1708e344e69efddbfaa5cf464 inv, 57eef8c3d4a13d22f0b40f9742e7b281.fadb8b76a21d0037200f1f2222239841 pr\n          WHERE 57eef8c3d4a13d22f0b40f9742e7b281.eaa994fe322caac69f400ab06d8ecace.8e296af0709009f4cb601a563ab2e022 = 'PR'\n            AND 57eef8c3d4a13d22f0b40f9742e7b281.eaa994fe322caac69f400ab06d8ecace.9d0604c46c7fc3d284e860c5703e30e5 = 57eef8c3d4a13d22f0b40f9742e7b281.c0fb76e4cf5f001346b40cb85ab28000dc6f5ca1708e344e69efddbfaa5cf464.9d0604c46c7fc3d284e860c5703e30e5\n            AND 57eef8c3d4a13d22f0b40f9742e7b281.eaa994fe322caac69f400ab06d8ecace.5a8103ceb3eda727eed8d3dbc244a027 = 57eef8c3d4a13d22f0b40f9742e7b281.c0fb76e4cf5f001346b40cb85ab28000dc6f5ca1708e344e69efddbfaa5cf464.5a8103ceb3eda727eed8d3dbc244a027\n            AND 57eef8c3d4a13d22f0b40f9742e7b281.eaa994fe322caac69f400ab06d8ecace.5a8103ceb3eda727eed8d3dbc244a027 = 57eef8c3d4a13d22f0b40f9742e7b281.fadb8b76a21d0037200f1f2222239841.5a8103ceb3eda727eed8d3dbc244a027\n            AND 57eef8c3d4a13d22f0b40f9742e7b281.eaa994fe322caac69f400ab06d8ecace.9d0604c46c7fc3d284e860c5703e30e5 = 57eef8c3d4a13d22f0b40f9742e7b281.fadb8b76a21d0037200f1f2222239841.9d0604c46c7fc3d284e860c5703e30e5\n            AND 57eef8c3d4a13d22f0b40f9742e7b281.c0fb76e4cf5f001346b40cb85ab28000dc6f5ca1708e344e69efddbfaa5cf464.0616929b5e372c58fe6f173176e49c11 = 57eef8c3d4a13d22f0b40f9742e7b281.eaa994fe322caac69f400ab06d8ecace.4cb02d50e00c65fc5d70b5e7e2795357 - 1\n            AND EXISTS (SELECT 'X'\n                          FROM 57eef8c3d4a13d22f0b40f9742e7b281.e96e2363b3f0b483f6c6bac06cbce70c brg, 57eef8c3d4a13d22f0b40f9742e7b281.4494394bdae57ac129f3f9c8d6b432a8 fwb\n                         WHERE 57eef8c3d4a13d22f0b40f9742e7b281.4494394bdae57ac129f3f9c8d6b432a8.9d0604c46c7fc3d284e860c5703e30e5 = 57eef8c3d4a13d22f0b40f9742e7b281.e96e2363b3f0b483f6c6bac06cbce70c.9d0604c46c7fc3d284e860c5703e30e5\n                           AND 57eef8c3d4a13d22f0b40f9742e7b281.4494394bdae57ac129f3f9c8d6b432a8.5a8103ceb3eda727eed8d3dbc244a027 = 57eef8c3d4a13d22f0b40f9742e7b281.e96e2363b3f0b483f6c6bac06cbce70c.5a8103ceb3eda727eed8d3dbc244a027\n                           AND 57eef8c3d4a13d22f0b40f9742e7b281.4494394bdae57ac129f3f9c8d6b432a8.b039fac464493012dbb8c802e0c5f1b3 = 57eef8c3d4a13d22f0b40f9742e7b281.e96e2363b3f0b483f6c6bac06cbce70c.b039fac464493012dbb8c802e0c5f1b3\n                           AND 57eef8c3d4a13d22f0b40f9742e7b281.e96e2363b3f0b483f6c6bac06cbce70c.0d87b59f7e55e64a6aa535e163a294d0 = 57eef8c3d4a13d22f0b40f9742e7b281.eaa994fe322caac69f400ab06d8ecace.0d87b59f7e55e64a6aa535e163a294d0\n                           AND 57eef8c3d4a13d22f0b40f9742e7b281.e96e2363b3f0b483f6c6bac06cbce70c.5a8103ceb3eda727eed8d3dbc244a027 = 57eef8c3d4a13d22f0b40f9742e7b281.eaa994fe322caac69f400ab06d8ecace.5a8103ceb3eda727eed8d3dbc244a027\n                           AND TRUNC(57eef8c3d4a13d22f0b40f9742e7b281.e96e2363b3f0b483f6c6bac06cbce70c.4cb02d50e00c65fc5d70b5e7e2795357) = TO_DATE('01-01-1900', 'DD-MM-YYYY')\n                           AND 57eef8c3d4a13d22f0b40f9742e7b281.4494394bdae57ac129f3f9c8d6b432a8.6826ace148031485490ab3facb2a3938 = 'WEEKLY');\n\n      TYPE t_rcvd_pos IS TABLE OF c_rcvd_pos%ROWTYPE;\n\n      r_rcvd_pos      t_rcvd_pos;\n   BEGIN\n      DBMS_OUTPUT.put_line('Order Date: ' || l_odate);\n\n      \n      SELECT param_value_nbr\n        INTO l_wk_strt_day\n        FROM 57eef8c3d4a13d22f0b40f9742e7b281.1f9c921b05aafc28bf91547d5ec08a09\n       WHERE app_name = 'FORWARD_BUY'\n         AND param_type = 'CMTY_GUIDANCE_WK'\n         AND param_code = 'STRT_DAY';\n\n      SELECT MAX(clndr_dt)\n        INTO l_eff_dt\n        FROM 57eef8c3d4a13d22f0b40f9742e7b281.a2349118cac55136943abdf2d397e141\n       WHERE TO_CHAR(clndr_dt, 'D') = l_wk_strt_day\n         AND clndr_dt <= l_odate;\n\n      DBMS_OUTPUT.put_line('Effective Date: ' || l_eff_dt);\n\n      DBMS_OUTPUT.put_line('Starting Merge from OPO_CORP');\n\n      \n      MERGE INTO 57eef8c3d4a13d22f0b40f9742e7b281.e96e2363b3f0b483f6c6bac06cbce70c brg\n           USING (SELECT 77a997c3cbb9086632d798ea139ef3db.5a8103ceb3eda727eed8d3dbc244a027,\n                         TO_DATE('01-01-1900', 'DD-MM-YYYY') po_rcvd_dt,\n                         57eef8c3d4a13d22f0b40f9742e7b281.9b750ec2007bde96270d1d7b1f9580ae.0d87b59f7e55e64a6aa535e163a294d0,\n                         77a997c3cbb9086632d798ea139ef3db.9d0604c46c7fc3d284e860c5703e30e5,\n                         57eef8c3d4a13d22f0b40f9742e7b281.9b750ec2007bde96270d1d7b1f9580ae.4b59171098890bad2dce8062e2c004d0,\n                         57eef8c3d4a13d22f0b40f9742e7b281.9b750ec2007bde96270d1d7b1f9580ae.b37e525777403fb0c0cfa2cab3876994,\n                         77a997c3cbb9086632d798ea139ef3db.b039fac464493012dbb8c802e0c5f1b3,\n                         77a997c3cbb9086632d798ea139ef3db.035f18dd3f4744cbba3d3c0e867e72ed,\n                         77a997c3cbb9086632d798ea139ef3db.a0cb4fc179140ff174fbd1682dc451a253bf80c2794394a9e4fc91b08ae828cc,\n                         77a997c3cbb9086632d798ea139ef3db.68080a9a39ec1f932c8217dea347114bee40e9daeb1770b740e44d126ed089be,\n                         57eef8c3d4a13d22f0b40f9742e7b281.9b750ec2007bde96270d1d7b1f9580ae.d79dda76c8a6bcffecc087ec1131c985,\n                         57eef8c3d4a13d22f0b40f9742e7b281.9b750ec2007bde96270d1d7b1f9580ae.2a1a6bf6d59791c2deab38f31ad1af48,\n                         'X' po_cnfrm_on_tm,\n                         NVL(57eef8c3d4a13d22f0b40f9742e7b281.9b750ec2007bde96270d1d7b1f9580ae.88e8ca78a7ac9f877493b8f7921848a5, 0) cnfrm_qty_ord,\n                         'OPO_CORP' fwb_trans_typ,\n                         SYSDATE fwb_last_updt_dt,\n                         TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS') ldr_tm,\n                         \n                         CASE\n                            WHEN (  NVL(57eef8c3d4a13d22f0b40f9742e7b281.fadb8b76a21d0037200f1f2222239841.424c463cfee8bf6e0e7f0af89a2a6d99, 0)\n                                  + (SELECT NVL(SUM(ttl_qty_ord), 0)\n                                       FROM 57eef8c3d4a13d22f0b40f9742e7b281.9b750ec2007bde96270d1d7b1f9580ae\n                                      WHERE prod_nbr = 57eef8c3d4a13d22f0b40f9742e7b281.9b750ec2007bde96270d1d7b1f9580ae.9d0604c46c7fc3d284e860c5703e30e5\n                                        AND div_nbr = 57eef8c3d4a13d22f0b40f9742e7b281.9b750ec2007bde96270d1d7b1f9580ae.5a8103ceb3eda727eed8d3dbc244a027\n                                        AND arvl_dt < 57eef8c3d4a13d22f0b40f9742e7b281.9b750ec2007bde96270d1d7b1f9580ae.2a1a6bf6d59791c2deab38f31ad1af48)\n                                  - NVL(57eef8c3d4a13d22f0b40f9742e7b281.fadb8b76a21d0037200f1f2222239841.0c6006dfe1273fdfc6156477e50d71a8, 0)\n                                  - (CASE WHEN 57eef8c3d4a13d22f0b40f9742e7b281.9b750ec2007bde96270d1d7b1f9580ae.2a1a6bf6d59791c2deab38f31ad1af48 < l_odate THEN 0 ELSE (57eef8c3d4a13d22f0b40f9742e7b281.9b750ec2007bde96270d1d7b1f9580ae.2a1a6bf6d59791c2deab38f31ad1af48 - l_odate) END\n                                     * (nvl(77a997c3cbb9086632d798ea139ef3db.9a23a4024ea9389918e94be7794b19b6,0) / 7))) < 0 THEN  \n                               0\n                            ELSE\n                               (  NVL(57eef8c3d4a13d22f0b40f9742e7b281.fadb8b76a21d0037200f1f2222239841.424c463cfee8bf6e0e7f0af89a2a6d99, 0)\n                                + (SELECT NVL(SUM(ttl_qty_ord), 0)\n                                     FROM 57eef8c3d4a13d22f0b40f9742e7b281.9b750ec2007bde96270d1d7b1f9580ae\n                                    WHERE prod_nbr = 57eef8c3d4a13d22f0b40f9742e7b281.9b750ec2007bde96270d1d7b1f9580ae.9d0604c46c7fc3d284e860c5703e30e5\n                                      AND div_nbr = 57eef8c3d4a13d22f0b40f9742e7b281.9b750ec2007bde96270d1d7b1f9580ae.5a8103ceb3eda727eed8d3dbc244a027\n                                      AND arvl_dt < 57eef8c3d4a13d22f0b40f9742e7b281.9b750ec2007bde96270d1d7b1f9580ae.2a1a6bf6d59791c2deab38f31ad1af48)\n                                - NVL(57eef8c3d4a13d22f0b40f9742e7b281.fadb8b76a21d0037200f1f2222239841.0c6006dfe1273fdfc6156477e50d71a8, 0)\n                                - (CASE WHEN 57eef8c3d4a13d22f0b40f9742e7b281.9b750ec2007bde96270d1d7b1f9580ae.2a1a6bf6d59791c2deab38f31ad1af48 < l_odate THEN 0 ELSE (57eef8c3d4a13d22f0b40f9742e7b281.9b750ec2007bde96270d1d7b1f9580ae.2a1a6bf6d59791c2deab38f31ad1af48 - l_odate) END\n                                   * (nvl(77a997c3cbb9086632d798ea139ef3db.9a23a4024ea9389918e94be7794b19b6,0) / 7))) * decode(5a65488ae2879caea5de6f87724a1922.c677121a99c5d342ae692d86efc6bc94 ,'Y',03efec6fc33aee2b402a21cfad233a1d.44efb77cae84aa2abbd29c787a6b1e3c,1)  \n                               * (57eef8c3d4a13d22f0b40f9742e7b281.9b750ec2007bde96270d1d7b1f9580ae.ee6d33bbed4b71298a519f4d61c0ff3a0b926620744a8f42b00b6b1074a3564f - get_opn_po_lic(57eef8c3d4a13d22f0b40f9742e7b281.9b750ec2007bde96270d1d7b1f9580ae.9d0604c46c7fc3d284e860c5703e30e5, 57eef8c3d4a13d22f0b40f9742e7b281.9b750ec2007bde96270d1d7b1f9580ae.5a8103ceb3eda727eed8d3dbc244a027, 57eef8c3d4a13d22f0b40f9742e7b281.9b750ec2007bde96270d1d7b1f9580ae.2a1a6bf6d59791c2deab38f31ad1af48))\n                         END\n                            invnty_gain_loss,\n                         57eef8c3d4a13d22f0b40f9742e7b281.9b750ec2007bde96270d1d7b1f9580ae.94bd0bf344ba2b6661ea81d13b5de86a,\n                         57eef8c3d4a13d22f0b40f9742e7b281.9b750ec2007bde96270d1d7b1f9580ae.79c92c82c2720267016a18829db4755a po_cnfrm_dt\n                    FROM 57eef8c3d4a13d22f0b40f9742e7b281.4494394bdae57ac129f3f9c8d6b432a8 mdl, 57eef8c3d4a13d22f0b40f9742e7b281.9b750ec2007bde96270d1d7b1f9580ae po, 57eef8c3d4a13d22f0b40f9742e7b281.fadb8b76a21d0037200f1f2222239841 prod\n                   WHERE 77a997c3cbb9086632d798ea139ef3db.9d0604c46c7fc3d284e860c5703e30e5 = 57eef8c3d4a13d22f0b40f9742e7b281.9b750ec2007bde96270d1d7b1f9580ae.9d0604c46c7fc3d284e860c5703e30e5\n                     AND 77a997c3cbb9086632d798ea139ef3db.5a8103ceb3eda727eed8d3dbc244a027 = 57eef8c3d4a13d22f0b40f9742e7b281.9b750ec2007bde96270d1d7b1f9580ae.5a8103ceb3eda727eed8d3dbc244a027\n                     AND 77a997c3cbb9086632d798ea139ef3db.9d0604c46c7fc3d284e860c5703e30e5 = 57eef8c3d4a13d22f0b40f9742e7b281.fadb8b76a21d0037200f1f2222239841.9d0604c46c7fc3d284e860c5703e30e5\n                     AND 77a997c3cbb9086632d798ea139ef3db.5a8103ceb3eda727eed8d3dbc244a027 = 57eef8c3d4a13d22f0b40f9742e7b281.fadb8b76a21d0037200f1f2222239841.5a8103ceb3eda727eed8d3dbc244a027\n                     AND 77a997c3cbb9086632d798ea139ef3db.6826ace148031485490ab3facb2a3938 = 'WEEKLY'\n                     AND 77a997c3cbb9086632d798ea139ef3db.035f18dd3f4744cbba3d3c0e867e72ed >= l_eff_dt - 14\n                     AND 57eef8c3d4a13d22f0b40f9742e7b281.9b750ec2007bde96270d1d7b1f9580ae.94bd0bf344ba2b6661ea81d13b5de86a BETWEEN 77a997c3cbb9086632d798ea139ef3db.035f18dd3f4744cbba3d3c0e867e72ed AND 77a997c3cbb9086632d798ea139ef3db.035f18dd3f4744cbba3d3c0e867e72ed + 6\n                     AND 57eef8c3d4a13d22f0b40f9742e7b281.9b750ec2007bde96270d1d7b1f9580ae.10610f3d34f5bdc724f75441c5eb6e1e > 0) mdl\n              ON (ac9da67460afadceab39d5d53cf913ef.0d87b59f7e55e64a6aa535e163a294d0 = 77a997c3cbb9086632d798ea139ef3db.0d87b59f7e55e64a6aa535e163a294d0\n              AND ac9da67460afadceab39d5d53cf913ef.9d0604c46c7fc3d284e860c5703e30e5 = 77a997c3cbb9086632d798ea139ef3db.9d0604c46c7fc3d284e860c5703e30e5\n              AND ac9da67460afadceab39d5d53cf913ef.5a8103ceb3eda727eed8d3dbc244a027 = 77a997c3cbb9086632d798ea139ef3db.5a8103ceb3eda727eed8d3dbc244a027\n              AND ac9da67460afadceab39d5d53cf913ef.035f18dd3f4744cbba3d3c0e867e72ed = 77a997c3cbb9086632d798ea139ef3db.035f18dd3f4744cbba3d3c0e867e72ed\n              AND ac9da67460afadceab39d5d53cf913ef.b039fac464493012dbb8c802e0c5f1b3 = 77a997c3cbb9086632d798ea139ef3db.b039fac464493012dbb8c802e0c5f1b3\n              \n              \n              \n              )\n      WHEN MATCHED THEN\n         UPDATE SET ac9da67460afadceab39d5d53cf913ef.4cb02d50e00c65fc5d70b5e7e2795357           = 77a997c3cbb9086632d798ea139ef3db.4cb02d50e00c65fc5d70b5e7e2795357,\n                    ac9da67460afadceab39d5d53cf913ef.b37e525777403fb0c0cfa2cab3876994              = 77a997c3cbb9086632d798ea139ef3db.b37e525777403fb0c0cfa2cab3876994,\n                    ac9da67460afadceab39d5d53cf913ef.68080a9a39ec1f932c8217dea347114bee40e9daeb1770b740e44d126ed089be   = 77a997c3cbb9086632d798ea139ef3db.68080a9a39ec1f932c8217dea347114bee40e9daeb1770b740e44d126ed089be,\n                    ac9da67460afadceab39d5d53cf913ef.d79dda76c8a6bcffecc087ec1131c985         = 77a997c3cbb9086632d798ea139ef3db.d79dda76c8a6bcffecc087ec1131c985,\n                    ac9da67460afadceab39d5d53cf913ef.2a1a6bf6d59791c2deab38f31ad1af48              = 77a997c3cbb9086632d798ea139ef3db.2a1a6bf6d59791c2deab38f31ad1af48,\n                    ac9da67460afadceab39d5d53cf913ef.4398bb53267f1843d24c415dc779d7c1       = 77a997c3cbb9086632d798ea139ef3db.4398bb53267f1843d24c415dc779d7c1,\n                    ac9da67460afadceab39d5d53cf913ef.88e8ca78a7ac9f877493b8f7921848a5        = 77a997c3cbb9086632d798ea139ef3db.88e8ca78a7ac9f877493b8f7921848a5,\n                    ac9da67460afadceab39d5d53cf913ef.86b9e982eb5cb3f0040bc18a472e7df5        = 77a997c3cbb9086632d798ea139ef3db.86b9e982eb5cb3f0040bc18a472e7df5,\n                    ac9da67460afadceab39d5d53cf913ef.648a7217ad6540648271b813fedefc9153a0c0fe76045acdb204ca36f43c8ecf     = 77a997c3cbb9086632d798ea139ef3db.648a7217ad6540648271b813fedefc9153a0c0fe76045acdb204ca36f43c8ecf,\n                    ac9da67460afadceab39d5d53cf913ef.1cdbb93df2e7e062ae4cf6bcf2b9474753a0c0fe76045acdb204ca36f43c8ecf     = 77a997c3cbb9086632d798ea139ef3db.1cdbb93df2e7e062ae4cf6bcf2b9474753a0c0fe76045acdb204ca36f43c8ecf,\n                    ac9da67460afadceab39d5d53cf913ef.94bd0bf344ba2b6661ea81d13b5de86a               = 77a997c3cbb9086632d798ea139ef3db.94bd0bf344ba2b6661ea81d13b5de86a,\n                    ac9da67460afadceab39d5d53cf913ef.ec0bd64971a7e3dc3bd60fa2a57bebab          = 77a997c3cbb9086632d798ea139ef3db.ec0bd64971a7e3dc3bd60fa2a57bebab\n      WHEN NOT MATCHED THEN\n         INSERT            (div_nbr, po_rcvd_dt, po_nbr, prod_nbr, line_nbr, prcs_dt,\n                            fwb_cyc_id, eff_dt, pim_usf_std_prod_cd, prch_from_vndr_nbr, po_cnfrm_ind, arvl_dt,\n                            po_cnfrm_on_tm, cnfrm_qty_ord, fwb_trans_typ, fwb_last_updt_dt, ldr_tm, invnty_gain_loss,\n                            ord_dt, po_cnfrm_dt)\n             VALUES (77a997c3cbb9086632d798ea139ef3db.5a8103ceb3eda727eed8d3dbc244a027,\n                     77a997c3cbb9086632d798ea139ef3db.4cb02d50e00c65fc5d70b5e7e2795357,\n                     77a997c3cbb9086632d798ea139ef3db.0d87b59f7e55e64a6aa535e163a294d0,\n                     77a997c3cbb9086632d798ea139ef3db.9d0604c46c7fc3d284e860c5703e30e5,\n                     77a997c3cbb9086632d798ea139ef3db.4b59171098890bad2dce8062e2c004d0,\n                     77a997c3cbb9086632d798ea139ef3db.b37e525777403fb0c0cfa2cab3876994,\n                     77a997c3cbb9086632d798ea139ef3db.b039fac464493012dbb8c802e0c5f1b3,\n                     77a997c3cbb9086632d798ea139ef3db.035f18dd3f4744cbba3d3c0e867e72ed,\n                     77a997c3cbb9086632d798ea139ef3db.a0cb4fc179140ff174fbd1682dc451a253bf80c2794394a9e4fc91b08ae828cc,\n                     77a997c3cbb9086632d798ea139ef3db.68080a9a39ec1f932c8217dea347114bee40e9daeb1770b740e44d126ed089be,\n                     77a997c3cbb9086632d798ea139ef3db.d79dda76c8a6bcffecc087ec1131c985,\n                     77a997c3cbb9086632d798ea139ef3db.2a1a6bf6d59791c2deab38f31ad1af48,\n                     77a997c3cbb9086632d798ea139ef3db.4398bb53267f1843d24c415dc779d7c1,\n                     77a997c3cbb9086632d798ea139ef3db.88e8ca78a7ac9f877493b8f7921848a5,\n                     77a997c3cbb9086632d798ea139ef3db.86b9e982eb5cb3f0040bc18a472e7df5,\n                     77a997c3cbb9086632d798ea139ef3db.648a7217ad6540648271b813fedefc9153a0c0fe76045acdb204ca36f43c8ecf,\n                     77a997c3cbb9086632d798ea139ef3db.1f0f2abf63196db2770aedbe59e6cb12,\n                     77a997c3cbb9086632d798ea139ef3db.1cdbb93df2e7e062ae4cf6bcf2b9474753a0c0fe76045acdb204ca36f43c8ecf,\n                     77a997c3cbb9086632d798ea139ef3db.94bd0bf344ba2b6661ea81d13b5de86a,\n                     77a997c3cbb9086632d798ea139ef3db.ec0bd64971a7e3dc3bd60fa2a57bebab);\n\n      DBMS_OUTPUT.put_line('Merged from OPO_CORP ' || sql%ROWCOUNT || ' rows');\n\n      \n      MERGE INTO 57eef8c3d4a13d22f0b40f9742e7b281.e96e2363b3f0b483f6c6bac06cbce70c brg\n           USING (SELECT 77a997c3cbb9086632d798ea139ef3db.5a8103ceb3eda727eed8d3dbc244a027,\n                         57eef8c3d4a13d22f0b40f9742e7b281.eaa994fe322caac69f400ab06d8ecace.4cb02d50e00c65fc5d70b5e7e2795357,\n                         57eef8c3d4a13d22f0b40f9742e7b281.eaa994fe322caac69f400ab06d8ecace.0d87b59f7e55e64a6aa535e163a294d0,\n                         77a997c3cbb9086632d798ea139ef3db.9d0604c46c7fc3d284e860c5703e30e5,\n                         57eef8c3d4a13d22f0b40f9742e7b281.eaa994fe322caac69f400ab06d8ecace.4b59171098890bad2dce8062e2c004d0,\n                         57eef8c3d4a13d22f0b40f9742e7b281.eaa994fe322caac69f400ab06d8ecace.b37e525777403fb0c0cfa2cab3876994,\n                         77a997c3cbb9086632d798ea139ef3db.b039fac464493012dbb8c802e0c5f1b3,\n                         77a997c3cbb9086632d798ea139ef3db.035f18dd3f4744cbba3d3c0e867e72ed,\n                         77a997c3cbb9086632d798ea139ef3db.a0cb4fc179140ff174fbd1682dc451a253bf80c2794394a9e4fc91b08ae828cc,\n                         77a997c3cbb9086632d798ea139ef3db.68080a9a39ec1f932c8217dea347114bee40e9daeb1770b740e44d126ed089be,\n                         57eef8c3d4a13d22f0b40f9742e7b281.eaa994fe322caac69f400ab06d8ecace.d79dda76c8a6bcffecc087ec1131c985,\n                         57eef8c3d4a13d22f0b40f9742e7b281.eaa994fe322caac69f400ab06d8ecace.2a1a6bf6d59791c2deab38f31ad1af48,\n                         'X' po_cnfrm_on_tm,\n                         NVL(57eef8c3d4a13d22f0b40f9742e7b281.eaa994fe322caac69f400ab06d8ecace.88e8ca78a7ac9f877493b8f7921848a5, 0) cnfrm_qty_ord,\n                         'PO_CORP' fwb_trans_typ,\n                         SYSDATE fwb_last_updt_dt,\n                         TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS') ldr_tm,\n\n                        ((57eef8c3d4a13d22f0b40f9742e7b281.c0fb76e4cf5f001346b40cb85ab28000dc6f5ca1708e344e69efddbfaa5cf464.2c57d1f0db5e6b1fcdee819eed969f1c * decode(5a65488ae2879caea5de6f87724a1922.c677121a99c5d342ae692d86efc6bc94 ,'Y',03efec6fc33aee2b402a21cfad233a1d.44efb77cae84aa2abbd29c787a6b1e3c,1))  * (57eef8c3d4a13d22f0b40f9742e7b281.eaa994fe322caac69f400ab06d8ecace.ee6d33bbed4b71298a519f4d61c0ff3a0b926620744a8f42b00b6b1074a3564f - 57eef8c3d4a13d22f0b40f9742e7b281.c0fb76e4cf5f001346b40cb85ab28000dc6f5ca1708e344e69efddbfaa5cf464.2307e44a5b12c7ca59ade961452e2122)) invnty_gain_loss,\n                         57eef8c3d4a13d22f0b40f9742e7b281.eaa994fe322caac69f400ab06d8ecace.94bd0bf344ba2b6661ea81d13b5de86a,\n                         57eef8c3d4a13d22f0b40f9742e7b281.eaa994fe322caac69f400ab06d8ecace.79c92c82c2720267016a18829db4755a po_cnfrm_dt\n                    FROM 57eef8c3d4a13d22f0b40f9742e7b281.4494394bdae57ac129f3f9c8d6b432a8 mdl,\n                         57eef8c3d4a13d22f0b40f9742e7b281.eaa994fe322caac69f400ab06d8ecace po,\n                         57eef8c3d4a13d22f0b40f9742e7b281.fadb8b76a21d0037200f1f2222239841 prod,\n                         57eef8c3d4a13d22f0b40f9742e7b281.c0fb76e4cf5f001346b40cb85ab28000dc6f5ca1708e344e69efddbfaa5cf464 inv\n                   WHERE 77a997c3cbb9086632d798ea139ef3db.9d0604c46c7fc3d284e860c5703e30e5 = 57eef8c3d4a13d22f0b40f9742e7b281.eaa994fe322caac69f400ab06d8ecace.9d0604c46c7fc3d284e860c5703e30e5\n                     AND 77a997c3cbb9086632d798ea139ef3db.5a8103ceb3eda727eed8d3dbc244a027 = 57eef8c3d4a13d22f0b40f9742e7b281.eaa994fe322caac69f400ab06d8ecace.5a8103ceb3eda727eed8d3dbc244a027\n                     AND 77a997c3cbb9086632d798ea139ef3db.9d0604c46c7fc3d284e860c5703e30e5 = 57eef8c3d4a13d22f0b40f9742e7b281.fadb8b76a21d0037200f1f2222239841.9d0604c46c7fc3d284e860c5703e30e5\n                     AND 77a997c3cbb9086632d798ea139ef3db.5a8103ceb3eda727eed8d3dbc244a027 = 57eef8c3d4a13d22f0b40f9742e7b281.fadb8b76a21d0037200f1f2222239841.5a8103ceb3eda727eed8d3dbc244a027\n                     AND 77a997c3cbb9086632d798ea139ef3db.9d0604c46c7fc3d284e860c5703e30e5 = 57eef8c3d4a13d22f0b40f9742e7b281.c0fb76e4cf5f001346b40cb85ab28000dc6f5ca1708e344e69efddbfaa5cf464.9d0604c46c7fc3d284e860c5703e30e5\n                     AND 77a997c3cbb9086632d798ea139ef3db.5a8103ceb3eda727eed8d3dbc244a027 = 57eef8c3d4a13d22f0b40f9742e7b281.c0fb76e4cf5f001346b40cb85ab28000dc6f5ca1708e344e69efddbfaa5cf464.5a8103ceb3eda727eed8d3dbc244a027\n                     AND 57eef8c3d4a13d22f0b40f9742e7b281.c0fb76e4cf5f001346b40cb85ab28000dc6f5ca1708e344e69efddbfaa5cf464.0616929b5e372c58fe6f173176e49c11 = 57eef8c3d4a13d22f0b40f9742e7b281.eaa994fe322caac69f400ab06d8ecace.4cb02d50e00c65fc5d70b5e7e2795357 - 1\n                     AND 77a997c3cbb9086632d798ea139ef3db.6826ace148031485490ab3facb2a3938 = 'WEEKLY'\n                     AND 57eef8c3d4a13d22f0b40f9742e7b281.eaa994fe322caac69f400ab06d8ecace.8e296af0709009f4cb601a563ab2e022 = 'PR'\n                     AND 77a997c3cbb9086632d798ea139ef3db.035f18dd3f4744cbba3d3c0e867e72ed >= l_eff_dt - 14\n                     AND 57eef8c3d4a13d22f0b40f9742e7b281.eaa994fe322caac69f400ab06d8ecace.94bd0bf344ba2b6661ea81d13b5de86a BETWEEN 77a997c3cbb9086632d798ea139ef3db.035f18dd3f4744cbba3d3c0e867e72ed AND 77a997c3cbb9086632d798ea139ef3db.035f18dd3f4744cbba3d3c0e867e72ed + 6\n                     AND 57eef8c3d4a13d22f0b40f9742e7b281.eaa994fe322caac69f400ab06d8ecace.7305ef24a877840abddd9e26bcfdf10a > 0) mdl\n              ON (ac9da67460afadceab39d5d53cf913ef.0d87b59f7e55e64a6aa535e163a294d0 = 77a997c3cbb9086632d798ea139ef3db.0d87b59f7e55e64a6aa535e163a294d0\n              AND ac9da67460afadceab39d5d53cf913ef.9d0604c46c7fc3d284e860c5703e30e5 = 77a997c3cbb9086632d798ea139ef3db.9d0604c46c7fc3d284e860c5703e30e5\n              AND ac9da67460afadceab39d5d53cf913ef.5a8103ceb3eda727eed8d3dbc244a027 = 77a997c3cbb9086632d798ea139ef3db.5a8103ceb3eda727eed8d3dbc244a027\n              AND ac9da67460afadceab39d5d53cf913ef.035f18dd3f4744cbba3d3c0e867e72ed = 77a997c3cbb9086632d798ea139ef3db.035f18dd3f4744cbba3d3c0e867e72ed\n              AND ac9da67460afadceab39d5d53cf913ef.b039fac464493012dbb8c802e0c5f1b3 = 77a997c3cbb9086632d798ea139ef3db.b039fac464493012dbb8c802e0c5f1b3\n              \n              AND ac9da67460afadceab39d5d53cf913ef.4cb02d50e00c65fc5d70b5e7e2795357 = 77a997c3cbb9086632d798ea139ef3db.4cb02d50e00c65fc5d70b5e7e2795357\n              AND ac9da67460afadceab39d5d53cf913ef.4b59171098890bad2dce8062e2c004d0 = 77a997c3cbb9086632d798ea139ef3db.4b59171098890bad2dce8062e2c004d0\n              AND ac9da67460afadceab39d5d53cf913ef.b37e525777403fb0c0cfa2cab3876994 = 77a997c3cbb9086632d798ea139ef3db.b37e525777403fb0c0cfa2cab3876994\n              )\n      WHEN MATCHED THEN\n         UPDATE SET \n                    \n                    ac9da67460afadceab39d5d53cf913ef.68080a9a39ec1f932c8217dea347114bee40e9daeb1770b740e44d126ed089be   = 77a997c3cbb9086632d798ea139ef3db.68080a9a39ec1f932c8217dea347114bee40e9daeb1770b740e44d126ed089be,\n                    ac9da67460afadceab39d5d53cf913ef.d79dda76c8a6bcffecc087ec1131c985         = 77a997c3cbb9086632d798ea139ef3db.d79dda76c8a6bcffecc087ec1131c985,\n                    ac9da67460afadceab39d5d53cf913ef.2a1a6bf6d59791c2deab38f31ad1af48              = 77a997c3cbb9086632d798ea139ef3db.2a1a6bf6d59791c2deab38f31ad1af48,\n                    ac9da67460afadceab39d5d53cf913ef.4398bb53267f1843d24c415dc779d7c1       = 77a997c3cbb9086632d798ea139ef3db.4398bb53267f1843d24c415dc779d7c1,\n                    ac9da67460afadceab39d5d53cf913ef.88e8ca78a7ac9f877493b8f7921848a5        = 77a997c3cbb9086632d798ea139ef3db.88e8ca78a7ac9f877493b8f7921848a5,\n                    ac9da67460afadceab39d5d53cf913ef.86b9e982eb5cb3f0040bc18a472e7df5        = 77a997c3cbb9086632d798ea139ef3db.86b9e982eb5cb3f0040bc18a472e7df5,\n                    ac9da67460afadceab39d5d53cf913ef.648a7217ad6540648271b813fedefc9153a0c0fe76045acdb204ca36f43c8ecf     = 77a997c3cbb9086632d798ea139ef3db.648a7217ad6540648271b813fedefc9153a0c0fe76045acdb204ca36f43c8ecf,\n                    ac9da67460afadceab39d5d53cf913ef.1cdbb93df2e7e062ae4cf6bcf2b9474753a0c0fe76045acdb204ca36f43c8ecf     = 77a997c3cbb9086632d798ea139ef3db.1cdbb93df2e7e062ae4cf6bcf2b9474753a0c0fe76045acdb204ca36f43c8ecf,\n                    ac9da67460afadceab39d5d53cf913ef.94bd0bf344ba2b6661ea81d13b5de86a               = 77a997c3cbb9086632d798ea139ef3db.94bd0bf344ba2b6661ea81d13b5de86a,\n                    ac9da67460afadceab39d5d53cf913ef.ec0bd64971a7e3dc3bd60fa2a57bebab          = 77a997c3cbb9086632d798ea139ef3db.ec0bd64971a7e3dc3bd60fa2a57bebab\n      WHEN NOT MATCHED THEN\n         INSERT            (div_nbr, po_rcvd_dt, po_nbr, prod_nbr, line_nbr, prcs_dt,\n                            fwb_cyc_id, eff_dt, pim_usf_std_prod_cd, prch_from_vndr_nbr, po_cnfrm_ind, arvl_dt,\n                            po_cnfrm_on_tm, cnfrm_qty_ord, fwb_trans_typ, fwb_last_updt_dt, ldr_tm, invnty_gain_loss,\n                            ord_dt, po_cnfrm_dt)\n             VALUES (77a997c3cbb9086632d798ea139ef3db.5a8103ceb3eda727eed8d3dbc244a027,\n                     77a997c3cbb9086632d798ea139ef3db.4cb02d50e00c65fc5d70b5e7e2795357,\n                     77a997c3cbb9086632d798ea139ef3db.0d87b59f7e55e64a6aa535e163a294d0,\n                     77a997c3cbb9086632d798ea139ef3db.9d0604c46c7fc3d284e860c5703e30e5,\n                     77a997c3cbb9086632d798ea139ef3db.4b59171098890bad2dce8062e2c004d0,\n                     77a997c3cbb9086632d798ea139ef3db.b37e525777403fb0c0cfa2cab3876994,\n                     77a997c3cbb9086632d798ea139ef3db.b039fac464493012dbb8c802e0c5f1b3,\n                     77a997c3cbb9086632d798ea139ef3db.035f18dd3f4744cbba3d3c0e867e72ed,\n                     77a997c3cbb9086632d798ea139ef3db.a0cb4fc179140ff174fbd1682dc451a253bf80c2794394a9e4fc91b08ae828cc,\n                     77a997c3cbb9086632d798ea139ef3db.68080a9a39ec1f932c8217dea347114bee40e9daeb1770b740e44d126ed089be,\n                     77a997c3cbb9086632d798ea139ef3db.d79dda76c8a6bcffecc087ec1131c985,\n                     77a997c3cbb9086632d798ea139ef3db.2a1a6bf6d59791c2deab38f31ad1af48,\n                     77a997c3cbb9086632d798ea139ef3db.4398bb53267f1843d24c415dc779d7c1,\n                     77a997c3cbb9086632d798ea139ef3db.88e8ca78a7ac9f877493b8f7921848a5,\n                     77a997c3cbb9086632d798ea139ef3db.86b9e982eb5cb3f0040bc18a472e7df5,\n                     77a997c3cbb9086632d798ea139ef3db.648a7217ad6540648271b813fedefc9153a0c0fe76045acdb204ca36f43c8ecf,\n                     77a997c3cbb9086632d798ea139ef3db.1f0f2abf63196db2770aedbe59e6cb12,\n                     77a997c3cbb9086632d798ea139ef3db.1cdbb93df2e7e062ae4cf6bcf2b9474753a0c0fe76045acdb204ca36f43c8ecf,\n                     77a997c3cbb9086632d798ea139ef3db.94bd0bf344ba2b6661ea81d13b5de86a,\n                     77a997c3cbb9086632d798ea139ef3db.ec0bd64971a7e3dc3bd60fa2a57bebab);\n\n      DBMS_OUTPUT.put_line('Merged from PO_CORP ' || sql%ROWCOUNT || ' rows');\n\n\n      \n      OPEN c_rcvd_pos;\n\n      FETCH c_rcvd_pos\n      BULK COLLECT INTO r_rcvd_pos;\n\n      FORALL i IN 1 .. ad169df4a5ba1749478152a9eba7f71a.1e21de3bb543a206edf22b18c23a0c49()\n         UPDATE 57eef8c3d4a13d22f0b40f9742e7b281.e96e2363b3f0b483f6c6bac06cbce70c\n            SET po_rcvd_dt = r_rcvd_pos(i).po_rcvd_dt, invnty_gain_loss = r_rcvd_pos(i).invnty_gain_loss\n          WHERE prod_nbr = r_rcvd_pos(i).prod_nbr\n            AND div_nbr = r_rcvd_pos(i).div_nbr\n            AND po_nbr = r_rcvd_pos(i).po_nbr;\n\n      DBMS_OUTPUT.put_line('Updated ' || sql%ROWCOUNT || ' rows for inventory gain/loss');\n\n      CLOSE c_rcvd_pos;\n\n      \n      DELETE FROM 57eef8c3d4a13d22f0b40f9742e7b281.e96e2363b3f0b483f6c6bac06cbce70c brg\n            WHERE ac9da67460afadceab39d5d53cf913ef.86b9e982eb5cb3f0040bc18a472e7df5 = 'OPO_CORP'\n              AND EXISTS (SELECT 'X'\n                            FROM 57eef8c3d4a13d22f0b40f9742e7b281.4494394bdae57ac129f3f9c8d6b432a8 mdl\n                           WHERE 57eef8c3d4a13d22f0b40f9742e7b281.4494394bdae57ac129f3f9c8d6b432a8.b039fac464493012dbb8c802e0c5f1b3 = ac9da67460afadceab39d5d53cf913ef.b039fac464493012dbb8c802e0c5f1b3\n                             AND 57eef8c3d4a13d22f0b40f9742e7b281.4494394bdae57ac129f3f9c8d6b432a8.9d0604c46c7fc3d284e860c5703e30e5 = ac9da67460afadceab39d5d53cf913ef.9d0604c46c7fc3d284e860c5703e30e5\n                             AND 57eef8c3d4a13d22f0b40f9742e7b281.4494394bdae57ac129f3f9c8d6b432a8.5a8103ceb3eda727eed8d3dbc244a027 = ac9da67460afadceab39d5d53cf913ef.5a8103ceb3eda727eed8d3dbc244a027\n                             AND 57eef8c3d4a13d22f0b40f9742e7b281.4494394bdae57ac129f3f9c8d6b432a8.6826ace148031485490ab3facb2a3938 = 'WEEKLY')\n              AND NOT EXISTS (SELECT 'X'\n                                FROM 57eef8c3d4a13d22f0b40f9742e7b281.9b750ec2007bde96270d1d7b1f9580ae\n                               WHERE po_nbr = ac9da67460afadceab39d5d53cf913ef.0d87b59f7e55e64a6aa535e163a294d0\n                                 AND div_nbr = ac9da67460afadceab39d5d53cf913ef.5a8103ceb3eda727eed8d3dbc244a027\n                                 AND prod_nbr = ac9da67460afadceab39d5d53cf913ef.9d0604c46c7fc3d284e860c5703e30e5)\n              AND EXISTS (SELECT 'X'\n                            FROM 57eef8c3d4a13d22f0b40f9742e7b281.619982f11fc39868c5b6059378ed0ba6\n                           WHERE fact_table = 'PO_CORP'\n                             AND fact_typ_cd = 'RG'\n                             AND div_nbr = ac9da67460afadceab39d5d53cf913ef.5a8103ceb3eda727eed8d3dbc244a027\n                             AND latest_prcs_dt >= l_odate);\n\n      DBMS_OUTPUT.put_line('Deleted ' || sql%ROWCOUNT || ' rows where OPO no longer exists or QTY is zero');\n\n      \n      DELETE FROM 57eef8c3d4a13d22f0b40f9742e7b281.e96e2363b3f0b483f6c6bac06cbce70c brg\n            WHERE ac9da67460afadceab39d5d53cf913ef.86b9e982eb5cb3f0040bc18a472e7df5 = 'OPO_CORP'\n              AND EXISTS (SELECT 'X'\n                            FROM 57eef8c3d4a13d22f0b40f9742e7b281.4494394bdae57ac129f3f9c8d6b432a8 mdl\n                           WHERE 57eef8c3d4a13d22f0b40f9742e7b281.4494394bdae57ac129f3f9c8d6b432a8.b039fac464493012dbb8c802e0c5f1b3 = ac9da67460afadceab39d5d53cf913ef.b039fac464493012dbb8c802e0c5f1b3\n                             AND 57eef8c3d4a13d22f0b40f9742e7b281.4494394bdae57ac129f3f9c8d6b432a8.9d0604c46c7fc3d284e860c5703e30e5 = ac9da67460afadceab39d5d53cf913ef.9d0604c46c7fc3d284e860c5703e30e5\n                             AND 57eef8c3d4a13d22f0b40f9742e7b281.4494394bdae57ac129f3f9c8d6b432a8.5a8103ceb3eda727eed8d3dbc244a027 = ac9da67460afadceab39d5d53cf913ef.5a8103ceb3eda727eed8d3dbc244a027\n                             AND 57eef8c3d4a13d22f0b40f9742e7b281.4494394bdae57ac129f3f9c8d6b432a8.6826ace148031485490ab3facb2a3938 = 'WEEKLY')\n              AND EXISTS (SELECT 'X'\n                            FROM 57eef8c3d4a13d22f0b40f9742e7b281.9b750ec2007bde96270d1d7b1f9580ae\n                           WHERE po_nbr = ac9da67460afadceab39d5d53cf913ef.0d87b59f7e55e64a6aa535e163a294d0\n                             AND div_nbr = ac9da67460afadceab39d5d53cf913ef.5a8103ceb3eda727eed8d3dbc244a027\n                             AND prod_nbr = ac9da67460afadceab39d5d53cf913ef.9d0604c46c7fc3d284e860c5703e30e5\n                             AND ttl_qty_ord = 0);\n\n      DBMS_OUTPUT.put_line('Deleted ' || sql%ROWCOUNT || ' rows where OPO quantity is zero');\n\n      COMMIT;\n\n      RETURN c_success;\n   EXCEPTION\n      WHEN OTHERS THEN\n         ROLLBACK;\n         DBMS_OUTPUT.put_line('Unexepected error');\n         DBMS_OUTPUT.put_line(SQLCODE || ': ' || SQLERRM);\n         RETURN c_error;\n   END fn_fwb_mdl_bridge_cmdty_load;\n\n    FUNCTION fn_fwb_mdl_cmdty_updt(p_odate IN VARCHAR2)\n      RETURN NUMBER IS\n      \n\n      l_eff_dt                      DATE;\n      l_odate                       DATE := TO_DATE(p_odate, 'YYYYMMDD');\n      l_wk_strt_day                 NUMBER;\n      l_mrkt_cost_chng_dt           DATE;\n      l_freeze_date                 DATE;\n      l_arvl_freeze_date            DATE;\n      l_wk_freeze_day               NUMBER;\n      l_fwd_mdl_opo_arvl_dt_fltr    NUMBER;\n      l_invty_dt                    DATE;\n      l_max_invty_dt                DATE;\n\n      \n      CURSOR c_mdl(\n         p_eff_dt                     DATE,\n         p_mrkt_cost_chng_dt          DATE) IS\n         WITH forecast_pivot AS           \n                (SELECT div_nbr, prod_nbr,cases_per_week_dssnd, week\n                , AVG(fcst_qty) OVER (PARTITION BY div_nbr, prod_nbr ORDER BY week ROWS BETWEEN 12 PRECEDING AND CURRENT ROW) AS fcst_qty \n                , 'S' AS fcst_own_sys\n                FROM\n                (SELECT\n                   9a13e4f8d213be79c2a943e7a7798fa2.d4973b5a538aeee023fd0e0e3dec2246, 9a13e4f8d213be79c2a943e7a7798fa2.6f0b966e78174c386897d77fd41fff66, NVL(9a13e4f8d213be79c2a943e7a7798fa2.bcdf878c4cc9cc052cd89d53c0a2e58c8028917aa6b7a2907a4028c643cf2a95,0) cases_per_week_dssnd,\n\n                   9a13e4f8d213be79c2a943e7a7798fa2.91918c30c845d55163648ac949642dadca1b4a4f1c625dd37ced46d410f60152,\n                   9a13e4f8d213be79c2a943e7a7798fa2.91918c30c845d55163648ac949642dad57fe7f2c8ce79dfdea3c47e4b1856209,\n                   9a13e4f8d213be79c2a943e7a7798fa2.91918c30c845d55163648ac949642daddb47595eee7b6db403d1381feea2b629,\n                   9a13e4f8d213be79c2a943e7a7798fa2.91918c30c845d55163648ac949642dadcd02d97c8832f5a21ad22577e0883e63,\n                   9a13e4f8d213be79c2a943e7a7798fa2.91918c30c845d55163648ac949642dad5a5ec1bb55f6cf319b363e752d181f3d,\n                   9a13e4f8d213be79c2a943e7a7798fa2.91918c30c845d55163648ac949642dadbd0250c2ac1cb017f05a2c5ad410ac28,\n                   9a13e4f8d213be79c2a943e7a7798fa2.91918c30c845d55163648ac949642dade42d35e9733d12cfe10a4908bf0b7a2c,\n                   9a13e4f8d213be79c2a943e7a7798fa2.91918c30c845d55163648ac949642dad7b7fb3232e016706d4eb42fd883b210c,\n                   9a13e4f8d213be79c2a943e7a7798fa2.91918c30c845d55163648ac949642dadbce99b7c32fd028fe46891e0a8ee95a5,\n                   9a13e4f8d213be79c2a943e7a7798fa2.91918c30c845d55163648ac949642dadb7b04ce9c9f3087b9d986654005da26a,\n                   9a13e4f8d213be79c2a943e7a7798fa2.91918c30c845d55163648ac949642dad4fa98020b0ab2a12631cca0f736e9c4d,\n                   9a13e4f8d213be79c2a943e7a7798fa2.91918c30c845d55163648ac949642dad1885f41575eeb8544dcf6c07af0105be\n                   FROM 57eef8c3d4a13d22f0b40f9742e7b281.2d07b77befb01ea094d879d8c1bc20a72b1c1e3dcb39c6f9c21d037557568056 P\n                   WHERE 9a13e4f8d213be79c2a943e7a7798fa2.5cfd2a5816c62cb3081424d250aad87f =   l_invty_dt\n                   AND 9a13e4f8d213be79c2a943e7a7798fa2.cd9c5f4a31935f42f74f9f7d20e0cca453a0c0fe76045acdb204ca36f43c8ecf IS NOT NULL)\n \n                UNPIVOT (fcst_qty FOR week IN ( CASE_FCST_TTL_WK_2 AS 1, CASE_FCST_TTL_WK_3 AS 2, CASE_FCST_TTL_WK_4 AS 3,\n                               CASE_FCST_TTL_WK_5 AS 4, CASE_FCST_TTL_WK_6 AS 5, CASE_FCST_TTL_WK_7 AS 6, CASE_FCST_TTL_WK_8 AS 7,\n                               CASE_FCST_TTL_WK_9 AS 8, CASE_FCST_TTL_WK_10 AS 9, CASE_FCST_TTL_WK_11 AS 10, CASE_FCST_TTL_WK_12 AS 11,\n                               CASE_FCST_TTL_WK_13 AS 12\n                               ))\n                UNION ALL\n                SELECT div_nbr, prod_nbr,NVL(8b27dbd8d4ef5bf1e679e3f7e4f9d5f9.bcdf878c4cc9cc052cd89d53c0a2e58c8028917aa6b7a2907a4028c643cf2a95,0) cases_per_wk_dssnd, 6d0cd1b65d34cda127f9a40b5d9d9106.b077bb1e0ce0acede3a27664d065886e, NVL(8b27dbd8d4ef5bf1e679e3f7e4f9d5f9.bcdf878c4cc9cc052cd89d53c0a2e58c8028917aa6b7a2907a4028c643cf2a95,0) fcst_qty, 'L' AS fcst_own_sys\n                FROM 57eef8c3d4a13d22f0b40f9742e7b281.2d07b77befb01ea094d879d8c1bc20a72b1c1e3dcb39c6f9c21d037557568056 P1\n                ,(SELECT week FROM   \n                  ((SELECT 1 v1, 2 v2, 3 v3, 4 v4, 5 v5, 6 v6, 7 v7, 8 v8, 9 v9 , 10 v10 , 11 v11 , 12 v12, 13 v13 FROM DUAL)\n                  UNPIVOT (week FOR wk IN (v1 AS 1, v2 AS 2, v3 AS 3 , v4 AS 4, v5 AS 5, v6 AS 6, v7 AS 7, v8 AS 8, v9 AS 9, v10 AS 10, v11 AS 11, v12 AS 12  ))\n                  )) WKS\n                   WHERE 8b27dbd8d4ef5bf1e679e3f7e4f9d5f9.5cfd2a5816c62cb3081424d250aad87f = l_invty_dt\n                   AND 8b27dbd8d4ef5bf1e679e3f7e4f9d5f9.cd9c5f4a31935f42f74f9f7d20e0cca453a0c0fe76045acdb204ca36f43c8ecf IS  NULL)\n          SELECT ed9cfc82cf8ab046ab643b4d08b7a268.9d0604c46c7fc3d284e860c5703e30e5,\n                ed9cfc82cf8ab046ab643b4d08b7a268.5a8103ceb3eda727eed8d3dbc244a027,\n                \n                CASE\n                   WHEN 9b3f2e8dad35bac81ec90d12b3fdb067.d29c8ccf19e9f52525650c3b46f0ac2fc1e1ab753a3b305911e8a15073f6c8e7 IS NULL THEN\n                      NULL\n                   ELSE\n                      CASE\n                         WHEN ((9b3f2e8dad35bac81ec90d12b3fdb067.d29c8ccf19e9f52525650c3b46f0ac2fc1e1ab753a3b305911e8a15073f6c8e7\n                                - CASE\n                                     WHEN NVL(246e23c61a2a1962f28f571eaf459ec6.255549dc5feefca4723d5b420aaa1349, 0) = 0 THEN  \n                                        0\n                                     ELSE\n                                        (NVL(ed9cfc82cf8ab046ab643b4d08b7a268.424c463cfee8bf6e0e7f0af89a2a6d99, 0) + NVL(57ec85093416d0c4247b432ec76450e7.2e75f98afe07dc21380a4af81d890c66, 0) - NVL(ed9cfc82cf8ab046ab643b4d08b7a268.0c6006dfe1273fdfc6156477e50d71a8, 0))\n                                        / 246e23c61a2a1962f28f571eaf459ec6.255549dc5feefca4723d5b420aaa1349  \n                                        * 7\n                                  END)\n                               * NVL(246e23c61a2a1962f28f571eaf459ec6.255549dc5feefca4723d5b420aaa1349, 0) \n                               / 7) < 0 THEN\n                            0\n                         ELSE\n                            (9b3f2e8dad35bac81ec90d12b3fdb067.d29c8ccf19e9f52525650c3b46f0ac2fc1e1ab753a3b305911e8a15073f6c8e7\n                             - CASE\n                                  WHEN NVL(246e23c61a2a1962f28f571eaf459ec6.255549dc5feefca4723d5b420aaa1349, 0) = 0 THEN\n                                     0\n                                  ELSE\n                                     (  NVL(ed9cfc82cf8ab046ab643b4d08b7a268.424c463cfee8bf6e0e7f0af89a2a6d99, 0)\n                                      + NVL(57ec85093416d0c4247b432ec76450e7.2e75f98afe07dc21380a4af81d890c66, 0)\n                                      - NVL(ed9cfc82cf8ab046ab643b4d08b7a268.0c6006dfe1273fdfc6156477e50d71a8, 0))\n                                     / 246e23c61a2a1962f28f571eaf459ec6.255549dc5feefca4723d5b420aaa1349            \n                                     * 7\n                               END)\n                            * NVL(246e23c61a2a1962f28f571eaf459ec6.255549dc5feefca4723d5b420aaa1349, 0)            \n                            / 7\n                      END\n                END\n                   recmd_qty_to_ord,\n                CASE\n                   WHEN NVL(246e23c61a2a1962f28f571eaf459ec6.255549dc5feefca4723d5b420aaa1349, 0) = 0 THEN        \n                      0\n                   ELSE\n                        (NVL(ed9cfc82cf8ab046ab643b4d08b7a268.424c463cfee8bf6e0e7f0af89a2a6d99, 0) + NVL(57ec85093416d0c4247b432ec76450e7.2e75f98afe07dc21380a4af81d890c66, 0) - NVL(ed9cfc82cf8ab046ab643b4d08b7a268.0c6006dfe1273fdfc6156477e50d71a8, 0))\n                      / 246e23c61a2a1962f28f571eaf459ec6.255549dc5feefca4723d5b420aaa1349                         \n                      * 7\n                END\n                   days_invtny_on_hnd,\n                NVL(ed9cfc82cf8ab046ab643b4d08b7a268.424c463cfee8bf6e0e7f0af89a2a6d99, 0) qty_on_hnd_actl,\n                \n                NVL(57ec85093416d0c4247b432ec76450e7.2e75f98afe07dc21380a4af81d890c66, 0) qty_on_ord_actl,\n                NVL(ed9cfc82cf8ab046ab643b4d08b7a268.0c6006dfe1273fdfc6156477e50d71a8, 0) rsrv_qty,\n                CASE\n                   WHEN ed9cfc82cf8ab046ab643b4d08b7a268.fc25e1768db60a0123b4dc8d83c35baaec46c2c12a09a2a835e37f63df4d75bc <= p_mrkt_cost_chng_dt THEN ed9cfc82cf8ab046ab643b4d08b7a268.7447e4c5c7341b00bf372f9c851e251a2f2b3e70926b93774cf0d2641fb19d5e\n                   ELSE ed9cfc82cf8ab046ab643b4d08b7a268.9e7d198b282707dcc4d4b9e27f6b2859\n                END\n                   mrkt_cost,\n                (SELECT MAX(invnty_dt)\n                   FROM 57eef8c3d4a13d22f0b40f9742e7b281.c0fb76e4cf5f001346b40cb85ab28000dc6f5ca1708e344e69efddbfaa5cf464 inv\n                  WHERE invnty_dt <= l_odate\n                    AND 57eef8c3d4a13d22f0b40f9742e7b281.c0fb76e4cf5f001346b40cb85ab28000dc6f5ca1708e344e69efddbfaa5cf464.5a8103ceb3eda727eed8d3dbc244a027 = 57eef8c3d4a13d22f0b40f9742e7b281.fadb8b76a21d0037200f1f2222239841.5a8103ceb3eda727eed8d3dbc244a027\n                    AND 57eef8c3d4a13d22f0b40f9742e7b281.c0fb76e4cf5f001346b40cb85ab28000dc6f5ca1708e344e69efddbfaa5cf464.9d0604c46c7fc3d284e860c5703e30e5 = 57eef8c3d4a13d22f0b40f9742e7b281.fadb8b76a21d0037200f1f2222239841.9d0604c46c7fc3d284e860c5703e30e5\n                    AND NVL(57eef8c3d4a13d22f0b40f9742e7b281.fadb8b76a21d0037200f1f2222239841.9e7d198b282707dcc4d4b9e27f6b2859, 0) <> NVL(57eef8c3d4a13d22f0b40f9742e7b281.c0fb76e4cf5f001346b40cb85ab28000dc6f5ca1708e344e69efddbfaa5cf464.9e7d198b282707dcc4d4b9e27f6b2859, 0)),\n                   mrkt_cost_last_chng_dt,\n                5949474a66e17ceb30a874ef398f78c3.7030b23a1bb87d6e45f798457dea32e72e10f03a9d47432c9de1f70c49ee8035 ,\n                5949474a66e17ceb30a874ef398f78c3.255549dc5feefca4723d5b420aaa1349 as fcst_cases    \n           FROM 57eef8c3d4a13d22f0b40f9742e7b281.4494394bdae57ac129f3f9c8d6b432a8 fwb, 57eef8c3d4a13d22f0b40f9742e7b281.fadb8b76a21d0037200f1f2222239841 prod, forecast_pivot fcst,\n           (Select div_nbr , prod_nbr ,  sum(TTL_QTY_ORD) opo_TTL_QTY_ORD\n                     from 57eef8c3d4a13d22f0b40f9742e7b281.9b750ec2007bde96270d1d7b1f9580ae\n                     where 1=1\n                      and arvl_dt <= l_arvl_freeze_date\n                      group by div_nbr , prod_nbr  )   opo\n          WHERE 57eef8c3d4a13d22f0b40f9742e7b281.4494394bdae57ac129f3f9c8d6b432a8.9d0604c46c7fc3d284e860c5703e30e5 = 57eef8c3d4a13d22f0b40f9742e7b281.fadb8b76a21d0037200f1f2222239841.9d0604c46c7fc3d284e860c5703e30e5\n            AND 57eef8c3d4a13d22f0b40f9742e7b281.4494394bdae57ac129f3f9c8d6b432a8.5a8103ceb3eda727eed8d3dbc244a027 = 57eef8c3d4a13d22f0b40f9742e7b281.fadb8b76a21d0037200f1f2222239841.5a8103ceb3eda727eed8d3dbc244a027\n            AND 57eef8c3d4a13d22f0b40f9742e7b281.4494394bdae57ac129f3f9c8d6b432a8.9d0604c46c7fc3d284e860c5703e30e5 = 57ec85093416d0c4247b432ec76450e7.9d0604c46c7fc3d284e860c5703e30e5(+)\n            AND 57eef8c3d4a13d22f0b40f9742e7b281.4494394bdae57ac129f3f9c8d6b432a8.5a8103ceb3eda727eed8d3dbc244a027 = 57ec85093416d0c4247b432ec76450e7.5a8103ceb3eda727eed8d3dbc244a027(+)\n            AND 57eef8c3d4a13d22f0b40f9742e7b281.4494394bdae57ac129f3f9c8d6b432a8.6826ace148031485490ab3facb2a3938 = 'WEEKLY'\n            AND 57eef8c3d4a13d22f0b40f9742e7b281.4494394bdae57ac129f3f9c8d6b432a8.035f18dd3f4744cbba3d3c0e867e72ed = p_eff_dt\n            AND 57eef8c3d4a13d22f0b40f9742e7b281.4494394bdae57ac129f3f9c8d6b432a8.5a8103ceb3eda727eed8d3dbc244a027 = 5949474a66e17ceb30a874ef398f78c3.5a8103ceb3eda727eed8d3dbc244a027\n            and 57eef8c3d4a13d22f0b40f9742e7b281.4494394bdae57ac129f3f9c8d6b432a8.9d0604c46c7fc3d284e860c5703e30e5 = 5949474a66e17ceb30a874ef398f78c3.9d0604c46c7fc3d284e860c5703e30e5\n            and trim(57eef8c3d4a13d22f0b40f9742e7b281.fadb8b76a21d0037200f1f2222239841.4461a4cc88d0ee519faed8757555e7e2) in ( '0' ,'2')\n            and 5949474a66e17ceb30a874ef398f78c3.b077bb1e0ce0acede3a27664d065886e = LEAST(CEIL(57eef8c3d4a13d22f0b40f9742e7b281.4494394bdae57ac129f3f9c8d6b432a8.d29c8ccf19e9f52525650c3b46f0ac2fc1e1ab753a3b305911e8a15073f6c8e7/7),12)\n             ;\n\n\n      TYPE t_mdl IS TABLE OF c_mdl%ROWTYPE;\n\n      r_mdl                 t_mdl;\n   BEGIN\n      DBMS_OUTPUT.put_line('Order Date: ' || l_odate);\n\n      \n      SELECT param_value_nbr\n        INTO l_wk_strt_day\n        FROM 57eef8c3d4a13d22f0b40f9742e7b281.1f9c921b05aafc28bf91547d5ec08a09\n       WHERE app_name = 'FORWARD_BUY'\n         AND param_type = 'CMTY_GUIDANCE_WK'\n         AND param_code = 'STRT_DAY';\n\n      SELECT MAX(clndr_dt)\n        INTO l_eff_dt\n        FROM 57eef8c3d4a13d22f0b40f9742e7b281.a2349118cac55136943abdf2d397e141\n       WHERE TO_CHAR(clndr_dt, 'D') = l_wk_strt_day\n         AND clndr_dt <= l_odate;\n\n      DBMS_OUTPUT.put_line('Effective Date: ' || l_eff_dt);\n\n         \n   SELECT param_value_nbr\n     INTO l_wk_freeze_day\n     FROM 57eef8c3d4a13d22f0b40f9742e7b281.1f9c921b05aafc28bf91547d5ec08a09\n    WHERE app_name = 'FORWARD_BUY'\n      AND param_type = 'CMTY_GUIDANCE_WK'\n      AND param_code = 'FREEZE_DAY';\n\n   SELECT l_eff_dt + l_wk_freeze_day\n     INTO l_freeze_date\n     FROM DUAL;\n\n   SELECT MAX(invnty_dt)\n     INTO l_max_invty_dt\n     FROM 57eef8c3d4a13d22f0b40f9742e7b281.c0fb76e4cf5f001346b40cb85ab28000dc6f5ca1708e344e69efddbfaa5cf464 ;\n\n   IF l_freeze_date > l_max_invty_dt            \n     THEN l_invty_dt  := l_max_invty_dt ;\n     ELSE l_invty_dt  := l_freeze_date;\n   END IF;\n\n   SELECT   param_value_nbr\n        INTO l_fwd_mdl_opo_arvl_dt_fltr\n        FROM 57eef8c3d4a13d22f0b40f9742e7b281.1f9c921b05aafc28bf91547d5ec08a09\n       WHERE app_name = 'FORWARD_BUY'\n       and param_type = 'FWD_MDL_OPO_ARVL_DT_FLTR'\n       and param_code = 'CMTY_OPEN_ORD_ARVL_DT';\n\n    SELECT l_odate + l_fwd_mdl_opo_arvl_dt_fltr\n     INTO l_arvl_freeze_date\n     FROM DUAL;\n\n\n   DBMS_OUTPUT.put_line('Freeze Date: ' || l_freeze_date);\n   DBMS_OUTPUT.put_line('Inventory Date: ' || l_invty_dt);\n   DBMS_OUTPUT.put_line('Arrival freeze Date: ' || l_arvl_freeze_date);\n\n\n      \n      SELECT MIN(clndr_dt)\n        INTO l_mrkt_cost_chng_dt\n        FROM 57eef8c3d4a13d22f0b40f9742e7b281.a2349118cac55136943abdf2d397e141\n       WHERE clndr_day_of_wk = 7\n         AND clndr_dt >= l_eff_dt;\n\n\n\n      DBMS_OUTPUT.put_line('Next TMC Change Date: ' || l_mrkt_cost_chng_dt);\n\n      \n      OPEN c_mdl(l_eff_dt, l_mrkt_cost_chng_dt);\n\n      FETCH c_mdl\n      BULK COLLECT INTO r_mdl;\n\n\n      FORALL i IN 1 .. 880f6f1ae28554ebc6ad0e705d4b328e.1e21de3bb543a206edf22b18c23a0c49()\n         UPDATE 57eef8c3d4a13d22f0b40f9742e7b281.4494394bdae57ac129f3f9c8d6b432a8\n            SET recmd_qty_to_ord         = r_mdl(i).recmd_qty_to_ord,\n                days_invtny_on_hnd       = r_mdl(i).days_invtny_on_hnd,\n                qty_on_hnd_actl          = r_mdl(i).qty_on_hnd_actl,\n                qty_on_ord_actl          = r_mdl(i).qty_on_ord_actl,\n                rsrv_qty                 = r_mdl(i).rsrv_qty,\n                mrkt_cost                = r_mdl(i).mrkt_cost,\n                mrkt_cost_last_chng_dt   = r_mdl(i).mrkt_cost_last_chng_dt,\n                cases_per_wk_dssnd       = r_mdl(i).cases_per_week_dssnd,  \n                fcst_cases               = r_mdl(i).fcst_cases,\n                fwb_last_updt_dt         = SYSDATE\n          WHERE prod_nbr = r_mdl(i).prod_nbr\n            AND div_nbr = r_mdl(i).div_nbr\n            AND eff_dt = l_eff_dt\n            AND fwb_cyc_typ = 'WEEKLY';\n\n      DBMS_OUTPUT.put_line('Updated ' || sql%ROWCOUNT || ' rows');\n\n      CLOSE c_mdl;\n\n      COMMIT;\n\n      RETURN c_success;\n   EXCEPTION\n      WHEN OTHERS THEN\n         ROLLBACK;\n         DBMS_OUTPUT.put_line('Unexepected error');\n         DBMS_OUTPUT.put_line(SQLCODE || ': ' || SQLERRM);\n         RETURN c_error;\n   END fn_fwb_mdl_cmdty_updt;\n\n\n\n   FUNCTION get_opn_po_lic(p_prod_nbr     IN VARCHAR2,\n                           p_div_nbr      IN NUMBER,\n                           p_arvl_dt      IN DATE)\n      RETURN NUMBER IS\n      \n\n      l_last_cost   NUMBER;\n   BEGIN\n      BEGIN\n         SELECT last_inv_cost_per_unit\n           INTO l_last_cost\n           FROM (  SELECT last_inv_cost_per_unit\n                     FROM 57eef8c3d4a13d22f0b40f9742e7b281.9b750ec2007bde96270d1d7b1f9580ae\n                    WHERE prod_nbr = p_prod_nbr\n                      AND div_nbr = p_div_nbr\n                      AND arvl_dt < p_arvl_dt\n                 ORDER BY arvl_dt DESC)\n          WHERE ROWNUM = 1;\n      EXCEPTION\n         WHEN NO_DATA_FOUND THEN\n            SELECT last_inv_cost\n              INTO l_last_cost\n              FROM 57eef8c3d4a13d22f0b40f9742e7b281.fadb8b76a21d0037200f1f2222239841\n             WHERE prod_nbr = p_prod_nbr\n               AND div_nbr = p_div_nbr;\n      END;\n\n      RETURN l_last_cost;\n   END get_opn_po_lic;\nEND pkg_fwb_cmdty;\n/",
            "upstream_dependencies": [],
            "downstream_dependencies": [],
            "dag_location": "null",
            "gantt_location": "null",
            "created_at": "null",
            "updated_at": "null"
        },
        {
            "name": "PKG_CPAT_MARGIN_DEV_BASIS",
            "encrypted_name": "13cc009a6f63064b046af6d41a3c642934a1757f4bad54138c2efb5761614607",
            "type": "package",
            "database": "null",
            "encrypted_database": "null",
            "schema": "XDMADM",
            "encrypted_schema": "da238e96cf2cb791a097ca6946c096b4",
            "fully_qualified_name": "XDMADM.PKG_CPAT_MARGIN_DEV_BASIS",
            "encrypted_fqn": "da238e96cf2cb791a097ca6946c096b4.13cc009a6f63064b046af6d41a3c642934a1757f4bad54138c2efb5761614607",
            "synonyms": [],
            "metadata_analysis": "CREATE OR REPLACE PACKAGE \"da238e96cf2cb791a097ca6946c096b4\".\"13cc009a6f63064b046af6d41a3c642934a1757f4bad54138c2efb5761614607\" AS\n\n  \n  FUNCTION          get_dev_cost_full_cs_margin1(prime_deviated_cost_type IN VARCHAR2,\n                                             prime_markup_indicator IN VARCHAR2,\n                                             price_uom IN VARCHAR2,\n                                             dev_cost_margin IN NUMBER,\n                                             NET_WT_SHIPPED In NUMBER,\n                                             UNFM_QTY_SHPD IN NUMBER,\n                                             DEV_COST IN NUMBER,\n                                             inv_freight IN NUMBER,\n                                             prime_price_basis_amount IN NUMBER,\n                                             dev_cost_allowance IN NUMBER\n                                             )\n   RETURN NUMBER DETERMINISTIC PARALLEL_ENABLE;\n\n   FUNCTION          get_dev_cost_full_cs_sellprice(prime_deviated_cost_type IN VARCHAR2,\n                                             DEV_COST IN NUMBER,\n                                             inv_freight IN NUMBER,\n                                             dev_cost_allowance IN NUMBER,\n                                             vendor_cost IN NUMBER,\n                                             dev_cost_calc_full_csmargin IN NUMBER\n                                             )\n   RETURN NUMBER DETERMINISTIC PARALLEL_ENABLE;\n\n  FUNCTION          get_dev_cost_calceach_csmargin(prime_deviated_cost_type IN VARCHAR2,\n                                              prime_each_markup_type IN VARCHAR2,\n                                              price_uom IN VARCHAR2,\n                                              sales_uom IN VARCHAR2,\n                                              dev_cost_calcfull_cssell_price IN NUMBER,\n                                              prime_contract_ea_markupamount IN NUMBER,\n                                              each_conv_factor IN NUMBER,\n                                             each_shipped IN NUMBER)\n   RETURN NUMBER DETERMINISTIC PARALLEL_ENABLE;\n\nEND PKG_CPAT_MARGIN_DEV_BASIS;\n/\nCREATE OR REPLACE PACKAGE BODY \"da238e96cf2cb791a097ca6946c096b4\".\"13cc009a6f63064b046af6d41a3c642934a1757f4bad54138c2efb5761614607\"\nAS\nFUNCTION get_dev_cost_full_cs_margin1(\n    prime_deviated_cost_type IN VARCHAR2,\n    prime_markup_indicator   IN VARCHAR2,\n    price_uom                IN VARCHAR2,\n    dev_cost_margin          IN NUMBER,\n    NET_WT_SHIPPED           IN NUMBER,\n    UNFM_QTY_SHPD            IN NUMBER,\n    DEV_COST                 IN NUMBER,\n    inv_freight              IN NUMBER,\n    prime_price_basis_amount IN NUMBER,\n    dev_cost_allowance       IN NUMBER )\n  RETURN NUMBER DETERMINISTIC PARALLEL_ENABLE\nIS\n  \n  dev_cost_full_cs_margin1 NUMBER;\nBEGIN\n  dev_cost_full_cs_margin1 :=\n  CASE\n  WHEN prime_deviated_cost_type = 'FX' THEN\n    0\n  ELSE\n    CASE\n    WHEN prime_markup_indicator IN ('D', 'N') OR prime_markup_indicator IS NULL THEN\n      dev_cost_margin\n    WHEN prime_markup_indicator = '#' THEN\n      CASE\n      WHEN price_uom <>'CS' THEN\n        dev_cost_margin\n      WHEN price_uom = 'CS' THEN\n        CASE\n        WHEN UNFM_QTY_SHPD = 0 THEN\n          0\n        ELSE\n          (to_number(net_wt_shipped) / UNFM_QTY_SHPD) * dev_cost_margin\n        END\n      END\n    WHEN prime_markup_indicator = 'P' THEN\n      CASE\n      WHEN (1 - dev_cost_margin ) = 0 THEN\n        0\n      WHEN prime_deviated_cost_type = 'AL' THEN\n        ((prime_price_basis_amount + dev_cost_allowance ) / (1 - dev_cost_margin)) - (prime_price_basis_amount + dev_cost_allowance )\n      WHEN prime_deviated_cost_type = 'D' THEN\n        ( dev_cost / (1 - dev_cost_margin )) - dev_cost\n      WHEN prime_deviated_cost_type = 'F' THEN\n        ( (dev_cost + inv_freight ) / ( 1 - dev_cost_margin )) - (dev_cost + inv_freight )\n      ELSE\n        ( prime_price_basis_amount / (1 - dev_cost_margin)) - prime_price_basis_amount\n      END\n    END\n  END;\n  RETURN(NVL(dev_cost_full_cs_margin1,0));\nEND;\n\nFUNCTION get_dev_cost_full_cs_sellprice(\n    prime_deviated_cost_type    IN VARCHAR2,\n    DEV_COST                    IN NUMBER,\n    inv_freight                 IN NUMBER,\n    dev_cost_allowance          IN NUMBER,\n    vendor_cost                 IN NUMBER,\n    dev_cost_calc_full_csmargin IN NUMBER )\n  RETURN NUMBER DETERMINISTIC PARALLEL_ENABLE\nIS\n  \n  dev_cost_full_cs_sell_price NUMBER;\nBEGIN\n  dev_cost_full_cs_sell_price :=\n  CASE\n  WHEN prime_deviated_cost_type = 'AL' THEN\n    vendor_cost + dev_cost_allowance + dev_cost_calc_full_csmargin\n  WHEN prime_deviated_cost_type = 'D' THEN\n    dev_cost_calc_full_csmargin + DEV_COST\n  WHEN prime_deviated_cost_type = 'F' THEN\n    DEV_COST + inv_freight + dev_cost_calc_full_csmargin\n  WHEN prime_deviated_cost_type = 'FX' THEN\n    DEV_COST\n  WHEN prime_deviated_cost_type IS NULL THEN\n    vendor_cost + dev_cost_calc_full_csmargin\n  END;\n  RETURN(NVL(dev_cost_full_cs_sell_price,0));\nEND;\n\nFUNCTION get_dev_cost_calceach_csmargin(\n    prime_deviated_cost_type       IN VARCHAR2,\n    prime_each_markup_type         IN VARCHAR2,\n    price_uom                      IN VARCHAR2,\n    sales_uom                      IN VARCHAR2,\n    dev_cost_calcfull_cssell_price IN NUMBER,\n    prime_contract_ea_markupamount IN NUMBER,\n    each_conv_factor               IN NUMBER,\n    each_shipped                   IN NUMBER )\n  RETURN NUMBER DETERMINISTIC PARALLEL_ENABLE\nIS\n  \n  dev_cost_calceach_csmargin NUMBER;\nBEGIN\n  dev_cost_calceach_csmargin :=\n  CASE\n  WHEN each_shipped <> 0 THEN\n    CASE\n    WHEN prime_deviated_cost_type <> 'FX' OR prime_deviated_cost_type IS NULL THEN\n      CASE\n      WHEN prime_each_markup_type = 'P' THEN\n        CASE\n        WHEN price_uom = 'LB' THEN\n          ( prime_contract_ea_markupamount / 100) * dev_cost_calcfull_cssell_price\n        WHEN sales_uom <> 'EA' AND price_uom = 'CS' THEN\n          CASE WHEN each_conv_factor = 0 THEN 0 ELSE\n            ( dev_cost_calcfull_cssell_price / each_conv_factor) * (prime_contract_ea_markupamount / 100)\n          END\n        WHEN sales_uom = 'EA' AND price_uom = 'CS' THEN\n          dev_cost_calcfull_cssell_price * (prime_contract_ea_markupamount / 100)\n        END\n      ELSE\n        CASE\n        WHEN prime_each_markup_type IS NULL OR prime_each_markup_type <> 'P' THEN\n          prime_contract_ea_markupamount\n        END\n      END\n    END\n  ELSE\n    0\n  END;\n  RETURN(NVL(dev_cost_calceach_csmargin,0));\nEND;\n\nEND PKG_CPAT_MARGIN_DEV_BASIS;\n/",
            "upstream_dependencies": [],
            "downstream_dependencies": [],
            "dag_location": "null",
            "gantt_location": "null",
            "created_at": "null",
            "updated_at": "null"
        },
        {
            "name": "PKG_EDI_816_867_EXTRCT",
            "encrypted_name": "2f7537400c01953cca3b2c16a51c6e7da087ad812ff84062aa3b7d538a53ef2a",
            "type": "package",
            "database": "null",
            "encrypted_database": "null",
            "schema": "XDMADM",
            "encrypted_schema": "da238e96cf2cb791a097ca6946c096b4",
            "fully_qualified_name": "XDMADM.PKG_EDI_816_867_EXTRCT",
            "encrypted_fqn": "da238e96cf2cb791a097ca6946c096b4.2f7537400c01953cca3b2c16a51c6e7da087ad812ff84062aa3b7d538a53ef2a",
            "synonyms": [],
            "metadata_analysis": "CREATE OR REPLACE PACKAGE \"da238e96cf2cb791a097ca6946c096b4\".\"2f7537400c01953cca3b2c16a51c6e7da087ad812ff84062aa3b7d538a53ef2a\" as\n\nFUNCTION fn_extract_816_pepsi\n(\n   p_partner_id   IN   VARCHAR2,\n   p_odate        IN   VARCHAR2\n )\n      RETURN NUMBER;\n\nFUNCTION fn_extract_816_ecolab\n(\n   p_partner_id   IN   VARCHAR2,\n   p_mfr_num      IN   NUMBER,\n   p_odate        IN   VARCHAR2\n )\n      RETURN NUMBER;\nFUNCTION fn_extract_867_pepsi\n(\n   p_partner_id   IN   VARCHAR2,\n   p_odate        IN   VARCHAR2\n )\n      RETURN NUMBER;\n\nFUNCTION fn_extract_867_ecolab\n(\n   p_partner_id   IN   VARCHAR2,\n   p_mfr_num      IN   NUMBER,\n   p_odate        IN   VARCHAR2\n )\n      RETURN NUMBER;\n\nEND pkg_EDI_816_867_extrct;\n/\nCREATE OR REPLACE PACKAGE BODY \"da238e96cf2cb791a097ca6946c096b4\".\"2f7537400c01953cca3b2c16a51c6e7da087ad812ff84062aa3b7d538a53ef2a\" AS\n\n\n\n\n    c_limit                     CONSTANT INTEGER    := 1000;\n    g_total_timer_begin         PLS_INTEGER;\n    g_timer_end                 PLS_INTEGER;\n    g_run_time                  PLS_INTEGER;\n    g_message                   VARCHAR2(256);\n    g_how_many                  INTEGER;\n    g_sqlcode                   NUMBER;\n    g_total_lines               INTEGER;\n    g_reads                     INTEGER;\n    g_this_week                 INTEGER;\n    g_this_year                 INTEGER;\n    g_begin_week                DATE;\n    g_end_week                  DATE;\n    g_records_inserted          INTEGER;\n    g_cases                     NUMBER;\n    g_bulk_error_count          NUMBER;\n    g_idx                       NUMBER;\n    g_this_idx                  NUMBER;\n    g_mfr_num                   NUMBER;\n    g_city                      VARCHAR2(30);\n    g_last_brnch_cd             VARCHAR2(2);\n    g_state                     VARCHAR2(2);\n    g_zip                       VARCHAR2(15);\n    g_name                      VARCHAR2(30);\n    g_mfr                       VARCHAR2(30);\n    v_bulk_errors                       EXCEPTION;\n    PRAGMA EXCEPTION_INIT (v_bulk_errors, -24381);\n\nCURSOR cur_816_pepsi\nIS\n        SELECT DISTINCT RPAD(57eef8c3d4a13d22f0b40f9742e7b281.7cad4bed0267ab37956f1fcccb769b24.36894f5f47f531f17812c932d1e217a2, 25, ' '),\n            RPAD(57eef8c3d4a13d22f0b40f9742e7b281.7cad4bed0267ab37956f1fcccb769b24.cd8c19b82a9bb45539c5ddd5262d5ee8, 2, ' '),\n            RPAD (NVL (LTRIM (TRANSLATE (57eef8c3d4a13d22f0b40f9742e7b281.d73db8611de2680d7b0b5feaa04810c2.111341020e63cc60873e4d05e285d6de,  '*^|><@~`&','    ')),\n                'Name blank in db') ,25,' '),\n            LPAD (NVL (LTRIM (TRANSLATE (57eef8c3d4a13d22f0b40f9742e7b281.d73db8611de2680d7b0b5feaa04810c2.6e427bacb381704d6a3dbca94a0d4f03,  '*^|><@~`&','    ')),\n                ' ') ,15, 0) ,\n            RPAD (NVL (LTRIM (TRANSLATE (57eef8c3d4a13d22f0b40f9742e7b281.d73db8611de2680d7b0b5feaa04810c2.5365b933bbc11da76734c5fea5465226,  '*^|><@~`&','        ')),\n                'Address blank in db') ,25,' ') ,\n            RPAD (NVL (LTRIM (TRANSLATE (57eef8c3d4a13d22f0b40f9742e7b281.d73db8611de2680d7b0b5feaa04810c2.e1d646da9043723e193e05335bd5ca88,  '*^|><@~`&','     ')),\n                'CIty blank in db') ,18,' ') ,\n            RPAD (NVL (LTRIM (TRANSLATE (57eef8c3d4a13d22f0b40f9742e7b281.d73db8611de2680d7b0b5feaa04810c2.0221da4fb16f9602b1445ff5a28f449d,  '*^|><@~`&','      ')),\n                'XX') ,2,' '),\n            LPAD (NVL (LTRIM (TRANSLATE (57eef8c3d4a13d22f0b40f9742e7b281.d73db8611de2680d7b0b5feaa04810c2.5cb1ed84165efa1276ea973f17a56426,  '*^|><@~`&','         ')),\n                ' ') ,9, 0),\n            57eef8c3d4a13d22f0b40f9742e7b281.6071e9636f96f191337758a751a38d40.1066994b3c9cb973df9654728af380e0\n        FROM 57eef8c3d4a13d22f0b40f9742e7b281.7cad4bed0267ab37956f1fcccb769b24 d, 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e s, 57eef8c3d4a13d22f0b40f9742e7b281.fadb8b76a21d0037200f1f2222239841 p,\n             57eef8c3d4a13d22f0b40f9742e7b281.d73db8611de2680d7b0b5feaa04810c2 c, 57eef8c3d4a13d22f0b40f9742e7b281.6071e9636f96f191337758a751a38d40 pim\n        WHERE 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.b37e525777403fb0c0cfa2cab3876994 BETWEEN g_begin_week AND g_end_week\n        AND 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.6e427bacb381704d6a3dbca94a0d4f03 = 57eef8c3d4a13d22f0b40f9742e7b281.d73db8611de2680d7b0b5feaa04810c2.6e427bacb381704d6a3dbca94a0d4f03\n        AND 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.5a8103ceb3eda727eed8d3dbc244a027 = 57eef8c3d4a13d22f0b40f9742e7b281.d73db8611de2680d7b0b5feaa04810c2.5a8103ceb3eda727eed8d3dbc244a027\n        AND 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.9d0604c46c7fc3d284e860c5703e30e5 = 57eef8c3d4a13d22f0b40f9742e7b281.fadb8b76a21d0037200f1f2222239841.9d0604c46c7fc3d284e860c5703e30e5\n        AND 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.5a8103ceb3eda727eed8d3dbc244a027 = 57eef8c3d4a13d22f0b40f9742e7b281.fadb8b76a21d0037200f1f2222239841.5a8103ceb3eda727eed8d3dbc244a027\n        AND 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.5a8103ceb3eda727eed8d3dbc244a027 = 57eef8c3d4a13d22f0b40f9742e7b281.7cad4bed0267ab37956f1fcccb769b24.5a8103ceb3eda727eed8d3dbc244a027\n        AND 57eef8c3d4a13d22f0b40f9742e7b281.fadb8b76a21d0037200f1f2222239841.a0cb4fc179140ff174fbd1682dc451a253bf80c2794394a9e4fc91b08ae828cc = 57eef8c3d4a13d22f0b40f9742e7b281.6071e9636f96f191337758a751a38d40.a0cb4fc179140ff174fbd1682dc451a253bf80c2794394a9e4fc91b08ae828cc\n        AND(57eef8c3d4a13d22f0b40f9742e7b281.6071e9636f96f191337758a751a38d40.1066994b3c9cb973df9654728af380e0 in ( Select  PARAM_VALUE_CHR from da238e96cf2cb791a097ca6946c096b4.4f5536cc47645edba0ee701f6b3007a7\n                                     where app_name = 'PepsiEDI' and param_type = 'Vendor' )OR 57eef8c3d4a13d22f0b40f9742e7b281.fadb8b76a21d0037200f1f2222239841.9d0604c46c7fc3d284e860c5703e30e5 in  (Select  PARAM_VALUE_CHR from da238e96cf2cb791a097ca6946c096b4.4f5536cc47645edba0ee701f6b3007a7\n\t\t\t\t\t\t\t\t\t where app_name = 'PepsiEDI' and param_type = 'INCL_PROD_NBR' ))\n        AND 57eef8c3d4a13d22f0b40f9742e7b281.6071e9636f96f191337758a751a38d40.1066994b3c9cb973df9654728af380e0 ||'-' || 57eef8c3d4a13d22f0b40f9742e7b281.d73db8611de2680d7b0b5feaa04810c2.5a8103ceb3eda727eed8d3dbc244a027 not in  ( Select  PARAM_VALUE_CHR from da238e96cf2cb791a097ca6946c096b4.4f5536cc47645edba0ee701f6b3007a7\n                    where app_name = 'PepsiEDI' and param_type = 'Exclusion' )\n        AND 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.ff5eff8369918e81f835c2f6b23835df IS NULL\n        AND 57eef8c3d4a13d22f0b40f9742e7b281.d73db8611de2680d7b0b5feaa04810c2.7080f549428abf39b1057724fa59d813 = '1'\n        AND 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.8e296af0709009f4cb601a563ab2e022 in ('RT','CD','WC','VS')\n        AND 57eef8c3d4a13d22f0b40f9742e7b281.7cad4bed0267ab37956f1fcccb769b24.0556eb81b3a560cc20f6933e52a28a69 <> 'CC'\n        ORDER BY RPAD(57eef8c3d4a13d22f0b40f9742e7b281.7cad4bed0267ab37956f1fcccb769b24.cd8c19b82a9bb45539c5ddd5262d5ee8, 2, ' ');\n\n\n\n\n     TYPE ntt_number is table of NUMBER;\n     TYPE ntt_date is table of DATE;\n     TYPE ntt_varr IS table of VARCHAR2(100);\n\n     nt_div_nm ntt_varr;\n     nt_brnch_cd ntt_varr;\n     nt_cust_nm ntt_varr;\n     nt_cust_nbr ntt_varr;\n     nt_addr ntt_varr;\n     nt_city ntt_varr;\n     nt_st ntt_varr;\n     nt_zip ntt_varr;\n     nt_mfr ntt_varr;\n\n\n   \nPROCEDURE sp_calc_run_time\n\n\n\n\n    (\n        run_time_i  PLS_INTEGER,\n        desc_i      VARCHAR2\n    )\n    IS\n        v_secs NUMBER;\n        v_mins NUMBER;\n        v_hrs  NUMBER;\nBEGIN\n        v_secs    := ROUND((run_time_i) / 100, 2);\n        v_hrs     := TRUNC(v_secs / 3600);\n        v_secs    := v_secs - (v_hrs * 3600);\n        v_mins    := TRUNC(v_secs / 60);\n        v_secs    := ROUND(v_secs - (v_mins * 60));\n        g_message := desc_i  || v_hrs || ' hours; ' || v_mins || ' minutes; ' || v_secs || ' seconds';\n        dbms_output.put_line(g_message);\n\nEND sp_calc_run_time;\n \nPROCEDURE sp_last_week_dates\n\n\n\n\n    (\n        odate_i      VARCHAR2\n    )\n    IS\n        v_secs NUMBER;\n        v_mins NUMBER;\n        v_hrs  NUMBER;\nBEGIN\n    SELECT  fisc_yr, fisc_wk_of_yr - 1 this_week\n    INTO  g_this_year , g_this_week\n    FROM 57eef8c3d4a13d22f0b40f9742e7b281.a2349118cac55136943abdf2d397e141\n    WHERE clndr_dt = odate_i;\n\n    IF g_this_week = 0 THEN\n        g_this_year := g_this_year - 1;\n        SELECT MAX(fisc_wk_of_yr)\n        INTO g_this_week\n        FROM 57eef8c3d4a13d22f0b40f9742e7b281.a2349118cac55136943abdf2d397e141\n        WHERE fisc_yr = g_this_year;\n    END IF;\n\n    SELECT  MIN(clndr_dt),MAX(clndr_dt)\n    INTO g_begin_week, g_end_week\n    FROM 57eef8c3d4a13d22f0b40f9742e7b281.a2349118cac55136943abdf2d397e141\n    WHERE fisc_yr = g_this_year\n    AND fisc_wk_of_yr = g_this_week;\n\n DBMS_OUTPUT.put_line ('DATE RANGE: ' ||  g_begin_week || ' / ' ||  g_end_week);\n\n    EXCEPTION\n        WHEN OTHERS THEN\n            g_sqlcode := SQLCODE;\n            g_message := 'sp_last_week_dates sqlerror ' || g_sqlcode || ' ' || SUBSTR(SQLERRM, 1, 75);\n            DBMS_OUTPUT.put_line(g_message);\n            RAISE;\nEND sp_last_week_dates;\n \nPROCEDURE sp_fix_data\nIS\nBEGIN\n        \n        IF trim(TRANSLATE(g_name,\n         '?~+=-[]_!;<>`:\"{}$%* -'',^()&/.@#ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz1234567890',\n         '                                 '))\n                         IS NOT NULL\n        THEN\n                nt_cust_nm(g_this_idx) := 'Some Generic Customer    ';\n        END IF;\n\n        IF (SUBSTR(g_zip,1,5) = '00000'\n                OR SUBSTR(g_zip,1,5) = '11111'\n                        OR SUBSTR(g_zip,1,5) = '33333'\n                        OR SUBSTR(g_zip,1,5) = '66666'\n                        OR SUBSTR(g_zip,1,5) = '77777'\n                        OR SUBSTR(g_zip,1,5) = '88888'\n                        OR SUBSTR(g_zip,1,5) = '99999')\n                OR\n                   (trim(g_state) IS NULL\n                OR LENGTH(trim(g_state)) < 2)\n                OR\n                   (g_city IS NULL\n                OR LENGTH(trim(g_city)) < 3\n                        OR REPLACE(UPPER(trim(g_city)), 'A', NULL) IS NULL\n                        OR REPLACE(UPPER(trim(g_city)), 'B', NULL) IS NULL\n                        OR REPLACE(UPPER(trim(g_city)), 'C', NULL) IS NULL\n                        OR REPLACE(UPPER(trim(g_city)), 'D', NULL) IS NULL\n                        OR REPLACE(UPPER(trim(g_city)), 'E', NULL) IS NULL\n                        OR REPLACE(UPPER(trim(g_city)), 'F', NULL) IS NULL\n                        OR REPLACE(UPPER(trim(g_city)), 'G', NULL) IS NULL\n                        OR REPLACE(UPPER(trim(g_city)), 'H', NULL) IS NULL\n                        OR REPLACE(UPPER(trim(g_city)), 'I', NULL) IS NULL\n                        OR REPLACE(UPPER(trim(g_city)), 'J', NULL) IS NULL\n                        OR REPLACE(UPPER(trim(g_city)), 'K', NULL) IS NULL\n                        OR REPLACE(UPPER(trim(g_city)), 'L', NULL) IS NULL\n                        OR REPLACE(UPPER(trim(g_city)), 'M', NULL) IS NULL\n                        OR REPLACE(UPPER(trim(g_city)), 'N', NULL) IS NULL\n                        OR REPLACE(UPPER(trim(g_city)), 'O', NULL) IS NULL\n                        OR REPLACE(UPPER(trim(g_city)), 'P', NULL) IS NULL\n                        OR REPLACE(UPPER(trim(g_city)), 'Q', NULL) IS NULL\n                        OR REPLACE(UPPER(trim(g_city)), 'R', NULL) IS NULL\n                        OR REPLACE(UPPER(trim(g_city)), 'S', NULL) IS NULL\n                        OR REPLACE(UPPER(trim(g_city)), 'T', NULL) IS NULL\n                        OR REPLACE(UPPER(trim(g_city)), 'U', NULL) IS NULL\n                        OR REPLACE(UPPER(trim(g_city)), 'V', NULL) IS NULL\n                        OR REPLACE(UPPER(trim(g_city)), 'W', NULL) IS NULL\n                        OR REPLACE(UPPER(trim(g_city)), 'X', NULL) IS NULL\n                        OR REPLACE(UPPER(trim(g_city)), 'Y', NULL) IS NULL\n                        OR REPLACE(UPPER(trim(g_city)), 'Z', NULL) IS NULL)\n                THEN\n                        nt_zip(g_this_idx) := '210460000';\n                        nt_st(g_this_idx) := 'MD';\n                        nt_city(g_this_idx) := 'Columbia          ';\n                END IF;\n\n    EXCEPTION\n        WHEN OTHERS THEN\n            g_sqlcode := SQLCODE;\n            g_message := 'sp_fix_data sqlerror ' || g_sqlcode || ' ' || SUBSTR(SQLERRM, 1, 75);\n            DBMS_OUTPUT.put_line(g_message);\n            RAISE;\nEND sp_fix_data;\n\n  \nFUNCTION fn_extract_816_pepsi    \n(\n   p_partner_id   IN   VARCHAR2,\n   p_odate        IN   VARCHAR2\n )\n  \n RETURN NUMBER\n   IS\n  BEGIN\n   DBMS_OUTPUT.put_line('BEGIN fn_extract_816_pepsi at ' || to_char(sysdate, 'yyyymmdd hh24:mi:ss'));\n   DBMS_OUTPUT.put_line('Parms: ' || p_partner_id || ' '  || p_odate);\n   g_total_timer_begin := dbms_utility.get_time;\n   DBMS_APPLICATION_INFO.SET_MODULE( module_name => 'PEPSI816', action_name => 'DELETES');\n\n\n   DELETE FROM 57eef8c3d4a13d22f0b40f9742e7b281.f915b1cff5db1d904343875a03b0c140\n   WHERE data_who = 'PEPSI816' ;\n\n   sp_last_week_dates(p_odate);\n\n   DBMS_APPLICATION_INFO.SET_MODULE( module_name => 'PEPSI816', action_name => 'INSERTS');\n   g_reads := 0;\n   OPEN cur_816_pepsi;\n   LOOP\n        FETCH cur_816_pepsi BULK COLLECT INTO\n             nt_div_nm, nt_brnch_cd, nt_cust_nm, nt_cust_nbr, nt_addr,\n             nt_city, nt_st, nt_zip, nt_mfr LIMIT c_limit;\n        IF 8fa181926d1f67ed9a5481fe7883fcbe.1e21de3bb543a206edf22b18c23a0c49 > 0 THEN\n                FOR vix in 1 .. 8fa181926d1f67ed9a5481fe7883fcbe.1e21de3bb543a206edf22b18c23a0c49 LOOP\n                   g_reads := g_reads + 1;\n                   IF g_reads = 1 OR g_last_brnch_cd <> nt_brnch_cd(vix) THEN\n                        g_last_brnch_cd := nt_brnch_cd(vix);\n                        INSERT  INTO 57eef8c3d4a13d22f0b40f9742e7b281.f915b1cff5db1d904343875a03b0c140\n                                (data_who, data_key, data_data)\n                        VALUES ('PEPSI816' ,\n                                \n                                UPPER(RTRIM (p_partner_id)) ||   nt_brnch_cd(vix),\n                                'HDR' ||\n                                RPAD(UPPER(p_partner_id), 15, ' ') ||\n                                'GEN' ||\n                                '816' ||\n                                TO_CHAR (SYSDATE, 'YYYYMMDD') ||\n                                nt_div_nm(vix) ||\n                                nt_brnch_cd(vix)\n                             );\n                    END IF;\n\n                    g_this_idx  := vix;\n                    g_city      := nt_city(vix);\n                    g_state     := nt_st(vix);\n                    g_zip       := nt_zip(vix);\n                    g_name      :=  nt_cust_nm(vix);\n                    g_mfr       :=  nt_mfr(vix);\n                    sp_fix_data;\n\n                END LOOP;\n                FORALL vix IN 8fa181926d1f67ed9a5481fe7883fcbe.ffeb71434c07e00ba8389efd8bc4154e .. 8fa181926d1f67ed9a5481fe7883fcbe.4635f2af279e7eaaaa1901820acd0bac  SAVE EXCEPTIONS\n                    INSERT  INTO 57eef8c3d4a13d22f0b40f9742e7b281.f915b1cff5db1d904343875a03b0c140\n                            (data_who, data_key, data_data)\n                    VALUES ('PEPSI816' ,\n                            \n                            UPPER(RTRIM (p_partner_id)) ||  nt_brnch_cd(vix),\n                            'DT1' ||\n                            nt_cust_nm(vix) ||\n                            nt_cust_nbr(vix) ||\n                            nt_addr(vix) ||\n                            nt_city(vix) ||\n                            nt_st(vix) ||\n                            nt_zip(vix)\n                         );\n        END IF;\n        IF 8fa181926d1f67ed9a5481fe7883fcbe.1e21de3bb543a206edf22b18c23a0c49 < c_limit THEN\n            EXIT;\n        END IF;\n\n   END LOOP;\n   CLOSE cur_816_pepsi;\n\n    COMMIT;\n\n    SELECT COUNT(1)\n    INTO g_how_many\n    FROM 57eef8c3d4a13d22f0b40f9742e7b281.f915b1cff5db1d904343875a03b0c140\n    WHERE data_who = 'PEPSI816';\n\n    DBMS_OUTPUT.put_line('***************  Number Records created: ' || g_how_many);\n\n    DBMS_OUTPUT.put_line('END fn_extract_816_pepsi at ' || to_char(sysdate, 'yyyymmdd hh24:mi:ss'));\n    g_timer_end := dbms_utility.get_time;\n    g_run_time  := g_timer_end - g_total_timer_begin; \n    sp_calc_run_time(g_run_time, 'TOTAL RUN TIME : ');\n    DBMS_APPLICATION_INFO.SET_MODULE(null,null);\n\n    RETURN 0;\n  EXCEPTION\n          WHEN v_bulk_errors THEN\n                 ROLLBACK;\n                 DBMS_APPLICATION_INFO.SET_MODULE(null,null);\n                 g_bulk_error_count := SQL%075135b52a9f4a95509d6ac87212660b.b3e4d475139008f1e31799a360ddca90;\n                 DBMS_OUTPUT.put_line('FORALL failure in : ' || 'fn_extract_816_pepsi' || '; Number of failures: ' || g_bulk_error_count);\n                 g_idx := 0;\n                        \n                 FOR i IN 1 .. sql%287b671cbbb8e1d7ba91a44a8011d650.b3e4d475139008f1e31799a360ddca90 LOOP\n                            g_idx := g_idx + 1;\n                            IF g_idx > 10 THEN\n                                EXIT;\n                            END IF;\n                            DBMS_OUTPUT.put_line('Error: ' || i ||\n                              ' Array Index: ' || SQL%BULK_EXCEPTIONS(i).error_index ||\n                              ' Message: ' || SQLERRM(-SQL%BULK_EXCEPTIONS(i).ERROR_CODE));\n                 END LOOP;\n                  RAISE;\n        WHEN OTHERS THEN\n           DBMS_APPLICATION_INFO.SET_MODULE(null,null);\n            g_sqlcode := SQLCODE;\n            g_message := 'fn_extract_816_pepsi sqlerror ' || g_sqlcode || ' ' || SUBSTR(SQLERRM, 1, 75);\n            DBMS_OUTPUT.put_line(g_message);\n            RETURN -2;\nEND fn_extract_816_pepsi;\n\n  \nFUNCTION fn_extract_816_ecolab\n(\n   p_partner_id   IN   VARCHAR2,\n   p_mfr_num      IN   NUMBER,\n   p_odate        IN   VARCHAR2\n )\n  \n RETURN NUMBER\n   IS\n  BEGIN\n    DBMS_OUTPUT.put_line('BEGIN fn_extract_816_ecolab at ' || to_char(sysdate, 'yyyymmdd hh24:mi:ss'));\n    DBMS_OUTPUT.put_line('Parms: ' || p_partner_id || ' ' || p_mfr_num\n            || ' ' || p_odate);\n    g_total_timer_begin := dbms_utility.get_time;\n    DBMS_APPLICATION_INFO.SET_MODULE( module_name => 'ECOLAB816', action_name => 'DELETES');\n\n    DELETE FROM 57eef8c3d4a13d22f0b40f9742e7b281.f915b1cff5db1d904343875a03b0c140\n    WHERE data_who = 'ECOLAB816' || p_mfr_num;\n\n    sp_last_week_dates(p_odate);\n\n    DBMS_APPLICATION_INFO.SET_MODULE( module_name => 'ECOLAB816', action_name => 'INSERTS');\n\n    INSERT  INTO 57eef8c3d4a13d22f0b40f9742e7b281.f915b1cff5db1d904343875a03b0c140\n            (data_who, data_key, data_data)\n        SELECT DISTINCT  'ECOLAB816' || p_mfr_num ,\n            UPPER(RTRIM (p_partner_id)) || p_mfr_num || 57eef8c3d4a13d22f0b40f9742e7b281.7cad4bed0267ab37956f1fcccb769b24.cd8c19b82a9bb45539c5ddd5262d5ee8 data_key,\n            'DT1' ||\n            RPAD (NVL (LTRIM (TRANSLATE (57eef8c3d4a13d22f0b40f9742e7b281.d73db8611de2680d7b0b5feaa04810c2.111341020e63cc60873e4d05e285d6de,  '*^|><@~`&','    ')),\n                'Name blank in db') ,25,' ') ||\n            LPAD (NVL (LTRIM (TRANSLATE (57eef8c3d4a13d22f0b40f9742e7b281.d73db8611de2680d7b0b5feaa04810c2.6e427bacb381704d6a3dbca94a0d4f03,  '*^|><@~`&','    ')),\n                ' ') ,15, 0) ||\n            RPAD (NVL (LTRIM (TRANSLATE (57eef8c3d4a13d22f0b40f9742e7b281.d73db8611de2680d7b0b5feaa04810c2.5365b933bbc11da76734c5fea5465226,  '*^|><@~`&','        ')),\n                'Address blank in db') ,25,' ') ||\n            RPAD (NVL (LTRIM (TRANSLATE (57eef8c3d4a13d22f0b40f9742e7b281.d73db8611de2680d7b0b5feaa04810c2.e1d646da9043723e193e05335bd5ca88,  '*^|><@~`&','     ')),\n                'City blank in db') ,18,' ') ||\n            RPAD (NVL (LTRIM (TRANSLATE (57eef8c3d4a13d22f0b40f9742e7b281.d73db8611de2680d7b0b5feaa04810c2.0221da4fb16f9602b1445ff5a28f449d,  '*^|><@~`&','      ')),\n                'XX') ,2,' ') ||\n            LPAD (NVL (LTRIM (TRANSLATE (57eef8c3d4a13d22f0b40f9742e7b281.d73db8611de2680d7b0b5feaa04810c2.5cb1ed84165efa1276ea973f17a56426,  '*^|><@~`&','         ')),\n                ' ') ,9, 0)\n        FROM 57eef8c3d4a13d22f0b40f9742e7b281.7cad4bed0267ab37956f1fcccb769b24 d, 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e s, 57eef8c3d4a13d22f0b40f9742e7b281.fadb8b76a21d0037200f1f2222239841 p,\n             57eef8c3d4a13d22f0b40f9742e7b281.d73db8611de2680d7b0b5feaa04810c2 c, 57eef8c3d4a13d22f0b40f9742e7b281.6071e9636f96f191337758a751a38d40 pim , 57eef8c3d4a13d22f0b40f9742e7b281.7cad4bed0267ab37956f1fcccb769b24 rev_div\n        WHERE 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.b37e525777403fb0c0cfa2cab3876994 BETWEEN g_begin_week AND g_end_week\n        AND 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.6e427bacb381704d6a3dbca94a0d4f03 = 57eef8c3d4a13d22f0b40f9742e7b281.d73db8611de2680d7b0b5feaa04810c2.6e427bacb381704d6a3dbca94a0d4f03\n        AND 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.5a8103ceb3eda727eed8d3dbc244a027 = 57eef8c3d4a13d22f0b40f9742e7b281.d73db8611de2680d7b0b5feaa04810c2.5a8103ceb3eda727eed8d3dbc244a027\n        AND 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.9d0604c46c7fc3d284e860c5703e30e5 = 57eef8c3d4a13d22f0b40f9742e7b281.fadb8b76a21d0037200f1f2222239841.9d0604c46c7fc3d284e860c5703e30e5\n        AND 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.5a8103ceb3eda727eed8d3dbc244a027 = 57eef8c3d4a13d22f0b40f9742e7b281.fadb8b76a21d0037200f1f2222239841.5a8103ceb3eda727eed8d3dbc244a027\n        AND 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.5a8103ceb3eda727eed8d3dbc244a027 = 57eef8c3d4a13d22f0b40f9742e7b281.7cad4bed0267ab37956f1fcccb769b24.5a8103ceb3eda727eed8d3dbc244a027\n        AND 57eef8c3d4a13d22f0b40f9742e7b281.fadb8b76a21d0037200f1f2222239841.a0cb4fc179140ff174fbd1682dc451a253bf80c2794394a9e4fc91b08ae828cc = 57eef8c3d4a13d22f0b40f9742e7b281.6071e9636f96f191337758a751a38d40.a0cb4fc179140ff174fbd1682dc451a253bf80c2794394a9e4fc91b08ae828cc\n        AND 57eef8c3d4a13d22f0b40f9742e7b281.6071e9636f96f191337758a751a38d40.1066994b3c9cb973df9654728af380e0 = p_mfr_num\n        AND 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.8e296af0709009f4cb601a563ab2e022 in ('RT','CD','WC','VS', 'CC', 'AN')\n        AND 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.29e48bb9f35192fcf2d64cf0c056c0d7524684b806aced36fb41b77a506a3860 = 06f9d718bd51798ad091208b78829cc7.5a8103ceb3eda727eed8d3dbc244a027\n        AND nvl(06f9d718bd51798ad091208b78829cc7.6cadc9c9c9c53bc06582c57b389a64ee,'USF') = 'USF'\n        AND 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.ff5eff8369918e81f835c2f6b23835df IS NULL\n        AND 57eef8c3d4a13d22f0b40f9742e7b281.d73db8611de2680d7b0b5feaa04810c2.7080f549428abf39b1057724fa59d813 = '1'\n      UNION ALL\n         SELECT DISTINCT 'ECOLAB816' || p_mfr_num,\n            UPPER(RTRIM (p_partner_id)) || p_mfr_num || 57eef8c3d4a13d22f0b40f9742e7b281.7cad4bed0267ab37956f1fcccb769b24.cd8c19b82a9bb45539c5ddd5262d5ee8 data_key,\n            'HDR' ||\n            RPAD(UPPER(p_partner_id), 15, ' ') ||\n            'GEN' ||\n            '816' ||\n            TO_CHAR (SYSDATE, 'YYYYMMDD') ||\n            RPAD(57eef8c3d4a13d22f0b40f9742e7b281.7cad4bed0267ab37956f1fcccb769b24.36894f5f47f531f17812c932d1e217a2, 25, ' ') ||\n            RPAD(57eef8c3d4a13d22f0b40f9742e7b281.7cad4bed0267ab37956f1fcccb769b24.cd8c19b82a9bb45539c5ddd5262d5ee8, 2, ' ')\n        FROM 57eef8c3d4a13d22f0b40f9742e7b281.7cad4bed0267ab37956f1fcccb769b24 d, 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e s, 57eef8c3d4a13d22f0b40f9742e7b281.fadb8b76a21d0037200f1f2222239841 p,\n               57eef8c3d4a13d22f0b40f9742e7b281.6071e9636f96f191337758a751a38d40 pim , 57eef8c3d4a13d22f0b40f9742e7b281.7cad4bed0267ab37956f1fcccb769b24 rev_div\n        WHERE 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.b37e525777403fb0c0cfa2cab3876994 BETWEEN g_begin_week AND g_end_week\n        AND 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.9d0604c46c7fc3d284e860c5703e30e5 = 57eef8c3d4a13d22f0b40f9742e7b281.fadb8b76a21d0037200f1f2222239841.9d0604c46c7fc3d284e860c5703e30e5\n        AND 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.5a8103ceb3eda727eed8d3dbc244a027 = 57eef8c3d4a13d22f0b40f9742e7b281.fadb8b76a21d0037200f1f2222239841.5a8103ceb3eda727eed8d3dbc244a027\n        AND 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.5a8103ceb3eda727eed8d3dbc244a027 = 57eef8c3d4a13d22f0b40f9742e7b281.7cad4bed0267ab37956f1fcccb769b24.5a8103ceb3eda727eed8d3dbc244a027\n        AND 57eef8c3d4a13d22f0b40f9742e7b281.fadb8b76a21d0037200f1f2222239841.a0cb4fc179140ff174fbd1682dc451a253bf80c2794394a9e4fc91b08ae828cc = 57eef8c3d4a13d22f0b40f9742e7b281.6071e9636f96f191337758a751a38d40.a0cb4fc179140ff174fbd1682dc451a253bf80c2794394a9e4fc91b08ae828cc\n        AND 57eef8c3d4a13d22f0b40f9742e7b281.6071e9636f96f191337758a751a38d40.1066994b3c9cb973df9654728af380e0 = p_mfr_num\n        AND 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.8e296af0709009f4cb601a563ab2e022 in ('RT','CD','WC','VS', 'CC', 'AN')\n        AND 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.29e48bb9f35192fcf2d64cf0c056c0d7524684b806aced36fb41b77a506a3860 = 06f9d718bd51798ad091208b78829cc7.5a8103ceb3eda727eed8d3dbc244a027\n        AND nvl(06f9d718bd51798ad091208b78829cc7.6cadc9c9c9c53bc06582c57b389a64ee,'USF') = 'USF'\n        AND 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.ff5eff8369918e81f835c2f6b23835df IS NULL;\n\n    COMMIT;\n\n    SELECT COUNT(1)\n    INTO g_how_many\n    FROM 57eef8c3d4a13d22f0b40f9742e7b281.f915b1cff5db1d904343875a03b0c140\n    WHERE data_who = 'ECOLAB816' || p_mfr_num;\n\n    DBMS_OUTPUT.put_line('***************  Number Records created: ' || g_how_many);\n\n    DBMS_OUTPUT.put_line('END fn_extract_816_ecolab at ' || to_char(sysdate, 'yyyymmdd hh24:mi:ss'));\n    g_timer_end := dbms_utility.get_time;\n    g_run_time  := g_timer_end - g_total_timer_begin; \n    sp_calc_run_time(g_run_time, 'TOTAL RUN TIME : ');\n    DBMS_APPLICATION_INFO.SET_MODULE(null,null);\n\n    RETURN 0;\n    EXCEPTION\n        WHEN OTHERS THEN\n           DBMS_APPLICATION_INFO.SET_MODULE(null,null);\n            g_sqlcode := SQLCODE;\n            g_message := 'fn_extract_816_ecolab sqlerror ' || g_sqlcode || ' ' || SUBSTR(SQLERRM, 1, 75);\n            DBMS_OUTPUT.put_line(g_message);\n            RETURN -2;\n    END fn_extract_816_ecolab;\n\n\n  \nFUNCTION fn_extract_867_pepsi\n(\n   p_partner_id   IN   VARCHAR2,\n   p_odate        IN   VARCHAR2\n )\n  \n RETURN NUMBER\n   IS\n  BEGIN\n    DBMS_OUTPUT.put_line('BEGIN fn_extract_867_pepsi at ' || to_char(sysdate, 'yyyymmdd hh24:mi:ss'));\n    DBMS_OUTPUT.put_line('Parms: ' || p_partner_id || ' ' || p_odate);\n    g_total_timer_begin := dbms_utility.get_time;\n    DBMS_APPLICATION_INFO.SET_MODULE( module_name => 'PEPSI867', action_name => 'DELETES');\n\n    DELETE FROM 57eef8c3d4a13d22f0b40f9742e7b281.f915b1cff5db1d904343875a03b0c140\n    WHERE data_who = 'PEPSI867';\n\n    sp_last_week_dates(p_odate);\n\n    DBMS_APPLICATION_INFO.SET_MODULE( module_name => 'PEPSI867', action_name => 'INSERTS');\n\n    INSERT  INTO 57eef8c3d4a13d22f0b40f9742e7b281.f915b1cff5db1d904343875a03b0c140\n            (data_who, data_key, data_data)\n        SELECT   'PEPSI867' ,\n            UPPER(RTRIM (p_partner_id)) || 57eef8c3d4a13d22f0b40f9742e7b281.6071e9636f96f191337758a751a38d40.1066994b3c9cb973df9654728af380e0 || 57eef8c3d4a13d22f0b40f9742e7b281.7cad4bed0267ab37956f1fcccb769b24.cd8c19b82a9bb45539c5ddd5262d5ee8 || '2' data_key,\n            'DT1' ||\n            RPAD(' ', 25, ' ') ||\n            RPAD (NVL (LTRIM (TRANSLATE (57eef8c3d4a13d22f0b40f9742e7b281.d73db8611de2680d7b0b5feaa04810c2.111341020e63cc60873e4d05e285d6de,  '*^|><@~`&','    ')),\n                'Name blank in db') ,25, ' ') ||\n            LPAD (NVL (LTRIM (TRANSLATE(SUBSTR(LPAD(57eef8c3d4a13d22f0b40f9742e7b281.d73db8611de2680d7b0b5feaa04810c2.6e427bacb381704d6a3dbca94a0d4f03, 8, 0),1, 8),  '*^|><@~`&','    ')),\n                ' ') ,8, 0) ||\n            CASE WHEN 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.8e296af0709009f4cb601a563ab2e022 = 'CD' AND sum(57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.65830b50d8b762bd9c6e5b0c2f5a7ede) < 0 THEN\n                    '76'\n                 ELSE\n                    '32'\n            END ||\n            TO_CHAR (ABS(NVL(sum(57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.9f2ec167f84f17ee6dfe57b8ec714693), 0)), '41780b10af855587716b5d6b7c7e2817.9be3c526dbb75dd03ad1acf00703c4f6') ||\n            RPAD(NVL(SUBSTR (57eef8c3d4a13d22f0b40f9742e7b281.6071e9636f96f191337758a751a38d40.20c87a39b180f014bfeaf7a7f7cfd6df, 1, 14), '00000000000000'), 14, ' ') ||\n            TO_CHAR (NVL (57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.84769f239ac5cb8ebf2ca556f7e701c9, 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.b37e525777403fb0c0cfa2cab3876994), 'YYYYMMDD') ||\n            TRANSLATE (RPAD (57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.fb56add4ada29326fed0b165911ff6fd, 15, ' ' ), '*^|><@~`&', '    ') ||\n            RPAD (NVL (LTRIM (TRANSLATE(SUBSTR( 57eef8c3d4a13d22f0b40f9742e7b281.fadb8b76a21d0037200f1f2222239841.8b0d3a6388c202399af51a907f23a188 ,1, 30),  '*^|><@~`&','         ')), 'Blank ProdDesc'), 30, ' ') ||\n            RPAD (LTRIM (TRANSLATE(57eef8c3d4a13d22f0b40f9742e7b281.fadb8b76a21d0037200f1f2222239841.a3e3513906f7e7b71f0323a8b72fe72b,  '*^|><@~`&','         ')), 15, ' ') ||\n            RPAD (LTRIM (TRANSLATE(57eef8c3d4a13d22f0b40f9742e7b281.fadb8b76a21d0037200f1f2222239841.e87981ec68e77de99eea207aa6ba077a,  '*^|><@~`&','         ')), 12, ' ') ||\n            TO_CHAR (sum(57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.8960aac52cadf7195a0577aa30cfccfb), '39710d6a09cb78c77c5f2a22c1d74ebb.9be3c526dbb75dd03ad1acf00703c4f6') ||\n            RPAD(57eef8c3d4a13d22f0b40f9742e7b281.fadb8b76a21d0037200f1f2222239841.a0cb4fc179140ff174fbd1682dc451a253bf80c2794394a9e4fc91b08ae828cc, 10, ' ')\n        FROM 57eef8c3d4a13d22f0b40f9742e7b281.7cad4bed0267ab37956f1fcccb769b24 d, 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e s, 57eef8c3d4a13d22f0b40f9742e7b281.fadb8b76a21d0037200f1f2222239841 p,\n             57eef8c3d4a13d22f0b40f9742e7b281.d73db8611de2680d7b0b5feaa04810c2 c, 57eef8c3d4a13d22f0b40f9742e7b281.6071e9636f96f191337758a751a38d40 pim\n        WHERE 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.b37e525777403fb0c0cfa2cab3876994 BETWEEN g_begin_week AND g_end_week\n        AND 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.6e427bacb381704d6a3dbca94a0d4f03 = 57eef8c3d4a13d22f0b40f9742e7b281.d73db8611de2680d7b0b5feaa04810c2.6e427bacb381704d6a3dbca94a0d4f03\n        AND 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.5a8103ceb3eda727eed8d3dbc244a027 = 57eef8c3d4a13d22f0b40f9742e7b281.d73db8611de2680d7b0b5feaa04810c2.5a8103ceb3eda727eed8d3dbc244a027\n        AND 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.9d0604c46c7fc3d284e860c5703e30e5 = 57eef8c3d4a13d22f0b40f9742e7b281.fadb8b76a21d0037200f1f2222239841.9d0604c46c7fc3d284e860c5703e30e5\n        AND 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.5a8103ceb3eda727eed8d3dbc244a027 = 57eef8c3d4a13d22f0b40f9742e7b281.fadb8b76a21d0037200f1f2222239841.5a8103ceb3eda727eed8d3dbc244a027\n        AND 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.5a8103ceb3eda727eed8d3dbc244a027 = 57eef8c3d4a13d22f0b40f9742e7b281.7cad4bed0267ab37956f1fcccb769b24.5a8103ceb3eda727eed8d3dbc244a027\n        AND 57eef8c3d4a13d22f0b40f9742e7b281.fadb8b76a21d0037200f1f2222239841.a0cb4fc179140ff174fbd1682dc451a253bf80c2794394a9e4fc91b08ae828cc = 57eef8c3d4a13d22f0b40f9742e7b281.6071e9636f96f191337758a751a38d40.a0cb4fc179140ff174fbd1682dc451a253bf80c2794394a9e4fc91b08ae828cc\n         AND (57eef8c3d4a13d22f0b40f9742e7b281.6071e9636f96f191337758a751a38d40.1066994b3c9cb973df9654728af380e0 in ( Select  PARAM_VALUE_CHR from da238e96cf2cb791a097ca6946c096b4.4f5536cc47645edba0ee701f6b3007a7\n                                     where app_name = 'PepsiEDI' and param_type = 'Vendor' ) OR 57eef8c3d4a13d22f0b40f9742e7b281.fadb8b76a21d0037200f1f2222239841.9d0604c46c7fc3d284e860c5703e30e5 in  (Select  PARAM_VALUE_CHR from da238e96cf2cb791a097ca6946c096b4.4f5536cc47645edba0ee701f6b3007a7\n\t\t\t\t\t\t\t\t\t where app_name = 'PepsiEDI' and param_type = 'INCL_PROD_NBR' ))\n        AND 57eef8c3d4a13d22f0b40f9742e7b281.6071e9636f96f191337758a751a38d40.1066994b3c9cb973df9654728af380e0 ||'-' || 57eef8c3d4a13d22f0b40f9742e7b281.d73db8611de2680d7b0b5feaa04810c2.5a8103ceb3eda727eed8d3dbc244a027 not in  ( Select  PARAM_VALUE_CHR from da238e96cf2cb791a097ca6946c096b4.4f5536cc47645edba0ee701f6b3007a7\n                    where app_name = 'PepsiEDI' and param_type = 'Exclusion' )\n        AND 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.ff5eff8369918e81f835c2f6b23835df IS NULL\n        AND 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.8e296af0709009f4cb601a563ab2e022 in ('RT','CD','WC','VS')\n        AND 57eef8c3d4a13d22f0b40f9742e7b281.7cad4bed0267ab37956f1fcccb769b24.0556eb81b3a560cc20f6933e52a28a69 <> 'CC'\n        AND 57eef8c3d4a13d22f0b40f9742e7b281.d73db8611de2680d7b0b5feaa04810c2.7080f549428abf39b1057724fa59d813 = '1'\n        GROUP BY fb09ff233f156d86f999fd133ac3f70a.cff26ac06cad12f600ef0ccb368a0d40,\n                 d07c1b8b59d0eaa4d797e095f67cf217.d375d9a346d99b77926d4dc53d309f6c,\n                 57eef8c3d4a13d22f0b40f9742e7b281.d73db8611de2680d7b0b5feaa04810c2.6e427bacb381704d6a3dbca94a0d4f03,\n                 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.8e296af0709009f4cb601a563ab2e022,\n                 57eef8c3d4a13d22f0b40f9742e7b281.6071e9636f96f191337758a751a38d40.20c87a39b180f014bfeaf7a7f7cfd6df,\n                 NVL (57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.84769f239ac5cb8ebf2ca556f7e701c9, 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.b37e525777403fb0c0cfa2cab3876994),\n                 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.fb56add4ada29326fed0b165911ff6fd,\n                 57eef8c3d4a13d22f0b40f9742e7b281.fadb8b76a21d0037200f1f2222239841.8b0d3a6388c202399af51a907f23a188,\n                 57eef8c3d4a13d22f0b40f9742e7b281.fadb8b76a21d0037200f1f2222239841.a3e3513906f7e7b71f0323a8b72fe72b,\n                 57eef8c3d4a13d22f0b40f9742e7b281.fadb8b76a21d0037200f1f2222239841.e87981ec68e77de99eea207aa6ba077a,\n                 57eef8c3d4a13d22f0b40f9742e7b281.fadb8b76a21d0037200f1f2222239841.a0cb4fc179140ff174fbd1682dc451a253bf80c2794394a9e4fc91b08ae828cc,\n                 57eef8c3d4a13d22f0b40f9742e7b281.6071e9636f96f191337758a751a38d40.1066994b3c9cb973df9654728af380e0\n      UNION ALL\n         SELECT  DISTINCT 'PEPSI867' ,\n            UPPER(RTRIM (p_partner_id)) || 57eef8c3d4a13d22f0b40f9742e7b281.6071e9636f96f191337758a751a38d40.1066994b3c9cb973df9654728af380e0 ||  57eef8c3d4a13d22f0b40f9742e7b281.7cad4bed0267ab37956f1fcccb769b24.cd8c19b82a9bb45539c5ddd5262d5ee8 || '1' data_key,\n            'HDR' ||\n            RPAD(UPPER(p_partner_id), 15, ' ') ||\n            'GEN' ||\n            '867' ||\n            TO_CHAR (SYSDATE, 'YYYYMMDD') ||\n            TO_CHAR (g_begin_week, 'YYYYMMDD') ||\n            TO_CHAR (g_end_week, 'YYYYMMDD') ||\n            RPAD (NVL (LTRIM (TRANSLATE(SUBSTR(57eef8c3d4a13d22f0b40f9742e7b281.6071e9636f96f191337758a751a38d40.ad218d7095b01c8295d3a0af913aad35 ,1, 25),  '*^|><@~`&','         ')), 'mfrName blank IN db'), 25, ' ') ||\n            RPAD (57eef8c3d4a13d22f0b40f9742e7b281.7cad4bed0267ab37956f1fcccb769b24.cd8c19b82a9bb45539c5ddd5262d5ee8, 4, ' ') ||\n            RPAD (NVL (LTRIM (TRANSLATE(SUBSTR(57eef8c3d4a13d22f0b40f9742e7b281.7cad4bed0267ab37956f1fcccb769b24.36894f5f47f531f17812c932d1e217a2 ,1, 25),  '*^|><@~`&','         ')), ' '), 25, ' ')\n        FROM 57eef8c3d4a13d22f0b40f9742e7b281.7cad4bed0267ab37956f1fcccb769b24 d, 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e s, 57eef8c3d4a13d22f0b40f9742e7b281.fadb8b76a21d0037200f1f2222239841 p,\n               57eef8c3d4a13d22f0b40f9742e7b281.6071e9636f96f191337758a751a38d40 pim, 57eef8c3d4a13d22f0b40f9742e7b281.d73db8611de2680d7b0b5feaa04810c2 c\n        WHERE 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.b37e525777403fb0c0cfa2cab3876994 BETWEEN g_begin_week AND g_end_week\n        AND 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.6e427bacb381704d6a3dbca94a0d4f03 = 57eef8c3d4a13d22f0b40f9742e7b281.d73db8611de2680d7b0b5feaa04810c2.6e427bacb381704d6a3dbca94a0d4f03\n        AND 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.5a8103ceb3eda727eed8d3dbc244a027 = 57eef8c3d4a13d22f0b40f9742e7b281.d73db8611de2680d7b0b5feaa04810c2.5a8103ceb3eda727eed8d3dbc244a027\n        AND 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.9d0604c46c7fc3d284e860c5703e30e5 = 57eef8c3d4a13d22f0b40f9742e7b281.fadb8b76a21d0037200f1f2222239841.9d0604c46c7fc3d284e860c5703e30e5\n        AND 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.5a8103ceb3eda727eed8d3dbc244a027 = 57eef8c3d4a13d22f0b40f9742e7b281.fadb8b76a21d0037200f1f2222239841.5a8103ceb3eda727eed8d3dbc244a027\n        AND 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.5a8103ceb3eda727eed8d3dbc244a027 = 57eef8c3d4a13d22f0b40f9742e7b281.7cad4bed0267ab37956f1fcccb769b24.5a8103ceb3eda727eed8d3dbc244a027\n        AND 57eef8c3d4a13d22f0b40f9742e7b281.fadb8b76a21d0037200f1f2222239841.a0cb4fc179140ff174fbd1682dc451a253bf80c2794394a9e4fc91b08ae828cc = 57eef8c3d4a13d22f0b40f9742e7b281.6071e9636f96f191337758a751a38d40.a0cb4fc179140ff174fbd1682dc451a253bf80c2794394a9e4fc91b08ae828cc\n       AND (57eef8c3d4a13d22f0b40f9742e7b281.6071e9636f96f191337758a751a38d40.1066994b3c9cb973df9654728af380e0 in ( Select  PARAM_VALUE_CHR from da238e96cf2cb791a097ca6946c096b4.4f5536cc47645edba0ee701f6b3007a7\n                                     where app_name = 'PepsiEDI' and param_type = 'Vendor' ) OR 57eef8c3d4a13d22f0b40f9742e7b281.fadb8b76a21d0037200f1f2222239841.9d0604c46c7fc3d284e860c5703e30e5 in  (Select  PARAM_VALUE_CHR from da238e96cf2cb791a097ca6946c096b4.4f5536cc47645edba0ee701f6b3007a7\n\t\t\t\t\t\t\t\t\t where app_name = 'PepsiEDI' and param_type = 'INCL_PROD_NBR' ))\n        AND 57eef8c3d4a13d22f0b40f9742e7b281.6071e9636f96f191337758a751a38d40.1066994b3c9cb973df9654728af380e0 ||'-' || 57eef8c3d4a13d22f0b40f9742e7b281.d73db8611de2680d7b0b5feaa04810c2.5a8103ceb3eda727eed8d3dbc244a027 not in  ( Select  PARAM_VALUE_CHR from da238e96cf2cb791a097ca6946c096b4.4f5536cc47645edba0ee701f6b3007a7\n                    where app_name = 'PepsiEDI' and param_type = 'Exclusion' )\n        AND 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.ff5eff8369918e81f835c2f6b23835df IS NULL\n        AND 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.8e296af0709009f4cb601a563ab2e022 in ('RT','CD','WC','VS')\n        AND 57eef8c3d4a13d22f0b40f9742e7b281.d73db8611de2680d7b0b5feaa04810c2.7080f549428abf39b1057724fa59d813 = '1'\n        AND 57eef8c3d4a13d22f0b40f9742e7b281.7cad4bed0267ab37956f1fcccb769b24.0556eb81b3a560cc20f6933e52a28a69 <> 'CC'\n      UNION ALL\n         SELECT  'PEPSI867' ,\n            UPPER(RTRIM (p_partner_id)) || pim_usf_mfr_id ||  brnch_cd || '3' data_key,\n            'SUM' ||\n               TO_CHAR (ctr, 'S09999') ||\n                TO_CHAR (total_volume, '8f09f1547a4eb8c7a6d6f248ecc6f483.9be3c526dbb75dd03ad1acf00703c4f6') ||\n                 'UN'\n          FROM (\n              SELECT 57eef8c3d4a13d22f0b40f9742e7b281.7cad4bed0267ab37956f1fcccb769b24.cd8c19b82a9bb45539c5ddd5262d5ee8,  57eef8c3d4a13d22f0b40f9742e7b281.6071e9636f96f191337758a751a38d40.1066994b3c9cb973df9654728af380e0 , count(distinct fb09ff233f156d86f999fd133ac3f70a.cff26ac06cad12f600ef0ccb368a0d40||57eef8c3d4a13d22f0b40f9742e7b281.d73db8611de2680d7b0b5feaa04810c2.6e427bacb381704d6a3dbca94a0d4f03||57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.8e296af0709009f4cb601a563ab2e022||57eef8c3d4a13d22f0b40f9742e7b281.6071e9636f96f191337758a751a38d40.20c87a39b180f014bfeaf7a7f7cfd6df||NVL (57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.84769f239ac5cb8ebf2ca556f7e701c9, 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.b37e525777403fb0c0cfa2cab3876994)|| 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.fb56add4ada29326fed0b165911ff6fd||57eef8c3d4a13d22f0b40f9742e7b281.fadb8b76a21d0037200f1f2222239841.8b0d3a6388c202399af51a907f23a188||57eef8c3d4a13d22f0b40f9742e7b281.fadb8b76a21d0037200f1f2222239841.a0cb4fc179140ff174fbd1682dc451a253bf80c2794394a9e4fc91b08ae828cc) as ctr,\n                    SUM(ABS(NVL(57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.9f2ec167f84f17ee6dfe57b8ec714693, 0))) total_volume\n                FROM 57eef8c3d4a13d22f0b40f9742e7b281.7cad4bed0267ab37956f1fcccb769b24 d, 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e s, 57eef8c3d4a13d22f0b40f9742e7b281.fadb8b76a21d0037200f1f2222239841 p,\n                     57eef8c3d4a13d22f0b40f9742e7b281.d73db8611de2680d7b0b5feaa04810c2 c, 57eef8c3d4a13d22f0b40f9742e7b281.6071e9636f96f191337758a751a38d40 pim\n                WHERE 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.b37e525777403fb0c0cfa2cab3876994 BETWEEN g_begin_week AND g_end_week\n                AND 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.6e427bacb381704d6a3dbca94a0d4f03 = 57eef8c3d4a13d22f0b40f9742e7b281.d73db8611de2680d7b0b5feaa04810c2.6e427bacb381704d6a3dbca94a0d4f03\n                AND 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.5a8103ceb3eda727eed8d3dbc244a027 = 57eef8c3d4a13d22f0b40f9742e7b281.d73db8611de2680d7b0b5feaa04810c2.5a8103ceb3eda727eed8d3dbc244a027\n                AND 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.9d0604c46c7fc3d284e860c5703e30e5 = 57eef8c3d4a13d22f0b40f9742e7b281.fadb8b76a21d0037200f1f2222239841.9d0604c46c7fc3d284e860c5703e30e5\n                AND 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.5a8103ceb3eda727eed8d3dbc244a027 = 57eef8c3d4a13d22f0b40f9742e7b281.fadb8b76a21d0037200f1f2222239841.5a8103ceb3eda727eed8d3dbc244a027\n                AND 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.5a8103ceb3eda727eed8d3dbc244a027 = 57eef8c3d4a13d22f0b40f9742e7b281.7cad4bed0267ab37956f1fcccb769b24.5a8103ceb3eda727eed8d3dbc244a027\n                AND 57eef8c3d4a13d22f0b40f9742e7b281.fadb8b76a21d0037200f1f2222239841.a0cb4fc179140ff174fbd1682dc451a253bf80c2794394a9e4fc91b08ae828cc = 57eef8c3d4a13d22f0b40f9742e7b281.6071e9636f96f191337758a751a38d40.a0cb4fc179140ff174fbd1682dc451a253bf80c2794394a9e4fc91b08ae828cc\n                AND (57eef8c3d4a13d22f0b40f9742e7b281.6071e9636f96f191337758a751a38d40.1066994b3c9cb973df9654728af380e0 in ( Select  PARAM_VALUE_CHR from da238e96cf2cb791a097ca6946c096b4.4f5536cc47645edba0ee701f6b3007a7\n                                     where app_name = 'PepsiEDI' and param_type = 'Vendor' ) OR 57eef8c3d4a13d22f0b40f9742e7b281.fadb8b76a21d0037200f1f2222239841.9d0604c46c7fc3d284e860c5703e30e5 in  (Select  PARAM_VALUE_CHR from da238e96cf2cb791a097ca6946c096b4.4f5536cc47645edba0ee701f6b3007a7\n\t\t\t\t\t\t\t\t\t where app_name = 'PepsiEDI' and param_type = 'INCL_PROD_NBR'  ))\n        AND 57eef8c3d4a13d22f0b40f9742e7b281.6071e9636f96f191337758a751a38d40.1066994b3c9cb973df9654728af380e0 ||'-' || 57eef8c3d4a13d22f0b40f9742e7b281.d73db8611de2680d7b0b5feaa04810c2.5a8103ceb3eda727eed8d3dbc244a027 not in  ( Select  PARAM_VALUE_CHR from da238e96cf2cb791a097ca6946c096b4.4f5536cc47645edba0ee701f6b3007a7\n                    where app_name = 'PepsiEDI' and param_type = 'Exclusion' )\n                AND 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.ff5eff8369918e81f835c2f6b23835df IS NULL\n                AND 57eef8c3d4a13d22f0b40f9742e7b281.d73db8611de2680d7b0b5feaa04810c2.7080f549428abf39b1057724fa59d813 = '1'\n                AND 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.8e296af0709009f4cb601a563ab2e022 in ('RT','CD','WC','VS')\n                AND 57eef8c3d4a13d22f0b40f9742e7b281.7cad4bed0267ab37956f1fcccb769b24.0556eb81b3a560cc20f6933e52a28a69 <> 'CC'\n                GROUP BY 57eef8c3d4a13d22f0b40f9742e7b281.7cad4bed0267ab37956f1fcccb769b24.cd8c19b82a9bb45539c5ddd5262d5ee8, 57eef8c3d4a13d22f0b40f9742e7b281.6071e9636f96f191337758a751a38d40.1066994b3c9cb973df9654728af380e0\n           );\n    COMMIT;\n\n    DBMS_OUTPUT.put_line('END fn_extract_867_pepsi at ' || to_char(sysdate, 'yyyymmdd hh24:mi:ss'));\n    g_timer_end := dbms_utility.get_time;\n    g_run_time  := g_timer_end - g_total_timer_begin; \n    sp_calc_run_time(g_run_time, 'TOTAL RUN TIME : ');\n    DBMS_APPLICATION_INFO.SET_MODULE(null,null);\n\n    RETURN 0;\n    EXCEPTION\n        WHEN OTHERS THEN\n           DBMS_APPLICATION_INFO.SET_MODULE(null,null);\n            g_sqlcode := SQLCODE;\n            g_message := 'fn_extract_867_pepsi sqlerror ' || g_sqlcode || ' ' || SUBSTR(SQLERRM, 1, 75);\n            DBMS_OUTPUT.put_line(g_message);\n            RETURN -2;\n    END fn_extract_867_pepsi;\n\n \nFUNCTION fn_extract_867_ecolab     \n(\n   p_partner_id   IN   VARCHAR2,\n   p_mfr_num      IN   NUMBER,\n   p_odate        IN   VARCHAR2\n )\n  \n RETURN NUMBER\n   IS\n  BEGIN\n    DBMS_OUTPUT.put_line('BEGIN fn_extract_867_ecolab at ' || to_char(sysdate, 'yyyymmdd hh24:mi:ss'));\n    DBMS_OUTPUT.put_line('Parms: ' || p_partner_id || ' ' || p_mfr_num\n            || ' ' || p_odate);\n    g_total_timer_begin := dbms_utility.get_time;\n    DBMS_APPLICATION_INFO.SET_MODULE( module_name => 'ECOLAB867', action_name => 'DELETES');\n\n    DELETE FROM 57eef8c3d4a13d22f0b40f9742e7b281.f915b1cff5db1d904343875a03b0c140\n    WHERE data_who = 'ECOLAB867' || p_mfr_num ;\n\n    sp_last_week_dates(p_odate);\n\n    DBMS_APPLICATION_INFO.SET_MODULE( module_name => 'ECOLAB867', action_name => 'INSERTS');\n\n    INSERT  INTO 57eef8c3d4a13d22f0b40f9742e7b281.f915b1cff5db1d904343875a03b0c140\n            (data_who, data_key, data_data)\n        SELECT 'ECOLAB867' || p_mfr_num data_who,\n            UPPER(RTRIM (p_partner_id)) || p_mfr_num || 57eef8c3d4a13d22f0b40f9742e7b281.7cad4bed0267ab37956f1fcccb769b24.cd8c19b82a9bb45539c5ddd5262d5ee8 || '2' data_key,\n            'DT1' ||\n            RPAD(' ', 25, ' ') ||\n            RPAD (NVL (LTRIM (TRANSLATE (57eef8c3d4a13d22f0b40f9742e7b281.d73db8611de2680d7b0b5feaa04810c2.111341020e63cc60873e4d05e285d6de,  '*^|><@~`&','    ')),\n                'Name blank in db') ,25, ' ') ||\n            LPAD (NVL (LTRIM (TRANSLATE(SUBSTR(LPAD(57eef8c3d4a13d22f0b40f9742e7b281.d73db8611de2680d7b0b5feaa04810c2.6e427bacb381704d6a3dbca94a0d4f03, 8, 0),1, 8),  '*^|><@~`&','    ')),\n                ' ') ,8, 0) ||\n            CASE WHEN 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.8e296af0709009f4cb601a563ab2e022 = 'CD' AND 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.65830b50d8b762bd9c6e5b0c2f5a7ede < 0 THEN\n                    '76'\n                 ELSE\n                    '32'\n            END ||\n            TO_CHAR (ABS(NVL(57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.9f2ec167f84f17ee6dfe57b8ec714693, 0)), '41780b10af855587716b5d6b7c7e2817.9be3c526dbb75dd03ad1acf00703c4f6') ||\n            RPAD(NVL(SUBSTR (57eef8c3d4a13d22f0b40f9742e7b281.6071e9636f96f191337758a751a38d40.20c87a39b180f014bfeaf7a7f7cfd6df, 1, 14), '00000000000000'), 14, ' ') ||\n            TO_CHAR (NVL (57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.84769f239ac5cb8ebf2ca556f7e701c9, 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.b37e525777403fb0c0cfa2cab3876994), 'YYYYMMDD') ||\n            TRANSLATE (RPAD (57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.fb56add4ada29326fed0b165911ff6fd, 15, ' ' ), '*^|><@~`&', '    ') ||\n            RPAD (NVL (LTRIM (TRANSLATE(SUBSTR( 57eef8c3d4a13d22f0b40f9742e7b281.fadb8b76a21d0037200f1f2222239841.8b0d3a6388c202399af51a907f23a188 ,1, 30),  '*^|><@~`&','         ')), 'Blank ProdDesc'), 30, ' ') ||\n            RPAD (LTRIM (TRANSLATE(57eef8c3d4a13d22f0b40f9742e7b281.fadb8b76a21d0037200f1f2222239841.a3e3513906f7e7b71f0323a8b72fe72b,  '*^|><@~`&','         ')), 15, ' ') ||\n            RPAD (LTRIM (TRANSLATE(57eef8c3d4a13d22f0b40f9742e7b281.fadb8b76a21d0037200f1f2222239841.e87981ec68e77de99eea207aa6ba077a,  '*^|><@~`&','         ')), 12, ' ') ||\n            TO_CHAR (57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.8960aac52cadf7195a0577aa30cfccfb, '39710d6a09cb78c77c5f2a22c1d74ebb.9be3c526dbb75dd03ad1acf00703c4f6') ||\n            RPAD(57eef8c3d4a13d22f0b40f9742e7b281.fadb8b76a21d0037200f1f2222239841.a0cb4fc179140ff174fbd1682dc451a253bf80c2794394a9e4fc91b08ae828cc, 10, ' ')\n        FROM 57eef8c3d4a13d22f0b40f9742e7b281.7cad4bed0267ab37956f1fcccb769b24 d, 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e s, 57eef8c3d4a13d22f0b40f9742e7b281.fadb8b76a21d0037200f1f2222239841 p,\n             57eef8c3d4a13d22f0b40f9742e7b281.d73db8611de2680d7b0b5feaa04810c2 c, 57eef8c3d4a13d22f0b40f9742e7b281.6071e9636f96f191337758a751a38d40 pim , 57eef8c3d4a13d22f0b40f9742e7b281.7cad4bed0267ab37956f1fcccb769b24 rev_div\n        WHERE 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.b37e525777403fb0c0cfa2cab3876994 BETWEEN g_begin_week AND g_end_week\n        AND 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.6e427bacb381704d6a3dbca94a0d4f03 = 57eef8c3d4a13d22f0b40f9742e7b281.d73db8611de2680d7b0b5feaa04810c2.6e427bacb381704d6a3dbca94a0d4f03\n        AND 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.5a8103ceb3eda727eed8d3dbc244a027 = 57eef8c3d4a13d22f0b40f9742e7b281.d73db8611de2680d7b0b5feaa04810c2.5a8103ceb3eda727eed8d3dbc244a027\n        AND 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.9d0604c46c7fc3d284e860c5703e30e5 = 57eef8c3d4a13d22f0b40f9742e7b281.fadb8b76a21d0037200f1f2222239841.9d0604c46c7fc3d284e860c5703e30e5\n        AND 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.5a8103ceb3eda727eed8d3dbc244a027 = 57eef8c3d4a13d22f0b40f9742e7b281.fadb8b76a21d0037200f1f2222239841.5a8103ceb3eda727eed8d3dbc244a027\n        AND 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.5a8103ceb3eda727eed8d3dbc244a027 = 57eef8c3d4a13d22f0b40f9742e7b281.7cad4bed0267ab37956f1fcccb769b24.5a8103ceb3eda727eed8d3dbc244a027\n        AND 57eef8c3d4a13d22f0b40f9742e7b281.fadb8b76a21d0037200f1f2222239841.a0cb4fc179140ff174fbd1682dc451a253bf80c2794394a9e4fc91b08ae828cc = 57eef8c3d4a13d22f0b40f9742e7b281.6071e9636f96f191337758a751a38d40.a0cb4fc179140ff174fbd1682dc451a253bf80c2794394a9e4fc91b08ae828cc\n        AND 57eef8c3d4a13d22f0b40f9742e7b281.6071e9636f96f191337758a751a38d40.1066994b3c9cb973df9654728af380e0 = p_mfr_num\n        AND 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.ff5eff8369918e81f835c2f6b23835df IS NULL\n        AND 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.8e296af0709009f4cb601a563ab2e022 in ('RT','CD','WC','VS', 'CC', 'AN')\n        AND 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.29e48bb9f35192fcf2d64cf0c056c0d7524684b806aced36fb41b77a506a3860 = 06f9d718bd51798ad091208b78829cc7.5a8103ceb3eda727eed8d3dbc244a027\n        AND nvl(06f9d718bd51798ad091208b78829cc7.6cadc9c9c9c53bc06582c57b389a64ee,'USF') = 'USF'\n        AND 57eef8c3d4a13d22f0b40f9742e7b281.d73db8611de2680d7b0b5feaa04810c2.7080f549428abf39b1057724fa59d813 = '1'\n      UNION ALL\n         SELECT DISTINCT  'ECOLAB867' || p_mfr_num data_who,\n            UPPER(RTRIM (p_partner_id)) || p_mfr_num || 57eef8c3d4a13d22f0b40f9742e7b281.7cad4bed0267ab37956f1fcccb769b24.cd8c19b82a9bb45539c5ddd5262d5ee8 || '1' data_key,\n            'HDR' ||\n            RPAD(UPPER(p_partner_id), 15, ' ') ||\n            'GEN' ||\n            '867' ||\n            TO_CHAR (SYSDATE, 'YYYYMMDD') ||\n            TO_CHAR (g_begin_week, 'YYYYMMDD') ||\n            TO_CHAR (g_end_week, 'YYYYMMDD') ||\n            RPAD (NVL (LTRIM (TRANSLATE(SUBSTR(57eef8c3d4a13d22f0b40f9742e7b281.6071e9636f96f191337758a751a38d40.ad218d7095b01c8295d3a0af913aad35 ,1, 25),  '*^|><@~`&','         ')), 'mfrName blank IN db'), 25, ' ') ||\n            RPAD (57eef8c3d4a13d22f0b40f9742e7b281.7cad4bed0267ab37956f1fcccb769b24.5a8103ceb3eda727eed8d3dbc244a027, 4, ' ') ||\n            RPAD (NVL (LTRIM (TRANSLATE(SUBSTR(57eef8c3d4a13d22f0b40f9742e7b281.7cad4bed0267ab37956f1fcccb769b24.36894f5f47f531f17812c932d1e217a2 ,1, 25),  '*^|><@~`&','         ')), ' '), 25, ' ')\n        FROM 57eef8c3d4a13d22f0b40f9742e7b281.7cad4bed0267ab37956f1fcccb769b24 d, 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e s, 57eef8c3d4a13d22f0b40f9742e7b281.fadb8b76a21d0037200f1f2222239841 p,\n               57eef8c3d4a13d22f0b40f9742e7b281.6071e9636f96f191337758a751a38d40 pim, 57eef8c3d4a13d22f0b40f9742e7b281.d73db8611de2680d7b0b5feaa04810c2 c , 57eef8c3d4a13d22f0b40f9742e7b281.7cad4bed0267ab37956f1fcccb769b24 rev_div\n        WHERE 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.b37e525777403fb0c0cfa2cab3876994 BETWEEN g_begin_week AND g_end_week\n        AND 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.6e427bacb381704d6a3dbca94a0d4f03 = 57eef8c3d4a13d22f0b40f9742e7b281.d73db8611de2680d7b0b5feaa04810c2.6e427bacb381704d6a3dbca94a0d4f03\n        AND 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.5a8103ceb3eda727eed8d3dbc244a027 = 57eef8c3d4a13d22f0b40f9742e7b281.d73db8611de2680d7b0b5feaa04810c2.5a8103ceb3eda727eed8d3dbc244a027\n        AND 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.9d0604c46c7fc3d284e860c5703e30e5 = 57eef8c3d4a13d22f0b40f9742e7b281.fadb8b76a21d0037200f1f2222239841.9d0604c46c7fc3d284e860c5703e30e5\n        AND 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.5a8103ceb3eda727eed8d3dbc244a027 = 57eef8c3d4a13d22f0b40f9742e7b281.fadb8b76a21d0037200f1f2222239841.5a8103ceb3eda727eed8d3dbc244a027\n        AND 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.5a8103ceb3eda727eed8d3dbc244a027 = 57eef8c3d4a13d22f0b40f9742e7b281.7cad4bed0267ab37956f1fcccb769b24.5a8103ceb3eda727eed8d3dbc244a027\n        AND 57eef8c3d4a13d22f0b40f9742e7b281.fadb8b76a21d0037200f1f2222239841.a0cb4fc179140ff174fbd1682dc451a253bf80c2794394a9e4fc91b08ae828cc = 57eef8c3d4a13d22f0b40f9742e7b281.6071e9636f96f191337758a751a38d40.a0cb4fc179140ff174fbd1682dc451a253bf80c2794394a9e4fc91b08ae828cc\n        AND 57eef8c3d4a13d22f0b40f9742e7b281.6071e9636f96f191337758a751a38d40.1066994b3c9cb973df9654728af380e0 = p_mfr_num\n        AND 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.8e296af0709009f4cb601a563ab2e022 in ('RT','CD','WC','VS', 'CC', 'AN')\n        AND 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.29e48bb9f35192fcf2d64cf0c056c0d7524684b806aced36fb41b77a506a3860 = 06f9d718bd51798ad091208b78829cc7.5a8103ceb3eda727eed8d3dbc244a027\n        AND nvl(06f9d718bd51798ad091208b78829cc7.6cadc9c9c9c53bc06582c57b389a64ee,'USF') = 'USF'\n        AND 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.ff5eff8369918e81f835c2f6b23835df IS NULL\n      UNION ALL\n         SELECT 'ECOLAB867' || p_mfr_num data_who,\n            UPPER(RTRIM (p_partner_id)) || p_mfr_num || brnch_cd || '3' data_key,\n            'SUM' ||\n               TO_CHAR (SUM(ctr), 'S09999') ||\n                TO_CHAR (SUM(total_volume), '8f09f1547a4eb8c7a6d6f248ecc6f483.9be3c526dbb75dd03ad1acf00703c4f6') ||\n                 'UN'\n          FROM (\n              SELECT DISTINCT 57eef8c3d4a13d22f0b40f9742e7b281.7cad4bed0267ab37956f1fcccb769b24.cd8c19b82a9bb45539c5ddd5262d5ee8,  count(1) as ctr,\n                    SUM(ABS(NVL(57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.9f2ec167f84f17ee6dfe57b8ec714693, 0))) total_volume\n                FROM 57eef8c3d4a13d22f0b40f9742e7b281.7cad4bed0267ab37956f1fcccb769b24 d, 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e s, 57eef8c3d4a13d22f0b40f9742e7b281.fadb8b76a21d0037200f1f2222239841 p,\n                     57eef8c3d4a13d22f0b40f9742e7b281.d73db8611de2680d7b0b5feaa04810c2 c, 57eef8c3d4a13d22f0b40f9742e7b281.6071e9636f96f191337758a751a38d40 pim , 57eef8c3d4a13d22f0b40f9742e7b281.7cad4bed0267ab37956f1fcccb769b24 rev_div\n                WHERE 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.b37e525777403fb0c0cfa2cab3876994 BETWEEN g_begin_week AND g_end_week\n                AND 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.6e427bacb381704d6a3dbca94a0d4f03 = 57eef8c3d4a13d22f0b40f9742e7b281.d73db8611de2680d7b0b5feaa04810c2.6e427bacb381704d6a3dbca94a0d4f03\n                AND 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.5a8103ceb3eda727eed8d3dbc244a027 = 57eef8c3d4a13d22f0b40f9742e7b281.d73db8611de2680d7b0b5feaa04810c2.5a8103ceb3eda727eed8d3dbc244a027\n                AND 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.9d0604c46c7fc3d284e860c5703e30e5 = 57eef8c3d4a13d22f0b40f9742e7b281.fadb8b76a21d0037200f1f2222239841.9d0604c46c7fc3d284e860c5703e30e5\n                AND 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.5a8103ceb3eda727eed8d3dbc244a027 = 57eef8c3d4a13d22f0b40f9742e7b281.fadb8b76a21d0037200f1f2222239841.5a8103ceb3eda727eed8d3dbc244a027\n                AND 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.5a8103ceb3eda727eed8d3dbc244a027 = 57eef8c3d4a13d22f0b40f9742e7b281.7cad4bed0267ab37956f1fcccb769b24.5a8103ceb3eda727eed8d3dbc244a027\n                AND 57eef8c3d4a13d22f0b40f9742e7b281.fadb8b76a21d0037200f1f2222239841.a0cb4fc179140ff174fbd1682dc451a253bf80c2794394a9e4fc91b08ae828cc = 57eef8c3d4a13d22f0b40f9742e7b281.6071e9636f96f191337758a751a38d40.a0cb4fc179140ff174fbd1682dc451a253bf80c2794394a9e4fc91b08ae828cc\n                AND 57eef8c3d4a13d22f0b40f9742e7b281.6071e9636f96f191337758a751a38d40.1066994b3c9cb973df9654728af380e0 = p_mfr_num\n                AND 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.ff5eff8369918e81f835c2f6b23835df IS NULL\n                AND 57eef8c3d4a13d22f0b40f9742e7b281.d73db8611de2680d7b0b5feaa04810c2.7080f549428abf39b1057724fa59d813 = '1'\n                AND 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.8e296af0709009f4cb601a563ab2e022 in ('RT','CD','WC','VS', 'CC', 'AN')\n                AND 57eef8c3d4a13d22f0b40f9742e7b281.41ed826c5ef2992d413dc7358355d10e.29e48bb9f35192fcf2d64cf0c056c0d7524684b806aced36fb41b77a506a3860 = 06f9d718bd51798ad091208b78829cc7.5a8103ceb3eda727eed8d3dbc244a027\n                AND nvl(06f9d718bd51798ad091208b78829cc7.6cadc9c9c9c53bc06582c57b389a64ee,'USF') = 'USF'\n                GROUP BY 57eef8c3d4a13d22f0b40f9742e7b281.7cad4bed0267ab37956f1fcccb769b24.cd8c19b82a9bb45539c5ddd5262d5ee8\n           )\n            GROUP BY brnch_cd ;\n    COMMIT;\n\n    DBMS_OUTPUT.put_line('END fn_extract_867_ecolab at ' || to_char(sysdate, 'yyyymmdd hh24:mi:ss'));\n    g_timer_end := dbms_utility.get_time;\n    g_run_time  := g_timer_end - g_total_timer_begin; \n    sp_calc_run_time(g_run_time, 'TOTAL RUN TIME : ');\n    DBMS_APPLICATION_INFO.SET_MODULE(null,null);\n\n    RETURN 0;\n    EXCEPTION\n        WHEN OTHERS THEN\n           DBMS_APPLICATION_INFO.SET_MODULE(null,null);\n            g_sqlcode := SQLCODE;\n            g_message := 'fn_extract_867_ecolab sqlerror ' || g_sqlcode || ' ' || SUBSTR(SQLERRM, 1, 75);\n            DBMS_OUTPUT.put_line(g_message);\n            RETURN -2;\n    END fn_extract_867_ecolab;\n\n  END pkg_EDI_816_867_extrct ;\n/",
            "upstream_dependencies": [],
            "downstream_dependencies": [],
            "dag_location": "null",
            "gantt_location": "null",
            "created_at": "null",
            "updated_at": "null"
        },
        {
            "name": "PKG_SLS_RNK",
            "encrypted_name": "ae1ae99b0366cfa872a132fcd972dcd2",
            "type": "package",
            "database": "null",
            "encrypted_database": "null",
            "schema": "XDMADM",
            "encrypted_schema": "da238e96cf2cb791a097ca6946c096b4",
            "fully_qualified_name": "XDMADM.PKG_SLS_RNK",
            "encrypted_fqn": "da238e96cf2cb791a097ca6946c096b4.ae1ae99b0366cfa872a132fcd972dcd2",
            "synonyms": [],
            "metadata_analysis": "CREATE OR REPLACE PACKAGE \"da238e96cf2cb791a097ca6946c096b4\".\"ae1ae99b0366cfa872a132fcd972dcd2\" AS\n   FUNCTION fn_upd_sls_rnk(p_odate IN VARCHAR2)\n      RETURN NUMBER;\nEND pkg_sls_rnk;\n/\nCREATE OR REPLACE PACKAGE BODY \"da238e96cf2cb791a097ca6946c096b4\".\"ae1ae99b0366cfa872a132fcd972dcd2\" AS\n   \n\n   g_fisc_yr       NUMBER;\n   g_fisc_yr_mth   VARCHAR2(6);\n   g_fisc_yr_wk    VARCHAR2(6);\n   g_default_id    CONSTANT VARCHAR2(30) := 'UNKNOWN';\n   g_default_nm    CONSTANT VARCHAR2(30) := 'UNKNOWN';\n   g_grp_typ_cd    CONSTANT VARCHAR2(30) := 'SALES';\n\n   PROCEDURE ins_sls_rnk_org;\n\n   PROCEDURE ins_sls_rnk_tmp;\n\n   PROCEDURE ins_sls_rnk_mth;\n\n   PROCEDURE upd_sls_rnk_mth_cnt;\n\n   PROCEDURE upd_sls_rnk_mth_rnk;\n\n   PROCEDURE upd_sls_rnk_org_nm;\n\n   \n   FUNCTION fn_upd_sls_rnk(p_odate IN VARCHAR2)\n      RETURN NUMBER IS\n      c_success           CONSTANT NUMBER := 0;\n      c_error             CONSTANT NUMBER := 1;\n\n      l_return_code       NUMBER := 0;\n      l_out_msg           VARCHAR2(256);\n      l_odate             DATE := TO_DATE(p_odate, 'YYYYMMDD');\n      l_last_sat          DATE;\n      l_lastest_pa_load   DATE;\n   BEGIN\n      \n      IF TRIM(TO_CHAR(l_odate, 'DAY')) = 'SATURDAY' THEN\n         l_last_sat   := l_odate;\n      ELSE\n         l_last_sat   := TRUNC(l_odate, 'DAY') - 1;\n      END IF;\n\n      DBMS_OUTPUT.put_line('Most Recent Saturday: ' || l_last_sat);\n\n      \n      SELECT fisc_yr, fisc_yr_mth, fisc_yr_wk\n        INTO g_fisc_yr, g_fisc_yr_mth, g_fisc_yr_wk\n        FROM 57eef8c3d4a13d22f0b40f9742e7b281.a2349118cac55136943abdf2d397e141\n       WHERE clndr_dt = l_last_sat;\n\n      DBMS_OUTPUT.put_line('Fisc Year: ' || g_fisc_yr);\n      DBMS_OUTPUT.put_line('Fisc Month: ' || g_fisc_yr_mth);\n      DBMS_OUTPUT.put_line('Fisc Week: ' || g_fisc_yr_wk);\n\n      \n      SELECT MAX(latest_prcs_dt)\n        INTO l_lastest_pa_load\n        FROM 57eef8c3d4a13d22f0b40f9742e7b281.619982f11fc39868c5b6059378ed0ba6\n       WHERE fact_table = 'SALES_CORP'\n         AND fact_typ_cd = 'AP';\n\n      IF l_lastest_pa_load <= l_last_sat - 7 THEN\n         DBMS_OUTPUT.put_line('PAs not loaded for week');\n         RETURN 1;\n      END IF;\n\n      \n      ins_sls_rnk_org;\n\n      \n      upd_sls_rnk_org_nm;\n\n      \n      ins_sls_rnk_tmp;\n\n      \n      ins_sls_rnk_mth;\n\n      \n      upd_sls_rnk_mth_cnt;\n\n      \n      upd_sls_rnk_mth_rnk;\n\n      \n      l_return_code   :=\n         51a807b365f066e5e34d0ad8a0117c9c.9b9dddad754084e9039b44beec15a88d.8f3b641c38fbe5b729945877fba692919f4aab07a05bab8855dad3fbfb2416e8(l_out_msg,\n                                             'XDMADM',\n                                             'SLS_RNK_ORG',\n                                             'SLS_RNK_ORG_' || g_fisc_yr_mth);\n\n      DBMS_OUTPUT.put_line('Truncate table partition SLS_RNK_ORG_' || g_fisc_yr_mth || ' return code: ' || l_return_code);\n\n      IF l_return_code <> 0 THEN\n         DBMS_OUTPUT.put_line('Error: Failed to truncate table partition SLS_RNK_ORG_' || g_fisc_yr_mth);\n         RETURN 1;\n      END IF;\n\n      \n      l_return_code   :=\n         51a807b365f066e5e34d0ad8a0117c9c.9b9dddad754084e9039b44beec15a88d.8f3b641c38fbe5b729945877fba692919f4aab07a05bab8855dad3fbfb2416e8(l_out_msg,\n                                             'XDMADM',\n                                             'SLS_RNK_MTH',\n                                             'SLS_RNK_MTH_' || g_fisc_yr_mth);\n\n      DBMS_OUTPUT.put_line('Truncate table partition SLS_RNK_MTH_' || g_fisc_yr_mth || ' return code: ' || l_return_code);\n\n      IF l_return_code <> 0 THEN\n         DBMS_OUTPUT.put_line('Error: Failed to truncate table partition SLS_RNK_MTH_' || g_fisc_yr_mth);\n         RETURN 1;\n      END IF;\n\n      \n      INSERT \n            INTO sls_rnk_org\n         (SELECT * FROM sls_rnk_org_tmp);\n\n      DBMS_OUTPUT.put_line('Inserted ' || sql%ROWCOUNT || ' rows into SLS_RNK_ORG');\n\n      \n      INSERT \n            INTO sls_rnk_mth\n         (SELECT * FROM sls_rnk_mth_tmp);\n\n      DBMS_OUTPUT.put_line('Inserted ' || sql%ROWCOUNT || ' rows into SLS_RNK_MTH');\n\n      COMMIT;\n\n      \n      l_return_code   := 51a807b365f066e5e34d0ad8a0117c9c.9b9dddad754084e9039b44beec15a88d.c9c724fb8ac640ac45c4a6fc55311bbe(l_out_msg, 'XDMADM', 'SLS_RNK_ORG_TMP');\n      DBMS_OUTPUT.put_line('Truncate table SLS_RNK_ORG_TMP return code: ' || l_return_code);\n\n      IF l_return_code <> 0 THEN\n         DBMS_OUTPUT.put_line('Error: Failed to truncate table SLS_RNK_ORG_TMP');\n         RETURN 1;\n      END IF;\n\n      \n      l_return_code   := 51a807b365f066e5e34d0ad8a0117c9c.9b9dddad754084e9039b44beec15a88d.c9c724fb8ac640ac45c4a6fc55311bbe(l_out_msg, 'XDMADM', 'SLS_RNK_MTH_TMP');\n      DBMS_OUTPUT.put_line('Truncate table SLS_RNK_MTH_TMP return code: ' || l_return_code);\n\n      IF l_return_code <> 0 THEN\n         DBMS_OUTPUT.put_line('Error: Failed to truncate table SLS_RNK_MTH_TMP');\n         RETURN 1;\n      END IF;\n\n      \n      l_return_code   := 57eef8c3d4a13d22f0b40f9742e7b281.e9c7d074541f588587f071b89e534d87('XDMADM', 'SLS_RNK_ORG');\n      DBMS_OUTPUT.put_line('Analyze SLS_RNK_ORG Return Code: ' || l_return_code);\n\n      IF l_return_code <> 0 THEN\n         DBMS_OUTPUT.put_line('Error: Failed to analyze table SLS_RNK_ORG');\n         RETURN 1;\n      END IF;\n\n      \n      l_return_code   := 57eef8c3d4a13d22f0b40f9742e7b281.e9c7d074541f588587f071b89e534d87('XDMADM', 'SLS_RNK_MTH');\n      DBMS_OUTPUT.put_line('Analyze SLS_RNK_MTH Return Code: ' || l_return_code);\n\n      IF l_return_code <> 0 THEN\n         DBMS_OUTPUT.put_line('Error: Failed to analyze table SLS_RNK_MTH');\n         RETURN 1;\n      END IF;\n\n      \n      UPDATE 57eef8c3d4a13d22f0b40f9742e7b281.619982f11fc39868c5b6059378ed0ba6\n         SET latest_prcs_dt = l_last_sat, prcs_dt = l_odate\n       WHERE fact_table = 'SLS_RNK_MTH';\n\n      COMMIT;\n      DBMS_OUTPUT.put_line('Updated FACT_LOAD_STAT');\n\n      RETURN 0;\n   EXCEPTION\n      WHEN OTHERS THEN\n         ROLLBACK;\n         DBMS_OUTPUT.put_line('Error processing sales ranking tables');\n         DBMS_OUTPUT.put_line(SQLERRM);\n         RETURN 1;\n   END fn_upd_sls_rnk;\n\n   \n   PROCEDURE ins_sls_rnk_org IS\n      l_return_code             NUMBER := 0;\n      l_out_msg                 VARCHAR2(256);\n\n      l_rsm_dsm_acct_thrshld    NUMBER;\n      l_tm_trtry_acct_thrshld   NUMBER;\n   BEGIN\n      \n      SELECT param_value_nbr\n        INTO l_rsm_dsm_acct_thrshld\n        FROM 57eef8c3d4a13d22f0b40f9742e7b281.1f9c921b05aafc28bf91547d5ec08a09\n       WHERE app_name = 'SLS_RNK'\n         AND param_type = 'NET_ACCT_THRSHLD'\n         AND param_code = 'RSM_DSM';\n\n      DBMS_OUTPUT.put_line('RSM DSM - Net account threshold value: ' || l_rsm_dsm_acct_thrshld);\n\n      SELECT param_value_nbr\n        INTO l_tm_trtry_acct_thrshld\n        FROM 57eef8c3d4a13d22f0b40f9742e7b281.1f9c921b05aafc28bf91547d5ec08a09\n       WHERE app_name = 'SLS_RNK'\n         AND param_type = 'NET_ACCT_THRSHLD'\n         AND param_code = 'TM_TRTRY';\n\n      DBMS_OUTPUT.put_line('TM TRTRY - Net account threshold value: ' || l_tm_trtry_acct_thrshld);\n\n      \n      l_return_code   := 51a807b365f066e5e34d0ad8a0117c9c.9b9dddad754084e9039b44beec15a88d.c9c724fb8ac640ac45c4a6fc55311bbe(l_out_msg, 'XDMADM', 'SLS_RNK_ORG_TMP');\n      DBMS_OUTPUT.put_line('Truncate table SLS_RNK_ORG_TMP return code: ' || l_return_code);\n\n      DBMS_OUTPUT.put_line('Begin inserting SLS_RNK_ORG_TMP');\n\n      INSERT \n            INTO 57eef8c3d4a13d22f0b40f9742e7b281.c34b3b41e7bd0c01dfd7c75a49970163(fisc_yr_mth, org_lvl, org_val, rgn_cd, rgn_nm, area_cd,\n                                        area_nm, grp_cd_or_brnch_cd, grp_nm_or_div_nm_cd_nbr, rgn_sls_mgr_id, dstrct_sls_mgr_id, trtry_mgr_id,\n                                        brnch_trtry_cd, mth_st_elgbl, ytd_st_elgbl, mth_na_elgbl, ytd_na_elgbl, tm_st_cnt,\n                                        tm_na_cnt, tm_st_cnt_ly, tm_na_cnt_ly)\n         SELECT *\n           FROM (WITH org_tmp AS\n                        (  SELECT 57eef8c3d4a13d22f0b40f9742e7b281.ac60f3b24ab9261fbfdd476a640ab55e.051677fa81b6acaecd067857b3e57ecd,\n                                  57eef8c3d4a13d22f0b40f9742e7b281.7cad4bed0267ab37956f1fcccb769b24.4eb9d832d7428eb363fb936e2036c963,\n                                  57eef8c3d4a13d22f0b40f9742e7b281.7cad4bed0267ab37956f1fcccb769b24.8f344ae97447447340767dca0e403389,\n                                  57eef8c3d4a13d22f0b40f9742e7b281.7cad4bed0267ab37956f1fcccb769b24.83b71521fb15b7d5d328381cdcc3ebd0,\n                                  57eef8c3d4a13d22f0b40f9742e7b281.7cad4bed0267ab37956f1fcccb769b24.88f2dad13ea1c4ddc798ee201d06f00e,\n                                  CASE WHEN 57eef8c3d4a13d22f0b40f9742e7b281.7cad4bed0267ab37956f1fcccb769b24.a534b553ce2280fa65ad5af10e67f577 = g_grp_typ_cd THEN 'G_' || 57eef8c3d4a13d22f0b40f9742e7b281.7cad4bed0267ab37956f1fcccb769b24.0c37e0327461eb9c1d479f1bf773611a ELSE 'D_' || 57eef8c3d4a13d22f0b40f9742e7b281.7cad4bed0267ab37956f1fcccb769b24.cd8c19b82a9bb45539c5ddd5262d5ee8 END grp_cd_or_brnch_cd,\n                                  CASE WHEN 57eef8c3d4a13d22f0b40f9742e7b281.7cad4bed0267ab37956f1fcccb769b24.a534b553ce2280fa65ad5af10e67f577 = g_grp_typ_cd THEN 57eef8c3d4a13d22f0b40f9742e7b281.7cad4bed0267ab37956f1fcccb769b24.496c09c18b07ec1b1775772cbdaa1e6427085abce23ac854172d9df04aec4dba ELSE 57eef8c3d4a13d22f0b40f9742e7b281.7cad4bed0267ab37956f1fcccb769b24.0d955b9be963b81fd59ad3cfd4ce97aa END grp_nm_or_div_nm_cd_nbr,\n                                  57eef8c3d4a13d22f0b40f9742e7b281.7b6f47db0f8e291b853cdfa5619afedf.5a8103ceb3eda727eed8d3dbc244a027,\n                                  NVL(57eef8c3d4a13d22f0b40f9742e7b281.d73db8611de2680d7b0b5feaa04810c2.9c0e3ca45e9e6d5e37b7b267abe94ef8, g_default_id) rgn_sls_mgr_id,\n                                  NVL(57eef8c3d4a13d22f0b40f9742e7b281.d73db8611de2680d7b0b5feaa04810c2.f0e42dcd17c0461501b0d0a44a18ba0c0ca5fb119e004e3dd9cc2be01757c595, g_default_id) dstrct_sls_mgr_id,\n                                  NVL(57eef8c3d4a13d22f0b40f9742e7b281.d73db8611de2680d7b0b5feaa04810c2.a2aa8624c681d422d7579b82a029c958, g_default_id) trtry_mgr_id,\n                                  57eef8c3d4a13d22f0b40f9742e7b281.7cad4bed0267ab37956f1fcccb769b24.cd8c19b82a9bb45539c5ddd5262d5ee8 || '-' || 57eef8c3d4a13d22f0b40f9742e7b281.d73db8611de2680d7b0b5feaa04810c2.c2c889382e3600a66841485b2acbd235 brnch_trtry_cd,\n                                  COUNT(DISTINCT CASE\n                                                    WHEN 57eef8c3d4a13d22f0b40f9742e7b281.d73db8611de2680d7b0b5feaa04810c2.0b49a7fb4e4ab429796cf3bf656d061a711cccba8c2d5033896154ebc5bb9823 = 'L'\n                                                     AND 57eef8c3d4a13d22f0b40f9742e7b281.c2f43c31651b37621d36cc6c7b12632e.4c01182b11bab7684e2c612849b1ad0d = 'ST'\n                                                     AND 57eef8c3d4a13d22f0b40f9742e7b281.d73db8611de2680d7b0b5feaa04810c2.cccc4a6a953ec910fc17463e24f09c77 IN ('IND', 'REG', 'HOS', 'OTH') THEN\n                                                       57eef8c3d4a13d22f0b40f9742e7b281.7b6f47db0f8e291b853cdfa5619afedf.633bff8cd684a2516fd7ab36360caed253a0c0fe76045acdb204ca36f43c8ecf\n                                                    ELSE\n                                                       NULL\n                                                 END)\n                                     net_acct_st,\n                                  COUNT(DISTINCT CASE\n                                                    WHEN 57eef8c3d4a13d22f0b40f9742e7b281.d73db8611de2680d7b0b5feaa04810c2.0b49a7fb4e4ab429796cf3bf656d061a711cccba8c2d5033896154ebc5bb9823 = 'L'\n                                                     AND 57eef8c3d4a13d22f0b40f9742e7b281.c2f43c31651b37621d36cc6c7b12632e.4c01182b11bab7684e2c612849b1ad0d = 'ST'\n                                                     AND 57eef8c3d4a13d22f0b40f9742e7b281.d73db8611de2680d7b0b5feaa04810c2.cccc4a6a953ec910fc17463e24f09c77 IN ('IND', 'REG', 'HOS', 'OTH') THEN\n                                                       57eef8c3d4a13d22f0b40f9742e7b281.7b6f47db0f8e291b853cdfa5619afedf.633bff8cd684a2516fd7ab36360caed291b777230e03c0dedfb113c2c8af948c\n                                                    ELSE\n                                                       NULL\n                                                 END)\n                                     net_acct_st_ly,\n                                  COUNT(DISTINCT CASE\n                                                    WHEN 57eef8c3d4a13d22f0b40f9742e7b281.d73db8611de2680d7b0b5feaa04810c2.0b49a7fb4e4ab429796cf3bf656d061a711cccba8c2d5033896154ebc5bb9823 = 'N'\n                                                     AND 57eef8c3d4a13d22f0b40f9742e7b281.c2f43c31651b37621d36cc6c7b12632e.4c01182b11bab7684e2c612849b1ad0d = 'NA' THEN\n                                                       57eef8c3d4a13d22f0b40f9742e7b281.7b6f47db0f8e291b853cdfa5619afedf.633bff8cd684a2516fd7ab36360caed253a0c0fe76045acdb204ca36f43c8ecf\n                                                    ELSE\n                                                       NULL\n                                                 END)\n                                     net_acct_na,\n                                  COUNT(DISTINCT CASE\n                                                    WHEN 57eef8c3d4a13d22f0b40f9742e7b281.d73db8611de2680d7b0b5feaa04810c2.0b49a7fb4e4ab429796cf3bf656d061a711cccba8c2d5033896154ebc5bb9823 = 'N'\n                                                     AND 57eef8c3d4a13d22f0b40f9742e7b281.c2f43c31651b37621d36cc6c7b12632e.4c01182b11bab7684e2c612849b1ad0d = 'NA' THEN\n                                                       57eef8c3d4a13d22f0b40f9742e7b281.7b6f47db0f8e291b853cdfa5619afedf.633bff8cd684a2516fd7ab36360caed291b777230e03c0dedfb113c2c8af948c\n                                                    ELSE\n                                                       NULL\n                                                 END)\n                                     net_acct_na_ly\n                             FROM 57eef8c3d4a13d22f0b40f9742e7b281.7b6f47db0f8e291b853cdfa5619afedf s,\n                                  57eef8c3d4a13d22f0b40f9742e7b281.d73db8611de2680d7b0b5feaa04810c2 cc,\n                                  57eef8c3d4a13d22f0b40f9742e7b281.7cad4bed0267ab37956f1fcccb769b24 d,\n                                  57eef8c3d4a13d22f0b40f9742e7b281.7cad4bed0267ab37956f1fcccb769b24 d2,\n                                  57eef8c3d4a13d22f0b40f9742e7b281.ac60f3b24ab9261fbfdd476a640ab55e t,\n                                  57eef8c3d4a13d22f0b40f9742e7b281.c2f43c31651b37621d36cc6c7b12632e st\n                            WHERE 57eef8c3d4a13d22f0b40f9742e7b281.7b6f47db0f8e291b853cdfa5619afedf.6e427bacb381704d6a3dbca94a0d4f03 = 57eef8c3d4a13d22f0b40f9742e7b281.d73db8611de2680d7b0b5feaa04810c2.6e427bacb381704d6a3dbca94a0d4f03\n                              AND 57eef8c3d4a13d22f0b40f9742e7b281.7b6f47db0f8e291b853cdfa5619afedf.5a8103ceb3eda727eed8d3dbc244a027 = 57eef8c3d4a13d22f0b40f9742e7b281.d73db8611de2680d7b0b5feaa04810c2.5a8103ceb3eda727eed8d3dbc244a027\n                              AND 57eef8c3d4a13d22f0b40f9742e7b281.7b6f47db0f8e291b853cdfa5619afedf.5a8103ceb3eda727eed8d3dbc244a027 = 57eef8c3d4a13d22f0b40f9742e7b281.7cad4bed0267ab37956f1fcccb769b24.5a8103ceb3eda727eed8d3dbc244a027\n                              AND 57eef8c3d4a13d22f0b40f9742e7b281.7b6f47db0f8e291b853cdfa5619afedf.62b8391a73b393544f23e7450967c0131766d3fdb0a7d34e76c86087df29e1be = 57eef8c3d4a13d22f0b40f9742e7b281.7cad4bed0267ab37956f1fcccb769b24.5a8103ceb3eda727eed8d3dbc244a027\n                              AND 57eef8c3d4a13d22f0b40f9742e7b281.7b6f47db0f8e291b853cdfa5619afedf.78b147c8e239062228170605a601c274 = 57eef8c3d4a13d22f0b40f9742e7b281.ac60f3b24ab9261fbfdd476a640ab55e.78b147c8e239062228170605a601c274\n                              AND 57eef8c3d4a13d22f0b40f9742e7b281.d73db8611de2680d7b0b5feaa04810c2.5a8103ceb3eda727eed8d3dbc244a027 = 57eef8c3d4a13d22f0b40f9742e7b281.c2f43c31651b37621d36cc6c7b12632e.5a8103ceb3eda727eed8d3dbc244a027\n                              AND 57eef8c3d4a13d22f0b40f9742e7b281.d73db8611de2680d7b0b5feaa04810c2.c2c889382e3600a66841485b2acbd235 = 57eef8c3d4a13d22f0b40f9742e7b281.c2f43c31651b37621d36cc6c7b12632e.c2c889382e3600a66841485b2acbd235\n                              AND 57eef8c3d4a13d22f0b40f9742e7b281.ac60f3b24ab9261fbfdd476a640ab55e.9b0cd70f1039477f7d51dc7aea625afe = g_fisc_yr\n                              AND 57eef8c3d4a13d22f0b40f9742e7b281.ac60f3b24ab9261fbfdd476a640ab55e.78b147c8e239062228170605a601c274 <= g_fisc_yr_wk\n                              AND 57eef8c3d4a13d22f0b40f9742e7b281.7cad4bed0267ab37956f1fcccb769b24.d5888bb74952b9abf72c4e89988d3f67 <> 'CC'\n                              AND 57eef8c3d4a13d22f0b40f9742e7b281.7b6f47db0f8e291b853cdfa5619afedf.318fdc0a1edcc562c36f48fc77ec4a6a = 'N'\n                              AND 57eef8c3d4a13d22f0b40f9742e7b281.d73db8611de2680d7b0b5feaa04810c2.7080f549428abf39b1057724fa59d813 = '1'\n                              AND 57eef8c3d4a13d22f0b40f9742e7b281.7cad4bed0267ab37956f1fcccb769b24.d5888bb74952b9abf72c4e89988d3f67 = 'USF'\n                              AND 57eef8c3d4a13d22f0b40f9742e7b281.7cad4bed0267ab37956f1fcccb769b24.0cdc126b1c7da4de6df00b51a8cfda85 = 1\n                              AND NOT EXISTS (SELECT 'X'\n                                                FROM 57eef8c3d4a13d22f0b40f9742e7b281.1f9c921b05aafc28bf91547d5ec08a09\n                                               WHERE app_name = 'DIV_SALES_CHURN'\n                                                 AND param_type = 'EXCLD_BRDLN_DIV'\n                                                 AND param_value_nbr = 57eef8c3d4a13d22f0b40f9742e7b281.7cad4bed0267ab37956f1fcccb769b24.5a8103ceb3eda727eed8d3dbc244a027)\n                         GROUP BY 57eef8c3d4a13d22f0b40f9742e7b281.ac60f3b24ab9261fbfdd476a640ab55e.051677fa81b6acaecd067857b3e57ecd,\n                                  57eef8c3d4a13d22f0b40f9742e7b281.7cad4bed0267ab37956f1fcccb769b24.4eb9d832d7428eb363fb936e2036c963,\n                                  57eef8c3d4a13d22f0b40f9742e7b281.7cad4bed0267ab37956f1fcccb769b24.8f344ae97447447340767dca0e403389,\n                                  57eef8c3d4a13d22f0b40f9742e7b281.7cad4bed0267ab37956f1fcccb769b24.83b71521fb15b7d5d328381cdcc3ebd0,\n                                  57eef8c3d4a13d22f0b40f9742e7b281.7cad4bed0267ab37956f1fcccb769b24.88f2dad13ea1c4ddc798ee201d06f00e,\n                                  CASE WHEN 57eef8c3d4a13d22f0b40f9742e7b281.7cad4bed0267ab37956f1fcccb769b24.a534b553ce2280fa65ad5af10e67f577 = g_grp_typ_cd THEN 'G_' || 57eef8c3d4a13d22f0b40f9742e7b281.7cad4bed0267ab37956f1fcccb769b24.0c37e0327461eb9c1d479f1bf773611a ELSE 'D_' || 57eef8c3d4a13d22f0b40f9742e7b281.7cad4bed0267ab37956f1fcccb769b24.cd8c19b82a9bb45539c5ddd5262d5ee8 END,\n                                  CASE WHEN 57eef8c3d4a13d22f0b40f9742e7b281.7cad4bed0267ab37956f1fcccb769b24.a534b553ce2280fa65ad5af10e67f577 = g_grp_typ_cd THEN 57eef8c3d4a13d22f0b40f9742e7b281.7cad4bed0267ab37956f1fcccb769b24.496c09c18b07ec1b1775772cbdaa1e6427085abce23ac854172d9df04aec4dba ELSE 57eef8c3d4a13d22f0b40f9742e7b281.7cad4bed0267ab37956f1fcccb769b24.0d955b9be963b81fd59ad3cfd4ce97aa END,\n                                  57eef8c3d4a13d22f0b40f9742e7b281.7b6f47db0f8e291b853cdfa5619afedf.5a8103ceb3eda727eed8d3dbc244a027,\n                                  57eef8c3d4a13d22f0b40f9742e7b281.d73db8611de2680d7b0b5feaa04810c2.9c0e3ca45e9e6d5e37b7b267abe94ef8,\n                                  NVL(57eef8c3d4a13d22f0b40f9742e7b281.d73db8611de2680d7b0b5feaa04810c2.9c0e3ca45e9e6d5e37b7b267abe94ef8, g_default_id),\n                                  NVL(57eef8c3d4a13d22f0b40f9742e7b281.d73db8611de2680d7b0b5feaa04810c2.f0e42dcd17c0461501b0d0a44a18ba0c0ca5fb119e004e3dd9cc2be01757c595, g_default_id),\n                                  NVL(57eef8c3d4a13d22f0b40f9742e7b281.d73db8611de2680d7b0b5feaa04810c2.a2aa8624c681d422d7579b82a029c958, g_default_id),\n                                  57eef8c3d4a13d22f0b40f9742e7b281.7cad4bed0267ab37956f1fcccb769b24.cd8c19b82a9bb45539c5ddd5262d5ee8 || '-' || 57eef8c3d4a13d22f0b40f9742e7b281.d73db8611de2680d7b0b5feaa04810c2.c2c889382e3600a66841485b2acbd235)\n                   SELECT g_fisc_yr_mth,\n                          'TRTRY' org_lvl,\n                          grp_cd_or_brnch_cd || '-' || rgn_sls_mgr_id || '-' || dstrct_sls_mgr_id || '-' || trtry_mgr_id || '-' || brnch_trtry_cd\n                             org_val,\n                          rgn_cd,\n                          rgn_nm,\n                          area_cd,\n                          area_nm,\n                          grp_cd_or_brnch_cd,\n                          grp_nm_or_div_nm_cd_nbr,\n                          rgn_sls_mgr_id,\n                          dstrct_sls_mgr_id,\n                          trtry_mgr_id,\n                          brnch_trtry_cd,\n                          MAX(CASE\n                                 WHEN (CASE WHEN fisc_yr_mth = g_fisc_yr_mth THEN net_acct_st_ly ELSE 0 END) >= l_tm_trtry_acct_thrshld\n                                  AND (CASE WHEN fisc_yr_mth = g_fisc_yr_mth THEN net_acct_st ELSE 0 END) >= 1 THEN\n                                    'Y'\n                                 ELSE\n                                    'N'\n                              END)\n                             mth_st_elgbl,\n                          CASE\n                             WHEN MAX(net_acct_st_ly) >= l_tm_trtry_acct_thrshld\n                              AND MAX(net_acct_st) >= 1 THEN\n                                'Y'\n                             ELSE\n                                'N'\n                          END\n                             ytd_st_elgbl,\n                          MAX(CASE\n                                 WHEN (CASE WHEN fisc_yr_mth = g_fisc_yr_mth THEN net_acct_na_ly ELSE 0 END) >= l_tm_trtry_acct_thrshld\n                                  AND (CASE WHEN fisc_yr_mth = g_fisc_yr_mth THEN net_acct_na ELSE 0 END) >= 1 THEN\n                                    'Y'\n                                 ELSE\n                                    'N'\n                              END)\n                             mth_na_elgbl,\n                          CASE\n                             WHEN MAX(net_acct_na_ly) >= l_tm_trtry_acct_thrshld\n                              AND MAX(net_acct_na) >= 1 THEN\n                                'Y'\n                             ELSE\n                                'N'\n                          END\n                             ytd_na_elgbl,\n                          NULL tm_st_cnt,\n                          NULL tm_na_cnt,\n                          NULL tm_st_cnt_ly,\n                          NULL tm_na_cnt_ly\n                     FROM (  SELECT fisc_yr_mth,\n                                    rgn_cd,\n                                    rgn_nm,\n                                    area_cd,\n                                    area_nm,\n                                    grp_cd_or_brnch_cd,\n                                    grp_nm_or_div_nm_cd_nbr,\n                                    rgn_sls_mgr_id,\n                                    dstrct_sls_mgr_id,\n                                    trtry_mgr_id,\n                                    brnch_trtry_cd,\n                                    SUM(net_acct_st) net_acct_st,\n                                    SUM(net_acct_st_ly) net_acct_st_ly,\n                                    SUM(net_acct_na) net_acct_na,\n                                    SUM(net_acct_na_ly) net_acct_na_ly\n                               FROM org_tmp\n                           GROUP BY fisc_yr_mth,\n                                    rgn_cd,\n                                    rgn_nm,\n                                    area_cd,\n                                    area_nm,\n                                    grp_cd_or_brnch_cd,\n                                    grp_nm_or_div_nm_cd_nbr,\n                                    rgn_sls_mgr_id,\n                                    dstrct_sls_mgr_id,\n                                    trtry_mgr_id,\n                                    brnch_trtry_cd)\n                 GROUP BY rgn_cd,\n                          rgn_nm,\n                          area_cd,\n                          area_nm,\n                          grp_cd_or_brnch_cd,\n                          grp_nm_or_div_nm_cd_nbr,\n                          rgn_sls_mgr_id,\n                          dstrct_sls_mgr_id,\n                          trtry_mgr_id,\n                          brnch_trtry_cd\n                 UNION\n                   SELECT g_fisc_yr_mth,\n                          'TM' org_lvl,\n                          grp_cd_or_brnch_cd || '-' || rgn_sls_mgr_id || '-' || dstrct_sls_mgr_id || '-' || trtry_mgr_id org_val,\n                          rgn_cd,\n                          rgn_nm,\n                          area_cd,\n                          area_nm,\n                          grp_cd_or_brnch_cd,\n                          grp_nm_or_div_nm_cd_nbr,\n                          rgn_sls_mgr_id,\n                          dstrct_sls_mgr_id,\n                          trtry_mgr_id,\n                          NULL brnch_trtry_cd,\n                          MAX(CASE\n                                 WHEN (CASE WHEN fisc_yr_mth = g_fisc_yr_mth THEN net_acct_st_ly ELSE 0 END) >= l_tm_trtry_acct_thrshld\n                                  AND (CASE WHEN fisc_yr_mth = g_fisc_yr_mth THEN net_acct_st ELSE 0 END) >= 1 THEN\n                                    'Y'\n                                 ELSE\n                                    'N'\n                              END)\n                             mth_st_elgbl,\n                          CASE\n                             WHEN MAX(net_acct_st_ly) >= l_tm_trtry_acct_thrshld\n                              AND MAX(net_acct_st) >= 1 THEN\n                                'Y'\n                             ELSE\n                                'N'\n                          END\n                             ytd_st_elgbl,\n                          MAX(CASE\n                                 WHEN (CASE WHEN fisc_yr_mth = g_fisc_yr_mth THEN net_acct_na_ly ELSE 0 END) >= l_tm_trtry_acct_thrshld\n                                  AND (CASE WHEN fisc_yr_mth = g_fisc_yr_mth THEN net_acct_na ELSE 0 END) >= 1 THEN\n                                    'Y'\n                                 ELSE\n                                    'N'\n                              END)\n                             mth_na_elgbl,\n                          CASE\n                             WHEN MAX(net_acct_na_ly) >= l_tm_trtry_acct_thrshld\n                              AND MAX(net_acct_na) >= 1 THEN\n                                'Y'\n                             ELSE\n                                'N'\n                          END\n                             ytd_na_elgbl,\n                          NULL tm_st_cnt,\n                          NULL tm_na_cnt,\n                          NULL tm_st_cnt_ly,\n                          NULL tm_na_cnt_ly\n                     FROM (  SELECT fisc_yr_mth,\n                                    rgn_cd,\n                                    rgn_nm,\n                                    area_cd,\n                                    area_nm,\n                                    grp_cd_or_brnch_cd,\n                                    grp_nm_or_div_nm_cd_nbr,\n                                    rgn_sls_mgr_id,\n                                    dstrct_sls_mgr_id,\n                                    trtry_mgr_id,\n                                    SUM(net_acct_st) net_acct_st,\n                                    SUM(net_acct_st_ly) net_acct_st_ly,\n                                    SUM(net_acct_na) net_acct_na,\n                                    SUM(net_acct_na_ly) net_acct_na_ly\n                               FROM org_tmp\n                           GROUP BY fisc_yr_mth,\n                                    rgn_cd,\n                                    rgn_nm,\n                                    area_cd,\n                                    area_nm,\n                                    grp_cd_or_brnch_cd,\n                                    grp_nm_or_div_nm_cd_nbr,\n                                    rgn_sls_mgr_id,\n                                    dstrct_sls_mgr_id,\n                                    trtry_mgr_id)\n                 GROUP BY rgn_cd,\n                          rgn_nm,\n                          area_cd,\n                          area_nm,\n                          grp_cd_or_brnch_cd,\n                          grp_nm_or_div_nm_cd_nbr,\n                          rgn_sls_mgr_id,\n                          dstrct_sls_mgr_id,\n                          trtry_mgr_id\n                 UNION\n                   SELECT g_fisc_yr_mth,\n                          'DSM' org_lvl,\n                          grp_cd_or_brnch_cd || '-' || rgn_sls_mgr_id || '-' || dstrct_sls_mgr_id org_val,\n                          rgn_cd,\n                          rgn_nm,\n                          area_cd,\n                          area_nm,\n                          grp_cd_or_brnch_cd,\n                          grp_nm_or_div_nm_cd_nbr,\n                          rgn_sls_mgr_id,\n                          dstrct_sls_mgr_id,\n                          NULL trtry_mgr_id,\n                          NULL brnch_trtry_cd,\n                          MAX(CASE\n                                 WHEN (CASE WHEN fisc_yr_mth = g_fisc_yr_mth THEN net_acct_st_ly ELSE 0 END) >= l_rsm_dsm_acct_thrshld\n                                  AND (CASE WHEN fisc_yr_mth = g_fisc_yr_mth THEN net_acct_st ELSE 0 END) >= 1 THEN\n                                    'Y'\n                                 ELSE\n                                    'N'\n                              END)\n                             mth_st_elgbl,\n                          CASE\n                             WHEN MAX(net_acct_st_ly) >= l_rsm_dsm_acct_thrshld\n                              AND MAX(net_acct_st) >= 1 THEN\n                                'Y'\n                             ELSE\n                                'N'\n                          END\n                             ytd_st_elgbl,\n                          MAX(CASE\n                                 WHEN (CASE WHEN fisc_yr_mth = g_fisc_yr_mth THEN net_acct_na_ly ELSE 0 END) >= l_rsm_dsm_acct_thrshld\n                                  AND (CASE WHEN fisc_yr_mth = g_fisc_yr_mth THEN net_acct_na ELSE 0 END) >= 1 THEN\n                                    'Y'\n                                 ELSE\n                                    'N'\n                              END)\n                             mth_na_elgbl,\n                          CASE\n                             WHEN MAX(net_acct_na_ly) >= l_rsm_dsm_acct_thrshld\n                              AND MAX(net_acct_na) >= 1 THEN\n                                'Y'\n                             ELSE\n                                'N'\n                          END\n                             ytd_na_elgbl,\n                          SUM(CASE WHEN fisc_yr_mth = g_fisc_yr_mth THEN tm_st_cnt ELSE 0 END) tm_st_cnt,\n                          SUM(CASE WHEN fisc_yr_mth = g_fisc_yr_mth THEN tm_na_cnt ELSE 0 END) tm_na_cnt,\n                          SUM(CASE WHEN fisc_yr_mth = g_fisc_yr_mth THEN tm_st_cnt_ly ELSE 0 END) tm_st_cnt_ly,\n                          SUM(CASE WHEN fisc_yr_mth = g_fisc_yr_mth THEN tm_na_cnt_ly ELSE 0 END) tm_na_cnt_ly\n                     FROM (  SELECT fisc_yr_mth,\n                                    rgn_cd,\n                                    rgn_nm,\n                                    area_cd,\n                                    area_nm,\n                                    grp_cd_or_brnch_cd,\n                                    grp_nm_or_div_nm_cd_nbr,\n                                    rgn_sls_mgr_id,\n                                    dstrct_sls_mgr_id,\n                                    SUM(net_acct_st) net_acct_st,\n                                    SUM(net_acct_st_ly) net_acct_st_ly,\n                                    SUM(net_acct_na) net_acct_na,\n                                    SUM(net_acct_na_ly) net_acct_na_ly,\n                                    COUNT(DISTINCT CASE WHEN net_acct_st > 0 THEN trtry_mgr_id ELSE NULL END) tm_st_cnt,\n                                    COUNT(DISTINCT CASE WHEN net_acct_na > 0 THEN trtry_mgr_id ELSE NULL END) tm_na_cnt,\n                                    COUNT(DISTINCT CASE WHEN net_acct_st_ly > 0 THEN trtry_mgr_id ELSE NULL END) tm_st_cnt_ly,\n                                    COUNT(DISTINCT CASE WHEN net_acct_na_ly > 0 THEN trtry_mgr_id ELSE NULL END) tm_na_cnt_ly\n                               FROM org_tmp\n                           GROUP BY fisc_yr_mth,\n                                    rgn_cd,\n                                    rgn_nm,\n                                    area_cd,\n                                    area_nm,\n                                    grp_cd_or_brnch_cd,\n                                    grp_nm_or_div_nm_cd_nbr,\n                                    rgn_sls_mgr_id,\n                                    dstrct_sls_mgr_id)\n                 GROUP BY rgn_cd,\n                          rgn_nm,\n                          area_cd,\n                          area_nm,\n                          grp_cd_or_brnch_cd,\n                          grp_nm_or_div_nm_cd_nbr,\n                          rgn_sls_mgr_id,\n                          dstrct_sls_mgr_id\n                 UNION\n                   SELECT g_fisc_yr_mth,\n                          'RSM' org_lvl,\n                          grp_cd_or_brnch_cd || '-' || rgn_sls_mgr_id org_val,\n                          rgn_cd,\n                          rgn_nm,\n                          area_cd,\n                          area_nm,\n                          grp_cd_or_brnch_cd,\n                          grp_nm_or_div_nm_cd_nbr,\n                          rgn_sls_mgr_id,\n                          NULL dstrct_sls_mgr_id,\n                          NULL trtry_mgr_id,\n                          NULL brnch_trtry_cd,\n                          MAX(CASE\n                                 WHEN (CASE WHEN fisc_yr_mth = g_fisc_yr_mth THEN net_acct_st_ly ELSE 0 END) >= l_rsm_dsm_acct_thrshld\n                                  AND (CASE WHEN fisc_yr_mth = g_fisc_yr_mth THEN net_acct_st ELSE 0 END) >= 1\n                                  AND usr_flg = 'Y' THEN\n                                    'Y'\n                                 ELSE\n                                    'N'\n                              END)\n                             mth_st_elgbl,\n                          CASE\n                             WHEN MAX(net_acct_st_ly) >= l_rsm_dsm_acct_thrshld\n                              AND MAX(net_acct_st) >= 1\n                              AND MAX(usr_flg) = 'Y' THEN\n                                'Y'\n                             ELSE\n                                'N'\n                          END\n                             ytd_st_elgbl,\n                          MAX(CASE\n                                 WHEN (CASE WHEN fisc_yr_mth = g_fisc_yr_mth THEN net_acct_na_ly ELSE 0 END) >= l_rsm_dsm_acct_thrshld\n                                  AND (CASE WHEN fisc_yr_mth = g_fisc_yr_mth THEN net_acct_na ELSE 0 END) >= 1\n                                  AND usr_flg = 'Y' THEN\n                                    'Y'\n                                 ELSE\n                                    'N'\n                              END)\n                             mth_na_elgbl,\n                          CASE\n                             WHEN MAX(net_acct_na_ly) >= l_rsm_dsm_acct_thrshld\n                              AND MAX(net_acct_na) >= 1\n                              AND MAX(usr_flg) = 'Y' THEN\n                                'Y'\n                             ELSE\n                                'N'\n                          END\n                             ytd_na_elgbl,\n                          SUM(CASE WHEN fisc_yr_mth = g_fisc_yr_mth THEN tm_st_cnt ELSE 0 END) tm_st_cnt,\n                          SUM(CASE WHEN fisc_yr_mth = g_fisc_yr_mth THEN tm_na_cnt ELSE 0 END) tm_na_cnt,\n                          SUM(CASE WHEN fisc_yr_mth = g_fisc_yr_mth THEN tm_st_cnt_ly ELSE 0 END) tm_st_cnt_ly,\n                          SUM(CASE WHEN fisc_yr_mth = g_fisc_yr_mth THEN tm_na_cnt_ly ELSE 0 END) tm_na_cnt_ly\n                     FROM (SELECT fisc_yr_mth,\n                                  rgn_cd,\n                                  rgn_nm,\n                                  area_cd,\n                                  area_nm,\n                                  grp_cd_or_brnch_cd,\n                                  grp_nm_or_div_nm_cd_nbr,\n                                  rgn_sls_mgr_id,\n                                  net_acct_st,\n                                  net_acct_st_ly,\n                                  net_acct_na,\n                                  net_acct_na_ly,\n                                  tm_st_cnt,\n                                  tm_na_cnt,\n                                  tm_st_cnt_ly,\n                                  tm_na_cnt_ly,\n                                  NVL((SELECT DISTINCT 'Y'\n                                         FROM 57eef8c3d4a13d22f0b40f9742e7b281.230ea95f0603b5b9bb462c4ea26a662a7a4d01943c07489ef12b1c93c47b3a30\n                                        WHERE username = 74a532e64f2a3e33d6197afffc5ba9f1.9c0e3ca45e9e6d5e37b7b267abe94ef8),\n                                      'N')\n                                     usr_flg\n                             FROM (  SELECT fisc_yr_mth,\n                                            rgn_cd,\n                                            rgn_nm,\n                                            area_cd,\n                                            area_nm,\n                                            grp_cd_or_brnch_cd,\n                                            grp_nm_or_div_nm_cd_nbr,\n                                            rgn_sls_mgr_id,\n                                            SUM(net_acct_st) net_acct_st,\n                                            SUM(net_acct_st_ly) net_acct_st_ly,\n                                            SUM(net_acct_na) net_acct_na,\n                                            SUM(net_acct_na_ly) net_acct_na_ly,\n                                            COUNT(DISTINCT CASE WHEN net_acct_st > 0 THEN trtry_mgr_id ELSE NULL END) tm_st_cnt,\n                                            COUNT(DISTINCT CASE WHEN net_acct_na > 0 THEN trtry_mgr_id ELSE NULL END) tm_na_cnt,\n                                            COUNT(DISTINCT CASE WHEN net_acct_st_ly > 0 THEN trtry_mgr_id ELSE NULL END) tm_st_cnt_ly,\n                                            COUNT(DISTINCT CASE WHEN net_acct_na_ly > 0 THEN trtry_mgr_id ELSE NULL END) tm_na_cnt_ly\n                                       FROM org_tmp\n                                   GROUP BY fisc_yr_mth,\n                                            rgn_cd,\n                                            rgn_nm,\n                                            area_cd,\n                                            area_nm,\n                                            grp_cd_or_brnch_cd,\n                                            grp_nm_or_div_nm_cd_nbr,\n                                            rgn_sls_mgr_id) a)\n                 GROUP BY rgn_cd,\n                          rgn_nm,\n                          area_cd,\n                          area_nm,\n                          grp_cd_or_brnch_cd,\n                          grp_nm_or_div_nm_cd_nbr,\n                          rgn_sls_mgr_id\n                 UNION\n                   SELECT g_fisc_yr_mth,\n                          'GRP_DIV' org_lvl,\n                          grp_cd_or_brnch_cd org_val,\n                          rgn_cd,\n                          rgn_nm,\n                          area_cd,\n                          area_nm,\n                          grp_cd_or_brnch_cd,\n                          grp_nm_or_div_nm_cd_nbr,\n                          NULL rgn_sls_mgr_id,\n                          NULL dstrct_sls_mgr_id,\n                          NULL trtry_mgr_id,\n                          NULL brnch_trtry_cd,\n                          MAX(CASE\n                                 WHEN (CASE WHEN fisc_yr_mth = g_fisc_yr_mth THEN net_acct_st_ly ELSE 0 END) >= 1\n                                  AND (CASE WHEN fisc_yr_mth = g_fisc_yr_mth THEN net_acct_st ELSE 0 END) >= 1 THEN\n                                    'Y'\n                                 ELSE\n                                    'N'\n                              END)\n                             mth_st_elgbl,\n                          CASE\n                             WHEN MAX(net_acct_st_ly) >= 1\n                              AND MAX(net_acct_st) >= 1 THEN\n                                'Y'\n                             ELSE\n                                'N'\n                          END\n                             ytd_st_elgbl,\n                          MAX(CASE\n                                 WHEN (CASE WHEN fisc_yr_mth = g_fisc_yr_mth THEN net_acct_na_ly ELSE 0 END) >= 1\n                                  AND (CASE WHEN fisc_yr_mth = g_fisc_yr_mth THEN net_acct_na ELSE 0 END) >= 1 THEN\n                                    'Y'\n                                 ELSE\n                                    'N'\n                              END)\n                             mth_na_elgbl,\n                          CASE\n                             WHEN MAX(net_acct_na_ly) >= 1\n                              AND MAX(net_acct_na) >= 1 THEN\n                                'Y'\n                             ELSE\n                                'N'\n                          END\n                             ytd_na_elgbl,\n                          SUM(CASE WHEN fisc_yr_mth = g_fisc_yr_mth THEN tm_st_cnt ELSE 0 END) tm_st_cnt,\n                          SUM(CASE WHEN fisc_yr_mth = g_fisc_yr_mth THEN tm_na_cnt ELSE 0 END) tm_na_cnt,\n                          SUM(CASE WHEN fisc_yr_mth = g_fisc_yr_mth THEN tm_st_cnt_ly ELSE 0 END) tm_st_cnt_ly,\n                          SUM(CASE WHEN fisc_yr_mth = g_fisc_yr_mth THEN tm_na_cnt_ly ELSE 0 END) tm_na_cnt_ly\n                     FROM (  SELECT fisc_yr_mth,\n                                    rgn_cd,\n                                    rgn_nm,\n                                    area_cd,\n                                    area_nm,\n                                    grp_cd_or_brnch_cd,\n                                    grp_nm_or_div_nm_cd_nbr,\n                                    SUM(net_acct_st) net_acct_st,\n                                    SUM(net_acct_st_ly) net_acct_st_ly,\n                                    SUM(net_acct_na) net_acct_na,\n                                    SUM(net_acct_na_ly) net_acct_na_ly,\n                                    COUNT(DISTINCT CASE WHEN net_acct_st > 0 THEN trtry_mgr_id ELSE NULL END) tm_st_cnt,\n                                    COUNT(DISTINCT CASE WHEN net_acct_na > 0 THEN trtry_mgr_id ELSE NULL END) tm_na_cnt,\n                                    COUNT(DISTINCT CASE WHEN net_acct_st_ly > 0 THEN trtry_mgr_id ELSE NULL END) tm_st_cnt_ly,\n                                    COUNT(DISTINCT CASE WHEN net_acct_na_ly > 0 THEN trtry_mgr_id ELSE NULL END) tm_na_cnt_ly\n                               FROM org_tmp\n                           GROUP BY fisc_yr_mth,\n                                    rgn_cd,\n                                    rgn_nm,\n                                    area_cd,\n                                    area_nm,\n                                    grp_cd_or_brnch_cd,\n                                    grp_nm_or_div_nm_cd_nbr)\n                 GROUP BY rgn_cd,\n                          rgn_nm,\n                          area_cd,\n                          area_nm,\n                          grp_cd_or_brnch_cd,\n                          grp_nm_or_div_nm_cd_nbr\n                 UNION\n                   SELECT g_fisc_yr_mth,\n                          'AREA' org_lvl,\n                          area_cd org_val,\n                          rgn_cd,\n                          rgn_nm,\n                          area_cd,\n                          area_nm,\n                          NULL grp_cd_or_brnch_cd,\n                          NULL grp_nm_or_div_nm_cd_nbr,\n                          NULL rgn_sls_mgr_id,\n                          NULL dstrct_sls_mgr_id,\n                          NULL trtry_mgr_id,\n                          NULL brnch_trtry_cd,\n                          MAX(CASE\n                                 WHEN (CASE WHEN fisc_yr_mth = g_fisc_yr_mth THEN net_acct_st_ly ELSE 0 END) >= 1\n                                  AND (CASE WHEN fisc_yr_mth = g_fisc_yr_mth THEN net_acct_st ELSE 0 END) >= 1 THEN\n                                    'Y'\n                                 ELSE\n                                    'N'\n                              END)\n                             mth_st_elgbl,\n                          CASE\n                             WHEN MAX(net_acct_st_ly) >= 1\n                              AND MAX(net_acct_st) >= 1 THEN\n                                'Y'\n                             ELSE\n                                'N'\n                          END\n                             ytd_st_elgbl,\n                          MAX(CASE\n                                 WHEN (CASE WHEN fisc_yr_mth = g_fisc_yr_mth THEN net_acct_na_ly ELSE 0 END) >= 1\n                                  AND (CASE WHEN fisc_yr_mth = g_fisc_yr_mth THEN net_acct_na ELSE 0 END) >= 1 THEN\n                                    'Y'\n                                 ELSE\n                                    'N'\n                              END)\n                             mth_na_elgbl,\n                          CASE\n                             WHEN MAX(net_acct_na_ly) >= 1\n                              AND MAX(net_acct_na) >= 1 THEN\n                                'Y'\n                             ELSE\n                                'N'\n                          END\n                             ytd_na_elgbl,\n                          SUM(CASE WHEN fisc_yr_mth = g_fisc_yr_mth THEN tm_st_cnt ELSE 0 END) tm_st_cnt,\n                          SUM(CASE WHEN fisc_yr_mth = g_fisc_yr_mth THEN tm_na_cnt ELSE 0 END) tm_na_cnt,\n                          SUM(CASE WHEN fisc_yr_mth = g_fisc_yr_mth THEN tm_st_cnt_ly ELSE 0 END) tm_st_cnt_ly,\n                          SUM(CASE WHEN fisc_yr_mth = g_fisc_yr_mth THEN tm_na_cnt_ly ELSE 0 END) tm_na_cnt_ly\n                     FROM (  SELECT fisc_yr_mth,\n                                    rgn_cd,\n                                    rgn_nm,\n                                    area_cd,\n                                    area_nm,\n                                    SUM(net_acct_st) net_acct_st,\n                                    SUM(net_acct_st_ly) net_acct_st_ly,\n                                    SUM(net_acct_na) net_acct_na,\n                                    SUM(net_acct_na_ly) net_acct_na_ly,\n                                    COUNT(DISTINCT CASE WHEN net_acct_st > 0 THEN trtry_mgr_id ELSE NULL END) tm_st_cnt,\n                                    COUNT(DISTINCT CASE WHEN net_acct_na > 0 THEN trtry_mgr_id ELSE NULL END) tm_na_cnt,\n                                    COUNT(DISTINCT CASE WHEN net_acct_st_ly > 0 THEN trtry_mgr_id ELSE NULL END) tm_st_cnt_ly,\n                                    COUNT(DISTINCT CASE WHEN net_acct_na_ly > 0 THEN trtry_mgr_id ELSE NULL END) tm_na_cnt_ly\n                               FROM org_tmp\n                           GROUP BY fisc_yr_mth,\n                                    rgn_cd,\n                                    rgn_nm,\n                                    area_cd,\n                                    area_nm)\n                 GROUP BY rgn_cd,\n                          rgn_nm,\n                          area_cd,\n                          area_nm\n                 UNION\n                   SELECT g_fisc_yr_mth,\n                          'RGN' org_lvl,\n                          rgn_cd org_val,\n                          rgn_cd,\n                          rgn_nm,\n                          NULL area_cd,\n                          NULL area_nm,\n                          NULL grp_cd_or_brnch_cd,\n                          NULL grp_nm_or_div_nm_cd_nbr,\n                          NULL rgn_sls_mgr_id,\n                          NULL dstrct_sls_mgr_id,\n                          NULL trtry_mgr_id,\n                          NULL brnch_trtry_cd,\n                          'Y' mth_st_elgbl,\n                          'Y' ytd_st_elgbl,\n                          'Y' mth_na_elgbl,\n                          'Y' ytd_na_elgbl,\n                          SUM(CASE WHEN fisc_yr_mth = g_fisc_yr_mth THEN tm_st_cnt ELSE 0 END) tm_st_cnt,\n                          SUM(CASE WHEN fisc_yr_mth = g_fisc_yr_mth THEN tm_na_cnt ELSE 0 END) tm_na_cnt,\n                          SUM(CASE WHEN fisc_yr_mth = g_fisc_yr_mth THEN tm_st_cnt_ly ELSE 0 END) tm_st_cnt_ly,\n                          SUM(CASE WHEN fisc_yr_mth = g_fisc_yr_mth THEN tm_na_cnt_ly ELSE 0 END) tm_na_cnt_ly\n                     FROM (  SELECT fisc_yr_mth, rgn_cd, rgn_nm, COUNT(DISTINCT CASE WHEN net_acct_st > 0 THEN trtry_mgr_id ELSE NULL END) tm_st_cnt, COUNT(DISTINCT CASE WHEN net_acct_na > 0 THEN trtry_mgr_id ELSE NULL END) tm_na_cnt, COUNT(DISTINCT CASE WHEN net_acct_st_ly > 0 THEN trtry_mgr_id ELSE NULL END) tm_st_cnt_ly, COUNT(DISTINCT CASE WHEN net_acct_na_ly > 0 THEN trtry_mgr_id ELSE NULL END) tm_na_cnt_ly\n                               FROM org_tmp\n                           GROUP BY fisc_yr_mth, rgn_cd, rgn_nm)\n                 GROUP BY rgn_cd, rgn_nm);\n\n      DBMS_OUTPUT.put_line('Inserted ' || sql%ROWCOUNT || ' rows');\n\n      COMMIT;\n\n      \n      l_return_code   := 57eef8c3d4a13d22f0b40f9742e7b281.e9c7d074541f588587f071b89e534d87('XDMADM', 'SLS_RNK_ORG_TMP');\n      DBMS_OUTPUT.put_line('Analyze SLS_RNK_ORG_TMP Return Code: ' || l_return_code);\n\n      IF l_return_code <> 0 THEN\n         DBMS_OUTPUT.put_line('Error: Failed to analyze table SLS_RNK_ORG_TMP');\n      END IF;\n   END ins_sls_rnk_org;\n\n   \n   PROCEDURE ins_sls_rnk_tmp IS\n      l_return_code   NUMBER := 0;\n      l_out_msg       VARCHAR2(256);\n   BEGIN\n      \n      l_return_code   := 51a807b365f066e5e34d0ad8a0117c9c.9b9dddad754084e9039b44beec15a88d.c9c724fb8ac640ac45c4a6fc55311bbe(l_out_msg, 'XDMADM', 'SLS_RNK_TMP');\n      DBMS_OUTPUT.put_line('Truncate table SLS_RNK_TMP return code: ' || l_return_code);\n\n      DBMS_OUTPUT.put_line('Begin inserting SLS_RNK_TMP');\n\n      INSERT INTO 57eef8c3d4a13d22f0b40f9742e7b281.f2a0e23cc9c6bc0a97b68fe4091ebe54\n         (  SELECT g_fisc_yr_mth fisc_yr_mth,\n                   57eef8c3d4a13d22f0b40f9742e7b281.7cad4bed0267ab37956f1fcccb769b24.4eb9d832d7428eb363fb936e2036c963,\n                   CASE WHEN 57eef8c3d4a13d22f0b40f9742e7b281.7cad4bed0267ab37956f1fcccb769b24.a534b553ce2280fa65ad5af10e67f577 = g_grp_typ_cd THEN 'G_' || 57eef8c3d4a13d22f0b40f9742e7b281.7cad4bed0267ab37956f1fcccb769b24.0c37e0327461eb9c1d479f1bf773611a ELSE 'D_' || 57eef8c3d4a13d22f0b40f9742e7b281.7cad4bed0267ab37956f1fcccb769b24.cd8c19b82a9bb45539c5ddd5262d5ee8 END grp_cd_or_brnch_cd,\n                   57eef8c3d4a13d22f0b40f9742e7b281.7b6f47db0f8e291b853cdfa5619afedf.5a8103ceb3eda727eed8d3dbc244a027,\n                   NVL(57eef8c3d4a13d22f0b40f9742e7b281.d73db8611de2680d7b0b5feaa04810c2.9c0e3ca45e9e6d5e37b7b267abe94ef8, g_default_id) rgn_sls_mgr_id,\n                   NVL(57eef8c3d4a13d22f0b40f9742e7b281.d73db8611de2680d7b0b5feaa04810c2.f0e42dcd17c0461501b0d0a44a18ba0c0ca5fb119e004e3dd9cc2be01757c595, g_default_id) dstrct_sls_mgr_id,\n                   NVL(57eef8c3d4a13d22f0b40f9742e7b281.d73db8611de2680d7b0b5feaa04810c2.a2aa8624c681d422d7579b82a029c958, g_default_id) trtry_mgr_id,\n                   57eef8c3d4a13d22f0b40f9742e7b281.7cad4bed0267ab37956f1fcccb769b24.cd8c19b82a9bb45539c5ddd5262d5ee8 || '-' || 57eef8c3d4a13d22f0b40f9742e7b281.d73db8611de2680d7b0b5feaa04810c2.c2c889382e3600a66841485b2acbd235 brnch_trtry_cd,\n                   57eef8c3d4a13d22f0b40f9742e7b281.d73db8611de2680d7b0b5feaa04810c2.cccc4a6a953ec910fc17463e24f09c77,\n                   57eef8c3d4a13d22f0b40f9742e7b281.d73db8611de2680d7b0b5feaa04810c2.0b49a7fb4e4ab429796cf3bf656d061a711cccba8c2d5033896154ebc5bb9823,\n                   57eef8c3d4a13d22f0b40f9742e7b281.c2f43c31651b37621d36cc6c7b12632e.4c01182b11bab7684e2c612849b1ad0d,\n                   57eef8c3d4a13d22f0b40f9742e7b281.9120c445eaf2287e4edc55adaf0f21a60353b2a83648372cb2d3370b12c1d504.5d05d543e266512d1fd2ec6a83eece24,\n                   SUM(CASE WHEN 57eef8c3d4a13d22f0b40f9742e7b281.ac60f3b24ab9261fbfdd476a640ab55e.051677fa81b6acaecd067857b3e57ecd = g_fisc_yr_mth THEN NVL(57eef8c3d4a13d22f0b40f9742e7b281.7b6f47db0f8e291b853cdfa5619afedf.9e7e4013fd15c78725b0ef91cd1cd802, 0) ELSE 0 END) grs_sls_extnd,\n                   SUM(CASE WHEN 57eef8c3d4a13d22f0b40f9742e7b281.ac60f3b24ab9261fbfdd476a640ab55e.051677fa81b6acaecd067857b3e57ecd = g_fisc_yr_mth THEN NVL(57eef8c3d4a13d22f0b40f9742e7b281.7b6f47db0f8e291b853cdfa5619afedf.38b856c3c52540c729a21ac9b1e8d4b453a0c0fe76045acdb204ca36f43c8ecf, 0) ELSE 0 END) grs_sls_extnd_ly,\n                   SUM(NVL(57eef8c3d4a13d22f0b40f9742e7b281.7b6f47db0f8e291b853cdfa5619afedf.9e7e4013fd15c78725b0ef91cd1cd802, 0)) grs_sls_extnd_ytd,\n                   SUM(NVL(57eef8c3d4a13d22f0b40f9742e7b281.7b6f47db0f8e291b853cdfa5619afedf.38b856c3c52540c729a21ac9b1e8d4b453a0c0fe76045acdb204ca36f43c8ecf, 0)) grs_sls_extnd_ytd_ly,\n                   SUM(CASE WHEN 57eef8c3d4a13d22f0b40f9742e7b281.ac60f3b24ab9261fbfdd476a640ab55e.051677fa81b6acaecd067857b3e57ecd = g_fisc_yr_mth THEN NVL(57eef8c3d4a13d22f0b40f9742e7b281.7b6f47db0f8e291b853cdfa5619afedf.35b5bbe882cdc6cc77aeda236583bcf0, 0) ELSE 0 END) unfrm_qty_ship,\n                   SUM(CASE WHEN 57eef8c3d4a13d22f0b40f9742e7b281.ac60f3b24ab9261fbfdd476a640ab55e.051677fa81b6acaecd067857b3e57ecd = g_fisc_yr_mth THEN NVL(57eef8c3d4a13d22f0b40f9742e7b281.7b6f47db0f8e291b853cdfa5619afedf.c010eb47e28b6c7bf48eb014da195523d4562c639a288065002fd4e56c86fcd7, 0) ELSE 0 END) unfrm_qty_ship_ly,\n                   SUM(NVL(57eef8c3d4a13d22f0b40f9742e7b281.7b6f47db0f8e291b853cdfa5619afedf.35b5bbe882cdc6cc77aeda236583bcf0, 0)) unfrm_qty_ship_ytd,\n                   SUM(NVL(57eef8c3d4a13d22f0b40f9742e7b281.7b6f47db0f8e291b853cdfa5619afedf.c010eb47e28b6c7bf48eb014da195523d4562c639a288065002fd4e56c86fcd7, 0)) unfrm_qty_ship_ytd_ly,\n                   SUM(CASE WHEN 57eef8c3d4a13d22f0b40f9742e7b281.ac60f3b24ab9261fbfdd476a640ab55e.051677fa81b6acaecd067857b3e57ecd = g_fisc_yr_mth THEN NVL(57eef8c3d4a13d22f0b40f9742e7b281.7b6f47db0f8e291b853cdfa5619afedf.de359d0148528b5cfe3c4b36b71fd9cd, 0) ELSE 0 END) grs_tgp,\n                   SUM(CASE WHEN 57eef8c3d4a13d22f0b40f9742e7b281.ac60f3b24ab9261fbfdd476a640ab55e.051677fa81b6acaecd067857b3e57ecd = g_fisc_yr_mth THEN NVL(57eef8c3d4a13d22f0b40f9742e7b281.7b6f47db0f8e291b853cdfa5619afedf.7b01e56fd85d33f336818231098d9d90, 0) ELSE 0 END) grs_tgp_ly,\n                   SUM(NVL(57eef8c3d4a13d22f0b40f9742e7b281.7b6f47db0f8e291b853cdfa5619afedf.de359d0148528b5cfe3c4b36b71fd9cd, 0)) grs_tgp_ytd,\n                   SUM(NVL(57eef8c3d4a13d22f0b40f9742e7b281.7b6f47db0f8e291b853cdfa5619afedf.7b01e56fd85d33f336818231098d9d90, 0)) grs_tgp_ytd_ly,\n                   COUNT(DISTINCT CASE WHEN 57eef8c3d4a13d22f0b40f9742e7b281.ac60f3b24ab9261fbfdd476a640ab55e.051677fa81b6acaecd067857b3e57ecd = g_fisc_yr_mth THEN 57eef8c3d4a13d22f0b40f9742e7b281.7b6f47db0f8e291b853cdfa5619afedf.633bff8cd684a2516fd7ab36360caed253a0c0fe76045acdb204ca36f43c8ecf ELSE NULL END) net_acct,\n                   COUNT(DISTINCT CASE WHEN 57eef8c3d4a13d22f0b40f9742e7b281.ac60f3b24ab9261fbfdd476a640ab55e.051677fa81b6acaecd067857b3e57ecd = g_fisc_yr_mth THEN 57eef8c3d4a13d22f0b40f9742e7b281.7b6f47db0f8e291b853cdfa5619afedf.633bff8cd684a2516fd7ab36360caed291b777230e03c0dedfb113c2c8af948c ELSE NULL END) net_acct_ly,\n                   COUNT(DISTINCT 57eef8c3d4a13d22f0b40f9742e7b281.7b6f47db0f8e291b853cdfa5619afedf.633bff8cd684a2516fd7ab36360caed253a0c0fe76045acdb204ca36f43c8ecf) net_acct_ytd,\n                   COUNT(DISTINCT 57eef8c3d4a13d22f0b40f9742e7b281.7b6f47db0f8e291b853cdfa5619afedf.633bff8cd684a2516fd7ab36360caed291b777230e03c0dedfb113c2c8af948c) net_acct_ytd_ly,\n                   SUM(CASE WHEN 57eef8c3d4a13d22f0b40f9742e7b281.ac60f3b24ab9261fbfdd476a640ab55e.051677fa81b6acaecd067857b3e57ecd = g_fisc_yr_mth THEN NVL(57eef8c3d4a13d22f0b40f9742e7b281.7b6f47db0f8e291b853cdfa5619afedf.e3c9674cf72ad209a86e79ad7170a77f, 0) ELSE 0 END) rt_ln_cnt,\n                   SUM(CASE WHEN 57eef8c3d4a13d22f0b40f9742e7b281.ac60f3b24ab9261fbfdd476a640ab55e.051677fa81b6acaecd067857b3e57ecd = g_fisc_yr_mth THEN NVL(57eef8c3d4a13d22f0b40f9742e7b281.7b6f47db0f8e291b853cdfa5619afedf.cc13a0b97d56d9aff1b0c78c855c726c53a0c0fe76045acdb204ca36f43c8ecf, 0) ELSE 0 END) vndr_ship_ln_cnt,\n                   SUM(CASE WHEN 57eef8c3d4a13d22f0b40f9742e7b281.ac60f3b24ab9261fbfdd476a640ab55e.051677fa81b6acaecd067857b3e57ecd = g_fisc_yr_mth THEN NVL(57eef8c3d4a13d22f0b40f9742e7b281.7b6f47db0f8e291b853cdfa5619afedf.26c3a68b174857edf61a2b0937fd2db7, 0) ELSE 0 END) wc_ln_cnt,\n                   SUM(CASE WHEN 57eef8c3d4a13d22f0b40f9742e7b281.ac60f3b24ab9261fbfdd476a640ab55e.051677fa81b6acaecd067857b3e57ecd = g_fisc_yr_mth THEN NVL(57eef8c3d4a13d22f0b40f9742e7b281.7b6f47db0f8e291b853cdfa5619afedf.163292e356591886d2dbc90bb358824a, 0) ELSE 0 END) drop_cnt,\n                   SUM(CASE WHEN 57eef8c3d4a13d22f0b40f9742e7b281.ac60f3b24ab9261fbfdd476a640ab55e.051677fa81b6acaecd067857b3e57ecd = g_fisc_yr_mth THEN NVL(57eef8c3d4a13d22f0b40f9742e7b281.7b6f47db0f8e291b853cdfa5619afedf.38b68df6eff1ccc35e63028a96c972a6, 0) ELSE 0 END) rt_ln_cnt_ly,\n                   SUM(CASE WHEN 57eef8c3d4a13d22f0b40f9742e7b281.ac60f3b24ab9261fbfdd476a640ab55e.051677fa81b6acaecd067857b3e57ecd = g_fisc_yr_mth THEN NVL(57eef8c3d4a13d22f0b40f9742e7b281.7b6f47db0f8e291b853cdfa5619afedf.cc13a0b97d56d9aff1b0c78c855c726c91b777230e03c0dedfb113c2c8af948c, 0) ELSE 0 END) vndr_ship_ln_cnt_ly,\n                   SUM(CASE WHEN 57eef8c3d4a13d22f0b40f9742e7b281.ac60f3b24ab9261fbfdd476a640ab55e.051677fa81b6acaecd067857b3e57ecd = g_fisc_yr_mth THEN NVL(57eef8c3d4a13d22f0b40f9742e7b281.7b6f47db0f8e291b853cdfa5619afedf.020f3d7b0db35337834063801a84df46, 0) ELSE 0 END) wc_ln_cnt_ly,\n                   SUM(CASE WHEN 57eef8c3d4a13d22f0b40f9742e7b281.ac60f3b24ab9261fbfdd476a640ab55e.051677fa81b6acaecd067857b3e57ecd = g_fisc_yr_mth THEN NVL(57eef8c3d4a13d22f0b40f9742e7b281.7b6f47db0f8e291b853cdfa5619afedf.eb496422b413b276ec7601e36b3cddd4, 0) ELSE 0 END) drop_cnt_ly,\n                   SUM(CASE WHEN 57eef8c3d4a13d22f0b40f9742e7b281.ac60f3b24ab9261fbfdd476a640ab55e.051677fa81b6acaecd067857b3e57ecd = g_fisc_yr_mth THEN NVL(57eef8c3d4a13d22f0b40f9742e7b281.7b6f47db0f8e291b853cdfa5619afedf.05bf51c98f7ab7d3a8b23f414be7cea253a0c0fe76045acdb204ca36f43c8ecf, 0) ELSE 0 END) eb_grs_sls_extnd,\n                   SUM(CASE WHEN 57eef8c3d4a13d22f0b40f9742e7b281.ac60f3b24ab9261fbfdd476a640ab55e.051677fa81b6acaecd067857b3e57ecd = g_fisc_yr_mth THEN NVL(57eef8c3d4a13d22f0b40f9742e7b281.7b6f47db0f8e291b853cdfa5619afedf.05bf51c98f7ab7d3a8b23f414be7cea291b777230e03c0dedfb113c2c8af948c, 0) ELSE 0 END) eb_grs_sls_extnd_ly,\n                   SUM(CASE WHEN 57eef8c3d4a13d22f0b40f9742e7b281.ac60f3b24ab9261fbfdd476a640ab55e.051677fa81b6acaecd067857b3e57ecd = g_fisc_yr_mth THEN NVL(57eef8c3d4a13d22f0b40f9742e7b281.7b6f47db0f8e291b853cdfa5619afedf.30b8eb8adbe8b46b8847e3302ec12ef153a0c0fe76045acdb204ca36f43c8ecf, 0) ELSE 0 END) ec_grs_sls_extnd,\n                   SUM(CASE WHEN 57eef8c3d4a13d22f0b40f9742e7b281.ac60f3b24ab9261fbfdd476a640ab55e.051677fa81b6acaecd067857b3e57ecd = g_fisc_yr_mth THEN NVL(57eef8c3d4a13d22f0b40f9742e7b281.7b6f47db0f8e291b853cdfa5619afedf.781bd4db21a2cb52defbc57c6e6eb0a053a0c0fe76045acdb204ca36f43c8ecf, 0) ELSE 0 END) rt_grs_sls_extnd,\n                   SUM(CASE WHEN 57eef8c3d4a13d22f0b40f9742e7b281.ac60f3b24ab9261fbfdd476a640ab55e.051677fa81b6acaecd067857b3e57ecd = g_fisc_yr_mth THEN NVL(57eef8c3d4a13d22f0b40f9742e7b281.7b6f47db0f8e291b853cdfa5619afedf.a3f81d344cc4a0aef3a614e5af45d37653a0c0fe76045acdb204ca36f43c8ecf, 0) ELSE 0 END) vs_grs_sls_extnd,\n                   SUM(CASE WHEN 57eef8c3d4a13d22f0b40f9742e7b281.ac60f3b24ab9261fbfdd476a640ab55e.051677fa81b6acaecd067857b3e57ecd = g_fisc_yr_mth THEN NVL(57eef8c3d4a13d22f0b40f9742e7b281.7b6f47db0f8e291b853cdfa5619afedf.ed4079c11dff76da027267ac8f0aa7c853a0c0fe76045acdb204ca36f43c8ecf, 0) ELSE 0 END) wc_grs_sls_extnd,\n                   SUM(CASE\n                          WHEN 57eef8c3d4a13d22f0b40f9742e7b281.ac60f3b24ab9261fbfdd476a640ab55e.051677fa81b6acaecd067857b3e57ecd = g_fisc_yr_mth\n                           AND 57eef8c3d4a13d22f0b40f9742e7b281.33d5d9bbe88e36eb225ea6acfd1f90d953a0c0fe76045acdb204ca36f43c8ecf.d5d60a3677b46a3b9c2d21a74abbf3f0feb16ec175a739c84b79e5d396593a57 = 1 THEN\n                             NVL(57eef8c3d4a13d22f0b40f9742e7b281.7b6f47db0f8e291b853cdfa5619afedf.9e7e4013fd15c78725b0ef91cd1cd802, 0)\n                          ELSE\n                             0\n                       END)\n                      ir_grs_sls_extnd,\n                   SUM(CASE WHEN 57eef8c3d4a13d22f0b40f9742e7b281.33d5d9bbe88e36eb225ea6acfd1f90d953a0c0fe76045acdb204ca36f43c8ecf.d5d60a3677b46a3b9c2d21a74abbf3f0feb16ec175a739c84b79e5d396593a57 = 1 THEN NVL(57eef8c3d4a13d22f0b40f9742e7b281.7b6f47db0f8e291b853cdfa5619afedf.9e7e4013fd15c78725b0ef91cd1cd802, 0) ELSE 0 END) ir_grs_sls_extnd_ytd,\n                   57eef8c3d4a13d22f0b40f9742e7b281.7cad4bed0267ab37956f1fcccb769b24.83b71521fb15b7d5d328381cdcc3ebd0\n              FROM 57eef8c3d4a13d22f0b40f9742e7b281.7b6f47db0f8e291b853cdfa5619afedf s,\n                   57eef8c3d4a13d22f0b40f9742e7b281.d73db8611de2680d7b0b5feaa04810c2 cc,\n                   57eef8c3d4a13d22f0b40f9742e7b281.9120c445eaf2287e4edc55adaf0f21a60353b2a83648372cb2d3370b12c1d504 cls,\n                   57eef8c3d4a13d22f0b40f9742e7b281.7cad4bed0267ab37956f1fcccb769b24 d,\n                   57eef8c3d4a13d22f0b40f9742e7b281.7cad4bed0267ab37956f1fcccb769b24 d2,\n                   57eef8c3d4a13d22f0b40f9742e7b281.ac60f3b24ab9261fbfdd476a640ab55e t,\n                   57eef8c3d4a13d22f0b40f9742e7b281.c2f43c31651b37621d36cc6c7b12632e st,\n                   57eef8c3d4a13d22f0b40f9742e7b281.33d5d9bbe88e36eb225ea6acfd1f90d953a0c0fe76045acdb204ca36f43c8ecf pyr\n             WHERE 57eef8c3d4a13d22f0b40f9742e7b281.7b6f47db0f8e291b853cdfa5619afedf.6e427bacb381704d6a3dbca94a0d4f03 = 57eef8c3d4a13d22f0b40f9742e7b281.d73db8611de2680d7b0b5feaa04810c2.6e427bacb381704d6a3dbca94a0d4f03\n               AND 57eef8c3d4a13d22f0b40f9742e7b281.7b6f47db0f8e291b853cdfa5619afedf.5a8103ceb3eda727eed8d3dbc244a027 = 57eef8c3d4a13d22f0b40f9742e7b281.d73db8611de2680d7b0b5feaa04810c2.5a8103ceb3eda727eed8d3dbc244a027\n               AND 57eef8c3d4a13d22f0b40f9742e7b281.7b6f47db0f8e291b853cdfa5619afedf.6e427bacb381704d6a3dbca94a0d4f03 = 57eef8c3d4a13d22f0b40f9742e7b281.9120c445eaf2287e4edc55adaf0f21a60353b2a83648372cb2d3370b12c1d504.6e427bacb381704d6a3dbca94a0d4f03\n               AND 57eef8c3d4a13d22f0b40f9742e7b281.7b6f47db0f8e291b853cdfa5619afedf.5a8103ceb3eda727eed8d3dbc244a027 = 57eef8c3d4a13d22f0b40f9742e7b281.9120c445eaf2287e4edc55adaf0f21a60353b2a83648372cb2d3370b12c1d504.5a8103ceb3eda727eed8d3dbc244a027\n               AND 57eef8c3d4a13d22f0b40f9742e7b281.ac60f3b24ab9261fbfdd476a640ab55e.051677fa81b6acaecd067857b3e57ecd = 57eef8c3d4a13d22f0b40f9742e7b281.9120c445eaf2287e4edc55adaf0f21a60353b2a83648372cb2d3370b12c1d504.051677fa81b6acaecd067857b3e57ecd\n               AND 57eef8c3d4a13d22f0b40f9742e7b281.7b6f47db0f8e291b853cdfa5619afedf.5a8103ceb3eda727eed8d3dbc244a027 = 57eef8c3d4a13d22f0b40f9742e7b281.7cad4bed0267ab37956f1fcccb769b24.5a8103ceb3eda727eed8d3dbc244a027\n               AND 57eef8c3d4a13d22f0b40f9742e7b281.7b6f47db0f8e291b853cdfa5619afedf.78b147c8e239062228170605a601c274 = 57eef8c3d4a13d22f0b40f9742e7b281.ac60f3b24ab9261fbfdd476a640ab55e.78b147c8e239062228170605a601c274\n               AND 57eef8c3d4a13d22f0b40f9742e7b281.d73db8611de2680d7b0b5feaa04810c2.5a8103ceb3eda727eed8d3dbc244a027 = 57eef8c3d4a13d22f0b40f9742e7b281.c2f43c31651b37621d36cc6c7b12632e.5a8103ceb3eda727eed8d3dbc244a027\n               AND 57eef8c3d4a13d22f0b40f9742e7b281.d73db8611de2680d7b0b5feaa04810c2.c2c889382e3600a66841485b2acbd235 = 57eef8c3d4a13d22f0b40f9742e7b281.c2f43c31651b37621d36cc6c7b12632e.c2c889382e3600a66841485b2acbd235\n               AND 57eef8c3d4a13d22f0b40f9742e7b281.d73db8611de2680d7b0b5feaa04810c2.cccc4a6a953ec910fc17463e24f09c77 = 57eef8c3d4a13d22f0b40f9742e7b281.33d5d9bbe88e36eb225ea6acfd1f90d953a0c0fe76045acdb204ca36f43c8ecf.cccc4a6a953ec910fc17463e24f09c77\n               \n               AND 57eef8c3d4a13d22f0b40f9742e7b281.ac60f3b24ab9261fbfdd476a640ab55e.9b0cd70f1039477f7d51dc7aea625afe = g_fisc_yr\n               AND 57eef8c3d4a13d22f0b40f9742e7b281.ac60f3b24ab9261fbfdd476a640ab55e.78b147c8e239062228170605a601c274 <= g_fisc_yr_wk\n               AND 57eef8c3d4a13d22f0b40f9742e7b281.7b6f47db0f8e291b853cdfa5619afedf.318fdc0a1edcc562c36f48fc77ec4a6a = 'N'\n               AND 57eef8c3d4a13d22f0b40f9742e7b281.d73db8611de2680d7b0b5feaa04810c2.7080f549428abf39b1057724fa59d813 = '1'\n               AND 57eef8c3d4a13d22f0b40f9742e7b281.7cad4bed0267ab37956f1fcccb769b24.d5888bb74952b9abf72c4e89988d3f67 = 'USF'\n               AND 57eef8c3d4a13d22f0b40f9742e7b281.7cad4bed0267ab37956f1fcccb769b24.d5888bb74952b9abf72c4e89988d3f67 <> 'CC'\n               AND NVL(57eef8c3d4a13d22f0b40f9742e7b281.7cad4bed0267ab37956f1fcccb769b24.2800fcaf2024e8cef16792ebcf9e3538, 'USF') = 'USF' \n               AND NVL(57eef8c3d4a13d22f0b40f9742e7b281.7b6f47db0f8e291b853cdfa5619afedf.62b8391a73b393544f23e7450967c0131766d3fdb0a7d34e76c86087df29e1be, 57eef8c3d4a13d22f0b40f9742e7b281.7cad4bed0267ab37956f1fcccb769b24.5a8103ceb3eda727eed8d3dbc244a027) = 57eef8c3d4a13d22f0b40f9742e7b281.7cad4bed0267ab37956f1fcccb769b24.5a8103ceb3eda727eed8d3dbc244a027 \n               AND 57eef8c3d4a13d22f0b40f9742e7b281.7cad4bed0267ab37956f1fcccb769b24.0cdc126b1c7da4de6df00b51a8cfda85 = 1\n               AND NOT EXISTS (SELECT 'X'\n                                 FROM 57eef8c3d4a13d22f0b40f9742e7b281.1f9c921b05aafc28bf91547d5ec08a09\n                                WHERE app_name = 'DIV_SALES_CHURN'\n                                  AND param_type = 'EXCLD_BRDLN_DIV'\n                                  AND param_value_nbr = 57eef8c3d4a13d22f0b40f9742e7b281.7cad4bed0267ab37956f1fcccb769b24.5a8103ceb3eda727eed8d3dbc244a027)\n          GROUP BY 57eef8c3d4a13d22f0b40f9742e7b281.7cad4bed0267ab37956f1fcccb769b24.4eb9d832d7428eb363fb936e2036c963,\n                   CASE WHEN 57eef8c3d4a13d22f0b40f9742e7b281.7cad4bed0267ab37956f1fcccb769b24.a534b553ce2280fa65ad5af10e67f577 = g_grp_typ_cd THEN 'G_' || 57eef8c3d4a13d22f0b40f9742e7b281.7cad4bed0267ab37956f1fcccb769b24.0c37e0327461eb9c1d479f1bf773611a ELSE 'D_' || 57eef8c3d4a13d22f0b40f9742e7b281.7cad4bed0267ab37956f1fcccb769b24.cd8c19b82a9bb45539c5ddd5262d5ee8 END,\n                   57eef8c3d4a13d22f0b40f9742e7b281.7b6f47db0f8e291b853cdfa5619afedf.5a8103ceb3eda727eed8d3dbc244a027,\n                   57eef8c3d4a13d22f0b40f9742e7b281.d73db8611de2680d7b0b5feaa04810c2.9c0e3ca45e9e6d5e37b7b267abe94ef8,\n                   57eef8c3d4a13d22f0b40f9742e7b281.d73db8611de2680d7b0b5feaa04810c2.f0e42dcd17c0461501b0d0a44a18ba0c0ca5fb119e004e3dd9cc2be01757c595,\n                   57eef8c3d4a13d22f0b40f9742e7b281.d73db8611de2680d7b0b5feaa04810c2.a2aa8624c681d422d7579b82a029c958,\n                   57eef8c3d4a13d22f0b40f9742e7b281.7cad4bed0267ab37956f1fcccb769b24.cd8c19b82a9bb45539c5ddd5262d5ee8 || '-' || 57eef8c3d4a13d22f0b40f9742e7b281.d73db8611de2680d7b0b5feaa04810c2.c2c889382e3600a66841485b2acbd235,\n                   57eef8c3d4a13d22f0b40f9742e7b281.d73db8611de2680d7b0b5feaa04810c2.cccc4a6a953ec910fc17463e24f09c77,\n                   57eef8c3d4a13d22f0b40f9742e7b281.d73db8611de2680d7b0b5feaa04810c2.0b49a7fb4e4ab429796cf3bf656d061a711cccba8c2d5033896154ebc5bb9823,\n                   57eef8c3d4a13d22f0b40f9742e7b281.c2f43c31651b37621d36cc6c7b12632e.4c01182b11bab7684e2c612849b1ad0d,\n                   57eef8c3d4a13d22f0b40f9742e7b281.9120c445eaf2287e4edc55adaf0f21a60353b2a83648372cb2d3370b12c1d504.5d05d543e266512d1fd2ec6a83eece24,\n                   57eef8c3d4a13d22f0b40f9742e7b281.7cad4bed0267ab37956f1fcccb769b24.83b71521fb15b7d5d328381cdcc3ebd0);\n\n      DBMS_OUTPUT.put_line('Inserted ' || sql%ROWCOUNT || ' rows in SLS_RNK_TMP table');\n\n      COMMIT;\n\n      \n      l_return_code   := 57eef8c3d4a13d22f0b40f9742e7b281.e9c7d074541f588587f071b89e534d87('XDMADM', 'SLS_RNK_TMP');\n      DBMS_OUTPUT.put_line('Analyze SLS_RNK_TMP Return Code: ' || l_return_code);\n\n      IF l_return_code <> 0 THEN\n         DBMS_OUTPUT.put_line('Error: Failed to analyze table SLS_RNK_TMP');\n      END IF;\n   END ins_sls_rnk_tmp;\n\n   \n   PROCEDURE ins_sls_rnk_mth IS\n      \n      CURSOR c_org_lvl IS\n         SELECT param_code org_lvl,\n                CASE param_code\n                   WHEN 'TRTRY' THEN\n                      '46bd43eb00eef456dba9d96ff198d23e.ef475f1eb4af657bf72d87e81656e990feb16ec175a739c84b79e5d396593a57 = fbedbc120a0a5f64565a8fd10ef09617.ef475f1eb4af657bf72d87e81656e990feb16ec175a739c84b79e5d396593a57\n                    AND 46bd43eb00eef456dba9d96ff198d23e.9c0e3ca45e9e6d5e37b7b267abe94ef8 = fbedbc120a0a5f64565a8fd10ef09617.9c0e3ca45e9e6d5e37b7b267abe94ef8\n                    AND 46bd43eb00eef456dba9d96ff198d23e.f0e42dcd17c0461501b0d0a44a18ba0c0ca5fb119e004e3dd9cc2be01757c595 = fbedbc120a0a5f64565a8fd10ef09617.f0e42dcd17c0461501b0d0a44a18ba0c0ca5fb119e004e3dd9cc2be01757c595\n                    AND 46bd43eb00eef456dba9d96ff198d23e.a2aa8624c681d422d7579b82a029c958 = fbedbc120a0a5f64565a8fd10ef09617.a2aa8624c681d422d7579b82a029c958\n                    AND 46bd43eb00eef456dba9d96ff198d23e.c492229178479df540a130a9914194ab = fbedbc120a0a5f64565a8fd10ef09617.c492229178479df540a130a9914194ab'\n                   WHEN 'TM' THEN\n                      '46bd43eb00eef456dba9d96ff198d23e.ef475f1eb4af657bf72d87e81656e990feb16ec175a739c84b79e5d396593a57 = fbedbc120a0a5f64565a8fd10ef09617.ef475f1eb4af657bf72d87e81656e990feb16ec175a739c84b79e5d396593a57\n                    AND 46bd43eb00eef456dba9d96ff198d23e.9c0e3ca45e9e6d5e37b7b267abe94ef8 = fbedbc120a0a5f64565a8fd10ef09617.9c0e3ca45e9e6d5e37b7b267abe94ef8\n                    AND 46bd43eb00eef456dba9d96ff198d23e.f0e42dcd17c0461501b0d0a44a18ba0c0ca5fb119e004e3dd9cc2be01757c595 = fbedbc120a0a5f64565a8fd10ef09617.f0e42dcd17c0461501b0d0a44a18ba0c0ca5fb119e004e3dd9cc2be01757c595\n                    AND 46bd43eb00eef456dba9d96ff198d23e.a2aa8624c681d422d7579b82a029c958 = fbedbc120a0a5f64565a8fd10ef09617.a2aa8624c681d422d7579b82a029c958'\n                   WHEN 'DSM' THEN\n                      '46bd43eb00eef456dba9d96ff198d23e.ef475f1eb4af657bf72d87e81656e990feb16ec175a739c84b79e5d396593a57 = fbedbc120a0a5f64565a8fd10ef09617.ef475f1eb4af657bf72d87e81656e990feb16ec175a739c84b79e5d396593a57\n                    AND 46bd43eb00eef456dba9d96ff198d23e.9c0e3ca45e9e6d5e37b7b267abe94ef8 = fbedbc120a0a5f64565a8fd10ef09617.9c0e3ca45e9e6d5e37b7b267abe94ef8\n                    AND 46bd43eb00eef456dba9d96ff198d23e.f0e42dcd17c0461501b0d0a44a18ba0c0ca5fb119e004e3dd9cc2be01757c595 = fbedbc120a0a5f64565a8fd10ef09617.f0e42dcd17c0461501b0d0a44a18ba0c0ca5fb119e004e3dd9cc2be01757c595'\n                   WHEN 'RSM' THEN\n                      '46bd43eb00eef456dba9d96ff198d23e.ef475f1eb4af657bf72d87e81656e990feb16ec175a739c84b79e5d396593a57 = fbedbc120a0a5f64565a8fd10ef09617.ef475f1eb4af657bf72d87e81656e990feb16ec175a739c84b79e5d396593a57\n                    AND 46bd43eb00eef456dba9d96ff198d23e.9c0e3ca45e9e6d5e37b7b267abe94ef8 = fbedbc120a0a5f64565a8fd10ef09617.9c0e3ca45e9e6d5e37b7b267abe94ef8'\n                   WHEN 'GRP_DIV' THEN\n                      '46bd43eb00eef456dba9d96ff198d23e.ef475f1eb4af657bf72d87e81656e990feb16ec175a739c84b79e5d396593a57 = fbedbc120a0a5f64565a8fd10ef09617.ef475f1eb4af657bf72d87e81656e990feb16ec175a739c84b79e5d396593a57'\n                   WHEN 'AREA' THEN\n                      '46bd43eb00eef456dba9d96ff198d23e.83b71521fb15b7d5d328381cdcc3ebd0 = fbedbc120a0a5f64565a8fd10ef09617.83b71521fb15b7d5d328381cdcc3ebd0'\n                   WHEN 'RGN' THEN\n                      '46bd43eb00eef456dba9d96ff198d23e.4eb9d832d7428eb363fb936e2036c963 = fbedbc120a0a5f64565a8fd10ef09617.4eb9d832d7428eb363fb936e2036c963'\n                END\n                   predicate\n           FROM 57eef8c3d4a13d22f0b40f9742e7b281.1f9c921b05aafc28bf91547d5ec08a09\n          WHERE app_name = 'SLS_RNK'\n            AND param_type = 'ORG_LVL';\n\n      \n      \n      \n      \n      CURSOR c_rnk_ctgry IS\n         SELECT rnk_ctgry,\n                CASE rnk_ctgry\n                   WHEN 1 THEN 'cust_natl_mngd_flg = ''L'' AND trtry_type = ''ST'''\n                   WHEN 2 THEN 'cust_natl_mngd_flg = ''L'' AND trtry_type = ''ST'' AND pyr_seg_cd = ''IND'''\n                   WHEN 3 THEN 'cust_natl_mngd_flg = ''L'' AND trtry_type = ''ST'' AND pyr_seg_cd IN (''IND'', ''REG'', ''HOS'', ''OTH'')'\n                   WHEN 4 THEN 'cust_natl_mngd_flg = ''N'' AND trtry_type = ''NA'''\n                   WHEN 5 THEN 'cust_natl_mngd_flg = ''N'' AND pyr_seg_cd = ''HOS'' AND trtry_type = ''NA'''\n                   WHEN 6 THEN 'cust_natl_mngd_flg = ''N'' AND pyr_seg_cd = ''REG'' AND trtry_type = ''NA'''\n                END\n                   rnk_predicate,\n                CASE rnk_ctgry\n                   WHEN 1 THEN 'cust_natl_mngd_flg = ''L'' AND trtry_type = ''ST'' AND pyr_seg_cd IN (''IND'', ''REG'', ''HOS'', ''OTH'')'\n                   WHEN 2 THEN 'cust_natl_mngd_flg = ''L'' AND trtry_type = ''ST'' AND pyr_seg_cd IN (''IND'', ''REG'', ''HOS'', ''OTH'')'\n                   WHEN 3 THEN 'cust_natl_mngd_flg = ''L'' AND trtry_type = ''ST'' AND pyr_seg_cd IN (''IND'', ''REG'', ''HOS'', ''OTH'')'\n                   WHEN 4 THEN 'cust_natl_mngd_flg = ''N'' AND trtry_type = ''NA'''\n                   WHEN 5 THEN 'cust_natl_mngd_flg = ''N'' AND trtry_type = ''NA'''\n                   WHEN 6 THEN 'cust_natl_mngd_flg = ''N'' AND trtry_type = ''NA'''\n                END\n                   pop_predicate\n           FROM 57eef8c3d4a13d22f0b40f9742e7b281.17e1e5c363228950551b40eacd224600\n         UNION\n         SELECT 0, '1=1', '1=1' FROM DUAL;\n\n      \n      CURSOR c_cust_clsfctn IS\n         SELECT param_code cust_clsfctn, CASE param_code WHEN 'ALL' THEN '1=1' ELSE 'CUST_CLSFCTN = ''' || param_code || '''' END predicate\n           FROM 57eef8c3d4a13d22f0b40f9742e7b281.1f9c921b05aafc28bf91547d5ec08a09\n          WHERE app_name = 'SLS_RNK'\n            AND param_type = 'CUST_CLSFCTN_LOV';\n\n      l_sql           VARCHAR2(32000);\n      l_return_code   NUMBER := 0;\n      l_out_msg       VARCHAR2(256);\n   BEGIN\n      \n      l_return_code   := 51a807b365f066e5e34d0ad8a0117c9c.9b9dddad754084e9039b44beec15a88d.c9c724fb8ac640ac45c4a6fc55311bbe(l_out_msg, 'XDMADM', 'SLS_RNK_MTH_TMP');\n      DBMS_OUTPUT.put_line('Truncate table SLS_RNK_MTH_TMP return code: ' || l_return_code);\n\n      DBMS_OUTPUT.put_line('Begin inserting SLS_RNK_MTH_TMP');\n\n      FOR r_org_lvl IN c_org_lvl LOOP\n         FOR r_rnk_ctgry IN c_rnk_ctgry LOOP\n            FOR r_cust_clsfctn IN c_cust_clsfctn LOOP\n               l_sql   :=\n                  'INSERT  INTO 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2(fisc_yr_mth, org_lvl, org_val, rnk_ctgry, rnk_lvl, cust_clsfctn,\n                                   rnk_by, grp_cd_or_brnch_cd, ec_pct, ir_pct, ir_pct_ytd, grs_sls_extnd,\n                                   grs_sls_extnd_ly, grs_sls_extnd_var, grs_sls_extnd_ytd, grs_sls_extnd_ytd_ly, grs_sls_extnd_ytd_var, unfrm_qty_ship,\n                                   unfrm_qty_ship_ly, unfrm_qty_ship_var, unfrm_qty_ship_ytd, unfrm_qty_ship_ytd_ly, unfrm_qty_ship_ytd_var, grs_tgp,\n                                   grs_tgp_ly, grs_tgp_var, grs_tgp_ytd, grs_tgp_ytd_ly, grs_tgp_ytd_var, net_acct,\n                                   net_acct_ly, net_acct_var, net_acct_per_tm, net_acct_per_tm_ly, net_acct_per_tm_var, lines_per_drop,\n                                   lines_per_drop_ly, lines_per_drop_var, eb_pct, eb_pct_ly, eb_pct_var)\n         SELECT *\n           FROM (WITH pop AS (SELECT DISTINCT fbedbc120a0a5f64565a8fd10ef09617.940d2cf399f647883b423bdc838abc48, fbedbc120a0a5f64565a8fd10ef09617.ef475f1eb4af657bf72d87e81656e990feb16ec175a739c84b79e5d396593a57\n                                FROM 57eef8c3d4a13d22f0b40f9742e7b281.f2a0e23cc9c6bc0a97b68fe4091ebe54 tmp, 57eef8c3d4a13d22f0b40f9742e7b281.c34b3b41e7bd0c01dfd7c75a49970163 org\n                               WHERE '\n                  || 2e287f91c1a72c8a2cd237d9c036d931.374d02f3911361f30c9f6dca39455d4c\n                  || '\n                                 AND '\n                  || e1526bd55893e365bac40408d41be6c7.c302e14c9cc74d803647ad5d65883aa5\n                  || '\n                                 AND fbedbc120a0a5f64565a8fd10ef09617.959d7ed0152ba33b5452be0366845ae2 = '''\n                  || 2e287f91c1a72c8a2cd237d9c036d931.959d7ed0152ba33b5452be0366845ae2\n                  || '''\n                                 AND fbedbc120a0a5f64565a8fd10ef09617.051677fa81b6acaecd067857b3e57ecd = '''\n                  || g_fisc_yr_mth\n                  || '''),\n                     rnk AS\n                        (  SELECT fbedbc120a0a5f64565a8fd10ef09617.940d2cf399f647883b423bdc838abc48,\n                               CASE\n                                  WHEN SUM(57eef8c3d4a13d22f0b40f9742e7b281.f2a0e23cc9c6bc0a97b68fe4091ebe54.781bd4db21a2cb52defbc57c6e6eb0a053a0c0fe76045acdb204ca36f43c8ecf + 57eef8c3d4a13d22f0b40f9742e7b281.f2a0e23cc9c6bc0a97b68fe4091ebe54.a3f81d344cc4a0aef3a614e5af45d37653a0c0fe76045acdb204ca36f43c8ecf + 57eef8c3d4a13d22f0b40f9742e7b281.f2a0e23cc9c6bc0a97b68fe4091ebe54.ed4079c11dff76da027267ac8f0aa7c853a0c0fe76045acdb204ca36f43c8ecf) > 0 THEN\n                                    (SUM(57eef8c3d4a13d22f0b40f9742e7b281.f2a0e23cc9c6bc0a97b68fe4091ebe54.30b8eb8adbe8b46b8847e3302ec12ef153a0c0fe76045acdb204ca36f43c8ecf) / SUM(57eef8c3d4a13d22f0b40f9742e7b281.f2a0e23cc9c6bc0a97b68fe4091ebe54.781bd4db21a2cb52defbc57c6e6eb0a053a0c0fe76045acdb204ca36f43c8ecf + 57eef8c3d4a13d22f0b40f9742e7b281.f2a0e23cc9c6bc0a97b68fe4091ebe54.a3f81d344cc4a0aef3a614e5af45d37653a0c0fe76045acdb204ca36f43c8ecf + 57eef8c3d4a13d22f0b40f9742e7b281.f2a0e23cc9c6bc0a97b68fe4091ebe54.ed4079c11dff76da027267ac8f0aa7c853a0c0fe76045acdb204ca36f43c8ecf)) * 100\n                                  ELSE 0\n                               END\n                                  ec_pct,\n                               CASE\n                                  WHEN SUM(57eef8c3d4a13d22f0b40f9742e7b281.f2a0e23cc9c6bc0a97b68fe4091ebe54.9e7e4013fd15c78725b0ef91cd1cd802) > 0 THEN (SUM(57eef8c3d4a13d22f0b40f9742e7b281.f2a0e23cc9c6bc0a97b68fe4091ebe54.89bc0e5692a1cb46c6358e1110e2da3c53a0c0fe76045acdb204ca36f43c8ecf) / SUM(57eef8c3d4a13d22f0b40f9742e7b281.f2a0e23cc9c6bc0a97b68fe4091ebe54.9e7e4013fd15c78725b0ef91cd1cd802)) * 100\n                                  ELSE 0\n                               END\n                                  ir_pct,\n                               CASE\n                                  WHEN SUM(57eef8c3d4a13d22f0b40f9742e7b281.f2a0e23cc9c6bc0a97b68fe4091ebe54.5be717b469b9cc32bb6cea74112db38a0ca5fb119e004e3dd9cc2be01757c595) > 0 THEN\n                                     (SUM(57eef8c3d4a13d22f0b40f9742e7b281.f2a0e23cc9c6bc0a97b68fe4091ebe54.89bc0e5692a1cb46c6358e1110e2da3c3f532994348196abf94de5c58947e5f4) / SUM(57eef8c3d4a13d22f0b40f9742e7b281.f2a0e23cc9c6bc0a97b68fe4091ebe54.5be717b469b9cc32bb6cea74112db38a0ca5fb119e004e3dd9cc2be01757c595)) * 100\n                                  ELSE\n                                     0\n                               END\n                                  ir_pct_ytd,\n                               SUM(57eef8c3d4a13d22f0b40f9742e7b281.f2a0e23cc9c6bc0a97b68fe4091ebe54.9e7e4013fd15c78725b0ef91cd1cd802) grs_sls_extnd,\n                               SUM(57eef8c3d4a13d22f0b40f9742e7b281.f2a0e23cc9c6bc0a97b68fe4091ebe54.38b856c3c52540c729a21ac9b1e8d4b453a0c0fe76045acdb204ca36f43c8ecf) grs_sls_extnd_ly,\n                               SUM(57eef8c3d4a13d22f0b40f9742e7b281.f2a0e23cc9c6bc0a97b68fe4091ebe54.9e7e4013fd15c78725b0ef91cd1cd802) - SUM(57eef8c3d4a13d22f0b40f9742e7b281.f2a0e23cc9c6bc0a97b68fe4091ebe54.38b856c3c52540c729a21ac9b1e8d4b453a0c0fe76045acdb204ca36f43c8ecf) grs_sls_extnd_var,\n                               SUM(57eef8c3d4a13d22f0b40f9742e7b281.f2a0e23cc9c6bc0a97b68fe4091ebe54.5be717b469b9cc32bb6cea74112db38a0ca5fb119e004e3dd9cc2be01757c595) grs_sls_extnd_ytd,\n                               SUM(57eef8c3d4a13d22f0b40f9742e7b281.f2a0e23cc9c6bc0a97b68fe4091ebe54.5be717b469b9cc32bb6cea74112db38ab1ad21072600892b79b2f03b961f8103) grs_sls_extnd_ytd_ly,\n                               SUM(57eef8c3d4a13d22f0b40f9742e7b281.f2a0e23cc9c6bc0a97b68fe4091ebe54.5be717b469b9cc32bb6cea74112db38a0ca5fb119e004e3dd9cc2be01757c595) - SUM(57eef8c3d4a13d22f0b40f9742e7b281.f2a0e23cc9c6bc0a97b68fe4091ebe54.5be717b469b9cc32bb6cea74112db38ab1ad21072600892b79b2f03b961f8103) grs_sls_extnd_ytd_var,\n                               SUM(57eef8c3d4a13d22f0b40f9742e7b281.f2a0e23cc9c6bc0a97b68fe4091ebe54.35b5bbe882cdc6cc77aeda236583bcf0) unfrm_qty_ship,\n                               SUM(57eef8c3d4a13d22f0b40f9742e7b281.f2a0e23cc9c6bc0a97b68fe4091ebe54.c010eb47e28b6c7bf48eb014da195523d4562c639a288065002fd4e56c86fcd7) unfrm_qty_ship_ly,\n                               SUM(57eef8c3d4a13d22f0b40f9742e7b281.f2a0e23cc9c6bc0a97b68fe4091ebe54.35b5bbe882cdc6cc77aeda236583bcf0) - SUM(57eef8c3d4a13d22f0b40f9742e7b281.f2a0e23cc9c6bc0a97b68fe4091ebe54.c010eb47e28b6c7bf48eb014da195523d4562c639a288065002fd4e56c86fcd7) unfrm_qty_ship_var,\n                               SUM(57eef8c3d4a13d22f0b40f9742e7b281.f2a0e23cc9c6bc0a97b68fe4091ebe54.e6eacb08cfb1528f520daba6c77bfbbb97b501caccd90ae146341c7c4f5ffd17) unfrm_qty_ship_ytd,\n                               SUM(57eef8c3d4a13d22f0b40f9742e7b281.f2a0e23cc9c6bc0a97b68fe4091ebe54.e6eacb08cfb1528f520daba6c77bfbbb9cfb40ba667e147bf77567a1f22be3c0) unfrm_qty_ship_ytd_ly,\n                               SUM(57eef8c3d4a13d22f0b40f9742e7b281.f2a0e23cc9c6bc0a97b68fe4091ebe54.e6eacb08cfb1528f520daba6c77bfbbb97b501caccd90ae146341c7c4f5ffd17) - SUM(57eef8c3d4a13d22f0b40f9742e7b281.f2a0e23cc9c6bc0a97b68fe4091ebe54.e6eacb08cfb1528f520daba6c77bfbbb9cfb40ba667e147bf77567a1f22be3c0) unfrm_qty_ship_ytd_var,\n                               SUM(57eef8c3d4a13d22f0b40f9742e7b281.f2a0e23cc9c6bc0a97b68fe4091ebe54.de359d0148528b5cfe3c4b36b71fd9cd) grs_tgp,\n                               SUM(57eef8c3d4a13d22f0b40f9742e7b281.f2a0e23cc9c6bc0a97b68fe4091ebe54.7b01e56fd85d33f336818231098d9d90) grs_tgp_ly,\n                               SUM(57eef8c3d4a13d22f0b40f9742e7b281.f2a0e23cc9c6bc0a97b68fe4091ebe54.de359d0148528b5cfe3c4b36b71fd9cd) - SUM(57eef8c3d4a13d22f0b40f9742e7b281.f2a0e23cc9c6bc0a97b68fe4091ebe54.7b01e56fd85d33f336818231098d9d90) grs_tgp_var,\n                               SUM(57eef8c3d4a13d22f0b40f9742e7b281.f2a0e23cc9c6bc0a97b68fe4091ebe54.ab2fa5045bbd7f0fd3439b80811b1538) grs_tgp_ytd,\n                               SUM(57eef8c3d4a13d22f0b40f9742e7b281.f2a0e23cc9c6bc0a97b68fe4091ebe54.0e64b83ed41957f76af6e9b8a5c2e5a6) grs_tgp_ytd_ly,\n                               SUM(57eef8c3d4a13d22f0b40f9742e7b281.f2a0e23cc9c6bc0a97b68fe4091ebe54.ab2fa5045bbd7f0fd3439b80811b1538) - SUM(57eef8c3d4a13d22f0b40f9742e7b281.f2a0e23cc9c6bc0a97b68fe4091ebe54.0e64b83ed41957f76af6e9b8a5c2e5a6) grs_tgp_ytd_var,\n                               SUM(57eef8c3d4a13d22f0b40f9742e7b281.f2a0e23cc9c6bc0a97b68fe4091ebe54.9c9a1e7c735e3747c82e2f22363a41b3) net_acct,\n                               SUM(57eef8c3d4a13d22f0b40f9742e7b281.f2a0e23cc9c6bc0a97b68fe4091ebe54.d37113b057aae8aaddfdad2c2ee8a8fb) net_acct_ly,\n                               SUM(57eef8c3d4a13d22f0b40f9742e7b281.f2a0e23cc9c6bc0a97b68fe4091ebe54.9c9a1e7c735e3747c82e2f22363a41b3) - SUM(57eef8c3d4a13d22f0b40f9742e7b281.f2a0e23cc9c6bc0a97b68fe4091ebe54.d37113b057aae8aaddfdad2c2ee8a8fb) net_acct_var,\n                               CASE\n                                  WHEN fbedbc120a0a5f64565a8fd10ef09617.8e03069323442dd80d6c5a2e777fe24d > 0 THEN\n                                     SUM(57eef8c3d4a13d22f0b40f9742e7b281.f2a0e23cc9c6bc0a97b68fe4091ebe54.9c9a1e7c735e3747c82e2f22363a41b3) / fbedbc120a0a5f64565a8fd10ef09617.8e03069323442dd80d6c5a2e777fe24d\n                                  ELSE\n                                     0\n                               END\n                                  net_acct_per_tm,\n                               CASE\n                                  WHEN fbedbc120a0a5f64565a8fd10ef09617.fa15d89f304e26b55cfa1374391a204e > 0 THEN\n                                     SUM(57eef8c3d4a13d22f0b40f9742e7b281.f2a0e23cc9c6bc0a97b68fe4091ebe54.d37113b057aae8aaddfdad2c2ee8a8fb) / fbedbc120a0a5f64565a8fd10ef09617.fa15d89f304e26b55cfa1374391a204e\n                                  ELSE\n                                     0\n                               END\n                                  net_acct_per_tm_ly,\n                              CASE\n                                  WHEN fbedbc120a0a5f64565a8fd10ef09617.8e03069323442dd80d6c5a2e777fe24d > 0 THEN\n                                     SUM(57eef8c3d4a13d22f0b40f9742e7b281.f2a0e23cc9c6bc0a97b68fe4091ebe54.9c9a1e7c735e3747c82e2f22363a41b3) / fbedbc120a0a5f64565a8fd10ef09617.8e03069323442dd80d6c5a2e777fe24d\n                                  ELSE\n                                     0\n                               END\n                                  -\n                               CASE\n                                  WHEN fbedbc120a0a5f64565a8fd10ef09617.fa15d89f304e26b55cfa1374391a204e > 0 THEN\n                                     SUM(57eef8c3d4a13d22f0b40f9742e7b281.f2a0e23cc9c6bc0a97b68fe4091ebe54.d37113b057aae8aaddfdad2c2ee8a8fb) / fbedbc120a0a5f64565a8fd10ef09617.fa15d89f304e26b55cfa1374391a204e\n                                  ELSE\n                                     0\n                               END  net_acct_per_tm_var,\n                               CASE\n                                  WHEN SUM(57eef8c3d4a13d22f0b40f9742e7b281.f2a0e23cc9c6bc0a97b68fe4091ebe54.163292e356591886d2dbc90bb358824a) > 0 THEN\n                                     SUM(57eef8c3d4a13d22f0b40f9742e7b281.f2a0e23cc9c6bc0a97b68fe4091ebe54.e3c9674cf72ad209a86e79ad7170a77f + 57eef8c3d4a13d22f0b40f9742e7b281.f2a0e23cc9c6bc0a97b68fe4091ebe54.cc13a0b97d56d9aff1b0c78c855c726c53a0c0fe76045acdb204ca36f43c8ecf + 57eef8c3d4a13d22f0b40f9742e7b281.f2a0e23cc9c6bc0a97b68fe4091ebe54.26c3a68b174857edf61a2b0937fd2db7) / SUM(57eef8c3d4a13d22f0b40f9742e7b281.f2a0e23cc9c6bc0a97b68fe4091ebe54.163292e356591886d2dbc90bb358824a)\n                                  ELSE\n                                     0\n                               END\n                                  lines_per_drop,\n                               CASE\n                                  WHEN SUM(57eef8c3d4a13d22f0b40f9742e7b281.f2a0e23cc9c6bc0a97b68fe4091ebe54.eb496422b413b276ec7601e36b3cddd4) > 0 THEN\n                                     SUM(57eef8c3d4a13d22f0b40f9742e7b281.f2a0e23cc9c6bc0a97b68fe4091ebe54.38b68df6eff1ccc35e63028a96c972a6 + 57eef8c3d4a13d22f0b40f9742e7b281.f2a0e23cc9c6bc0a97b68fe4091ebe54.cc13a0b97d56d9aff1b0c78c855c726c91b777230e03c0dedfb113c2c8af948c + 57eef8c3d4a13d22f0b40f9742e7b281.f2a0e23cc9c6bc0a97b68fe4091ebe54.020f3d7b0db35337834063801a84df46) / SUM(57eef8c3d4a13d22f0b40f9742e7b281.f2a0e23cc9c6bc0a97b68fe4091ebe54.eb496422b413b276ec7601e36b3cddd4)\n                                  ELSE\n                                     0\n                               END\n                                  lines_per_drop_ly,\n                               CASE\n                                  WHEN SUM(57eef8c3d4a13d22f0b40f9742e7b281.f2a0e23cc9c6bc0a97b68fe4091ebe54.163292e356591886d2dbc90bb358824a) > 0 THEN\n                                     SUM(57eef8c3d4a13d22f0b40f9742e7b281.f2a0e23cc9c6bc0a97b68fe4091ebe54.e3c9674cf72ad209a86e79ad7170a77f + 57eef8c3d4a13d22f0b40f9742e7b281.f2a0e23cc9c6bc0a97b68fe4091ebe54.cc13a0b97d56d9aff1b0c78c855c726c53a0c0fe76045acdb204ca36f43c8ecf + 57eef8c3d4a13d22f0b40f9742e7b281.f2a0e23cc9c6bc0a97b68fe4091ebe54.26c3a68b174857edf61a2b0937fd2db7) / SUM(57eef8c3d4a13d22f0b40f9742e7b281.f2a0e23cc9c6bc0a97b68fe4091ebe54.163292e356591886d2dbc90bb358824a)\n                                  ELSE\n                                     0\n                               END\n                               - CASE\n                                    WHEN SUM(57eef8c3d4a13d22f0b40f9742e7b281.f2a0e23cc9c6bc0a97b68fe4091ebe54.eb496422b413b276ec7601e36b3cddd4) > 0 THEN\n                                       SUM(57eef8c3d4a13d22f0b40f9742e7b281.f2a0e23cc9c6bc0a97b68fe4091ebe54.38b68df6eff1ccc35e63028a96c972a6 + 57eef8c3d4a13d22f0b40f9742e7b281.f2a0e23cc9c6bc0a97b68fe4091ebe54.cc13a0b97d56d9aff1b0c78c855c726c91b777230e03c0dedfb113c2c8af948c + 57eef8c3d4a13d22f0b40f9742e7b281.f2a0e23cc9c6bc0a97b68fe4091ebe54.020f3d7b0db35337834063801a84df46) / SUM(57eef8c3d4a13d22f0b40f9742e7b281.f2a0e23cc9c6bc0a97b68fe4091ebe54.eb496422b413b276ec7601e36b3cddd4)\n                                    ELSE\n                                       0\n                                 END\n                                  lines_per_drop_var,\n                               CASE\n                                  WHEN SUM(57eef8c3d4a13d22f0b40f9742e7b281.f2a0e23cc9c6bc0a97b68fe4091ebe54.9e7e4013fd15c78725b0ef91cd1cd802) > 0 THEN (SUM(57eef8c3d4a13d22f0b40f9742e7b281.f2a0e23cc9c6bc0a97b68fe4091ebe54.05bf51c98f7ab7d3a8b23f414be7cea253a0c0fe76045acdb204ca36f43c8ecf) / SUM(57eef8c3d4a13d22f0b40f9742e7b281.f2a0e23cc9c6bc0a97b68fe4091ebe54.9e7e4013fd15c78725b0ef91cd1cd802)) * 100\n                                  ELSE 0\n                               END\n                                  eb_pct,\n                               CASE\n                                  WHEN SUM(57eef8c3d4a13d22f0b40f9742e7b281.f2a0e23cc9c6bc0a97b68fe4091ebe54.38b856c3c52540c729a21ac9b1e8d4b453a0c0fe76045acdb204ca36f43c8ecf) > 0 THEN (SUM(57eef8c3d4a13d22f0b40f9742e7b281.f2a0e23cc9c6bc0a97b68fe4091ebe54.05bf51c98f7ab7d3a8b23f414be7cea291b777230e03c0dedfb113c2c8af948c) / SUM(57eef8c3d4a13d22f0b40f9742e7b281.f2a0e23cc9c6bc0a97b68fe4091ebe54.38b856c3c52540c729a21ac9b1e8d4b453a0c0fe76045acdb204ca36f43c8ecf)) * 100\n                                  ELSE 0\n                               END\n                                  eb_pct_ly,\n                               CASE\n                                  WHEN SUM(57eef8c3d4a13d22f0b40f9742e7b281.f2a0e23cc9c6bc0a97b68fe4091ebe54.9e7e4013fd15c78725b0ef91cd1cd802) > 0 THEN (SUM(57eef8c3d4a13d22f0b40f9742e7b281.f2a0e23cc9c6bc0a97b68fe4091ebe54.05bf51c98f7ab7d3a8b23f414be7cea253a0c0fe76045acdb204ca36f43c8ecf) / SUM(57eef8c3d4a13d22f0b40f9742e7b281.f2a0e23cc9c6bc0a97b68fe4091ebe54.9e7e4013fd15c78725b0ef91cd1cd802)) * 100\n                                  ELSE 0\n                               END\n                               - CASE\n                                    WHEN SUM(57eef8c3d4a13d22f0b40f9742e7b281.f2a0e23cc9c6bc0a97b68fe4091ebe54.38b856c3c52540c729a21ac9b1e8d4b453a0c0fe76045acdb204ca36f43c8ecf) > 0 THEN\n                                       (SUM(57eef8c3d4a13d22f0b40f9742e7b281.f2a0e23cc9c6bc0a97b68fe4091ebe54.05bf51c98f7ab7d3a8b23f414be7cea291b777230e03c0dedfb113c2c8af948c) / SUM(57eef8c3d4a13d22f0b40f9742e7b281.f2a0e23cc9c6bc0a97b68fe4091ebe54.38b856c3c52540c729a21ac9b1e8d4b453a0c0fe76045acdb204ca36f43c8ecf)) * 100\n                                    ELSE\n                                       0\n                                 END\n                                  eb_pct_var\n                             FROM (SELECT *\n                                     FROM 57eef8c3d4a13d22f0b40f9742e7b281.f2a0e23cc9c6bc0a97b68fe4091ebe54\n                                    WHERE '\n                  || e1526bd55893e365bac40408d41be6c7.bbb3bad778264a50a1a6c246b3daf397\n                  || '\n                                      AND '\n                  || 32a5aa777d265c79e81e0e943db6ed49.374d02f3911361f30c9f6dca39455d4c\n                  || ') tmp,\n                            (SELECT 57eef8c3d4a13d22f0b40f9742e7b281.c34b3b41e7bd0c01dfd7c75a49970163.*, CASE WHEN '\n                  || e1526bd55893e365bac40408d41be6c7.31953ff0f9caf854f33c049172c5937b\n                  || ' <= 3 THEN tm_st_cnt ELSE tm_na_cnt END tm_cnt,\n                                         CASE WHEN '\n                  || e1526bd55893e365bac40408d41be6c7.31953ff0f9caf854f33c049172c5937b\n                  || ' <= 3 THEN tm_st_cnt_ly ELSE tm_na_cnt_ly END tm_cnt_ly\n                               FROM 57eef8c3d4a13d22f0b40f9742e7b281.c34b3b41e7bd0c01dfd7c75a49970163 o) org\n                            WHERE '\n                  || 2e287f91c1a72c8a2cd237d9c036d931.374d02f3911361f30c9f6dca39455d4c\n                  || '\n                              AND fbedbc120a0a5f64565a8fd10ef09617.959d7ed0152ba33b5452be0366845ae2 = '''\n                  || 2e287f91c1a72c8a2cd237d9c036d931.959d7ed0152ba33b5452be0366845ae2\n                  || '''\n                              AND fbedbc120a0a5f64565a8fd10ef09617.051677fa81b6acaecd067857b3e57ecd = '''\n                  || g_fisc_yr_mth\n                  || '''\n                         GROUP BY fbedbc120a0a5f64565a8fd10ef09617.940d2cf399f647883b423bdc838abc48, fbedbc120a0a5f64565a8fd10ef09617.8e03069323442dd80d6c5a2e777fe24d, fbedbc120a0a5f64565a8fd10ef09617.fa15d89f304e26b55cfa1374391a204e)\n                 SELECT '''\n                  || g_fisc_yr_mth\n                  || ''' fisc_yr_mth,\n                        '''\n                  || 2e287f91c1a72c8a2cd237d9c036d931.959d7ed0152ba33b5452be0366845ae2\n                  || ''' org_lvl,\n                        b31a7d43ee7e1a5b4d264027e2683bd0.940d2cf399f647883b423bdc838abc48, '\n                  || e1526bd55893e365bac40408d41be6c7.31953ff0f9caf854f33c049172c5937b\n                  || ' rnk_ctgry,\n                        57eef8c3d4a13d22f0b40f9742e7b281.1f9c921b05aafc28bf91547d5ec08a09.4037c51e8a924adecf20c1b5c685241e rnk_lvl,\n                        '''\n                  || 32a5aa777d265c79e81e0e943db6ed49.5d05d543e266512d1fd2ec6a83eece24\n                  || ''' cust_clsfctn,\n                        ''VAR'' rnk_by,\n                        b31a7d43ee7e1a5b4d264027e2683bd0.ef475f1eb4af657bf72d87e81656e990feb16ec175a739c84b79e5d396593a57,\n                        8683f9784911be4ee0f7b8b1797ca15b.b67af150b2e84394fb0262f2776bf2ae,\n                        8683f9784911be4ee0f7b8b1797ca15b.a97268ede7c0d7e2eebc4d0d488e361f,\n                        8683f9784911be4ee0f7b8b1797ca15b.60f6e21732722471e0c3aa442c0b51dc,\n                        8683f9784911be4ee0f7b8b1797ca15b.9e7e4013fd15c78725b0ef91cd1cd802,\n                        8683f9784911be4ee0f7b8b1797ca15b.38b856c3c52540c729a21ac9b1e8d4b453a0c0fe76045acdb204ca36f43c8ecf,\n                        8683f9784911be4ee0f7b8b1797ca15b.97d0b7dfcea2ede9da55f1198a57885e3829969834280a39721b32c836afdff1,\n                        8683f9784911be4ee0f7b8b1797ca15b.5be717b469b9cc32bb6cea74112db38a0ca5fb119e004e3dd9cc2be01757c595,\n                        8683f9784911be4ee0f7b8b1797ca15b.5be717b469b9cc32bb6cea74112db38ab1ad21072600892b79b2f03b961f8103,\n                        8683f9784911be4ee0f7b8b1797ca15b.5be717b469b9cc32bb6cea74112db38ac97717101e5ade058bac8c8d50eb5364,\n                        8683f9784911be4ee0f7b8b1797ca15b.35b5bbe882cdc6cc77aeda236583bcf0,\n                        8683f9784911be4ee0f7b8b1797ca15b.c010eb47e28b6c7bf48eb014da195523d4562c639a288065002fd4e56c86fcd7,\n                        8683f9784911be4ee0f7b8b1797ca15b.3c3217b237b0cc8aea934e93e6932ee6760ee94864352b2fd143cb660266e5ba,\n                        8683f9784911be4ee0f7b8b1797ca15b.e6eacb08cfb1528f520daba6c77bfbbb97b501caccd90ae146341c7c4f5ffd17,\n                        8683f9784911be4ee0f7b8b1797ca15b.e6eacb08cfb1528f520daba6c77bfbbb9cfb40ba667e147bf77567a1f22be3c0,\n                        8683f9784911be4ee0f7b8b1797ca15b.e6eacb08cfb1528f520daba6c77bfbbb5082620ccee91c174294c9aaeb197b93,\n                        8683f9784911be4ee0f7b8b1797ca15b.de359d0148528b5cfe3c4b36b71fd9cd,\n                        8683f9784911be4ee0f7b8b1797ca15b.7b01e56fd85d33f336818231098d9d90,\n                        8683f9784911be4ee0f7b8b1797ca15b.fd189c6b966ffe8b9685896d114aa5af,\n                        8683f9784911be4ee0f7b8b1797ca15b.ab2fa5045bbd7f0fd3439b80811b1538,\n                        8683f9784911be4ee0f7b8b1797ca15b.0e64b83ed41957f76af6e9b8a5c2e5a6,\n                        8683f9784911be4ee0f7b8b1797ca15b.39e09b7556dd8f4b602616386ec7e4bd,\n                        8683f9784911be4ee0f7b8b1797ca15b.9c9a1e7c735e3747c82e2f22363a41b3,\n                        8683f9784911be4ee0f7b8b1797ca15b.d37113b057aae8aaddfdad2c2ee8a8fb,\n                        8683f9784911be4ee0f7b8b1797ca15b.6a6aeba4661d228696adbafac058a9c9,\n                        8683f9784911be4ee0f7b8b1797ca15b.e3771fe5b897240b5e25f272b9f0f263,\n                        8683f9784911be4ee0f7b8b1797ca15b.f0c88babacd81e10e30eec256b721797665303dbbc240a5eaa44af13b9d8147d,\n                        8683f9784911be4ee0f7b8b1797ca15b.f0c88babacd81e10e30eec256b72179754cfce5485b7fc71f014d21387b577f0,\n                        8683f9784911be4ee0f7b8b1797ca15b.36a969534b50ebd7e707a938655c31de,\n                        8683f9784911be4ee0f7b8b1797ca15b.78e6d88e1c6251dad6cc7a53317762a9d4562c639a288065002fd4e56c86fcd7,\n                        8683f9784911be4ee0f7b8b1797ca15b.fe00e43d17fcccf45bd8fd1f60976e3b760ee94864352b2fd143cb660266e5ba,\n                        8683f9784911be4ee0f7b8b1797ca15b.21c474c55b03f885347d88f4911a9704,\n                        8683f9784911be4ee0f7b8b1797ca15b.d6fa913c3fbceed53e266c0933b8890f,\n                        8683f9784911be4ee0f7b8b1797ca15b.ce3016f9cfb6897930b0022d4a9ebaba\n                   FROM pop, rnk, 57eef8c3d4a13d22f0b40f9742e7b281.1f9c921b05aafc28bf91547d5ec08a09 pv\n                  WHERE b31a7d43ee7e1a5b4d264027e2683bd0.940d2cf399f647883b423bdc838abc48 = 8683f9784911be4ee0f7b8b1797ca15b.940d2cf399f647883b423bdc838abc48(+)\n                    AND 57eef8c3d4a13d22f0b40f9742e7b281.1f9c921b05aafc28bf91547d5ec08a09.43a9f6c6a177bec360bf6b18c1940207 = ''SLS_RNK''\n                    AND 57eef8c3d4a13d22f0b40f9742e7b281.1f9c921b05aafc28bf91547d5ec08a09.4b71eb655fa28c0be4a6bcbfd3e189a5 = ''RNK_LVL_LOV'')';\n\n               EXECUTE IMMEDIATE l_sql;\n\n               COMMIT;\n\n               l_sql   :=\n                  'INSERT  INTO 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2(fisc_yr_mth, org_lvl, org_val, rnk_ctgry, rnk_lvl, cust_clsfctn,\n                                   rnk_by, grp_cd_or_brnch_cd, ec_pct, ir_pct, ir_pct_ytd, grs_sls_extnd,\n                                   grs_sls_extnd_ly, grs_sls_extnd_var, grs_sls_extnd_ytd, grs_sls_extnd_ytd_ly, grs_sls_extnd_ytd_var, unfrm_qty_ship,\n                                   unfrm_qty_ship_ly, unfrm_qty_ship_var, unfrm_qty_ship_ytd, unfrm_qty_ship_ytd_ly, unfrm_qty_ship_ytd_var, grs_tgp,\n                                   grs_tgp_ly, grs_tgp_var, grs_tgp_ytd, grs_tgp_ytd_ly, grs_tgp_ytd_var, net_acct,\n                                   net_acct_ly, net_acct_var, net_acct_per_tm, net_acct_per_tm_ly, net_acct_per_tm_var, lines_per_drop,\n                                   lines_per_drop_ly, lines_per_drop_var, eb_pct, eb_pct_ly, eb_pct_var)\n         SELECT *\n           FROM (WITH pop AS (SELECT DISTINCT fbedbc120a0a5f64565a8fd10ef09617.940d2cf399f647883b423bdc838abc48, fbedbc120a0a5f64565a8fd10ef09617.ef475f1eb4af657bf72d87e81656e990feb16ec175a739c84b79e5d396593a57\n                                FROM 57eef8c3d4a13d22f0b40f9742e7b281.f2a0e23cc9c6bc0a97b68fe4091ebe54 tmp, 57eef8c3d4a13d22f0b40f9742e7b281.c34b3b41e7bd0c01dfd7c75a49970163 org\n                               WHERE '\n                  || 2e287f91c1a72c8a2cd237d9c036d931.374d02f3911361f30c9f6dca39455d4c\n                  || '\n                                 AND '\n                  || e1526bd55893e365bac40408d41be6c7.c302e14c9cc74d803647ad5d65883aa5\n                  || '\n                                 AND fbedbc120a0a5f64565a8fd10ef09617.959d7ed0152ba33b5452be0366845ae2 = '''\n                  || 2e287f91c1a72c8a2cd237d9c036d931.959d7ed0152ba33b5452be0366845ae2\n                  || '''\n                                 AND fbedbc120a0a5f64565a8fd10ef09617.051677fa81b6acaecd067857b3e57ecd = '''\n                  || g_fisc_yr_mth\n                  || '''),\n                     rnk AS\n                        (  SELECT fbedbc120a0a5f64565a8fd10ef09617.940d2cf399f647883b423bdc838abc48,\n                                  CASE\n                                     WHEN SUM(57eef8c3d4a13d22f0b40f9742e7b281.f2a0e23cc9c6bc0a97b68fe4091ebe54.781bd4db21a2cb52defbc57c6e6eb0a053a0c0fe76045acdb204ca36f43c8ecf + 57eef8c3d4a13d22f0b40f9742e7b281.f2a0e23cc9c6bc0a97b68fe4091ebe54.a3f81d344cc4a0aef3a614e5af45d37653a0c0fe76045acdb204ca36f43c8ecf + 57eef8c3d4a13d22f0b40f9742e7b281.f2a0e23cc9c6bc0a97b68fe4091ebe54.ed4079c11dff76da027267ac8f0aa7c853a0c0fe76045acdb204ca36f43c8ecf) > 0 THEN\n                                        (SUM(57eef8c3d4a13d22f0b40f9742e7b281.f2a0e23cc9c6bc0a97b68fe4091ebe54.30b8eb8adbe8b46b8847e3302ec12ef153a0c0fe76045acdb204ca36f43c8ecf) / SUM(57eef8c3d4a13d22f0b40f9742e7b281.f2a0e23cc9c6bc0a97b68fe4091ebe54.781bd4db21a2cb52defbc57c6e6eb0a053a0c0fe76045acdb204ca36f43c8ecf + 57eef8c3d4a13d22f0b40f9742e7b281.f2a0e23cc9c6bc0a97b68fe4091ebe54.a3f81d344cc4a0aef3a614e5af45d37653a0c0fe76045acdb204ca36f43c8ecf + 57eef8c3d4a13d22f0b40f9742e7b281.f2a0e23cc9c6bc0a97b68fe4091ebe54.ed4079c11dff76da027267ac8f0aa7c853a0c0fe76045acdb204ca36f43c8ecf)) * 100\n                                     ELSE\n                                        0\n                                  END\n                                     ec_pct,\n                                  CASE\n                                     WHEN SUM(57eef8c3d4a13d22f0b40f9742e7b281.f2a0e23cc9c6bc0a97b68fe4091ebe54.9e7e4013fd15c78725b0ef91cd1cd802) > 0 THEN\n                                        (SUM(57eef8c3d4a13d22f0b40f9742e7b281.f2a0e23cc9c6bc0a97b68fe4091ebe54.89bc0e5692a1cb46c6358e1110e2da3c53a0c0fe76045acdb204ca36f43c8ecf) / SUM(57eef8c3d4a13d22f0b40f9742e7b281.f2a0e23cc9c6bc0a97b68fe4091ebe54.9e7e4013fd15c78725b0ef91cd1cd802)) * 100\n                                     ELSE\n                                        0\n                                  END\n                                     ir_pct,\n                                  CASE\n                                     WHEN SUM(57eef8c3d4a13d22f0b40f9742e7b281.f2a0e23cc9c6bc0a97b68fe4091ebe54.5be717b469b9cc32bb6cea74112db38a0ca5fb119e004e3dd9cc2be01757c595) > 0 THEN\n                                        (SUM(57eef8c3d4a13d22f0b40f9742e7b281.f2a0e23cc9c6bc0a97b68fe4091ebe54.89bc0e5692a1cb46c6358e1110e2da3c3f532994348196abf94de5c58947e5f4) / SUM(57eef8c3d4a13d22f0b40f9742e7b281.f2a0e23cc9c6bc0a97b68fe4091ebe54.5be717b469b9cc32bb6cea74112db38a0ca5fb119e004e3dd9cc2be01757c595)) * 100\n                                     ELSE\n                                        0\n                                  END\n                                     ir_pct_ytd,\n                                  SUM(57eef8c3d4a13d22f0b40f9742e7b281.f2a0e23cc9c6bc0a97b68fe4091ebe54.9e7e4013fd15c78725b0ef91cd1cd802) grs_sls_extnd,\n                                  SUM(57eef8c3d4a13d22f0b40f9742e7b281.f2a0e23cc9c6bc0a97b68fe4091ebe54.38b856c3c52540c729a21ac9b1e8d4b453a0c0fe76045acdb204ca36f43c8ecf) grs_sls_extnd_ly,\n                                  CASE\n                                     WHEN SUM(57eef8c3d4a13d22f0b40f9742e7b281.f2a0e23cc9c6bc0a97b68fe4091ebe54.38b856c3c52540c729a21ac9b1e8d4b453a0c0fe76045acdb204ca36f43c8ecf) > 0 THEN\n                                        ((SUM(57eef8c3d4a13d22f0b40f9742e7b281.f2a0e23cc9c6bc0a97b68fe4091ebe54.9e7e4013fd15c78725b0ef91cd1cd802) - SUM(57eef8c3d4a13d22f0b40f9742e7b281.f2a0e23cc9c6bc0a97b68fe4091ebe54.38b856c3c52540c729a21ac9b1e8d4b453a0c0fe76045acdb204ca36f43c8ecf)) / SUM(57eef8c3d4a13d22f0b40f9742e7b281.f2a0e23cc9c6bc0a97b68fe4091ebe54.38b856c3c52540c729a21ac9b1e8d4b453a0c0fe76045acdb204ca36f43c8ecf))\n                                        * 100\n                                     ELSE\n                                        0\n                                  END\n                                     grs_sls_extnd_var,\n                                  SUM(57eef8c3d4a13d22f0b40f9742e7b281.f2a0e23cc9c6bc0a97b68fe4091ebe54.5be717b469b9cc32bb6cea74112db38a0ca5fb119e004e3dd9cc2be01757c595) grs_sls_extnd_ytd,\n                                  SUM(57eef8c3d4a13d22f0b40f9742e7b281.f2a0e23cc9c6bc0a97b68fe4091ebe54.5be717b469b9cc32bb6cea74112db38ab1ad21072600892b79b2f03b961f8103) grs_sls_extnd_ytd_ly,\n                                  CASE\n                                     WHEN SUM(57eef8c3d4a13d22f0b40f9742e7b281.f2a0e23cc9c6bc0a97b68fe4091ebe54.5be717b469b9cc32bb6cea74112db38ab1ad21072600892b79b2f03b961f8103) > 0 THEN\n                                        ((SUM(57eef8c3d4a13d22f0b40f9742e7b281.f2a0e23cc9c6bc0a97b68fe4091ebe54.5be717b469b9cc32bb6cea74112db38a0ca5fb119e004e3dd9cc2be01757c595) - SUM(57eef8c3d4a13d22f0b40f9742e7b281.f2a0e23cc9c6bc0a97b68fe4091ebe54.5be717b469b9cc32bb6cea74112db38ab1ad21072600892b79b2f03b961f8103))\n                                         / SUM(57eef8c3d4a13d22f0b40f9742e7b281.f2a0e23cc9c6bc0a97b68fe4091ebe54.5be717b469b9cc32bb6cea74112db38ab1ad21072600892b79b2f03b961f8103))\n                                        * 100\n                                     ELSE\n                                        0\n                                  END\n                                     grs_sls_extnd_ytd_var,\n                                  SUM(57eef8c3d4a13d22f0b40f9742e7b281.f2a0e23cc9c6bc0a97b68fe4091ebe54.35b5bbe882cdc6cc77aeda236583bcf0) unfrm_qty_ship,\n                                  SUM(57eef8c3d4a13d22f0b40f9742e7b281.f2a0e23cc9c6bc0a97b68fe4091ebe54.c010eb47e28b6c7bf48eb014da195523d4562c639a288065002fd4e56c86fcd7) unfrm_qty_ship_ly,\n                                  CASE\n                                     WHEN SUM(57eef8c3d4a13d22f0b40f9742e7b281.f2a0e23cc9c6bc0a97b68fe4091ebe54.c010eb47e28b6c7bf48eb014da195523d4562c639a288065002fd4e56c86fcd7) > 0 THEN\n                                        ((SUM(57eef8c3d4a13d22f0b40f9742e7b281.f2a0e23cc9c6bc0a97b68fe4091ebe54.35b5bbe882cdc6cc77aeda236583bcf0) - SUM(57eef8c3d4a13d22f0b40f9742e7b281.f2a0e23cc9c6bc0a97b68fe4091ebe54.c010eb47e28b6c7bf48eb014da195523d4562c639a288065002fd4e56c86fcd7)) / SUM(57eef8c3d4a13d22f0b40f9742e7b281.f2a0e23cc9c6bc0a97b68fe4091ebe54.c010eb47e28b6c7bf48eb014da195523d4562c639a288065002fd4e56c86fcd7))\n                                        * 100\n                                     ELSE\n                                        0\n                                  END\n                                     unfrm_qty_ship_var,\n                                  SUM(57eef8c3d4a13d22f0b40f9742e7b281.f2a0e23cc9c6bc0a97b68fe4091ebe54.e6eacb08cfb1528f520daba6c77bfbbb97b501caccd90ae146341c7c4f5ffd17) unfrm_qty_ship_ytd,\n                                  SUM(57eef8c3d4a13d22f0b40f9742e7b281.f2a0e23cc9c6bc0a97b68fe4091ebe54.e6eacb08cfb1528f520daba6c77bfbbb9cfb40ba667e147bf77567a1f22be3c0) unfrm_qty_ship_ytd_ly,\n                                  CASE\n                                     WHEN SUM(57eef8c3d4a13d22f0b40f9742e7b281.f2a0e23cc9c6bc0a97b68fe4091ebe54.e6eacb08cfb1528f520daba6c77bfbbb9cfb40ba667e147bf77567a1f22be3c0) > 0 THEN\n                                        ((SUM(57eef8c3d4a13d22f0b40f9742e7b281.f2a0e23cc9c6bc0a97b68fe4091ebe54.e6eacb08cfb1528f520daba6c77bfbbb97b501caccd90ae146341c7c4f5ffd17) - SUM(57eef8c3d4a13d22f0b40f9742e7b281.f2a0e23cc9c6bc0a97b68fe4091ebe54.e6eacb08cfb1528f520daba6c77bfbbb9cfb40ba667e147bf77567a1f22be3c0))\n                                         / SUM(57eef8c3d4a13d22f0b40f9742e7b281.f2a0e23cc9c6bc0a97b68fe4091ebe54.e6eacb08cfb1528f520daba6c77bfbbb9cfb40ba667e147bf77567a1f22be3c0))\n                                        * 100\n                                     ELSE\n                                        0\n                                  END\n                                     unfrm_qty_ship_ytd_var,\n                                  SUM(57eef8c3d4a13d22f0b40f9742e7b281.f2a0e23cc9c6bc0a97b68fe4091ebe54.de359d0148528b5cfe3c4b36b71fd9cd) grs_tgp,\n                                  SUM(57eef8c3d4a13d22f0b40f9742e7b281.f2a0e23cc9c6bc0a97b68fe4091ebe54.7b01e56fd85d33f336818231098d9d90) grs_tgp_ly,\n                                  CASE\n                                     WHEN SUM(57eef8c3d4a13d22f0b40f9742e7b281.f2a0e23cc9c6bc0a97b68fe4091ebe54.7b01e56fd85d33f336818231098d9d90) > 0 THEN\n                                        ((SUM(57eef8c3d4a13d22f0b40f9742e7b281.f2a0e23cc9c6bc0a97b68fe4091ebe54.de359d0148528b5cfe3c4b36b71fd9cd) - SUM(57eef8c3d4a13d22f0b40f9742e7b281.f2a0e23cc9c6bc0a97b68fe4091ebe54.7b01e56fd85d33f336818231098d9d90)) / SUM(57eef8c3d4a13d22f0b40f9742e7b281.f2a0e23cc9c6bc0a97b68fe4091ebe54.7b01e56fd85d33f336818231098d9d90)) * 100\n                                     ELSE\n                                        0\n                                  END\n                                     grs_tgp_var,\n                                  SUM(57eef8c3d4a13d22f0b40f9742e7b281.f2a0e23cc9c6bc0a97b68fe4091ebe54.ab2fa5045bbd7f0fd3439b80811b1538) grs_tgp_ytd,\n                                  SUM(57eef8c3d4a13d22f0b40f9742e7b281.f2a0e23cc9c6bc0a97b68fe4091ebe54.0e64b83ed41957f76af6e9b8a5c2e5a6) grs_tgp_ytd_ly,\n                                  CASE\n                                     WHEN SUM(57eef8c3d4a13d22f0b40f9742e7b281.f2a0e23cc9c6bc0a97b68fe4091ebe54.0e64b83ed41957f76af6e9b8a5c2e5a6) > 0 THEN\n                                        ((SUM(57eef8c3d4a13d22f0b40f9742e7b281.f2a0e23cc9c6bc0a97b68fe4091ebe54.ab2fa5045bbd7f0fd3439b80811b1538) - SUM(57eef8c3d4a13d22f0b40f9742e7b281.f2a0e23cc9c6bc0a97b68fe4091ebe54.0e64b83ed41957f76af6e9b8a5c2e5a6)) / SUM(57eef8c3d4a13d22f0b40f9742e7b281.f2a0e23cc9c6bc0a97b68fe4091ebe54.0e64b83ed41957f76af6e9b8a5c2e5a6)) * 100\n                                     ELSE\n                                        0\n                                  END\n                                     grs_tgp_ytd_var,\n                                  SUM(57eef8c3d4a13d22f0b40f9742e7b281.f2a0e23cc9c6bc0a97b68fe4091ebe54.9c9a1e7c735e3747c82e2f22363a41b3) net_acct,\n                                  SUM(57eef8c3d4a13d22f0b40f9742e7b281.f2a0e23cc9c6bc0a97b68fe4091ebe54.d37113b057aae8aaddfdad2c2ee8a8fb) net_acct_ly,\n                                  CASE\n                                     WHEN SUM(57eef8c3d4a13d22f0b40f9742e7b281.f2a0e23cc9c6bc0a97b68fe4091ebe54.d37113b057aae8aaddfdad2c2ee8a8fb) > 0 THEN\n                                        ((SUM(57eef8c3d4a13d22f0b40f9742e7b281.f2a0e23cc9c6bc0a97b68fe4091ebe54.9c9a1e7c735e3747c82e2f22363a41b3) - SUM(57eef8c3d4a13d22f0b40f9742e7b281.f2a0e23cc9c6bc0a97b68fe4091ebe54.d37113b057aae8aaddfdad2c2ee8a8fb)) / SUM(57eef8c3d4a13d22f0b40f9742e7b281.f2a0e23cc9c6bc0a97b68fe4091ebe54.d37113b057aae8aaddfdad2c2ee8a8fb)) * 100\n                                     ELSE\n                                        0\n                                  END\n                                     net_acct_var,\n                                  CASE WHEN fbedbc120a0a5f64565a8fd10ef09617.8e03069323442dd80d6c5a2e777fe24d > 0 THEN SUM(57eef8c3d4a13d22f0b40f9742e7b281.f2a0e23cc9c6bc0a97b68fe4091ebe54.9c9a1e7c735e3747c82e2f22363a41b3) / fbedbc120a0a5f64565a8fd10ef09617.8e03069323442dd80d6c5a2e777fe24d ELSE 0 END net_acct_per_tm,\n                                  CASE WHEN fbedbc120a0a5f64565a8fd10ef09617.fa15d89f304e26b55cfa1374391a204e > 0 THEN SUM(57eef8c3d4a13d22f0b40f9742e7b281.f2a0e23cc9c6bc0a97b68fe4091ebe54.d37113b057aae8aaddfdad2c2ee8a8fb) / fbedbc120a0a5f64565a8fd10ef09617.fa15d89f304e26b55cfa1374391a204e ELSE 0 END\n                                     net_acct_per_tm_ly,\n                                  CASE\n                                     WHEN CASE WHEN fbedbc120a0a5f64565a8fd10ef09617.fa15d89f304e26b55cfa1374391a204e > 0 THEN SUM(57eef8c3d4a13d22f0b40f9742e7b281.f2a0e23cc9c6bc0a97b68fe4091ebe54.d37113b057aae8aaddfdad2c2ee8a8fb) / fbedbc120a0a5f64565a8fd10ef09617.fa15d89f304e26b55cfa1374391a204e ELSE 0 END > 0 THEN\n                                        (CASE WHEN fbedbc120a0a5f64565a8fd10ef09617.8e03069323442dd80d6c5a2e777fe24d > 0 THEN SUM(57eef8c3d4a13d22f0b40f9742e7b281.f2a0e23cc9c6bc0a97b68fe4091ebe54.9c9a1e7c735e3747c82e2f22363a41b3) / fbedbc120a0a5f64565a8fd10ef09617.8e03069323442dd80d6c5a2e777fe24d ELSE 0 END\n                                         - CASE WHEN fbedbc120a0a5f64565a8fd10ef09617.fa15d89f304e26b55cfa1374391a204e > 0 THEN SUM(57eef8c3d4a13d22f0b40f9742e7b281.f2a0e23cc9c6bc0a97b68fe4091ebe54.d37113b057aae8aaddfdad2c2ee8a8fb) / fbedbc120a0a5f64565a8fd10ef09617.fa15d89f304e26b55cfa1374391a204e ELSE 0 END)\n                                        / CASE WHEN fbedbc120a0a5f64565a8fd10ef09617.fa15d89f304e26b55cfa1374391a204e > 0 THEN SUM(57eef8c3d4a13d22f0b40f9742e7b281.f2a0e23cc9c6bc0a97b68fe4091ebe54.d37113b057aae8aaddfdad2c2ee8a8fb) / fbedbc120a0a5f64565a8fd10ef09617.fa15d89f304e26b55cfa1374391a204e ELSE 0 END\n                                        * 100\n                                     ELSE\n                                        0\n                                  END\n                                     net_acct_per_tm_var,\n                                  CASE\n                                     WHEN SUM(57eef8c3d4a13d22f0b40f9742e7b281.f2a0e23cc9c6bc0a97b68fe4091ebe54.163292e356591886d2dbc90bb358824a) > 0 THEN\n                                        SUM(57eef8c3d4a13d22f0b40f9742e7b281.f2a0e23cc9c6bc0a97b68fe4091ebe54.e3c9674cf72ad209a86e79ad7170a77f + 57eef8c3d4a13d22f0b40f9742e7b281.f2a0e23cc9c6bc0a97b68fe4091ebe54.cc13a0b97d56d9aff1b0c78c855c726c53a0c0fe76045acdb204ca36f43c8ecf + 57eef8c3d4a13d22f0b40f9742e7b281.f2a0e23cc9c6bc0a97b68fe4091ebe54.26c3a68b174857edf61a2b0937fd2db7) / SUM(57eef8c3d4a13d22f0b40f9742e7b281.f2a0e23cc9c6bc0a97b68fe4091ebe54.163292e356591886d2dbc90bb358824a)\n                                     ELSE\n                                        0\n                                  END\n                                     lines_per_drop,\n                                  CASE\n                                     WHEN SUM(57eef8c3d4a13d22f0b40f9742e7b281.f2a0e23cc9c6bc0a97b68fe4091ebe54.eb496422b413b276ec7601e36b3cddd4) > 0 THEN\n                                        SUM(57eef8c3d4a13d22f0b40f9742e7b281.f2a0e23cc9c6bc0a97b68fe4091ebe54.38b68df6eff1ccc35e63028a96c972a6 + 57eef8c3d4a13d22f0b40f9742e7b281.f2a0e23cc9c6bc0a97b68fe4091ebe54.cc13a0b97d56d9aff1b0c78c855c726c91b777230e03c0dedfb113c2c8af948c + 57eef8c3d4a13d22f0b40f9742e7b281.f2a0e23cc9c6bc0a97b68fe4091ebe54.020f3d7b0db35337834063801a84df46)\n                                        / SUM(57eef8c3d4a13d22f0b40f9742e7b281.f2a0e23cc9c6bc0a97b68fe4091ebe54.eb496422b413b276ec7601e36b3cddd4)\n                                     ELSE\n                                        0\n                                  END\n                                     lines_per_drop_ly,\n                                  CASE\n                                     WHEN CASE\n                                             WHEN SUM(57eef8c3d4a13d22f0b40f9742e7b281.f2a0e23cc9c6bc0a97b68fe4091ebe54.eb496422b413b276ec7601e36b3cddd4) > 0 THEN\n                                                SUM(57eef8c3d4a13d22f0b40f9742e7b281.f2a0e23cc9c6bc0a97b68fe4091ebe54.38b68df6eff1ccc35e63028a96c972a6 + 57eef8c3d4a13d22f0b40f9742e7b281.f2a0e23cc9c6bc0a97b68fe4091ebe54.cc13a0b97d56d9aff1b0c78c855c726c91b777230e03c0dedfb113c2c8af948c + 57eef8c3d4a13d22f0b40f9742e7b281.f2a0e23cc9c6bc0a97b68fe4091ebe54.020f3d7b0db35337834063801a84df46)\n                                                / SUM(57eef8c3d4a13d22f0b40f9742e7b281.f2a0e23cc9c6bc0a97b68fe4091ebe54.eb496422b413b276ec7601e36b3cddd4)\n                                             ELSE\n                                                0\n                                          END > 0 THEN\n                                        (CASE\n                                            WHEN SUM(57eef8c3d4a13d22f0b40f9742e7b281.f2a0e23cc9c6bc0a97b68fe4091ebe54.163292e356591886d2dbc90bb358824a) > 0 THEN\n                                               SUM(57eef8c3d4a13d22f0b40f9742e7b281.f2a0e23cc9c6bc0a97b68fe4091ebe54.e3c9674cf72ad209a86e79ad7170a77f + 57eef8c3d4a13d22f0b40f9742e7b281.f2a0e23cc9c6bc0a97b68fe4091ebe54.cc13a0b97d56d9aff1b0c78c855c726c53a0c0fe76045acdb204ca36f43c8ecf + 57eef8c3d4a13d22f0b40f9742e7b281.f2a0e23cc9c6bc0a97b68fe4091ebe54.26c3a68b174857edf61a2b0937fd2db7) / SUM(57eef8c3d4a13d22f0b40f9742e7b281.f2a0e23cc9c6bc0a97b68fe4091ebe54.163292e356591886d2dbc90bb358824a)\n                                            ELSE\n                                               0\n                                         END\n                                         - CASE\n                                              WHEN SUM(57eef8c3d4a13d22f0b40f9742e7b281.f2a0e23cc9c6bc0a97b68fe4091ebe54.eb496422b413b276ec7601e36b3cddd4) > 0 THEN\n                                                 SUM(57eef8c3d4a13d22f0b40f9742e7b281.f2a0e23cc9c6bc0a97b68fe4091ebe54.38b68df6eff1ccc35e63028a96c972a6 + 57eef8c3d4a13d22f0b40f9742e7b281.f2a0e23cc9c6bc0a97b68fe4091ebe54.cc13a0b97d56d9aff1b0c78c855c726c91b777230e03c0dedfb113c2c8af948c + 57eef8c3d4a13d22f0b40f9742e7b281.f2a0e23cc9c6bc0a97b68fe4091ebe54.020f3d7b0db35337834063801a84df46)\n                                                 / SUM(57eef8c3d4a13d22f0b40f9742e7b281.f2a0e23cc9c6bc0a97b68fe4091ebe54.eb496422b413b276ec7601e36b3cddd4)\n                                              ELSE\n                                                 0\n                                           END)\n                                        / CASE\n                                             WHEN SUM(57eef8c3d4a13d22f0b40f9742e7b281.f2a0e23cc9c6bc0a97b68fe4091ebe54.eb496422b413b276ec7601e36b3cddd4) > 0 THEN\n                                                SUM(57eef8c3d4a13d22f0b40f9742e7b281.f2a0e23cc9c6bc0a97b68fe4091ebe54.38b68df6eff1ccc35e63028a96c972a6 + 57eef8c3d4a13d22f0b40f9742e7b281.f2a0e23cc9c6bc0a97b68fe4091ebe54.cc13a0b97d56d9aff1b0c78c855c726c91b777230e03c0dedfb113c2c8af948c + 57eef8c3d4a13d22f0b40f9742e7b281.f2a0e23cc9c6bc0a97b68fe4091ebe54.020f3d7b0db35337834063801a84df46)\n                                                / SUM(57eef8c3d4a13d22f0b40f9742e7b281.f2a0e23cc9c6bc0a97b68fe4091ebe54.eb496422b413b276ec7601e36b3cddd4)\n                                             ELSE\n                                                0\n                                          END\n                                        * 100\n                                     ELSE\n                                        0\n                                  END\n                                     lines_per_drop_var,\n                                  CASE\n                                     WHEN SUM(57eef8c3d4a13d22f0b40f9742e7b281.f2a0e23cc9c6bc0a97b68fe4091ebe54.9e7e4013fd15c78725b0ef91cd1cd802) > 0 THEN\n                                        (SUM(57eef8c3d4a13d22f0b40f9742e7b281.f2a0e23cc9c6bc0a97b68fe4091ebe54.05bf51c98f7ab7d3a8b23f414be7cea253a0c0fe76045acdb204ca36f43c8ecf) / SUM(57eef8c3d4a13d22f0b40f9742e7b281.f2a0e23cc9c6bc0a97b68fe4091ebe54.9e7e4013fd15c78725b0ef91cd1cd802)) * 100\n                                     ELSE\n                                        0\n                                  END\n                                     eb_pct,\n                                  CASE\n                                     WHEN SUM(57eef8c3d4a13d22f0b40f9742e7b281.f2a0e23cc9c6bc0a97b68fe4091ebe54.38b856c3c52540c729a21ac9b1e8d4b453a0c0fe76045acdb204ca36f43c8ecf) > 0 THEN\n                                        (SUM(57eef8c3d4a13d22f0b40f9742e7b281.f2a0e23cc9c6bc0a97b68fe4091ebe54.05bf51c98f7ab7d3a8b23f414be7cea291b777230e03c0dedfb113c2c8af948c) / SUM(57eef8c3d4a13d22f0b40f9742e7b281.f2a0e23cc9c6bc0a97b68fe4091ebe54.38b856c3c52540c729a21ac9b1e8d4b453a0c0fe76045acdb204ca36f43c8ecf)) * 100\n                                     ELSE\n                                        0\n                                  END\n                                     eb_pct_ly\n                             FROM (SELECT *\n                                     FROM 57eef8c3d4a13d22f0b40f9742e7b281.f2a0e23cc9c6bc0a97b68fe4091ebe54\n                                    WHERE '\n                  || e1526bd55893e365bac40408d41be6c7.bbb3bad778264a50a1a6c246b3daf397\n                  || '\n                                      AND '\n                  || 32a5aa777d265c79e81e0e943db6ed49.374d02f3911361f30c9f6dca39455d4c\n                  || ') tmp,\n                            (SELECT 57eef8c3d4a13d22f0b40f9742e7b281.c34b3b41e7bd0c01dfd7c75a49970163.*, CASE WHEN '\n                  || e1526bd55893e365bac40408d41be6c7.31953ff0f9caf854f33c049172c5937b\n                  || ' <= 3 THEN tm_st_cnt ELSE tm_na_cnt END tm_cnt,\n                                         CASE WHEN '\n                  || e1526bd55893e365bac40408d41be6c7.31953ff0f9caf854f33c049172c5937b\n                  || ' <= 3 THEN tm_st_cnt_ly ELSE tm_na_cnt_ly END tm_cnt_ly\n                               FROM 57eef8c3d4a13d22f0b40f9742e7b281.c34b3b41e7bd0c01dfd7c75a49970163 o) org\n                            WHERE '\n                  || 2e287f91c1a72c8a2cd237d9c036d931.374d02f3911361f30c9f6dca39455d4c\n                  || '\n                              AND fbedbc120a0a5f64565a8fd10ef09617.959d7ed0152ba33b5452be0366845ae2 = '''\n                  || 2e287f91c1a72c8a2cd237d9c036d931.959d7ed0152ba33b5452be0366845ae2\n                  || '''\n                              AND fbedbc120a0a5f64565a8fd10ef09617.051677fa81b6acaecd067857b3e57ecd = '''\n                  || g_fisc_yr_mth\n                  || '''\n                         GROUP BY fbedbc120a0a5f64565a8fd10ef09617.940d2cf399f647883b423bdc838abc48, fbedbc120a0a5f64565a8fd10ef09617.8e03069323442dd80d6c5a2e777fe24d, fbedbc120a0a5f64565a8fd10ef09617.fa15d89f304e26b55cfa1374391a204e)\n                 SELECT '''\n                  || g_fisc_yr_mth\n                  || ''' fisc_yr_mth,\n                        '''\n                  || 2e287f91c1a72c8a2cd237d9c036d931.959d7ed0152ba33b5452be0366845ae2\n                  || ''' org_lvl,\n                        b31a7d43ee7e1a5b4d264027e2683bd0.940d2cf399f647883b423bdc838abc48, '\n                  || e1526bd55893e365bac40408d41be6c7.31953ff0f9caf854f33c049172c5937b\n                  || ' rnk_ctgry,\n                        57eef8c3d4a13d22f0b40f9742e7b281.1f9c921b05aafc28bf91547d5ec08a09.4037c51e8a924adecf20c1b5c685241e rnk_lvl,\n                        '''\n                  || 32a5aa777d265c79e81e0e943db6ed49.5d05d543e266512d1fd2ec6a83eece24\n                  || ''' cust_clsfctn,\n                        ''VAR PERCENT'' rnk_by,\n                        b31a7d43ee7e1a5b4d264027e2683bd0.ef475f1eb4af657bf72d87e81656e990feb16ec175a739c84b79e5d396593a57,\n                        8683f9784911be4ee0f7b8b1797ca15b.b67af150b2e84394fb0262f2776bf2ae,\n                        8683f9784911be4ee0f7b8b1797ca15b.a97268ede7c0d7e2eebc4d0d488e361f,\n                        8683f9784911be4ee0f7b8b1797ca15b.60f6e21732722471e0c3aa442c0b51dc,\n                        8683f9784911be4ee0f7b8b1797ca15b.9e7e4013fd15c78725b0ef91cd1cd802,\n                        8683f9784911be4ee0f7b8b1797ca15b.38b856c3c52540c729a21ac9b1e8d4b453a0c0fe76045acdb204ca36f43c8ecf,\n                        CASE WHEN 8683f9784911be4ee0f7b8b1797ca15b.97d0b7dfcea2ede9da55f1198a57885e3829969834280a39721b32c836afdff1 > 958300e91dcc6b35c883a368ed727def.9be3c526dbb75dd03ad1acf00703c4f6 THEN 958300e91dcc6b35c883a368ed727def.9be3c526dbb75dd03ad1acf00703c4f6 ELSE 8683f9784911be4ee0f7b8b1797ca15b.97d0b7dfcea2ede9da55f1198a57885e3829969834280a39721b32c836afdff1 END grs_sls_extnd_var,\n                        8683f9784911be4ee0f7b8b1797ca15b.5be717b469b9cc32bb6cea74112db38a0ca5fb119e004e3dd9cc2be01757c595,\n                        8683f9784911be4ee0f7b8b1797ca15b.5be717b469b9cc32bb6cea74112db38ab1ad21072600892b79b2f03b961f8103,\n                        CASE WHEN 8683f9784911be4ee0f7b8b1797ca15b.5be717b469b9cc32bb6cea74112db38ac97717101e5ade058bac8c8d50eb5364 > 958300e91dcc6b35c883a368ed727def.9be3c526dbb75dd03ad1acf00703c4f6 THEN 958300e91dcc6b35c883a368ed727def.9be3c526dbb75dd03ad1acf00703c4f6 ELSE 8683f9784911be4ee0f7b8b1797ca15b.5be717b469b9cc32bb6cea74112db38ac97717101e5ade058bac8c8d50eb5364 END grs_sls_extnd_ytd_var,\n                        8683f9784911be4ee0f7b8b1797ca15b.35b5bbe882cdc6cc77aeda236583bcf0,\n                        8683f9784911be4ee0f7b8b1797ca15b.c010eb47e28b6c7bf48eb014da195523d4562c639a288065002fd4e56c86fcd7,\n                        CASE WHEN 8683f9784911be4ee0f7b8b1797ca15b.3c3217b237b0cc8aea934e93e6932ee6760ee94864352b2fd143cb660266e5ba > 7b14044dbf7642c0804753f3aaf9906b.4ca6b9bd624e18502f423aa069e6e084 THEN 7b14044dbf7642c0804753f3aaf9906b.4ca6b9bd624e18502f423aa069e6e084 ELSE 8683f9784911be4ee0f7b8b1797ca15b.3c3217b237b0cc8aea934e93e6932ee6760ee94864352b2fd143cb660266e5ba END unfrm_qty_ship_var,\n                        8683f9784911be4ee0f7b8b1797ca15b.e6eacb08cfb1528f520daba6c77bfbbb97b501caccd90ae146341c7c4f5ffd17,\n                        8683f9784911be4ee0f7b8b1797ca15b.e6eacb08cfb1528f520daba6c77bfbbb9cfb40ba667e147bf77567a1f22be3c0,\n                        CASE WHEN 8683f9784911be4ee0f7b8b1797ca15b.e6eacb08cfb1528f520daba6c77bfbbb5082620ccee91c174294c9aaeb197b93 > 7b14044dbf7642c0804753f3aaf9906b.4ca6b9bd624e18502f423aa069e6e084 THEN 7b14044dbf7642c0804753f3aaf9906b.4ca6b9bd624e18502f423aa069e6e084 ELSE 8683f9784911be4ee0f7b8b1797ca15b.e6eacb08cfb1528f520daba6c77bfbbb5082620ccee91c174294c9aaeb197b93 END unfrm_qty_ship_ytd_var,\n                        8683f9784911be4ee0f7b8b1797ca15b.de359d0148528b5cfe3c4b36b71fd9cd,\n                        8683f9784911be4ee0f7b8b1797ca15b.7b01e56fd85d33f336818231098d9d90,\n                        CASE WHEN 8683f9784911be4ee0f7b8b1797ca15b.fd189c6b966ffe8b9685896d114aa5af > 7b14044dbf7642c0804753f3aaf9906b.c3cacb5b2bab05b2925e1e650e183e3f THEN 7b14044dbf7642c0804753f3aaf9906b.c3cacb5b2bab05b2925e1e650e183e3f ELSE 8683f9784911be4ee0f7b8b1797ca15b.fd189c6b966ffe8b9685896d114aa5af END grs_tgp_var,\n                        8683f9784911be4ee0f7b8b1797ca15b.ab2fa5045bbd7f0fd3439b80811b1538,\n                        8683f9784911be4ee0f7b8b1797ca15b.0e64b83ed41957f76af6e9b8a5c2e5a6,\n                        CASE WHEN 8683f9784911be4ee0f7b8b1797ca15b.39e09b7556dd8f4b602616386ec7e4bd > 7b14044dbf7642c0804753f3aaf9906b.c3cacb5b2bab05b2925e1e650e183e3f THEN 7b14044dbf7642c0804753f3aaf9906b.c3cacb5b2bab05b2925e1e650e183e3f ELSE 8683f9784911be4ee0f7b8b1797ca15b.39e09b7556dd8f4b602616386ec7e4bd END grs_tgp_ytd_var,\n                        8683f9784911be4ee0f7b8b1797ca15b.9c9a1e7c735e3747c82e2f22363a41b3,\n                        8683f9784911be4ee0f7b8b1797ca15b.d37113b057aae8aaddfdad2c2ee8a8fb,\n                        CASE WHEN 8683f9784911be4ee0f7b8b1797ca15b.6a6aeba4661d228696adbafac058a9c9 > c3cacb5b2bab05b2925e1e650e183e3f.9be3c526dbb75dd03ad1acf00703c4f6 THEN c3cacb5b2bab05b2925e1e650e183e3f.9be3c526dbb75dd03ad1acf00703c4f6 ELSE 8683f9784911be4ee0f7b8b1797ca15b.6a6aeba4661d228696adbafac058a9c9 END net_acct_var,\n                        8683f9784911be4ee0f7b8b1797ca15b.e3771fe5b897240b5e25f272b9f0f263,\n                        8683f9784911be4ee0f7b8b1797ca15b.f0c88babacd81e10e30eec256b721797665303dbbc240a5eaa44af13b9d8147d,\n                        CASE WHEN 8683f9784911be4ee0f7b8b1797ca15b.f0c88babacd81e10e30eec256b72179754cfce5485b7fc71f014d21387b577f0 > 4307b75cdef84b19095a0ca61cac02fe.4ca6b9bd624e18502f423aa069e6e084 THEN 4307b75cdef84b19095a0ca61cac02fe.4ca6b9bd624e18502f423aa069e6e084 ELSE 8683f9784911be4ee0f7b8b1797ca15b.f0c88babacd81e10e30eec256b72179754cfce5485b7fc71f014d21387b577f0 END net_acct_per_tm_var,\n                        8683f9784911be4ee0f7b8b1797ca15b.36a969534b50ebd7e707a938655c31de,\n                        8683f9784911be4ee0f7b8b1797ca15b.78e6d88e1c6251dad6cc7a53317762a9d4562c639a288065002fd4e56c86fcd7,\n                        CASE WHEN 8683f9784911be4ee0f7b8b1797ca15b.fe00e43d17fcccf45bd8fd1f60976e3b760ee94864352b2fd143cb660266e5ba > 4307b75cdef84b19095a0ca61cac02fe.4ca6b9bd624e18502f423aa069e6e084 THEN 4307b75cdef84b19095a0ca61cac02fe.4ca6b9bd624e18502f423aa069e6e084 ELSE 8683f9784911be4ee0f7b8b1797ca15b.fe00e43d17fcccf45bd8fd1f60976e3b760ee94864352b2fd143cb660266e5ba END lines_per_drop_var,\n                        8683f9784911be4ee0f7b8b1797ca15b.21c474c55b03f885347d88f4911a9704,\n                        8683f9784911be4ee0f7b8b1797ca15b.d6fa913c3fbceed53e266c0933b8890f,\n                        NULL\n                   FROM pop, rnk, 57eef8c3d4a13d22f0b40f9742e7b281.1f9c921b05aafc28bf91547d5ec08a09 pv\n                  WHERE b31a7d43ee7e1a5b4d264027e2683bd0.940d2cf399f647883b423bdc838abc48 = 8683f9784911be4ee0f7b8b1797ca15b.940d2cf399f647883b423bdc838abc48(+)\n                    AND 57eef8c3d4a13d22f0b40f9742e7b281.1f9c921b05aafc28bf91547d5ec08a09.43a9f6c6a177bec360bf6b18c1940207 = ''SLS_RNK''\n                    AND 57eef8c3d4a13d22f0b40f9742e7b281.1f9c921b05aafc28bf91547d5ec08a09.4b71eb655fa28c0be4a6bcbfd3e189a5 = ''RNK_LVL_LOV'')';\n\n               EXECUTE IMMEDIATE l_sql;\n\n               COMMIT;\n            END LOOP;\n         END LOOP;\n      END LOOP;\n\n      \n      l_return_code   := 57eef8c3d4a13d22f0b40f9742e7b281.e9c7d074541f588587f071b89e534d87('XDMADM', 'SLS_RNK_MTH_TMP');\n      DBMS_OUTPUT.put_line('Analyze SLS_RNK_MTH_TMP Return Code: ' || l_return_code);\n\n      \n      UPDATE 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2 s\n         SET ir_pct   =\n                (SELECT ir_pct\n                   FROM 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2\n                  WHERE org_lvl = c1e1ab753a3b305911e8a15073f6c8e7.959d7ed0152ba33b5452be0366845ae2\n                    AND org_val = c1e1ab753a3b305911e8a15073f6c8e7.940d2cf399f647883b423bdc838abc48\n                    AND cust_clsfctn = c1e1ab753a3b305911e8a15073f6c8e7.5d05d543e266512d1fd2ec6a83eece24\n                    AND rnk_by = c1e1ab753a3b305911e8a15073f6c8e7.6b7c0883b4db52123315459187a26b49\n                    AND rnk_lvl = c1e1ab753a3b305911e8a15073f6c8e7.83a522d7deb767fb152402f1efe33872\n                    AND rnk_ctgry = 0),\n             ir_pct_ytd   =\n                (SELECT ir_pct_ytd\n                   FROM 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2\n                  WHERE org_lvl = c1e1ab753a3b305911e8a15073f6c8e7.959d7ed0152ba33b5452be0366845ae2\n                    AND org_val = c1e1ab753a3b305911e8a15073f6c8e7.940d2cf399f647883b423bdc838abc48\n                    AND cust_clsfctn = c1e1ab753a3b305911e8a15073f6c8e7.5d05d543e266512d1fd2ec6a83eece24\n                    AND rnk_by = c1e1ab753a3b305911e8a15073f6c8e7.6b7c0883b4db52123315459187a26b49\n                    AND rnk_lvl = c1e1ab753a3b305911e8a15073f6c8e7.83a522d7deb767fb152402f1efe33872\n                    AND rnk_ctgry = 0)\n       WHERE rnk_ctgry <> 0;\n\n      IF l_return_code <> 0 THEN\n         DBMS_OUTPUT.put_line('Error: Failed to analyze table SLS_RNK_MTH_TMP');\n      END IF;\n   EXCEPTION\n      WHEN OTHERS THEN\n         DBMS_OUTPUT.put_line(l_sql);\n         RAISE;\n   END ins_sls_rnk_mth;\n\n   \n\n   PROCEDURE upd_sls_rnk_mth_cnt IS\n      \n      CURSOR c_div_cnt IS\n           SELECT 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.051677fa81b6acaecd067857b3e57ecd,\n                  57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.959d7ed0152ba33b5452be0366845ae2,\n                  57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.31953ff0f9caf854f33c049172c5937b,\n                  57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.5d05d543e266512d1fd2ec6a83eece24,\n                  57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.ef475f1eb4af657bf72d87e81656e990feb16ec175a739c84b79e5d396593a57,\n                  SUM(CASE\n                         WHEN ((57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.31953ff0f9caf854f33c049172c5937b <= 3\n                            AND fbedbc120a0a5f64565a8fd10ef09617.5476018fbbb9dba5f160875a3669958f = 'Y')\n                            OR (57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.31953ff0f9caf854f33c049172c5937b >= 4\n                            AND fbedbc120a0a5f64565a8fd10ef09617.eda676abf3186dcacecd70aa0e501730 = 'Y')) THEN\n                            1\n                         ELSE\n                            0\n                      END)\n                     mth_pop,\n                  SUM(CASE\n                         WHEN ((57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.31953ff0f9caf854f33c049172c5937b <= 3\n                            AND fbedbc120a0a5f64565a8fd10ef09617.4db59846821e5f3a7db740c32f8cca18 = 'Y')\n                            OR (57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.31953ff0f9caf854f33c049172c5937b >= 4\n                            AND fbedbc120a0a5f64565a8fd10ef09617.75baa75c0b184dd5e1aa3fa19462dd65 = 'Y')) THEN\n                            1\n                         ELSE\n                            0\n                      END)\n                     ytd_pop\n             FROM 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2 rnk, 57eef8c3d4a13d22f0b40f9742e7b281.c34b3b41e7bd0c01dfd7c75a49970163 org\n            WHERE 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.051677fa81b6acaecd067857b3e57ecd = fbedbc120a0a5f64565a8fd10ef09617.051677fa81b6acaecd067857b3e57ecd\n              AND 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.959d7ed0152ba33b5452be0366845ae2 = fbedbc120a0a5f64565a8fd10ef09617.959d7ed0152ba33b5452be0366845ae2\n              AND 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.940d2cf399f647883b423bdc838abc48 = fbedbc120a0a5f64565a8fd10ef09617.940d2cf399f647883b423bdc838abc48\n              AND 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.83a522d7deb767fb152402f1efe33872 = 'DIVISION'\n              AND 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.6b7c0883b4db52123315459187a26b49 = 'VAR'\n              AND fbedbc120a0a5f64565a8fd10ef09617.051677fa81b6acaecd067857b3e57ecd = g_fisc_yr_mth\n         GROUP BY 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.051677fa81b6acaecd067857b3e57ecd,\n                  57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.959d7ed0152ba33b5452be0366845ae2,\n                  57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.31953ff0f9caf854f33c049172c5937b,\n                  57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.5d05d543e266512d1fd2ec6a83eece24,\n                  57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.ef475f1eb4af657bf72d87e81656e990feb16ec175a739c84b79e5d396593a57;\n\n      TYPE t_div_cnt IS TABLE OF c_div_cnt%ROWTYPE;\n\n      r_div_cnt   t_div_cnt;\n\n      \n      CURSOR c_nat_cnt IS\n           SELECT 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.051677fa81b6acaecd067857b3e57ecd,\n                  57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.959d7ed0152ba33b5452be0366845ae2,\n                  57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.31953ff0f9caf854f33c049172c5937b,\n                  57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.5d05d543e266512d1fd2ec6a83eece24,\n                  SUM(CASE\n                         WHEN ((57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.31953ff0f9caf854f33c049172c5937b <= 3\n                            AND fbedbc120a0a5f64565a8fd10ef09617.5476018fbbb9dba5f160875a3669958f = 'Y')\n                            OR (57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.31953ff0f9caf854f33c049172c5937b >= 4\n                            AND fbedbc120a0a5f64565a8fd10ef09617.eda676abf3186dcacecd70aa0e501730 = 'Y')) THEN\n                            1\n                         ELSE\n                            0\n                      END)\n                     mth_pop,\n                  SUM(CASE\n                         WHEN ((57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.31953ff0f9caf854f33c049172c5937b <= 3\n                            AND fbedbc120a0a5f64565a8fd10ef09617.4db59846821e5f3a7db740c32f8cca18 = 'Y')\n                            OR (57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.31953ff0f9caf854f33c049172c5937b >= 4\n                            AND fbedbc120a0a5f64565a8fd10ef09617.75baa75c0b184dd5e1aa3fa19462dd65 = 'Y')) THEN\n                            1\n                         ELSE\n                            0\n                      END)\n                     ytd_pop\n             FROM 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2 rnk, 57eef8c3d4a13d22f0b40f9742e7b281.c34b3b41e7bd0c01dfd7c75a49970163 org\n            WHERE 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.051677fa81b6acaecd067857b3e57ecd = fbedbc120a0a5f64565a8fd10ef09617.051677fa81b6acaecd067857b3e57ecd\n              AND 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.959d7ed0152ba33b5452be0366845ae2 = fbedbc120a0a5f64565a8fd10ef09617.959d7ed0152ba33b5452be0366845ae2\n              AND 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.940d2cf399f647883b423bdc838abc48 = fbedbc120a0a5f64565a8fd10ef09617.940d2cf399f647883b423bdc838abc48\n              AND 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.83a522d7deb767fb152402f1efe33872 = 'NATIONAL'\n              AND 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.6b7c0883b4db52123315459187a26b49 = 'VAR'\n              AND fbedbc120a0a5f64565a8fd10ef09617.051677fa81b6acaecd067857b3e57ecd = g_fisc_yr_mth\n         GROUP BY 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.051677fa81b6acaecd067857b3e57ecd,\n                  57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.959d7ed0152ba33b5452be0366845ae2,\n                  57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.31953ff0f9caf854f33c049172c5937b,\n                  57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.5d05d543e266512d1fd2ec6a83eece24;\n\n      TYPE t_nat_cnt IS TABLE OF c_nat_cnt%ROWTYPE;\n\n      r_nat_cnt   t_nat_cnt;\n   BEGIN\n      DBMS_OUTPUT.put_line('Updating counts in SLS_RNK_MTH_TMP');\n\n      \n      OPEN c_div_cnt;\n\n      LOOP\n         EXIT WHEN c_div_cnt%NOTFOUND;\n\n         FETCH c_div_cnt\n         BULK COLLECT INTO r_div_cnt\n         LIMIT 50000;\n\n         FORALL i IN 1 .. 67914aa2166de6b25718824b9ead8ec5.1e21de3bb543a206edf22b18c23a0c49()\n            UPDATE 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2\n               SET mth_pop = r_div_cnt(i).mth_pop, ytd_pop = r_div_cnt(i).ytd_pop\n             WHERE fisc_yr_mth = r_div_cnt(i).fisc_yr_mth\n               AND org_lvl = r_div_cnt(i).org_lvl\n               AND rnk_ctgry = r_div_cnt(i).rnk_ctgry\n               AND cust_clsfctn = r_div_cnt(i).cust_clsfctn\n               AND grp_cd_or_brnch_cd = r_div_cnt(i).grp_cd_or_brnch_cd\n               AND rnk_lvl = 'DIVISION';\n      END LOOP;\n\n      CLOSE c_div_cnt;\n\n      COMMIT;\n\n      \n      OPEN c_nat_cnt;\n\n      LOOP\n         EXIT WHEN c_nat_cnt%NOTFOUND;\n\n         FETCH c_nat_cnt\n         BULK COLLECT INTO r_nat_cnt\n         LIMIT 50000;\n\n         FORALL i IN 1 .. f2220feb3d3f90c6cafbb6610ea65f74.1e21de3bb543a206edf22b18c23a0c49()\n            UPDATE 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2\n               SET mth_pop = r_nat_cnt(i).mth_pop, ytd_pop = r_nat_cnt(i).ytd_pop\n             WHERE fisc_yr_mth = r_div_cnt(i).fisc_yr_mth\n               AND org_lvl = r_nat_cnt(i).org_lvl\n               AND rnk_ctgry = r_nat_cnt(i).rnk_ctgry\n               AND cust_clsfctn = r_nat_cnt(i).cust_clsfctn\n               AND rnk_lvl = 'NATIONAL';\n      END LOOP;\n\n      CLOSE c_nat_cnt;\n\n      COMMIT;\n   END upd_sls_rnk_mth_cnt;\n\n   \n\n   PROCEDURE upd_sls_rnk_mth_rnk IS\n      \n      CURSOR c_mth_div_rnk IS\n         SELECT fisc_yr_mth,\n                org_lvl,\n                org_val,\n                rnk_ctgry,\n                cust_clsfctn,\n                rnk_by,\n                ec_pct_rnk,\n                ec_pct_rnk_pctl,\n                ir_pct_rnk,\n                ir_pct_rnk_pctl,\n                grs_sls_extnd_rnk,\n                grs_sls_extnd_rnk_pctl,\n                unfrm_qty_ship_rnk,\n                unfrm_qty_ship_rnk_pctl,\n                grs_tgp_rnk,\n                grs_tgp_rnk_pctl,\n                net_acct_rnk,\n                net_acct_rnk_pctl,\n                net_acct_per_tm_rnk,\n                net_acct_per_tm_rnk_pctl,\n                lines_per_drop_rnk,\n                lines_per_drop_rnk_pctl,\n                eb_pct_rnk,\n                eb_pct_rnk_pctl,\n                RANK()\n                   OVER (PARTITION BY fisc_yr_mth, org_lvl, rnk_ctgry, cust_clsfctn, rnk_by, grp_cd_or_brnch_cd\n                         ORDER BY ir_pct_rnk + unfrm_qty_ship_rnk + grs_tgp_rnk)\n                   overall_rnk,\n                PERCENT_RANK()\n                   OVER (PARTITION BY fisc_yr_mth, org_lvl, rnk_ctgry, cust_clsfctn, rnk_by, grp_cd_or_brnch_cd\n                         ORDER BY ir_pct_rnk + unfrm_qty_ship_rnk + grs_tgp_rnk DESC)\n                   overall_rnk_pctl\n           FROM (SELECT 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.051677fa81b6acaecd067857b3e57ecd,\n                        57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.959d7ed0152ba33b5452be0366845ae2,\n                        57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.940d2cf399f647883b423bdc838abc48,\n                        57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.31953ff0f9caf854f33c049172c5937b,\n                        57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.5d05d543e266512d1fd2ec6a83eece24,\n                        57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.6b7c0883b4db52123315459187a26b49,\n                        fbedbc120a0a5f64565a8fd10ef09617.ef475f1eb4af657bf72d87e81656e990feb16ec175a739c84b79e5d396593a57,\n                        RANK()\n                           OVER (PARTITION BY 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.051677fa81b6acaecd067857b3e57ecd, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.959d7ed0152ba33b5452be0366845ae2, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.31953ff0f9caf854f33c049172c5937b, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.5d05d543e266512d1fd2ec6a83eece24, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.6b7c0883b4db52123315459187a26b49, fbedbc120a0a5f64565a8fd10ef09617.ef475f1eb4af657bf72d87e81656e990feb16ec175a739c84b79e5d396593a57\n                                 ORDER BY 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.b67af150b2e84394fb0262f2776bf2ae DESC NULLS LAST)\n                           ec_pct_rnk,\n                        PERCENT_RANK()\n                           OVER (PARTITION BY 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.051677fa81b6acaecd067857b3e57ecd, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.959d7ed0152ba33b5452be0366845ae2, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.31953ff0f9caf854f33c049172c5937b, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.5d05d543e266512d1fd2ec6a83eece24, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.6b7c0883b4db52123315459187a26b49, fbedbc120a0a5f64565a8fd10ef09617.ef475f1eb4af657bf72d87e81656e990feb16ec175a739c84b79e5d396593a57\n                                 ORDER BY 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.b67af150b2e84394fb0262f2776bf2ae NULLS FIRST)\n                           ec_pct_rnk_pctl,\n                        RANK()\n                           OVER (PARTITION BY 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.051677fa81b6acaecd067857b3e57ecd, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.959d7ed0152ba33b5452be0366845ae2, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.31953ff0f9caf854f33c049172c5937b, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.5d05d543e266512d1fd2ec6a83eece24, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.6b7c0883b4db52123315459187a26b49, fbedbc120a0a5f64565a8fd10ef09617.ef475f1eb4af657bf72d87e81656e990feb16ec175a739c84b79e5d396593a57\n                                 ORDER BY 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.a97268ede7c0d7e2eebc4d0d488e361f DESC NULLS LAST)\n                           ir_pct_rnk,\n                        PERCENT_RANK()\n                           OVER (PARTITION BY 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.051677fa81b6acaecd067857b3e57ecd, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.959d7ed0152ba33b5452be0366845ae2, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.31953ff0f9caf854f33c049172c5937b, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.5d05d543e266512d1fd2ec6a83eece24, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.6b7c0883b4db52123315459187a26b49, fbedbc120a0a5f64565a8fd10ef09617.ef475f1eb4af657bf72d87e81656e990feb16ec175a739c84b79e5d396593a57\n                                 ORDER BY 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.a97268ede7c0d7e2eebc4d0d488e361f NULLS FIRST)\n                           ir_pct_rnk_pctl,\n                        RANK()\n                           OVER (PARTITION BY 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.051677fa81b6acaecd067857b3e57ecd, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.959d7ed0152ba33b5452be0366845ae2, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.31953ff0f9caf854f33c049172c5937b, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.5d05d543e266512d1fd2ec6a83eece24, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.6b7c0883b4db52123315459187a26b49, fbedbc120a0a5f64565a8fd10ef09617.ef475f1eb4af657bf72d87e81656e990feb16ec175a739c84b79e5d396593a57\n                                 ORDER BY 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.97d0b7dfcea2ede9da55f1198a57885e3829969834280a39721b32c836afdff1 DESC NULLS LAST)\n                           grs_sls_extnd_rnk,\n                        PERCENT_RANK()\n                           OVER (PARTITION BY 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.051677fa81b6acaecd067857b3e57ecd, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.959d7ed0152ba33b5452be0366845ae2, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.31953ff0f9caf854f33c049172c5937b, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.5d05d543e266512d1fd2ec6a83eece24, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.6b7c0883b4db52123315459187a26b49, fbedbc120a0a5f64565a8fd10ef09617.ef475f1eb4af657bf72d87e81656e990feb16ec175a739c84b79e5d396593a57\n                                 ORDER BY 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.97d0b7dfcea2ede9da55f1198a57885e3829969834280a39721b32c836afdff1 NULLS FIRST)\n                           grs_sls_extnd_rnk_pctl,\n                        RANK()\n                           OVER (PARTITION BY 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.051677fa81b6acaecd067857b3e57ecd, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.959d7ed0152ba33b5452be0366845ae2, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.31953ff0f9caf854f33c049172c5937b, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.5d05d543e266512d1fd2ec6a83eece24, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.6b7c0883b4db52123315459187a26b49, fbedbc120a0a5f64565a8fd10ef09617.ef475f1eb4af657bf72d87e81656e990feb16ec175a739c84b79e5d396593a57\n                                 ORDER BY 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.3c3217b237b0cc8aea934e93e6932ee6760ee94864352b2fd143cb660266e5ba DESC NULLS LAST)\n                           unfrm_qty_ship_rnk,\n                        PERCENT_RANK()\n                           OVER (PARTITION BY 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.051677fa81b6acaecd067857b3e57ecd, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.959d7ed0152ba33b5452be0366845ae2, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.31953ff0f9caf854f33c049172c5937b, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.5d05d543e266512d1fd2ec6a83eece24, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.6b7c0883b4db52123315459187a26b49, fbedbc120a0a5f64565a8fd10ef09617.ef475f1eb4af657bf72d87e81656e990feb16ec175a739c84b79e5d396593a57\n                                 ORDER BY 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.3c3217b237b0cc8aea934e93e6932ee6760ee94864352b2fd143cb660266e5ba NULLS FIRST)\n                           unfrm_qty_ship_rnk_pctl,\n                        RANK()\n                           OVER (PARTITION BY 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.051677fa81b6acaecd067857b3e57ecd, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.959d7ed0152ba33b5452be0366845ae2, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.31953ff0f9caf854f33c049172c5937b, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.5d05d543e266512d1fd2ec6a83eece24, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.6b7c0883b4db52123315459187a26b49, fbedbc120a0a5f64565a8fd10ef09617.ef475f1eb4af657bf72d87e81656e990feb16ec175a739c84b79e5d396593a57\n                                 ORDER BY 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.fd189c6b966ffe8b9685896d114aa5af DESC NULLS LAST)\n                           grs_tgp_rnk,\n                        PERCENT_RANK()\n                           OVER (PARTITION BY 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.051677fa81b6acaecd067857b3e57ecd, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.959d7ed0152ba33b5452be0366845ae2, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.31953ff0f9caf854f33c049172c5937b, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.5d05d543e266512d1fd2ec6a83eece24, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.6b7c0883b4db52123315459187a26b49, fbedbc120a0a5f64565a8fd10ef09617.ef475f1eb4af657bf72d87e81656e990feb16ec175a739c84b79e5d396593a57\n                                 ORDER BY 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.fd189c6b966ffe8b9685896d114aa5af NULLS FIRST)\n                           grs_tgp_rnk_pctl,\n                        RANK()\n                           OVER (PARTITION BY 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.051677fa81b6acaecd067857b3e57ecd, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.959d7ed0152ba33b5452be0366845ae2, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.31953ff0f9caf854f33c049172c5937b, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.5d05d543e266512d1fd2ec6a83eece24, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.6b7c0883b4db52123315459187a26b49, fbedbc120a0a5f64565a8fd10ef09617.ef475f1eb4af657bf72d87e81656e990feb16ec175a739c84b79e5d396593a57\n                                 ORDER BY 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.6a6aeba4661d228696adbafac058a9c9 DESC NULLS LAST)\n                           net_acct_rnk,\n                        PERCENT_RANK()\n                           OVER (PARTITION BY 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.051677fa81b6acaecd067857b3e57ecd, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.959d7ed0152ba33b5452be0366845ae2, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.31953ff0f9caf854f33c049172c5937b, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.5d05d543e266512d1fd2ec6a83eece24, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.6b7c0883b4db52123315459187a26b49, fbedbc120a0a5f64565a8fd10ef09617.ef475f1eb4af657bf72d87e81656e990feb16ec175a739c84b79e5d396593a57\n                                 ORDER BY 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.6a6aeba4661d228696adbafac058a9c9 NULLS FIRST)\n                           net_acct_rnk_pctl,\n                        RANK()\n                           OVER (PARTITION BY 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.051677fa81b6acaecd067857b3e57ecd, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.959d7ed0152ba33b5452be0366845ae2, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.31953ff0f9caf854f33c049172c5937b, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.5d05d543e266512d1fd2ec6a83eece24, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.6b7c0883b4db52123315459187a26b49, fbedbc120a0a5f64565a8fd10ef09617.ef475f1eb4af657bf72d87e81656e990feb16ec175a739c84b79e5d396593a57\n                                 ORDER BY 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.f0c88babacd81e10e30eec256b72179754cfce5485b7fc71f014d21387b577f0 DESC NULLS LAST)\n                           net_acct_per_tm_rnk,\n                        PERCENT_RANK()\n                           OVER (PARTITION BY 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.051677fa81b6acaecd067857b3e57ecd, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.959d7ed0152ba33b5452be0366845ae2, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.31953ff0f9caf854f33c049172c5937b, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.5d05d543e266512d1fd2ec6a83eece24, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.6b7c0883b4db52123315459187a26b49, fbedbc120a0a5f64565a8fd10ef09617.ef475f1eb4af657bf72d87e81656e990feb16ec175a739c84b79e5d396593a57\n                                 ORDER BY 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.f0c88babacd81e10e30eec256b72179754cfce5485b7fc71f014d21387b577f0 NULLS FIRST)\n                           net_acct_per_tm_rnk_pctl,\n                        RANK()\n                           OVER (PARTITION BY 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.051677fa81b6acaecd067857b3e57ecd, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.959d7ed0152ba33b5452be0366845ae2, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.31953ff0f9caf854f33c049172c5937b, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.5d05d543e266512d1fd2ec6a83eece24, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.6b7c0883b4db52123315459187a26b49, fbedbc120a0a5f64565a8fd10ef09617.ef475f1eb4af657bf72d87e81656e990feb16ec175a739c84b79e5d396593a57\n                                 ORDER BY 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.fe00e43d17fcccf45bd8fd1f60976e3b760ee94864352b2fd143cb660266e5ba DESC NULLS LAST)\n                           lines_per_drop_rnk,\n                        PERCENT_RANK()\n                           OVER (PARTITION BY 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.051677fa81b6acaecd067857b3e57ecd, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.959d7ed0152ba33b5452be0366845ae2, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.31953ff0f9caf854f33c049172c5937b, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.5d05d543e266512d1fd2ec6a83eece24, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.6b7c0883b4db52123315459187a26b49, fbedbc120a0a5f64565a8fd10ef09617.ef475f1eb4af657bf72d87e81656e990feb16ec175a739c84b79e5d396593a57\n                                 ORDER BY 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.fe00e43d17fcccf45bd8fd1f60976e3b760ee94864352b2fd143cb660266e5ba NULLS FIRST)\n                           lines_per_drop_rnk_pctl,\n                        RANK()\n                           OVER (PARTITION BY 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.051677fa81b6acaecd067857b3e57ecd, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.959d7ed0152ba33b5452be0366845ae2, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.31953ff0f9caf854f33c049172c5937b, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.5d05d543e266512d1fd2ec6a83eece24, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.6b7c0883b4db52123315459187a26b49, fbedbc120a0a5f64565a8fd10ef09617.ef475f1eb4af657bf72d87e81656e990feb16ec175a739c84b79e5d396593a57\n                                 ORDER BY 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.ce3016f9cfb6897930b0022d4a9ebaba DESC NULLS LAST)\n                           eb_pct_rnk,\n                        PERCENT_RANK()\n                           OVER (PARTITION BY 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.051677fa81b6acaecd067857b3e57ecd, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.959d7ed0152ba33b5452be0366845ae2, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.31953ff0f9caf854f33c049172c5937b, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.5d05d543e266512d1fd2ec6a83eece24, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.6b7c0883b4db52123315459187a26b49, fbedbc120a0a5f64565a8fd10ef09617.ef475f1eb4af657bf72d87e81656e990feb16ec175a739c84b79e5d396593a57\n                                 ORDER BY 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.ce3016f9cfb6897930b0022d4a9ebaba NULLS FIRST)\n                           eb_pct_rnk_pctl\n                   FROM 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2 rnk, 57eef8c3d4a13d22f0b40f9742e7b281.c34b3b41e7bd0c01dfd7c75a49970163 org\n                  WHERE 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.051677fa81b6acaecd067857b3e57ecd = fbedbc120a0a5f64565a8fd10ef09617.051677fa81b6acaecd067857b3e57ecd\n                    AND 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.959d7ed0152ba33b5452be0366845ae2 = fbedbc120a0a5f64565a8fd10ef09617.959d7ed0152ba33b5452be0366845ae2\n                    AND 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.940d2cf399f647883b423bdc838abc48 = fbedbc120a0a5f64565a8fd10ef09617.940d2cf399f647883b423bdc838abc48\n                    AND ((57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.31953ff0f9caf854f33c049172c5937b <= 3\n                      AND fbedbc120a0a5f64565a8fd10ef09617.5476018fbbb9dba5f160875a3669958f = 'Y')\n                      OR (57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.31953ff0f9caf854f33c049172c5937b >= 4\n                      AND fbedbc120a0a5f64565a8fd10ef09617.eda676abf3186dcacecd70aa0e501730 = 'Y'))\n                    AND 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.83a522d7deb767fb152402f1efe33872 = 'DIVISION'\n                    AND fbedbc120a0a5f64565a8fd10ef09617.051677fa81b6acaecd067857b3e57ecd = g_fisc_yr_mth);\n\n      TYPE t_mth_div_rnk IS TABLE OF c_mth_div_rnk%ROWTYPE;\n\n      r_mth_div_rnk   t_mth_div_rnk;\n\n      \n      CURSOR c_mth_nat_rnk IS\n         SELECT fisc_yr_mth,\n                org_lvl,\n                org_val,\n                rnk_ctgry,\n                cust_clsfctn,\n                rnk_by,\n                ec_pct_rnk,\n                ec_pct_rnk_pctl,\n                ir_pct_rnk,\n                ir_pct_rnk_pctl,\n                grs_sls_extnd_rnk,\n                grs_sls_extnd_rnk_pctl,\n                unfrm_qty_ship_rnk,\n                unfrm_qty_ship_rnk_pctl,\n                grs_tgp_rnk,\n                grs_tgp_rnk_pctl,\n                net_acct_rnk,\n                net_acct_rnk_pctl,\n                net_acct_per_tm_rnk,\n                net_acct_per_tm_rnk_pctl,\n                lines_per_drop_rnk,\n                lines_per_drop_rnk_pctl,\n                eb_pct_rnk,\n                eb_pct_rnk_pctl,\n                RANK()\n                   OVER (PARTITION BY fisc_yr_mth, org_lvl, rnk_ctgry, cust_clsfctn, rnk_by ORDER BY ir_pct_rnk + unfrm_qty_ship_rnk + grs_tgp_rnk)\n                   overall_rnk,\n                PERCENT_RANK()\n                   OVER (PARTITION BY fisc_yr_mth, org_lvl, rnk_ctgry, cust_clsfctn, rnk_by\n                         ORDER BY ir_pct_rnk + unfrm_qty_ship_rnk + grs_tgp_rnk DESC)\n                   overall_rnk_pctl\n           FROM (SELECT 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.051677fa81b6acaecd067857b3e57ecd,\n                        57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.959d7ed0152ba33b5452be0366845ae2,\n                        57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.940d2cf399f647883b423bdc838abc48,\n                        57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.31953ff0f9caf854f33c049172c5937b,\n                        57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.5d05d543e266512d1fd2ec6a83eece24,\n                        57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.6b7c0883b4db52123315459187a26b49,\n                        RANK()\n                           OVER (PARTITION BY 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.051677fa81b6acaecd067857b3e57ecd, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.959d7ed0152ba33b5452be0366845ae2, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.31953ff0f9caf854f33c049172c5937b, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.5d05d543e266512d1fd2ec6a83eece24, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.6b7c0883b4db52123315459187a26b49\n                                 ORDER BY 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.b67af150b2e84394fb0262f2776bf2ae DESC NULLS LAST)\n                           ec_pct_rnk,\n                        PERCENT_RANK()\n                           OVER (PARTITION BY 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.051677fa81b6acaecd067857b3e57ecd, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.959d7ed0152ba33b5452be0366845ae2, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.31953ff0f9caf854f33c049172c5937b, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.5d05d543e266512d1fd2ec6a83eece24, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.6b7c0883b4db52123315459187a26b49\n                                 ORDER BY 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.b67af150b2e84394fb0262f2776bf2ae NULLS FIRST)\n                           ec_pct_rnk_pctl,\n                        RANK()\n                           OVER (PARTITION BY 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.051677fa81b6acaecd067857b3e57ecd, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.959d7ed0152ba33b5452be0366845ae2, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.31953ff0f9caf854f33c049172c5937b, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.5d05d543e266512d1fd2ec6a83eece24, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.6b7c0883b4db52123315459187a26b49\n                                 ORDER BY 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.a97268ede7c0d7e2eebc4d0d488e361f DESC NULLS LAST)\n                           ir_pct_rnk,\n                        PERCENT_RANK()\n                           OVER (PARTITION BY 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.051677fa81b6acaecd067857b3e57ecd, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.959d7ed0152ba33b5452be0366845ae2, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.31953ff0f9caf854f33c049172c5937b, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.5d05d543e266512d1fd2ec6a83eece24, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.6b7c0883b4db52123315459187a26b49\n                                 ORDER BY 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.a97268ede7c0d7e2eebc4d0d488e361f NULLS FIRST)\n                           ir_pct_rnk_pctl,\n                        RANK()\n                           OVER (PARTITION BY 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.051677fa81b6acaecd067857b3e57ecd, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.959d7ed0152ba33b5452be0366845ae2, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.31953ff0f9caf854f33c049172c5937b, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.5d05d543e266512d1fd2ec6a83eece24, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.6b7c0883b4db52123315459187a26b49\n                                 ORDER BY 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.97d0b7dfcea2ede9da55f1198a57885e3829969834280a39721b32c836afdff1 DESC NULLS LAST)\n                           grs_sls_extnd_rnk,\n                        PERCENT_RANK()\n                           OVER (PARTITION BY 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.051677fa81b6acaecd067857b3e57ecd, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.959d7ed0152ba33b5452be0366845ae2, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.31953ff0f9caf854f33c049172c5937b, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.5d05d543e266512d1fd2ec6a83eece24, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.6b7c0883b4db52123315459187a26b49\n                                 ORDER BY 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.97d0b7dfcea2ede9da55f1198a57885e3829969834280a39721b32c836afdff1 NULLS FIRST)\n                           grs_sls_extnd_rnk_pctl,\n                        RANK()\n                           OVER (PARTITION BY 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.051677fa81b6acaecd067857b3e57ecd, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.959d7ed0152ba33b5452be0366845ae2, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.31953ff0f9caf854f33c049172c5937b, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.5d05d543e266512d1fd2ec6a83eece24, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.6b7c0883b4db52123315459187a26b49\n                                 ORDER BY 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.3c3217b237b0cc8aea934e93e6932ee6760ee94864352b2fd143cb660266e5ba DESC NULLS LAST)\n                           unfrm_qty_ship_rnk,\n                        PERCENT_RANK()\n                           OVER (PARTITION BY 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.051677fa81b6acaecd067857b3e57ecd, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.959d7ed0152ba33b5452be0366845ae2, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.31953ff0f9caf854f33c049172c5937b, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.5d05d543e266512d1fd2ec6a83eece24, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.6b7c0883b4db52123315459187a26b49\n                                 ORDER BY 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.3c3217b237b0cc8aea934e93e6932ee6760ee94864352b2fd143cb660266e5ba NULLS FIRST)\n                           unfrm_qty_ship_rnk_pctl,\n                        RANK()\n                           OVER (PARTITION BY 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.051677fa81b6acaecd067857b3e57ecd, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.959d7ed0152ba33b5452be0366845ae2, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.31953ff0f9caf854f33c049172c5937b, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.5d05d543e266512d1fd2ec6a83eece24, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.6b7c0883b4db52123315459187a26b49\n                                 ORDER BY 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.fd189c6b966ffe8b9685896d114aa5af DESC NULLS LAST)\n                           grs_tgp_rnk,\n                        PERCENT_RANK()\n                           OVER (PARTITION BY 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.051677fa81b6acaecd067857b3e57ecd, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.959d7ed0152ba33b5452be0366845ae2, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.31953ff0f9caf854f33c049172c5937b, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.5d05d543e266512d1fd2ec6a83eece24, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.6b7c0883b4db52123315459187a26b49\n                                 ORDER BY 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.fd189c6b966ffe8b9685896d114aa5af NULLS FIRST)\n                           grs_tgp_rnk_pctl,\n                        RANK()\n                           OVER (PARTITION BY 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.051677fa81b6acaecd067857b3e57ecd, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.959d7ed0152ba33b5452be0366845ae2, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.31953ff0f9caf854f33c049172c5937b, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.5d05d543e266512d1fd2ec6a83eece24, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.6b7c0883b4db52123315459187a26b49\n                                 ORDER BY 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.6a6aeba4661d228696adbafac058a9c9 DESC NULLS LAST)\n                           net_acct_rnk,\n                        PERCENT_RANK()\n                           OVER (PARTITION BY 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.051677fa81b6acaecd067857b3e57ecd, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.959d7ed0152ba33b5452be0366845ae2, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.31953ff0f9caf854f33c049172c5937b, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.5d05d543e266512d1fd2ec6a83eece24, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.6b7c0883b4db52123315459187a26b49\n                                 ORDER BY 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.6a6aeba4661d228696adbafac058a9c9 NULLS FIRST)\n                           net_acct_rnk_pctl,\n                        RANK()\n                           OVER (PARTITION BY 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.051677fa81b6acaecd067857b3e57ecd, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.959d7ed0152ba33b5452be0366845ae2, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.31953ff0f9caf854f33c049172c5937b, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.5d05d543e266512d1fd2ec6a83eece24, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.6b7c0883b4db52123315459187a26b49\n                                 ORDER BY 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.f0c88babacd81e10e30eec256b72179754cfce5485b7fc71f014d21387b577f0 DESC NULLS LAST)\n                           net_acct_per_tm_rnk,\n                        PERCENT_RANK()\n                           OVER (PARTITION BY 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.051677fa81b6acaecd067857b3e57ecd, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.959d7ed0152ba33b5452be0366845ae2, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.31953ff0f9caf854f33c049172c5937b, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.5d05d543e266512d1fd2ec6a83eece24, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.6b7c0883b4db52123315459187a26b49\n                                 ORDER BY 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.f0c88babacd81e10e30eec256b72179754cfce5485b7fc71f014d21387b577f0 NULLS FIRST)\n                           net_acct_per_tm_rnk_pctl,\n                        RANK()\n                           OVER (PARTITION BY 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.051677fa81b6acaecd067857b3e57ecd, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.959d7ed0152ba33b5452be0366845ae2, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.31953ff0f9caf854f33c049172c5937b, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.5d05d543e266512d1fd2ec6a83eece24, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.6b7c0883b4db52123315459187a26b49\n                                 ORDER BY 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.fe00e43d17fcccf45bd8fd1f60976e3b760ee94864352b2fd143cb660266e5ba DESC NULLS LAST)\n                           lines_per_drop_rnk,\n                        PERCENT_RANK()\n                           OVER (PARTITION BY 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.051677fa81b6acaecd067857b3e57ecd, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.959d7ed0152ba33b5452be0366845ae2, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.31953ff0f9caf854f33c049172c5937b, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.5d05d543e266512d1fd2ec6a83eece24, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.6b7c0883b4db52123315459187a26b49\n                                 ORDER BY 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.fe00e43d17fcccf45bd8fd1f60976e3b760ee94864352b2fd143cb660266e5ba NULLS FIRST)\n                           lines_per_drop_rnk_pctl,\n                        RANK()\n                           OVER (PARTITION BY 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.051677fa81b6acaecd067857b3e57ecd, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.959d7ed0152ba33b5452be0366845ae2, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.31953ff0f9caf854f33c049172c5937b, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.5d05d543e266512d1fd2ec6a83eece24, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.6b7c0883b4db52123315459187a26b49\n                                 ORDER BY 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.ce3016f9cfb6897930b0022d4a9ebaba DESC NULLS LAST)\n                           eb_pct_rnk,\n                        PERCENT_RANK()\n                           OVER (PARTITION BY 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.051677fa81b6acaecd067857b3e57ecd, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.959d7ed0152ba33b5452be0366845ae2, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.31953ff0f9caf854f33c049172c5937b, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.5d05d543e266512d1fd2ec6a83eece24, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.6b7c0883b4db52123315459187a26b49\n                                 ORDER BY 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.ce3016f9cfb6897930b0022d4a9ebaba NULLS FIRST)\n                           eb_pct_rnk_pctl\n                   FROM 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2 rnk, 57eef8c3d4a13d22f0b40f9742e7b281.c34b3b41e7bd0c01dfd7c75a49970163 org\n                  WHERE 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.051677fa81b6acaecd067857b3e57ecd = fbedbc120a0a5f64565a8fd10ef09617.051677fa81b6acaecd067857b3e57ecd\n                    AND 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.959d7ed0152ba33b5452be0366845ae2 = fbedbc120a0a5f64565a8fd10ef09617.959d7ed0152ba33b5452be0366845ae2\n                    AND 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.940d2cf399f647883b423bdc838abc48 = fbedbc120a0a5f64565a8fd10ef09617.940d2cf399f647883b423bdc838abc48\n                    AND ((57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.31953ff0f9caf854f33c049172c5937b <= 3\n                      AND fbedbc120a0a5f64565a8fd10ef09617.5476018fbbb9dba5f160875a3669958f = 'Y')\n                      OR (57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.31953ff0f9caf854f33c049172c5937b >= 4\n                      AND fbedbc120a0a5f64565a8fd10ef09617.eda676abf3186dcacecd70aa0e501730 = 'Y'))\n                    AND 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.83a522d7deb767fb152402f1efe33872 = 'NATIONAL'\n                    AND fbedbc120a0a5f64565a8fd10ef09617.051677fa81b6acaecd067857b3e57ecd = g_fisc_yr_mth);\n\n      TYPE t_mth_nat_rnk IS TABLE OF c_mth_nat_rnk%ROWTYPE;\n\n      r_mth_nat_rnk   t_mth_nat_rnk;\n\n      \n      CURSOR c_ytd_div_rnk IS\n         SELECT fisc_yr_mth,\n                org_lvl,\n                org_val,\n                rnk_ctgry,\n                cust_clsfctn,\n                rnk_by,\n                ir_pct_ytd_rnk,\n                grs_sls_extnd_ytd_rnk,\n                unfrm_qty_ship_ytd_rnk,\n                grs_tgp_ytd_rnk,\n                ir_pct_ytd_rnk_pctl,\n                grs_sls_extnd_ytd_rnk_pctl,\n                unfrm_qty_ship_ytd_rnk_pctl,\n                grs_tgp_ytd_rnk_pctl,\n                RANK()\n                   OVER (PARTITION BY fisc_yr_mth, org_lvl, rnk_ctgry, cust_clsfctn, rnk_by, grp_cd_or_brnch_cd\n                         ORDER BY unfrm_qty_ship_ytd_rnk + grs_tgp_ytd_rnk + ir_pct_ytd_rnk)\n                   overall_ytd_rnk,\n                PERCENT_RANK()\n                   OVER (PARTITION BY fisc_yr_mth, org_lvl, rnk_ctgry, cust_clsfctn, rnk_by, grp_cd_or_brnch_cd\n                         ORDER BY unfrm_qty_ship_ytd_rnk + grs_tgp_ytd_rnk + ir_pct_ytd_rnk DESC)\n                   overall_ytd_rnk_pctl\n           FROM (SELECT 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.051677fa81b6acaecd067857b3e57ecd,\n                        57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.959d7ed0152ba33b5452be0366845ae2,\n                        57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.940d2cf399f647883b423bdc838abc48,\n                        57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.31953ff0f9caf854f33c049172c5937b,\n                        57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.5d05d543e266512d1fd2ec6a83eece24,\n                        57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.6b7c0883b4db52123315459187a26b49,\n                        fbedbc120a0a5f64565a8fd10ef09617.ef475f1eb4af657bf72d87e81656e990feb16ec175a739c84b79e5d396593a57,\n                        RANK()\n                           OVER (PARTITION BY 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.051677fa81b6acaecd067857b3e57ecd, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.959d7ed0152ba33b5452be0366845ae2, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.31953ff0f9caf854f33c049172c5937b, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.5d05d543e266512d1fd2ec6a83eece24, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.6b7c0883b4db52123315459187a26b49, fbedbc120a0a5f64565a8fd10ef09617.ef475f1eb4af657bf72d87e81656e990feb16ec175a739c84b79e5d396593a57\n                                 ORDER BY 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.60f6e21732722471e0c3aa442c0b51dc DESC NULLS LAST)\n                           ir_pct_ytd_rnk,\n                        PERCENT_RANK()\n                           OVER (PARTITION BY 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.051677fa81b6acaecd067857b3e57ecd, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.959d7ed0152ba33b5452be0366845ae2, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.31953ff0f9caf854f33c049172c5937b, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.5d05d543e266512d1fd2ec6a83eece24, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.6b7c0883b4db52123315459187a26b49, fbedbc120a0a5f64565a8fd10ef09617.ef475f1eb4af657bf72d87e81656e990feb16ec175a739c84b79e5d396593a57\n                                 ORDER BY 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.60f6e21732722471e0c3aa442c0b51dc NULLS FIRST)\n                           ir_pct_ytd_rnk_pctl,\n                        RANK()\n                           OVER (PARTITION BY 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.051677fa81b6acaecd067857b3e57ecd, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.959d7ed0152ba33b5452be0366845ae2, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.31953ff0f9caf854f33c049172c5937b, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.5d05d543e266512d1fd2ec6a83eece24, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.6b7c0883b4db52123315459187a26b49, fbedbc120a0a5f64565a8fd10ef09617.ef475f1eb4af657bf72d87e81656e990feb16ec175a739c84b79e5d396593a57\n                                 ORDER BY 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.5be717b469b9cc32bb6cea74112db38ac97717101e5ade058bac8c8d50eb5364 DESC NULLS LAST)\n                           grs_sls_extnd_ytd_rnk,\n                        PERCENT_RANK()\n                           OVER (PARTITION BY 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.051677fa81b6acaecd067857b3e57ecd, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.959d7ed0152ba33b5452be0366845ae2, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.31953ff0f9caf854f33c049172c5937b, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.5d05d543e266512d1fd2ec6a83eece24, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.6b7c0883b4db52123315459187a26b49, fbedbc120a0a5f64565a8fd10ef09617.ef475f1eb4af657bf72d87e81656e990feb16ec175a739c84b79e5d396593a57\n                                 ORDER BY 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.5be717b469b9cc32bb6cea74112db38ac97717101e5ade058bac8c8d50eb5364 NULLS FIRST)\n                           grs_sls_extnd_ytd_rnk_pctl,\n                        RANK()\n                           OVER (PARTITION BY 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.051677fa81b6acaecd067857b3e57ecd, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.959d7ed0152ba33b5452be0366845ae2, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.31953ff0f9caf854f33c049172c5937b, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.5d05d543e266512d1fd2ec6a83eece24, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.6b7c0883b4db52123315459187a26b49, fbedbc120a0a5f64565a8fd10ef09617.ef475f1eb4af657bf72d87e81656e990feb16ec175a739c84b79e5d396593a57\n                                 ORDER BY 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.e6eacb08cfb1528f520daba6c77bfbbb5082620ccee91c174294c9aaeb197b93 DESC NULLS LAST)\n                           unfrm_qty_ship_ytd_rnk,\n                        PERCENT_RANK()\n                           OVER (PARTITION BY 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.051677fa81b6acaecd067857b3e57ecd, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.959d7ed0152ba33b5452be0366845ae2, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.31953ff0f9caf854f33c049172c5937b, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.5d05d543e266512d1fd2ec6a83eece24, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.6b7c0883b4db52123315459187a26b49, fbedbc120a0a5f64565a8fd10ef09617.ef475f1eb4af657bf72d87e81656e990feb16ec175a739c84b79e5d396593a57\n                                 ORDER BY 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.e6eacb08cfb1528f520daba6c77bfbbb5082620ccee91c174294c9aaeb197b93 NULLS FIRST)\n                           unfrm_qty_ship_ytd_rnk_pctl,\n                        RANK()\n                           OVER (PARTITION BY 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.051677fa81b6acaecd067857b3e57ecd, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.959d7ed0152ba33b5452be0366845ae2, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.31953ff0f9caf854f33c049172c5937b, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.5d05d543e266512d1fd2ec6a83eece24, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.6b7c0883b4db52123315459187a26b49, fbedbc120a0a5f64565a8fd10ef09617.ef475f1eb4af657bf72d87e81656e990feb16ec175a739c84b79e5d396593a57\n                                 ORDER BY 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.39e09b7556dd8f4b602616386ec7e4bd DESC NULLS LAST)\n                           grs_tgp_ytd_rnk,\n                        PERCENT_RANK()\n                           OVER (PARTITION BY 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.051677fa81b6acaecd067857b3e57ecd, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.959d7ed0152ba33b5452be0366845ae2, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.31953ff0f9caf854f33c049172c5937b, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.5d05d543e266512d1fd2ec6a83eece24, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.6b7c0883b4db52123315459187a26b49, fbedbc120a0a5f64565a8fd10ef09617.ef475f1eb4af657bf72d87e81656e990feb16ec175a739c84b79e5d396593a57\n                                 ORDER BY 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.39e09b7556dd8f4b602616386ec7e4bd NULLS FIRST)\n                           grs_tgp_ytd_rnk_pctl\n                   FROM 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2 rnk, 57eef8c3d4a13d22f0b40f9742e7b281.c34b3b41e7bd0c01dfd7c75a49970163 org\n                  WHERE 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.051677fa81b6acaecd067857b3e57ecd = fbedbc120a0a5f64565a8fd10ef09617.051677fa81b6acaecd067857b3e57ecd\n                    AND 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.959d7ed0152ba33b5452be0366845ae2 = fbedbc120a0a5f64565a8fd10ef09617.959d7ed0152ba33b5452be0366845ae2\n                    AND 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.940d2cf399f647883b423bdc838abc48 = fbedbc120a0a5f64565a8fd10ef09617.940d2cf399f647883b423bdc838abc48\n                    AND ((57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.31953ff0f9caf854f33c049172c5937b <= 3\n                      AND fbedbc120a0a5f64565a8fd10ef09617.4db59846821e5f3a7db740c32f8cca18 = 'Y')\n                      OR (57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.31953ff0f9caf854f33c049172c5937b >= 4\n                      AND fbedbc120a0a5f64565a8fd10ef09617.75baa75c0b184dd5e1aa3fa19462dd65 = 'Y'))\n                    AND 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.83a522d7deb767fb152402f1efe33872 = 'DIVISION'\n                    AND fbedbc120a0a5f64565a8fd10ef09617.051677fa81b6acaecd067857b3e57ecd = g_fisc_yr_mth);\n\n      TYPE t_ytd_div_rnk IS TABLE OF c_ytd_div_rnk%ROWTYPE;\n\n      r_ytd_div_rnk   t_ytd_div_rnk;\n\n      \n      CURSOR c_ytd_nat_rnk IS\n         SELECT fisc_yr_mth,\n                org_lvl,\n                org_val,\n                rnk_ctgry,\n                cust_clsfctn,\n                rnk_by,\n                ir_pct_ytd_rnk,\n                ir_pct_ytd_rnk_pctl,\n                grs_sls_extnd_ytd_rnk,\n                grs_sls_extnd_ytd_rnk_pctl,\n                unfrm_qty_ship_ytd_rnk,\n                unfrm_qty_ship_ytd_rnk_pctl,\n                grs_tgp_ytd_rnk,\n                grs_tgp_ytd_rnk_pctl,\n                RANK()\n                   OVER (PARTITION BY fisc_yr_mth, org_lvl, rnk_ctgry, cust_clsfctn, rnk_by\n                         ORDER BY unfrm_qty_ship_ytd_rnk + grs_tgp_ytd_rnk + ir_pct_ytd_rnk)\n                   overall_ytd_rnk,\n                PERCENT_RANK()\n                   OVER (PARTITION BY fisc_yr_mth, org_lvl, rnk_ctgry, cust_clsfctn, rnk_by\n                         ORDER BY unfrm_qty_ship_ytd_rnk + grs_tgp_ytd_rnk + ir_pct_ytd_rnk DESC)\n                   overall_ytd_rnk_pctl\n           FROM (SELECT 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.051677fa81b6acaecd067857b3e57ecd,\n                        57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.959d7ed0152ba33b5452be0366845ae2,\n                        57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.940d2cf399f647883b423bdc838abc48,\n                        57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.31953ff0f9caf854f33c049172c5937b,\n                        57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.5d05d543e266512d1fd2ec6a83eece24,\n                        57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.6b7c0883b4db52123315459187a26b49,\n                        RANK()\n                           OVER (PARTITION BY 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.051677fa81b6acaecd067857b3e57ecd, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.959d7ed0152ba33b5452be0366845ae2, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.31953ff0f9caf854f33c049172c5937b, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.5d05d543e266512d1fd2ec6a83eece24, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.6b7c0883b4db52123315459187a26b49\n                                 ORDER BY 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.60f6e21732722471e0c3aa442c0b51dc DESC NULLS LAST)\n                           ir_pct_ytd_rnk,\n                        PERCENT_RANK()\n                           OVER (PARTITION BY 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.051677fa81b6acaecd067857b3e57ecd, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.959d7ed0152ba33b5452be0366845ae2, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.31953ff0f9caf854f33c049172c5937b, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.5d05d543e266512d1fd2ec6a83eece24, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.6b7c0883b4db52123315459187a26b49\n                                 ORDER BY 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.60f6e21732722471e0c3aa442c0b51dc NULLS FIRST)\n                           ir_pct_ytd_rnk_pctl,\n                        RANK()\n                           OVER (PARTITION BY 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.051677fa81b6acaecd067857b3e57ecd, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.959d7ed0152ba33b5452be0366845ae2, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.31953ff0f9caf854f33c049172c5937b, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.5d05d543e266512d1fd2ec6a83eece24, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.6b7c0883b4db52123315459187a26b49\n                                 ORDER BY 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.5be717b469b9cc32bb6cea74112db38ac97717101e5ade058bac8c8d50eb5364 DESC NULLS LAST)\n                           grs_sls_extnd_ytd_rnk,\n                        PERCENT_RANK()\n                           OVER (PARTITION BY 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.051677fa81b6acaecd067857b3e57ecd, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.959d7ed0152ba33b5452be0366845ae2, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.31953ff0f9caf854f33c049172c5937b, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.5d05d543e266512d1fd2ec6a83eece24, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.6b7c0883b4db52123315459187a26b49\n                                 ORDER BY 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.5be717b469b9cc32bb6cea74112db38ac97717101e5ade058bac8c8d50eb5364 NULLS FIRST)\n                           grs_sls_extnd_ytd_rnk_pctl,\n                        RANK()\n                           OVER (PARTITION BY 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.051677fa81b6acaecd067857b3e57ecd, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.959d7ed0152ba33b5452be0366845ae2, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.31953ff0f9caf854f33c049172c5937b, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.5d05d543e266512d1fd2ec6a83eece24, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.6b7c0883b4db52123315459187a26b49\n                                 ORDER BY 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.e6eacb08cfb1528f520daba6c77bfbbb5082620ccee91c174294c9aaeb197b93 DESC NULLS LAST)\n                           unfrm_qty_ship_ytd_rnk,\n                        PERCENT_RANK()\n                           OVER (PARTITION BY 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.051677fa81b6acaecd067857b3e57ecd, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.959d7ed0152ba33b5452be0366845ae2, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.31953ff0f9caf854f33c049172c5937b, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.5d05d543e266512d1fd2ec6a83eece24, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.6b7c0883b4db52123315459187a26b49\n                                 ORDER BY 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.e6eacb08cfb1528f520daba6c77bfbbb5082620ccee91c174294c9aaeb197b93 NULLS FIRST)\n                           unfrm_qty_ship_ytd_rnk_pctl,\n                        RANK()\n                           OVER (PARTITION BY 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.051677fa81b6acaecd067857b3e57ecd, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.959d7ed0152ba33b5452be0366845ae2, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.31953ff0f9caf854f33c049172c5937b, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.5d05d543e266512d1fd2ec6a83eece24, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.6b7c0883b4db52123315459187a26b49\n                                 ORDER BY 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.39e09b7556dd8f4b602616386ec7e4bd DESC NULLS LAST)\n                           grs_tgp_ytd_rnk,\n                        PERCENT_RANK()\n                           OVER (PARTITION BY 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.051677fa81b6acaecd067857b3e57ecd, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.959d7ed0152ba33b5452be0366845ae2, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.31953ff0f9caf854f33c049172c5937b, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.5d05d543e266512d1fd2ec6a83eece24, 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.6b7c0883b4db52123315459187a26b49\n                                 ORDER BY 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.39e09b7556dd8f4b602616386ec7e4bd NULLS FIRST)\n                           grs_tgp_ytd_rnk_pctl\n                   FROM 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2 rnk, 57eef8c3d4a13d22f0b40f9742e7b281.c34b3b41e7bd0c01dfd7c75a49970163 org\n                  WHERE 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.051677fa81b6acaecd067857b3e57ecd = fbedbc120a0a5f64565a8fd10ef09617.051677fa81b6acaecd067857b3e57ecd\n                    AND 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.959d7ed0152ba33b5452be0366845ae2 = fbedbc120a0a5f64565a8fd10ef09617.959d7ed0152ba33b5452be0366845ae2\n                    AND 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.940d2cf399f647883b423bdc838abc48 = fbedbc120a0a5f64565a8fd10ef09617.940d2cf399f647883b423bdc838abc48\n                    AND ((57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.31953ff0f9caf854f33c049172c5937b <= 3\n                      AND fbedbc120a0a5f64565a8fd10ef09617.4db59846821e5f3a7db740c32f8cca18 = 'Y')\n                      OR (57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.31953ff0f9caf854f33c049172c5937b >= 4\n                      AND fbedbc120a0a5f64565a8fd10ef09617.75baa75c0b184dd5e1aa3fa19462dd65 = 'Y'))\n                    AND 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2.83a522d7deb767fb152402f1efe33872 = 'NATIONAL'\n                    AND fbedbc120a0a5f64565a8fd10ef09617.051677fa81b6acaecd067857b3e57ecd = g_fisc_yr_mth);\n\n      TYPE t_ytd_nat_rnk IS TABLE OF c_ytd_nat_rnk%ROWTYPE;\n\n      r_ytd_nat_rnk   t_ytd_nat_rnk;\n   BEGIN\n      DBMS_OUTPUT.put_line('Updating ranks in SLS_RNK_MTH_TMP');\n\n      \n      OPEN c_mth_div_rnk;\n\n      LOOP\n         EXIT WHEN c_mth_div_rnk%NOTFOUND;\n\n         FETCH c_mth_div_rnk\n         BULK COLLECT INTO r_mth_div_rnk\n         LIMIT 50000;\n\n         FORALL i IN 1 .. bd49d2206a87f611333242e24d9119ca.1e21de3bb543a206edf22b18c23a0c49()\n            UPDATE 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2\n               SET overall_rnk                = r_mth_div_rnk(i).overall_rnk,\n                   overall_rnk_pctl           = r_mth_div_rnk(i).overall_rnk_pctl * 100,\n                   ec_pct_rnk                 = r_mth_div_rnk(i).ec_pct_rnk,\n                   ec_pct_rnk_pctl            = r_mth_div_rnk(i).ec_pct_rnk_pctl * 100,\n                   ir_pct_rnk                 = r_mth_div_rnk(i).ir_pct_rnk,\n                   ir_pct_pctl                = r_mth_div_rnk(i).ir_pct_rnk_pctl * 100,\n                   grs_sls_extnd_rnk          = r_mth_div_rnk(i).grs_sls_extnd_rnk,\n                   grs_sls_extnd_rnk_pctl     = r_mth_div_rnk(i).grs_sls_extnd_rnk_pctl * 100,\n                   unfrm_qty_ship_rnk         = r_mth_div_rnk(i).unfrm_qty_ship_rnk,\n                   unfrm_qty_ship_rnk_pctl    = r_mth_div_rnk(i).unfrm_qty_ship_rnk_pctl * 100,\n                   grs_tgp_rnk                = r_mth_div_rnk(i).grs_tgp_rnk,\n                   grs_tgp_rnk_pctl           = r_mth_div_rnk(i).grs_tgp_rnk_pctl * 100,\n                   net_acct_rnk               = r_mth_div_rnk(i).net_acct_rnk,\n                   net_acct_rnk_pctl          = r_mth_div_rnk(i).net_acct_rnk_pctl * 100,\n                   net_acct_per_tm_rnk        = r_mth_div_rnk(i).net_acct_per_tm_rnk,\n                   net_acct_per_tm_rnk_pctl   = r_mth_div_rnk(i).net_acct_per_tm_rnk_pctl * 100,\n                   lines_per_drop_rnk         = r_mth_div_rnk(i).lines_per_drop_rnk,\n                   lines_per_drop_rnk_pctl    = r_mth_div_rnk(i).lines_per_drop_rnk_pctl * 100,\n                   eb_pct_rnk                 = r_mth_div_rnk(i).eb_pct_rnk,\n                   eb_pct_rnk_pctl            = r_mth_div_rnk(i).eb_pct_rnk_pctl * 100\n             WHERE fisc_yr_mth = r_mth_div_rnk(i).fisc_yr_mth\n               AND org_lvl = r_mth_div_rnk(i).org_lvl\n               AND org_val = r_mth_div_rnk(i).org_val\n               AND rnk_ctgry = r_mth_div_rnk(i).rnk_ctgry\n               AND cust_clsfctn = r_mth_div_rnk(i).cust_clsfctn\n               AND rnk_by = r_mth_div_rnk(i).rnk_by\n               AND rnk_lvl = 'DIVISION';\n      END LOOP;\n\n      CLOSE c_mth_div_rnk;\n\n      COMMIT;\n\n      \n      OPEN c_mth_nat_rnk;\n\n      LOOP\n         EXIT WHEN c_mth_nat_rnk%NOTFOUND;\n\n         FETCH c_mth_nat_rnk\n         BULK COLLECT INTO r_mth_nat_rnk\n         LIMIT 50000;\n\n         FORALL i IN 1 .. 28ce4133a4a4e0b40f8b3d8b9f06800c.1e21de3bb543a206edf22b18c23a0c49()\n            UPDATE 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2\n               SET overall_rnk                = r_mth_nat_rnk(i).overall_rnk,\n                   overall_rnk_pctl           = r_mth_nat_rnk(i).overall_rnk_pctl * 100,\n                   ec_pct_rnk                 = r_mth_nat_rnk(i).ec_pct_rnk,\n                   ec_pct_rnk_pctl            = r_mth_nat_rnk(i).ec_pct_rnk_pctl * 100,\n                   ir_pct_rnk                 = r_mth_nat_rnk(i).ir_pct_rnk,\n                   ir_pct_pctl                = r_mth_nat_rnk(i).ir_pct_rnk_pctl * 100,\n                   grs_sls_extnd_rnk          = r_mth_nat_rnk(i).grs_sls_extnd_rnk,\n                   grs_sls_extnd_rnk_pctl     = r_mth_nat_rnk(i).grs_sls_extnd_rnk_pctl * 100,\n                   unfrm_qty_ship_rnk         = r_mth_nat_rnk(i).unfrm_qty_ship_rnk,\n                   unfrm_qty_ship_rnk_pctl    = r_mth_nat_rnk(i).unfrm_qty_ship_rnk_pctl * 100,\n                   grs_tgp_rnk                = r_mth_nat_rnk(i).grs_tgp_rnk,\n                   grs_tgp_rnk_pctl           = r_mth_nat_rnk(i).grs_tgp_rnk_pctl * 100,\n                   net_acct_rnk               = r_mth_nat_rnk(i).net_acct_rnk,\n                   net_acct_rnk_pctl          = r_mth_nat_rnk(i).net_acct_rnk_pctl * 100,\n                   net_acct_per_tm_rnk        = r_mth_nat_rnk(i).net_acct_per_tm_rnk,\n                   net_acct_per_tm_rnk_pctl   = r_mth_nat_rnk(i).net_acct_per_tm_rnk_pctl * 100,\n                   lines_per_drop_rnk         = r_mth_nat_rnk(i).lines_per_drop_rnk,\n                   lines_per_drop_rnk_pctl    = r_mth_nat_rnk(i).lines_per_drop_rnk_pctl * 100,\n                   eb_pct_rnk                 = r_mth_nat_rnk(i).eb_pct_rnk,\n                   eb_pct_rnk_pctl            = r_mth_nat_rnk(i).eb_pct_rnk_pctl * 100\n             WHERE fisc_yr_mth = r_mth_nat_rnk(i).fisc_yr_mth\n               AND org_lvl = r_mth_nat_rnk(i).org_lvl\n               AND org_val = r_mth_nat_rnk(i).org_val\n               AND rnk_ctgry = r_mth_nat_rnk(i).rnk_ctgry\n               AND cust_clsfctn = r_mth_nat_rnk(i).cust_clsfctn\n               AND rnk_by = r_mth_nat_rnk(i).rnk_by\n               AND rnk_lvl = 'NATIONAL';\n      END LOOP;\n\n      CLOSE c_mth_nat_rnk;\n\n      COMMIT;\n\n      \n      OPEN c_ytd_div_rnk;\n\n      LOOP\n         EXIT WHEN c_ytd_div_rnk%NOTFOUND;\n\n         FETCH c_ytd_div_rnk\n         BULK COLLECT INTO r_ytd_div_rnk\n         LIMIT 50000;\n\n         FORALL i IN 1 .. 6a9f084e92c22cfdee005259f034c879.1e21de3bb543a206edf22b18c23a0c49()\n            UPDATE 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2\n               SET overall_ytd_rnk               = r_ytd_div_rnk(i).overall_ytd_rnk,\n                   overall_ytd_rnk_pctl          = r_ytd_div_rnk(i).overall_ytd_rnk_pctl * 100,\n                   ir_pct_ytd_rnk                = r_ytd_div_rnk(i).ir_pct_ytd_rnk,\n                   ir_pct_ytd_rnk_pctl           = r_ytd_div_rnk(i).ir_pct_ytd_rnk_pctl * 100,\n                   grs_sls_extnd_ytd_rnk         = r_ytd_div_rnk(i).grs_sls_extnd_ytd_rnk,\n                   grs_sls_extnd_ytd_rnk_pctl    = r_ytd_div_rnk(i).grs_sls_extnd_ytd_rnk_pctl * 100,\n                   unfrm_qty_ship_ytd_rnk        = r_ytd_div_rnk(i).unfrm_qty_ship_ytd_rnk,\n                   unfrm_qty_ship_ytd_rnk_pctl   = r_ytd_div_rnk(i).unfrm_qty_ship_ytd_rnk_pctl * 100,\n                   grs_tgp_ytd_rnk               = r_ytd_div_rnk(i).grs_tgp_ytd_rnk,\n                   grs_tgp_ytd_rnk_pctl          = r_ytd_div_rnk(i).grs_tgp_ytd_rnk_pctl * 100\n             WHERE fisc_yr_mth = r_ytd_div_rnk(i).fisc_yr_mth\n               AND org_lvl = r_ytd_div_rnk(i).org_lvl\n               AND org_val = r_ytd_div_rnk(i).org_val\n               AND rnk_ctgry = r_ytd_div_rnk(i).rnk_ctgry\n               AND cust_clsfctn = r_ytd_div_rnk(i).cust_clsfctn\n               AND rnk_by = r_ytd_div_rnk(i).rnk_by\n               AND rnk_lvl = 'DIVISION';\n      END LOOP;\n\n      CLOSE c_ytd_div_rnk;\n\n      COMMIT;\n\n      \n      OPEN c_ytd_nat_rnk;\n\n      LOOP\n         EXIT WHEN c_ytd_nat_rnk%NOTFOUND;\n\n         FETCH c_ytd_nat_rnk\n         BULK COLLECT INTO r_ytd_nat_rnk\n         LIMIT 50000;\n\n         FORALL i IN 1 .. 17e7c7059f72c74df2ca333f2e22d636.1e21de3bb543a206edf22b18c23a0c49()\n            UPDATE 57eef8c3d4a13d22f0b40f9742e7b281.cddf6fece7835761ba84541c5c973ce2\n               SET overall_ytd_rnk               = r_ytd_nat_rnk(i).overall_ytd_rnk,\n                   overall_ytd_rnk_pctl          = r_ytd_nat_rnk(i).overall_ytd_rnk_pctl * 100,\n                   ir_pct_ytd_rnk                = r_ytd_nat_rnk(i).ir_pct_ytd_rnk,\n                   ir_pct_ytd_rnk_pctl           = r_ytd_nat_rnk(i).ir_pct_ytd_rnk_pctl * 100,\n                   grs_sls_extnd_ytd_rnk         = r_ytd_nat_rnk(i).grs_sls_extnd_ytd_rnk,\n                   grs_sls_extnd_ytd_rnk_pctl    = r_ytd_nat_rnk(i).grs_sls_extnd_ytd_rnk_pctl * 100,\n                   unfrm_qty_ship_ytd_rnk        = r_ytd_nat_rnk(i).unfrm_qty_ship_ytd_rnk,\n                   unfrm_qty_ship_ytd_rnk_pctl   = r_ytd_nat_rnk(i).unfrm_qty_ship_ytd_rnk_pctl * 100,\n                   grs_tgp_ytd_rnk               = r_ytd_nat_rnk(i).grs_tgp_ytd_rnk,\n                   grs_tgp_ytd_rnk_pctl          = r_ytd_nat_rnk(i).grs_tgp_ytd_rnk_pctl * 100\n             WHERE fisc_yr_mth = r_ytd_nat_rnk(i).fisc_yr_mth\n               AND org_lvl = r_ytd_nat_rnk(i).org_lvl\n               AND org_val = r_ytd_nat_rnk(i).org_val\n               AND rnk_ctgry = r_ytd_nat_rnk(i).rnk_ctgry\n               AND cust_clsfctn = r_ytd_nat_rnk(i).cust_clsfctn\n               AND rnk_by = r_ytd_nat_rnk(i).rnk_by\n               AND rnk_lvl = 'NATIONAL';\n      END LOOP;\n\n      CLOSE c_ytd_nat_rnk;\n\n      COMMIT;\n   END upd_sls_rnk_mth_rnk;\n\n   \n\n   PROCEDURE upd_sls_rnk_org_nm IS\n      \n      CURSOR c_rsm_nm IS\n         SELECT rgn_sls_mgr_id, rgn_sls_mgr_nm_id\n           FROM (  SELECT NVL(57eef8c3d4a13d22f0b40f9742e7b281.d73db8611de2680d7b0b5feaa04810c2.9c0e3ca45e9e6d5e37b7b267abe94ef8, 'UNKNOWN') rgn_sls_mgr_id, MAX(NVL(57eef8c3d4a13d22f0b40f9742e7b281.d73db8611de2680d7b0b5feaa04810c2.dfb05e30cbe9e2770e3cd8540072f6f60ca5fb119e004e3dd9cc2be01757c595, 'UNKNOWN' || ' (' || NVL(57eef8c3d4a13d22f0b40f9742e7b281.d73db8611de2680d7b0b5feaa04810c2.9c0e3ca45e9e6d5e37b7b267abe94ef8, 'UNKNOWN') || ')')) rgn_sls_mgr_nm_id\n                     FROM 57eef8c3d4a13d22f0b40f9742e7b281.d73db8611de2680d7b0b5feaa04810c2 cc, 57eef8c3d4a13d22f0b40f9742e7b281.7cad4bed0267ab37956f1fcccb769b24 d\n                    WHERE 57eef8c3d4a13d22f0b40f9742e7b281.d73db8611de2680d7b0b5feaa04810c2.5a8103ceb3eda727eed8d3dbc244a027 = 57eef8c3d4a13d22f0b40f9742e7b281.7cad4bed0267ab37956f1fcccb769b24.5a8103ceb3eda727eed8d3dbc244a027\n                      AND 57eef8c3d4a13d22f0b40f9742e7b281.7cad4bed0267ab37956f1fcccb769b24.d5888bb74952b9abf72c4e89988d3f67 = 'USF'\n                      AND 57eef8c3d4a13d22f0b40f9742e7b281.7cad4bed0267ab37956f1fcccb769b24.0cdc126b1c7da4de6df00b51a8cfda85 = 1\n                      AND 57eef8c3d4a13d22f0b40f9742e7b281.7cad4bed0267ab37956f1fcccb769b24.fcd5fdac42a84c4fcc9e9a0c60fc5200 IS NULL\n                 GROUP BY NVL(57eef8c3d4a13d22f0b40f9742e7b281.d73db8611de2680d7b0b5feaa04810c2.9c0e3ca45e9e6d5e37b7b267abe94ef8, 'UNKNOWN')) cust\n          WHERE EXISTS (SELECT 'X'\n                          FROM 57eef8c3d4a13d22f0b40f9742e7b281.6b55fd660644c66096a320cc4f099d8a\n                         WHERE fisc_yr_mth < g_fisc_yr_mth\n                           AND rgn_sls_mgr_id = 7c2ad16aa31e676c2527f1e9d6611b65.9c0e3ca45e9e6d5e37b7b267abe94ef8\n                           AND NVL(rgn_sls_mgr_nm_id, '-999') <> 7c2ad16aa31e676c2527f1e9d6611b65.dfb05e30cbe9e2770e3cd8540072f6f60ca5fb119e004e3dd9cc2be01757c595);\n\n      TYPE t_rsm_nm IS TABLE OF c_rsm_nm%ROWTYPE;\n\n      r_rsm_nm       t_rsm_nm;\n\n      \n      CURSOR c_rsm_nm_tmp IS\n         SELECT rgn_sls_mgr_id, rgn_sls_mgr_nm_id\n           FROM (  SELECT NVL(57eef8c3d4a13d22f0b40f9742e7b281.d73db8611de2680d7b0b5feaa04810c2.9c0e3ca45e9e6d5e37b7b267abe94ef8, 'UNKNOWN') rgn_sls_mgr_id, MAX(NVL(57eef8c3d4a13d22f0b40f9742e7b281.d73db8611de2680d7b0b5feaa04810c2.dfb05e30cbe9e2770e3cd8540072f6f60ca5fb119e004e3dd9cc2be01757c595, 'UNKNOWN' || ' (' || NVL(57eef8c3d4a13d22f0b40f9742e7b281.d73db8611de2680d7b0b5feaa04810c2.9c0e3ca45e9e6d5e37b7b267abe94ef8, 'UNKNOWN') || ')')) rgn_sls_mgr_nm_id\n                     FROM 57eef8c3d4a13d22f0b40f9742e7b281.d73db8611de2680d7b0b5feaa04810c2 cc, 57eef8c3d4a13d22f0b40f9742e7b281.7cad4bed0267ab37956f1fcccb769b24 d\n                    WHERE 57eef8c3d4a13d22f0b40f9742e7b281.d73db8611de2680d7b0b5feaa04810c2.5a8103ceb3eda727eed8d3dbc244a027 = 57eef8c3d4a13d22f0b40f9742e7b281.7cad4bed0267ab37956f1fcccb769b24.5a8103ceb3eda727eed8d3dbc244a027\n                      AND 57eef8c3d4a13d22f0b40f9742e7b281.7cad4bed0267ab37956f1fcccb769b24.d5888bb74952b9abf72c4e89988d3f67 = 'USF'\n                      AND 57eef8c3d4a13d22f0b40f9742e7b281.7cad4bed0267ab37956f1fcccb769b24.0cdc126b1c7da4de6df00b51a8cfda85 = 1\n                      AND 57eef8c3d4a13d22f0b40f9742e7b281.7cad4bed0267ab37956f1fcccb769b24.fcd5fdac42a84c4fcc9e9a0c60fc5200 IS NULL\n                 GROUP BY NVL(57eef8c3d4a13d22f0b40f9742e7b281.d73db8611de2680d7b0b5feaa04810c2.9c0e3ca45e9e6d5e37b7b267abe94ef8, 'UNKNOWN')) cust\n          WHERE EXISTS (SELECT 'X'\n                          FROM 57eef8c3d4a13d22f0b40f9742e7b281.c34b3b41e7bd0c01dfd7c75a49970163\n                         WHERE rgn_sls_mgr_id = 7c2ad16aa31e676c2527f1e9d6611b65.9c0e3ca45e9e6d5e37b7b267abe94ef8);\n\n      TYPE t_rsm_nm_tmp IS TABLE OF c_rsm_nm_tmp%ROWTYPE;\n\n      r_rsm_nm_tmp   t_rsm_nm_tmp;\n\n      \n      CURSOR c_dsm_nm IS\n         SELECT dstrct_sls_mgr_id, dstrct_sls_mgr_nm_id\n           FROM (  SELECT NVL(57eef8c3d4a13d22f0b40f9742e7b281.d73db8611de2680d7b0b5feaa04810c2.f0e42dcd17c0461501b0d0a44a18ba0c0ca5fb119e004e3dd9cc2be01757c595, 'UNKNOWN') dstrct_sls_mgr_id, MAX(NVL(57eef8c3d4a13d22f0b40f9742e7b281.d73db8611de2680d7b0b5feaa04810c2.f16a829d04cb6259f150cb942d141767fbd59c10841470c4404f966cd6f2203e, 'UNKNOWN' || ' (' || NVL(57eef8c3d4a13d22f0b40f9742e7b281.d73db8611de2680d7b0b5feaa04810c2.f0e42dcd17c0461501b0d0a44a18ba0c0ca5fb119e004e3dd9cc2be01757c595, 'UNKNOWN') || ')')) dstrct_sls_mgr_nm_id\n                     FROM 57eef8c3d4a13d22f0b40f9742e7b281.d73db8611de2680d7b0b5feaa04810c2 cc, 57eef8c3d4a13d22f0b40f9742e7b281.7cad4bed0267ab37956f1fcccb769b24 d\n                    WHERE 57eef8c3d4a13d22f0b40f9742e7b281.d73db8611de2680d7b0b5feaa04810c2.5a8103ceb3eda727eed8d3dbc244a027 = 57eef8c3d4a13d22f0b40f9742e7b281.7cad4bed0267ab37956f1fcccb769b24.5a8103ceb3eda727eed8d3dbc244a027\n                      AND 57eef8c3d4a13d22f0b40f9742e7b281.7cad4bed0267ab37956f1fcccb769b24.d5888bb74952b9abf72c4e89988d3f67 = 'USF'\n                      AND 57eef8c3d4a13d22f0b40f9742e7b281.7cad4bed0267ab37956f1fcccb769b24.0cdc126b1c7da4de6df00b51a8cfda85 = 1\n                      AND 57eef8c3d4a13d22f0b40f9742e7b281.7cad4bed0267ab37956f1fcccb769b24.fcd5fdac42a84c4fcc9e9a0c60fc5200 IS NULL\n                 GROUP BY NVL(57eef8c3d4a13d22f0b40f9742e7b281.d73db8611de2680d7b0b5feaa04810c2.f0e42dcd17c0461501b0d0a44a18ba0c0ca5fb119e004e3dd9cc2be01757c595, 'UNKNOWN')) cust\n          WHERE EXISTS (SELECT 'X'\n                          FROM 57eef8c3d4a13d22f0b40f9742e7b281.6b55fd660644c66096a320cc4f099d8a\n                         WHERE fisc_yr_mth < g_fisc_yr_mth\n                           AND dstrct_sls_mgr_id = 7c2ad16aa31e676c2527f1e9d6611b65.f0e42dcd17c0461501b0d0a44a18ba0c0ca5fb119e004e3dd9cc2be01757c595\n                           AND NVL(dstrct_sls_mgr_nm_id, '-999') <> 7c2ad16aa31e676c2527f1e9d6611b65.f16a829d04cb6259f150cb942d141767fbd59c10841470c4404f966cd6f2203e);\n\n      TYPE t_dsm_nm IS TABLE OF c_dsm_nm%ROWTYPE;\n\n      r_dsm_nm       t_dsm_nm;\n\n      \n      CURSOR c_dsm_nm_tmp IS\n         SELECT dstrct_sls_mgr_id, dstrct_sls_mgr_nm_id\n           FROM (  SELECT NVL(57eef8c3d4a13d22f0b40f9742e7b281.d73db8611de2680d7b0b5feaa04810c2.f0e42dcd17c0461501b0d0a44a18ba0c0ca5fb119e004e3dd9cc2be01757c595, 'UNKNOWN') dstrct_sls_mgr_id, MAX(NVL(57eef8c3d4a13d22f0b40f9742e7b281.d73db8611de2680d7b0b5feaa04810c2.f16a829d04cb6259f150cb942d141767fbd59c10841470c4404f966cd6f2203e, 'UNKNOWN' || ' (' || NVL(57eef8c3d4a13d22f0b40f9742e7b281.d73db8611de2680d7b0b5feaa04810c2.f0e42dcd17c0461501b0d0a44a18ba0c0ca5fb119e004e3dd9cc2be01757c595, 'UNKNOWN') || ')')) dstrct_sls_mgr_nm_id\n                     FROM 57eef8c3d4a13d22f0b40f9742e7b281.d73db8611de2680d7b0b5feaa04810c2 cc, 57eef8c3d4a13d22f0b40f9742e7b281.7cad4bed0267ab37956f1fcccb769b24 d\n                    WHERE 57eef8c3d4a13d22f0b40f9742e7b281.d73db8611de2680d7b0b5feaa04810c2.5a8103ceb3eda727eed8d3dbc244a027 = 57eef8c3d4a13d22f0b40f9742e7b281.7cad4bed0267ab37956f1fcccb769b24.5a8103ceb3eda727eed8d3dbc244a027\n                      AND 57eef8c3d4a13d22f0b40f9742e7b281.7cad4bed0267ab37956f1fcccb769b24.d5888bb74952b9abf72c4e89988d3f67 = 'USF'\n                      AND 57eef8c3d4a13d22f0b40f9742e7b281.7cad4bed0267ab37956f1fcccb769b24.0cdc126b1c7da4de6df00b51a8cfda85 = 1\n                      AND 57eef8c3d4a13d22f0b40f9742e7b281.7cad4bed0267ab37956f1fcccb769b24.fcd5fdac42a84c4fcc9e9a0c60fc5200 IS NULL\n                 GROUP BY NVL(57eef8c3d4a13d22f0b40f9742e7b281.d73db8611de2680d7b0b5feaa04810c2.f0e42dcd17c0461501b0d0a44a18ba0c0ca5fb119e004e3dd9cc2be01757c595, 'UNKNOWN')) cust\n          WHERE EXISTS (SELECT 'X'\n                          FROM 57eef8c3d4a13d22f0b40f9742e7b281.c34b3b41e7bd0c01dfd7c75a49970163\n                         WHERE dstrct_sls_mgr_id = 7c2ad16aa31e676c2527f1e9d6611b65.f0e42dcd17c0461501b0d0a44a18ba0c0ca5fb119e004e3dd9cc2be01757c595);\n\n      TYPE t_dsm_nm_tmp IS TABLE OF c_dsm_nm_tmp%ROWTYPE;\n\n      r_dsm_nm_tmp   t_dsm_nm_tmp;\n\n      \n      CURSOR c_tm_nm IS\n         SELECT trtry_mgr_id, trtry_mgr_nm_id\n           FROM (  SELECT NVL(57eef8c3d4a13d22f0b40f9742e7b281.d73db8611de2680d7b0b5feaa04810c2.a2aa8624c681d422d7579b82a029c958, 'UNKNOWN') trtry_mgr_id, MAX(NVL(57eef8c3d4a13d22f0b40f9742e7b281.d73db8611de2680d7b0b5feaa04810c2.d5ec39faef0393e2408b35307f53d103, 'UNKNOWN' || ' (' || NVL(57eef8c3d4a13d22f0b40f9742e7b281.d73db8611de2680d7b0b5feaa04810c2.a2aa8624c681d422d7579b82a029c958, 'UNKNOWN') || ')')) trtry_mgr_nm_id\n                     FROM 57eef8c3d4a13d22f0b40f9742e7b281.d73db8611de2680d7b0b5feaa04810c2 cc, 57eef8c3d4a13d22f0b40f9742e7b281.7cad4bed0267ab37956f1fcccb769b24 d\n                    WHERE 57eef8c3d4a13d22f0b40f9742e7b281.d73db8611de2680d7b0b5feaa04810c2.5a8103ceb3eda727eed8d3dbc244a027 = 57eef8c3d4a13d22f0b40f9742e7b281.7cad4bed0267ab37956f1fcccb769b24.5a8103ceb3eda727eed8d3dbc244a027\n                      AND 57eef8c3d4a13d22f0b40f9742e7b281.7cad4bed0267ab37956f1fcccb769b24.d5888bb74952b9abf72c4e89988d3f67 = 'USF'\n                      AND 57eef8c3d4a13d22f0b40f9742e7b281.7cad4bed0267ab37956f1fcccb769b24.0cdc126b1c7da4de6df00b51a8cfda85 = 1\n                      AND 57eef8c3d4a13d22f0b40f9742e7b281.7cad4bed0267ab37956f1fcccb769b24.fcd5fdac42a84c4fcc9e9a0c60fc5200 IS NULL\n                 GROUP BY NVL(57eef8c3d4a13d22f0b40f9742e7b281.d73db8611de2680d7b0b5feaa04810c2.a2aa8624c681d422d7579b82a029c958, 'UNKNOWN')) cust\n          WHERE EXISTS (SELECT 'X'\n                          FROM 57eef8c3d4a13d22f0b40f9742e7b281.6b55fd660644c66096a320cc4f099d8a\n                         WHERE fisc_yr_mth < g_fisc_yr_mth\n                           AND trtry_mgr_id = 7c2ad16aa31e676c2527f1e9d6611b65.a2aa8624c681d422d7579b82a029c958\n                           AND NVL(trtry_mgr_nm_id, '-999') <> 7c2ad16aa31e676c2527f1e9d6611b65.d5ec39faef0393e2408b35307f53d103);\n\n      TYPE t_tm_nm IS TABLE OF c_tm_nm%ROWTYPE;\n\n      r_tm_nm        t_tm_nm;\n\n      \n      CURSOR c_tm_nm_tmp IS\n         SELECT trtry_mgr_id, trtry_mgr_nm_id\n           FROM (  SELECT NVL(57eef8c3d4a13d22f0b40f9742e7b281.d73db8611de2680d7b0b5feaa04810c2.a2aa8624c681d422d7579b82a029c958, 'UNKNOWN') trtry_mgr_id, MAX(NVL(57eef8c3d4a13d22f0b40f9742e7b281.d73db8611de2680d7b0b5feaa04810c2.d5ec39faef0393e2408b35307f53d103, 'UNKNOWN' || ' (' || NVL(57eef8c3d4a13d22f0b40f9742e7b281.d73db8611de2680d7b0b5feaa04810c2.a2aa8624c681d422d7579b82a029c958, 'UNKNOWN') || ')')) trtry_mgr_nm_id\n                     FROM 57eef8c3d4a13d22f0b40f9742e7b281.d73db8611de2680d7b0b5feaa04810c2 cc, 57eef8c3d4a13d22f0b40f9742e7b281.7cad4bed0267ab37956f1fcccb769b24 d\n                    WHERE 57eef8c3d4a13d22f0b40f9742e7b281.d73db8611de2680d7b0b5feaa04810c2.5a8103ceb3eda727eed8d3dbc244a027 = 57eef8c3d4a13d22f0b40f9742e7b281.7cad4bed0267ab37956f1fcccb769b24.5a8103ceb3eda727eed8d3dbc244a027\n                      AND 57eef8c3d4a13d22f0b40f9742e7b281.7cad4bed0267ab37956f1fcccb769b24.d5888bb74952b9abf72c4e89988d3f67 = 'USF'\n                      AND 57eef8c3d4a13d22f0b40f9742e7b281.7cad4bed0267ab37956f1fcccb769b24.0cdc126b1c7da4de6df00b51a8cfda85 = 1\n                      AND 57eef8c3d4a13d22f0b40f9742e7b281.7cad4bed0267ab37956f1fcccb769b24.fcd5fdac42a84c4fcc9e9a0c60fc5200 IS NULL\n                 GROUP BY NVL(57eef8c3d4a13d22f0b40f9742e7b281.d73db8611de2680d7b0b5feaa04810c2.a2aa8624c681d422d7579b82a029c958, 'UNKNOWN')) cust\n          WHERE EXISTS (SELECT 'X'\n                          FROM 57eef8c3d4a13d22f0b40f9742e7b281.c34b3b41e7bd0c01dfd7c75a49970163\n                         WHERE trtry_mgr_id = 7c2ad16aa31e676c2527f1e9d6611b65.a2aa8624c681d422d7579b82a029c958);\n\n      TYPE t_tm_nm_tmp IS TABLE OF c_tm_nm_tmp%ROWTYPE;\n\n      r_tm_nm_tmp    t_tm_nm_tmp;\n   BEGIN\n      \n      OPEN c_rsm_nm;\n\n      FETCH c_rsm_nm\n      BULK COLLECT INTO r_rsm_nm;\n\n      FORALL i IN 1 .. 1d57ae7d3857fed87bc06a0a56ba5175.1e21de3bb543a206edf22b18c23a0c49()\n         UPDATE 57eef8c3d4a13d22f0b40f9742e7b281.6b55fd660644c66096a320cc4f099d8a\n            SET rgn_sls_mgr_nm_id   = r_rsm_nm(i).rgn_sls_mgr_nm_id\n          WHERE fisc_yr_mth < g_fisc_yr_mth\n            AND rgn_sls_mgr_id = r_rsm_nm(i).rgn_sls_mgr_id\n            AND NVL(rgn_sls_mgr_nm_id, '-999') <> r_rsm_nm(i).rgn_sls_mgr_nm_id;\n\n      DBMS_OUTPUT.put_line('Updated RSM names in SLS_RNK_ORG');\n\n      CLOSE c_rsm_nm;\n\n      \n      OPEN c_rsm_nm_tmp;\n\n      FETCH c_rsm_nm_tmp\n      BULK COLLECT INTO r_rsm_nm_tmp;\n\n      FORALL i IN 1 .. 33db94d81fa9b6be4c0af2e1bbc15089.1e21de3bb543a206edf22b18c23a0c49()\n         UPDATE 57eef8c3d4a13d22f0b40f9742e7b281.c34b3b41e7bd0c01dfd7c75a49970163\n            SET rgn_sls_mgr_nm_id   = r_rsm_nm_tmp(i).rgn_sls_mgr_nm_id\n          WHERE rgn_sls_mgr_id = r_rsm_nm_tmp(i).rgn_sls_mgr_id;\n\n      DBMS_OUTPUT.put_line('Updated RSM names in SLS_RNK_ORG_TMP');\n\n      CLOSE c_rsm_nm_tmp;\n\n      \n      OPEN c_dsm_nm;\n\n      FETCH c_dsm_nm\n      BULK COLLECT INTO r_dsm_nm;\n\n      FORALL i IN 1 .. d85677763e1a276b98724281421bc72a.1e21de3bb543a206edf22b18c23a0c49()\n         UPDATE 57eef8c3d4a13d22f0b40f9742e7b281.6b55fd660644c66096a320cc4f099d8a\n            SET dstrct_sls_mgr_nm_id   = r_dsm_nm(i).dstrct_sls_mgr_nm_id\n          WHERE fisc_yr_mth < g_fisc_yr_mth\n            AND dstrct_sls_mgr_id = r_dsm_nm(i).dstrct_sls_mgr_id\n            AND NVL(dstrct_sls_mgr_nm_id, '-999') <> r_dsm_nm(i).dstrct_sls_mgr_nm_id;\n\n      DBMS_OUTPUT.put_line('Updated DSM names in SLS_RNK_ORG');\n\n      CLOSE c_dsm_nm;\n\n      \n      OPEN c_dsm_nm_tmp;\n\n      FETCH c_dsm_nm_tmp\n      BULK COLLECT INTO r_dsm_nm_tmp;\n\n      FORALL i IN 1 .. 9dd30702eed749bd344044cfdabfc8f2.1e21de3bb543a206edf22b18c23a0c49()\n         UPDATE 57eef8c3d4a13d22f0b40f9742e7b281.c34b3b41e7bd0c01dfd7c75a49970163\n            SET dstrct_sls_mgr_nm_id   = r_dsm_nm_tmp(i).dstrct_sls_mgr_nm_id\n          WHERE dstrct_sls_mgr_id = r_dsm_nm_tmp(i).dstrct_sls_mgr_id;\n\n      DBMS_OUTPUT.put_line('Updated DSM names in SLS_RNK_ORG_TMP');\n\n      CLOSE c_dsm_nm_tmp;\n\n      \n      OPEN c_tm_nm;\n\n      FETCH c_tm_nm\n      BULK COLLECT INTO r_tm_nm;\n\n      FORALL i IN 1 .. 92058930f3f67e75e92acd90d0ee0372.1e21de3bb543a206edf22b18c23a0c49()\n         UPDATE 57eef8c3d4a13d22f0b40f9742e7b281.6b55fd660644c66096a320cc4f099d8a\n            SET trtry_mgr_nm_id   = r_tm_nm(i).trtry_mgr_nm_id\n          WHERE fisc_yr_mth < g_fisc_yr_mth\n            AND trtry_mgr_id = r_tm_nm(i).trtry_mgr_id\n            AND NVL(trtry_mgr_nm_id, '-999') <> r_tm_nm(i).trtry_mgr_nm_id;\n\n      DBMS_OUTPUT.put_line('Updated TM names in SLS_RNK_ORG');\n\n      CLOSE c_tm_nm;\n\n      \n      OPEN c_tm_nm_tmp;\n\n      FETCH c_tm_nm_tmp\n      BULK COLLECT INTO r_tm_nm_tmp;\n\n      FORALL i IN 1 .. 371e3ac93e2ee9e54130df886b55103e.1e21de3bb543a206edf22b18c23a0c49()\n         UPDATE 57eef8c3d4a13d22f0b40f9742e7b281.c34b3b41e7bd0c01dfd7c75a49970163\n            SET trtry_mgr_nm_id   = r_tm_nm_tmp(i).trtry_mgr_nm_id\n          WHERE trtry_mgr_id = r_tm_nm_tmp(i).trtry_mgr_id;\n\n      DBMS_OUTPUT.put_line('Updated TM names in SLS_RNK_ORG_TMP');\n\n      CLOSE c_tm_nm_tmp;\n\n      COMMIT;\n   END upd_sls_rnk_org_nm;\nEND pkg_sls_rnk;\n/",
            "upstream_dependencies": [],
            "downstream_dependencies": [],
            "dag_location": "null",
            "gantt_location": "null",
            "created_at": "null",
            "updated_at": "null"
        },
        {
            "name": "PKG_SLS_PYR",
            "encrypted_name": "f9e834d0ce032038958b136eeedc3902",
            "type": "package",
            "database": "null",
            "encrypted_database": "null",
            "schema": "XDMADM",
            "encrypted_schema": "da238e96cf2cb791a097ca6946c096b4",
            "fully_qualified_name": "XDMADM.PKG_SLS_PYR",
            "encrypted_fqn": "da238e96cf2cb791a097ca6946c096b4.f9e834d0ce032038958b136eeedc3902",
            "synonyms": [],
            "metadata_analysis": "CREATE OR REPLACE PACKAGE \"da238e96cf2cb791a097ca6946c096b4\".\"f9e834d0ce032038958b136eeedc3902\" AS\n   \n   c_aggr_syn_nm   \t\tCONSTANT VARCHAR2(30) := 'SALES_SUMM_PYR_AGGR';\n   c_prj_load_syn_nm\tCONSTANT VARCHAR2(30) := 'SALES_SUMM_PYR_PRJ_LOAD';\n   c_schema_nm     \t\tCONSTANT VARCHAR2(8) := 'XDMADM';\n   c_success       \t\tCONSTANT NUMBER := 0;\n   c_error         \t\tCONSTANT NUMBER := 1;\n\n   \n   c_merch_syn_nm         CONSTANT VARCHAR2(30) := 'SALES_SUMM_MRCH_AGGR';\n   c_cust_merch_syn_nm    CONSTANT VARCHAR2(30) := 'CUST_CORP_MRCH_AGGR';\n   c_pim_merch_syn_nm     CONSTANT VARCHAR2(30) := 'PIM_CORP_MRCH_AGGR';\n\n   \n   c_cust_pyr_syn_nm      CONSTANT VARCHAR2(30) := 'CUST_CORP_PYR_AGGR';\n   c_pim_pyr_syn_nm       CONSTANT VARCHAR2(30) := 'PIM_CORP_AGGR';\n   \n\n   TYPE t_aggr_dim IS RECORD(div_nbr               d54ac6e24333514b7b0da3633f47b285f7cf2aac9079a81dfc6d8e320a4898a9.5a8103ceb3eda727eed8d3dbc244a027%TYPE,\n                             pim_cls_id            d54ac6e24333514b7b0da3633f47b285f7cf2aac9079a81dfc6d8e320a4898a9.efdf828ab5807ba11926106c83446edf%TYPE,\n                             pim_suprcls_id_crnt   d54ac6e24333514b7b0da3633f47b285f7cf2aac9079a81dfc6d8e320a4898a9.c9cb6c3aebf1feef31b4ae62eb481a549d7cf68eee057f0c1cd5afcea8bdbeb8%TYPE,\n                             pim_suprcls_id_actl   d54ac6e24333514b7b0da3633f47b285f7cf2aac9079a81dfc6d8e320a4898a9.a0f6961bdc835dca2e5e3774ec64db253c0fecea47df5fa5ea18b34d89b824b0%TYPE,\n                             trd_cls               d54ac6e24333514b7b0da3633f47b285f7cf2aac9079a81dfc6d8e320a4898a9.7080f549428abf39b1057724fa59d813%TYPE,\n                             pyr_seg_cd            d54ac6e24333514b7b0da3633f47b285f7cf2aac9079a81dfc6d8e320a4898a9.cccc4a6a953ec910fc17463e24f09c77%TYPE,\n                             corp_mlt_unit_nbr     d54ac6e24333514b7b0da3633f47b285f7cf2aac9079a81dfc6d8e320a4898a9.e55fceed8f2eab1e37d2d927e339c92a3829969834280a39721b32c836afdff1%TYPE,\n                             prnt_mlt_unit_cd      d54ac6e24333514b7b0da3633f47b285f7cf2aac9079a81dfc6d8e320a4898a9.8df1cdd196bd3b27791c8c601cfcb2c453a0c0fe76045acdb204ca36f43c8ecf%TYPE,\n                             pim_brnd_typ          d54ac6e24333514b7b0da3633f47b285f7cf2aac9079a81dfc6d8e320a4898a9.bf06136cf49bda7953950bcb3c3c3cb7%TYPE,\n                             \n                             cust_cntrct_flg       d54ac6e24333514b7b0da3633f47b285f7cf2aac9079a81dfc6d8e320a4898a9.2616b8adce49af0fb212dd0420113d8f%TYPE,\n                             cust_natl_mngd_flg    d54ac6e24333514b7b0da3633f47b285f7cf2aac9079a81dfc6d8e320a4898a9.0b49a7fb4e4ab429796cf3bf656d061a711cccba8c2d5033896154ebc5bb9823%TYPE,\n                             cust_acctblty_flg     d54ac6e24333514b7b0da3633f47b285f7cf2aac9079a81dfc6d8e320a4898a9.35bad28a56e645a0b55ebaf1719a9779d15d6ea9acbd3c23e674ad6d3cc16e59%TYPE,  \n                             sls_revenue_div_nbr   d54ac6e24333514b7b0da3633f47b285f7cf2aac9079a81dfc6d8e320a4898a9.62b8391a73b393544f23e7450967c0131766d3fdb0a7d34e76c86087df29e1be%TYPE\n\t\t\t\t\t\t\t );\n\n   TYPE t_aggr_msr IS RECORD(sales     \t\t\t\td54ac6e24333514b7b0da3633f47b285f7cf2aac9079a81dfc6d8e320a4898a9.9e7e4013fd15c78725b0ef91cd1cd802%TYPE,\n                             cases     \t\t\t\td54ac6e24333514b7b0da3633f47b285f7cf2aac9079a81dfc6d8e320a4898a9.35b5bbe882cdc6cc77aeda236583bcf0%TYPE,\n                             tagp      \t\t\t\td54ac6e24333514b7b0da3633f47b285f7cf2aac9079a81dfc6d8e320a4898a9.4c4cd385a85195b3e0992884d97581eb%TYPE,\n                             pa        \t\t\t\td54ac6e24333514b7b0da3633f47b285f7cf2aac9079a81dfc6d8e320a4898a9.a93269d2d91405b98207972fb3a1ae80%TYPE,\n                             \n                             grs_tgp   \t\t\t\td54ac6e24333514b7b0da3633f47b285f7cf2aac9079a81dfc6d8e320a4898a9.de359d0148528b5cfe3c4b36b71fd9cd%TYPE,\n                             net_sls   \t\t\t\td54ac6e24333514b7b0da3633f47b285f7cf2aac9079a81dfc6d8e320a4898a9.ab99700499f70b7018dfa7cc45b968c5%TYPE,\n                             net_tgp   \t\t\t\td54ac6e24333514b7b0da3633f47b285f7cf2aac9079a81dfc6d8e320a4898a9.8778832fa9be240347e4d5b742fa7d56%TYPE,\n\t\t\t\t\t\t\t \n\t\t\t\t\t\t\t net_non_prod_alwnc\t    d54ac6e24333514b7b0da3633f47b285f7cf2aac9079a81dfc6d8e320a4898a9.117de07ea6e56d6513d558249871c2bb0bf423af777c8e292e23a011605b5a08%TYPE,\n\t\t\t\t\t\t\t net_prod_alwnc        \td54ac6e24333514b7b0da3633f47b285f7cf2aac9079a81dfc6d8e320a4898a9.8133a5a199fbd04e5d994857d15f60ec%TYPE,\n\t\t\t\t\t\t\t rbt_loc_accrl_amt     \td54ac6e24333514b7b0da3633f47b285f7cf2aac9079a81dfc6d8e320a4898a9.c90e0997f72c3b7a3eb3a2a616c7448b2e39b1a2ae96282cbb0b695a350e526f%TYPE,\n\t\t\t\t\t\t\t rbt_natl_accrl_amt    \td54ac6e24333514b7b0da3633f47b285f7cf2aac9079a81dfc6d8e320a4898a9.82820cdd5ba12371d387ee6f3b3213492f2b3e70926b93774cf0d2641fb19d5e%TYPE,\n\t\t\t\t\t\t\t rbt_loc_exp_amt       \td54ac6e24333514b7b0da3633f47b285f7cf2aac9079a81dfc6d8e320a4898a9.dd83d6d3c1195b4dd6f2375c9e19be20%TYPE,\n\t\t\t\t\t\t\t rbt_natl_exp_amt      \td54ac6e24333514b7b0da3633f47b285f7cf2aac9079a81dfc6d8e320a4898a9.64ee7ea1bef1b8afeb2a76052c6403b953a0c0fe76045acdb204ca36f43c8ecf%TYPE,\n\t\t\t\t\t\t\t net_prod_chrg         \td54ac6e24333514b7b0da3633f47b285f7cf2aac9079a81dfc6d8e320a4898a9.1964fdb18e32bf3a469ba1dc46dbd66c%TYPE,\n\t\t\t\t\t\t\t net_non_prod_chrg     \td54ac6e24333514b7b0da3633f47b285f7cf2aac9079a81dfc6d8e320a4898a9.f43d738704af5fe4c0684ccab1bfebf3d15d6ea9acbd3c23e674ad6d3cc16e59%TYPE,\n\t\t\t\t\t\t\t ec_grs_sls_extnd       d54ac6e24333514b7b0da3633f47b285f7cf2aac9079a81dfc6d8e320a4898a9.30b8eb8adbe8b46b8847e3302ec12ef153a0c0fe76045acdb204ca36f43c8ecf%TYPE,\n\t\t\t\t\t\t\t py_cust_cases      \td54ac6e24333514b7b0da3633f47b285f7cf2aac9079a81dfc6d8e320a4898a9.ec7dd1e60d506767f4d7864ee9a788f0%TYPE,\n\t\t\t\t\t\t\t py_cust_cnt         \td54ac6e24333514b7b0da3633f47b285f7cf2aac9079a81dfc6d8e320a4898a9.bbec97e172207684075437b73193210a%TYPE,\n\t\t\t\t\t\t\t cust_bow_cnt     \t\td54ac6e24333514b7b0da3633f47b285f7cf2aac9079a81dfc6d8e320a4898a9.c2d9f2e87841859025012fd30e9a0849%TYPE\n\t\t\t\t\t\t\t );\n\n   TYPE t_aggr_growth IS RECORD(sales     \t\t\t\tNUMBER(13, 4),\n                                cases     \t\t\t\tNUMBER(13, 4),\n                                tagp      \t\t\t\tNUMBER(13, 4),\n                                pa        \t\t\t\tNUMBER(13, 4),\n                                grs_tgp   \t\t\t\tNUMBER(13, 4),\n                                net_sls   \t\t\t\tNUMBER(13, 4),\n                                net_tgp\t\t\t\t \tNUMBER(13, 4),\n\t\t\t\t\t\t\t\tnet_non_prod_alwnc\t\tNUMBER(11, 4),\n\t\t\t\t\t\t\t\tnet_prod_alwnc    \t\tNUMBER(11, 4),\n\t\t\t\t\t\t\t\trbt_loc_accrl_amt     \tNUMBER(17, 8),\n\t\t\t\t\t\t\t\trbt_natl_accrl_amt    \tNUMBER(17, 8),\n\t\t\t\t\t\t\t\trbt_loc_exp_amt       \tNUMBER(17, 8),\n\t\t\t\t\t\t\t\trbt_natl_exp_amt      \tNUMBER(17, 8),\n\t\t\t\t\t\t\t\tnet_prod_chrg         \tNUMBER(11, 4),\n\t\t\t\t\t\t\t\tnet_non_prod_chrg     \tNUMBER(11, 4),\n\t\t\t\t\t\t\t\tec_grs_sls_extnd        NUMBER(11, 4),\n\t\t\t\t\t\t\t\tpy_cust_cases      \t\tNUMBER(11, 4),\n\t\t\t\t\t\t\t\tpy_cust_cnt         \tNUMBER(11),\n\t\t\t\t\t\t\t\tcust_bow_cnt     \t\tNUMBER(11)\n\t\t\t\t\t\t\t );\n                                \n\n   FUNCTION get_fisc_wk(p_clndr_dt IN DATE)\n      RETURN VARCHAR2;\n\n   FUNCTION get_measures(p_wk_from      IN VARCHAR2,\n                         p_wk_to        IN VARCHAR2,\n                         p_aggr_dim     IN t_aggr_dim)\n      RETURN t_aggr_msr;\n\n   FUNCTION get_wow_growth(p_wk_from      IN VARCHAR2,\n                           p_wk_to        IN VARCHAR2,\n                           p_aggr_dim     IN t_aggr_dim)\n      RETURN t_aggr_growth;\n\n   FUNCTION get_msr_growth(p_msr_cy       IN NUMBER,\n                           p_msr_ly       IN NUMBER)\n      RETURN NUMBER;\n\n   FUNCTION get_msr_prj(p_msr          IN t_aggr_msr,\n                        p_msr_growth   IN t_aggr_growth)\n      RETURN t_aggr_msr;\n\n   FUNCTION fn_get_prev_yr_wk(p_fisc_yr_wk    VARCHAR,\n                              p_prev_yr       NUMBER)\n      RETURN VARCHAR2\n      DETERMINISTIC;\n\n   FUNCTION fn_get_tbl_nm_syn(p_syn_nm        VARCHAR2)\n      RETURN VARCHAR2;\n\n   FUNCTION fn_get_tbl_nm(p_syn_nm        VARCHAR2,\n                          p_tbl_actv      VARCHAR2)\n      RETURN VARCHAR2;\n\n   PROCEDURE set_syn_tbl(p_tbl_nm        VARCHAR2,\n                         p_tbl_actv      VARCHAR2);\nEND pkg_sls_pyr;\n/\nCREATE OR REPLACE PACKAGE BODY \"da238e96cf2cb791a097ca6946c096b4\".\"f9e834d0ce032038958b136eeedc3902\" AS\n   \n   TYPE t_wow_wks IS TABLE OF 57eef8c3d4a13d22f0b40f9742e7b281.a2349118cac55136943abdf2d397e141.78b147c8e239062228170605a601c274%TYPE\n                        INDEX BY BINARY_INTEGER;\n\n   r_wow_wks       t_wow_wks;\n\n   l_wow_prev_wk   VARCHAR2(6);\n\n   \n   FUNCTION get_fisc_wk(p_clndr_dt IN DATE)\n      RETURN VARCHAR2 IS\n      l_fisc_yr_wk   VARCHAR2(6);\n   BEGIN\n      SELECT fisc_yr_wk\n        INTO l_fisc_yr_wk\n        FROM time_corp\n       WHERE TRUNC(clndr_dt) = TRUNC(p_clndr_dt);\n\n      RETURN l_fisc_yr_wk;\n   EXCEPTION\n      WHEN OTHERS THEN\n         DBMS_OUTPUT.put_line('Error in GET_FISC_WK');\n         DBMS_OUTPUT.put_line(SUBSTR(SQLERRM, 1, 2000));\n   END get_fisc_wk;\n\n   \n   FUNCTION get_msr_prj(p_msr          IN t_aggr_msr,\n                        p_msr_growth   IN t_aggr_growth)\n      RETURN t_aggr_msr IS\n      r_aggr_msr   t_aggr_msr;\n   BEGIN\n      ce2fbe56e9feed0535a415484ab4ce31.91b09e1025eaa89037f7453e981008ed                := ROUND(fd86dc660e80cab7a51c34e817ff88e4.91b09e1025eaa89037f7453e981008ed * (1 + 12b4c0fbdb9f3401cac06d758f31e378.91b09e1025eaa89037f7453e981008ed), 2);\n      ce2fbe56e9feed0535a415484ab4ce31.42f8abbdcc7713ab91c09d3c9ec244a0                := ROUND(fd86dc660e80cab7a51c34e817ff88e4.42f8abbdcc7713ab91c09d3c9ec244a0 * (1 + 12b4c0fbdb9f3401cac06d758f31e378.42f8abbdcc7713ab91c09d3c9ec244a0), 2);\n      ce2fbe56e9feed0535a415484ab4ce31.36fbdf4b259cc86808a96ba5706e588d                 := ROUND(fd86dc660e80cab7a51c34e817ff88e4.36fbdf4b259cc86808a96ba5706e588d * (1 + 12b4c0fbdb9f3401cac06d758f31e378.36fbdf4b259cc86808a96ba5706e588d), 2);\n      ce2fbe56e9feed0535a415484ab4ce31.cd58358e81e2bce2bd4b2086934f28d3                   := ROUND(fd86dc660e80cab7a51c34e817ff88e4.cd58358e81e2bce2bd4b2086934f28d3 * (1 + 12b4c0fbdb9f3401cac06d758f31e378.cd58358e81e2bce2bd4b2086934f28d3), 2);\n      \n      ce2fbe56e9feed0535a415484ab4ce31.de359d0148528b5cfe3c4b36b71fd9cd              := ROUND(fd86dc660e80cab7a51c34e817ff88e4.de359d0148528b5cfe3c4b36b71fd9cd * (1 + 12b4c0fbdb9f3401cac06d758f31e378.de359d0148528b5cfe3c4b36b71fd9cd), 2);\n      ce2fbe56e9feed0535a415484ab4ce31.ab99700499f70b7018dfa7cc45b968c5              := ROUND(fd86dc660e80cab7a51c34e817ff88e4.ab99700499f70b7018dfa7cc45b968c5 * (1 + 12b4c0fbdb9f3401cac06d758f31e378.ab99700499f70b7018dfa7cc45b968c5), 2);\n      ce2fbe56e9feed0535a415484ab4ce31.8778832fa9be240347e4d5b742fa7d56              := ROUND(fd86dc660e80cab7a51c34e817ff88e4.8778832fa9be240347e4d5b742fa7d56 * (1 + 12b4c0fbdb9f3401cac06d758f31e378.8778832fa9be240347e4d5b742fa7d56), 2);\n      \n      ce2fbe56e9feed0535a415484ab4ce31.117de07ea6e56d6513d558249871c2bb0bf423af777c8e292e23a011605b5a08   := ROUND(fd86dc660e80cab7a51c34e817ff88e4.117de07ea6e56d6513d558249871c2bb0bf423af777c8e292e23a011605b5a08 * (1 + 12b4c0fbdb9f3401cac06d758f31e378.117de07ea6e56d6513d558249871c2bb0bf423af777c8e292e23a011605b5a08), 2);\n      ce2fbe56e9feed0535a415484ab4ce31.8133a5a199fbd04e5d994857d15f60ec       := ROUND(fd86dc660e80cab7a51c34e817ff88e4.8133a5a199fbd04e5d994857d15f60ec * (1 + 12b4c0fbdb9f3401cac06d758f31e378.8133a5a199fbd04e5d994857d15f60ec), 2);\n      ce2fbe56e9feed0535a415484ab4ce31.c90e0997f72c3b7a3eb3a2a616c7448b2e39b1a2ae96282cbb0b695a350e526f    := ROUND(fd86dc660e80cab7a51c34e817ff88e4.c90e0997f72c3b7a3eb3a2a616c7448b2e39b1a2ae96282cbb0b695a350e526f * (1 + 12b4c0fbdb9f3401cac06d758f31e378.c90e0997f72c3b7a3eb3a2a616c7448b2e39b1a2ae96282cbb0b695a350e526f), 2);\n      ce2fbe56e9feed0535a415484ab4ce31.82820cdd5ba12371d387ee6f3b3213492f2b3e70926b93774cf0d2641fb19d5e   := ROUND(fd86dc660e80cab7a51c34e817ff88e4.82820cdd5ba12371d387ee6f3b3213492f2b3e70926b93774cf0d2641fb19d5e * (1 + 12b4c0fbdb9f3401cac06d758f31e378.82820cdd5ba12371d387ee6f3b3213492f2b3e70926b93774cf0d2641fb19d5e), 2);\n      ce2fbe56e9feed0535a415484ab4ce31.dd83d6d3c1195b4dd6f2375c9e19be20      := ROUND(fd86dc660e80cab7a51c34e817ff88e4.dd83d6d3c1195b4dd6f2375c9e19be20 * (1 + 12b4c0fbdb9f3401cac06d758f31e378.dd83d6d3c1195b4dd6f2375c9e19be20), 2);\n      ce2fbe56e9feed0535a415484ab4ce31.64ee7ea1bef1b8afeb2a76052c6403b953a0c0fe76045acdb204ca36f43c8ecf     := ROUND(fd86dc660e80cab7a51c34e817ff88e4.64ee7ea1bef1b8afeb2a76052c6403b953a0c0fe76045acdb204ca36f43c8ecf * (1 + 12b4c0fbdb9f3401cac06d758f31e378.64ee7ea1bef1b8afeb2a76052c6403b953a0c0fe76045acdb204ca36f43c8ecf), 2);\n      ce2fbe56e9feed0535a415484ab4ce31.1964fdb18e32bf3a469ba1dc46dbd66c        := ROUND(fd86dc660e80cab7a51c34e817ff88e4.1964fdb18e32bf3a469ba1dc46dbd66c * (1 + 12b4c0fbdb9f3401cac06d758f31e378.1964fdb18e32bf3a469ba1dc46dbd66c), 2);\n      ce2fbe56e9feed0535a415484ab4ce31.f43d738704af5fe4c0684ccab1bfebf3d15d6ea9acbd3c23e674ad6d3cc16e59    := ROUND(fd86dc660e80cab7a51c34e817ff88e4.f43d738704af5fe4c0684ccab1bfebf3d15d6ea9acbd3c23e674ad6d3cc16e59 * (1 + 12b4c0fbdb9f3401cac06d758f31e378.f43d738704af5fe4c0684ccab1bfebf3d15d6ea9acbd3c23e674ad6d3cc16e59), 2);\n      ce2fbe56e9feed0535a415484ab4ce31.30b8eb8adbe8b46b8847e3302ec12ef153a0c0fe76045acdb204ca36f43c8ecf     := ROUND(fd86dc660e80cab7a51c34e817ff88e4.30b8eb8adbe8b46b8847e3302ec12ef153a0c0fe76045acdb204ca36f43c8ecf * (1 + 12b4c0fbdb9f3401cac06d758f31e378.30b8eb8adbe8b46b8847e3302ec12ef153a0c0fe76045acdb204ca36f43c8ecf), 2);\n      ce2fbe56e9feed0535a415484ab4ce31.ec7dd1e60d506767f4d7864ee9a788f0        := ROUND(fd86dc660e80cab7a51c34e817ff88e4.ec7dd1e60d506767f4d7864ee9a788f0 * (1 + 12b4c0fbdb9f3401cac06d758f31e378.ec7dd1e60d506767f4d7864ee9a788f0), 2);\n      ce2fbe56e9feed0535a415484ab4ce31.bbec97e172207684075437b73193210a          := ROUND(fd86dc660e80cab7a51c34e817ff88e4.bbec97e172207684075437b73193210a * (1 + 12b4c0fbdb9f3401cac06d758f31e378.bbec97e172207684075437b73193210a), 2);\n      ce2fbe56e9feed0535a415484ab4ce31.c2d9f2e87841859025012fd30e9a0849         := ROUND(fd86dc660e80cab7a51c34e817ff88e4.c2d9f2e87841859025012fd30e9a0849 * (1 + 12b4c0fbdb9f3401cac06d758f31e378.c2d9f2e87841859025012fd30e9a0849), 2);\n\n      RETURN r_aggr_msr;\n   EXCEPTION\n      WHEN OTHERS THEN\n         DBMS_OUTPUT.put_line('Error in GET_MSR_PRJ');\n         DBMS_OUTPUT.put_line(SUBSTR(SQLERRM, 1, 2000));\n   END get_msr_prj;\n\n   \n   FUNCTION get_measures(p_wk_from      IN VARCHAR2,\n                         p_wk_to        IN VARCHAR2,\n                         p_aggr_dim     IN t_aggr_dim)\n      RETURN t_aggr_msr IS\n      r_aggr_msr   t_aggr_msr;\n   BEGIN\n      SELECT \n            NVL(SUM(grs_sls_extnd), 0) sales,\n             NVL(SUM(unfrm_qty_ship), 0) cases,\n             NVL(SUM(actl_gp), 0) tagp,\n             NVL(SUM(ttl_alwnc), 0) pa,\n             NVL(SUM(grs_tgp), 0) grs_tgp,\n             NVL(SUM(net_sls), 0) net_sls,\n             NVL(SUM(net_tgp), 0) net_tgp,\n             NVL(SUM(net_non_prod_alwnc), 0) net_non_prod_alwnc,\n             NVL(SUM(net_prod_alwnc), 0) net_prod_alwnc,\n             NVL(SUM(rbt_loc_accrl_amt), 0) rbt_loc_accrl_amt,\n             NVL(SUM(rbt_natl_accrl_amt), 0) rbt_natl_accrl_amt,\n             NVL(SUM(rbt_loc_exp_amt), 0) rbt_loc_exp_amt,\n             NVL(SUM(rbt_natl_exp_amt), 0) rbt_natl_exp_amt,\n             NVL(SUM(net_prod_chrg), 0) net_prod_chrg,\n             NVL(SUM(net_non_prod_chrg), 0) net_non_prod_chrg,\n             NVL(SUM(ec_grs_sls_extnd), 0) ec_grs_sls_extnd,\n             NVL(SUM(py_cust_cases), 0) py_cust_cases,\n             NVL(SUM(py_cust_cnt), 0) py_cust_cnt,\n             NVL(SUM(cust_bow_cnt), 0) cust_bow_cnt\n        INTO ce2fbe56e9feed0535a415484ab4ce31.91b09e1025eaa89037f7453e981008ed,\n             ce2fbe56e9feed0535a415484ab4ce31.42f8abbdcc7713ab91c09d3c9ec244a0,\n             ce2fbe56e9feed0535a415484ab4ce31.36fbdf4b259cc86808a96ba5706e588d,\n             ce2fbe56e9feed0535a415484ab4ce31.cd58358e81e2bce2bd4b2086934f28d3,\n             \n             ce2fbe56e9feed0535a415484ab4ce31.de359d0148528b5cfe3c4b36b71fd9cd,\n             ce2fbe56e9feed0535a415484ab4ce31.ab99700499f70b7018dfa7cc45b968c5,\n             ce2fbe56e9feed0535a415484ab4ce31.8778832fa9be240347e4d5b742fa7d56,\n             \n             ce2fbe56e9feed0535a415484ab4ce31.117de07ea6e56d6513d558249871c2bb0bf423af777c8e292e23a011605b5a08,\n             ce2fbe56e9feed0535a415484ab4ce31.8133a5a199fbd04e5d994857d15f60ec,\n             ce2fbe56e9feed0535a415484ab4ce31.c90e0997f72c3b7a3eb3a2a616c7448b2e39b1a2ae96282cbb0b695a350e526f,\n             ce2fbe56e9feed0535a415484ab4ce31.82820cdd5ba12371d387ee6f3b3213492f2b3e70926b93774cf0d2641fb19d5e,\n             ce2fbe56e9feed0535a415484ab4ce31.dd83d6d3c1195b4dd6f2375c9e19be20,\n             ce2fbe56e9feed0535a415484ab4ce31.64ee7ea1bef1b8afeb2a76052c6403b953a0c0fe76045acdb204ca36f43c8ecf,\n             ce2fbe56e9feed0535a415484ab4ce31.1964fdb18e32bf3a469ba1dc46dbd66c,\n             ce2fbe56e9feed0535a415484ab4ce31.f43d738704af5fe4c0684ccab1bfebf3d15d6ea9acbd3c23e674ad6d3cc16e59,\n             ce2fbe56e9feed0535a415484ab4ce31.30b8eb8adbe8b46b8847e3302ec12ef153a0c0fe76045acdb204ca36f43c8ecf,\n             ce2fbe56e9feed0535a415484ab4ce31.ec7dd1e60d506767f4d7864ee9a788f0,\n             ce2fbe56e9feed0535a415484ab4ce31.bbec97e172207684075437b73193210a,\n             ce2fbe56e9feed0535a415484ab4ce31.c2d9f2e87841859025012fd30e9a0849\n        FROM 57eef8c3d4a13d22f0b40f9742e7b281.d54ac6e24333514b7b0da3633f47b285b4385b365654a359c9902c4c3615aab4\n       WHERE fisc_yr_wk BETWEEN p_wk_from AND p_wk_to\n         AND div_nbr = 10173302d8c963e316d4e4b880f1e837.5a8103ceb3eda727eed8d3dbc244a027\n         AND pim_cls_id = 10173302d8c963e316d4e4b880f1e837.efdf828ab5807ba11926106c83446edf\n         AND pim_suprcls_id_crnt = 10173302d8c963e316d4e4b880f1e837.c9cb6c3aebf1feef31b4ae62eb481a549d7cf68eee057f0c1cd5afcea8bdbeb8\n         AND pim_suprcls_id_actl = 10173302d8c963e316d4e4b880f1e837.a0f6961bdc835dca2e5e3774ec64db253c0fecea47df5fa5ea18b34d89b824b0\n         AND trd_cls = 10173302d8c963e316d4e4b880f1e837.7080f549428abf39b1057724fa59d813\n         AND pyr_seg_cd = 10173302d8c963e316d4e4b880f1e837.cccc4a6a953ec910fc17463e24f09c77\n         AND corp_mlt_unit_nbr = 10173302d8c963e316d4e4b880f1e837.e55fceed8f2eab1e37d2d927e339c92a3829969834280a39721b32c836afdff1\n         AND prnt_mlt_unit_cd = 10173302d8c963e316d4e4b880f1e837.8df1cdd196bd3b27791c8c601cfcb2c453a0c0fe76045acdb204ca36f43c8ecf\n         AND pim_brnd_typ = 10173302d8c963e316d4e4b880f1e837.bf06136cf49bda7953950bcb3c3c3cb7\n         AND cust_cntrct_flg = 10173302d8c963e316d4e4b880f1e837.2616b8adce49af0fb212dd0420113d8f\n         AND cust_natl_mngd_flg = 10173302d8c963e316d4e4b880f1e837.0b49a7fb4e4ab429796cf3bf656d061a711cccba8c2d5033896154ebc5bb9823\n         AND cust_acctblty_flg = 10173302d8c963e316d4e4b880f1e837.35bad28a56e645a0b55ebaf1719a9779d15d6ea9acbd3c23e674ad6d3cc16e59\n         AND sls_revenue_div_nbr = 10173302d8c963e316d4e4b880f1e837.62b8391a73b393544f23e7450967c0131766d3fdb0a7d34e76c86087df29e1be;\n\n      RETURN r_aggr_msr;\n   EXCEPTION\n      WHEN OTHERS THEN\n         DBMS_OUTPUT.put_line('Error in GET_MEASURES');\n         DBMS_OUTPUT.put_line(SUBSTR(SQLERRM, 1, 2000));\n   END get_measures;\n\n   \n   FUNCTION get_wow_growth(p_wk_from      IN VARCHAR2,\n                           p_wk_to        IN VARCHAR2,\n                           p_aggr_dim     IN t_aggr_dim)\n      RETURN t_aggr_growth IS\n      l_prev_wk        VARCHAR2(6);\n      r_total_growth   t_aggr_growth;\n      r_avg_growth     t_aggr_growth;\n      l_wk_cnt         NUMBER := 0;\n\n      CURSOR c_wow_wks(x_first_wk     IN VARCHAR2,\n                       x_last_wk      IN VARCHAR2) IS\n           SELECT fisc_yr_wk\n             FROM wkly_time_corp\n            WHERE fisc_yr_wk BETWEEN x_first_wk AND x_last_wk\n         ORDER BY fisc_yr_wk;\n\n      r_cur_wk_msr     t_aggr_msr;\n      r_prev_wk_msr    t_aggr_msr;\n   BEGIN\n      IF (l_wow_prev_wk IS NULL) THEN\n         SELECT fisc_yr_wkago\n           INTO l_wow_prev_wk\n           FROM wkly_time_corp\n          WHERE fisc_yr_wk = p_wk_from;\n\n         \n         OPEN c_wow_wks(p_wk_from, p_wk_to);\n\n         FETCH c_wow_wks\n         BULK COLLECT INTO r_wow_wks;\n\n         CLOSE c_wow_wks;\n      END IF;\n\n      r_prev_wk_msr                       := get_measures(l_wow_prev_wk, l_wow_prev_wk, p_aggr_dim);\n\n      e2c774f3a8441d302a4800ff80cd6925.91b09e1025eaa89037f7453e981008ed                := 0;\n      e2c774f3a8441d302a4800ff80cd6925.42f8abbdcc7713ab91c09d3c9ec244a0                := 0;\n      e2c774f3a8441d302a4800ff80cd6925.36fbdf4b259cc86808a96ba5706e588d                 := 0;\n      e2c774f3a8441d302a4800ff80cd6925.cd58358e81e2bce2bd4b2086934f28d3                   := 0;\n      \n      e2c774f3a8441d302a4800ff80cd6925.de359d0148528b5cfe3c4b36b71fd9cd              := 0;\n      e2c774f3a8441d302a4800ff80cd6925.ab99700499f70b7018dfa7cc45b968c5              := 0;\n      e2c774f3a8441d302a4800ff80cd6925.8778832fa9be240347e4d5b742fa7d56              := 0;\n      \n      e2c774f3a8441d302a4800ff80cd6925.117de07ea6e56d6513d558249871c2bb0bf423af777c8e292e23a011605b5a08   := 0;\n      e2c774f3a8441d302a4800ff80cd6925.8133a5a199fbd04e5d994857d15f60ec       := 0;\n      e2c774f3a8441d302a4800ff80cd6925.c90e0997f72c3b7a3eb3a2a616c7448b2e39b1a2ae96282cbb0b695a350e526f    := 0;\n      e2c774f3a8441d302a4800ff80cd6925.82820cdd5ba12371d387ee6f3b3213492f2b3e70926b93774cf0d2641fb19d5e   := 0;\n      e2c774f3a8441d302a4800ff80cd6925.dd83d6d3c1195b4dd6f2375c9e19be20      := 0;\n      e2c774f3a8441d302a4800ff80cd6925.64ee7ea1bef1b8afeb2a76052c6403b953a0c0fe76045acdb204ca36f43c8ecf     := 0;\n      e2c774f3a8441d302a4800ff80cd6925.1964fdb18e32bf3a469ba1dc46dbd66c        := 0;\n      e2c774f3a8441d302a4800ff80cd6925.f43d738704af5fe4c0684ccab1bfebf3d15d6ea9acbd3c23e674ad6d3cc16e59    := 0;\n      e2c774f3a8441d302a4800ff80cd6925.30b8eb8adbe8b46b8847e3302ec12ef153a0c0fe76045acdb204ca36f43c8ecf     := 0;\n      e2c774f3a8441d302a4800ff80cd6925.ec7dd1e60d506767f4d7864ee9a788f0        := 0;\n      e2c774f3a8441d302a4800ff80cd6925.bbec97e172207684075437b73193210a          := 0;\n      e2c774f3a8441d302a4800ff80cd6925.c2d9f2e87841859025012fd30e9a0849         := 0;\n\n      \n\n      FOR i IN 3e09810caa07e587ad01b2ff45c2c0ba.ffeb71434c07e00ba8389efd8bc4154e .. 3e09810caa07e587ad01b2ff45c2c0ba.4635f2af279e7eaaaa1901820acd0bac LOOP\n         r_cur_wk_msr                        := get_measures(r_wow_wks(i), r_wow_wks(i), p_aggr_dim);\n\n         e2c774f3a8441d302a4800ff80cd6925.91b09e1025eaa89037f7453e981008ed                := e2c774f3a8441d302a4800ff80cd6925.91b09e1025eaa89037f7453e981008ed + get_msr_growth(602f2cb568dd8ee798940dd9c674a31c.91b09e1025eaa89037f7453e981008ed, 3730db2cfdc8c8ffe0504ecf6df945bd.91b09e1025eaa89037f7453e981008ed);\n         e2c774f3a8441d302a4800ff80cd6925.42f8abbdcc7713ab91c09d3c9ec244a0                := e2c774f3a8441d302a4800ff80cd6925.42f8abbdcc7713ab91c09d3c9ec244a0 + get_msr_growth(602f2cb568dd8ee798940dd9c674a31c.42f8abbdcc7713ab91c09d3c9ec244a0, 3730db2cfdc8c8ffe0504ecf6df945bd.42f8abbdcc7713ab91c09d3c9ec244a0);\n         e2c774f3a8441d302a4800ff80cd6925.36fbdf4b259cc86808a96ba5706e588d                 := e2c774f3a8441d302a4800ff80cd6925.36fbdf4b259cc86808a96ba5706e588d + get_msr_growth(602f2cb568dd8ee798940dd9c674a31c.36fbdf4b259cc86808a96ba5706e588d, 3730db2cfdc8c8ffe0504ecf6df945bd.36fbdf4b259cc86808a96ba5706e588d);\n         e2c774f3a8441d302a4800ff80cd6925.cd58358e81e2bce2bd4b2086934f28d3                   := e2c774f3a8441d302a4800ff80cd6925.cd58358e81e2bce2bd4b2086934f28d3 + get_msr_growth(602f2cb568dd8ee798940dd9c674a31c.cd58358e81e2bce2bd4b2086934f28d3, 3730db2cfdc8c8ffe0504ecf6df945bd.cd58358e81e2bce2bd4b2086934f28d3);\n         \n         e2c774f3a8441d302a4800ff80cd6925.de359d0148528b5cfe3c4b36b71fd9cd              := e2c774f3a8441d302a4800ff80cd6925.de359d0148528b5cfe3c4b36b71fd9cd + get_msr_growth(602f2cb568dd8ee798940dd9c674a31c.de359d0148528b5cfe3c4b36b71fd9cd, 3730db2cfdc8c8ffe0504ecf6df945bd.de359d0148528b5cfe3c4b36b71fd9cd);\n         e2c774f3a8441d302a4800ff80cd6925.ab99700499f70b7018dfa7cc45b968c5              := e2c774f3a8441d302a4800ff80cd6925.ab99700499f70b7018dfa7cc45b968c5 + get_msr_growth(602f2cb568dd8ee798940dd9c674a31c.ab99700499f70b7018dfa7cc45b968c5, 3730db2cfdc8c8ffe0504ecf6df945bd.ab99700499f70b7018dfa7cc45b968c5);\n         e2c774f3a8441d302a4800ff80cd6925.8778832fa9be240347e4d5b742fa7d56              := e2c774f3a8441d302a4800ff80cd6925.8778832fa9be240347e4d5b742fa7d56 + get_msr_growth(602f2cb568dd8ee798940dd9c674a31c.8778832fa9be240347e4d5b742fa7d56, 3730db2cfdc8c8ffe0504ecf6df945bd.8778832fa9be240347e4d5b742fa7d56);\n         \n         e2c774f3a8441d302a4800ff80cd6925.117de07ea6e56d6513d558249871c2bb0bf423af777c8e292e23a011605b5a08   := e2c774f3a8441d302a4800ff80cd6925.117de07ea6e56d6513d558249871c2bb0bf423af777c8e292e23a011605b5a08 + get_msr_growth(602f2cb568dd8ee798940dd9c674a31c.117de07ea6e56d6513d558249871c2bb0bf423af777c8e292e23a011605b5a08, 3730db2cfdc8c8ffe0504ecf6df945bd.117de07ea6e56d6513d558249871c2bb0bf423af777c8e292e23a011605b5a08);\n         e2c774f3a8441d302a4800ff80cd6925.8133a5a199fbd04e5d994857d15f60ec       := e2c774f3a8441d302a4800ff80cd6925.8133a5a199fbd04e5d994857d15f60ec + get_msr_growth(602f2cb568dd8ee798940dd9c674a31c.8133a5a199fbd04e5d994857d15f60ec, 3730db2cfdc8c8ffe0504ecf6df945bd.8133a5a199fbd04e5d994857d15f60ec);\n         e2c774f3a8441d302a4800ff80cd6925.c90e0997f72c3b7a3eb3a2a616c7448b2e39b1a2ae96282cbb0b695a350e526f    := e2c774f3a8441d302a4800ff80cd6925.c90e0997f72c3b7a3eb3a2a616c7448b2e39b1a2ae96282cbb0b695a350e526f + get_msr_growth(602f2cb568dd8ee798940dd9c674a31c.c90e0997f72c3b7a3eb3a2a616c7448b2e39b1a2ae96282cbb0b695a350e526f, 3730db2cfdc8c8ffe0504ecf6df945bd.c90e0997f72c3b7a3eb3a2a616c7448b2e39b1a2ae96282cbb0b695a350e526f);\n         e2c774f3a8441d302a4800ff80cd6925.82820cdd5ba12371d387ee6f3b3213492f2b3e70926b93774cf0d2641fb19d5e   := e2c774f3a8441d302a4800ff80cd6925.82820cdd5ba12371d387ee6f3b3213492f2b3e70926b93774cf0d2641fb19d5e + get_msr_growth(602f2cb568dd8ee798940dd9c674a31c.82820cdd5ba12371d387ee6f3b3213492f2b3e70926b93774cf0d2641fb19d5e, 3730db2cfdc8c8ffe0504ecf6df945bd.82820cdd5ba12371d387ee6f3b3213492f2b3e70926b93774cf0d2641fb19d5e);\n         e2c774f3a8441d302a4800ff80cd6925.dd83d6d3c1195b4dd6f2375c9e19be20      := e2c774f3a8441d302a4800ff80cd6925.dd83d6d3c1195b4dd6f2375c9e19be20 + get_msr_growth(602f2cb568dd8ee798940dd9c674a31c.dd83d6d3c1195b4dd6f2375c9e19be20, 3730db2cfdc8c8ffe0504ecf6df945bd.dd83d6d3c1195b4dd6f2375c9e19be20);\n         e2c774f3a8441d302a4800ff80cd6925.64ee7ea1bef1b8afeb2a76052c6403b953a0c0fe76045acdb204ca36f43c8ecf     := e2c774f3a8441d302a4800ff80cd6925.64ee7ea1bef1b8afeb2a76052c6403b953a0c0fe76045acdb204ca36f43c8ecf + get_msr_growth(602f2cb568dd8ee798940dd9c674a31c.64ee7ea1bef1b8afeb2a76052c6403b953a0c0fe76045acdb204ca36f43c8ecf, 3730db2cfdc8c8ffe0504ecf6df945bd.64ee7ea1bef1b8afeb2a76052c6403b953a0c0fe76045acdb204ca36f43c8ecf);\n         e2c774f3a8441d302a4800ff80cd6925.1964fdb18e32bf3a469ba1dc46dbd66c        := e2c774f3a8441d302a4800ff80cd6925.1964fdb18e32bf3a469ba1dc46dbd66c + get_msr_growth(602f2cb568dd8ee798940dd9c674a31c.1964fdb18e32bf3a469ba1dc46dbd66c, 3730db2cfdc8c8ffe0504ecf6df945bd.1964fdb18e32bf3a469ba1dc46dbd66c);\n         e2c774f3a8441d302a4800ff80cd6925.f43d738704af5fe4c0684ccab1bfebf3d15d6ea9acbd3c23e674ad6d3cc16e59    := e2c774f3a8441d302a4800ff80cd6925.f43d738704af5fe4c0684ccab1bfebf3d15d6ea9acbd3c23e674ad6d3cc16e59 + get_msr_growth(602f2cb568dd8ee798940dd9c674a31c.f43d738704af5fe4c0684ccab1bfebf3d15d6ea9acbd3c23e674ad6d3cc16e59, 3730db2cfdc8c8ffe0504ecf6df945bd.f43d738704af5fe4c0684ccab1bfebf3d15d6ea9acbd3c23e674ad6d3cc16e59);\n         e2c774f3a8441d302a4800ff80cd6925.30b8eb8adbe8b46b8847e3302ec12ef153a0c0fe76045acdb204ca36f43c8ecf     := e2c774f3a8441d302a4800ff80cd6925.30b8eb8adbe8b46b8847e3302ec12ef153a0c0fe76045acdb204ca36f43c8ecf + get_msr_growth(602f2cb568dd8ee798940dd9c674a31c.30b8eb8adbe8b46b8847e3302ec12ef153a0c0fe76045acdb204ca36f43c8ecf, 3730db2cfdc8c8ffe0504ecf6df945bd.30b8eb8adbe8b46b8847e3302ec12ef153a0c0fe76045acdb204ca36f43c8ecf);\n         e2c774f3a8441d302a4800ff80cd6925.ec7dd1e60d506767f4d7864ee9a788f0        := e2c774f3a8441d302a4800ff80cd6925.ec7dd1e60d506767f4d7864ee9a788f0 + get_msr_growth(602f2cb568dd8ee798940dd9c674a31c.ec7dd1e60d506767f4d7864ee9a788f0, 3730db2cfdc8c8ffe0504ecf6df945bd.ec7dd1e60d506767f4d7864ee9a788f0);\n         e2c774f3a8441d302a4800ff80cd6925.bbec97e172207684075437b73193210a          := e2c774f3a8441d302a4800ff80cd6925.bbec97e172207684075437b73193210a + get_msr_growth(602f2cb568dd8ee798940dd9c674a31c.bbec97e172207684075437b73193210a, 3730db2cfdc8c8ffe0504ecf6df945bd.bbec97e172207684075437b73193210a);\n         e2c774f3a8441d302a4800ff80cd6925.c2d9f2e87841859025012fd30e9a0849         := e2c774f3a8441d302a4800ff80cd6925.c2d9f2e87841859025012fd30e9a0849 + get_msr_growth(602f2cb568dd8ee798940dd9c674a31c.c2d9f2e87841859025012fd30e9a0849, 3730db2cfdc8c8ffe0504ecf6df945bd.c2d9f2e87841859025012fd30e9a0849);\n         \n         r_prev_wk_msr                       := r_cur_wk_msr;\n         l_wk_cnt                            := l_wk_cnt + 1;\n      END LOOP;\n\n      bab763466990aead02f661a7c778dca8.91b09e1025eaa89037f7453e981008ed                  := e2c774f3a8441d302a4800ff80cd6925.91b09e1025eaa89037f7453e981008ed / l_wk_cnt;\n      bab763466990aead02f661a7c778dca8.42f8abbdcc7713ab91c09d3c9ec244a0                  := e2c774f3a8441d302a4800ff80cd6925.42f8abbdcc7713ab91c09d3c9ec244a0 / l_wk_cnt;\n      bab763466990aead02f661a7c778dca8.36fbdf4b259cc86808a96ba5706e588d                   := e2c774f3a8441d302a4800ff80cd6925.36fbdf4b259cc86808a96ba5706e588d / l_wk_cnt;\n      bab763466990aead02f661a7c778dca8.cd58358e81e2bce2bd4b2086934f28d3                     := e2c774f3a8441d302a4800ff80cd6925.cd58358e81e2bce2bd4b2086934f28d3 / l_wk_cnt;\n      bab763466990aead02f661a7c778dca8.de359d0148528b5cfe3c4b36b71fd9cd                := e2c774f3a8441d302a4800ff80cd6925.de359d0148528b5cfe3c4b36b71fd9cd / l_wk_cnt; \n      bab763466990aead02f661a7c778dca8.ab99700499f70b7018dfa7cc45b968c5                := e2c774f3a8441d302a4800ff80cd6925.ab99700499f70b7018dfa7cc45b968c5 / l_wk_cnt; \n      bab763466990aead02f661a7c778dca8.8778832fa9be240347e4d5b742fa7d56                := e2c774f3a8441d302a4800ff80cd6925.8778832fa9be240347e4d5b742fa7d56 / l_wk_cnt; \n      bab763466990aead02f661a7c778dca8.117de07ea6e56d6513d558249871c2bb0bf423af777c8e292e23a011605b5a08     := e2c774f3a8441d302a4800ff80cd6925.117de07ea6e56d6513d558249871c2bb0bf423af777c8e292e23a011605b5a08 / l_wk_cnt; \n      bab763466990aead02f661a7c778dca8.8133a5a199fbd04e5d994857d15f60ec         := e2c774f3a8441d302a4800ff80cd6925.8133a5a199fbd04e5d994857d15f60ec / l_wk_cnt; \n      bab763466990aead02f661a7c778dca8.c90e0997f72c3b7a3eb3a2a616c7448b2e39b1a2ae96282cbb0b695a350e526f      := e2c774f3a8441d302a4800ff80cd6925.c90e0997f72c3b7a3eb3a2a616c7448b2e39b1a2ae96282cbb0b695a350e526f / l_wk_cnt; \n      bab763466990aead02f661a7c778dca8.82820cdd5ba12371d387ee6f3b3213492f2b3e70926b93774cf0d2641fb19d5e     := e2c774f3a8441d302a4800ff80cd6925.82820cdd5ba12371d387ee6f3b3213492f2b3e70926b93774cf0d2641fb19d5e / l_wk_cnt; \n      bab763466990aead02f661a7c778dca8.dd83d6d3c1195b4dd6f2375c9e19be20        := e2c774f3a8441d302a4800ff80cd6925.dd83d6d3c1195b4dd6f2375c9e19be20 / l_wk_cnt; \n      bab763466990aead02f661a7c778dca8.64ee7ea1bef1b8afeb2a76052c6403b953a0c0fe76045acdb204ca36f43c8ecf       := e2c774f3a8441d302a4800ff80cd6925.64ee7ea1bef1b8afeb2a76052c6403b953a0c0fe76045acdb204ca36f43c8ecf / l_wk_cnt; \n      bab763466990aead02f661a7c778dca8.1964fdb18e32bf3a469ba1dc46dbd66c          := e2c774f3a8441d302a4800ff80cd6925.1964fdb18e32bf3a469ba1dc46dbd66c / l_wk_cnt; \n      bab763466990aead02f661a7c778dca8.f43d738704af5fe4c0684ccab1bfebf3d15d6ea9acbd3c23e674ad6d3cc16e59      := e2c774f3a8441d302a4800ff80cd6925.f43d738704af5fe4c0684ccab1bfebf3d15d6ea9acbd3c23e674ad6d3cc16e59 / l_wk_cnt; \n      bab763466990aead02f661a7c778dca8.30b8eb8adbe8b46b8847e3302ec12ef153a0c0fe76045acdb204ca36f43c8ecf       := e2c774f3a8441d302a4800ff80cd6925.30b8eb8adbe8b46b8847e3302ec12ef153a0c0fe76045acdb204ca36f43c8ecf / l_wk_cnt;\n      bab763466990aead02f661a7c778dca8.ec7dd1e60d506767f4d7864ee9a788f0          := e2c774f3a8441d302a4800ff80cd6925.ec7dd1e60d506767f4d7864ee9a788f0 / l_wk_cnt;\n      bab763466990aead02f661a7c778dca8.bbec97e172207684075437b73193210a            := e2c774f3a8441d302a4800ff80cd6925.bbec97e172207684075437b73193210a / l_wk_cnt;\n      bab763466990aead02f661a7c778dca8.c2d9f2e87841859025012fd30e9a0849           := e2c774f3a8441d302a4800ff80cd6925.c2d9f2e87841859025012fd30e9a0849 / l_wk_cnt;\n\n      RETURN r_avg_growth;\n   EXCEPTION\n      WHEN OTHERS THEN\n         DBMS_OUTPUT.put_line('Error in GET_WOW_GROWTH');\n         DBMS_OUTPUT.put_line(SUBSTR(SQLERRM, 1, 2000));\n   END get_wow_growth;\n\n   \n   FUNCTION get_msr_growth(p_msr_cy       IN NUMBER,\n                           p_msr_ly       IN NUMBER)\n      RETURN NUMBER IS\n      l_growth   NUMBER;\n   BEGIN\n      IF (p_msr_ly <> 0) THEN\n         l_growth   := ROUND((p_msr_cy - p_msr_ly) / p_msr_ly, 4);\n\n         IF (l_growth > 2) THEN\n            l_growth   := 2;\n         END IF;\n\n         IF (l_growth < -2) THEN\n            l_growth   := -2;\n         END IF;\n      ELSE\n         l_growth   := 0;\n      END IF;\n\n      RETURN l_growth;\n   EXCEPTION\n      WHEN OTHERS THEN\n         DBMS_OUTPUT.put_line('Error in GET_MSR_GROWTH');\n         DBMS_OUTPUT.put_line(SUBSTR(SQLERRM, 1, 2000));\n   END get_msr_growth;\n\n   \n   \n\n   \n   FUNCTION fn_get_prev_yr_wk(p_fisc_yr_wk    VARCHAR,\n                              p_prev_yr       NUMBER)\n      RETURN VARCHAR2\n      DETERMINISTIC IS\n      l_prev_fisc_yr_wk   VARCHAR2(6);\n   BEGIN\n      l_prev_fisc_yr_wk   := p_fisc_yr_wk;\n\n      FOR i IN 1 .. p_prev_yr LOOP\n         SELECT fisc_yrago_wk\n           INTO l_prev_fisc_yr_wk\n           FROM 57eef8c3d4a13d22f0b40f9742e7b281.ac60f3b24ab9261fbfdd476a640ab55e\n          WHERE fisc_yr_wk = l_prev_fisc_yr_wk;\n      END LOOP;\n\n      RETURN l_prev_fisc_yr_wk;\n   EXCEPTION\n      WHEN OTHERS THEN\n         DBMS_OUTPUT.put_line('Error in FN_GET_PREV_YR_WK');\n         DBMS_OUTPUT.put_line(SUBSTR(SQLERRM, 1, 2000));\n   END fn_get_prev_yr_wk;\n\n   \n   FUNCTION fn_get_tbl_nm_syn(p_syn_nm VARCHAR2)\n      RETURN VARCHAR2 IS\n      l_full_tbl_nm   VARCHAR2(30);\n   BEGIN\n      SELECT table_name\n        INTO l_full_tbl_nm\n        FROM user_synonyms\n       WHERE synonym_name = p_syn_nm;\n\n      RETURN l_full_tbl_nm;\n   EXCEPTION\n      WHEN OTHERS THEN\n         DBMS_OUTPUT.put_line('Error in FN_GET_TBL_NM_SYN');\n         DBMS_OUTPUT.put_line(SUBSTR(SQLERRM, 1, 2000));\n   END fn_get_tbl_nm_syn;\n\n   \n   FUNCTION fn_get_tbl_nm(p_syn_nm        VARCHAR2,\n                          p_tbl_actv      VARCHAR2)\n      RETURN VARCHAR2 IS\n      l_full_tbl_nm   VARCHAR2(30);\n   BEGIN\n      SELECT tbl_nm\n        INTO l_full_tbl_nm\n        FROM 0995ae2071582f271cc89b5935c8c98b.e82518bc41eafdc4a4d474a4439ba693\n       WHERE synonym_nm = p_syn_nm\n         AND actv_ind = p_tbl_actv;\n\n      RETURN l_full_tbl_nm;\n   EXCEPTION\n      WHEN OTHERS THEN\n         DBMS_OUTPUT.put_line('Error in FN_GET_TBL_NM');\n         DBMS_OUTPUT.put_line(SUBSTR(SQLERRM, 1, 2000));\n   END fn_get_tbl_nm;\n\n   \n   PROCEDURE set_syn_tbl(p_tbl_nm        VARCHAR2,\n                         p_tbl_actv      VARCHAR2) IS\n   BEGIN\n      UPDATE 0995ae2071582f271cc89b5935c8c98b.e82518bc41eafdc4a4d474a4439ba693\n         SET actv_ind = p_tbl_actv, last_updt = SYSDATE\n       WHERE tbl_nm = p_tbl_nm;\n\n      IF (sql%ROWCOUNT = 0) THEN\n         DBMS_OUTPUT.put_line('No rows to update in syn tbl map');\n      END IF;\n   EXCEPTION\n      WHEN OTHERS THEN\n         DBMS_OUTPUT.put_line('Error in SET_SYN_TBL');\n         DBMS_OUTPUT.put_line(SUBSTR(SQLERRM, 1, 2000));\n         RAISE;\n   END set_syn_tbl;\nEND pkg_sls_pyr;\n/",
            "upstream_dependencies": [],
            "downstream_dependencies": [],
            "dag_location": "null",
            "gantt_location": "null",
            "created_at": "null",
            "updated_at": "null"
        }
    ]
}