{
    "filename": "ddl_procedure.sql",
    "numb_objects": 6,
    "type": "procedure",
    "type_hex": "292b130ac21d47a6d91108e12383ec2c",
    "encryption_key_type": "procedure.key",
    "inventory": [
        {
            "name": "PROC_XDM_ORD_GD_MAINT",
            "encrypted_name": "89e68d17d531adb2101c65ec47c52f5842db972fd474b9a9fddc6696d6b94ecc",
            "type": "procedure",
            "database": "null",
            "encrypted_database": "null",
            "schema": "XDMADM",
            "encrypted_schema": "2ddcb6a6d265b3329028a96c19731808",
            "fully_qualified_name": "XDMADM.PROC_XDM_ORD_GD_MAINT",
            "encrypted_fqn": "2ddcb6a6d265b3329028a96c19731808.89e68d17d531adb2101c65ec47c52f5842db972fd474b9a9fddc6696d6b94ecc",
            "synonyms": [],
            "metadata_analysis": "CREATE OR REPLACE PROCEDURE \"2ddcb6a6d265b3329028a96c19731808\".\"89e68d17d531adb2101c65ec47c52f5842db972fd474b9a9fddc6696d6b94ecc\" IS\n   \n   c_success                   CONSTANT NUMBER := 0;\n   c_error                     CONSTANT NUMBER := 1;\n   c_schema                    CONSTANT VARCHAR2(30) := 'XDMADM';\n   c_tbl_nm           \t\t   CONSTANT VARCHAR2(30) := 'ORD_GD_CORP';\n   c_load_tbl_nm               CONSTANT VARCHAR2(30) := 'ORD_GD_CORP';\n\n   l_nbr_wks\t\t\t\t       NUMBER;\n   l_maint_wks            NUMBER;\n   l_return_code               NUMBER;\n   l_out_msg                   VARCHAR2(256);\n   l_out_msg2                  VARCHAR2(256);\n   l_number_of_wks\t\t\t   NUMBER;\n   l_partition_name\t\t\t   VARCHAR2(100);\n\nBEGIN\n\n\t\n        l_return_code := 5ded13d6d14659363f5e912cc49d5792.e5fc2ed6a30153bf2fcd229cf19469f4(c_schema, c_load_tbl_nm);\n    DBMS_OUTPUT.put_line('Analyze Table Return: ' || l_return_code || '-' || l_out_msg);\n\n  IF (l_return_code <> 0) THEN\n      DBMS_OUTPUT.put_line('Error: Failed to analyze table');\n    \n  Else\n       DBMS_OUTPUT.put_line('Table Analyzed');\n  End If;\n\n  \n  SELECT PARAM_VALUE_NBR\n  INTO l_maint_wks\n  FROM 2ddcb6a6d265b3329028a96c19731808.e28c3d06356e2f53d190d8ca9b253972\n  WHERE APP_NAME = 'PROC_ORD_GD_MAINT';\n\n\t\n\t  SELECT COUNT(DISTINCT WKLY_RUN_DT)\n  \tINTO l_nbr_wks\n  \tFROM 2ddcb6a6d265b3329028a96c19731808.9bab81acfd9a20cd7393c395041f4954;\n\n    \n\tIF l_nbr_wks > l_maint_wks THEN\n\t\t\n\t\tSelect 25dba3ee357520e7fbb06d44d4294eac.bab295d004d6316a3cb66d6e2a3b9abf\n\t\tInto L_Partition_Name\n\t\tFrom All_Objects Obj\n        , all_tab_partitions part\n\t\tWHERE 8ed37da78b0173e3de7b6390c914c9b3.a5435bb114c45f7cfb9b67fc5c92f6e5 = 'TABLE PARTITION'\n\t\tAnd 25dba3ee357520e7fbb06d44d4294eac.e54416cf798433b8d452fd1cdb2365d9 = 'ORD_GD_CORP'\n    And 25dba3ee357520e7fbb06d44d4294eac.739f11a26afeb306178a3e9cff0269b2 = 'XDMADM'\n    and 25dba3ee357520e7fbb06d44d4294eac.946ff0d4cf575845006ade10ae69c6f2 = 76d41cd1cdf9db59bf162e4915a066eaebf41c40720e31772748fc70eee95737.6ef6f4bc910761dbab006cd6168613c1\n    And 25dba3ee357520e7fbb06d44d4294eac.739f11a26afeb306178a3e9cff0269b2 = 7000ac0346d01caa04ae3fc822852be7.d0a22ffceae2e5cb49bc82d69a8869dd\n    and 25dba3ee357520e7fbb06d44d4294eac.bab295d004d6316a3cb66d6e2a3b9abf = 7000ac0346d01caa04ae3fc822852be7.9dc3171f96b351c0d3634e445d53c59d\n    And 7000ac0346d01caa04ae3fc822852be7.35a99b00b18153a85893d0a603e9916b>0\n    and 8ed37da78b0173e3de7b6390c914c9b3.5d1d3c2ad1dc0300826a82a983ae537b<>'ORD_GD_CORP_WK1'\n\t\tAnd 25dba3ee357520e7fbb06d44d4294eac.1648e4bcb2b242e53a65ab22cd7d9eef = (Select Min(25dba3ee357520e7fbb06d44d4294eac.1648e4bcb2b242e53a65ab22cd7d9eef)\n                  From All_Objects Obj2\n                  , all_tab_partitions part2\n                  WHERE e61c2bbc83ae2a4e4521ccb5ab981e00.a5435bb114c45f7cfb9b67fc5c92f6e5 = 8ed37da78b0173e3de7b6390c914c9b3.a5435bb114c45f7cfb9b67fc5c92f6e5\n                  And 25dba3ee357520e7fbb06d44d4294eac.e54416cf798433b8d452fd1cdb2365d9 = 25dba3ee357520e7fbb06d44d4294eac.e54416cf798433b8d452fd1cdb2365d9\n                  And 25dba3ee357520e7fbb06d44d4294eac.e54416cf798433b8d452fd1cdb2365d9 = c5e9db0c861e7a2ec35a2cca6f3087c5.0e8c5c4de29f10b5c6dc96871dbe0952\n                  and 25dba3ee357520e7fbb06d44d4294eac.bab295d004d6316a3cb66d6e2a3b9abf = c5e9db0c861e7a2ec35a2cca6f3087c5.9dc3171f96b351c0d3634e445d53c59d\n                  And 25dba3ee357520e7fbb06d44d4294eac.739f11a26afeb306178a3e9cff0269b2 = c5e9db0c861e7a2ec35a2cca6f3087c5.d0a22ffceae2e5cb49bc82d69a8869dd\n                  and c5e9db0c861e7a2ec35a2cca6f3087c5.57aea29376acf2aebe3c9a36673c7392>0\n                  And 25dba3ee357520e7fbb06d44d4294eac.739f11a26afeb306178a3e9cff0269b2 = 'XDMADM'\n                  and e61c2bbc83ae2a4e4521ccb5ab981e00.5d1d3c2ad1dc0300826a82a983ae537b<>'ORD_GD_CORP_WK1');\n\n\t\tl_return_code   :=\n         0c3f9d83b1e5d732f0d8f87c2ed0306e.984603c65e01f983383339bad7549c36.2b9b8c7ae3fc2c4c062858c3bff7a146(l_out_msg,\n                                             c_schema,\n                                             c_load_tbl_nm,\n                                             l_partition_name);\n\n\t  Dbms_Output.Put_Line('Drop Partition Return: ' || L_Return_Code );\n    Dbms_Output.Put_Line('outmssage ' || L_Out_Msg);\n\n      IF (l_return_code <> 0) THEN\n         DBMS_OUTPUT.put_line('Error: Failed to drop partition');\n       \n      END IF;\n  ELSE\n      DBMS_OUTPUT.put_line('No Partition to Drop');\n\tEND IF;\n\n\t\n        l_return_code := 5ded13d6d14659363f5e912cc49d5792.e5fc2ed6a30153bf2fcd229cf19469f4(c_schema, c_load_tbl_nm);\n    DBMS_OUTPUT.put_line('Analyze Table Return: ' || l_return_code || '-' || l_out_msg);\n\n  IF (l_return_code <> 0) THEN\n      DBMS_OUTPUT.put_line('Error: Failed to analyze table');\n    \n  ELSE\n       DBMS_OUTPUT.put_line('Table Analyzed');\n  END IF;\n\n  \n\nEXCEPTION\n   WHEN OTHERS THEN\n      DBMS_OUTPUT.put_line('Unexepected error');\n      DBMS_OUTPUT.put_line(SQLCODE || ': ' || SQLERRM);\n   \nEND; \n/",
            "upstream_dependencies": [],
            "downstream_dependencies": [],
            "dag_location": "null",
            "gantt_location": "null",
            "created_at": "null",
            "updated_at": "null"
        },
        {
            "name": "TRUNC_TBL",
            "encrypted_name": "a9fa9926b6d7764cee9f22ccf32f34f8",
            "type": "procedure",
            "database": "null",
            "encrypted_database": "null",
            "schema": "XDMADM",
            "encrypted_schema": "2ddcb6a6d265b3329028a96c19731808",
            "fully_qualified_name": "XDMADM.TRUNC_TBL",
            "encrypted_fqn": "2ddcb6a6d265b3329028a96c19731808.a9fa9926b6d7764cee9f22ccf32f34f8",
            "synonyms": [],
            "metadata_analysis": "CREATE OR REPLACE PROCEDURE \"2ddcb6a6d265b3329028a96c19731808\".\"a9fa9926b6d7764cee9f22ccf32f34f8\" (\n   p_trgt_schm        in varchar2 \n   ,p_trgt_tbl        in varchar2 \n   ,p_trgt_part       in varchar2 default null \n   ,p_trgt_type       in varchar2 default null \n) is\n v_trgt_schm     varchar2(30) := upper(p_trgt_schm);\n v_trgt_tbl      varchar2(30) := upper(p_trgt_tbl);\n v_trgt_part     varchar2(30) := upper(p_trgt_part);\n stmt            varchar2(32767);\nbegin\n if v_trgt_part is null then\n  stmt := 'truncate table ' || v_trgt_schm || '.' || v_trgt_tbl;\n  dbms_output.put_line(stmt);\n  execute immediate stmt;\n else\n  stmt := 'alter table ' || v_trgt_schm || '.' || v_trgt_tbl || ' truncate ' || p_trgt_type || '(' || v_trgt_part || ')';\n  dbms_output.put_line(stmt);\n  execute immediate stmt;\n end if;\nend trunc_tbl;\n/",
            "upstream_dependencies": [],
            "downstream_dependencies": [],
            "dag_location": "null",
            "gantt_location": "null",
            "created_at": "null",
            "updated_at": "null"
        },
        {
            "name": "INCR_LOAD_STAT",
            "encrypted_name": "52321dd05ff919168d056641c2826618",
            "type": "procedure",
            "database": "null",
            "encrypted_database": "null",
            "schema": "XDMADM",
            "encrypted_schema": "2ddcb6a6d265b3329028a96c19731808",
            "fully_qualified_name": "XDMADM.INCR_LOAD_STAT",
            "encrypted_fqn": "2ddcb6a6d265b3329028a96c19731808.52321dd05ff919168d056641c2826618",
            "synonyms": [],
            "metadata_analysis": "CREATE OR REPLACE PROCEDURE \"2ddcb6a6d265b3329028a96c19731808\".\"52321dd05ff919168d056641c2826618\" (p_fact_table IN VARCHAR2,\n                          p_div_nbr IN NUMBER,\n                          p_fact_typ_cd IN VARCHAR2,\n                          p_odate IN DATE) AS\n\n\n   c_enable_execute    CONSTANT INTEGER := 1; \n   c_enable_commit     CONSTANT INTEGER := 1; \n\n     l_corp_update_sql        VARCHAR2(8000);\n     l_ap_update_sql          VARCHAR2(8000);\n     l_reg_update_sql         VARCHAR2(2000);\n\t\t l_trans_update_sql       VARCHAR2(2000);\n     l_trans_typ              VARCHAR2(2);\n     l_fact_typ_cd            VARCHAR2(2);\n     l_fact_table             VARCHAR2(100);\n     l_div_nbr                NUMBER;\n     l_odate                  DATE;\n     maxPrcsDt                DATE;\n\nBEGIN\nl_fact_typ_cd := p_fact_typ_cd;\nl_fact_table := p_fact_table;\nl_div_nbr := p_div_nbr;\n\ndbms_output.put_line('Start');\n\n\nIF l_div_nbr = 0 THEN\n\n        DBMS_OUTPUT.put_line('Start Corporate Update for '||l_fact_table);\n                  UPDATE   5ded13d6d14659363f5e912cc49d5792.33089db804c0c75abd403d74f20b0dcd\n                     SET   div_load_ts   = sysdate,\n                           div_load_stat = div_load_stat + 1,\n                           latest_prcs_Dt = p_odate\n                   WHERE   fact_table = l_fact_table\n\t\t\t\t\t\t\t\t\t\t and   latest_prcs_Dt <= p_odate;\n\n                DBMS_OUTPUT.put_line('Updated ' || sql%ROWCOUNT || ' rows for ' || l_fact_table);\nEND IF;\n\nIF l_fact_table not in ('SALES_CORP', 'PO_CORP') and l_div_nbr != 0  THEN\n    DBMS_OUTPUT.put_line ('Start '||l_fact_table||' Update');\n     l_reg_update_sql  := 'update 5ded13d6d14659363f5e912cc49d5792.33089db804c0c75abd403d74f20b0dcd\n                   set  div_load_stat = div_load_stat + 1,\n                        div_load_ts = sysdate,\n                        latest_prcs_dt = '''||trunc(p_odate)||'''\n\t\t\t\t\t\t\t\t where  latest_prcs_dt <=  '''||trunc(p_odate)||'''\n\t\t\t\t\t\t\t\t  and   fact_table =''' ||l_fact_table||'''\n\t\t\t\t\t\t\t\t\tand   (div_nbr is null or div_nbr ='''|| l_div_nbr||''')\n\t\t\t\t\t\t\t\t  and   (fact_typ_cd is null or fact_typ_cd =''' ||l_fact_typ_cd||''')';\n    DBMS_OUTPUT.put_line(l_reg_update_sql);\n    EXECUTE IMMEDIATE  l_reg_update_sql;\n        DBMS_OUTPUT.put_line('Updated ' || sql%ROWCOUNT || ' rows for ' || p_fact_table);\n\n\n\nELSIF l_fact_table = 'SALES_CORP'  AND l_fact_typ_cd = 'RG' THEN\nDBMS_OUTPUT.put_line ('Start SALES_CORP RG Update');\n\nEXECUTE IMMEDIATE\n       'select max(prcs_dt)\n          from 606cb8ef2b1001c14a7350e19dfa6538.4e9c10cc327b88d207b2adf10ec0e261'||p_div_nbr||'_ext where trans_typ != ''AP'' and xfer_from_dt is null 'into maxPrcsDt ;\n                    dbms_output.put_line('Prcs_Dt for 606cb8ef2b1001c14a7350e19dfa6538.4e9c10cc327b88d207b2adf10ec0e261'||p_div_nbr||'_ext:'||maxPrcsDt);\n\n                    l_trans_update_sql    :=\n 'update 5ded13d6d14659363f5e912cc49d5792.33089db804c0c75abd403d74f20b0dcd\n  set    div_load_stat = div_load_stat +1,\n                 div_load_ts = sysdate,\n         latest_prcs_dt = '''||maxPrcsDt||'''\n  where  latest_prcs_dt <= '''||maxPrcsDt||'''\n  and    fact_table =''' ||l_fact_table||'''\n  and    div_nbr =' ||l_div_nbr || '\n  and    fact_typ_cd =''' ||l_fact_typ_cd||'''';\n\n                    dbms_output.put_line(l_trans_update_sql);\n\n           EXECUTE IMMEDIATE l_trans_update_sql;\n           DBMS_OUTPUT.put_line('Updated ' || sql%ROWCOUNT || ' REG SALES_CORP rows in FACT_LOAD_STAT');\n\n\nELSIF l_fact_table = 'PO_CORP'  AND l_fact_typ_cd = 'RG'  THEN\nDBMS_OUTPUT.put_line ('Start PO_CORP RG Update');\nEXECUTE IMMEDIATE\n       'select max(prcs_dt)\n          from 606cb8ef2b1001c14a7350e19dfa6538.80d31fe0ea18d3cbb78b8653f32c7e0a'||p_div_nbr||'_ext where trans_typ not in (''SB'', ''SS'') 'into maxPrcsDt ;\n             dbms_output.put_line('Prcs_Dt for 606cb8ef2b1001c14a7350e19dfa6538.80d31fe0ea18d3cbb78b8653f32c7e0a'||p_div_nbr||'_ext:'||maxPrcsDt);\n\n                    l_trans_update_sql    :=\n 'update 5ded13d6d14659363f5e912cc49d5792.33089db804c0c75abd403d74f20b0dcd\n  set    div_load_stat = div_load_stat +1,\n                 div_load_ts = sysdate,\n         latest_prcs_dt = '''||maxPrcsDt||'''\n  where  latest_prcs_dt <= '''||maxPrcsDt||'''\n  and    fact_table =''' ||l_fact_table||'''\n  and    div_nbr =' ||l_div_nbr || '\n  and    fact_typ_cd =''' ||l_fact_typ_cd||'''';\n           dbms_output.put_line(l_trans_update_sql);\n\n      EXECUTE IMMEDIATE l_trans_update_sql;\n     DBMS_OUTPUT.put_line('Updated ' || sql%ROWCOUNT || ' REG PO_CORP rows in FACT_LOAD_STAT');\n\n\nELSIF  l_fact_table = 'SALES_CORP' AND l_fact_typ_cd = 'AP' THEN\nDBMS_OUTPUT.put_line ('Start SALES CORP AP Update');\nEXECUTE IMMEDIATE\n       'select max(prcs_dt)\n          from 606cb8ef2b1001c14a7350e19dfa6538.4e9c10cc327b88d207b2adf10ec0e261'||p_div_nbr||'_ext where trans_typ = ''AP'' and xfer_from_dt is null 'into maxPrcsDt ;\n     dbms_output.put_line('Prcs_Dt for 606cb8ef2b1001c14a7350e19dfa6538.4e9c10cc327b88d207b2adf10ec0e261'||p_div_nbr||'_ext:'||maxPrcsDt);\n\n                          l_trans_update_sql    :=\n 'update 5ded13d6d14659363f5e912cc49d5792.33089db804c0c75abd403d74f20b0dcd\n  set    div_load_stat = div_load_stat +1,\n                 div_load_ts = sysdate,\n         latest_prcs_dt = '''||maxPrcsDt||'''\n  where  latest_prcs_dt <= '''||maxPrcsDt||'''\n  and    fact_table =''' ||l_fact_table||'''\n  and    div_nbr =' ||l_div_nbr || '\n  and    fact_typ_cd =''' ||l_fact_typ_cd||'''';\n            dbms_output.put_line(l_trans_update_sql);\n\n           EXECUTE IMMEDIATE l_trans_update_sql;\n           DBMS_OUTPUT.put_line('Updated ' || sql%ROWCOUNT || ' AP SALES_CORP rows in FACT_LOAD_STAT');\n\nELSIF l_fact_table = 'PO_CORP'  AND l_fact_typ_cd = 'SB' THEN\nDBMS_OUTPUT.put_line ('Start PO_CORP SB Update');\nEXECUTE IMMEDIATE\n       'select max(prcs_dt)\n          from 606cb8ef2b1001c14a7350e19dfa6538.80d31fe0ea18d3cbb78b8653f32c7e0a'||p_div_nbr||'_ext where trans_typ not in (''PR'', ''RC'', ''RA'') 'into maxPrcsDt ;\n     dbms_output.put_line('Prcs_Dt for 606cb8ef2b1001c14a7350e19dfa6538.4e9c10cc327b88d207b2adf10ec0e261'||p_div_nbr||'_ext:'||maxPrcsDt);\n\n                           l_trans_update_sql    :=\n 'update 5ded13d6d14659363f5e912cc49d5792.33089db804c0c75abd403d74f20b0dcd\n  set    div_load_stat = div_load_stat +1,\n                 div_load_ts = sysdate,\n         latest_prcs_dt = '''||maxPrcsDt||'''\n  where  latest_prcs_dt <= '''||maxPrcsDt||'''\n  and    fact_table =''' ||l_fact_table||'''\n  and    div_nbr =' ||l_div_nbr || '\n  and    fact_typ_cd =''' ||l_fact_typ_cd||'''';\n            dbms_output.put_line(l_trans_update_sql);\n\n           EXECUTE IMMEDIATE l_trans_update_sql;\n\n           DBMS_OUTPUT.put_line('Updated ' || sql%ROWCOUNT || ' SB PO_CORP rows in FACT_LOAD_STAT');\n            END IF;\n\n   IF (c_enable_commit = 1) THEN\n      COMMIT;\n            ELSE ROLLBACK;\n   END IF;\n\n   DBMS_OUTPUT.put_line ('End Process');\n\nEXCEPTION\n    WHEN NO_DATA_FOUND\n      THEN NULL;\n   WHEN OTHERS THEN\n      ROLLBACK;\n      DBMS_OUTPUT.put_line(SQLERRM || ':' || SQLERRM);\nEND incr_load_stat;\n/",
            "upstream_dependencies": [],
            "downstream_dependencies": [],
            "dag_location": "null",
            "gantt_location": "null",
            "created_at": "null",
            "updated_at": "null"
        },
        {
            "name": "RESET_LOAD_STAT",
            "encrypted_name": "65317d56b6c939b13dadc6ca7ee15000",
            "type": "procedure",
            "database": "null",
            "encrypted_database": "null",
            "schema": "XDMADM",
            "encrypted_schema": "2ddcb6a6d265b3329028a96c19731808",
            "fully_qualified_name": "XDMADM.RESET_LOAD_STAT",
            "encrypted_fqn": "2ddcb6a6d265b3329028a96c19731808.65317d56b6c939b13dadc6ca7ee15000",
            "synonyms": [],
            "metadata_analysis": "CREATE OR REPLACE PROCEDURE \"2ddcb6a6d265b3329028a96c19731808\".\"65317d56b6c939b13dadc6ca7ee15000\" (p_fact_table IN Varchar2,\n                               p_fact_typ_cd IN Varchar,\n                               p_fact_table_dsply_nm IN Varchar2,\n                               p_fact_typ_desc IN Varchar2,\n                               p_load_freq IN Varchar2,\n                               p_rpt_dsply_ind IN Varchar2,\n                               p_odate IN Date)\n       AS\n\n\n\nlatestPrcsdt            DATE;\nl_opo_div               NUMBER;\nl_fact_typ_cd           Varchar(2 Byte);\nl_fact_table            VARCHAR2(100);\nl_fact_table_dsply_nm   VARCHAR2(100);\nl_fact_typ_desc         VARCHAR2(100);\nl_load_freq             VARCHAR2(100);\nl_div_nbr               number;\nl_rpt_dsply_ind         VARCHAR2(2 Byte);\nl_day_of_week           Varchar2(100);\n\n  TYPE cur_type IS REF CURSOR;\n  div_cur  cur_type;\n    TYPE rec_ty IS RECORD\n  ( div_nbr NUMBER);\n\n  div_rec rec_ty;\n\nBEGIN\n\ndbms_output.put_line('Start');\n\ndbms_output.put_line('Delete inactive records');\n            DELETE FROM 5ded13d6d14659363f5e912cc49d5792.33089db804c0c75abd403d74f20b0dcd\n            WHERE div_nbr NOT IN (SELECT  5ded13d6d14659363f5e912cc49d5792.6e5c32168d75c8a36e8690f803edfd23.8d8390ff0a8c194daf6e133712ea6bc9\n                                 FROM   5ded13d6d14659363f5e912cc49d5792.6e5c32168d75c8a36e8690f803edfd23 dc\n                                  WHERE   (5ded13d6d14659363f5e912cc49d5792.6e5c32168d75c8a36e8690f803edfd23.f20ff5af3219e81cbb7593d49d92cd7e IS NULL\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tOR    5ded13d6d14659363f5e912cc49d5792.6e5c32168d75c8a36e8690f803edfd23.f86ebd39dad00a97e7a977a4c46db7db > SYSDATE)\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t AND    5ded13d6d14659363f5e912cc49d5792.6e5c32168d75c8a36e8690f803edfd23.7ae69b45dcca5f2b783df61fe59b714c IS NULL\n                                    AND   5ded13d6d14659363f5e912cc49d5792.6e5c32168d75c8a36e8690f803edfd23.37d173cca846617a2f79758e8392ecd5 > 0)\n                                    AND div_nbr != 0\n                                    AND fact_table = p_fact_table;\n                DBMS_OUTPUT.put_line('DELETED ' || sql%ROWCOUNT || ' rows for ' || p_fact_table);\n\n  OPEN div_cur FOR\n            SELECT   5ded13d6d14659363f5e912cc49d5792.6e5c32168d75c8a36e8690f803edfd23.8d8390ff0a8c194daf6e133712ea6bc9\n            FROM   5ded13d6d14659363f5e912cc49d5792.6e5c32168d75c8a36e8690f803edfd23 dc\n           WHERE   (5ded13d6d14659363f5e912cc49d5792.6e5c32168d75c8a36e8690f803edfd23.f20ff5af3219e81cbb7593d49d92cd7e IS NULL\n                    OR 5ded13d6d14659363f5e912cc49d5792.6e5c32168d75c8a36e8690f803edfd23.f86ebd39dad00a97e7a977a4c46db7db > SYSDATE)\n                    AND   5ded13d6d14659363f5e912cc49d5792.6e5c32168d75c8a36e8690f803edfd23.7ae69b45dcca5f2b783df61fe59b714c IS NULL\n                    AND   5ded13d6d14659363f5e912cc49d5792.6e5c32168d75c8a36e8690f803edfd23.37d173cca846617a2f79758e8392ecd5 > 0;\n\nLOOP\n  FETCH div_cur INTO div_rec;\n  EXIT WHEN div_cur%NOTFOUND;\n\n            l_fact_typ_cd := p_fact_typ_cd;\n            l_div_nbr := cb3282c078638f07b13a9f25e6f7bd8c.8d8390ff0a8c194daf6e133712ea6bc9;\n            l_fact_table := p_fact_table;\n            l_fact_table_dsply_nm:= p_fact_table_dsply_nm ;\n            l_fact_typ_desc := p_fact_typ_desc;\n            l_load_freq:= p_load_freq;\n\t\t\t\t\t\tl_rpt_dsply_ind:= p_rpt_dsply_ind;\n      dbms_output.put_line(l_fact_table ||' '|| l_div_nbr ||' ' || l_fact_typ_cd);\n\n        \n\n  INSERT INTO 5ded13d6d14659363f5e912cc49d5792.33089db804c0c75abd403d74f20b0dcd\n      (SELECT l_fact_table,l_div_nbr, l_fact_typ_cd, l_fact_table_dsply_nm, l_fact_typ_desc, TRUNC(p_odate), 1, (SYSDATE), TRUNC(p_odate),l_load_freq, l_rpt_dsply_ind\n         FROM div_corp div\n         WHERE 6e5c32168d75c8a36e8690f803edfd23.8d8390ff0a8c194daf6e133712ea6bc9 = l_div_nbr\n        AND NOT EXISTS (SELECT 1\n                            FROM 5ded13d6d14659363f5e912cc49d5792.33089db804c0c75abd403d74f20b0dcd org\n                           WHERE (c1910bccdd57062ccac47420c40e2843.8d8390ff0a8c194daf6e133712ea6bc9 =l_div_nbr or div_nbr = 0)\n                            AND   c1910bccdd57062ccac47420c40e2843.f2c833a931f5f1312fd85c6b6b8f67b7= l_fact_table\n\t                          AND  (c1910bccdd57062ccac47420c40e2843.92ac05241155ae43778fa8eb777fa97b is null or c1910bccdd57062ccac47420c40e2843.92ac05241155ae43778fa8eb777fa97b = l_fact_typ_cd))) ;\n\n            DBMS_OUTPUT.put_line('Inserted ' || sql%ROWCOUNT || ' rows for ' || l_fact_table);\n    END LOOP;\nCLOSE div_cur;\n\n    \n\n    SELECT   max(latest_prcs_dt)\n     INTO    latestPrcsdt\n     FROM    5ded13d6d14659363f5e912cc49d5792.33089db804c0c75abd403d74f20b0dcd\n     WHERE   fact_table = l_fact_table\n     AND     (fact_typ_cd is null or fact_typ_cd = l_fact_typ_cd);\n         DBMS_OUTPUT.put_line('Latest Prcs Dt '|| latestPrcsdt || ' ' || l_fact_table || ' ' || p_odate || ' ' || l_day_of_week);\n\n     SELECT trim(TO_CHAR(trunc(p_odate), 'DAY')) INTO l_day_of_week FROM dual;\n     DBMS_OUTPUT.put_line('Day of Week '|| l_day_of_week);\n\n     IF latestPrcsdt <= p_odate  AND (l_fact_typ_cd is null or l_fact_typ_cd not in ('AP', 'SB', 'SA')) THEN\n      dbms_output.put_line('Start Daily Update');\n\n         UPDATE 5ded13d6d14659363f5e912cc49d5792.33089db804c0c75abd403d74f20b0dcd\n          SET div_load_stat = 0,\n              div_load_ts = SYSDATE,\n              prcs_dt = p_odate +1\n        WHERE  fact_table = l_fact_table\n          AND (fact_typ_cd is null or fact_typ_cd = l_fact_typ_cd);\n    DBMS_OUTPUT.put_line('Updated' ||' '|| sql%ROWCOUNT || ' rows for ' || l_fact_table || ' ' || l_fact_typ_cd || ' ' || l_day_of_week);\n\n             ELSIF (l_fact_typ_cd in ('AP', 'SB', 'SA') and l_day_of_week ='SATURDAY') THEN\n             dbms_output.put_line('Start Weekly Update');\n\n\t\t\t\t\t\t  UPDATE 5ded13d6d14659363f5e912cc49d5792.33089db804c0c75abd403d74f20b0dcd\n                 SET div_load_stat = 0,\n                     div_load_ts = SYSDATE,\n                     prcs_dt = p_odate +1\n               WHERE fact_table = l_fact_table\n\t\t\t\t\t\t\t\tAND (fact_typ_cd is null or fact_typ_cd = l_fact_typ_cd);\n                 DBMS_OUTPUT.put_line('Updated' ||' '|| sql%ROWCOUNT || ' rows for ' || l_fact_table || ' ' || l_fact_typ_cd );\n              END IF;\nCOMMIT;\n     DBMS_OUTPUT.put_line ('End Process');\n\nEXCEPTION\n    WHEN NO_DATA_FOUND\n      THEN NULL;\n   WHEN OTHERS THEN\n      ROLLBACK;\n      DBMS_OUTPUT.put_line(SQLERRM || ':' || SQLERRM);\nEND reset_load_stat;\n/",
            "upstream_dependencies": [],
            "downstream_dependencies": [],
            "dag_location": "null",
            "gantt_location": "null",
            "created_at": "null",
            "updated_at": "null"
        },
        {
            "name": "FACT_LOAD_STAT_BAKUP",
            "encrypted_name": "63b73b47e5c7676e8b4910edff46ab825b41d78431b87c27a1c2e84ee343f76b",
            "type": "procedure",
            "database": "null",
            "encrypted_database": "null",
            "schema": "XDMADM",
            "encrypted_schema": "2ddcb6a6d265b3329028a96c19731808",
            "fully_qualified_name": "XDMADM.FACT_LOAD_STAT_BAKUP",
            "encrypted_fqn": "2ddcb6a6d265b3329028a96c19731808.63b73b47e5c7676e8b4910edff46ab825b41d78431b87c27a1c2e84ee343f76b",
            "synonyms": [],
            "metadata_analysis": "CREATE OR REPLACE PROCEDURE \"2ddcb6a6d265b3329028a96c19731808\".\"63b73b47e5c7676e8b4910edff46ab825b41d78431b87c27a1c2e84ee343f76b\" ( p_odate IN Date)\n   AS\n\n\n\nbakTs   CONSTANT DATE := SYSDATE;\n\nBEGIN\n\ndbms_output.put_line('Start');\ndbms_output.put_line('Insert into FACT_LOAD_STAT_BAK');\n\nInsert into 2ddcb6a6d265b3329028a96c19731808.63b73b47e5c7676e8b4910edff46ab82c7571154f79a0e35708e4ca563a942f2\n(select bakTs, fact_table, div_nbr, fact_typ_cd, fact_table_dsply_nm, fact_typ_desc, latest_prcs_dt, div_load_stat, div_load_ts, prcs_dt, load_freq, rpt_dsply_ind from fact_load_stat);\n\nDBMS_OUTPUT.put_line('INSERTED ' || sql%ROWCOUNT || ' rows into FACT_LOAD_STAT_BAK');\n\n     DBMS_OUTPUT.put_line ('End Process');\nCOMMIT;\n\nEXCEPTION\n    WHEN NO_DATA_FOUND\n      THEN NULL;\n   WHEN OTHERS THEN\n      ROLLBACK;\n      DBMS_OUTPUT.put_line(SQLERRM || ':' || SQLERRM);\n\nEND FACT_LOAD_STAT_BAKUP;\n/",
            "upstream_dependencies": [],
            "downstream_dependencies": [],
            "dag_location": "null",
            "gantt_location": "null",
            "created_at": "null",
            "updated_at": "null"
        },
        {
            "name": "COMPRESS_SUBPARTITION",
            "encrypted_name": "fd8c623d72ef2c02397ace273c3d5a004add06061f1d0aca459dcd274ff0e987",
            "type": "procedure",
            "database": "null",
            "encrypted_database": "null",
            "schema": "XDMADM",
            "encrypted_schema": "2ddcb6a6d265b3329028a96c19731808",
            "fully_qualified_name": "XDMADM.COMPRESS_SUBPARTITION",
            "encrypted_fqn": "2ddcb6a6d265b3329028a96c19731808.fd8c623d72ef2c02397ace273c3d5a004add06061f1d0aca459dcd274ff0e987",
            "synonyms": [],
            "metadata_analysis": "CREATE OR REPLACE PROCEDURE \"2ddcb6a6d265b3329028a96c19731808\".\"fd8c623d72ef2c02397ace273c3d5a004add06061f1d0aca459dcd274ff0e987\"\n(\np_schm   varchar2,\np_tbl    varchar2,\np_end_dt date\n)\nAS\n  l_highval     VARCHAR2(4000);\n  i_highval     VARCHAR2(4000);\n  l_subhighval  VARCHAR2(4000);\n  i_subhighval  VARCHAR2(4000);\n  v_div_nbr     number;\n  v_tgt_tab     varchar2(32);\n  v_end_dt      date;\n  v_stmt1       varchar2(2000);\n  v_stmt2       varchar2(2000);\n  \n  v_sls_compr_intvl NUMBER;\n  v_skip_sls_compr_intvl NUMBER;\nBEGIN\n  v_div_nbr := substr(p_tbl,instr(p_tbl,'_')+1);\n  dbms_output.put_line('Div Nbr: '|| v_div_nbr);\n  v_tgt_tab := substr(p_tbl,1,instr(p_tbl,'_'))||'CORP';\n  dbms_output.put_line('TGT Tab: '|| v_tgt_tab);\n\n\n\n\n\n\n     <<RETRIEVE_SKIP_SLS_COMPR_INTRVL>>\n      BEGIN\n\n            SELECT param_value_nbr\n              INTO v_skip_sls_compr_intvl\n              FROM 5ded13d6d14659363f5e912cc49d5792.571e59d82c7b9e71dfa8dc36478a5c3c\n             WHERE app_name = 'COMPRESSION'\n               AND param_type = 'COMPR_INTVL'\n               AND param_code = 'SKIP_SLS_COMPR_INTVL';\n\n             dbms_output.put_line('Skip Sales Compression Interval from param value is: ' || v_skip_sls_compr_intvl);\n\n             EXCEPTION\n                  WHEN NO_DATA_FOUND THEN\n                      DBMS_OUTPUT.PUT_LINE ('No Data Found in PARAM_VALUE where app_name = COMPRESSION and param_type = COMPR_INTVL and param_code = SKIP_SLS_COMPR_INTVL');\n                      DBMS_OUTPUT.PUT_LINE ('Exception Encountered: '||SQLCODE||' - '|| SQLERRM);\n                      RAISE;\n                  WHEN OTHERS THEN\n                      DBMS_OUTPUT.PUT_LINE('Exception Encountered: '||SQLCODE||' - '|| SQLERRM);\n                      RAISE;\n      END;\n\n\n\n\n\n  IF p_end_dt IS NULL THEN\n      BEGIN\n            \n            SELECT param_value_nbr\n              INTO v_sls_compr_intvl\n              FROM 5ded13d6d14659363f5e912cc49d5792.571e59d82c7b9e71dfa8dc36478a5c3c\n             WHERE app_name = 'COMPRESSION'\n               AND param_type = 'COMPR_INTVL'\n               AND param_code = 'SLS_COMPR_INTVL';\n\n             dbms_output.put_line('Sales Compression Interval from param value is: ' || v_sls_compr_intvl);\n\n             EXCEPTION\n                  WHEN NO_DATA_FOUND THEN\n                      DBMS_OUTPUT.PUT_LINE ('No Data Found in PARAM_VALUE where app_name = COMPRESSION and param_type = COMPR_INTVL and param_code = SLS_COMPR_INTVL');\n                      DBMS_OUTPUT.PUT_LINE ('Exception Encountered: '||SQLCODE||' - '|| SQLERRM);\n                      RAISE;\n                  WHEN OTHERS THEN\n                      DBMS_OUTPUT.PUT_LINE('Exception Encountered: '||SQLCODE||' - '|| SQLERRM);\n                      RAISE;\n      END;\n    \n    \n      v_end_dt := sysdate-v_sls_compr_intvl;\n  ELSE\n    v_end_dt := p_end_dt;\n  END IF;\n  dbms_output.put_line ('End Dt: '||v_end_dt);\n\n\n  FOR c1 IN (SELECT partition_name\n                   ,high_value\n               FROM user_tab_partitions\n              WHERE table_name = v_tgt_tab\n              ORDER BY partition_position DESC)\n  LOOP\n    \n\n    l_highval := face9ce394f23afac3740446e0543a05.4ce859ad78e19ebef92089dc9633319e;\n    \n    l_highval := substr(l_highval, 11, 11);\n    \n\n\n \n    IF to_date(l_highval,'yyyy-mm-dd') < SYSDATE-v_skip_sls_compr_intvl THEN\n        dbms_output.put_line('Partition: '||face9ce394f23afac3740446e0543a05.5d8ac05e1f80ed2c3930257230fd8804|| ' HV: '||l_highval);\n        FOR c2 IN (SELECT subpartition_name,tablespace_name, compress_for\n                         ,high_value\n                     FROM user_tab_subpartitions\n                    WHERE table_name = v_tgt_tab\n                      AND partition_name = face9ce394f23afac3740446e0543a05.5d8ac05e1f80ed2c3930257230fd8804\n                    ORDER BY subpartition_position)\n        LOOP\n            l_subhighval := a8316c93a70d463dd9046d70905a41e0.4ce859ad78e19ebef92089dc9633319e;\n\n            IF l_subhighval = to_char(v_div_nbr) THEN\n                dbms_output.put_line('Subpartition: '||a8316c93a70d463dd9046d70905a41e0.56ea15b71c311dca79ce908ab994e131faa8bbc1e6c994f497874a7d3dec9509|| ' HV: '||l_subhighval||' FOR: '||a8316c93a70d463dd9046d70905a41e0.b7b72595a28e80a483d2c3d06f7b30df);\n                v_stmt1 := 'ALTER TABLE '||p_schm||'.'||v_tgt_tab||' MOVE SUBPARTITION '||a8316c93a70d463dd9046d70905a41e0.56ea15b71c311dca79ce908ab994e131faa8bbc1e6c994f497874a7d3dec9509|| ' TABLESPACE '||a8316c93a70d463dd9046d70905a41e0.68b322594628401367fd543b5dfaf772||' COMPRESS FOR '||a8316c93a70d463dd9046d70905a41e0.b7b72595a28e80a483d2c3d06f7b30df;\n                dbms_output.put_line(v_stmt1);\n                BEGIN\n                  execute immediate (v_stmt1);\n                  EXCEPTION\n                    WHEN OTHERS THEN\n                      dbms_output.put_line('sql: '||v_stmt1);\n                      dbms_output.put_line('Exception Encountered: '||SQLCODE||' - '|| SQLERRM);\n                  RAISE;\n                END;\n                EXIT;\n            END IF;\n        END LOOP;\n      IF to_date(l_highval,'yyyy-mm-dd') < v_end_dt THEN\n        EXIT;\n      END IF;\n    END IF;\n  END LOOP;\n\n  FOR i0 in (SELECT index_name\n               FROM user_indexes\n              WHERE table_owner = p_schm AND table_name = v_tgt_tab)\n  LOOP\n    FOR i1 IN (SELECT partition_name\n                     ,high_value\n                 FROM user_ind_partitions\n                WHERE index_name = e9a1402cad47ef88aa53981f5620271e.4a5d8299465ed0c94de9fa9b4242c7a3\n                ORDER BY partition_position DESC)\n    LOOP\n      \n      i_highval := 9596bc213dfced86fa18f67ff01eb6a5.4ce859ad78e19ebef92089dc9633319e;\n      \n      i_highval := substr(i_highval, 11, 11);\n\n    \n        IF to_date(i_highval,'yyyy-mm-dd') < SYSDATE-v_skip_sls_compr_intvl THEN\n          dbms_output.put_line('Partition: '||9596bc213dfced86fa18f67ff01eb6a5.5d8ac05e1f80ed2c3930257230fd8804|| ' HV: '||i_highval);\n          FOR i2 IN (SELECT subpartition_name,tablespace_name\n                           ,high_value\n                       FROM user_ind_subpartitions\n                      WHERE index_name = e9a1402cad47ef88aa53981f5620271e.4a5d8299465ed0c94de9fa9b4242c7a3\n                        AND partition_name = 9596bc213dfced86fa18f67ff01eb6a5.5d8ac05e1f80ed2c3930257230fd8804\n                      ORDER BY subpartition_position)\n          LOOP\n              i_subhighval := 7df9f255161b6a2c42757b125330c065.4ce859ad78e19ebef92089dc9633319e;\n\n              IF i_subhighval = to_char(v_div_nbr) THEN\n                dbms_output.put_line('Subpartition: '||7df9f255161b6a2c42757b125330c065.56ea15b71c311dca79ce908ab994e131faa8bbc1e6c994f497874a7d3dec9509|| ' HV: '||i_subhighval);\n                v_stmt2 := 'ALTER INDEX '||p_schm||'.'||e9a1402cad47ef88aa53981f5620271e.4a5d8299465ed0c94de9fa9b4242c7a3||' REBUILD SUBPARTITION '||7df9f255161b6a2c42757b125330c065.56ea15b71c311dca79ce908ab994e131faa8bbc1e6c994f497874a7d3dec9509|| ' TABLESPACE '||7df9f255161b6a2c42757b125330c065.68b322594628401367fd543b5dfaf772;\n                dbms_output.put_line(v_stmt2);\n                BEGIN\n                  execute immediate (v_stmt2);\n                  EXCEPTION\n                    WHEN OTHERS THEN\n                      dbms_output.put_line('sql: '||v_stmt1);\n                      dbms_output.put_line('Exception Encountered: '||SQLCODE||' - '|| SQLERRM);\n                  RAISE;\n                END;\n                EXIT;\n              END IF;\n          END LOOP;\n        IF to_date(i_highval,'yyyy-mm-dd') < v_end_dt THEN\n          EXIT;\n        END IF;\n      END IF;\n    END LOOP;\n  END LOOP;\nend compress_subpartition;\n/",
            "upstream_dependencies": [],
            "downstream_dependencies": [],
            "dag_location": "null",
            "gantt_location": "null",
            "created_at": "null",
            "updated_at": "null"
        }
    ]
}