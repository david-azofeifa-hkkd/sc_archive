{
    "filename": "DDL_procedure.sql",
    "numb_objects": 6,
    "type": "procedure",
    "type_hex": "df54cdd7d9c94653de5c660822e14611",
    "encryption_key_type": "procedure.key",
    "inventory": [
        {
            "name": "PROC_XDM_ORD_GD_MAINT",
            "encrypted_name": "1a0b95680b7d9e538efafa688ff8a95cc707728726215623ef68b235f06803f9",
            "type": "procedure",
            "database": "null",
            "encrypted_database": "null",
            "schema": "XDMADM",
            "encrypted_schema": "d3ababae562e77f4eac89c2a2f1f69ba",
            "fully_qualified_name": "XDMADM.PROC_XDM_ORD_GD_MAINT",
            "encrypted_fqn": "d3ababae562e77f4eac89c2a2f1f69ba.1a0b95680b7d9e538efafa688ff8a95cc707728726215623ef68b235f06803f9",
            "synonyms": [],
            "metadata_analysis": "CREATE OR REPLACE PROCEDURE \"d3ababae562e77f4eac89c2a2f1f69ba\".\"1a0b95680b7d9e538efafa688ff8a95cc707728726215623ef68b235f06803f9\" IS\n   \n   c_success                   CONSTANT NUMBER := 0;\n   c_error                     CONSTANT NUMBER := 1;\n   c_schema                    CONSTANT VARCHAR2(30) := 'XDMADM';\n   c_tbl_nm           \t\t   CONSTANT VARCHAR2(30) := 'ORD_GD_CORP';\n   c_load_tbl_nm               CONSTANT VARCHAR2(30) := 'ORD_GD_CORP';\n\n   l_nbr_wks\t\t\t\t       NUMBER;\n   l_maint_wks            NUMBER;\n   l_return_code               NUMBER;\n   l_out_msg                   VARCHAR2(256);\n   l_out_msg2                  VARCHAR2(256);\n   l_number_of_wks\t\t\t   NUMBER;\n   l_partition_name\t\t\t   VARCHAR2(100);\n\nBEGIN\n\n\t\n        l_return_code := f3b0e17ff5eb20389464b74702fe30c3.cac2ca0c0cf5cb6441cfc85da396d4ad(c_schema, c_load_tbl_nm);\n    DBMS_OUTPUT.put_line('Analyze Table Return: ' || l_return_code || '-' || l_out_msg);\n\n  IF (l_return_code <> 0) THEN\n      DBMS_OUTPUT.put_line('Error: Failed to analyze table');\n    \n  Else\n       DBMS_OUTPUT.put_line('Table Analyzed');\n  End If;\n\n  \n  SELECT PARAM_VALUE_NBR\n  INTO l_maint_wks\n  FROM d3ababae562e77f4eac89c2a2f1f69ba.0d6aea263e1e273595b5a84b4200cf7f\n  WHERE APP_NAME = 'PROC_ORD_GD_MAINT';\n\n\t\n\t  SELECT COUNT(DISTINCT WKLY_RUN_DT)\n  \tINTO l_nbr_wks\n  \tFROM d3ababae562e77f4eac89c2a2f1f69ba.6e91a0c3cbf0d56666b892a075f94a73;\n\n    \n\tIF l_nbr_wks > l_maint_wks THEN\n\t\t\n\t\tSelect a4a438bf1919c284ae6692cec68a8321.d2e8ffd21bf22640d01bf4b8fee87b20\n\t\tInto L_Partition_Name\n\t\tFrom All_Objects Obj\n        , all_tab_partitions part\n\t\tWHERE 4c4c98fe6fd0fd49f59528245333c0c3.447371bbb156b31174302b440e265a9c = 'TABLE PARTITION'\n\t\tAnd a4a438bf1919c284ae6692cec68a8321.a62705b6d5da2caf495181a9e487af07 = 'ORD_GD_CORP'\n    And a4a438bf1919c284ae6692cec68a8321.bc20601ca3684c31df9172ee7f4c0105 = 'XDMADM'\n    and a4a438bf1919c284ae6692cec68a8321.692307c20668b4608908607c837a1f3a = bee8bd6a2bf43673bac00f8155e79597190a7797194adc5b8483580b12fa7adc.b40bd215329edaf2e38bc9a3dc55e796\n    And a4a438bf1919c284ae6692cec68a8321.bc20601ca3684c31df9172ee7f4c0105 = ed8dea1d8e56ac96b3ca409dc283cee9.eb83aef9826767eb4f29a3ecd924c08a\n    and a4a438bf1919c284ae6692cec68a8321.d2e8ffd21bf22640d01bf4b8fee87b20 = ed8dea1d8e56ac96b3ca409dc283cee9.a2be344c2865fa4fadf4c2f4a561e103\n    And ed8dea1d8e56ac96b3ca409dc283cee9.5ad76902ba167d46abc4106bd1d0912a>0\n    and 4c4c98fe6fd0fd49f59528245333c0c3.be138b170084507d86119d99160bae66<>'ORD_GD_CORP_WK1'\n\t\tAnd a4a438bf1919c284ae6692cec68a8321.534b38219c398dd0181bae661d5243d6 = (Select Min(a4a438bf1919c284ae6692cec68a8321.534b38219c398dd0181bae661d5243d6)\n                  From All_Objects Obj2\n                  , all_tab_partitions part2\n                  WHERE 89124b9f26dc57fdbe14cfcfe801859a.447371bbb156b31174302b440e265a9c = 4c4c98fe6fd0fd49f59528245333c0c3.447371bbb156b31174302b440e265a9c\n                  And a4a438bf1919c284ae6692cec68a8321.a62705b6d5da2caf495181a9e487af07 = a4a438bf1919c284ae6692cec68a8321.a62705b6d5da2caf495181a9e487af07\n                  And a4a438bf1919c284ae6692cec68a8321.a62705b6d5da2caf495181a9e487af07 = 65511779aaf10c23c1da579db14aa369.2477f7d36413e0eba98d9f209ba15e94\n                  and a4a438bf1919c284ae6692cec68a8321.d2e8ffd21bf22640d01bf4b8fee87b20 = 65511779aaf10c23c1da579db14aa369.a2be344c2865fa4fadf4c2f4a561e103\n                  And a4a438bf1919c284ae6692cec68a8321.bc20601ca3684c31df9172ee7f4c0105 = 65511779aaf10c23c1da579db14aa369.eb83aef9826767eb4f29a3ecd924c08a\n                  and 65511779aaf10c23c1da579db14aa369.a980fc8a04baaaa2b4c0cb941d628a76>0\n                  And a4a438bf1919c284ae6692cec68a8321.bc20601ca3684c31df9172ee7f4c0105 = 'XDMADM'\n                  and 89124b9f26dc57fdbe14cfcfe801859a.be138b170084507d86119d99160bae66<>'ORD_GD_CORP_WK1');\n\n\t\tl_return_code   :=\n         425d5bcc4f7a46b82ef9348a7cdf883b.323964bef14f9091d1b6676a5ca3bb45.e4bfe5c2577322aa81b163f5f0fa9912(l_out_msg,\n                                             c_schema,\n                                             c_load_tbl_nm,\n                                             l_partition_name);\n\n\t  Dbms_Output.Put_Line('Drop Partition Return: ' || L_Return_Code );\n    Dbms_Output.Put_Line('outmssage ' || L_Out_Msg);\n\n      IF (l_return_code <> 0) THEN\n         DBMS_OUTPUT.put_line('Error: Failed to drop partition');\n       \n      END IF;\n  ELSE\n      DBMS_OUTPUT.put_line('No Partition to Drop');\n\tEND IF;\n\n\t\n        l_return_code := f3b0e17ff5eb20389464b74702fe30c3.cac2ca0c0cf5cb6441cfc85da396d4ad(c_schema, c_load_tbl_nm);\n    DBMS_OUTPUT.put_line('Analyze Table Return: ' || l_return_code || '-' || l_out_msg);\n\n  IF (l_return_code <> 0) THEN\n      DBMS_OUTPUT.put_line('Error: Failed to analyze table');\n    \n  ELSE\n       DBMS_OUTPUT.put_line('Table Analyzed');\n  END IF;\n\n  \n\nEXCEPTION\n   WHEN OTHERS THEN\n      DBMS_OUTPUT.put_line('Unexepected error');\n      DBMS_OUTPUT.put_line(SQLCODE || ': ' || SQLERRM);\n   \nEND; \n/",
            "upstream_dependencies": [],
            "downstream_dependencies": [
                "XDMADM.PROC_XDM_ORD_GD_MAINT"
            ],
            "dag_location": "null",
            "gantt_location": "null",
            "created_at": "null",
            "updated_at": "null"
        },
        {
            "name": "TRUNC_TBL",
            "encrypted_name": "595096a033c46941175d509d27094c02",
            "type": "procedure",
            "database": "null",
            "encrypted_database": "null",
            "schema": "XDMADM",
            "encrypted_schema": "d3ababae562e77f4eac89c2a2f1f69ba",
            "fully_qualified_name": "XDMADM.TRUNC_TBL",
            "encrypted_fqn": "d3ababae562e77f4eac89c2a2f1f69ba.595096a033c46941175d509d27094c02",
            "synonyms": [],
            "metadata_analysis": "CREATE OR REPLACE PROCEDURE \"d3ababae562e77f4eac89c2a2f1f69ba\".\"595096a033c46941175d509d27094c02\" (\n   p_trgt_schm        in varchar2 \n   ,p_trgt_tbl        in varchar2 \n   ,p_trgt_part       in varchar2 default null \n   ,p_trgt_type       in varchar2 default null \n) is\n v_trgt_schm     varchar2(30) := upper(p_trgt_schm);\n v_trgt_tbl      varchar2(30) := upper(p_trgt_tbl);\n v_trgt_part     varchar2(30) := upper(p_trgt_part);\n stmt            varchar2(32767);\nbegin\n if v_trgt_part is null then\n  stmt := 'truncate table ' || v_trgt_schm || '.' || v_trgt_tbl;\n  dbms_output.put_line(stmt);\n  execute immediate stmt;\n else\n  stmt := 'alter table ' || v_trgt_schm || '.' || v_trgt_tbl || ' truncate ' || p_trgt_type || '(' || v_trgt_part || ')';\n  dbms_output.put_line(stmt);\n  execute immediate stmt;\n end if;\nend trunc_tbl;\n/",
            "upstream_dependencies": [],
            "downstream_dependencies": [
                "XDMADM.TRUNC_TBL"
            ],
            "dag_location": "null",
            "gantt_location": "null",
            "created_at": "null",
            "updated_at": "null"
        },
        {
            "name": "INCR_LOAD_STAT",
            "encrypted_name": "ad17c6121dbc118c130d0a29612ab4f4",
            "type": "procedure",
            "database": "null",
            "encrypted_database": "null",
            "schema": "XDMADM",
            "encrypted_schema": "d3ababae562e77f4eac89c2a2f1f69ba",
            "fully_qualified_name": "XDMADM.INCR_LOAD_STAT",
            "encrypted_fqn": "d3ababae562e77f4eac89c2a2f1f69ba.ad17c6121dbc118c130d0a29612ab4f4",
            "synonyms": [],
            "metadata_analysis": "CREATE OR REPLACE PROCEDURE \"d3ababae562e77f4eac89c2a2f1f69ba\".\"ad17c6121dbc118c130d0a29612ab4f4\" (p_fact_table IN VARCHAR2,\n                          p_div_nbr IN NUMBER,\n                          p_fact_typ_cd IN VARCHAR2,\n                          p_odate IN DATE) AS\n\n\n   c_enable_execute    CONSTANT INTEGER := 1; \n   c_enable_commit     CONSTANT INTEGER := 1; \n\n     l_corp_update_sql        VARCHAR2(8000);\n     l_ap_update_sql          VARCHAR2(8000);\n     l_reg_update_sql         VARCHAR2(2000);\n\t\t l_trans_update_sql       VARCHAR2(2000);\n     l_trans_typ              VARCHAR2(2);\n     l_fact_typ_cd            VARCHAR2(2);\n     l_fact_table             VARCHAR2(100);\n     l_div_nbr                NUMBER;\n     l_odate                  DATE;\n     maxPrcsDt                DATE;\n\nBEGIN\nl_fact_typ_cd := p_fact_typ_cd;\nl_fact_table := p_fact_table;\nl_div_nbr := p_div_nbr;\n\ndbms_output.put_line('Start');\n\n\nIF l_div_nbr = 0 THEN\n\n        DBMS_OUTPUT.put_line('Start Corporate Update for '||l_fact_table);\n                  UPDATE   f3b0e17ff5eb20389464b74702fe30c3.dffd5712cbb020a43643a0ea4b9caf73\n                     SET   div_load_ts   = sysdate,\n                           div_load_stat = div_load_stat + 1,\n                           latest_prcs_Dt = p_odate\n                   WHERE   fact_table = l_fact_table\n\t\t\t\t\t\t\t\t\t\t and   latest_prcs_Dt <= p_odate;\n\n                DBMS_OUTPUT.put_line('Updated ' || sql%ROWCOUNT || ' rows for ' || l_fact_table);\nEND IF;\n\nIF l_fact_table not in ('SALES_CORP', 'PO_CORP') and l_div_nbr != 0  THEN\n    DBMS_OUTPUT.put_line ('Start '||l_fact_table||' Update');\n     l_reg_update_sql  := 'update f3b0e17ff5eb20389464b74702fe30c3.dffd5712cbb020a43643a0ea4b9caf73\n                   set  div_load_stat = div_load_stat + 1,\n                        div_load_ts = sysdate,\n                        latest_prcs_dt = '''||trunc(p_odate)||'''\n\t\t\t\t\t\t\t\t where  latest_prcs_dt <=  '''||trunc(p_odate)||'''\n\t\t\t\t\t\t\t\t  and   fact_table =''' ||l_fact_table||'''\n\t\t\t\t\t\t\t\t\tand   (div_nbr is null or div_nbr ='''|| l_div_nbr||''')\n\t\t\t\t\t\t\t\t  and   (fact_typ_cd is null or fact_typ_cd =''' ||l_fact_typ_cd||''')';\n    DBMS_OUTPUT.put_line(l_reg_update_sql);\n    EXECUTE IMMEDIATE  l_reg_update_sql;\n        DBMS_OUTPUT.put_line('Updated ' || sql%ROWCOUNT || ' rows for ' || p_fact_table);\n\n\n\nELSIF l_fact_table = 'SALES_CORP'  AND l_fact_typ_cd = 'RG' THEN\nDBMS_OUTPUT.put_line ('Start SALES_CORP RG Update');\n\nEXECUTE IMMEDIATE\n       'select max(prcs_dt)\n          from 0ea093d85d1672d659a7eeba663c27fd.b04adb6e8221ed70af7f86eb491fdf88'||p_div_nbr||'_ext where trans_typ != ''AP'' and xfer_from_dt is null 'into maxPrcsDt ;\n                    dbms_output.put_line('Prcs_Dt for 0ea093d85d1672d659a7eeba663c27fd.b04adb6e8221ed70af7f86eb491fdf88'||p_div_nbr||'_ext:'||maxPrcsDt);\n\n                    l_trans_update_sql    :=\n 'update f3b0e17ff5eb20389464b74702fe30c3.dffd5712cbb020a43643a0ea4b9caf73\n  set    div_load_stat = div_load_stat +1,\n                 div_load_ts = sysdate,\n         latest_prcs_dt = '''||maxPrcsDt||'''\n  where  latest_prcs_dt <= '''||maxPrcsDt||'''\n  and    fact_table =''' ||l_fact_table||'''\n  and    div_nbr =' ||l_div_nbr || '\n  and    fact_typ_cd =''' ||l_fact_typ_cd||'''';\n\n                    dbms_output.put_line(l_trans_update_sql);\n\n           EXECUTE IMMEDIATE l_trans_update_sql;\n           DBMS_OUTPUT.put_line('Updated ' || sql%ROWCOUNT || ' REG SALES_CORP rows in FACT_LOAD_STAT');\n\n\nELSIF l_fact_table = 'PO_CORP'  AND l_fact_typ_cd = 'RG'  THEN\nDBMS_OUTPUT.put_line ('Start PO_CORP RG Update');\nEXECUTE IMMEDIATE\n       'select max(prcs_dt)\n          from 0ea093d85d1672d659a7eeba663c27fd.2bdc1abe7c5bd414834d4fcb52394dc9'||p_div_nbr||'_ext where trans_typ not in (''SB'', ''SS'') 'into maxPrcsDt ;\n             dbms_output.put_line('Prcs_Dt for 0ea093d85d1672d659a7eeba663c27fd.2bdc1abe7c5bd414834d4fcb52394dc9'||p_div_nbr||'_ext:'||maxPrcsDt);\n\n                    l_trans_update_sql    :=\n 'update f3b0e17ff5eb20389464b74702fe30c3.dffd5712cbb020a43643a0ea4b9caf73\n  set    div_load_stat = div_load_stat +1,\n                 div_load_ts = sysdate,\n         latest_prcs_dt = '''||maxPrcsDt||'''\n  where  latest_prcs_dt <= '''||maxPrcsDt||'''\n  and    fact_table =''' ||l_fact_table||'''\n  and    div_nbr =' ||l_div_nbr || '\n  and    fact_typ_cd =''' ||l_fact_typ_cd||'''';\n           dbms_output.put_line(l_trans_update_sql);\n\n      EXECUTE IMMEDIATE l_trans_update_sql;\n     DBMS_OUTPUT.put_line('Updated ' || sql%ROWCOUNT || ' REG PO_CORP rows in FACT_LOAD_STAT');\n\n\nELSIF  l_fact_table = 'SALES_CORP' AND l_fact_typ_cd = 'AP' THEN\nDBMS_OUTPUT.put_line ('Start SALES CORP AP Update');\nEXECUTE IMMEDIATE\n       'select max(prcs_dt)\n          from 0ea093d85d1672d659a7eeba663c27fd.b04adb6e8221ed70af7f86eb491fdf88'||p_div_nbr||'_ext where trans_typ = ''AP'' and xfer_from_dt is null 'into maxPrcsDt ;\n     dbms_output.put_line('Prcs_Dt for 0ea093d85d1672d659a7eeba663c27fd.b04adb6e8221ed70af7f86eb491fdf88'||p_div_nbr||'_ext:'||maxPrcsDt);\n\n                          l_trans_update_sql    :=\n 'update f3b0e17ff5eb20389464b74702fe30c3.dffd5712cbb020a43643a0ea4b9caf73\n  set    div_load_stat = div_load_stat +1,\n                 div_load_ts = sysdate,\n         latest_prcs_dt = '''||maxPrcsDt||'''\n  where  latest_prcs_dt <= '''||maxPrcsDt||'''\n  and    fact_table =''' ||l_fact_table||'''\n  and    div_nbr =' ||l_div_nbr || '\n  and    fact_typ_cd =''' ||l_fact_typ_cd||'''';\n            dbms_output.put_line(l_trans_update_sql);\n\n           EXECUTE IMMEDIATE l_trans_update_sql;\n           DBMS_OUTPUT.put_line('Updated ' || sql%ROWCOUNT || ' AP SALES_CORP rows in FACT_LOAD_STAT');\n\nELSIF l_fact_table = 'PO_CORP'  AND l_fact_typ_cd = 'SB' THEN\nDBMS_OUTPUT.put_line ('Start PO_CORP SB Update');\nEXECUTE IMMEDIATE\n       'select max(prcs_dt)\n          from 0ea093d85d1672d659a7eeba663c27fd.2bdc1abe7c5bd414834d4fcb52394dc9'||p_div_nbr||'_ext where trans_typ not in (''PR'', ''RC'', ''RA'') 'into maxPrcsDt ;\n     dbms_output.put_line('Prcs_Dt for 0ea093d85d1672d659a7eeba663c27fd.b04adb6e8221ed70af7f86eb491fdf88'||p_div_nbr||'_ext:'||maxPrcsDt);\n\n                           l_trans_update_sql    :=\n 'update f3b0e17ff5eb20389464b74702fe30c3.dffd5712cbb020a43643a0ea4b9caf73\n  set    div_load_stat = div_load_stat +1,\n                 div_load_ts = sysdate,\n         latest_prcs_dt = '''||maxPrcsDt||'''\n  where  latest_prcs_dt <= '''||maxPrcsDt||'''\n  and    fact_table =''' ||l_fact_table||'''\n  and    div_nbr =' ||l_div_nbr || '\n  and    fact_typ_cd =''' ||l_fact_typ_cd||'''';\n            dbms_output.put_line(l_trans_update_sql);\n\n           EXECUTE IMMEDIATE l_trans_update_sql;\n\n           DBMS_OUTPUT.put_line('Updated ' || sql%ROWCOUNT || ' SB PO_CORP rows in FACT_LOAD_STAT');\n            END IF;\n\n   IF (c_enable_commit = 1) THEN\n      COMMIT;\n            ELSE ROLLBACK;\n   END IF;\n\n   DBMS_OUTPUT.put_line ('End Process');\n\nEXCEPTION\n    WHEN NO_DATA_FOUND\n      THEN NULL;\n   WHEN OTHERS THEN\n      ROLLBACK;\n      DBMS_OUTPUT.put_line(SQLERRM || ':' || SQLERRM);\nEND incr_load_stat;\n/",
            "upstream_dependencies": [],
            "downstream_dependencies": [
                "XDMADM.INCR_LOAD_STAT"
            ],
            "dag_location": "null",
            "gantt_location": "null",
            "created_at": "null",
            "updated_at": "null"
        },
        {
            "name": "RESET_LOAD_STAT",
            "encrypted_name": "c06b598696256c60a2533ba57ed5ce5f",
            "type": "procedure",
            "database": "null",
            "encrypted_database": "null",
            "schema": "XDMADM",
            "encrypted_schema": "d3ababae562e77f4eac89c2a2f1f69ba",
            "fully_qualified_name": "XDMADM.RESET_LOAD_STAT",
            "encrypted_fqn": "d3ababae562e77f4eac89c2a2f1f69ba.c06b598696256c60a2533ba57ed5ce5f",
            "synonyms": [],
            "metadata_analysis": "CREATE OR REPLACE PROCEDURE \"d3ababae562e77f4eac89c2a2f1f69ba\".\"c06b598696256c60a2533ba57ed5ce5f\" (p_fact_table IN Varchar2,\n                               p_fact_typ_cd IN Varchar,\n                               p_fact_table_dsply_nm IN Varchar2,\n                               p_fact_typ_desc IN Varchar2,\n                               p_load_freq IN Varchar2,\n                               p_rpt_dsply_ind IN Varchar2,\n                               p_odate IN Date)\n       AS\n\n\n\nlatestPrcsdt            DATE;\nl_opo_div               NUMBER;\nl_fact_typ_cd           Varchar(2 Byte);\nl_fact_table            VARCHAR2(100);\nl_fact_table_dsply_nm   VARCHAR2(100);\nl_fact_typ_desc         VARCHAR2(100);\nl_load_freq             VARCHAR2(100);\nl_div_nbr               number;\nl_rpt_dsply_ind         VARCHAR2(2 Byte);\nl_day_of_week           Varchar2(100);\n\n  TYPE cur_type IS REF CURSOR;\n  div_cur  cur_type;\n    TYPE rec_ty IS RECORD\n  ( div_nbr NUMBER);\n\n  div_rec rec_ty;\n\nBEGIN\n\ndbms_output.put_line('Start');\n\ndbms_output.put_line('Delete inactive records');\n            DELETE FROM f3b0e17ff5eb20389464b74702fe30c3.dffd5712cbb020a43643a0ea4b9caf73\n            WHERE div_nbr NOT IN (SELECT  f3b0e17ff5eb20389464b74702fe30c3.f75c81fb1c3bb4ef2d891df0a8be6864.76e645dd6c2a4530c207369ef639040e\n                                 FROM   f3b0e17ff5eb20389464b74702fe30c3.f75c81fb1c3bb4ef2d891df0a8be6864 dc\n                                  WHERE   (f3b0e17ff5eb20389464b74702fe30c3.f75c81fb1c3bb4ef2d891df0a8be6864.be6ba2ef8b1a1494f70e3e67152bc520 IS NULL\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tOR    f3b0e17ff5eb20389464b74702fe30c3.f75c81fb1c3bb4ef2d891df0a8be6864.9e691ba2d76b83a97af65239347ddd30 > SYSDATE)\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t AND    f3b0e17ff5eb20389464b74702fe30c3.f75c81fb1c3bb4ef2d891df0a8be6864.291cd0a44f80c81d2f99f6b97097fe28 IS NULL\n                                    AND   f3b0e17ff5eb20389464b74702fe30c3.f75c81fb1c3bb4ef2d891df0a8be6864.108fe962811917a4bd67b66b0269af2c > 0)\n                                    AND div_nbr != 0\n                                    AND fact_table = p_fact_table;\n                DBMS_OUTPUT.put_line('DELETED ' || sql%ROWCOUNT || ' rows for ' || p_fact_table);\n\n  OPEN div_cur FOR\n            SELECT   f3b0e17ff5eb20389464b74702fe30c3.f75c81fb1c3bb4ef2d891df0a8be6864.76e645dd6c2a4530c207369ef639040e\n            FROM   f3b0e17ff5eb20389464b74702fe30c3.f75c81fb1c3bb4ef2d891df0a8be6864 dc\n           WHERE   (f3b0e17ff5eb20389464b74702fe30c3.f75c81fb1c3bb4ef2d891df0a8be6864.be6ba2ef8b1a1494f70e3e67152bc520 IS NULL\n                    OR f3b0e17ff5eb20389464b74702fe30c3.f75c81fb1c3bb4ef2d891df0a8be6864.9e691ba2d76b83a97af65239347ddd30 > SYSDATE)\n                    AND   f3b0e17ff5eb20389464b74702fe30c3.f75c81fb1c3bb4ef2d891df0a8be6864.291cd0a44f80c81d2f99f6b97097fe28 IS NULL\n                    AND   f3b0e17ff5eb20389464b74702fe30c3.f75c81fb1c3bb4ef2d891df0a8be6864.108fe962811917a4bd67b66b0269af2c > 0;\n\nLOOP\n  FETCH div_cur INTO div_rec;\n  EXIT WHEN div_cur%NOTFOUND;\n\n            l_fact_typ_cd := p_fact_typ_cd;\n            l_div_nbr := 7c249d7e9f79b24b8ec714efab43b3c0.76e645dd6c2a4530c207369ef639040e;\n            l_fact_table := p_fact_table;\n            l_fact_table_dsply_nm:= p_fact_table_dsply_nm ;\n            l_fact_typ_desc := p_fact_typ_desc;\n            l_load_freq:= p_load_freq;\n\t\t\t\t\t\tl_rpt_dsply_ind:= p_rpt_dsply_ind;\n      dbms_output.put_line(l_fact_table ||' '|| l_div_nbr ||' ' || l_fact_typ_cd);\n\n        \n\n  INSERT INTO f3b0e17ff5eb20389464b74702fe30c3.dffd5712cbb020a43643a0ea4b9caf73\n      (SELECT l_fact_table,l_div_nbr, l_fact_typ_cd, l_fact_table_dsply_nm, l_fact_typ_desc, TRUNC(p_odate), 1, (SYSDATE), TRUNC(p_odate),l_load_freq, l_rpt_dsply_ind\n         FROM div_corp div\n         WHERE f75c81fb1c3bb4ef2d891df0a8be6864.76e645dd6c2a4530c207369ef639040e = l_div_nbr\n        AND NOT EXISTS (SELECT 1\n                            FROM f3b0e17ff5eb20389464b74702fe30c3.dffd5712cbb020a43643a0ea4b9caf73 org\n                           WHERE (14fa4fe7a1fd652921f353d47117a175.76e645dd6c2a4530c207369ef639040e =l_div_nbr or div_nbr = 0)\n                            AND   14fa4fe7a1fd652921f353d47117a175.c2efa63f1c36f9f4f64e56bb36613521= l_fact_table\n\t                          AND  (14fa4fe7a1fd652921f353d47117a175.7fc6f144d711da7a7167910e8c2e463b is null or 14fa4fe7a1fd652921f353d47117a175.7fc6f144d711da7a7167910e8c2e463b = l_fact_typ_cd))) ;\n\n            DBMS_OUTPUT.put_line('Inserted ' || sql%ROWCOUNT || ' rows for ' || l_fact_table);\n    END LOOP;\nCLOSE div_cur;\n\n    \n\n    SELECT   max(latest_prcs_dt)\n     INTO    latestPrcsdt\n     FROM    f3b0e17ff5eb20389464b74702fe30c3.dffd5712cbb020a43643a0ea4b9caf73\n     WHERE   fact_table = l_fact_table\n     AND     (fact_typ_cd is null or fact_typ_cd = l_fact_typ_cd);\n         DBMS_OUTPUT.put_line('Latest Prcs Dt '|| latestPrcsdt || ' ' || l_fact_table || ' ' || p_odate || ' ' || l_day_of_week);\n\n     SELECT trim(TO_CHAR(trunc(p_odate), 'DAY')) INTO l_day_of_week FROM dual;\n     DBMS_OUTPUT.put_line('Day of Week '|| l_day_of_week);\n\n     IF latestPrcsdt <= p_odate  AND (l_fact_typ_cd is null or l_fact_typ_cd not in ('AP', 'SB', 'SA')) THEN\n      dbms_output.put_line('Start Daily Update');\n\n         UPDATE f3b0e17ff5eb20389464b74702fe30c3.dffd5712cbb020a43643a0ea4b9caf73\n          SET div_load_stat = 0,\n              div_load_ts = SYSDATE,\n              prcs_dt = p_odate +1\n        WHERE  fact_table = l_fact_table\n          AND (fact_typ_cd is null or fact_typ_cd = l_fact_typ_cd);\n    DBMS_OUTPUT.put_line('Updated' ||' '|| sql%ROWCOUNT || ' rows for ' || l_fact_table || ' ' || l_fact_typ_cd || ' ' || l_day_of_week);\n\n             ELSIF (l_fact_typ_cd in ('AP', 'SB', 'SA') and l_day_of_week ='SATURDAY') THEN\n             dbms_output.put_line('Start Weekly Update');\n\n\t\t\t\t\t\t  UPDATE f3b0e17ff5eb20389464b74702fe30c3.dffd5712cbb020a43643a0ea4b9caf73\n                 SET div_load_stat = 0,\n                     div_load_ts = SYSDATE,\n                     prcs_dt = p_odate +1\n               WHERE fact_table = l_fact_table\n\t\t\t\t\t\t\t\tAND (fact_typ_cd is null or fact_typ_cd = l_fact_typ_cd);\n                 DBMS_OUTPUT.put_line('Updated' ||' '|| sql%ROWCOUNT || ' rows for ' || l_fact_table || ' ' || l_fact_typ_cd );\n              END IF;\nCOMMIT;\n     DBMS_OUTPUT.put_line ('End Process');\n\nEXCEPTION\n    WHEN NO_DATA_FOUND\n      THEN NULL;\n   WHEN OTHERS THEN\n      ROLLBACK;\n      DBMS_OUTPUT.put_line(SQLERRM || ':' || SQLERRM);\nEND reset_load_stat;\n/",
            "upstream_dependencies": [],
            "downstream_dependencies": [
                "XDMADM.RESET_LOAD_STAT"
            ],
            "dag_location": "null",
            "gantt_location": "null",
            "created_at": "null",
            "updated_at": "null"
        },
        {
            "name": "FACT_LOAD_STAT_BAKUP",
            "encrypted_name": "dcbd625515f617302934bc7ca4dbf510f19b0d0d2a276f3b0d5cc885c2302752",
            "type": "procedure",
            "database": "null",
            "encrypted_database": "null",
            "schema": "XDMADM",
            "encrypted_schema": "d3ababae562e77f4eac89c2a2f1f69ba",
            "fully_qualified_name": "XDMADM.FACT_LOAD_STAT_BAKUP",
            "encrypted_fqn": "d3ababae562e77f4eac89c2a2f1f69ba.dcbd625515f617302934bc7ca4dbf510f19b0d0d2a276f3b0d5cc885c2302752",
            "synonyms": [],
            "metadata_analysis": "CREATE OR REPLACE PROCEDURE \"d3ababae562e77f4eac89c2a2f1f69ba\".\"dcbd625515f617302934bc7ca4dbf510f19b0d0d2a276f3b0d5cc885c2302752\" ( p_odate IN Date)\n   AS\n\n\n\nbakTs   CONSTANT DATE := SYSDATE;\n\nBEGIN\n\ndbms_output.put_line('Start');\ndbms_output.put_line('Insert into FACT_LOAD_STAT_BAK');\n\nInsert into d3ababae562e77f4eac89c2a2f1f69ba.dcbd625515f617302934bc7ca4dbf5103155ba5903f4f57786c5087ca76e389e\n(select bakTs, fact_table, div_nbr, fact_typ_cd, fact_table_dsply_nm, fact_typ_desc, latest_prcs_dt, div_load_stat, div_load_ts, prcs_dt, load_freq, rpt_dsply_ind from fact_load_stat);\n\nDBMS_OUTPUT.put_line('INSERTED ' || sql%ROWCOUNT || ' rows into FACT_LOAD_STAT_BAK');\n\n     DBMS_OUTPUT.put_line ('End Process');\nCOMMIT;\n\nEXCEPTION\n    WHEN NO_DATA_FOUND\n      THEN NULL;\n   WHEN OTHERS THEN\n      ROLLBACK;\n      DBMS_OUTPUT.put_line(SQLERRM || ':' || SQLERRM);\n\nEND FACT_LOAD_STAT_BAKUP;\n/",
            "upstream_dependencies": [],
            "downstream_dependencies": [
                "XDMADM.FACT_LOAD_STAT_BAKUP"
            ],
            "dag_location": "null",
            "gantt_location": "null",
            "created_at": "null",
            "updated_at": "null"
        },
        {
            "name": "COMPRESS_SUBPARTITION",
            "encrypted_name": "8e430d5b8894301b805a9ff11c9687c380325fc4e3c2abe9f906baec5d0e09d6",
            "type": "procedure",
            "database": "null",
            "encrypted_database": "null",
            "schema": "XDMADM",
            "encrypted_schema": "d3ababae562e77f4eac89c2a2f1f69ba",
            "fully_qualified_name": "XDMADM.COMPRESS_SUBPARTITION",
            "encrypted_fqn": "d3ababae562e77f4eac89c2a2f1f69ba.8e430d5b8894301b805a9ff11c9687c380325fc4e3c2abe9f906baec5d0e09d6",
            "synonyms": [],
            "metadata_analysis": "CREATE OR REPLACE PROCEDURE \"d3ababae562e77f4eac89c2a2f1f69ba\".\"8e430d5b8894301b805a9ff11c9687c380325fc4e3c2abe9f906baec5d0e09d6\"\n(\np_schm   varchar2,\np_tbl    varchar2,\np_end_dt date\n)\nAS\n  l_highval     VARCHAR2(4000);\n  i_highval     VARCHAR2(4000);\n  l_subhighval  VARCHAR2(4000);\n  i_subhighval  VARCHAR2(4000);\n  v_div_nbr     number;\n  v_tgt_tab     varchar2(32);\n  v_end_dt      date;\n  v_stmt1       varchar2(2000);\n  v_stmt2       varchar2(2000);\n  \n  v_sls_compr_intvl NUMBER;\n  v_skip_sls_compr_intvl NUMBER;\nBEGIN\n  v_div_nbr := substr(p_tbl,instr(p_tbl,'_')+1);\n  dbms_output.put_line('Div Nbr: '|| v_div_nbr);\n  v_tgt_tab := substr(p_tbl,1,instr(p_tbl,'_'))||'CORP';\n  dbms_output.put_line('TGT Tab: '|| v_tgt_tab);\n\n\n\n\n\n\n     <<RETRIEVE_SKIP_SLS_COMPR_INTRVL>>\n      BEGIN\n\n            SELECT param_value_nbr\n              INTO v_skip_sls_compr_intvl\n              FROM f3b0e17ff5eb20389464b74702fe30c3.ce930a3a4e5498a06f4a0f9e4a954f87\n             WHERE app_name = 'COMPRESSION'\n               AND param_type = 'COMPR_INTVL'\n               AND param_code = 'SKIP_SLS_COMPR_INTVL';\n\n             dbms_output.put_line('Skip Sales Compression Interval from param value is: ' || v_skip_sls_compr_intvl);\n\n             EXCEPTION\n                  WHEN NO_DATA_FOUND THEN\n                      DBMS_OUTPUT.PUT_LINE ('No Data Found in PARAM_VALUE where app_name = COMPRESSION and param_type = COMPR_INTVL and param_code = SKIP_SLS_COMPR_INTVL');\n                      DBMS_OUTPUT.PUT_LINE ('Exception Encountered: '||SQLCODE||' - '|| SQLERRM);\n                      RAISE;\n                  WHEN OTHERS THEN\n                      DBMS_OUTPUT.PUT_LINE('Exception Encountered: '||SQLCODE||' - '|| SQLERRM);\n                      RAISE;\n      END;\n\n\n\n\n\n  IF p_end_dt IS NULL THEN\n      BEGIN\n            \n            SELECT param_value_nbr\n              INTO v_sls_compr_intvl\n              FROM f3b0e17ff5eb20389464b74702fe30c3.ce930a3a4e5498a06f4a0f9e4a954f87\n             WHERE app_name = 'COMPRESSION'\n               AND param_type = 'COMPR_INTVL'\n               AND param_code = 'SLS_COMPR_INTVL';\n\n             dbms_output.put_line('Sales Compression Interval from param value is: ' || v_sls_compr_intvl);\n\n             EXCEPTION\n                  WHEN NO_DATA_FOUND THEN\n                      DBMS_OUTPUT.PUT_LINE ('No Data Found in PARAM_VALUE where app_name = COMPRESSION and param_type = COMPR_INTVL and param_code = SLS_COMPR_INTVL');\n                      DBMS_OUTPUT.PUT_LINE ('Exception Encountered: '||SQLCODE||' - '|| SQLERRM);\n                      RAISE;\n                  WHEN OTHERS THEN\n                      DBMS_OUTPUT.PUT_LINE('Exception Encountered: '||SQLCODE||' - '|| SQLERRM);\n                      RAISE;\n      END;\n    \n    \n      v_end_dt := sysdate-v_sls_compr_intvl;\n  ELSE\n    v_end_dt := p_end_dt;\n  END IF;\n  dbms_output.put_line ('End Dt: '||v_end_dt);\n\n\n  FOR c1 IN (SELECT partition_name\n                   ,high_value\n               FROM user_tab_partitions\n              WHERE table_name = v_tgt_tab\n              ORDER BY partition_position DESC)\n  LOOP\n    \n\n    l_highval := 3ddce89a1e362d34c989cab179f83b17.dabaa693a357439ecdea6c8f25c01e25;\n    \n    l_highval := substr(l_highval, 11, 11);\n    \n\n\n \n    IF to_date(l_highval,'yyyy-mm-dd') < SYSDATE-v_skip_sls_compr_intvl THEN\n        dbms_output.put_line('Partition: '||3ddce89a1e362d34c989cab179f83b17.b661e278898cdcf45f5dcdcb87747279|| ' HV: '||l_highval);\n        FOR c2 IN (SELECT subpartition_name,tablespace_name, compress_for\n                         ,high_value\n                     FROM user_tab_subpartitions\n                    WHERE table_name = v_tgt_tab\n                      AND partition_name = 3ddce89a1e362d34c989cab179f83b17.b661e278898cdcf45f5dcdcb87747279\n                    ORDER BY subpartition_position)\n        LOOP\n            l_subhighval := 8c76c53d8cd7c0aaabe67e0b2d92f6a4.dabaa693a357439ecdea6c8f25c01e25;\n\n            IF l_subhighval = to_char(v_div_nbr) THEN\n                dbms_output.put_line('Subpartition: '||8c76c53d8cd7c0aaabe67e0b2d92f6a4.e2d39eafadbf0034b7b987614d03d4d2208b73451326d90f4ae368ecd8da1c03|| ' HV: '||l_subhighval||' FOR: '||8c76c53d8cd7c0aaabe67e0b2d92f6a4.a45992f3a595c875704dc08e1d1ffeb5);\n                v_stmt1 := 'ALTER TABLE '||p_schm||'.'||v_tgt_tab||' MOVE SUBPARTITION '||8c76c53d8cd7c0aaabe67e0b2d92f6a4.e2d39eafadbf0034b7b987614d03d4d2208b73451326d90f4ae368ecd8da1c03|| ' TABLESPACE '||8c76c53d8cd7c0aaabe67e0b2d92f6a4.5d098dce8c716a6902c0b898ff5d2c27||' COMPRESS FOR '||8c76c53d8cd7c0aaabe67e0b2d92f6a4.a45992f3a595c875704dc08e1d1ffeb5;\n                dbms_output.put_line(v_stmt1);\n                BEGIN\n                  execute immediate (v_stmt1);\n                  EXCEPTION\n                    WHEN OTHERS THEN\n                      dbms_output.put_line('sql: '||v_stmt1);\n                      dbms_output.put_line('Exception Encountered: '||SQLCODE||' - '|| SQLERRM);\n                  RAISE;\n                END;\n                EXIT;\n            END IF;\n        END LOOP;\n      IF to_date(l_highval,'yyyy-mm-dd') < v_end_dt THEN\n        EXIT;\n      END IF;\n    END IF;\n  END LOOP;\n\n  FOR i0 in (SELECT index_name\n               FROM user_indexes\n              WHERE table_owner = p_schm AND table_name = v_tgt_tab)\n  LOOP\n    FOR i1 IN (SELECT partition_name\n                     ,high_value\n                 FROM user_ind_partitions\n                WHERE index_name = f506aaefc0232e8706a14f49828c4bf7.b866ac32406a02167caa725aa4c11687\n                ORDER BY partition_position DESC)\n    LOOP\n      \n      i_highval := bc3c07a582a338f5163c156948c98627.dabaa693a357439ecdea6c8f25c01e25;\n      \n      i_highval := substr(i_highval, 11, 11);\n\n    \n        IF to_date(i_highval,'yyyy-mm-dd') < SYSDATE-v_skip_sls_compr_intvl THEN\n          dbms_output.put_line('Partition: '||bc3c07a582a338f5163c156948c98627.b661e278898cdcf45f5dcdcb87747279|| ' HV: '||i_highval);\n          FOR i2 IN (SELECT subpartition_name,tablespace_name\n                           ,high_value\n                       FROM user_ind_subpartitions\n                      WHERE index_name = f506aaefc0232e8706a14f49828c4bf7.b866ac32406a02167caa725aa4c11687\n                        AND partition_name = bc3c07a582a338f5163c156948c98627.b661e278898cdcf45f5dcdcb87747279\n                      ORDER BY subpartition_position)\n          LOOP\n              i_subhighval := f4a9506ceff39c7dae39d7bbe394ecb7.dabaa693a357439ecdea6c8f25c01e25;\n\n              IF i_subhighval = to_char(v_div_nbr) THEN\n                dbms_output.put_line('Subpartition: '||f4a9506ceff39c7dae39d7bbe394ecb7.e2d39eafadbf0034b7b987614d03d4d2208b73451326d90f4ae368ecd8da1c03|| ' HV: '||i_subhighval);\n                v_stmt2 := 'ALTER INDEX '||p_schm||'.'||f506aaefc0232e8706a14f49828c4bf7.b866ac32406a02167caa725aa4c11687||' REBUILD SUBPARTITION '||f4a9506ceff39c7dae39d7bbe394ecb7.e2d39eafadbf0034b7b987614d03d4d2208b73451326d90f4ae368ecd8da1c03|| ' TABLESPACE '||f4a9506ceff39c7dae39d7bbe394ecb7.5d098dce8c716a6902c0b898ff5d2c27;\n                dbms_output.put_line(v_stmt2);\n                BEGIN\n                  execute immediate (v_stmt2);\n                  EXCEPTION\n                    WHEN OTHERS THEN\n                      dbms_output.put_line('sql: '||v_stmt1);\n                      dbms_output.put_line('Exception Encountered: '||SQLCODE||' - '|| SQLERRM);\n                  RAISE;\n                END;\n                EXIT;\n              END IF;\n          END LOOP;\n        IF to_date(i_highval,'yyyy-mm-dd') < v_end_dt THEN\n          EXIT;\n        END IF;\n      END IF;\n    END LOOP;\n  END LOOP;\nend compress_subpartition;\n/",
            "upstream_dependencies": [],
            "downstream_dependencies": [
                "XDMADM.COMPRESS_SUBPARTITION"
            ],
            "dag_location": "null",
            "gantt_location": "null",
            "created_at": "null",
            "updated_at": "null"
        }
    ]
}